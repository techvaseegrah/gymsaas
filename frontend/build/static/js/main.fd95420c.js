/*! For license information please see main.fd95420c.js.LICENSE.txt */
(()=>{var e={385:()=>{},551:()=>{},557:function(e,t,n){var r;"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof this||("undefined"!==typeof window?window:"undefined"!==typeof self?self:n.g),r=function(e){return function(){"use strict";var t={172:function(e,t){var n=this&&this.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.CellHookData=t.HookData=void 0;var r=function(e,t,n){this.table=t,this.pageNumber=t.pageNumber,this.pageCount=this.pageNumber,this.settings=t.settings,this.cursor=n,this.doc=e.getDocument()};t.HookData=r;var a=function(e){function t(t,n,r,a,i,o){var s=e.call(this,t,n,o)||this;return s.cell=r,s.row=a,s.column=i,s.section=a.section,s}return n(t,e),t}(r);t.CellHookData=a},340:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),a=n(136),i=n(744),o=n(776),s=n(664),l=n(972);t.default=function(e){e.API.autoTable=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];1===t.length?e=t[0]:(console.error("Use of deprecated autoTable initiation"),(e=t[2]||{}).columns=t[0],e.body=t[1]);var r=(0,o.parseInput)(this,e),a=(0,l.createTable)(this,r);return(0,s.drawTable)(this,a),this},e.API.lastAutoTable=!1,e.API.previousAutoTable=!1,e.API.autoTable.previous=!1,e.API.autoTableText=function(e,t,n,r){(0,a.default)(e,t,n,r,this)},e.API.autoTableSetDefaults=function(e){return i.DocHandler.setDefaults(e,this),this},e.autoTableSetDefaults=function(e,t){i.DocHandler.setDefaults(e,t)},e.API.autoTableHtmlToJson=function(e,t){var n;if(void 0===t&&(t=!1),"undefined"===typeof window)return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var a=new i.DocHandler(this),o=(0,r.parseHtml)(a,e,window,t,!1),s=o.head,l=o.body;return{columns:(null===(n=s[0])||void 0===n?void 0:n.map(function(e){return e.content}))||[],rows:l,data:l}},e.API.autoTableEndPosY=function(){console.error("Use of deprecated function: autoTableEndPosY. Use doc.lastAutoTable.finalY instead.");var e=this.lastAutoTable;return e&&e.finalY?e.finalY:0},e.API.autoTableAddPageContent=function(t){return console.error("Use of deprecated function: autoTableAddPageContent. Use jsPDF.autoTableSetDefaults({didDrawPage: () => {}}) instead."),e.API.autoTable.globalDefaults||(e.API.autoTable.globalDefaults={}),e.API.autoTable.globalDefaults.addPageContent=t,this},e.API.autoTableAddPage=function(){return console.error("Use of deprecated function: autoTableAddPage. Use doc.addPage()"),this.addPage(),this}}},136:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r,a){r=r||{};var i=a.internal.scaleFactor,o=a.internal.getFontSize()/i,s=o*(a.getLineHeightFactor?a.getLineHeightFactor():1.15),l="",c=1;if("middle"!==r.valign&&"bottom"!==r.valign&&"center"!==r.halign&&"right"!==r.halign||(c=(l="string"===typeof e?e.split(/\r\n|\r|\n/g):e).length||1),n+=o*(2-1.15),"middle"===r.valign?n-=c/2*s:"bottom"===r.valign&&(n-=c*s),"center"===r.halign||"right"===r.halign){var u=o;if("center"===r.halign&&(u*=.5),l&&c>=1){for(var h=0;h<l.length;h++)a.text(l[h],t-a.getStringUnitWidth(l[h])*u,n),n+=s;return a}t-=a.getStringUnitWidth(e)*u}return"justify"===r.halign?a.text(e,t,n,{maxWidth:r.maxWidth||100,align:"justify"}):a.text(e,t,n),a}},420:function(e,t){function n(e,t){var n=e>0,r=t||0===t;return n&&r?"DF":n?"S":r?"F":null}function r(e,t){var n,r,a,i;if(e=e||t,Array.isArray(e)){if(e.length>=4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(3===e.length)return{top:e[0],right:e[1],bottom:e[2],left:e[1]};if(2===e.length)return{top:e[0],right:e[1],bottom:e[0],left:e[1]};e=1===e.length?e[0]:t}return"object"===typeof e?("number"===typeof e.vertical&&(e.top=e.vertical,e.bottom=e.vertical),"number"===typeof e.horizontal&&(e.right=e.horizontal,e.left=e.horizontal),{left:null!==(n=e.left)&&void 0!==n?n:t,top:null!==(r=e.top)&&void 0!==r?r:t,right:null!==(a=e.right)&&void 0!==a?a:t,bottom:null!==(i=e.bottom)&&void 0!==i?i:t}):("number"!==typeof e&&(e=t),{top:e,right:e,bottom:e,left:e})}Object.defineProperty(t,"__esModule",{value:!0}),t.getPageAvailableWidth=t.parseSpacing=t.getFillStyle=t.addTableBorder=t.getStringWidth=void 0,t.getStringWidth=function(e,t,n){return n.applyStyles(t,!0),(Array.isArray(e)?e:[e]).map(function(e){return n.getTextWidth(e)}).reduce(function(e,t){return Math.max(e,t)},0)},t.addTableBorder=function(e,t,r,a){var i=t.settings.tableLineWidth,o=t.settings.tableLineColor;e.applyStyles({lineWidth:i,lineColor:o});var s=n(i,!1);s&&e.rect(r.x,r.y,t.getWidth(e.pageSize().width),a.y-r.y,s)},t.getFillStyle=n,t.parseSpacing=r,t.getPageAvailableWidth=function(e,t){var n=r(t.settings.margin,0);return e.pageSize().width-(n.left+n.right)}},796:function(e,t){var n=this&&this.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.getTheme=t.defaultStyles=t.HtmlRowInput=void 0;var r=function(e){function t(t){var n=e.call(this)||this;return n._element=t,n}return n(t,e),t}(Array);t.HtmlRowInput=r,t.defaultStyles=function(e){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/e,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}},t.getTheme=function(e){return{striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}}[e]}},903:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.parseCss=void 0;var r=n(420);function a(e,t){var n=i(e,t);if(!n)return null;var r=n.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!r||!Array.isArray(r))return null;var a=[parseInt(r[1]),parseInt(r[2]),parseInt(r[3])];return 0===parseInt(r[4])||isNaN(a[0])||isNaN(a[1])||isNaN(a[2])?null:a}function i(e,t){var n=t(e);return"rgba(0, 0, 0, 0)"===n||"transparent"===n||"initial"===n||"inherit"===n?null==e.parentElement?null:i(e.parentElement,t):n}t.parseCss=function(e,t,n,i,o){var s={},l=96/72,c=a(t,function(e){return o.getComputedStyle(e).backgroundColor});null!=c&&(s.fillColor=c);var u=a(t,function(e){return o.getComputedStyle(e).color});null!=u&&(s.textColor=u);var h=function(e,t){var n=[e.paddingTop,e.paddingRight,e.paddingBottom,e.paddingLeft],a=96/(72/t),i=(parseInt(e.lineHeight)-parseInt(e.fontSize))/t/2,o=n.map(function(e){return parseInt(e||"0")/a}),s=(0,r.parseSpacing)(o,0);return i>s.top&&(s.top=i),i>s.bottom&&(s.bottom=i),s}(i,n);h&&(s.cellPadding=h);var d="borderTopColor",f=l*n,p=i.borderTopWidth;if(i.borderBottomWidth===p&&i.borderRightWidth===p&&i.borderLeftWidth===p){var g=(parseFloat(p)||0)/f;g&&(s.lineWidth=g)}else s.lineWidth={top:(parseFloat(i.borderTopWidth)||0)/f,right:(parseFloat(i.borderRightWidth)||0)/f,bottom:(parseFloat(i.borderBottomWidth)||0)/f,left:(parseFloat(i.borderLeftWidth)||0)/f},s.lineWidth.top||(s.lineWidth.right?d="borderRightColor":s.lineWidth.bottom?d="borderBottomColor":s.lineWidth.left&&(d="borderLeftColor"));var m=a(t,function(e){return o.getComputedStyle(e)[d]});null!=m&&(s.lineColor=m);var v=["left","right","center","justify"];-1!==v.indexOf(i.textAlign)&&(s.halign=i.textAlign),-1!==(v=["middle","bottom","top"]).indexOf(i.verticalAlign)&&(s.valign=i.verticalAlign);var b=parseInt(i.fontSize||"");isNaN(b)||(s.fontSize=b/l);var x=function(e){var t="";return("bold"===e.fontWeight||"bolder"===e.fontWeight||parseInt(e.fontWeight)>=700)&&(t="bold"),"italic"!==e.fontStyle&&"oblique"!==e.fontStyle||(t+="italic"),t}(i);x&&(s.fontStyle=x);var y=(i.fontFamily||"").toLowerCase();return-1!==e.indexOf(y)&&(s.font=y),s}},744:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DocHandler=void 0;var n={},r=function(){function e(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return e.setDefaults=function(e,t){void 0===t&&(t=null),t?t.__autoTableDocumentDefaults=e:n=e},e.unifyColor=function(e){return Array.isArray(e)?e:"number"===typeof e?[e,e,e]:"string"===typeof e?[e]:null},e.prototype.applyStyles=function(t,n){var r,a,i;void 0===n&&(n=!1),t.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(t.fontStyle);var o=this.jsPDFDocument.internal.getFont(),s=o.fontStyle,l=o.fontName;if(t.font&&(l=t.font),t.fontStyle){s=t.fontStyle;var c=this.getFontList()[l];c&&-1===c.indexOf(s)&&(this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(c[0]),s=c[0])}if(this.jsPDFDocument.setFont(l,s),t.fontSize&&this.jsPDFDocument.setFontSize(t.fontSize),!n){var u=e.unifyColor(t.fillColor);u&&(r=this.jsPDFDocument).setFillColor.apply(r,u),(u=e.unifyColor(t.textColor))&&(a=this.jsPDFDocument).setTextColor.apply(a,u),(u=e.unifyColor(t.lineColor))&&(i=this.jsPDFDocument).setDrawColor.apply(i,u),"number"===typeof t.lineWidth&&this.jsPDFDocument.setLineWidth(t.lineWidth)}},e.prototype.splitTextToSize=function(e,t,n){return this.jsPDFDocument.splitTextToSize(e,t,n)},e.prototype.rect=function(e,t,n,r,a){return this.jsPDFDocument.rect(e,t,n,r,a)},e.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},e.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},e.prototype.getDocument=function(){return this.jsPDFDocument},e.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},e.prototype.addPage=function(){return this.jsPDFDocument.addPage()},e.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},e.prototype.getGlobalOptions=function(){return n||{}},e.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},e.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return null==e.width&&(e={width:e.getWidth(),height:e.getHeight()}),e},e.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},e.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},e.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},e.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},e}();t.DocHandler=r},4:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.parseHtml=void 0;var r=n(903),a=n(796);function i(e,t,n,i,s,l){for(var c=new a.HtmlRowInput(i),u=0;u<i.cells.length;u++){var h=i.cells[u],d=n.getComputedStyle(h);if(s||"none"!==d.display){var f=void 0;l&&(f=(0,r.parseCss)(e,h,t,d,n)),c.push({rowSpan:h.rowSpan,colSpan:h.colSpan,styles:f,_element:h,content:o(h)})}}var p=n.getComputedStyle(i);if(c.length>0&&(s||"none"!==p.display))return c}function o(e){var t=e.cloneNode(!0);return t.innerHTML=t.innerHTML.replace(/\n/g,"").replace(/ +/g," "),t.innerHTML=t.innerHTML.split(/<br.*?>/).map(function(e){return e.trim()}).join("\n"),t.innerText||t.textContent||""}t.parseHtml=function(e,t,n,r,a){var o,s,l;void 0===r&&(r=!1),void 0===a&&(a=!1),l="string"===typeof t?n.document.querySelector(t):t;var c=Object.keys(e.getFontList()),u=e.scaleFactor(),h=[],d=[],f=[];if(!l)return console.error("Html table could not be found with input: ",t),{head:h,body:d,foot:f};for(var p=0;p<l.rows.length;p++){var g=l.rows[p],m=null===(s=null===(o=null===g||void 0===g?void 0:g.parentElement)||void 0===o?void 0:o.tagName)||void 0===s?void 0:s.toLowerCase(),v=i(c,u,n,g,r,a);v&&("thead"===m?h.push(v):"tfoot"===m?f.push(v):d.push(v))}return{head:h,body:d,foot:f}}},776:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.parseInput=void 0;var r=n(4),a=n(356),i=n(420),o=n(744),s=n(792);t.parseInput=function(e,t){var n=new o.DocHandler(e),l=n.getDocumentOptions(),c=n.getGlobalOptions();(0,s.default)(n,c,l,t);var u,h=(0,a.assign)({},c,l,t);"undefined"!==typeof window&&(u=window);var d=function(e,t,n){for(var r={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},i=function(i){if("columnStyles"===i){var o=e[i],s=t[i],l=n[i];r.columnStyles=(0,a.assign)({},o,s,l)}else{var c=[e,t,n].map(function(e){return e[i]||{}});r[i]=(0,a.assign)({},c[0],c[1],c[2])}},o=0,s=Object.keys(r);o<s.length;o++)i(s[o]);return r}(c,l,t),f=function(e,t,n){for(var r={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},a=0,i=[e,t,n];a<i.length;a++){var o=i[a];o.didParseCell&&r.didParseCell.push(o.didParseCell),o.willDrawCell&&r.willDrawCell.push(o.willDrawCell),o.didDrawCell&&r.didDrawCell.push(o.didDrawCell),o.willDrawPage&&r.willDrawPage.push(o.willDrawPage),o.didDrawPage&&r.didDrawPage.push(o.didDrawPage)}return r}(c,l,t),p=function(e,t){var n,r,a,o,s,l,c,u,h,d,f,p,g,m,v=(0,i.parseSpacing)(t.margin,40/e.scaleFactor()),b=null!==(n=function(e,t){var n=e.getLastAutoTable(),r=e.scaleFactor(),a=e.pageNumber(),i=!1;return n&&n.startPageNumber&&(i=n.startPageNumber+n.pageNumber-1===a),"number"===typeof t?t:null!=t&&!1!==t||!i||null==(null===n||void 0===n?void 0:n.finalY)?null:n.finalY+20/r}(e,t.startY))&&void 0!==n?n:v.top;g=!0===t.showFoot?"everyPage":!1===t.showFoot?"never":null!==(r=t.showFoot)&&void 0!==r?r:"everyPage",m=!0===t.showHead?"everyPage":!1===t.showHead?"never":null!==(a=t.showHead)&&void 0!==a?a:"everyPage";var x=null!==(o=t.useCss)&&void 0!==o&&o,y=t.theme||(x?"plain":"striped"),w=!!t.horizontalPageBreak,k=null!==(s=t.horizontalPageBreakRepeat)&&void 0!==s?s:null;return{includeHiddenHtml:null!==(l=t.includeHiddenHtml)&&void 0!==l&&l,useCss:x,theme:y,startY:b,margin:v,pageBreak:null!==(c=t.pageBreak)&&void 0!==c?c:"auto",rowPageBreak:null!==(u=t.rowPageBreak)&&void 0!==u?u:"auto",tableWidth:null!==(h=t.tableWidth)&&void 0!==h?h:"auto",showHead:m,showFoot:g,tableLineWidth:null!==(d=t.tableLineWidth)&&void 0!==d?d:0,tableLineColor:null!==(f=t.tableLineColor)&&void 0!==f?f:200,horizontalPageBreak:w,horizontalPageBreakRepeat:k,horizontalPageBreakBehaviour:null!==(p=t.horizontalPageBreakBehaviour)&&void 0!==p?p:"afterAllRows"}}(n,h),g=function(e,t,n){var a=t.head||[],i=t.body||[],o=t.foot||[];if(t.html){var s=t.includeHiddenHtml;if(n){var l=(0,r.parseHtml)(e,t.html,n,s,t.useCss)||{};a=l.head||a,i=l.body||a,o=l.foot||a}else console.error("Cannot parse html in non browser environment")}var c=t.columns||function(e,t,n){var r=e[0]||t[0]||n[0]||[],a=[];return Object.keys(r).filter(function(e){return"_element"!==e}).forEach(function(e){var t,n=1;"object"!==typeof(t=Array.isArray(r)?r[parseInt(e)]:r[e])||Array.isArray(t)||(n=(null===t||void 0===t?void 0:t.colSpan)||1);for(var i=0;i<n;i++){var o={dataKey:Array.isArray(r)?a.length:e+(i>0?"_".concat(i):"")};a.push(o)}}),a}(a,i,o);return{columns:c,head:a,body:i,foot:o}}(n,h,u);return{id:t.tableId,content:g,hooks:f,styles:d,settings:p}}},792:function(e,t){function n(e){e.rowHeight?(console.error("Use of deprecated style rowHeight. It is renamed to minCellHeight."),e.minCellHeight||(e.minCellHeight=e.rowHeight)):e.columnWidth&&(console.error("Use of deprecated style columnWidth. It is renamed to cellWidth."),e.cellWidth||(e.cellWidth=e.columnWidth))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r,a){for(var i=function(t){t&&"object"!==typeof t&&console.error("The options parameter should be of type object, is: "+typeof t),"undefined"!==typeof t.extendWidth&&(t.tableWidth=t.extendWidth?"auto":"wrap",console.error("Use of deprecated option: extendWidth, use tableWidth instead.")),"undefined"!==typeof t.margins&&("undefined"===typeof t.margin&&(t.margin=t.margins),console.error("Use of deprecated option: margins, use margin instead.")),t.startY&&"number"!==typeof t.startY&&(console.error("Invalid value for startY option",t.startY),delete t.startY),!t.didDrawPage&&(t.afterPageContent||t.beforePageContent||t.afterPageAdd)&&(console.error("The afterPageContent, beforePageContent and afterPageAdd hooks are deprecated. Use didDrawPage instead"),t.didDrawPage=function(n){e.applyStyles(e.userStyles),t.beforePageContent&&t.beforePageContent(n),e.applyStyles(e.userStyles),t.afterPageContent&&t.afterPageContent(n),e.applyStyles(e.userStyles),t.afterPageAdd&&n.pageNumber>1&&n.afterPageAdd(n),e.applyStyles(e.userStyles)}),["createdHeaderCell","drawHeaderRow","drawRow","drawHeaderCell"].forEach(function(e){t[e]&&console.error('The "'.concat(e,'" hook has changed in version 3.0, check the changelog for how to migrate.'))}),[["showFoot","showFooter"],["showHead","showHeader"],["didDrawPage","addPageContent"],["didParseCell","createdCell"],["headStyles","headerStyles"]].forEach(function(e){var n=e[0],r=e[1];t[r]&&(console.error("Use of deprecated option ".concat(r,". Use ").concat(n," instead")),t[n]=t[r])}),[["padding","cellPadding"],["lineHeight","rowHeight"],"fontSize","overflow"].forEach(function(e){var n="string"===typeof e?e:e[0],r="string"===typeof e?e:e[1];"undefined"!==typeof t[n]&&("undefined"===typeof t.styles[r]&&(t.styles[r]=t[n]),console.error("Use of deprecated option: "+n+", use the style "+r+" instead."))});for(var r=0,a=["styles","bodyStyles","headStyles","footStyles"];r<a.length;r++)n(t[a[r]]||{});for(var i=t.columnStyles||{},o=0,s=Object.keys(i);o<s.length;o++)n(i[s[o]]||{})},o=0,s=[t,r,a];o<s.length;o++)i(s[o])}},260:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.Column=t.Cell=t.Row=t.Table=void 0;var r=n(796),a=n(172),i=n(420),o=function(){function e(e,t){this.pageNumber=1,this.pageCount=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=t.columns,this.head=t.head,this.body=t.body,this.foot=t.foot}return e.prototype.getHeadHeight=function(e){return this.head.reduce(function(t,n){return t+n.getMaxCellHeight(e)},0)},e.prototype.getFootHeight=function(e){return this.foot.reduce(function(t,n){return t+n.getMaxCellHeight(e)},0)},e.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},e.prototype.callCellHooks=function(e,t,n,r,i,o){for(var s=0,l=t;s<l.length;s++){var c=!1===(0,l[s])(new a.CellHookData(e,this,n,r,i,o));if(n.text=Array.isArray(n.text)?n.text:[n.text],c)return!1}return!0},e.prototype.callEndPageHooks=function(e,t){e.applyStyles(e.userStyles);for(var n=0,r=this.hooks.didDrawPage;n<r.length;n++)(0,r[n])(new a.HookData(e,this,t))},e.prototype.callWillDrawPageHooks=function(e,t){for(var n=0,r=this.hooks.willDrawPage;n<r.length;n++)(0,r[n])(new a.HookData(e,this,t))},e.prototype.getWidth=function(e){if("number"===typeof this.settings.tableWidth)return this.settings.tableWidth;if("wrap"===this.settings.tableWidth)return this.columns.reduce(function(e,t){return e+t.wrappedWidth},0);var t=this.settings.margin;return e-t.left-t.right},e}();t.Table=o;var s=function(){function e(e,t,n,a,i){void 0===i&&(i=!1),this.height=0,this.raw=e,e instanceof r.HtmlRowInput&&(this.raw=e._element,this.element=e._element),this.index=t,this.section=n,this.cells=a,this.spansMultiplePages=i}return e.prototype.getMaxCellHeight=function(e){var t=this;return e.reduce(function(e,n){var r;return Math.max(e,(null===(r=t.cells[n.index])||void 0===r?void 0:r.height)||0)},0)},e.prototype.hasRowSpan=function(e){var t=this;return e.filter(function(e){var n=t.cells[e.index];return!!n&&n.rowSpan>1}).length>0},e.prototype.canEntireRowFit=function(e,t){return this.getMaxCellHeight(t)<=e},e.prototype.getMinimumRowHeight=function(e,t){var n=this;return e.reduce(function(e,r){var a=n.cells[r.index];if(!a)return 0;var i=t.getLineHeight(a.styles.fontSize),o=a.padding("vertical")+i;return o>e?o:e},0)},e}();t.Row=s;var l=function(){function e(e,t,n){var r,a;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=t,this.section=n,this.raw=e;var i=e;null==e||"object"!==typeof e||Array.isArray(e)?(this.rowSpan=1,this.colSpan=1):(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,i=null!==(a=null!==(r=e.content)&&void 0!==r?r:e.title)&&void 0!==a?a:e,e._element&&(this.raw=e._element));var o=null!=i?""+i:"";this.text=o.split(/\r\n|\r|\n/g)}return e.prototype.getTextPos=function(){var e,t;if("top"===this.styles.valign)e=this.y+this.padding("top");else if("bottom"===this.styles.valign)e=this.y+this.height-this.padding("bottom");else{var n=this.height-this.padding("vertical");e=this.y+n/2+this.padding("top")}if("right"===this.styles.halign)t=this.x+this.width-this.padding("right");else if("center"===this.styles.halign){var r=this.width-this.padding("horizontal");t=this.x+r/2+this.padding("left")}else t=this.x+this.padding("left");return{x:t,y:e}},e.prototype.getContentHeight=function(e,t){void 0===t&&(t=1.15);var n=(Array.isArray(this.text)?this.text.length:1)*(this.styles.fontSize/e*t)+this.padding("vertical");return Math.max(n,this.styles.minCellHeight)},e.prototype.padding=function(e){var t=(0,i.parseSpacing)(this.styles.cellPadding,0);return"vertical"===e?t.top+t.bottom:"horizontal"===e?t.left+t.right:t[e]},e}();t.Cell=l;var c=function(){function e(e,t,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=t,this.index=n}return e.prototype.getMaxCustomCellWidth=function(e){for(var t=0,n=0,r=e.allRows();n<r.length;n++){var a=r[n].cells[this.index];a&&"number"===typeof a.styles.cellWidth&&(t=Math.max(t,a.styles.cellWidth))}return t},e}();t.Column=c},356:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.assign=void 0,t.assign=function(e,t,n,r,a){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(e),o=1;o<arguments.length;o++){var s=arguments[o];if(null!=s)for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(i[l]=s[l])}return i}},972:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.createTable=void 0;var r=n(744),a=n(260),i=n(324),o=n(796),s=n(356);function l(e,t,n,r,i,o){var s={};return t.map(function(t,l){for(var c=0,h={},d=0,f=0,p=0,g=n;p<g.length;p++){var m=g[p];if(null==s[m.index]||0===s[m.index].left)if(0===f){var v=void 0,b={};"object"!==typeof(v=Array.isArray(t)?t[m.index-d-c]:t[m.dataKey])||Array.isArray(v)||(b=(null===v||void 0===v?void 0:v.styles)||{});var x=u(e,m,l,i,r,o,b),y=new a.Cell(v,x,e);h[m.dataKey]=y,h[m.index]=y,f=y.colSpan-1,s[m.index]={left:y.rowSpan-1,times:f}}else f--,d++;else s[m.index].left--,f=s[m.index].times,c++}return new a.Row(t,l,e,h)})}function c(e,t){var n={};return e.forEach(function(e){if(null!=e.raw){var r=function(e,t){if("head"===e){if("object"===typeof t)return t.header||t.title||null;if("string"===typeof t||"number"===typeof t)return t}else if("foot"===e&&"object"===typeof t)return t.footer;return null}(t,e.raw);null!=r&&(n[e.dataKey]=r)}}),Object.keys(n).length>0?n:null}function u(e,t,n,r,a,i,l){var c,u=(0,o.getTheme)(r);"head"===e?c=a.headStyles:"body"===e?c=a.bodyStyles:"foot"===e&&(c=a.footStyles);var h=(0,s.assign)({},u.table,u[e],a.styles,c),d=a.columnStyles[t.dataKey]||a.columnStyles[t.index]||{},f="body"===e?d:{},p="body"===e&&n%2===0?(0,s.assign)({},u.alternateRow,a.alternateRowStyles):{},g=(0,o.defaultStyles)(i),m=(0,s.assign)({},g,h,p,f);return(0,s.assign)(m,l)}t.createTable=function(e,t){var n=new r.DocHandler(e),o=function(e,t){var n,r=e.content,i=function(e){return e.map(function(e,t){var n,r,i;return i="object"===typeof e&&null!==(r=null!==(n=e.dataKey)&&void 0!==n?n:e.key)&&void 0!==r?r:t,new a.Column(i,e,t)})}(r.columns);(0===r.head.length&&(n=c(i,"head"))&&r.head.push(n),0===r.foot.length)&&((n=c(i,"foot"))&&r.foot.push(n));var o=e.settings.theme,s=e.styles;return{columns:i,head:l("head",r.head,i,s,o,t),body:l("body",r.body,i,s,o,t),foot:l("foot",r.foot,i,s,o,t)}}(t,n.scaleFactor()),s=new a.Table(t,o);return(0,i.calculateWidths)(n,s),n.applyStyles(n.userStyles),s}},664:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.addPage=t.drawTable=void 0;var r=n(420),a=n(260),i=n(744),o=n(356),s=n(136),l=n(224);function c(e,t,n,r){var a=t.settings;e.applyStyles(e.userStyles),"firstPage"!==a.showHead&&"everyPage"!==a.showHead||t.head.forEach(function(a){return p(e,t,a,n,r)})}function u(e,t,n,r,a,i){e.applyStyles(e.userStyles),i=null!==i&&void 0!==i?i:t.body.length;var o=Math.min(n+i,t.body.length),s=-1;return t.body.slice(n,o).forEach(function(i,o){var l=n+o===t.body.length-1,c=m(e,t,l,r);i.canEntireRowFit(c,a)&&(p(e,t,i,r,a),s=n+o)}),s}function h(e,t,n,r){var a=t.settings;e.applyStyles(e.userStyles),"lastPage"!==a.showFoot&&"everyPage"!==a.showFoot||t.foot.forEach(function(a){return p(e,t,a,n,r)})}function d(e,t,n){var r=n.getLineHeight(e.styles.fontSize),a=e.padding("vertical"),i=Math.floor((t-a)/r);return Math.max(0,i)}function f(e,t,n,r,i,s,l){var c=m(e,t,r,s);if(n.canEntireRowFit(c,l))p(e,t,n,s,l);else if(function(e,t,n,r){var a=e.pageSize().height,i=r.settings.margin,o=a-(i.top+i.bottom);"body"===t.section&&(o-=r.getHeadHeight(r.columns)+r.getFootHeight(r.columns));var s=t.getMinimumRowHeight(r.columns,e),l=s<n;if(s>o)return console.error("Will not be able to print row ".concat(t.index," correctly since it's minimum height is larger than page height")),!0;if(!l)return!1;var c=t.hasRowSpan(r.columns);return t.getMaxCellHeight(r.columns)>o?(c&&console.error("The content of row ".concat(t.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!c&&"avoid"!==r.settings.rowPageBreak}(e,n,c,t)){var u=function(e,t,n,r){var i={};e.spansMultiplePages=!0,e.height=0;for(var s=0,l=0,c=n.columns;l<c.length;l++){var u=c[l];if(x=e.cells[u.index]){Array.isArray(x.text)||(x.text=[x.text]);var h=new a.Cell(x.raw,x.styles,x.section);(h=(0,o.assign)(h,x)).text=[];var f=d(x,t,r);x.text.length>f&&(h.text=x.text.splice(f,x.text.length));var p=r.scaleFactor(),g=r.getLineHeightFactor();x.contentHeight=x.getContentHeight(p,g),x.contentHeight>=t&&(x.contentHeight=t,h.styles.minCellHeight-=t),x.contentHeight>e.height&&(e.height=x.contentHeight),h.contentHeight=h.getContentHeight(p,g),h.contentHeight>s&&(s=h.contentHeight),i[u.index]=h}}var m=new a.Row(e.raw,-1,e.section,i,!0);m.height=s;for(var v=0,b=n.columns;v<b.length;v++){var x;u=b[v],(h=m.cells[u.index])&&(h.height=m.height),(x=e.cells[u.index])&&(x.height=e.height)}return m}(n,c,t,e);p(e,t,n,s,l),v(e,t,i,s,l),f(e,t,u,r,i,s,l)}else v(e,t,i,s,l),f(e,t,n,r,i,s,l)}function p(e,t,n,r,a){r.x=t.settings.margin.left;for(var i=0,o=a;i<o.length;i++){var l=o[i],c=n.cells[l.index];if(c)if(e.applyStyles(c.styles),c.x=r.x,c.y=r.y,!1!==t.callCellHooks(e,t.hooks.willDrawCell,c,n,l,r)){g(e,c,r);var u=c.getTextPos();(0,s.default)(c.text,u.x,u.y,{halign:c.styles.halign,valign:c.styles.valign,maxWidth:Math.ceil(c.width-c.padding("left")-c.padding("right"))},e.getDocument()),t.callCellHooks(e,t.hooks.didDrawCell,c,n,l,r),r.x+=l.width}else r.x+=l.width;else r.x+=l.width}r.y+=n.height}function g(e,t,n){var a=t.styles;if(e.getDocument().setFillColor(e.getDocument().getFillColor()),"number"===typeof a.lineWidth){var i=(0,r.getFillStyle)(a.lineWidth,a.fillColor);i&&e.rect(t.x,n.y,t.width,t.height,i)}else"object"===typeof a.lineWidth&&(a.fillColor&&e.rect(t.x,n.y,t.width,t.height,"F"),function(e,t,n,r){var a,i,o,s;function l(t,n,r,a,i){e.getDocument().setLineWidth(t),e.getDocument().line(n,r,a,i,"S")}r.top&&(a=n.x,i=n.y,o=n.x+t.width,s=n.y,r.right&&(o+=.5*r.right),r.left&&(a-=.5*r.left),l(r.top,a,i,o,s)),r.bottom&&(a=n.x,i=n.y+t.height,o=n.x+t.width,s=n.y+t.height,r.right&&(o+=.5*r.right),r.left&&(a-=.5*r.left),l(r.bottom,a,i,o,s)),r.left&&(a=n.x,i=n.y,o=n.x,s=n.y+t.height,r.top&&(i-=.5*r.top),r.bottom&&(s+=.5*r.bottom),l(r.left,a,i,o,s)),r.right&&(a=n.x+t.width,i=n.y,o=n.x+t.width,s=n.y+t.height,r.top&&(i-=.5*r.top),r.bottom&&(s+=.5*r.bottom),l(r.right,a,i,o,s))}(e,t,n,a.lineWidth))}function m(e,t,n,r){var a=t.settings.margin.bottom,i=t.settings.showFoot;return("everyPage"===i||"lastPage"===i&&n)&&(a+=t.getFootHeight(t.columns)),e.pageSize().height-r.y-a}function v(e,t,n,a,i,o){void 0===i&&(i=[]),void 0===o&&(o=!1),e.applyStyles(e.userStyles),"everyPage"!==t.settings.showFoot||o||t.foot.forEach(function(n){return p(e,t,n,a,i)}),t.callEndPageHooks(e,a);var s=t.settings.margin;(0,r.addTableBorder)(e,t,n,a),b(e),t.pageNumber++,t.pageCount++,a.x=s.left,a.y=s.top,n.y=s.top,t.callWillDrawPageHooks(e,a),"everyPage"===t.settings.showHead&&(t.head.forEach(function(n){return p(e,t,n,a,i)}),e.applyStyles(e.userStyles))}function b(e){var t=e.pageNumber();return e.setPage(t+1),e.pageNumber()===t&&(e.addPage(),!0)}t.drawTable=function(e,t){var n=t.settings,a=n.startY,s=n.margin,d={x:s.left,y:a},g=t.getHeadHeight(t.columns)+t.getFootHeight(t.columns),m=a+s.bottom+g;"avoid"===n.pageBreak&&(m+=t.body.reduce(function(e,t){return e+t.height},0));var x=new i.DocHandler(e);("always"===n.pageBreak||null!=n.startY&&m>x.pageSize().height)&&(b(x),d.y=s.top),t.callWillDrawPageHooks(x,d);var y=(0,o.assign)({},d);t.startPageNumber=x.pageNumber(),n.horizontalPageBreak?function(e,t,n,r){var a=(0,l.calculateAllColumnsCanFitInPage)(e,t),i=t.settings;if("afterAllRows"===i.horizontalPageBreakBehaviour)a.forEach(function(a,i){e.applyStyles(e.userStyles),i>0?v(e,t,n,r,a.columns,!0):c(e,t,r,a.columns),function(e,t,n,r,a){e.applyStyles(e.userStyles),t.body.forEach(function(i,o){var s=o===t.body.length-1;f(e,t,i,s,n,r,a)})}(e,t,n,r,a.columns),h(e,t,r,a.columns)});else for(var o=-1,s=a[0],d=function(){var i=o;if(s){e.applyStyles(e.userStyles);var l=s.columns;o>=0?v(e,t,n,r,l,!0):c(e,t,r,l),i=u(e,t,o+1,r,l),h(e,t,r,l)}var d=i-o;a.slice(1).forEach(function(a){e.applyStyles(e.userStyles),v(e,t,n,r,a.columns,!0),u(e,t,o+1,r,a.columns,d),h(e,t,r,a.columns)}),o=i};o<t.body.length-1;)d()}(x,t,y,d):(x.applyStyles(x.userStyles),"firstPage"!==n.showHead&&"everyPage"!==n.showHead||t.head.forEach(function(e){return p(x,t,e,d,t.columns)}),x.applyStyles(x.userStyles),t.body.forEach(function(e,n){var r=n===t.body.length-1;f(x,t,e,r,y,d,t.columns)}),x.applyStyles(x.userStyles),"lastPage"!==n.showFoot&&"everyPage"!==n.showFoot||t.foot.forEach(function(e){return p(x,t,e,d,t.columns)})),(0,r.addTableBorder)(x,t,y,d),t.callEndPageHooks(x,d),t.finalY=d.y,e.lastAutoTable=t,e.previousAutoTable=t,e.autoTable&&(e.autoTable.previous=t),x.applyStyles(x.userStyles)},t.addPage=v},224:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.calculateAllColumnsCanFitInPage=void 0;var r=n(420);function a(e,t,n){var a;void 0===n&&(n={});var i=(0,r.getPageAvailableWidth)(e,t),o=new Map,s=[],l=[],c=[];t.settings.horizontalPageBreakRepeat,Array.isArray(t.settings.horizontalPageBreakRepeat)?c=t.settings.horizontalPageBreakRepeat:"string"!==typeof t.settings.horizontalPageBreakRepeat&&"number"!==typeof t.settings.horizontalPageBreakRepeat||(c=[t.settings.horizontalPageBreakRepeat]),c.forEach(function(e){var n=t.columns.find(function(t){return t.dataKey===e||t.index===e});n&&!o.has(n.index)&&(o.set(n.index,!0),s.push(n.index),l.push(t.columns[n.index]),i-=n.wrappedWidth)});for(var u=!0,h=null!==(a=null===n||void 0===n?void 0:n.start)&&void 0!==a?a:0;h<t.columns.length;)if(o.has(h))h++;else{var d=t.columns[h].wrappedWidth;if(!(u||i>=d))break;u=!1,s.push(h),l.push(t.columns[h]),i-=d,h++}return{colIndexes:s,columns:l,lastIndex:h-1}}t.calculateAllColumnsCanFitInPage=function(e,t){for(var n=[],r=0;r<t.columns.length;r++){var i=a(e,t,{start:r});i.columns.length&&(n.push(i),r=i.lastIndex)}return n}},324:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.ellipsize=t.resizeColumns=t.calculateWidths=void 0;var r=n(420);function a(e,t,n){for(var r=t,i=e.reduce(function(e,t){return e+t.wrappedWidth},0),o=0;o<e.length;o++){var s=e[o],l=r*(s.wrappedWidth/i),c=s.width+l,u=n(s),h=c<u?u:c;t-=h-s.width,s.width=h}if(t=Math.round(1e10*t)/1e10){var d=e.filter(function(e){return!(t<0)||e.width>n(e)});d.length&&(t=a(d,t,n))}return t}function i(e,t,n,a,i){return e.map(function(e){return function(e,t,n,a,i){var o=1e4*a.scaleFactor();if((t=Math.ceil(t*o)/o)>=(0,r.getStringWidth)(e,n,a))return e;for(;t<(0,r.getStringWidth)(e+i,n,a)&&!(e.length<=1);)e=e.substring(0,e.length-1);return e.trim()+i}(e,t,n,a,i)})}t.calculateWidths=function(e,t){!function(e,t){var n=e.scaleFactor(),a=t.settings.horizontalPageBreak,i=(0,r.getPageAvailableWidth)(e,t);t.allRows().forEach(function(o){for(var s=0,l=t.columns;s<l.length;s++){var c=l[s],u=o.cells[c.index];if(u){var h=t.hooks.didParseCell;t.callCellHooks(e,h,u,o,c,null);var d=u.padding("horizontal");u.contentWidth=(0,r.getStringWidth)(u.text,u.styles,e)+d;var f=(0,r.getStringWidth)(u.text.join(" ").split(/[^\S\u00A0]+/),u.styles,e);if(u.minReadableWidth=f+u.padding("horizontal"),"number"===typeof u.styles.cellWidth)u.minWidth=u.styles.cellWidth,u.wrappedWidth=u.styles.cellWidth;else if("wrap"===u.styles.cellWidth||!0===a)u.contentWidth>i?(u.minWidth=i,u.wrappedWidth=i):(u.minWidth=u.contentWidth,u.wrappedWidth=u.contentWidth);else{var p=10/n;u.minWidth=u.styles.minCellWidth||p,u.wrappedWidth=u.contentWidth,u.minWidth>u.wrappedWidth&&(u.wrappedWidth=u.minWidth)}}}}),t.allRows().forEach(function(e){for(var n=0,r=t.columns;n<r.length;n++){var a=r[n],i=e.cells[a.index];if(i&&1===i.colSpan)a.wrappedWidth=Math.max(a.wrappedWidth,i.wrappedWidth),a.minWidth=Math.max(a.minWidth,i.minWidth),a.minReadableWidth=Math.max(a.minReadableWidth,i.minReadableWidth);else{var o=t.styles.columnStyles[a.dataKey]||t.styles.columnStyles[a.index]||{},s=o.cellWidth||o.minCellWidth;s&&"number"===typeof s&&(a.minWidth=s,a.wrappedWidth=s)}i&&(i.colSpan>1&&!a.minWidth&&(a.minWidth=i.minWidth),i.colSpan>1&&!a.wrappedWidth&&(a.wrappedWidth=i.minWidth))}})}(e,t);var n=[],o=0;t.columns.forEach(function(e){var r=e.getMaxCustomCellWidth(t);r?e.width=r:(e.width=e.wrappedWidth,n.push(e)),o+=e.width});var s=t.getWidth(e.pageSize().width)-o;s&&(s=a(n,s,function(e){return Math.max(e.minReadableWidth,e.minWidth)})),s&&(s=a(n,s,function(e){return e.minWidth})),s=Math.abs(s),!t.settings.horizontalPageBreak&&s>.1/e.scaleFactor()&&(s=s<1?s:Math.round(s),console.warn("Of the table content, ".concat(s," units width could not fit page"))),function(e){for(var t=e.allRows(),n=0;n<t.length;n++)for(var r=t[n],a=null,i=0,o=0,s=0;s<e.columns.length;s++){var l=e.columns[s];if((o-=1)>1&&e.columns[s+1])i+=l.width,delete r.cells[l.index];else if(a){var c=a;delete r.cells[l.index],a=null,c.width=l.width+i}else{if(!(c=r.cells[l.index]))continue;if(o=c.colSpan,i=0,c.colSpan>1){a=c,i+=l.width;continue}c.width=l.width+i}}}(t),function(e,t){for(var n={count:0,height:0},r=0,a=e.allRows();r<a.length;r++){for(var o=a[r],s=0,l=e.columns;s<l.length;s++){var c=l[s],u=o.cells[c.index];if(u){t.applyStyles(u.styles,!0);var h=u.width-u.padding("horizontal");if("linebreak"===u.styles.overflow)u.text=t.splitTextToSize(u.text,h+1/t.scaleFactor(),{fontSize:u.styles.fontSize});else if("ellipsize"===u.styles.overflow)u.text=i(u.text,h,u.styles,t,"...");else if("hidden"===u.styles.overflow)u.text=i(u.text,h,u.styles,t,"");else if("function"===typeof u.styles.overflow){var d=u.styles.overflow(u.text,h);u.text="string"===typeof d?[d]:d}u.contentHeight=u.getContentHeight(t.scaleFactor(),t.getLineHeightFactor());var f=u.contentHeight/u.rowSpan;u.rowSpan>1&&n.count*n.height<f*u.rowSpan?n={height:f,count:u.rowSpan}:n&&n.count>0&&n.height>f&&(f=n.height),f>o.height&&(o.height=f)}}n.count--}}(t,e),function(e){for(var t={},n=1,r=e.allRows(),a=0;a<r.length;a++)for(var i=r[a],o=0,s=e.columns;o<s.length;o++){var l=s[o],c=t[l.index];if(n>1)n--,delete i.cells[l.index];else if(c)c.cell.height+=i.height,n=c.cell.colSpan,delete i.cells[l.index],c.left--,c.left<=1&&delete t[l.index];else{var u=i.cells[l.index];if(!u)continue;if(u.height=i.height,u.rowSpan>1){var h=r.length-a,d=u.rowSpan>h?h:u.rowSpan;t[l.index]={cell:u,left:d,row:i}}}}}(t)},t.resizeColumns=a,t.ellipsize=i},964:function(t){if("undefined"===typeof e){var n=new Error("Cannot find module 'undefined'");throw n.code="MODULE_NOT_FOUND",n}t.exports=e}},n={};function r(e){var a=n[e];if(void 0!==a)return a.exports;var i=n[e]={exports:{}};return t[e].call(i.exports,i,i.exports,r),i.exports}var a={};return function(){var e=a;Object.defineProperty(e,"__esModule",{value:!0}),e.Cell=e.Column=e.Row=e.Table=e.CellHookData=e.__drawTable=e.__createTable=e.applyPlugin=void 0;var t=r(340),n=r(776),i=r(664),o=r(972),s=r(260);Object.defineProperty(e,"Table",{enumerable:!0,get:function(){return s.Table}});var l=r(172);Object.defineProperty(e,"CellHookData",{enumerable:!0,get:function(){return l.CellHookData}});var c=r(260);function u(e){(0,t.default)(e)}Object.defineProperty(e,"Cell",{enumerable:!0,get:function(){return c.Cell}}),Object.defineProperty(e,"Column",{enumerable:!0,get:function(){return c.Column}}),Object.defineProperty(e,"Row",{enumerable:!0,get:function(){return c.Row}}),e.applyPlugin=u,e.__createTable=function(e,t){var r=(0,n.parseInput)(e,t);return(0,o.createTable)(e,r)},e.__drawTable=function(e,t){(0,i.drawTable)(e,t)};try{var h=r(964);h.jsPDF&&(h=h.jsPDF),u(h)}catch(d){}e.default=function(e,t){var r=(0,n.parseInput)(e,t),a=(0,o.createTable)(e,r);(0,i.drawTable)(e,a)}}(),a}()},e.exports=r(function(){try{return n(7762)}catch(e){}}())},579:(e,t,n)=>{"use strict";e.exports=n(1153)},1065:()=>{},1153:(e,t,n)=>{"use strict";var r=n(5043),a=Symbol.for("react.element"),i=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,i={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)o.call(t,r)&&!l.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:a,type:e,key:c,ref:u,props:i,_owner:s.current}}t.Fragment=i,t.jsx=c,t.jsxs=c},1234:()=>{},2284:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n.d(t,{A:()=>r})},2430:function(e,t,n){var r;!function(a,i,o){var s,l=256,c=o.pow(l,6),u=o.pow(2,52),h=2*u,d=255;function f(e,t,n){var r=[],d=v(m((t=1==t?{entropy:!0}:t||{}).entropy?[e,b(i)]:null==e?function(){try{var e;return s&&(e=s.randomBytes)?e=e(l):(e=new Uint8Array(l),(a.crypto||a.msCrypto).getRandomValues(e)),b(e)}catch(r){var t=a.navigator,n=t&&t.plugins;return[+new Date,a,n,a.screen,b(i)]}}():e,3),r),f=new p(r),x=function(){for(var e=f.g(6),t=c,n=0;e<u;)e=(e+n)*l,t*=l,n=f.g(1);for(;e>=h;)e/=2,t/=2,n>>>=1;return(e+n)/t};return x.int32=function(){return 0|f.g(4)},x.quick=function(){return f.g(4)/4294967296},x.double=x,v(b(f.S),i),(t.pass||n||function(e,t,n,r){return r&&(r.S&&g(r,f),e.state=function(){return g(f,{})}),n?(o.random=e,t):e})(x,d,"global"in t?t.global:this==o,t.state)}function p(e){var t,n=e.length,r=this,a=0,i=r.i=r.j=0,o=r.S=[];for(n||(e=[n++]);a<l;)o[a]=a++;for(a=0;a<l;a++)o[a]=o[i=d&i+e[a%n]+(t=o[a])],o[i]=t;(r.g=function(e){for(var t,n=0,a=r.i,i=r.j,o=r.S;e--;)t=o[a=d&a+1],n=n*l+o[d&(o[a]=o[i=d&i+t])+(o[i]=t)];return r.i=a,r.j=i,n})(l)}function g(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function m(e,t){var n,r=[],a=typeof e;if(t&&"object"==a)for(n in e)try{r.push(m(e[n],t-1))}catch(i){}return r.length?r:"string"==a?e:e+"\0"}function v(e,t){for(var n,r=e+"",a=0;a<r.length;)t[d&a]=d&(n^=19*t[d&a])+r.charCodeAt(a++);return b(t)}function b(e){return String.fromCharCode.apply(0,e)}if(v(o.random(),i),e.exports){e.exports=f;try{s=n(1234)}catch(x){}}else void 0===(r=function(){return f}.call(t,n,t,e))||(e.exports=r)}("undefined"!==typeof self?self:this,[],Math)},2730:(e,t,n)=>{"use strict";var r=n(5043),a=n(8853);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,s={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(s[e]=t,e=0;e<t.length;e++)o.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function g(e,t,n,r,a,i,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){m[e]=new g(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];m[t]=new g(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){m[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){m[e]=new g(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){m[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){m[e]=new g(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){m[e]=new g(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){m[e]=new g(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){m[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)});var v=/[\-:]([a-z])/g;function b(e){return e[1].toUpperCase()}function x(e,t,n,r){var a=m.hasOwnProperty(t)?m[t]:null;(null!==a?0!==a.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!h.call(p,e)||!h.call(f,e)&&(d.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(v,b);m[t]=new g(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(v,b);m[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(v,b);m[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)}),m.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)});var y=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),k=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),_=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),D=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var F=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var O=Symbol.iterator;function L(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=O&&e[O]||e["@@iterator"])?e:null}var P,M=Object.assign;function j(e){if(void 0===P)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);P=t&&t[1]||""}return"\n"+P+e}var B=!1;function z(e,t){if(!e||B)return"";B=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var a=c.stack.split("\n"),i=r.stack.split("\n"),o=a.length-1,s=i.length-1;1<=o&&0<=s&&a[o]!==i[s];)s--;for(;1<=o&&0<=s;o--,s--)if(a[o]!==i[s]){if(1!==o||1!==s)do{if(o--,0>--s||a[o]!==i[s]){var l="\n"+a[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=s);break}}}finally{B=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?j(e):""}function W(e){switch(e.tag){case 5:return j(e.type);case 16:return j("Lazy");case 13:return j("Suspense");case 19:return j("SuspenseList");case 0:case 2:case 15:return e=z(e.type,!1);case 11:return e=z(e.type.render,!1);case 1:return e=z(e.type,!0);default:return""}}function U(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case N:return"Fragment";case k:return"Portal";case C:return"Profiler";case S:return"StrictMode";case T:return"Suspense";case A:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case _:return(e.displayName||"Context")+".Consumer";case E:return(e._context.displayName||"Context")+".Provider";case I:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case R:return null!==(t=e.displayName||null)?t:U(e.type)||"Memo";case D:t=e._payload,e=e._init;try{return U(e(t))}catch(n){}}return null}function V(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return U(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function G(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function q(e){e._valueTracker||(e._valueTracker=function(e){var t=G(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=G(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function X(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var n=t.checked;return M({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function $(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=H(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&x(e,"checked",t,!1)}function Q(e,t){J(e,t);var n=H(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&X(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+H(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return M({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(te(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:H(n)}}function ie(e,t){var n=H(t.value),r=H(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,he=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction(function(){return ue(e,t)})}:ue);function de(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function ge(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function me(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=ge(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(fe).forEach(function(e){pe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]})});var ve=M({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function be(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function xe(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ye=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var ke=null,Ne=null,Se=null;function Ce(e){if(e=xa(e)){if("function"!==typeof ke)throw Error(i(280));var t=e.stateNode;t&&(t=wa(t),ke(e.stateNode,e.type,t))}}function Ee(e){Ne?Se?Se.push(e):Se=[e]:Ne=e}function _e(){if(Ne){var e=Ne,t=Se;if(Se=Ne=null,Ce(e),t)for(e=0;e<t.length;e++)Ce(t[e])}}function Ie(e,t){return e(t)}function Te(){}var Ae=!1;function Re(e,t,n){if(Ae)return e(t,n);Ae=!0;try{return Ie(e,t,n)}finally{Ae=!1,(null!==Ne||null!==Se)&&(Te(),_e())}}function De(e,t){var n=e.stateNode;if(null===n)return null;var r=wa(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var Fe=!1;if(u)try{var Oe={};Object.defineProperty(Oe,"passive",{get:function(){Fe=!0}}),window.addEventListener("test",Oe,Oe),window.removeEventListener("test",Oe,Oe)}catch(ue){Fe=!1}function Le(e,t,n,r,a,i,o,s,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Pe=!1,Me=null,je=!1,Be=null,ze={onError:function(e){Pe=!0,Me=e}};function We(e,t,n,r,a,i,o,s,l){Pe=!1,Me=null,Le.apply(ze,arguments)}function Ue(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ve(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function He(e){if(Ue(e)!==e)throw Error(i(188))}function Ge(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ue(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var o=a.alternate;if(null===o){if(null!==(r=a.return)){n=r;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===n)return He(a),e;if(o===r)return He(a),t;o=o.sibling}throw Error(i(188))}if(n.return!==r.return)n=a,r=o;else{for(var s=!1,l=a.child;l;){if(l===n){s=!0,n=a,r=o;break}if(l===r){s=!0,r=a,n=o;break}l=l.sibling}if(!s){for(l=o.child;l;){if(l===n){s=!0,n=o,r=a;break}if(l===r){s=!0,r=o,n=a;break}l=l.sibling}if(!s)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e))?qe(e):null}function qe(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=qe(e);if(null!==t)return t;e=e.sibling}return null}var Ke=a.unstable_scheduleCallback,Xe=a.unstable_cancelCallback,Ye=a.unstable_shouldYield,$e=a.unstable_requestPaint,Je=a.unstable_now,Qe=a.unstable_getCurrentPriorityLevel,Ze=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,nt=a.unstable_LowPriority,rt=a.unstable_IdlePriority,at=null,it=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/lt|0)|0},st=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,a=e.suspendedLanes,i=e.pingedLanes,o=268435455&n;if(0!==o){var s=o&~a;0!==s?r=ht(s):0!==(i&=o)&&(r=ht(i))}else 0!==(o=n&~a)?r=ht(o):0!==i&&(r=ht(i));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&a)&&((a=r&-r)>=(i=t&-t)||16===a&&0!==(4194240&i)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-ot(t)),r|=e[n],t&=~a;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function gt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function mt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function bt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var xt=0;function yt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,kt,Nt,St,Ct,Et=!1,_t=[],It=null,Tt=null,At=null,Rt=new Map,Dt=new Map,Ft=[],Ot="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lt(e,t){switch(e){case"focusin":case"focusout":It=null;break;case"dragenter":case"dragleave":Tt=null;break;case"mouseover":case"mouseout":At=null;break;case"pointerover":case"pointerout":Rt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dt.delete(t.pointerId)}}function Pt(e,t,n,r,a,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},null!==t&&(null!==(t=xa(t))&&kt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Mt(e){var t=ba(e.target);if(null!==t){var n=Ue(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ve(n)))return e.blockedOn=t,void Ct(e.priority,function(){Nt(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function jt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=xa(n))&&kt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);ye=r,n.target.dispatchEvent(r),ye=null,t.shift()}return!0}function Bt(e,t,n){jt(e)&&n.delete(t)}function zt(){Et=!1,null!==It&&jt(It)&&(It=null),null!==Tt&&jt(Tt)&&(Tt=null),null!==At&&jt(At)&&(At=null),Rt.forEach(Bt),Dt.forEach(Bt)}function Wt(e,t){e.blockedOn===t&&(e.blockedOn=null,Et||(Et=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,zt)))}function Ut(e){function t(t){return Wt(t,e)}if(0<_t.length){Wt(_t[0],e);for(var n=1;n<_t.length;n++){var r=_t[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==It&&Wt(It,e),null!==Tt&&Wt(Tt,e),null!==At&&Wt(At,e),Rt.forEach(t),Dt.forEach(t),n=0;n<Ft.length;n++)(r=Ft[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Ft.length&&null===(n=Ft[0]).blockedOn;)Mt(n),null===n.blockedOn&&Ft.shift()}var Vt=y.ReactCurrentBatchConfig,Ht=!0;function Gt(e,t,n,r){var a=xt,i=Vt.transition;Vt.transition=null;try{xt=1,Kt(e,t,n,r)}finally{xt=a,Vt.transition=i}}function qt(e,t,n,r){var a=xt,i=Vt.transition;Vt.transition=null;try{xt=4,Kt(e,t,n,r)}finally{xt=a,Vt.transition=i}}function Kt(e,t,n,r){if(Ht){var a=Yt(e,t,n,r);if(null===a)Hr(e,t,r,Xt,n),Lt(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return It=Pt(It,e,t,n,r,a),!0;case"dragenter":return Tt=Pt(Tt,e,t,n,r,a),!0;case"mouseover":return At=Pt(At,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return Rt.set(i,Pt(Rt.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,Dt.set(i,Pt(Dt.get(i)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(Lt(e,r),4&t&&-1<Ot.indexOf(e)){for(;null!==a;){var i=xa(a);if(null!==i&&wt(i),null===(i=Yt(e,t,n,r))&&Hr(e,t,r,Xt,n),i===a)break;a=i}null!==a&&r.stopPropagation()}else Hr(e,t,r,null,n)}}var Xt=null;function Yt(e,t,n,r){if(Xt=null,null!==(e=ba(e=we(r))))if(null===(t=Ue(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ve(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Xt=e,null}function $t(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qe()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Jt=null,Qt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Qt,r=n.length,a="value"in Jt?Jt.value:Jt.textContent,i=a.length;for(e=0;e<r&&n[e]===a[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===a[i-t];t++);return Zt=a.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,a,i){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(a):a[o]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return M(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,sn,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=an(cn),hn=M({},cn,{view:0,detail:0}),dn=an(hn),fn=M({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(on=e.screenX-ln.screenX,sn=e.screenY-ln.screenY):sn=on=0,ln=e),on)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),pn=an(fn),gn=an(M({},fn,{dataTransfer:0})),mn=an(M({},hn,{relatedTarget:0})),vn=an(M({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),bn=M({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),xn=an(bn),yn=an(M({},cn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Nn[e])&&!!t[e]}function Cn(){return Sn}var En=M({},hn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?kn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),_n=an(En),In=an(M({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Tn=an(M({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cn})),An=an(M({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Rn=M({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Dn=an(Rn),Fn=[9,13,27,32],On=u&&"CompositionEvent"in window,Ln=null;u&&"documentMode"in document&&(Ln=document.documentMode);var Pn=u&&"TextEvent"in window&&!Ln,Mn=u&&(!On||Ln&&8<Ln&&11>=Ln),jn=String.fromCharCode(32),Bn=!1;function zn(e,t){switch(e){case"keyup":return-1!==Fn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Un=!1;var Vn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Vn[e.type]:"textarea"===t}function Gn(e,t,n,r){Ee(r),0<(t=qr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var qn=null,Kn=null;function Xn(e){jr(e,0)}function Yn(e){if(K(ya(e)))return e}function $n(e,t){if("change"===e)return t}var Jn=!1;if(u){var Qn;if(u){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Qn=Zn}else Qn=!1;Jn=Qn&&(!document.documentMode||9<document.documentMode)}function tr(){qn&&(qn.detachEvent("onpropertychange",nr),Kn=qn=null)}function nr(e){if("value"===e.propertyName&&Yn(Kn)){var t=[];Gn(t,Kn,e,we(e)),Re(Xn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Kn=n,(qn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ar(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(Kn)}function ir(e,t){if("click"===e)return Yn(t)}function or(e,t){if("input"===e||"change"===e)return Yn(t)}var sr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(sr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!h.call(t,a)||!sr(e[a],t[a]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function hr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function dr(){for(var e=window,t=X();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=X((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=dr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=void 0===r.end?i:Math.min(r.end,a),!e.extend&&i>r&&(a=r,r=i,i=a),a=ur(n,i);var o=ur(n,r);a&&o&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var gr=u&&"documentMode"in document&&11>=document.documentMode,mr=null,vr=null,br=null,xr=!1;function yr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;xr||null==mr||mr!==X(r)||("selectionStart"in(r=mr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},br&&lr(br,r)||(br=r,0<(r=qr(vr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=mr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var kr={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},Nr={},Sr={};function Cr(e){if(Nr[e])return Nr[e];if(!kr[e])return e;var t,n=kr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Sr)return Nr[e]=n[t];return e}u&&(Sr=document.createElement("div").style,"AnimationEvent"in window||(delete kr.animationend.animation,delete kr.animationiteration.animation,delete kr.animationstart.animation),"TransitionEvent"in window||delete kr.transitionend.transition);var Er=Cr("animationend"),_r=Cr("animationiteration"),Ir=Cr("animationstart"),Tr=Cr("transitionend"),Ar=new Map,Rr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Dr(e,t){Ar.set(e,t),l(t,[e])}for(var Fr=0;Fr<Rr.length;Fr++){var Or=Rr[Fr];Dr(Or.toLowerCase(),"on"+(Or[0].toUpperCase()+Or.slice(1)))}Dr(Er,"onAnimationEnd"),Dr(_r,"onAnimationIteration"),Dr(Ir,"onAnimationStart"),Dr("dblclick","onDoubleClick"),Dr("focusin","onFocus"),Dr("focusout","onBlur"),Dr(Tr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Pr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lr));function Mr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,o,s,l,c){if(We.apply(this,arguments),Pe){if(!Pe)throw Error(i(198));var u=Me;Pe=!1,Me=null,je||(je=!0,Be=u)}}(r,t,void 0,e),e.currentTarget=null}function jr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var s=r[o],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==i&&a.isPropagationStopped())break e;Mr(a,s,c),i=l}else for(o=0;o<r.length;o++){if(l=(s=r[o]).instance,c=s.currentTarget,s=s.listener,l!==i&&a.isPropagationStopped())break e;Mr(a,s,c),i=l}}}if(je)throw e=Be,je=!1,Be=null,e}function Br(e,t){var n=t[ga];void 0===n&&(n=t[ga]=new Set);var r=e+"__bubble";n.has(r)||(Vr(t,e,2,!1),n.add(r))}function zr(e,t,n){var r=0;t&&(r|=4),Vr(n,e,r,t)}var Wr="_reactListening"+Math.random().toString(36).slice(2);function Ur(e){if(!e[Wr]){e[Wr]=!0,o.forEach(function(t){"selectionchange"!==t&&(Pr.has(t)||zr(t,!1,e),zr(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Wr]||(t[Wr]=!0,zr("selectionchange",!1,t))}}function Vr(e,t,n,r){switch($t(t)){case 1:var a=Gt;break;case 4:a=qt;break;default:a=Kt}n=a.bind(null,t,n,e),a=void 0,!Fe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Hr(e,t,n,r,a){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var s=r.stateNode.containerInfo;if(s===a||8===s.nodeType&&s.parentNode===a)break;if(4===o)for(o=r.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===a||8===l.nodeType&&l.parentNode===a))return;o=o.return}for(;null!==s;){if(null===(o=ba(s)))return;if(5===(l=o.tag)||6===l){r=i=o;continue e}s=s.parentNode}}r=r.return}Re(function(){var r=i,a=we(n),o=[];e:{var s=Ar.get(e);if(void 0!==s){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=_n;break;case"focusin":c="focus",l=mn;break;case"focusout":c="blur",l=mn;break;case"beforeblur":case"afterblur":l=mn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=gn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Tn;break;case Er:case _r:case Ir:l=vn;break;case Tr:l=An;break;case"scroll":l=dn;break;case"wheel":l=Dn;break;case"copy":case"cut":case"paste":l=xn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=In}var u=0!==(4&t),h=!u&&"scroll"===e,d=u?null!==s?s+"Capture":null:s;u=[];for(var f,p=r;null!==p;){var g=(f=p).stateNode;if(5===f.tag&&null!==g&&(f=g,null!==d&&(null!=(g=De(p,d))&&u.push(Gr(p,g,f)))),h)break;p=p.return}0<u.length&&(s=new l(s,c,null,n,a),o.push({event:s,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===ye||!(c=n.relatedTarget||n.fromElement)||!ba(c)&&!c[pa])&&(l||s)&&(s=a.window===a?a:(s=a.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?ba(c):null)&&(c!==(h=Ue(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=pn,g="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=In,g="onPointerLeave",d="onPointerEnter",p="pointer"),h=null==l?s:ya(l),f=null==c?s:ya(c),(s=new u(g,p+"leave",l,n,a)).target=h,s.relatedTarget=f,g=null,ba(a)===r&&((u=new u(d,p+"enter",c,n,a)).target=f,u.relatedTarget=h,g=u),h=g,l&&c)e:{for(d=c,p=0,f=u=l;f;f=Kr(f))p++;for(f=0,g=d;g;g=Kr(g))f++;for(;0<p-f;)u=Kr(u),p--;for(;0<f-p;)d=Kr(d),f--;for(;p--;){if(u===d||null!==d&&u===d.alternate)break e;u=Kr(u),d=Kr(d)}u=null}else u=null;null!==l&&Xr(o,s,l,u,!1),null!==c&&null!==h&&Xr(o,h,c,u,!0)}if("select"===(l=(s=r?ya(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var m=$n;else if(Hn(s))if(Jn)m=or;else{m=ar;var v=rr}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(m=ir);switch(m&&(m=m(e,r))?Gn(o,m,n,a):(v&&v(e,s,r),"focusout"===e&&(v=s._wrapperState)&&v.controlled&&"number"===s.type&&ee(s,"number",s.value)),v=r?ya(r):window,e){case"focusin":(Hn(v)||"true"===v.contentEditable)&&(mr=v,vr=r,br=null);break;case"focusout":br=vr=mr=null;break;case"mousedown":xr=!0;break;case"contextmenu":case"mouseup":case"dragend":xr=!1,yr(o,n,a);break;case"selectionchange":if(gr)break;case"keydown":case"keyup":yr(o,n,a)}var b;if(On)e:{switch(e){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else Un?zn(e,n)&&(x="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(x="onCompositionStart");x&&(Mn&&"ko"!==n.locale&&(Un||"onCompositionStart"!==x?"onCompositionEnd"===x&&Un&&(b=en()):(Qt="value"in(Jt=a)?Jt.value:Jt.textContent,Un=!0)),0<(v=qr(r,x)).length&&(x=new yn(x,e,null,n,a),o.push({event:x,listeners:v}),b?x.data=b:null!==(b=Wn(n))&&(x.data=b))),(b=Pn?function(e,t){switch(e){case"compositionend":return Wn(t);case"keypress":return 32!==t.which?null:(Bn=!0,jn);case"textInput":return(e=t.data)===jn&&Bn?null:e;default:return null}}(e,n):function(e,t){if(Un)return"compositionend"===e||!On&&zn(e,t)?(e=en(),Zt=Qt=Jt=null,Un=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Mn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=qr(r,"onBeforeInput")).length&&(a=new yn("onBeforeInput","beforeinput",null,n,a),o.push({event:a,listeners:r}),a.data=b))}jr(o,t)})}function Gr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function qr(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,i=a.stateNode;5===a.tag&&null!==i&&(a=i,null!=(i=De(e,n))&&r.unshift(Gr(e,i,a)),null!=(i=De(e,t))&&r.push(Gr(e,i,a))),e=e.return}return r}function Kr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Xr(e,t,n,r,a){for(var i=t._reactName,o=[];null!==n&&n!==r;){var s=n,l=s.alternate,c=s.stateNode;if(null!==l&&l===r)break;5===s.tag&&null!==c&&(s=c,a?null!=(l=De(n,i))&&o.unshift(Gr(n,l,s)):a||null!=(l=De(n,i))&&o.push(Gr(n,l,s))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Yr=/\r\n?/g,$r=/\u0000|\uFFFD/g;function Jr(e){return("string"===typeof e?e:""+e).replace(Yr,"\n").replace($r,"")}function Qr(e,t,n){if(t=Jr(t),Jr(e)!==t&&n)throw Error(i(425))}function Zr(){}var ea=null,ta=null;function na(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ra="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,ia="function"===typeof Promise?Promise:void 0,oa="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ia?function(e){return ia.resolve(null).then(e).catch(sa)}:ra;function sa(e){setTimeout(function(){throw e})}function la(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===r)return e.removeChild(a),void Ut(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=a}while(n);Ut(t)}function ca(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ua(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ha=Math.random().toString(36).slice(2),da="__reactFiber$"+ha,fa="__reactProps$"+ha,pa="__reactContainer$"+ha,ga="__reactEvents$"+ha,ma="__reactListeners$"+ha,va="__reactHandles$"+ha;function ba(e){var t=e[da];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pa]||n[da]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ua(e);null!==e;){if(n=e[da])return n;e=ua(e)}return t}n=(e=n).parentNode}return null}function xa(e){return!(e=e[da]||e[pa])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function ya(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function wa(e){return e[fa]||null}var ka=[],Na=-1;function Sa(e){return{current:e}}function Ca(e){0>Na||(e.current=ka[Na],ka[Na]=null,Na--)}function Ea(e,t){Na++,ka[Na]=e.current,e.current=t}var _a={},Ia=Sa(_a),Ta=Sa(!1),Aa=_a;function Ra(e,t){var n=e.type.contextTypes;if(!n)return _a;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,i={};for(a in n)i[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Da(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Fa(){Ca(Ta),Ca(Ia)}function Oa(e,t,n){if(Ia.current!==_a)throw Error(i(168));Ea(Ia,t),Ea(Ta,n)}function La(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in t))throw Error(i(108,V(e)||"Unknown",a));return M({},n,r)}function Pa(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||_a,Aa=Ia.current,Ea(Ia,e),Ea(Ta,Ta.current),!0}function Ma(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=La(e,t,Aa),r.__reactInternalMemoizedMergedChildContext=e,Ca(Ta),Ca(Ia),Ea(Ia,e)):Ca(Ta),Ea(Ta,n)}var ja=null,Ba=!1,za=!1;function Wa(e){null===ja?ja=[e]:ja.push(e)}function Ua(){if(!za&&null!==ja){za=!0;var e=0,t=xt;try{var n=ja;for(xt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}ja=null,Ba=!1}catch(a){throw null!==ja&&(ja=ja.slice(e+1)),Ke(Ze,Ua),a}finally{xt=t,za=!1}}return null}var Va=[],Ha=0,Ga=null,qa=0,Ka=[],Xa=0,Ya=null,$a=1,Ja="";function Qa(e,t){Va[Ha++]=qa,Va[Ha++]=Ga,Ga=e,qa=t}function Za(e,t,n){Ka[Xa++]=$a,Ka[Xa++]=Ja,Ka[Xa++]=Ya,Ya=e;var r=$a;e=Ja;var a=32-ot(r)-1;r&=~(1<<a),n+=1;var i=32-ot(t)+a;if(30<i){var o=a-a%5;i=(r&(1<<o)-1).toString(32),r>>=o,a-=o,$a=1<<32-ot(t)+a|n<<a|r,Ja=i+e}else $a=1<<i|n<<a|r,Ja=e}function ei(e){null!==e.return&&(Qa(e,1),Za(e,1,0))}function ti(e){for(;e===Ga;)Ga=Va[--Ha],Va[Ha]=null,qa=Va[--Ha],Va[Ha]=null;for(;e===Ya;)Ya=Ka[--Xa],Ka[Xa]=null,Ja=Ka[--Xa],Ka[Xa]=null,$a=Ka[--Xa],Ka[Xa]=null}var ni=null,ri=null,ai=!1,ii=null;function oi(e,t){var n=Rc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function si(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ni=e,ri=ca(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ni=e,ri=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Ya?{id:$a,overflow:Ja}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Rc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ni=e,ri=null,!0);default:return!1}}function li(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ci(e){if(ai){var t=ri;if(t){var n=t;if(!si(e,t)){if(li(e))throw Error(i(418));t=ca(n.nextSibling);var r=ni;t&&si(e,t)?oi(r,n):(e.flags=-4097&e.flags|2,ai=!1,ni=e)}}else{if(li(e))throw Error(i(418));e.flags=-4097&e.flags|2,ai=!1,ni=e}}}function ui(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ni=e}function hi(e){if(e!==ni)return!1;if(!ai)return ui(e),ai=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!na(e.type,e.memoizedProps)),t&&(t=ri)){if(li(e))throw di(),Error(i(418));for(;t;)oi(e,t),t=ca(t.nextSibling)}if(ui(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ri=ca(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ri=null}}else ri=ni?ca(e.stateNode.nextSibling):null;return!0}function di(){for(var e=ri;e;)e=ca(e.nextSibling)}function fi(){ri=ni=null,ai=!1}function pi(e){null===ii?ii=[e]:ii.push(e)}var gi=y.ReactCurrentBatchConfig;function mi(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var a=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=a.refs;null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function vi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function bi(e){return(0,e._init)(e._payload)}function xi(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Fc(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Mc(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function c(e,t,n,r){var i=n.type;return i===N?h(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===D&&bi(i)===t.type)?((r=a(t,n.props)).ref=mi(e,t,n),r.return=e,r):((r=Oc(n.type,n.key,n.props,null,e.mode,r)).ref=mi(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=jc(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function h(e,t,n,r,i){return null===t||7!==t.tag?((t=Lc(n,e.mode,r,i)).return=e,t):((t=a(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Mc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Oc(t.type,t.key,t.props,null,e.mode,n)).ref=mi(e,null,t),n.return=e,n;case k:return(t=jc(t,e.mode,n)).return=e,t;case D:return d(e,(0,t._init)(t._payload),n)}if(te(t)||L(t))return(t=Lc(t,e.mode,n,null)).return=e,t;vi(e,t)}return null}function f(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==a?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===a?c(e,t,n,r):null;case k:return n.key===a?u(e,t,n,r):null;case D:return f(e,t,(a=n._init)(n._payload),r)}if(te(n)||L(n))return null!==a?null:h(e,t,n,r,null);vi(e,n)}return null}function p(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a);case k:return u(t,e=e.get(null===r.key?n:r.key)||null,r,a);case D:return p(e,t,n,(0,r._init)(r._payload),a)}if(te(r)||L(r))return h(t,e=e.get(n)||null,r,a,null);vi(t,r)}return null}function g(a,i,s,l){for(var c=null,u=null,h=i,g=i=0,m=null;null!==h&&g<s.length;g++){h.index>g?(m=h,h=null):m=h.sibling;var v=f(a,h,s[g],l);if(null===v){null===h&&(h=m);break}e&&h&&null===v.alternate&&t(a,h),i=o(v,i,g),null===u?c=v:u.sibling=v,u=v,h=m}if(g===s.length)return n(a,h),ai&&Qa(a,g),c;if(null===h){for(;g<s.length;g++)null!==(h=d(a,s[g],l))&&(i=o(h,i,g),null===u?c=h:u.sibling=h,u=h);return ai&&Qa(a,g),c}for(h=r(a,h);g<s.length;g++)null!==(m=p(h,a,g,s[g],l))&&(e&&null!==m.alternate&&h.delete(null===m.key?g:m.key),i=o(m,i,g),null===u?c=m:u.sibling=m,u=m);return e&&h.forEach(function(e){return t(a,e)}),ai&&Qa(a,g),c}function m(a,s,l,c){var u=L(l);if("function"!==typeof u)throw Error(i(150));if(null==(l=u.call(l)))throw Error(i(151));for(var h=u=null,g=s,m=s=0,v=null,b=l.next();null!==g&&!b.done;m++,b=l.next()){g.index>m?(v=g,g=null):v=g.sibling;var x=f(a,g,b.value,c);if(null===x){null===g&&(g=v);break}e&&g&&null===x.alternate&&t(a,g),s=o(x,s,m),null===h?u=x:h.sibling=x,h=x,g=v}if(b.done)return n(a,g),ai&&Qa(a,m),u;if(null===g){for(;!b.done;m++,b=l.next())null!==(b=d(a,b.value,c))&&(s=o(b,s,m),null===h?u=b:h.sibling=b,h=b);return ai&&Qa(a,m),u}for(g=r(a,g);!b.done;m++,b=l.next())null!==(b=p(g,a,m,b.value,c))&&(e&&null!==b.alternate&&g.delete(null===b.key?m:b.key),s=o(b,s,m),null===h?u=b:h.sibling=b,h=b);return e&&g.forEach(function(e){return t(a,e)}),ai&&Qa(a,m),u}return function e(r,i,o,l){if("object"===typeof o&&null!==o&&o.type===N&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case w:e:{for(var c=o.key,u=i;null!==u;){if(u.key===c){if((c=o.type)===N){if(7===u.tag){n(r,u.sibling),(i=a(u,o.props.children)).return=r,r=i;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===D&&bi(c)===u.type){n(r,u.sibling),(i=a(u,o.props)).ref=mi(r,u,o),i.return=r,r=i;break e}n(r,u);break}t(r,u),u=u.sibling}o.type===N?((i=Lc(o.props.children,r.mode,l,o.key)).return=r,r=i):((l=Oc(o.type,o.key,o.props,null,r.mode,l)).ref=mi(r,i,o),l.return=r,r=l)}return s(r);case k:e:{for(u=o.key;null!==i;){if(i.key===u){if(4===i.tag&&i.stateNode.containerInfo===o.containerInfo&&i.stateNode.implementation===o.implementation){n(r,i.sibling),(i=a(i,o.children||[])).return=r,r=i;break e}n(r,i);break}t(r,i),i=i.sibling}(i=jc(o,r.mode,l)).return=r,r=i}return s(r);case D:return e(r,i,(u=o._init)(o._payload),l)}if(te(o))return g(r,i,o,l);if(L(o))return m(r,i,o,l);vi(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==i&&6===i.tag?(n(r,i.sibling),(i=a(i,o)).return=r,r=i):(n(r,i),(i=Mc(o,r.mode,l)).return=r,r=i),s(r)):n(r,i)}}var yi=xi(!0),wi=xi(!1),ki=Sa(null),Ni=null,Si=null,Ci=null;function Ei(){Ci=Si=Ni=null}function _i(e){var t=ki.current;Ca(ki),e._currentValue=t}function Ii(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ti(e,t){Ni=e,Ci=Si=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(xs=!0),e.firstContext=null)}function Ai(e){var t=e._currentValue;if(Ci!==e)if(e={context:e,memoizedValue:t,next:null},null===Si){if(null===Ni)throw Error(i(308));Si=e,Ni.dependencies={lanes:0,firstContext:e}}else Si=Si.next=e;return t}var Ri=null;function Di(e){null===Ri?Ri=[e]:Ri.push(e)}function Fi(e,t,n,r){var a=t.interleaved;return null===a?(n.next=n,Di(t)):(n.next=a.next,a.next=n),t.interleaved=n,Oi(e,r)}function Oi(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Li=!1;function Pi(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Mi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ji(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Bi(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Il)){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,Oi(e,n)}return null===(a=r.interleaved)?(t.next=t,Di(r)):(t.next=a.next,a.next=t),r.interleaved=t,Oi(e,n)}function zi(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,bt(e,n)}}function Wi(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?a=i=o:i=i.next=o,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ui(e,t,n,r){var a=e.updateQueue;Li=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,s=a.shared.pending;if(null!==s){a.shared.pending=null;var l=s,c=l.next;l.next=null,null===o?i=c:o.next=c,o=l;var u=e.alternate;null!==u&&((s=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===s?u.firstBaseUpdate=c:s.next=c,u.lastBaseUpdate=l))}if(null!==i){var h=a.baseState;for(o=0,u=c=l=null,s=i;;){var d=s.lane,f=s.eventTime;if((r&d)===d){null!==u&&(u=u.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var p=e,g=s;switch(d=t,f=n,g.tag){case 1:if("function"===typeof(p=g.payload)){h=p.call(f,h,d);break e}h=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(d="function"===typeof(p=g.payload)?p.call(f,h,d):p)||void 0===d)break e;h=M({},h,d);break e;case 2:Li=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(d=a.effects)?a.effects=[s]:d.push(s))}else f={eventTime:f,lane:d,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(c=u=f,l=h):u=u.next=f,o|=d;if(null===(s=s.next)){if(null===(s=a.shared.pending))break;s=(d=s).next,d.next=null,a.lastBaseUpdate=d,a.shared.pending=null}}if(null===u&&(l=h),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,null!==(t=a.shared.interleaved)){a=t;do{o|=a.lane,a=a.next}while(a!==t)}else null===i&&(a.shared.lanes=0);Pl|=o,e.lanes=o,e.memoizedState=h}}function Vi(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(i(191,a));a.call(r)}}}var Hi={},Gi=Sa(Hi),qi=Sa(Hi),Ki=Sa(Hi);function Xi(e){if(e===Hi)throw Error(i(174));return e}function Yi(e,t){switch(Ea(Ki,t),Ea(qi,e),Ea(Gi,Hi),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ca(Gi),Ea(Gi,t)}function $i(){Ca(Gi),Ca(qi),Ca(Ki)}function Ji(e){Xi(Ki.current);var t=Xi(Gi.current),n=le(t,e.type);t!==n&&(Ea(qi,e),Ea(Gi,n))}function Qi(e){qi.current===e&&(Ca(Gi),Ca(qi))}var Zi=Sa(0);function eo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var to=[];function no(){for(var e=0;e<to.length;e++)to[e]._workInProgressVersionPrimary=null;to.length=0}var ro=y.ReactCurrentDispatcher,ao=y.ReactCurrentBatchConfig,io=0,oo=null,so=null,lo=null,co=!1,uo=!1,ho=0,fo=0;function po(){throw Error(i(321))}function go(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function mo(e,t,n,r,a,o){if(io=o,oo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ro.current=null===e||null===e.memoizedState?Zo:es,e=n(r,a),uo){o=0;do{if(uo=!1,ho=0,25<=o)throw Error(i(301));o+=1,lo=so=null,t.updateQueue=null,ro.current=ts,e=n(r,a)}while(uo)}if(ro.current=Qo,t=null!==so&&null!==so.next,io=0,lo=so=oo=null,co=!1,t)throw Error(i(300));return e}function vo(){var e=0!==ho;return ho=0,e}function bo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===lo?oo.memoizedState=lo=e:lo=lo.next=e,lo}function xo(){if(null===so){var e=oo.alternate;e=null!==e?e.memoizedState:null}else e=so.next;var t=null===lo?oo.memoizedState:lo.next;if(null!==t)lo=t,so=e;else{if(null===e)throw Error(i(310));e={memoizedState:(so=e).memoizedState,baseState:so.baseState,baseQueue:so.baseQueue,queue:so.queue,next:null},null===lo?oo.memoizedState=lo=e:lo=lo.next=e}return lo}function yo(e,t){return"function"===typeof t?t(e):t}function wo(e){var t=xo(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=so,a=r.baseQueue,o=n.pending;if(null!==o){if(null!==a){var s=a.next;a.next=o.next,o.next=s}r.baseQueue=a=o,n.pending=null}if(null!==a){o=a.next,r=r.baseState;var l=s=null,c=null,u=o;do{var h=u.lane;if((io&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,s=r):c=c.next=d,oo.lanes|=h,Pl|=h}u=u.next}while(null!==u&&u!==o);null===c?s=r:c.next=l,sr(r,t.memoizedState)||(xs=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){a=e;do{o=a.lane,oo.lanes|=o,Pl|=o,a=a.next}while(a!==e)}else null===a&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function ko(e){var t=xo(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,o=t.memoizedState;if(null!==a){n.pending=null;var s=a=a.next;do{o=e(o,s.action),s=s.next}while(s!==a);sr(o,t.memoizedState)||(xs=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function No(){}function So(e,t){var n=oo,r=xo(),a=t(),o=!sr(r.memoizedState,a);if(o&&(r.memoizedState=a,xs=!0),r=r.queue,Po(_o.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==lo&&1&lo.memoizedState.tag){if(n.flags|=2048,Ro(9,Eo.bind(null,n,r,a,t),void 0,null),null===Tl)throw Error(i(349));0!==(30&io)||Co(n,t,a)}return a}function Co(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Eo(e,t,n,r){t.value=n,t.getSnapshot=r,Io(t)&&To(e)}function _o(e,t,n){return n(function(){Io(t)&&To(e)})}function Io(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch(r){return!0}}function To(e){var t=Oi(e,1);null!==t&&nc(t,e,1,-1)}function Ao(e){var t=bo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:yo,lastRenderedState:e},t.queue=e,e=e.dispatch=Xo.bind(null,oo,e),[t.memoizedState,e]}function Ro(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Do(){return xo().memoizedState}function Fo(e,t,n,r){var a=bo();oo.flags|=e,a.memoizedState=Ro(1|t,n,void 0,void 0===r?null:r)}function Oo(e,t,n,r){var a=xo();r=void 0===r?null:r;var i=void 0;if(null!==so){var o=so.memoizedState;if(i=o.destroy,null!==r&&go(r,o.deps))return void(a.memoizedState=Ro(t,n,i,r))}oo.flags|=e,a.memoizedState=Ro(1|t,n,i,r)}function Lo(e,t){return Fo(8390656,8,e,t)}function Po(e,t){return Oo(2048,8,e,t)}function Mo(e,t){return Oo(4,2,e,t)}function jo(e,t){return Oo(4,4,e,t)}function Bo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function zo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Oo(4,4,Bo.bind(null,t,e),n)}function Wo(){}function Uo(e,t){var n=xo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&go(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Vo(e,t){var n=xo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&go(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Ho(e,t,n){return 0===(21&io)?(e.baseState&&(e.baseState=!1,xs=!0),e.memoizedState=n):(sr(n,t)||(n=gt(),oo.lanes|=n,Pl|=n,e.baseState=!0),t)}function Go(e,t){var n=xt;xt=0!==n&&4>n?n:4,e(!0);var r=ao.transition;ao.transition={};try{e(!1),t()}finally{xt=n,ao.transition=r}}function qo(){return xo().memoizedState}function Ko(e,t,n){var r=tc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Yo(e))$o(t,n);else if(null!==(n=Fi(e,t,n,r))){nc(n,e,r,ec()),Jo(n,t,r)}}function Xo(e,t,n){var r=tc(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Yo(e))$o(t,a);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var o=t.lastRenderedState,s=i(o,n);if(a.hasEagerState=!0,a.eagerState=s,sr(s,o)){var l=t.interleaved;return null===l?(a.next=a,Di(t)):(a.next=l.next,l.next=a),void(t.interleaved=a)}}catch(c){}null!==(n=Fi(e,t,a,r))&&(nc(n,e,r,a=ec()),Jo(n,t,r))}}function Yo(e){var t=e.alternate;return e===oo||null!==t&&t===oo}function $o(e,t){uo=co=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Jo(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,bt(e,n)}}var Qo={readContext:Ai,useCallback:po,useContext:po,useEffect:po,useImperativeHandle:po,useInsertionEffect:po,useLayoutEffect:po,useMemo:po,useReducer:po,useRef:po,useState:po,useDebugValue:po,useDeferredValue:po,useTransition:po,useMutableSource:po,useSyncExternalStore:po,useId:po,unstable_isNewReconciler:!1},Zo={readContext:Ai,useCallback:function(e,t){return bo().memoizedState=[e,void 0===t?null:t],e},useContext:Ai,useEffect:Lo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Fo(4194308,4,Bo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Fo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Fo(4,2,e,t)},useMemo:function(e,t){var n=bo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=bo();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Ko.bind(null,oo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},bo().memoizedState=e},useState:Ao,useDebugValue:Wo,useDeferredValue:function(e){return bo().memoizedState=e},useTransition:function(){var e=Ao(!1),t=e[0];return e=Go.bind(null,e[1]),bo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=oo,a=bo();if(ai){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===Tl)throw Error(i(349));0!==(30&io)||Co(r,t,n)}a.memoizedState=n;var o={value:n,getSnapshot:t};return a.queue=o,Lo(_o.bind(null,r,o,e),[e]),r.flags|=2048,Ro(9,Eo.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=bo(),t=Tl.identifierPrefix;if(ai){var n=Ja;t=":"+t+"R"+(n=($a&~(1<<32-ot($a)-1)).toString(32)+n),0<(n=ho++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=fo++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},es={readContext:Ai,useCallback:Uo,useContext:Ai,useEffect:Po,useImperativeHandle:zo,useInsertionEffect:Mo,useLayoutEffect:jo,useMemo:Vo,useReducer:wo,useRef:Do,useState:function(){return wo(yo)},useDebugValue:Wo,useDeferredValue:function(e){return Ho(xo(),so.memoizedState,e)},useTransition:function(){return[wo(yo)[0],xo().memoizedState]},useMutableSource:No,useSyncExternalStore:So,useId:qo,unstable_isNewReconciler:!1},ts={readContext:Ai,useCallback:Uo,useContext:Ai,useEffect:Po,useImperativeHandle:zo,useInsertionEffect:Mo,useLayoutEffect:jo,useMemo:Vo,useReducer:ko,useRef:Do,useState:function(){return ko(yo)},useDebugValue:Wo,useDeferredValue:function(e){var t=xo();return null===so?t.memoizedState=e:Ho(t,so.memoizedState,e)},useTransition:function(){return[ko(yo)[0],xo().memoizedState]},useMutableSource:No,useSyncExternalStore:So,useId:qo,unstable_isNewReconciler:!1};function ns(e,t){if(e&&e.defaultProps){for(var n in t=M({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function rs(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:M({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var as={isMounted:function(e){return!!(e=e._reactInternals)&&Ue(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ec(),a=tc(e),i=ji(r,a);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Bi(e,i,a))&&(nc(t,e,a,r),zi(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ec(),a=tc(e),i=ji(r,a);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Bi(e,i,a))&&(nc(t,e,a,r),zi(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),r=tc(e),a=ji(n,r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=Bi(e,a,r))&&(nc(t,e,r,n),zi(t,e,r))}};function is(e,t,n,r,a,i,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,o):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(a,i))}function os(e,t,n){var r=!1,a=_a,i=t.contextType;return"object"===typeof i&&null!==i?i=Ai(i):(a=Da(t)?Aa:Ia.current,i=(r=null!==(r=t.contextTypes)&&void 0!==r)?Ra(e,a):_a),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=as,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function ss(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&as.enqueueReplaceState(t,t.state,null)}function ls(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},Pi(e);var i=t.contextType;"object"===typeof i&&null!==i?a.context=Ai(i):(i=Da(t)?Aa:Ia.current,a.context=Ra(e,i)),a.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(rs(e,t,i,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&as.enqueueReplaceState(a,a.state,null),Ui(e,n,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function cs(e,t){try{var n="",r=t;do{n+=W(r),r=r.return}while(r);var a=n}catch(i){a="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:a,digest:null}}function us(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function hs(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var ds="function"===typeof WeakMap?WeakMap:Map;function fs(e,t,n){(n=ji(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Hl||(Hl=!0,Gl=r),hs(0,t)},n}function ps(e,t,n){(n=ji(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){hs(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){hs(0,t),"function"!==typeof r&&(null===ql?ql=new Set([this]):ql.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function gs(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ds;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=Cc.bind(null,e,t,n),t.then(e,e))}function ms(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vs(e,t,n,r,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=ji(-1,1)).tag=2,Bi(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var bs=y.ReactCurrentOwner,xs=!1;function ys(e,t,n,r){t.child=null===e?wi(t,null,n,r):yi(t,e.child,n,r)}function ws(e,t,n,r,a){n=n.render;var i=t.ref;return Ti(t,a),r=mo(e,t,n,r,i,a),n=vo(),null===e||xs?(ai&&n&&ei(t),t.flags|=1,ys(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Hs(e,t,a))}function ks(e,t,n,r,a){if(null===e){var i=n.type;return"function"!==typeof i||Dc(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Oc(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Ns(e,t,i,r,a))}if(i=e.child,0===(e.lanes&a)){var o=i.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(o,r)&&e.ref===t.ref)return Hs(e,t,a)}return t.flags|=1,(e=Fc(i,r)).ref=t.ref,e.return=t,t.child=e}function Ns(e,t,n,r,a){if(null!==e){var i=e.memoizedProps;if(lr(i,r)&&e.ref===t.ref){if(xs=!1,t.pendingProps=r=i,0===(e.lanes&a))return t.lanes=e.lanes,Hs(e,t,a);0!==(131072&e.flags)&&(xs=!0)}}return Es(e,t,n,r,a)}function Ss(e,t,n){var r=t.pendingProps,a=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ea(Fl,Dl),Dl|=n;else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ea(Fl,Dl),Dl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==i?i.baseLanes:n,Ea(Fl,Dl),Dl|=r}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,Ea(Fl,Dl),Dl|=r;return ys(e,t,a,n),t.child}function Cs(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Es(e,t,n,r,a){var i=Da(n)?Aa:Ia.current;return i=Ra(t,i),Ti(t,a),n=mo(e,t,n,r,i,a),r=vo(),null===e||xs?(ai&&r&&ei(t),t.flags|=1,ys(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Hs(e,t,a))}function _s(e,t,n,r,a){if(Da(n)){var i=!0;Pa(t)}else i=!1;if(Ti(t,a),null===t.stateNode)Vs(e,t),os(t,n,r),ls(t,n,r,a),r=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var l=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ai(c):c=Ra(t,c=Da(n)?Aa:Ia.current);var u=n.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==r||l!==c)&&ss(t,o,r,c),Li=!1;var d=t.memoizedState;o.state=d,Ui(t,r,o,a),l=t.memoizedState,s!==r||d!==l||Ta.current||Li?("function"===typeof u&&(rs(t,n,u,r),l=t.memoizedState),(s=Li||is(t,n,s,r,d,l,c))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),o.props=r,o.state=l,o.context=c,r=s):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Mi(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:ns(t.type,s),o.props=c,h=t.pendingProps,d=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ai(l):l=Ra(t,l=Da(n)?Aa:Ia.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==h||d!==l)&&ss(t,o,r,l),Li=!1,d=t.memoizedState,o.state=d,Ui(t,r,o,a);var p=t.memoizedState;s!==h||d!==p||Ta.current||Li?("function"===typeof f&&(rs(t,n,f,r),p=t.memoizedState),(c=Li||is(t,n,c,r,d,p,l)||!1)?(u||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=l,r=c):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return Is(e,t,n,r,i,a)}function Is(e,t,n,r,a,i){Cs(e,t);var o=0!==(128&t.flags);if(!r&&!o)return a&&Ma(t,n,!1),Hs(e,t,i);r=t.stateNode,bs.current=t;var s=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=yi(t,e.child,null,i),t.child=yi(t,null,s,i)):ys(e,t,s,i),t.memoizedState=r.state,a&&Ma(t,n,!0),t.child}function Ts(e){var t=e.stateNode;t.pendingContext?Oa(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Oa(0,t.context,!1),Yi(e,t.containerInfo)}function As(e,t,n,r,a){return fi(),pi(a),t.flags|=256,ys(e,t,n,r),t.child}var Rs,Ds,Fs,Os,Ls={dehydrated:null,treeContext:null,retryLane:0};function Ps(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ms(e,t,n){var r,a=t.pendingProps,o=Zi.current,s=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Ea(Zi,1&o),null===e)return ci(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=a.children,e=a.fallback,s?(a=t.mode,s=t.child,l={mode:"hidden",children:l},0===(1&a)&&null!==s?(s.childLanes=0,s.pendingProps=l):s=Pc(l,a,0,null),e=Lc(e,a,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Ps(n),t.memoizedState=Ls,e):js(t,l));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,a,o,s){if(n)return 256&t.flags?(t.flags&=-257,Bs(e,t,s,r=us(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,a=t.mode,r=Pc({mode:"visible",children:r.children},a,0,null),(o=Lc(o,a,s,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&yi(t,e.child,null,s),t.child.memoizedState=Ps(s),t.memoizedState=Ls,o);if(0===(1&t.mode))return Bs(e,t,s,null);if("$!"===a.data){if(r=a.nextSibling&&a.nextSibling.dataset)var l=r.dgst;return r=l,Bs(e,t,s,r=us(o=Error(i(419)),r,void 0))}if(l=0!==(s&e.childLanes),xs||l){if(null!==(r=Tl)){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(r.suspendedLanes|s))?0:a)&&a!==o.retryLane&&(o.retryLane=a,Oi(e,a),nc(r,e,a,-1))}return gc(),Bs(e,t,s,r=us(Error(i(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=_c.bind(null,e),a._reactRetry=t,null):(e=o.treeContext,ri=ca(a.nextSibling),ni=t,ai=!0,ii=null,null!==e&&(Ka[Xa++]=$a,Ka[Xa++]=Ja,Ka[Xa++]=Ya,$a=e.id,Ja=e.overflow,Ya=t),t=js(t,r.children),t.flags|=4096,t)}(e,t,l,a,r,o,n);if(s){s=a.fallback,l=t.mode,r=(o=e.child).sibling;var c={mode:"hidden",children:a.children};return 0===(1&l)&&t.child!==o?((a=t.child).childLanes=0,a.pendingProps=c,t.deletions=null):(a=Fc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==r?s=Fc(r,s):(s=Lc(s,l,n,null)).flags|=2,s.return=t,a.return=t,a.sibling=s,t.child=a,a=s,s=t.child,l=null===(l=e.child.memoizedState)?Ps(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=e.childLanes&~n,t.memoizedState=Ls,a}return e=(s=e.child).sibling,a=Fc(s,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=n),a.return=t,a.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=a,t.memoizedState=null,a}function js(e,t){return(t=Pc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Bs(e,t,n,r){return null!==r&&pi(r),yi(t,e.child,null,n),(e=js(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function zs(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ii(e.return,t,n)}function Ws(e,t,n,r,a){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function Us(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(ys(e,t,r.children,n),0!==(2&(r=Zi.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&zs(e,n,t);else if(19===e.tag)zs(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ea(Zi,r),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===eo(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Ws(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===eo(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Ws(t,!0,n,null,i);break;case"together":Ws(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Vs(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Hs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Pl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Fc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Fc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Gs(e,t){if(!ai)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function qs(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=14680064&a.subtreeFlags,r|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ks(e,t,n){var r=t.pendingProps;switch(ti(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qs(t),null;case 1:case 17:return Da(t.type)&&Fa(),qs(t),null;case 3:return r=t.stateNode,$i(),Ca(Ta),Ca(Ia),no(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(hi(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ii&&(oc(ii),ii=null))),Ds(e,t),qs(t),null;case 5:Qi(t);var a=Xi(Ki.current);if(n=t.type,null!==e&&null!=t.stateNode)Fs(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(i(166));return qs(t),null}if(e=Xi(Gi.current),hi(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[da]=t,r[fa]=o,e=0!==(1&t.mode),n){case"dialog":Br("cancel",r),Br("close",r);break;case"iframe":case"object":case"embed":Br("load",r);break;case"video":case"audio":for(a=0;a<Lr.length;a++)Br(Lr[a],r);break;case"source":Br("error",r);break;case"img":case"image":case"link":Br("error",r),Br("load",r);break;case"details":Br("toggle",r);break;case"input":$(r,o),Br("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Br("invalid",r);break;case"textarea":ae(r,o),Br("invalid",r)}for(var l in be(n,o),a=null,o)if(o.hasOwnProperty(l)){var c=o[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==o.suppressHydrationWarning&&Qr(r.textContent,c,e),a=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Qr(r.textContent,c,e),a=["children",""+c]):s.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Br("scroll",r)}switch(n){case"input":q(r),Z(r,o,!0);break;case"textarea":q(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Zr)}r=a,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[da]=t,e[fa]=r,Rs(e,t,!1,!1),t.stateNode=e;e:{switch(l=xe(n,r),n){case"dialog":Br("cancel",e),Br("close",e),a=r;break;case"iframe":case"object":case"embed":Br("load",e),a=r;break;case"video":case"audio":for(a=0;a<Lr.length;a++)Br(Lr[a],e);a=r;break;case"source":Br("error",e),a=r;break;case"img":case"image":case"link":Br("error",e),Br("load",e),a=r;break;case"details":Br("toggle",e),a=r;break;case"input":$(e,r),a=Y(e,r),Br("invalid",e);break;case"option":default:a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=M({},r,{value:void 0}),Br("invalid",e);break;case"textarea":ae(e,r),a=re(e,r),Br("invalid",e)}for(o in be(n,a),c=a)if(c.hasOwnProperty(o)){var u=c[o];"style"===o?me(e,u):"dangerouslySetInnerHTML"===o?null!=(u=u?u.__html:void 0)&&he(e,u):"children"===o?"string"===typeof u?("textarea"!==n||""!==u)&&de(e,u):"number"===typeof u&&de(e,""+u):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(s.hasOwnProperty(o)?null!=u&&"onScroll"===o&&Br("scroll",e):null!=u&&x(e,o,u,l))}switch(n){case"input":q(e),Z(e,r,!1);break;case"textarea":q(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+H(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return qs(t),null;case 6:if(e&&null!=t.stateNode)Os(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));if(n=Xi(Ki.current),Xi(Gi.current),hi(t)){if(r=t.stateNode,n=t.memoizedProps,r[da]=t,(o=r.nodeValue!==n)&&null!==(e=ni))switch(e.tag){case 3:Qr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Qr(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[da]=t,t.stateNode=r}return qs(t),null;case 13:if(Ca(Zi),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ai&&null!==ri&&0!==(1&t.mode)&&0===(128&t.flags))di(),fi(),t.flags|=98560,o=!1;else if(o=hi(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(i(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(i(317));o[da]=t}else fi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;qs(t),o=!1}else null!==ii&&(oc(ii),ii=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Zi.current)?0===Ol&&(Ol=3):gc())),null!==t.updateQueue&&(t.flags|=4),qs(t),null);case 4:return $i(),Ds(e,t),null===e&&Ur(t.stateNode.containerInfo),qs(t),null;case 10:return _i(t.type._context),qs(t),null;case 19:if(Ca(Zi),null===(o=t.memoizedState))return qs(t),null;if(r=0!==(128&t.flags),null===(l=o.rendering))if(r)Gs(o,!1);else{if(0!==Ol||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=eo(e))){for(t.flags|=128,Gs(o,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ea(Zi,1&Zi.current|2),t.child}e=e.sibling}null!==o.tail&&Je()>Ul&&(t.flags|=128,r=!0,Gs(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=eo(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Gs(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!ai)return qs(t),null}else 2*Je()-o.renderingStartTime>Ul&&1073741824!==n&&(t.flags|=128,r=!0,Gs(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=o.last)?n.sibling=l:t.child=l,o.last=l)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Je(),t.sibling=null,n=Zi.current,Ea(Zi,r?1&n|2:1&n),t):(qs(t),null);case 22:case 23:return hc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Dl)&&(qs(t),6&t.subtreeFlags&&(t.flags|=8192)):qs(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Xs(e,t){switch(ti(t),t.tag){case 1:return Da(t.type)&&Fa(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return $i(),Ca(Ta),Ca(Ia),no(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Qi(t),null;case 13:if(Ca(Zi),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));fi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ca(Zi),null;case 4:return $i(),null;case 10:return _i(t.type._context),null;case 22:case 23:return hc(),null;default:return null}}Rs=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ds=function(){},Fs=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,Xi(Gi.current);var i,o=null;switch(n){case"input":a=Y(e,a),r=Y(e,r),o=[];break;case"select":a=M({},a,{value:void 0}),r=M({},r,{value:void 0}),o=[];break;case"textarea":a=re(e,a),r=re(e,r),o=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(u in be(n,r),n=null,a)if(!r.hasOwnProperty(u)&&a.hasOwnProperty(u)&&null!=a[u])if("style"===u){var l=a[u];for(i in l)l.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(s.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=a?a[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(i in l)!l.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&l[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(o||(o=[]),o.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(o=o||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(s.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Br("scroll",e),o||l===c||(o=[])):(o=o||[]).push(u,c))}n&&(o=o||[]).push("style",n);var u=o;(t.updateQueue=u)&&(t.flags|=4)}},Os=function(e,t,n,r){n!==r&&(t.flags|=4)};var Ys=!1,$s=!1,Js="function"===typeof WeakSet?WeakSet:Set,Qs=null;function Zs(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Sc(e,t,r)}else n.current=null}function el(e,t,n){try{n()}catch(r){Sc(e,t,r)}}var tl=!1;function nl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var a=r=r.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,void 0!==i&&el(t,n,i)}a=a.next}while(a!==r)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function al(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function il(e){var t=e.alternate;null!==t&&(e.alternate=null,il(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[da],delete t[fa],delete t[ga],delete t[ma],delete t[va])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ol(e){return 5===e.tag||3===e.tag||4===e.tag}function sl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ol(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var ul=null,hl=!1;function dl(e,t,n){for(n=n.child;null!==n;)fl(e,t,n),n=n.sibling}function fl(e,t,n){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(at,n)}catch(s){}switch(n.tag){case 5:$s||Zs(n,t);case 6:var r=ul,a=hl;ul=null,dl(e,t,n),hl=a,null!==(ul=r)&&(hl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(hl?(e=ul,n=n.stateNode,8===e.nodeType?la(e.parentNode,n):1===e.nodeType&&la(e,n),Ut(e)):la(ul,n.stateNode));break;case 4:r=ul,a=hl,ul=n.stateNode.containerInfo,hl=!0,dl(e,t,n),ul=r,hl=a;break;case 0:case 11:case 14:case 15:if(!$s&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){a=r=r.next;do{var i=a,o=i.destroy;i=i.tag,void 0!==o&&(0!==(2&i)||0!==(4&i))&&el(n,t,o),a=a.next}while(a!==r)}dl(e,t,n);break;case 1:if(!$s&&(Zs(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Sc(n,t,s)}dl(e,t,n);break;case 21:dl(e,t,n);break;case 22:1&n.mode?($s=(r=$s)||null!==n.memoizedState,dl(e,t,n),$s=r):dl(e,t,n);break;default:dl(e,t,n)}}function pl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Js),t.forEach(function(t){var r=Ic.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}function gl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r];try{var o=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,hl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===ul)throw Error(i(160));fl(o,s,a),ul=null,hl=!1;var c=a.alternate;null!==c&&(c.return=null),a.return=null}catch(u){Sc(a,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)ml(t,e),t=t.sibling}function ml(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gl(t,e),vl(e),4&r){try{nl(3,e,e.return),rl(3,e)}catch(m){Sc(e,e.return,m)}try{nl(5,e,e.return)}catch(m){Sc(e,e.return,m)}}break;case 1:gl(t,e),vl(e),512&r&&null!==n&&Zs(n,n.return);break;case 5:if(gl(t,e),vl(e),512&r&&null!==n&&Zs(n,n.return),32&e.flags){var a=e.stateNode;try{de(a,"")}catch(m){Sc(e,e.return,m)}}if(4&r&&null!=(a=e.stateNode)){var o=e.memoizedProps,s=null!==n?n.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===o.type&&null!=o.name&&J(a,o),xe(l,s);var u=xe(l,o);for(s=0;s<c.length;s+=2){var h=c[s],d=c[s+1];"style"===h?me(a,d):"dangerouslySetInnerHTML"===h?he(a,d):"children"===h?de(a,d):x(a,h,d,u)}switch(l){case"input":Q(a,o);break;case"textarea":ie(a,o);break;case"select":var f=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?ne(a,!!o.multiple,p,!1):f!==!!o.multiple&&(null!=o.defaultValue?ne(a,!!o.multiple,o.defaultValue,!0):ne(a,!!o.multiple,o.multiple?[]:"",!1))}a[fa]=o}catch(m){Sc(e,e.return,m)}}break;case 6:if(gl(t,e),vl(e),4&r){if(null===e.stateNode)throw Error(i(162));a=e.stateNode,o=e.memoizedProps;try{a.nodeValue=o}catch(m){Sc(e,e.return,m)}}break;case 3:if(gl(t,e),vl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Ut(t.containerInfo)}catch(m){Sc(e,e.return,m)}break;case 4:default:gl(t,e),vl(e);break;case 13:gl(t,e),vl(e),8192&(a=e.child).flags&&(o=null!==a.memoizedState,a.stateNode.isHidden=o,!o||null!==a.alternate&&null!==a.alternate.memoizedState||(Wl=Je())),4&r&&pl(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?($s=(u=$s)||h,gl(t,e),$s=u):gl(t,e),vl(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!h&&0!==(1&e.mode))for(Qs=e,h=e.child;null!==h;){for(d=Qs=h;null!==Qs;){switch(p=(f=Qs).child,f.tag){case 0:case 11:case 14:case 15:nl(4,f,f.return);break;case 1:Zs(f,f.return);var g=f.stateNode;if("function"===typeof g.componentWillUnmount){r=f,n=f.return;try{t=r,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){Sc(r,n,m)}}break;case 5:Zs(f,f.return);break;case 22:if(null!==f.memoizedState){wl(d);continue}}null!==p?(p.return=f,Qs=p):wl(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{a=d.stateNode,u?"function"===typeof(o=a.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=d.stateNode,s=void 0!==(c=d.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=ge("display",s))}catch(m){Sc(e,e.return,m)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(m){Sc(e,e.return,m)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:gl(t,e),vl(e),4&r&&pl(e);case 21:}}function vl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ol(n)){var r=n;break e}n=n.return}throw Error(i(160))}switch(r.tag){case 5:var a=r.stateNode;32&r.flags&&(de(a,""),r.flags&=-33),cl(e,sl(e),a);break;case 3:case 4:var o=r.stateNode.containerInfo;ll(e,sl(e),o);break;default:throw Error(i(161))}}catch(s){Sc(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bl(e,t,n){Qs=e,xl(e,t,n)}function xl(e,t,n){for(var r=0!==(1&e.mode);null!==Qs;){var a=Qs,i=a.child;if(22===a.tag&&r){var o=null!==a.memoizedState||Ys;if(!o){var s=a.alternate,l=null!==s&&null!==s.memoizedState||$s;s=Ys;var c=$s;if(Ys=o,($s=l)&&!c)for(Qs=a;null!==Qs;)l=(o=Qs).child,22===o.tag&&null!==o.memoizedState?kl(a):null!==l?(l.return=o,Qs=l):kl(a);for(;null!==i;)Qs=i,xl(i,t,n),i=i.sibling;Qs=a,Ys=s,$s=c}yl(e)}else 0!==(8772&a.subtreeFlags)&&null!==i?(i.return=a,Qs=i):yl(e)}}function yl(e){for(;null!==Qs;){var t=Qs;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:$s||rl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!$s)if(null===n)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:ns(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Vi(t,o,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Vi(t,s,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&Ut(d)}}}break;default:throw Error(i(163))}$s||512&t.flags&&al(t)}catch(f){Sc(t,t.return,f)}}if(t===e){Qs=null;break}if(null!==(n=t.sibling)){n.return=t.return,Qs=n;break}Qs=t.return}}function wl(e){for(;null!==Qs;){var t=Qs;if(t===e){Qs=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Qs=n;break}Qs=t.return}}function kl(e){for(;null!==Qs;){var t=Qs;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(l){Sc(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var a=t.return;try{r.componentDidMount()}catch(l){Sc(t,a,l)}}var i=t.return;try{al(t)}catch(l){Sc(t,i,l)}break;case 5:var o=t.return;try{al(t)}catch(l){Sc(t,o,l)}}}catch(l){Sc(t,t.return,l)}if(t===e){Qs=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Qs=s;break}Qs=t.return}}var Nl,Sl=Math.ceil,Cl=y.ReactCurrentDispatcher,El=y.ReactCurrentOwner,_l=y.ReactCurrentBatchConfig,Il=0,Tl=null,Al=null,Rl=0,Dl=0,Fl=Sa(0),Ol=0,Ll=null,Pl=0,Ml=0,jl=0,Bl=null,zl=null,Wl=0,Ul=1/0,Vl=null,Hl=!1,Gl=null,ql=null,Kl=!1,Xl=null,Yl=0,$l=0,Jl=null,Ql=-1,Zl=0;function ec(){return 0!==(6&Il)?Je():-1!==Ql?Ql:Ql=Je()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Il)&&0!==Rl?Rl&-Rl:null!==gi.transition?(0===Zl&&(Zl=gt()),Zl):0!==(e=xt)?e:e=void 0===(e=window.event)?16:$t(e.type)}function nc(e,t,n,r){if(50<$l)throw $l=0,Jl=null,Error(i(185));vt(e,n,r),0!==(2&Il)&&e===Tl||(e===Tl&&(0===(2&Il)&&(Ml|=n),4===Ol&&sc(e,Rl)),rc(e,r),1===n&&0===Il&&0===(1&t.mode)&&(Ul=Je()+500,Ba&&Ua()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-ot(i),s=1<<o,l=a[o];-1===l?0!==(s&n)&&0===(s&r)||(a[o]=ft(s,t)):l<=t&&(e.expiredLanes|=s),i&=~s}}(e,t);var r=dt(e,e===Tl?Rl:0);if(0===r)null!==n&&Xe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Xe(n),1===t)0===e.tag?function(e){Ba=!0,Wa(e)}(lc.bind(null,e)):Wa(lc.bind(null,e)),oa(function(){0===(6&Il)&&Ua()}),n=null;else{switch(yt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Tc(n,ac.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ac(e,t){if(Ql=-1,Zl=0,0!==(6&Il))throw Error(i(327));var n=e.callbackNode;if(kc()&&e.callbackNode!==n)return null;var r=dt(e,e===Tl?Rl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=mc(e,r);else{t=r;var a=Il;Il|=2;var o=pc();for(Tl===e&&Rl===t||(Vl=null,Ul=Je()+500,dc(e,t));;)try{bc();break}catch(l){fc(e,l)}Ei(),Cl.current=o,Il=a,null!==Al?t=0:(Tl=null,Rl=0,t=Ol)}if(0!==t){if(2===t&&(0!==(a=pt(e))&&(r=a,t=ic(e,a))),1===t)throw n=Ll,dc(e,0),sc(e,r),rc(e,Je()),n;if(6===t)sc(e,r);else{if(a=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!sr(i(),a))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=mc(e,r))&&(0!==(o=pt(e))&&(r=o,t=ic(e,o))),1===t))throw n=Ll,dc(e,0),sc(e,r),rc(e,Je()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(i(345));case 2:case 5:wc(e,zl,Vl);break;case 3:if(sc(e,r),(130023424&r)===r&&10<(t=Wl+500-Je())){if(0!==dt(e,0))break;if(((a=e.suspendedLanes)&r)!==r){ec(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ra(wc.bind(null,e,zl,Vl),t);break}wc(e,zl,Vl);break;case 4:if(sc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,a=-1;0<r;){var s=31-ot(r);o=1<<s,(s=t[s])>a&&(a=s),r&=~o}if(r=a,10<(r=(120>(r=Je()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Sl(r/1960))-r)){e.timeoutHandle=ra(wc.bind(null,e,zl,Vl),r);break}wc(e,zl,Vl);break;default:throw Error(i(329))}}}return rc(e,Je()),e.callbackNode===n?ac.bind(null,e):null}function ic(e,t){var n=Bl;return e.current.memoizedState.isDehydrated&&(dc(e,t).flags|=256),2!==(e=mc(e,t))&&(t=zl,zl=n,null!==t&&oc(t)),e}function oc(e){null===zl?zl=e:zl.push.apply(zl,e)}function sc(e,t){for(t&=~jl,t&=~Ml,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function lc(e){if(0!==(6&Il))throw Error(i(327));kc();var t=dt(e,0);if(0===(1&t))return rc(e,Je()),null;var n=mc(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=ic(e,r))}if(1===n)throw n=Ll,dc(e,0),sc(e,t),rc(e,Je()),n;if(6===n)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,zl,Vl),rc(e,Je()),null}function cc(e,t){var n=Il;Il|=1;try{return e(t)}finally{0===(Il=n)&&(Ul=Je()+500,Ba&&Ua())}}function uc(e){null!==Xl&&0===Xl.tag&&0===(6&Il)&&kc();var t=Il;Il|=1;var n=_l.transition,r=xt;try{if(_l.transition=null,xt=1,e)return e()}finally{xt=r,_l.transition=n,0===(6&(Il=t))&&Ua()}}function hc(){Dl=Fl.current,Ca(Fl)}function dc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,aa(n)),null!==Al)for(n=Al.return;null!==n;){var r=n;switch(ti(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Fa();break;case 3:$i(),Ca(Ta),Ca(Ia),no();break;case 5:Qi(r);break;case 4:$i();break;case 13:case 19:Ca(Zi);break;case 10:_i(r.type._context);break;case 22:case 23:hc()}n=n.return}if(Tl=e,Al=e=Fc(e.current,null),Rl=Dl=t,Ol=0,Ll=null,jl=Ml=Pl=0,zl=Bl=null,null!==Ri){for(t=0;t<Ri.length;t++)if(null!==(r=(n=Ri[t]).interleaved)){n.interleaved=null;var a=r.next,i=n.pending;if(null!==i){var o=i.next;i.next=a,r.next=o}n.pending=r}Ri=null}return e}function fc(e,t){for(;;){var n=Al;try{if(Ei(),ro.current=Qo,co){for(var r=oo.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}co=!1}if(io=0,lo=so=oo=null,uo=!1,ho=0,El.current=null,null===n||null===n.return){Ol=1,Ll=t,Al=null;break}e:{var o=e,s=n.return,l=n,c=t;if(t=Rl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=ms(s);if(null!==p){p.flags&=-257,vs(p,s,l,0,t),1&p.mode&&gs(o,u,t),c=u;var g=(t=p).updateQueue;if(null===g){var m=new Set;m.add(c),t.updateQueue=m}else g.add(c);break e}if(0===(1&t)){gs(o,u,t),gc();break e}c=Error(i(426))}else if(ai&&1&l.mode){var v=ms(s);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),vs(v,s,l,0,t),pi(cs(c,l));break e}}o=c=cs(c,l),4!==Ol&&(Ol=2),null===Bl?Bl=[o]:Bl.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Wi(o,fs(0,c,t));break e;case 1:l=c;var b=o.type,x=o.stateNode;if(0===(128&o.flags)&&("function"===typeof b.getDerivedStateFromError||null!==x&&"function"===typeof x.componentDidCatch&&(null===ql||!ql.has(x)))){o.flags|=65536,t&=-t,o.lanes|=t,Wi(o,ps(o,l,t));break e}}o=o.return}while(null!==o)}yc(n)}catch(y){t=y,Al===n&&null!==n&&(Al=n=n.return);continue}break}}function pc(){var e=Cl.current;return Cl.current=Qo,null===e?Qo:e}function gc(){0!==Ol&&3!==Ol&&2!==Ol||(Ol=4),null===Tl||0===(268435455&Pl)&&0===(268435455&Ml)||sc(Tl,Rl)}function mc(e,t){var n=Il;Il|=2;var r=pc();for(Tl===e&&Rl===t||(Vl=null,dc(e,t));;)try{vc();break}catch(a){fc(e,a)}if(Ei(),Il=n,Cl.current=r,null!==Al)throw Error(i(261));return Tl=null,Rl=0,Ol}function vc(){for(;null!==Al;)xc(Al)}function bc(){for(;null!==Al&&!Ye();)xc(Al)}function xc(e){var t=Nl(e.alternate,e,Dl);e.memoizedProps=e.pendingProps,null===t?yc(e):Al=t,El.current=null}function yc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ks(n,t,Dl)))return void(Al=n)}else{if(null!==(n=Xs(n,t)))return n.flags&=32767,void(Al=n);if(null===e)return Ol=6,void(Al=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Al=t);Al=t=e}while(null!==t);0===Ol&&(Ol=5)}function wc(e,t,n){var r=xt,a=_l.transition;try{_l.transition=null,xt=1,function(e,t,n,r){do{kc()}while(null!==Xl);if(0!==(6&Il))throw Error(i(327));n=e.finishedWork;var a=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-ot(n),i=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~i}}(e,o),e===Tl&&(Al=Tl=null,Rl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Kl||(Kl=!0,Tc(tt,function(){return kc(),null})),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=_l.transition,_l.transition=null;var s=xt;xt=1;var l=Il;Il|=4,El.current=null,function(e,t){if(ea=Ht,fr(e=dr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(w){n=null;break e}var s=0,l=-1,c=-1,u=0,h=0,d=e,f=null;t:for(;;){for(var p;d!==n||0!==a&&3!==d.nodeType||(l=s+a),d!==o||0!==r&&3!==d.nodeType||(c=s+r),3===d.nodeType&&(s+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===e)break t;if(f===n&&++u===a&&(l=s),f===o&&++h===r&&(c=s),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ta={focusedElem:e,selectionRange:n},Ht=!1,Qs=t;null!==Qs;)if(e=(t=Qs).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Qs=e;else for(;null!==Qs;){t=Qs;try{var g=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var m=g.memoizedProps,v=g.memoizedState,b=t.stateNode,x=b.getSnapshotBeforeUpdate(t.elementType===t.type?m:ns(t.type,m),v);b.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var y=t.stateNode.containerInfo;1===y.nodeType?y.textContent="":9===y.nodeType&&y.documentElement&&y.removeChild(y.documentElement);break;default:throw Error(i(163))}}catch(w){Sc(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Qs=e;break}Qs=t.return}g=tl,tl=!1}(e,n),ml(n,e),pr(ta),Ht=!!ea,ta=ea=null,e.current=n,bl(n,e,a),$e(),Il=l,xt=s,_l.transition=o}else e.current=n;if(Kl&&(Kl=!1,Xl=e,Yl=a),o=e.pendingLanes,0===o&&(ql=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,Je()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(Hl)throw Hl=!1,e=Gl,Gl=null,e;0!==(1&Yl)&&0!==e.tag&&kc(),o=e.pendingLanes,0!==(1&o)?e===Jl?$l++:($l=0,Jl=e):$l=0,Ua()}(e,t,n,r)}finally{_l.transition=a,xt=r}return null}function kc(){if(null!==Xl){var e=yt(Yl),t=_l.transition,n=xt;try{if(_l.transition=null,xt=16>e?16:e,null===Xl)var r=!1;else{if(e=Xl,Xl=null,Yl=0,0!==(6&Il))throw Error(i(331));var a=Il;for(Il|=4,Qs=e.current;null!==Qs;){var o=Qs,s=o.child;if(0!==(16&Qs.flags)){var l=o.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Qs=u;null!==Qs;){var h=Qs;switch(h.tag){case 0:case 11:case 15:nl(8,h,o)}var d=h.child;if(null!==d)d.return=h,Qs=d;else for(;null!==Qs;){var f=(h=Qs).sibling,p=h.return;if(il(h),h===u){Qs=null;break}if(null!==f){f.return=p,Qs=f;break}Qs=p}}}var g=o.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(null!==m)}}Qs=o}}if(0!==(2064&o.subtreeFlags)&&null!==s)s.return=o,Qs=s;else e:for(;null!==Qs;){if(0!==(2048&(o=Qs).flags))switch(o.tag){case 0:case 11:case 15:nl(9,o,o.return)}var b=o.sibling;if(null!==b){b.return=o.return,Qs=b;break e}Qs=o.return}}var x=e.current;for(Qs=x;null!==Qs;){var y=(s=Qs).child;if(0!==(2064&s.subtreeFlags)&&null!==y)y.return=s,Qs=y;else e:for(s=x;null!==Qs;){if(0!==(2048&(l=Qs).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(k){Sc(l,l.return,k)}if(l===s){Qs=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Qs=w;break e}Qs=l.return}}if(Il=a,Ua(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(at,e)}catch(k){}r=!0}return r}finally{xt=n,_l.transition=t}}return!1}function Nc(e,t,n){e=Bi(e,t=fs(0,t=cs(n,t),1),1),t=ec(),null!==e&&(vt(e,1,t),rc(e,t))}function Sc(e,t,n){if(3===e.tag)Nc(e,e,n);else for(;null!==t;){if(3===t.tag){Nc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===ql||!ql.has(r))){t=Bi(t,e=ps(t,e=cs(n,e),1),1),e=ec(),null!==t&&(vt(t,1,e),rc(t,e));break}}t=t.return}}function Cc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Tl===e&&(Rl&n)===n&&(4===Ol||3===Ol&&(130023424&Rl)===Rl&&500>Je()-Wl?dc(e,0):jl|=n),rc(e,t)}function Ec(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=ec();null!==(e=Oi(e,t))&&(vt(e,t,n),rc(e,n))}function _c(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ec(e,n)}function Ic(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(i(314))}null!==r&&r.delete(t),Ec(e,n)}function Tc(e,t){return Ke(e,t)}function Ac(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rc(e,t,n,r){return new Ac(e,t,n,r)}function Dc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Fc(e,t){var n=e.alternate;return null===n?((n=Rc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Oc(e,t,n,r,a,o){var s=2;if(r=e,"function"===typeof e)Dc(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case N:return Lc(n.children,a,o,t);case S:s=8,a|=8;break;case C:return(e=Rc(12,n,t,2|a)).elementType=C,e.lanes=o,e;case T:return(e=Rc(13,n,t,a)).elementType=T,e.lanes=o,e;case A:return(e=Rc(19,n,t,a)).elementType=A,e.lanes=o,e;case F:return Pc(n,a,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case E:s=10;break e;case _:s=9;break e;case I:s=11;break e;case R:s=14;break e;case D:s=16,r=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=Rc(s,n,t,a)).elementType=e,t.type=r,t.lanes=o,t}function Lc(e,t,n,r){return(e=Rc(7,e,r,t)).lanes=n,e}function Pc(e,t,n,r){return(e=Rc(22,e,r,t)).elementType=F,e.lanes=n,e.stateNode={isHidden:!1},e}function Mc(e,t,n){return(e=Rc(6,e,null,t)).lanes=n,e}function jc(e,t,n){return(t=Rc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Bc(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function zc(e,t,n,r,a,i,o,s,l){return e=new Bc(e,t,n,s,l),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Rc(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Pi(i),e}function Wc(e){if(!e)return _a;e:{if(Ue(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Da(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var n=e.type;if(Da(n))return La(e,n,t)}return t}function Uc(e,t,n,r,a,i,o,s,l){return(e=zc(n,r,!0,e,0,i,0,s,l)).context=Wc(null),n=e.current,(i=ji(r=ec(),a=tc(n))).callback=void 0!==t&&null!==t?t:null,Bi(n,i,a),e.current.lanes=a,vt(e,a,r),rc(e,r),e}function Vc(e,t,n,r){var a=t.current,i=ec(),o=tc(a);return n=Wc(n),null===t.context?t.context=n:t.pendingContext=n,(t=ji(i,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Bi(a,t,o))&&(nc(e,a,o,i),zi(e,a,o)),o}function Hc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function qc(e,t){Gc(e,t),(e=e.alternate)&&Gc(e,t)}Nl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ta.current)xs=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return xs=!1,function(e,t,n){switch(t.tag){case 3:Ts(t),fi();break;case 5:Ji(t);break;case 1:Da(t.type)&&Pa(t);break;case 4:Yi(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Ea(ki,r._currentValue),r._currentValue=a;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ea(Zi,1&Zi.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Ms(e,t,n):(Ea(Zi,1&Zi.current),null!==(e=Hs(e,t,n))?e.sibling:null);Ea(Zi,1&Zi.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Us(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Ea(Zi,Zi.current),r)break;return null;case 22:case 23:return t.lanes=0,Ss(e,t,n)}return Hs(e,t,n)}(e,t,n);xs=0!==(131072&e.flags)}else xs=!1,ai&&0!==(1048576&t.flags)&&Za(t,qa,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Vs(e,t),e=t.pendingProps;var a=Ra(t,Ia.current);Ti(t,n),a=mo(null,t,r,e,a,n);var o=vo();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Da(r)?(o=!0,Pa(t)):o=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Pi(t),a.updater=as,t.stateNode=a,a._reactInternals=t,ls(t,r,e,n),t=Is(null,t,r,!0,o,n)):(t.tag=0,ai&&o&&ei(t),ys(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Vs(e,t),e=t.pendingProps,r=(a=r._init)(r._payload),t.type=r,a=t.tag=function(e){if("function"===typeof e)return Dc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===I)return 11;if(e===R)return 14}return 2}(r),e=ns(r,e),a){case 0:t=Es(null,t,r,e,n);break e;case 1:t=_s(null,t,r,e,n);break e;case 11:t=ws(null,t,r,e,n);break e;case 14:t=ks(null,t,r,ns(r.type,e),n);break e}throw Error(i(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,Es(e,t,r,a=t.elementType===r?a:ns(r,a),n);case 1:return r=t.type,a=t.pendingProps,_s(e,t,r,a=t.elementType===r?a:ns(r,a),n);case 3:e:{if(Ts(t),null===e)throw Error(i(387));r=t.pendingProps,a=(o=t.memoizedState).element,Mi(e,t),Ui(t,r,null,n);var s=t.memoizedState;if(r=s.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=As(e,t,r,n,a=cs(Error(i(423)),t));break e}if(r!==a){t=As(e,t,r,n,a=cs(Error(i(424)),t));break e}for(ri=ca(t.stateNode.containerInfo.firstChild),ni=t,ai=!0,ii=null,n=wi(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fi(),r===a){t=Hs(e,t,n);break e}ys(e,t,r,n)}t=t.child}return t;case 5:return Ji(t),null===e&&ci(t),r=t.type,a=t.pendingProps,o=null!==e?e.memoizedProps:null,s=a.children,na(r,a)?s=null:null!==o&&na(r,o)&&(t.flags|=32),Cs(e,t),ys(e,t,s,n),t.child;case 6:return null===e&&ci(t),null;case 13:return Ms(e,t,n);case 4:return Yi(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=yi(t,null,r,n):ys(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,ws(e,t,r,a=t.elementType===r?a:ns(r,a),n);case 7:return ys(e,t,t.pendingProps,n),t.child;case 8:case 12:return ys(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,o=t.memoizedProps,s=a.value,Ea(ki,r._currentValue),r._currentValue=s,null!==o)if(sr(o.value,s)){if(o.children===a.children&&!Ta.current){t=Hs(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){s=o.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===o.tag){(c=ji(-1,n&-n)).tag=2;var u=o.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Ii(o.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===o.tag)s=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(s=o.return))throw Error(i(341));s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),Ii(s,n,t),s=o.sibling}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===t){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}ys(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Ti(t,n),r=r(a=Ai(a)),t.flags|=1,ys(e,t,r,n),t.child;case 14:return a=ns(r=t.type,t.pendingProps),ks(e,t,r,a=ns(r.type,a),n);case 15:return Ns(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:ns(r,a),Vs(e,t),t.tag=1,Da(r)?(e=!0,Pa(t)):e=!1,Ti(t,n),os(t,r,a),ls(t,r,a,n),Is(null,t,r,!0,e,n);case 19:return Us(e,t,n);case 22:return Ss(e,t,n)}throw Error(i(156,t.tag))};var Kc="function"===typeof reportError?reportError:function(e){console.error(e)};function Xc(e){this._internalRoot=e}function Yc(e){this._internalRoot=e}function $c(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Qc(){}function Zc(e,t,n,r,a){var i=n._reactRootContainer;if(i){var o=i;if("function"===typeof a){var s=a;a=function(){var e=Hc(o);s.call(e)}}Vc(t,o,e,a)}else o=function(e,t,n,r,a){if(a){if("function"===typeof r){var i=r;r=function(){var e=Hc(o);i.call(e)}}var o=Uc(t,r,e,0,null,!1,0,"",Qc);return e._reactRootContainer=o,e[pa]=o.current,Ur(8===e.nodeType?e.parentNode:e),uc(),o}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof r){var s=r;r=function(){var e=Hc(l);s.call(e)}}var l=zc(e,0,!1,null,0,!1,0,"",Qc);return e._reactRootContainer=l,e[pa]=l.current,Ur(8===e.nodeType?e.parentNode:e),uc(function(){Vc(t,l,n,r)}),l}(n,t,e,a,r);return Hc(o)}Yc.prototype.render=Xc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Vc(e,t,null,null)},Yc.prototype.unmount=Xc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc(function(){Vc(null,e,null,null)}),t[pa]=null}},Yc.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ft.length&&0!==t&&t<Ft[n].priority;n++);Ft.splice(n,0,e),0===n&&Mt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ht(t.pendingLanes);0!==n&&(bt(t,1|n),rc(t,Je()),0===(6&Il)&&(Ul=Je()+500,Ua()))}break;case 13:uc(function(){var t=Oi(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}}),qc(e,1)}},kt=function(e){if(13===e.tag){var t=Oi(e,134217728);if(null!==t)nc(t,e,134217728,ec());qc(e,134217728)}},Nt=function(e){if(13===e.tag){var t=tc(e),n=Oi(e,t);if(null!==n)nc(n,e,t,ec());qc(e,t)}},St=function(){return xt},Ct=function(e,t){var n=xt;try{return xt=e,t()}finally{xt=n}},ke=function(e,t,n){switch(t){case"input":if(Q(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=wa(r);if(!a)throw Error(i(90));K(r),Q(r,a)}}}break;case"textarea":ie(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ie=cc,Te=uc;var eu={usingClientEntryPoint:!1,Events:[xa,ya,wa,Ee,_e,cc]},tu={findFiberByHostInstance:ba,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:y.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ge(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{at=ru.inject(nu),it=ru}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!$c(t))throw Error(i(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:k,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!$c(e))throw Error(i(299));var n=!1,r="",a=Kc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=zc(e,1,!1,null,0,n,0,r,a),e[pa]=t.current,Ur(8===e.nodeType?e.parentNode:e),new Xc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=Ge(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Jc(t))throw Error(i(200));return Zc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!$c(e))throw Error(i(405));var r=null!=n&&n.hydratedSources||null,a=!1,o="",s=Kc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=Uc(t,null,e,1,null!=n?n:null,a,0,o,s),e[pa]=t.current,Ur(e),r)for(e=0;e<r.length;e++)a=(a=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Yc(t)},t.render=function(e,t,n){if(!Jc(t))throw Error(i(200));return Zc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(i(40));return!!e._reactRootContainer&&(uc(function(){Zc(null,null,e,!1,function(){e._reactRootContainer=null,e[pa]=null})}),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Jc(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return Zc(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},3886:()=>{},4202:(e,t)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function v(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}function b(){}function x(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=v.prototype;var y=x.prototype=new b;y.constructor=x,g(y,v.prototype),y.isPureReactComponent=!0;var w=Array.isArray,k=Object.prototype.hasOwnProperty,N={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function C(e,t,r){var a,i={},o=null,s=null;if(null!=t)for(a in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(o=""+t.key),t)k.call(t,a)&&!S.hasOwnProperty(a)&&(i[a]=t[a]);var l=arguments.length-2;if(1===l)i.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}if(e&&e.defaultProps)for(a in l=e.defaultProps)void 0===i[a]&&(i[a]=l[a]);return{$$typeof:n,type:e,key:o,ref:s,props:i,_owner:N.current}}function E(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var _=/\/+/g;function I(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function T(e,t,a,i,o){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l=!1;if(null===e)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return o=o(l=e),e=""===i?"."+I(l,0):i,w(o)?(a="",null!=e&&(a=e.replace(_,"$&/")+"/"),T(o,t,a,"",function(e){return e})):null!=o&&(E(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,a+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(_,"$&/")+"/")+e)),t.push(o)),1;if(l=0,i=""===i?".":i+":",w(e))for(var c=0;c<e.length;c++){var u=i+I(s=e[c],c);l+=T(s,t,a,u,o)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(s=e.next()).done;)l+=T(s=s.value,t,a,u=i+I(s,c++),o);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function A(e,t,n){if(null==e)return e;var r=[],a=0;return T(e,r,"","",function(e){return t.call(n,e,a++)}),r}function R(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var D={current:null},F={transition:null},O={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:F,ReactCurrentOwner:N};function L(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:A,forEach:function(e,t,n){A(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return A(e,function(){t++}),t},toArray:function(e){return A(e,function(e){return e})||[]},only:function(e){if(!E(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=a,t.Profiler=o,t.PureComponent=x,t.StrictMode=i,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,t.act=L,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=g({},e.props),i=e.key,o=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,s=N.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)k.call(t,c)&&!S.hasOwnProperty(c)&&(a[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)a.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];a.children=l}return{$$typeof:n,type:e.type,key:i,ref:o,props:a,_owner:s}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=C,t.createFactory=function(e){var t=C.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:R}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=F.transition;F.transition={};try{e()}finally{F.transition=t}},t.unstable_act=L,t.useCallback=function(e,t){return D.current.useCallback(e,t)},t.useContext=function(e){return D.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return D.current.useDeferredValue(e)},t.useEffect=function(e,t){return D.current.useEffect(e,t)},t.useId=function(){return D.current.useId()},t.useImperativeHandle=function(e,t,n){return D.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return D.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return D.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return D.current.useMemo(e,t)},t.useReducer=function(e,t,n){return D.current.useReducer(e,t,n)},t.useRef=function(e){return D.current.useRef(e)},t.useState=function(e){return D.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return D.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return D.current.useTransition()},t.version="18.3.1"},4334:(e,t,n)=>{var r=n(7359),a=n(7066),i=n(9016),o=n(9538),s=n(6288),l=n(5262),c=n(2430);c.alea=r,c.xor128=a,c.xorwow=i,c.xorshift7=o,c.xor4096=s,c.tychei=l,e.exports=c},4391:(e,t,n)=>{"use strict";var r=n(7950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},4530:()=>{},4980:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(2284);function a(e){var t=function(e,t){if("object"!=(0,r.A)(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=(0,r.A)(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==(0,r.A)(t)?t:t+""}function i(e,t,n){return(t=a(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},5043:(e,t,n)=>{"use strict";e.exports=n(4202)},5262:function(e,t,n){var r;!function(e,a){function i(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,a=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^a,t.a=a-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function o(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function s(e,t){var n=new i(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&o(r,n),a.state=function(){return o(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.tychei=s}(0,e=n.nmd(e),n.amdD)},5817:()=>{},6288:function(e,t,n){var r;!function(e,a){function i(e){var t=this;t.next=function(){var e,n,r=t.w,a=t.X,i=t.i;return t.w=r=r+1640531527|0,n=a[i+34&127],e=a[i=i+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=a[i]=n^e,t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,a,i,o,s=[],l=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,l=Math.max(l,t.length)),a=0,i=-32;i<l;++i)t&&(r^=t.charCodeAt((i+32)%t.length)),0===i&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(o=o+1640531527|0,a=0==(n=s[127&i]^=r+o)?a+1:0);for(a>=128&&(s[127&(t&&t.length||0)]=-1),a=127,i=512;i>0;--i)r=s[a+34&127],n=s[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[a]=r^n;e.w=o,e.X=s,e.i=a}(t,e)}function o(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function s(e,t){null==e&&(e=+new Date);var n=new i(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.X&&o(r,n),a.state=function(){return o(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.xor4096=s}(0,e=n.nmd(e),n.amdD)},7029:function(e,t,n){var r;r=function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./src/react-webcam.tsx")}({"./src/react-webcam.tsx":function(e,t,n){"use strict";n.r(t);var r=n("react"),a=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=function(){return i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},i.apply(this,arguments)},o=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};function s(){return!(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)}"undefined"!==typeof window&&(void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(e){var t=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return t?new Promise(function(n,r){t.call(navigator,e,n,r)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}));var l=function(e){function t(t){var n=e.call(this,t)||this;return n.canvas=null,n.ctx=null,n.requestUserMediaId=0,n.unmounted=!1,n.state={hasUserMedia:!1},n}return a(t,e),t.prototype.componentDidMount=function(){var e=this.state,t=this.props;this.unmounted=!1,s()?(e.hasUserMedia||this.requestUserMedia(),t.children&&"function"!=typeof t.children&&console.warn("children must be a function")):t.onUserMediaError("getUserMedia not supported")},t.prototype.componentDidUpdate=function(e){var t=this.props;if(s()){var n=JSON.stringify(e.audioConstraints)!==JSON.stringify(t.audioConstraints),r=JSON.stringify(e.videoConstraints)!==JSON.stringify(t.videoConstraints),a=e.minScreenshotWidth!==t.minScreenshotWidth,i=e.minScreenshotHeight!==t.minScreenshotHeight;(r||a||i)&&(this.canvas=null,this.ctx=null),(n||r)&&(this.stopAndCleanup(),this.requestUserMedia())}else t.onUserMediaError("getUserMedia not supported")},t.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},t.stopMediaStream=function(e){e&&(e.getVideoTracks&&e.getAudioTracks?(e.getVideoTracks().map(function(t){e.removeTrack(t),t.stop()}),e.getAudioTracks().map(function(t){e.removeTrack(t),t.stop()})):e.stop())},t.prototype.stopAndCleanup=function(){var e=this.state;e.hasUserMedia&&(t.stopMediaStream(this.stream),e.src&&window.URL.revokeObjectURL(e.src))},t.prototype.getScreenshot=function(e){var t=this.state,n=this.props;if(!t.hasUserMedia)return null;var r=this.getCanvas(e);return r&&r.toDataURL(n.screenshotFormat,n.screenshotQuality)},t.prototype.getCanvas=function(e){var t=this.state,n=this.props;if(!this.video)return null;if(!t.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var r=this.video.videoWidth,a=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var i=r/a;a=(r=n.minScreenshotWidth||this.video.clientWidth)/i,n.minScreenshotHeight&&a<n.minScreenshotHeight&&(r=(a=n.minScreenshotHeight)*i)}this.canvas=document.createElement("canvas"),this.canvas.width=(null===e||void 0===e?void 0:e.width)||r,this.canvas.height=(null===e||void 0===e?void 0:e.height)||a,this.ctx=this.canvas.getContext("2d")}var o=this.ctx,s=this.canvas;return o&&s&&(s.width=(null===e||void 0===e?void 0:e.width)||s.width,s.height=(null===e||void 0===e?void 0:e.height)||s.height,n.mirrored&&(o.translate(s.width,0),o.scale(-1,1)),o.imageSmoothingEnabled=n.imageSmoothing,o.drawImage(this.video,0,0,(null===e||void 0===e?void 0:e.width)||s.width,(null===e||void 0===e?void 0:e.height)||s.height),n.mirrored&&(o.scale(-1,1),o.translate(-s.width,0))),s},t.prototype.requestUserMedia=function(){var e=this,n=this.props,r=function(r,a){var i={video:"undefined"===typeof a||a};n.audio&&(i.audio="undefined"===typeof r||r),e.requestUserMediaId++;var o=e.requestUserMediaId;navigator.mediaDevices.getUserMedia(i).then(function(n){e.unmounted||o!==e.requestUserMediaId?t.stopMediaStream(n):e.handleUserMedia(null,n)}).catch(function(t){e.handleUserMedia(t)})};if("mediaDevices"in navigator)r(n.audioConstraints,n.videoConstraints);else{var a=function(e){return{optional:[{sourceId:e}]}},i=function(e){var t=e.deviceId;return"string"===typeof t?t:Array.isArray(t)&&t.length>0?t[0]:"object"===typeof t&&t.ideal?t.ideal:null};MediaStreamTrack.getSources(function(e){var t=null,o=null;e.forEach(function(e){"audio"===e.kind?t=e.id:"video"===e.kind&&(o=e.id)});var s=i(n.audioConstraints);s&&(t=s);var l=i(n.videoConstraints);l&&(o=l),r(a(t),a(o))})}},t.prototype.handleUserMedia=function(e,t){var n=this.props;if(e||!t)return this.setState({hasUserMedia:!1}),void n.onUserMediaError(e);this.stream=t;try{this.video&&(this.video.srcObject=t),this.setState({hasUserMedia:!0})}catch(r){this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(t)})}n.onUserMedia(t)},t.prototype.render=function(){var e=this,t=this.state,n=this.props,a=n.audio,s=(n.forceScreenshotSourceSize,n.disablePictureInPicture),l=(n.onUserMedia,n.onUserMediaError,n.screenshotFormat,n.screenshotQuality,n.minScreenshotWidth,n.minScreenshotHeight,n.audioConstraints,n.videoConstraints,n.imageSmoothing,n.mirrored),c=n.style,u=void 0===c?{}:c,h=n.children,d=o(n,["audio","forceScreenshotSourceSize","disablePictureInPicture","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),f=l?i(i({},u),{transform:(u.transform||"")+" scaleX(-1)"}):u,p={getScreenshot:this.getScreenshot.bind(this)};return r.createElement(r.Fragment,null,r.createElement("video",i({autoPlay:!0,disablePictureInPicture:s,src:t.src,muted:!a,playsInline:!0,ref:function(t){e.video=t},style:f},d)),h&&h(p))},t.defaultProps={audio:!1,disablePictureInPicture:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},t}(r.Component);t.default=l},react:function(t,n){t.exports=e}}).default},e.exports=r(n(5043))},7066:function(e,t,n){var r;!function(e,a){function i(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function o(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function s(e,t){var n=new i(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&o(r,n),a.state=function(){return o(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.xor128=s}(0,e=n.nmd(e),n.amdD)},7234:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<i(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,o=a>>>1;r<o;){var s=2*(r+1)-1,l=e[s],c=s+1,u=e[c];if(0>i(l,n))c<a&&0>i(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[s]=n,r=s);else{if(!(c<a&&0>i(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var c=[],u=[],h=1,d=null,f=3,p=!1,g=!1,m=!1,v="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,x="undefined"!==typeof setImmediate?setImmediate:null;function y(e){for(var t=r(u);null!==t;){if(null===t.callback)a(u);else{if(!(t.startTime<=e))break;a(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function w(e){if(m=!1,y(e),!g)if(null!==r(c))g=!0,F(k);else{var t=r(u);null!==t&&O(w,t.startTime-e)}}function k(e,n){g=!1,m&&(m=!1,b(E),E=-1),p=!0;var i=f;try{for(y(n),d=r(c);null!==d&&(!(d.expirationTime>n)||e&&!T());){var o=d.callback;if("function"===typeof o){d.callback=null,f=d.priorityLevel;var s=o(d.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?d.callback=s:d===r(c)&&a(c),y(n)}else a(c);d=r(c)}if(null!==d)var l=!0;else{var h=r(u);null!==h&&O(w,h.startTime-n),l=!1}return l}finally{d=null,f=i,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var N,S=!1,C=null,E=-1,_=5,I=-1;function T(){return!(t.unstable_now()-I<_)}function A(){if(null!==C){var e=t.unstable_now();I=e;var n=!0;try{n=C(!0,e)}finally{n?N():(S=!1,C=null)}}else S=!1}if("function"===typeof x)N=function(){x(A)};else if("undefined"!==typeof MessageChannel){var R=new MessageChannel,D=R.port2;R.port1.onmessage=A,N=function(){D.postMessage(null)}}else N=function(){v(A,0)};function F(e){C=e,S||(S=!0,N())}function O(e,n){E=v(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,F(k))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,a,i){var o=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?o+i:o:i=o,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:h++,callback:a,priorityLevel:e,startTime:i,expirationTime:s=i+s,sortIndex:-1},i>o?(e.sortIndex=i,n(u,e),null===r(c)&&e===r(u)&&(m?(b(E),E=-1):m=!0,O(w,i-o))):(e.sortIndex=s,n(c,e),g||p||(g=!0,F(k))),e},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},7353:e=>{e.exports=n;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(C){}function n(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function r(e){return!0===(e&&e.__isLong__)}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0}),n.isLong=r;var a={},i={};function o(e,t){var n,r,o;return t?(o=0<=(e>>>=0)&&e<256)&&(r=i[e])?r:(n=l(e,(0|e)<0?-1:0,!0),o&&(i[e]=n),n):(o=-128<=(e|=0)&&e<128)&&(r=a[e])?r:(n=l(e,e<0?-1:0,!1),o&&(a[e]=n),n)}function s(e,t){if(isNaN(e))return t?v:m;if(t){if(e<0)return v;if(e>=f)return k}else{if(e<=-p)return N;if(e+1>=p)return w}return e<0?s(-e,t).neg():l(e%d|0,e/d|0,t)}function l(e,t,r){return new n(e,t,r)}n.fromInt=o,n.fromNumber=s,n.fromBits=l;var c=Math.pow;function u(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return m;if("number"===typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return u(e.substring(1),t,n).neg();for(var a=s(c(n,8)),i=m,o=0;o<e.length;o+=8){var l=Math.min(8,e.length-o),h=parseInt(e.substring(o,o+l),n);if(l<8){var d=s(c(n,l));i=i.mul(d).add(s(h))}else i=(i=i.mul(a)).add(s(h))}return i.unsigned=t,i}function h(e,t){return"number"===typeof e?s(e,t):"string"===typeof e?u(e,t):l(e.low,e.high,"boolean"===typeof t?t:e.unsigned)}n.fromString=u,n.fromValue=h;var d=4294967296,f=d*d,p=f/2,g=o(1<<24),m=o(0);n.ZERO=m;var v=o(0,!0);n.UZERO=v;var b=o(1);n.ONE=b;var x=o(1,!0);n.UONE=x;var y=o(-1);n.NEG_ONE=y;var w=l(-1,2147483647,!1);n.MAX_VALUE=w;var k=l(-1,-1,!0);n.MAX_UNSIGNED_VALUE=k;var N=l(0,-2147483648,!1);n.MIN_VALUE=N;var S=n.prototype;S.toInt=function(){return this.unsigned?this.low>>>0:this.low},S.toNumber=function(){return this.unsigned?(this.high>>>0)*d+(this.low>>>0):this.high*d+(this.low>>>0)},S.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(N)){var t=s(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var a=s(c(e,6),this.unsigned),i=this,o="";;){var l=i.div(a),u=(i.sub(l.mul(a)).toInt()>>>0).toString(e);if((i=l).isZero())return u+o;for(;u.length<6;)u="0"+u;o=""+u+o}},S.getHighBits=function(){return this.high},S.getHighBitsUnsigned=function(){return this.high>>>0},S.getLowBits=function(){return this.low},S.getLowBitsUnsigned=function(){return this.low>>>0},S.getNumBitsAbs=function(){if(this.isNegative())return this.eq(N)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},S.isZero=function(){return 0===this.high&&0===this.low},S.eqz=S.isZero,S.isNegative=function(){return!this.unsigned&&this.high<0},S.isPositive=function(){return this.unsigned||this.high>=0},S.isOdd=function(){return 1===(1&this.low)},S.isEven=function(){return 0===(1&this.low)},S.equals=function(e){return r(e)||(e=h(e)),(this.unsigned===e.unsigned||this.high>>>31!==1||e.high>>>31!==1)&&(this.high===e.high&&this.low===e.low)},S.eq=S.equals,S.notEquals=function(e){return!this.eq(e)},S.neq=S.notEquals,S.ne=S.notEquals,S.lessThan=function(e){return this.comp(e)<0},S.lt=S.lessThan,S.lessThanOrEqual=function(e){return this.comp(e)<=0},S.lte=S.lessThanOrEqual,S.le=S.lessThanOrEqual,S.greaterThan=function(e){return this.comp(e)>0},S.gt=S.greaterThan,S.greaterThanOrEqual=function(e){return this.comp(e)>=0},S.gte=S.greaterThanOrEqual,S.ge=S.greaterThanOrEqual,S.compare=function(e){if(r(e)||(e=h(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},S.comp=S.compare,S.negate=function(){return!this.unsigned&&this.eq(N)?N:this.not().add(b)},S.neg=S.negate,S.add=function(e){r(e)||(e=h(e));var t=this.high>>>16,n=65535&this.high,a=this.low>>>16,i=65535&this.low,o=e.high>>>16,s=65535&e.high,c=e.low>>>16,u=0,d=0,f=0,p=0;return f+=(p+=i+(65535&e.low))>>>16,d+=(f+=a+c)>>>16,u+=(d+=n+s)>>>16,u+=t+o,l((f&=65535)<<16|(p&=65535),(u&=65535)<<16|(d&=65535),this.unsigned)},S.subtract=function(e){return r(e)||(e=h(e)),this.add(e.neg())},S.sub=S.subtract,S.multiply=function(e){if(this.isZero())return m;if(r(e)||(e=h(e)),t)return l(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return m;if(this.eq(N))return e.isOdd()?N:m;if(e.eq(N))return this.isOdd()?N:m;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(g)&&e.lt(g))return s(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,a=65535&this.high,i=this.low>>>16,o=65535&this.low,c=e.high>>>16,u=65535&e.high,d=e.low>>>16,f=65535&e.low,p=0,v=0,b=0,x=0;return b+=(x+=o*f)>>>16,v+=(b+=i*f)>>>16,b&=65535,v+=(b+=o*d)>>>16,p+=(v+=a*f)>>>16,v&=65535,p+=(v+=i*d)>>>16,v&=65535,p+=(v+=o*u)>>>16,p+=n*f+a*d+i*u+o*c,l((b&=65535)<<16|(x&=65535),(p&=65535)<<16|(v&=65535),this.unsigned)},S.mul=S.multiply,S.divide=function(e){if(r(e)||(e=h(e)),e.isZero())throw Error("division by zero");var n,a,i;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?l((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?v:m;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return v;if(e.gt(this.shru(1)))return x;i=v}else{if(this.eq(N))return e.eq(b)||e.eq(y)?N:e.eq(N)?b:(n=this.shr(1).div(e).shl(1)).eq(m)?e.isNegative()?b:y:(a=this.sub(e.mul(n)),i=n.add(a.div(e)));if(e.eq(N))return this.unsigned?v:m;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=m}for(a=this;a.gte(e);){n=Math.max(1,Math.floor(a.toNumber()/e.toNumber()));for(var o=Math.ceil(Math.log(n)/Math.LN2),u=o<=48?1:c(2,o-48),d=s(n),f=d.mul(e);f.isNegative()||f.gt(a);)f=(d=s(n-=u,this.unsigned)).mul(e);d.isZero()&&(d=b),i=i.add(d),a=a.sub(f)}return i},S.div=S.divide,S.modulo=function(e){return r(e)||(e=h(e)),t?l((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},S.mod=S.modulo,S.rem=S.modulo,S.not=function(){return l(~this.low,~this.high,this.unsigned)},S.and=function(e){return r(e)||(e=h(e)),l(this.low&e.low,this.high&e.high,this.unsigned)},S.or=function(e){return r(e)||(e=h(e)),l(this.low|e.low,this.high|e.high,this.unsigned)},S.xor=function(e){return r(e)||(e=h(e)),l(this.low^e.low,this.high^e.high,this.unsigned)},S.shiftLeft=function(e){return r(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?l(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):l(0,this.low<<e-32,this.unsigned)},S.shl=S.shiftLeft,S.shiftRight=function(e){return r(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?l(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):l(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},S.shr=S.shiftRight,S.shiftRightUnsigned=function(e){if(r(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?l(this.low>>>e|t<<32-e,t>>>e,this.unsigned):l(32===e?t:t>>>e-32,0,this.unsigned)},S.shru=S.shiftRightUnsigned,S.shr_u=S.shiftRightUnsigned,S.toSigned=function(){return this.unsigned?l(this.low,this.high,!1):this},S.toUnsigned=function(){return this.unsigned?this:l(this.low,this.high,!0)},S.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},S.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},S.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},n.fromBytes=function(e,t,r){return r?n.fromBytesLE(e,t):n.fromBytesBE(e,t)},n.fromBytesLE=function(e,t){return new n(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},n.fromBytesBE=function(e,t){return new n(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},7359:function(e,t,n){var r;!function(e,a){function i(e){var t=this,n=function(){var e=4022871197,t=function(t){t=String(t);for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)};return t}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function o(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function s(e,t){var n=new i(e),r=t&&t.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,r&&("object"==typeof r&&o(r,n),a.state=function(){return o(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.alea=s}(0,e=n.nmd(e),n.amdD)},7762:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AcroForm:()=>wt,AcroFormAppearance:()=>xt,AcroFormButton:()=>dt,AcroFormCheckBox:()=>mt,AcroFormChoiceField:()=>lt,AcroFormComboBox:()=>ut,AcroFormEditBox:()=>ht,AcroFormListBox:()=>ct,AcroFormPasswordField:()=>bt,AcroFormPushButton:()=>ft,AcroFormRadioButton:()=>pt,AcroFormTextField:()=>vt,GState:()=>Te,ShadingPattern:()=>Re,TilingPattern:()=>De,default:()=>yn,jsPDF:()=>Fe});var r=n(2284),a=Uint8Array,i=Uint16Array,o=Int32Array,s=new a([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),l=new a([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),c=new a([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),u=function(e,t){for(var n=new i(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];var a=new o(n[30]);for(r=1;r<30;++r)for(var s=n[r];s<n[r+1];++s)a[s]=s-n[r]<<5|r;return{b:n,r:a}},h=u(s,2),d=h.b,f=h.r;d[28]=258,f[258]=28;for(var p=u(l,0),g=p.b,m=p.r,v=new i(32768),b=0;b<32768;++b){var x=(43690&b)>>1|(21845&b)<<1;x=(61680&(x=(52428&x)>>2|(13107&x)<<2))>>4|(3855&x)<<4,v[b]=((65280&x)>>8|(255&x)<<8)>>1}var y=function(e,t,n){for(var r=e.length,a=0,o=new i(t);a<r;++a)e[a]&&++o[e[a]-1];var s,l=new i(t);for(a=1;a<t;++a)l[a]=l[a-1]+o[a-1]<<1;if(n){s=new i(1<<t);var c=15-t;for(a=0;a<r;++a)if(e[a])for(var u=a<<4|e[a],h=t-e[a],d=l[e[a]-1]++<<h,f=d|(1<<h)-1;d<=f;++d)s[v[d]>>c]=u}else for(s=new i(r),a=0;a<r;++a)e[a]&&(s[a]=v[l[e[a]-1]++]>>15-e[a]);return s},w=new a(288);for(b=0;b<144;++b)w[b]=8;for(b=144;b<256;++b)w[b]=9;for(b=256;b<280;++b)w[b]=7;for(b=280;b<288;++b)w[b]=8;var k=new a(32);for(b=0;b<32;++b)k[b]=5;var N=y(w,9,0),S=y(w,9,1),C=y(k,5,0),E=y(k,5,1),_=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},I=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(7&t)&n},T=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(7&t)},A=function(e){return(e+7)/8|0},R=function(e,t,n){return(null==t||t<0)&&(t=0),(null==n||n>e.length)&&(n=e.length),new a(e.subarray(t,n))},D=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],F=function(e,t,n){var r=new Error(t||D[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,F),!n)throw r;return r},O=function(e,t,n,r){var i=e.length,o=r?r.length:0;if(!i||t.f&&!t.l)return n||new a(0);var u=!n,h=u||2!=t.i,f=t.i;u&&(n=new a(3*i));var p=function(e){var t=n.length;if(e>t){var r=new a(Math.max(2*t,e));r.set(n),n=r}},m=t.f||0,v=t.p||0,b=t.b||0,x=t.l,w=t.d,k=t.m,N=t.n,C=8*i;do{if(!x){m=I(e,v,1);var D=I(e,v+1,3);if(v+=3,!D){var O=e[(G=A(v)+4)-4]|e[G-3]<<8,L=G+O;if(L>i){f&&F(0);break}h&&p(b+O),n.set(e.subarray(G,L),b),t.b=b+=O,t.p=v=8*L,t.f=m;continue}if(1==D)x=S,w=E,k=9,N=5;else if(2==D){var P=I(e,v,31)+257,M=I(e,v+10,15)+4,j=P+I(e,v+5,31)+1;v+=14;for(var B=new a(j),z=new a(19),W=0;W<M;++W)z[c[W]]=I(e,v+3*W,7);v+=3*M;var U=_(z),V=(1<<U)-1,H=y(z,U,1);for(W=0;W<j;){var G,q=H[I(e,v,V)];if(v+=15&q,(G=q>>4)<16)B[W++]=G;else{var K=0,X=0;for(16==G?(X=3+I(e,v,3),v+=2,K=B[W-1]):17==G?(X=3+I(e,v,7),v+=3):18==G&&(X=11+I(e,v,127),v+=7);X--;)B[W++]=K}}var Y=B.subarray(0,P),$=B.subarray(P);k=_(Y),N=_($),x=y(Y,k,1),w=y($,N,1)}else F(1);if(v>C){f&&F(0);break}}h&&p(b+131072);for(var J=(1<<k)-1,Q=(1<<N)-1,Z=v;;Z=v){var ee=(K=x[T(e,v)&J])>>4;if((v+=15&K)>C){f&&F(0);break}if(K||F(2),ee<256)n[b++]=ee;else{if(256==ee){Z=v,x=null;break}var te=ee-254;if(ee>264){var ne=s[W=ee-257];te=I(e,v,(1<<ne)-1)+d[W],v+=ne}var re=w[T(e,v)&Q],ae=re>>4;re||F(3),v+=15&re;$=g[ae];if(ae>3){ne=l[ae];$+=T(e,v)&(1<<ne)-1,v+=ne}if(v>C){f&&F(0);break}h&&p(b+131072);var ie=b+te;if(b<$){var oe=o-$,se=Math.min($,ie);for(oe+b<0&&F(3);b<se;++b)n[b]=r[oe+b]}for(;b<ie;++b)n[b]=n[b-$]}}t.l=x,t.p=Z,t.b=b,t.f=m,x&&(m=1,t.m=k,t.d=w,t.n=N)}while(!m);return b!=n.length&&u?R(n,0,b):n.subarray(0,b)},L=function(e,t,n){n<<=7&t;var r=t/8|0;e[r]|=n,e[r+1]|=n>>8},P=function(e,t,n){n<<=7&t;var r=t/8|0;e[r]|=n,e[r+1]|=n>>8,e[r+2]|=n>>16},M=function(e,t){for(var n=[],r=0;r<e.length;++r)e[r]&&n.push({s:r,f:e[r]});var o=n.length,s=n.slice();if(!o)return{t:H,l:0};if(1==o){var l=new a(n[0].s+1);return l[n[0].s]=1,{t:l,l:1}}n.sort(function(e,t){return e.f-t.f}),n.push({s:-1,f:25001});var c=n[0],u=n[1],h=0,d=1,f=2;for(n[0]={s:-1,f:c.f+u.f,l:c,r:u};d!=o-1;)c=n[n[h].f<n[f].f?h++:f++],u=n[h!=d&&n[h].f<n[f].f?h++:f++],n[d++]={s:-1,f:c.f+u.f,l:c,r:u};var p=s[0].s;for(r=1;r<o;++r)s[r].s>p&&(p=s[r].s);var g=new i(p+1),m=j(n[d-1],g,0);if(m>t){r=0;var v=0,b=m-t,x=1<<b;for(s.sort(function(e,t){return g[t.s]-g[e.s]||e.f-t.f});r<o;++r){var y=s[r].s;if(!(g[y]>t))break;v+=x-(1<<m-g[y]),g[y]=t}for(v>>=b;v>0;){var w=s[r].s;g[w]<t?v-=1<<t-g[w]++-1:++r}for(;r>=0&&v;--r){var k=s[r].s;g[k]==t&&(--g[k],++v)}m=t}return{t:new a(g),l:m}},j=function(e,t,n){return-1==e.s?Math.max(j(e.l,t,n+1),j(e.r,t,n+1)):t[e.s]=n},B=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new i(++t),r=0,a=e[0],o=1,s=function(e){n[r++]=e},l=1;l<=t;++l)if(e[l]==a&&l!=t)++o;else{if(!a&&o>2){for(;o>138;o-=138)s(32754);o>2&&(s(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(s(a),--o;o>6;o-=6)s(8304);o>2&&(s(o-3<<5|8208),o=0)}for(;o--;)s(a);o=1,a=e[l]}return{c:n.subarray(0,r),n:t}},z=function(e,t){for(var n=0,r=0;r<t.length;++r)n+=e[r]*t[r];return n},W=function(e,t,n){var r=n.length,a=A(t+2);e[a]=255&r,e[a+1]=r>>8,e[a+2]=255^e[a],e[a+3]=255^e[a+1];for(var i=0;i<r;++i)e[a+i+4]=n[i];return 8*(a+4+r)},U=function(e,t,n,r,a,o,u,h,d,f,p){L(t,p++,n),++a[256];for(var g=M(a,15),m=g.t,v=g.l,b=M(o,15),x=b.t,S=b.l,E=B(m),_=E.c,I=E.n,T=B(x),A=T.c,R=T.n,D=new i(19),F=0;F<_.length;++F)++D[31&_[F]];for(F=0;F<A.length;++F)++D[31&A[F]];for(var O=M(D,7),j=O.t,U=O.l,V=19;V>4&&!j[c[V-1]];--V);var H,G,q,K,X=f+5<<3,Y=z(a,w)+z(o,k)+u,$=z(a,m)+z(o,x)+u+14+3*V+z(D,j)+2*D[16]+3*D[17]+7*D[18];if(d>=0&&X<=Y&&X<=$)return W(t,p,e.subarray(d,d+f));if(L(t,p,1+($<Y)),p+=2,$<Y){H=y(m,v,0),G=m,q=y(x,S,0),K=x;var J=y(j,U,0);L(t,p,I-257),L(t,p+5,R-1),L(t,p+10,V-4),p+=14;for(F=0;F<V;++F)L(t,p+3*F,j[c[F]]);p+=3*V;for(var Q=[_,A],Z=0;Z<2;++Z){var ee=Q[Z];for(F=0;F<ee.length;++F){var te=31&ee[F];L(t,p,J[te]),p+=j[te],te>15&&(L(t,p,ee[F]>>5&127),p+=ee[F]>>12)}}}else H=N,G=w,q=C,K=k;for(F=0;F<h;++F){var ne=r[F];if(ne>255){P(t,p,H[(te=ne>>18&31)+257]),p+=G[te+257],te>7&&(L(t,p,ne>>23&31),p+=s[te]);var re=31&ne;P(t,p,q[re]),p+=K[re],re>3&&(P(t,p,ne>>5&8191),p+=l[re])}else P(t,p,H[ne]),p+=G[ne]}return P(t,p,H[256]),p+G[256]},V=new o([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),H=new a(0),G=function(e,t,n,r,c,u){var h=u.z||e.length,d=new a(r+h+5*(1+Math.ceil(h/7e3))+c),p=d.subarray(r,d.length-c),g=u.l,v=7&(u.r||0);if(t){v&&(p[0]=u.r>>3);for(var b=V[t-1],x=b>>13,y=8191&b,w=(1<<n)-1,k=u.p||new i(32768),N=u.h||new i(w+1),S=Math.ceil(n/3),C=2*S,E=function(t){return(e[t]^e[t+1]<<S^e[t+2]<<C)&w},_=new o(25e3),I=new i(288),T=new i(32),D=0,F=0,O=u.i||0,L=0,P=u.w||0,M=0;O+2<h;++O){var j=E(O),B=32767&O,z=N[j];if(k[B]=z,N[j]=B,P<=O){var H=h-O;if((D>7e3||L>24576)&&(H>423||!g)){v=U(e,p,0,_,I,T,F,L,M,O-M,v),L=D=F=0,M=O;for(var G=0;G<286;++G)I[G]=0;for(G=0;G<30;++G)T[G]=0}var q=2,K=0,X=y,Y=B-z&32767;if(H>2&&j==E(O-Y))for(var $=Math.min(x,H)-1,J=Math.min(32767,O),Q=Math.min(258,H);Y<=J&&--X&&B!=z;){if(e[O+q]==e[O+q-Y]){for(var Z=0;Z<Q&&e[O+Z]==e[O+Z-Y];++Z);if(Z>q){if(q=Z,K=Y,Z>$)break;var ee=Math.min(Y,Z-2),te=0;for(G=0;G<ee;++G){var ne=O-Y+G&32767,re=ne-k[ne]&32767;re>te&&(te=re,z=ne)}}}Y+=(B=z)-(z=k[B])&32767}if(K){_[L++]=268435456|f[q]<<18|m[K];var ae=31&f[q],ie=31&m[K];F+=s[ae]+l[ie],++I[257+ae],++T[ie],P=O+q,++D}else _[L++]=e[O],++I[e[O]]}}for(O=Math.max(O,P);O<h;++O)_[L++]=e[O],++I[e[O]];v=U(e,p,g,_,I,T,F,L,M,O-M,v),g||(u.r=7&v|p[v/8|0]<<3,v-=7,u.h=N,u.p=k,u.i=O,u.w=P)}else{for(O=u.w||0;O<h+g;O+=65535){var oe=O+65535;oe>=h&&(p[v/8|0]=g,oe=h),v=W(p,v+1,e.subarray(O,oe))}u.i=h}return R(d,0,r+A(v)+c)},q=function(){var e=1,t=0;return{p:function(n){for(var r=e,a=t,i=0|n.length,o=0;o!=i;){for(var s=Math.min(o+2655,i);o<s;++o)a+=r+=n[o];r=(65535&r)+15*(r>>16),a=(65535&a)+15*(a>>16)}e=r,t=a},d:function(){return(255&(e%=65521))<<24|(65280&e)<<8|(255&(t%=65521))<<8|t>>8}}},K=function(e,t,n,r,i){if(!i&&(i={l:1},t.dictionary)){var o=t.dictionary.subarray(-32768),s=new a(o.length+e.length);s.set(o),s.set(e,o.length),e=s,i.w=o.length}return G(e,null==t.level?6:t.level,null==t.mem?i.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):20:12+t.mem,n,r,i)},X=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8},Y=function(e,t){var n=t.level,r=0==n?0:n<6?1:9==n?3:2;if(e[0]=120,e[1]=r<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var a=q();a.p(t.dictionary),X(e,2,a.d())}},$=function(e,t){return(8!=(15&e[0])||e[0]>>4>7||(e[0]<<8|e[1])%31)&&F(6,"invalid zlib data"),(e[1]>>5&1)==+!t&&F(6,"invalid zlib data: "+(32&e[1]?"need":"unexpected")+" dictionary"),2+(e[1]>>3&4)};function J(e,t){t||(t={});var n=q();n.p(e);var r=K(e,t,t.dictionary?6:2,4);return Y(r,t),X(r,r.length-4,n.d()),r}function Q(e,t){return O(e.subarray($(e,t&&t.dictionary),-4),{i:2},t&&t.out,t&&t.dictionary)}var Z="undefined"!=typeof TextDecoder&&new TextDecoder;try{Z.decode(H,{stream:!0})}catch(wn){}"function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout&&setTimeout;var ee=function(){return"undefined"!=typeof window?window:"undefined"!=typeof n.g?n.g:"undefined"!=typeof self?self:this}();function te(){ee.console&&"function"==typeof ee.console.log&&ee.console.log.apply(ee.console,arguments)}var ne={log:te,warn:function(e){ee.console&&("function"==typeof ee.console.warn?ee.console.warn.apply(ee.console,arguments):te.call(null,arguments))},error:function(e){ee.console&&("function"==typeof ee.console.error?ee.console.error.apply(ee.console,arguments):te(e))}};function re(e,t,n){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){le(r.response,t,n)},r.onerror=function(){ne.error("could not download file")},r.send()}function ae(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return t.status>=200&&t.status<=299}function ie(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var oe,se,le=ee.saveAs||("object"!==("undefined"==typeof window?"undefined":(0,r.A)(window))||window!==ee?function(){}:"undefined"!=typeof HTMLAnchorElement&&"download"in HTMLAnchorElement.prototype?function(e,t,n){var r=ee.URL||ee.webkitURL,a=document.createElement("a");t=t||e.name||"download",a.download=t,a.rel="noopener","string"==typeof e?(a.href=e,a.origin!==location.origin?ae(a.href)?re(e,t,n):ie(a,a.target="_blank"):ie(a)):(a.href=r.createObjectURL(e),setTimeout(function(){r.revokeObjectURL(a.href)},4e4),setTimeout(function(){ie(a)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,n){if(t=t||e.name||"download","string"==typeof e)if(ae(e))re(e,t,n);else{var a=document.createElement("a");a.href=e,a.target="_blank",setTimeout(function(){ie(a)})}else navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!==(0,r.A)(t)&&(ne.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e}(e,n),t)}:function(e,t,n,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),"string"==typeof e)return re(e,t,n);var i="application/octet-stream"===e.type,o=/constructor/i.test(ee.HTMLElement)||ee.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||i&&o)&&"object"===("undefined"==typeof FileReader?"undefined":(0,r.A)(FileReader))){var l=new FileReader;l.onloadend=function(){var e=l.result;e=s?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=e:location=e,a=null},l.readAsDataURL(e)}else{var c=ee.URL||ee.webkitURL,u=c.createObjectURL(e);a?a.location=u:location.href=u,a=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});function ce(e){var t;e=e||"",this.ok=!1,"#"==e.charAt(0)&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(e){return[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}}],r=0;r<n.length;r++){var a=n[r].re,i=n[r].process,o=a.exec(e);o&&(t=i(o),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var e=this.r.toString(16),t=this.g.toString(16),n=this.b.toString(16);return 1==e.length&&(e="0"+e),1==t.length&&(t="0"+t),1==n.length&&(n="0"+n),"#"+e+t+n}}function ue(e,t){var n=e[0],r=e[1],a=e[2],i=e[3];n=de(n,r,a,i,t[0],7,-680876936),i=de(i,n,r,a,t[1],12,-389564586),a=de(a,i,n,r,t[2],17,606105819),r=de(r,a,i,n,t[3],22,-1044525330),n=de(n,r,a,i,t[4],7,-176418897),i=de(i,n,r,a,t[5],12,1200080426),a=de(a,i,n,r,t[6],17,-1473231341),r=de(r,a,i,n,t[7],22,-45705983),n=de(n,r,a,i,t[8],7,1770035416),i=de(i,n,r,a,t[9],12,-1958414417),a=de(a,i,n,r,t[10],17,-42063),r=de(r,a,i,n,t[11],22,-1990404162),n=de(n,r,a,i,t[12],7,1804603682),i=de(i,n,r,a,t[13],12,-40341101),a=de(a,i,n,r,t[14],17,-1502002290),n=fe(n,r=de(r,a,i,n,t[15],22,1236535329),a,i,t[1],5,-165796510),i=fe(i,n,r,a,t[6],9,-1069501632),a=fe(a,i,n,r,t[11],14,643717713),r=fe(r,a,i,n,t[0],20,-373897302),n=fe(n,r,a,i,t[5],5,-701558691),i=fe(i,n,r,a,t[10],9,38016083),a=fe(a,i,n,r,t[15],14,-660478335),r=fe(r,a,i,n,t[4],20,-405537848),n=fe(n,r,a,i,t[9],5,568446438),i=fe(i,n,r,a,t[14],9,-1019803690),a=fe(a,i,n,r,t[3],14,-187363961),r=fe(r,a,i,n,t[8],20,1163531501),n=fe(n,r,a,i,t[13],5,-1444681467),i=fe(i,n,r,a,t[2],9,-51403784),a=fe(a,i,n,r,t[7],14,1735328473),n=pe(n,r=fe(r,a,i,n,t[12],20,-1926607734),a,i,t[5],4,-378558),i=pe(i,n,r,a,t[8],11,-2022574463),a=pe(a,i,n,r,t[11],16,1839030562),r=pe(r,a,i,n,t[14],23,-35309556),n=pe(n,r,a,i,t[1],4,-1530992060),i=pe(i,n,r,a,t[4],11,1272893353),a=pe(a,i,n,r,t[7],16,-155497632),r=pe(r,a,i,n,t[10],23,-1094730640),n=pe(n,r,a,i,t[13],4,681279174),i=pe(i,n,r,a,t[0],11,-358537222),a=pe(a,i,n,r,t[3],16,-722521979),r=pe(r,a,i,n,t[6],23,76029189),n=pe(n,r,a,i,t[9],4,-640364487),i=pe(i,n,r,a,t[12],11,-421815835),a=pe(a,i,n,r,t[15],16,530742520),n=ge(n,r=pe(r,a,i,n,t[2],23,-995338651),a,i,t[0],6,-198630844),i=ge(i,n,r,a,t[7],10,1126891415),a=ge(a,i,n,r,t[14],15,-1416354905),r=ge(r,a,i,n,t[5],21,-57434055),n=ge(n,r,a,i,t[12],6,1700485571),i=ge(i,n,r,a,t[3],10,-1894986606),a=ge(a,i,n,r,t[10],15,-1051523),r=ge(r,a,i,n,t[1],21,-2054922799),n=ge(n,r,a,i,t[8],6,1873313359),i=ge(i,n,r,a,t[15],10,-30611744),a=ge(a,i,n,r,t[6],15,-1560198380),r=ge(r,a,i,n,t[13],21,1309151649),n=ge(n,r,a,i,t[4],6,-145523070),i=ge(i,n,r,a,t[11],10,-1120210379),a=ge(a,i,n,r,t[2],15,718787259),r=ge(r,a,i,n,t[9],21,-343485551),e[0]=Ne(n,e[0]),e[1]=Ne(r,e[1]),e[2]=Ne(a,e[2]),e[3]=Ne(i,e[3])}function he(e,t,n,r,a,i){return t=Ne(Ne(t,e),Ne(r,i)),Ne(t<<a|t>>>32-a,n)}function de(e,t,n,r,a,i,o){return he(t&n|~t&r,e,t,a,i,o)}function fe(e,t,n,r,a,i,o){return he(t&r|n&~r,e,t,a,i,o)}function pe(e,t,n,r,a,i,o){return he(t^n^r,e,t,a,i,o)}function ge(e,t,n,r,a,i,o){return he(n^(t|~r),e,t,a,i,o)}function me(e){var t,n=e.length,r=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)ue(r,ve(e.substring(t-64,t)));e=e.substring(t-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)a[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(a[t>>2]|=128<<(t%4<<3),t>55)for(ue(r,a),t=0;t<16;t++)a[t]=0;return a[14]=8*n,ue(r,a),r}function ve(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}oe=ee.atob.bind(ee),se=ee.btoa.bind(ee);var be="0123456789abcdef".split("");function xe(e){for(var t="",n=0;n<4;n++)t+=be[e>>8*n+4&15]+be[e>>8*n&15];return t}function ye(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function we(e){return me(e).map(ye).join("")}var ke="5d41402abc4b2a76b9719d911017c592"!=function(e){for(var t=0;t<e.length;t++)e[t]=xe(e[t]);return e.join("")}(me("hello"));function Ne(e,t){if(ke){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}return e+t&4294967295}function Se(e,t){var n,r,a,i;if(e!==n){for(var o=(a=e,i=1+(256/e.length|0),new Array(i+1).join(a)),s=[],l=0;l<256;l++)s[l]=l;var c=0;for(l=0;l<256;l++){var u=s[l];c=(c+u+o.charCodeAt(l))%256,s[l]=s[c],s[c]=u}n=e,r=s}else s=r;var h=t.length,d=0,f=0,p="";for(l=0;l<h;l++)f=(f+(u=s[d=(d+1)%256]))%256,s[d]=s[f],s[f]=u,o=s[(s[d]+s[f])%256],p+=String.fromCharCode(t.charCodeAt(l)^o);return p}var Ce={print:4,modify:8,copy:16,"annot-forms":32};function Ee(e,t,n,r){this.v=1,this.r=2;var a=192;e.forEach(function(e){if(void 0!==Ce.perm)throw new Error("Invalid permission: "+e);a+=Ce[e]}),this.padding="(\xbfN^Nu\x8aAd\0NV\xff\xfa\x01\b..\0\xb6\xd0h>\x80/\f\xa9\xfedSiz";var i=(t+this.padding).substr(0,32),o=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,o),this.P=-(1+(255^a)),this.encryptionKey=we(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=Se(this.encryptionKey,this.padding)}function _e(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",n=e.length,r=0;r<n;r++){var a=e.charCodeAt(r);t+=a<33||35===a||37===a||40===a||41===a||47===a||60===a||62===a||91===a||93===a||123===a||125===a||a>126?"#"+("0"+a.toString(16)).slice(-2):e[r]}return t}function Ie(e){if("object"!==(0,r.A)(e))throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(e,n,r){if(r=r||!1,"string"!=typeof e||"function"!=typeof n||"boolean"!=typeof r)throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(e)||(t[e]={});var a=Math.random().toString(35);return t[e][a]=[n,!!r],a},this.unsubscribe=function(e){for(var n in t)if(t[n][e])return delete t[n][e],0===Object.keys(t[n]).length&&delete t[n],!0;return!1},this.publish=function(n){if(t.hasOwnProperty(n)){var r=Array.prototype.slice.call(arguments,1),a=[];for(var i in t[n]){var o=t[n][i];try{o[0].apply(e,r)}catch(n){ee.console&&ne.error("jsPDF PubSub Error",n.message,n)}o[1]&&a.push(i)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function Te(e){if(!(this instanceof Te))return new Te(e);var t="opacity,stroke-opacity".split(",");for(var n in e)e.hasOwnProperty(n)&&t.indexOf(n)>=0&&(this[n]=e[n]);this.id="",this.objectNumber=-1}function Ae(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function Re(e,t,n,r,a){if(!(this instanceof Re))return new Re(e,t,n,r,a);this.type="axial"===e?2:3,this.coords=t,this.colors=n,Ae.call(this,r,a)}function De(e,t,n,r,a){if(!(this instanceof De))return new De(e,t,n,r,a);this.boundingBox=e,this.xStep=t,this.yStep=n,this.stream="",this.cloneIndex=0,Ae.call(this,r,a)}function Fe(e){var t,n="string"==typeof arguments[0]?arguments[0]:"p",a=arguments[1],i=arguments[2],o=arguments[3],s=[],l=1,c=16,u="S",h=null;"object"===(0,r.A)(e=e||{})&&(n=e.orientation,a=e.unit||a,i=e.format||i,o=e.compress||e.compressPdf||o,null!==(h=e.encryption||null)&&(h.userPassword=h.userPassword||"",h.ownerPassword=h.ownerPassword||"",h.userPermissions=h.userPermissions||[]),l="number"==typeof e.userUnit?Math.abs(e.userUnit):1,void 0!==e.precision&&(t=e.precision),void 0!==e.floatPrecision&&(c=e.floatPrecision),u=e.defaultPathOperation||"S"),s=e.filters||(!0===o?["FlateEncode"]:s),a=a||"mm",n=(""+(n||"P")).toLowerCase();var d=e.putOnlyUsedFonts||!1,f={},p={internal:{},__private__:{}};p.__private__.PubSub=Ie;var g="1.3",m=p.__private__.getPdfVersion=function(){return g};p.__private__.setPdfVersion=function(e){g=e};var v={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};p.__private__.getPageFormats=function(){return v};var b=p.__private__.getPageFormat=function(e){return v[e]};i=i||"a4";var x="compat",y="advanced",w=x;function k(){this.saveGraphicsState(),Q(new He(be,0,0,-be,0,Nn()*be).toString()+" cm"),this.setFontSize(this.getFontSize()/be),u="n",w=y}function N(){this.restoreGraphicsState(),u="S",w=x}var S=p.__private__.combineFontStyleAndFontWeight=function(e,t){if("bold"==e&&"normal"==t||"bold"==e&&400==t||"normal"==e&&"italic"==t||"bold"==e&&"italic"==t)throw new Error("Invalid Combination of fontweight and fontstyle");return t&&(e=400==t||"normal"===t?"italic"===e?"italic":"normal":700!=t&&"bold"!==t||"normal"!==e?(700==t?"bold":t)+""+e:"bold"),e};p.advancedAPI=function(e){var t=w===x;return t&&k.call(this),"function"!=typeof e||(e(this),t&&N.call(this)),this},p.compatAPI=function(e){var t=w===y;return t&&N.call(this),"function"!=typeof e||(e(this),t&&k.call(this)),this},p.isAdvancedAPI=function(){return w===y};var C,E=function(e){if(w!==y)throw new Error(e+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},_=p.roundToPrecision=p.__private__.roundToPrecision=function(e,n){var r=t||n;if(isNaN(e)||isNaN(r))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return e.toFixed(r).replace(/0+$/,"")};C=p.hpf=p.__private__.hpf="number"==typeof c?function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.hpf");return _(e,c)}:"smart"===c?function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.hpf");return _(e,e>-1&&e<1?16:5)}:function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.hpf");return _(e,16)};var I=p.f2=p.__private__.f2=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.f2");return _(e,2)},T=p.__private__.f3=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.f3");return _(e,3)},A=p.scale=p.__private__.scale=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.scale");return w===x?e*be:w===y?e:void 0},R=function(e){return A(function(e){return w===x?Nn()-e:w===y?e:void 0}(e))};p.__private__.setPrecision=p.setPrecision=function(e){"number"==typeof parseInt(e,10)&&(t=parseInt(e,10))};var D,F="00000000000000000000000000000000",O=p.__private__.getFileId=function(){return F},L=p.__private__.setFileId=function(e){return F=void 0!==e&&/^[a-fA-F0-9]{32}$/.test(e)?e.toUpperCase():F.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),null!==h&&(Dt=new Ee(h.userPermissions,h.userPassword,h.ownerPassword,F)),F};p.setFileId=function(e){return L(e),this},p.getFileId=function(){return O()};var P=p.__private__.convertDateToPDFDate=function(e){var t=e.getTimezoneOffset(),n=t<0?"+":"-",r=Math.floor(Math.abs(t/60)),a=Math.abs(t%60),i=[n,W(r),"'",W(a),"'"].join("");return["D:",e.getFullYear(),W(e.getMonth()+1),W(e.getDate()),W(e.getHours()),W(e.getMinutes()),W(e.getSeconds()),i].join("")},M=p.__private__.convertPDFDateToDate=function(e){var t=parseInt(e.substr(2,4),10),n=parseInt(e.substr(6,2),10)-1,r=parseInt(e.substr(8,2),10),a=parseInt(e.substr(10,2),10),i=parseInt(e.substr(12,2),10),o=parseInt(e.substr(14,2),10);return new Date(t,n,r,a,i,o,0)},j=p.__private__.setCreationDate=function(e){var t;if(void 0===e&&(e=new Date),e instanceof Date)t=P(e);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(e))throw new Error("Invalid argument passed to jsPDF.setCreationDate");t=e}return D=t},B=p.__private__.getCreationDate=function(e){var t=D;return"jsDate"===e&&(t=M(D)),t};p.setCreationDate=function(e){return j(e),this},p.getCreationDate=function(e){return B(e)};var z,W=p.__private__.padd2=function(e){return("0"+parseInt(e)).slice(-2)},U=p.__private__.padd2Hex=function(e){return("00"+(e=e.toString())).substr(e.length)},V=0,H=[],G=[],q=0,K=[],X=[],Y=!1,$=G;p.__private__.setCustomOutputDestination=function(e){Y=!0,$=e};var J=function(e){Y||($=e)};p.__private__.resetCustomOutputDestination=function(){Y=!1,$=G};var Q=p.__private__.out=function(e){return e=e.toString(),q+=e.length+1,$.push(e),$},Z=p.__private__.write=function(e){return Q(1===arguments.length?e.toString():Array.prototype.join.call(arguments," "))},te=p.__private__.getArrayBuffer=function(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n);t--;)r[t]=e.charCodeAt(t);return n},re=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];p.__private__.getStandardFonts=function(){return re};var ae=e.fontSize||16;p.__private__.setFontSize=p.setFontSize=function(e){return ae=w===y?e/be:e,this};var ie,oe=p.__private__.getFontSize=p.getFontSize=function(){return w===x?ae:ae*be},ue=e.R2L||!1;p.__private__.setR2L=p.setR2L=function(e){return ue=e,this},p.__private__.getR2L=p.getR2L=function(){return ue};var he,de=p.__private__.setZoomMode=function(e){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(e))ie=e;else if(isNaN(e)){if(-1===[void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(e))throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+e+'" is not recognized.');ie=e}else ie=parseInt(e,10)};p.__private__.getZoomMode=function(){return ie};var fe,pe=p.__private__.setPageMode=function(e){if(-1==[void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(e))throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+e+'" is not recognized.');he=e};p.__private__.getPageMode=function(){return he};var ge=p.__private__.setLayoutMode=function(e){if(-1==[void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(e))throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+e+'" is not recognized.');fe=e};p.__private__.getLayoutMode=function(){return fe},p.__private__.setDisplayMode=p.setDisplayMode=function(e,t,n){return de(e),ge(t),pe(n),this};var me={title:"",subject:"",author:"",keywords:"",creator:""};p.__private__.getDocumentProperty=function(e){if(-1===Object.keys(me).indexOf(e))throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return me[e]},p.__private__.getDocumentProperties=function(){return me},p.__private__.setDocumentProperties=p.setProperties=p.setDocumentProperties=function(e){for(var t in me)me.hasOwnProperty(t)&&e[t]&&(me[t]=e[t]);return this},p.__private__.setDocumentProperty=function(e,t){if(-1===Object.keys(me).indexOf(e))throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return me[e]=t};var ve,be,xe,ye,we,ke={},Ne={},Se=[],Ce={},Ae={},Oe={},Le={},Pe=null,Me=0,je=[],Be=new Ie(p),ze=e.hotfixes||[],We={},Ue={},Ve=[],He=function e(t,n,r,a,i,o){if(!(this instanceof e))return new e(t,n,r,a,i,o);isNaN(t)&&(t=1),isNaN(n)&&(n=0),isNaN(r)&&(r=0),isNaN(a)&&(a=1),isNaN(i)&&(i=0),isNaN(o)&&(o=0),this._matrix=[t,n,r,a,i,o]};Object.defineProperty(He.prototype,"sx",{get:function(){return this._matrix[0]},set:function(e){this._matrix[0]=e}}),Object.defineProperty(He.prototype,"shy",{get:function(){return this._matrix[1]},set:function(e){this._matrix[1]=e}}),Object.defineProperty(He.prototype,"shx",{get:function(){return this._matrix[2]},set:function(e){this._matrix[2]=e}}),Object.defineProperty(He.prototype,"sy",{get:function(){return this._matrix[3]},set:function(e){this._matrix[3]=e}}),Object.defineProperty(He.prototype,"tx",{get:function(){return this._matrix[4]},set:function(e){this._matrix[4]=e}}),Object.defineProperty(He.prototype,"ty",{get:function(){return this._matrix[5]},set:function(e){this._matrix[5]=e}}),Object.defineProperty(He.prototype,"a",{get:function(){return this._matrix[0]},set:function(e){this._matrix[0]=e}}),Object.defineProperty(He.prototype,"b",{get:function(){return this._matrix[1]},set:function(e){this._matrix[1]=e}}),Object.defineProperty(He.prototype,"c",{get:function(){return this._matrix[2]},set:function(e){this._matrix[2]=e}}),Object.defineProperty(He.prototype,"d",{get:function(){return this._matrix[3]},set:function(e){this._matrix[3]=e}}),Object.defineProperty(He.prototype,"e",{get:function(){return this._matrix[4]},set:function(e){this._matrix[4]=e}}),Object.defineProperty(He.prototype,"f",{get:function(){return this._matrix[5]},set:function(e){this._matrix[5]=e}}),Object.defineProperty(He.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(He.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(He.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(He.prototype,"isIdentity",{get:function(){return 1===this.sx&&0===this.shy&&0===this.shx&&1===this.sy&&0===this.tx&&0===this.ty}}),He.prototype.join=function(e){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(C).join(e)},He.prototype.multiply=function(e){var t=e.sx*this.sx+e.shy*this.shx,n=e.sx*this.shy+e.shy*this.sy,r=e.shx*this.sx+e.sy*this.shx,a=e.shx*this.shy+e.sy*this.sy,i=e.tx*this.sx+e.ty*this.shx+this.tx,o=e.tx*this.shy+e.ty*this.sy+this.ty;return new He(t,n,r,a,i,o)},He.prototype.decompose=function(){var e=this.sx,t=this.shy,n=this.shx,r=this.sy,a=this.tx,i=this.ty,o=Math.sqrt(e*e+t*t),s=(e/=o)*n+(t/=o)*r;n-=e*s,r-=t*s;var l=Math.sqrt(n*n+r*r);return s/=l,e*(r/=l)<t*(n/=l)&&(e=-e,t=-t,s=-s,o=-o),{scale:new He(o,0,0,l,0,0),translate:new He(1,0,0,1,a,i),rotate:new He(e,t,-t,e,0,0),skew:new He(1,0,s,1,0,0)}},He.prototype.toString=function(e){return this.join(" ")},He.prototype.inversed=function(){var e=this.sx,t=this.shy,n=this.shx,r=this.sy,a=this.tx,i=this.ty,o=1/(e*r-t*n),s=r*o,l=-t*o,c=-n*o,u=e*o;return new He(s,l,c,u,-s*a-c*i,-l*a-u*i)},He.prototype.applyToPoint=function(e){var t=e.x*this.sx+e.y*this.shx+this.tx,n=e.x*this.shy+e.y*this.sy+this.ty;return new mn(t,n)},He.prototype.applyToRectangle=function(e){var t=this.applyToPoint(e),n=this.applyToPoint(new mn(e.x+e.w,e.y+e.h));return new vn(t.x,t.y,n.x-t.x,n.y-t.y)},He.prototype.clone=function(){var e=this.sx,t=this.shy,n=this.shx,r=this.sy,a=this.tx,i=this.ty;return new He(e,t,n,r,a,i)},p.Matrix=He;var Ge=p.matrixMult=function(e,t){return t.multiply(e)},qe=new He(1,0,0,1,0,0);p.unitMatrix=p.identityMatrix=qe;var Ke=function(e,t){if(!Ae[e]){var n=(t instanceof Re?"Sh":"P")+(Object.keys(Ce).length+1).toString(10);t.id=n,Ae[e]=n,Ce[n]=t,Be.publish("addPattern",t)}};p.ShadingPattern=Re,p.TilingPattern=De,p.addShadingPattern=function(e,t){return E("addShadingPattern()"),Ke(e,t),this},p.beginTilingPattern=function(e){E("beginTilingPattern()"),xn(e.boundingBox[0],e.boundingBox[1],e.boundingBox[2]-e.boundingBox[0],e.boundingBox[3]-e.boundingBox[1],e.matrix)},p.endTilingPattern=function(e,t){E("endTilingPattern()"),t.stream=X[z].join("\n"),Ke(e,t),Be.publish("endTilingPattern",t),Ve.pop().restore()};var Xe,Ye=p.__private__.newObject=function(){var e=$e();return Je(e,!0),e},$e=p.__private__.newObjectDeferred=function(){return V++,H[V]=function(){return q},V},Je=function(e,t){return t="boolean"==typeof t&&t,H[e]=q,t&&Q(e+" 0 obj"),e},Qe=p.__private__.newAdditionalObject=function(){var e={objId:$e(),content:""};return K.push(e),e},Ze=$e(),et=$e(),tt=p.__private__.decodeColorString=function(e){var t=e.split(" ");if(2!==t.length||"g"!==t[1]&&"G"!==t[1])5!==t.length||"k"!==t[4]&&"K"!==t[4]||(t=[(1-t[0])*(1-t[3]),(1-t[1])*(1-t[3]),(1-t[2])*(1-t[3]),"r"]);else{var n=parseFloat(t[0]);t=[n,n,n,"r"]}for(var r="#",a=0;a<3;a++)r+=("0"+Math.floor(255*parseFloat(t[a])).toString(16)).slice(-2);return r},nt=p.__private__.encodeColorString=function(e){var t;"string"==typeof e&&(e={ch1:e});var n=e.ch1,a=e.ch2,i=e.ch3,o=e.ch4,s="draw"===e.pdfColorType?["G","RG","K"]:["g","rg","k"];if("string"==typeof n&&"#"!==n.charAt(0)){var l=new ce(n);if(l.ok)n=l.toHex();else if(!/^\d*\.?\d*$/.test(n))throw new Error('Invalid color "'+n+'" passed to jsPDF.encodeColorString.')}if("string"==typeof n&&/^#[0-9A-Fa-f]{3}$/.test(n)&&(n="#"+n[1]+n[1]+n[2]+n[2]+n[3]+n[3]),"string"==typeof n&&/^#[0-9A-Fa-f]{6}$/.test(n)){var c=parseInt(n.substr(1),16);n=c>>16&255,a=c>>8&255,i=255&c}if(void 0===a||void 0===o&&n===a&&a===i)if("string"==typeof n)t=n+" "+s[0];else if(2===e.precision)t=I(n/255)+" "+s[0];else t=T(n/255)+" "+s[0];else if(void 0===o||"object"===(0,r.A)(o)){if(o&&!isNaN(o.a)&&0===o.a)return["1.","1.","1.",s[1]].join(" ");if("string"==typeof n)t=[n,a,i,s[1]].join(" ");else if(2===e.precision)t=[I(n/255),I(a/255),I(i/255),s[1]].join(" ");else t=[T(n/255),T(a/255),T(i/255),s[1]].join(" ")}else if("string"==typeof n)t=[n,a,i,o,s[2]].join(" ");else if(2===e.precision)t=[I(n),I(a),I(i),I(o),s[2]].join(" ");else t=[T(n),T(a),T(i),T(o),s[2]].join(" ");return t},rt=p.__private__.getFilters=function(){return s},at=p.__private__.putStream=function(e){var t=(e=e||{}).data||"",n=e.filters||rt(),r=e.alreadyAppliedFilters||[],a=e.addLength1||!1,i=t.length,o=e.objectId,s=function(e){return e};if(null!==h&&void 0===o)throw new Error("ObjectId must be passed to putStream for file encryption");null!==h&&(s=Dt.encryptor(o,0));var l={};!0===n&&(n=["FlateEncode"]);var c=e.additionalKeyValues||[],u=(l=void 0!==Fe.API.processDataByFilters?Fe.API.processDataByFilters(t,n):{data:t,reverseChain:[]}).reverseChain+(Array.isArray(r)?r.join(" "):r.toString());if(0!==l.data.length&&(c.push({key:"Length",value:l.data.length}),!0===a&&c.push({key:"Length1",value:i})),0!=u.length)if(u.split("/").length-1==1)c.push({key:"Filter",value:u});else{c.push({key:"Filter",value:"["+u+"]"});for(var d=0;d<c.length;d+=1)if("DecodeParms"===c[d].key){for(var f=[],p=0;p<l.reverseChain.split("/").length-1;p+=1)f.push("null");f.push(c[d].value),c[d].value="["+f.join(" ")+"]"}}Q("<<");for(var g=0;g<c.length;g++)Q("/"+c[g].key+" "+c[g].value);Q(">>"),0!==l.data.length&&(Q("stream"),Q(s(l.data)),Q("endstream"))},it=p.__private__.putPage=function(e){var t=e.number,n=e.data,r=e.objId,a=e.contentsObjId;Je(r,!0),Q("<</Type /Page"),Q("/Parent "+e.rootDictionaryObjId+" 0 R"),Q("/Resources "+e.resourceDictionaryObjId+" 0 R"),Q("/MediaBox ["+parseFloat(C(e.mediaBox.bottomLeftX))+" "+parseFloat(C(e.mediaBox.bottomLeftY))+" "+C(e.mediaBox.topRightX)+" "+C(e.mediaBox.topRightY)+"]"),null!==e.cropBox&&Q("/CropBox ["+C(e.cropBox.bottomLeftX)+" "+C(e.cropBox.bottomLeftY)+" "+C(e.cropBox.topRightX)+" "+C(e.cropBox.topRightY)+"]"),null!==e.bleedBox&&Q("/BleedBox ["+C(e.bleedBox.bottomLeftX)+" "+C(e.bleedBox.bottomLeftY)+" "+C(e.bleedBox.topRightX)+" "+C(e.bleedBox.topRightY)+"]"),null!==e.trimBox&&Q("/TrimBox ["+C(e.trimBox.bottomLeftX)+" "+C(e.trimBox.bottomLeftY)+" "+C(e.trimBox.topRightX)+" "+C(e.trimBox.topRightY)+"]"),null!==e.artBox&&Q("/ArtBox ["+C(e.artBox.bottomLeftX)+" "+C(e.artBox.bottomLeftY)+" "+C(e.artBox.topRightX)+" "+C(e.artBox.topRightY)+"]"),"number"==typeof e.userUnit&&1!==e.userUnit&&Q("/UserUnit "+e.userUnit),Be.publish("putPage",{objId:r,pageContext:je[t],pageNumber:t,page:n}),Q("/Contents "+a+" 0 R"),Q(">>"),Q("endobj");var i=n.join("\n");return w===y&&(i+="\nQ"),Je(a,!0),at({data:i,filters:rt(),objectId:a}),Q("endobj"),r},ot=p.__private__.putPages=function(){var e,t,n=[];for(e=1;e<=Me;e++)je[e].objId=$e(),je[e].contentsObjId=$e();for(e=1;e<=Me;e++)n.push(it({number:e,data:X[e],objId:je[e].objId,contentsObjId:je[e].contentsObjId,mediaBox:je[e].mediaBox,cropBox:je[e].cropBox,bleedBox:je[e].bleedBox,trimBox:je[e].trimBox,artBox:je[e].artBox,userUnit:je[e].userUnit,rootDictionaryObjId:Ze,resourceDictionaryObjId:et}));Je(Ze,!0),Q("<</Type /Pages");var r="/Kids [";for(t=0;t<Me;t++)r+=n[t]+" 0 R ";Q(r+"]"),Q("/Count "+Me),Q(">>"),Q("endobj"),Be.publish("postPutPages")},st=function(e){Be.publish("putFont",{font:e,out:Q,newObject:Ye,putStream:at}),!0!==e.isAlreadyPutted&&(e.objectNumber=Ye(),Q("<<"),Q("/Type /Font"),Q("/BaseFont /"+_e(e.postScriptName)),Q("/Subtype /Type1"),"string"==typeof e.encoding&&Q("/Encoding /"+e.encoding),Q("/FirstChar 32"),Q("/LastChar 255"),Q(">>"),Q("endobj"))},lt=function(e){e.objectNumber=Ye();var t=[];t.push({key:"Type",value:"/XObject"}),t.push({key:"Subtype",value:"/Form"}),t.push({key:"BBox",value:"["+[C(e.x),C(e.y),C(e.x+e.width),C(e.y+e.height)].join(" ")+"]"}),t.push({key:"Matrix",value:"["+e.matrix.toString()+"]"});var n=e.pages[1].join("\n");at({data:n,additionalKeyValues:t,objectId:e.objectNumber}),Q("endobj")},ct=function(e,t){t||(t=21);var n=Ye(),r=function(e,t){var n,r=[],a=1/(t-1);for(n=0;n<1;n+=a)r.push(n);if(r.push(1),0!=e[0].offset){var i={offset:0,color:e[0].color};e.unshift(i)}if(1!=e[e.length-1].offset){var o={offset:1,color:e[e.length-1].color};e.push(o)}for(var s="",l=0,c=0;c<r.length;c++){for(n=r[c];n>e[l+1].offset;)l++;var u=e[l].offset,h=(n-u)/(e[l+1].offset-u),d=e[l].color,f=e[l+1].color;s+=U(Math.round((1-h)*d[0]+h*f[0]).toString(16))+U(Math.round((1-h)*d[1]+h*f[1]).toString(16))+U(Math.round((1-h)*d[2]+h*f[2]).toString(16))}return s.trim()}(e.colors,t),a=[];a.push({key:"FunctionType",value:"0"}),a.push({key:"Domain",value:"[0.0 1.0]"}),a.push({key:"Size",value:"["+t+"]"}),a.push({key:"BitsPerSample",value:"8"}),a.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),a.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),at({data:r,additionalKeyValues:a,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:n}),Q("endobj"),e.objectNumber=Ye(),Q("<< /ShadingType "+e.type),Q("/ColorSpace /DeviceRGB");var i="/Coords ["+C(parseFloat(e.coords[0]))+" "+C(parseFloat(e.coords[1]))+" ";2===e.type?i+=C(parseFloat(e.coords[2]))+" "+C(parseFloat(e.coords[3])):i+=C(parseFloat(e.coords[2]))+" "+C(parseFloat(e.coords[3]))+" "+C(parseFloat(e.coords[4]))+" "+C(parseFloat(e.coords[5])),Q(i+="]"),e.matrix&&Q("/Matrix ["+e.matrix.toString()+"]"),Q("/Function "+n+" 0 R"),Q("/Extend [true true]"),Q(">>"),Q("endobj")},ut=function(e,t){var n=$e(),r=Ye();t.push({resourcesOid:n,objectOid:r}),e.objectNumber=r;var a=[];a.push({key:"Type",value:"/Pattern"}),a.push({key:"PatternType",value:"1"}),a.push({key:"PaintType",value:"1"}),a.push({key:"TilingType",value:"1"}),a.push({key:"BBox",value:"["+e.boundingBox.map(C).join(" ")+"]"}),a.push({key:"XStep",value:C(e.xStep)}),a.push({key:"YStep",value:C(e.yStep)}),a.push({key:"Resources",value:n+" 0 R"}),e.matrix&&a.push({key:"Matrix",value:"["+e.matrix.toString()+"]"}),at({data:e.stream,additionalKeyValues:a,objectId:e.objectNumber}),Q("endobj")},ht=function(e){for(var t in e.objectNumber=Ye(),Q("<<"),e)switch(t){case"opacity":Q("/ca "+I(e[t]));break;case"stroke-opacity":Q("/CA "+I(e[t]))}Q(">>"),Q("endobj")},dt=function(e){Je(e.resourcesOid,!0),Q("<<"),Q("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var e in Q("/Font <<"),ke)ke.hasOwnProperty(e)&&(!1===d||!0===d&&f.hasOwnProperty(e))&&Q("/"+e+" "+ke[e].objectNumber+" 0 R");Q(">>")}(),function(){if(Object.keys(Ce).length>0){for(var e in Q("/Shading <<"),Ce)Ce.hasOwnProperty(e)&&Ce[e]instanceof Re&&Ce[e].objectNumber>=0&&Q("/"+e+" "+Ce[e].objectNumber+" 0 R");Be.publish("putShadingPatternDict"),Q(">>")}}(),function(e){if(Object.keys(Ce).length>0){for(var t in Q("/Pattern <<"),Ce)Ce.hasOwnProperty(t)&&Ce[t]instanceof p.TilingPattern&&Ce[t].objectNumber>=0&&Ce[t].objectNumber<e&&Q("/"+t+" "+Ce[t].objectNumber+" 0 R");Be.publish("putTilingPatternDict"),Q(">>")}}(e.objectOid),function(){if(Object.keys(Oe).length>0){var e;for(e in Q("/ExtGState <<"),Oe)Oe.hasOwnProperty(e)&&Oe[e].objectNumber>=0&&Q("/"+e+" "+Oe[e].objectNumber+" 0 R");Be.publish("putGStateDict"),Q(">>")}}(),function(){for(var e in Q("/XObject <<"),We)We.hasOwnProperty(e)&&We[e].objectNumber>=0&&Q("/"+e+" "+We[e].objectNumber+" 0 R");Be.publish("putXobjectDict"),Q(">>")}(),Q(">>"),Q("endobj")},ft=function(){var e=[];(function(){for(var e in ke)ke.hasOwnProperty(e)&&(!1===d||!0===d&&f.hasOwnProperty(e))&&st(ke[e])})(),function(){var e;for(e in Oe)Oe.hasOwnProperty(e)&&ht(Oe[e])}(),function(){for(var e in We)We.hasOwnProperty(e)&&lt(We[e])}(),function(e){var t;for(t in Ce)Ce.hasOwnProperty(t)&&(Ce[t]instanceof Re?ct(Ce[t]):Ce[t]instanceof De&&ut(Ce[t],e))}(e),Be.publish("putResources"),e.forEach(dt),dt({resourcesOid:et,objectOid:Number.MAX_SAFE_INTEGER}),Be.publish("postPutResources")},pt=function(e){Ne[e.fontName]=Ne[e.fontName]||{},Ne[e.fontName][e.fontStyle]=e.id},gt=function(e,t,n,r,a){var i={id:"F"+(Object.keys(ke).length+1).toString(10),postScriptName:e,fontName:t,fontStyle:n,encoding:r,isStandardFont:a||!1,metadata:{}};return Be.publish("addFont",{font:i,instance:this}),ke[i.id]=i,pt(i),i.id},mt=p.__private__.pdfEscape=p.pdfEscape=function(e,t){return function(e,t){var n,r,a,i,o,s,l,c,u;if(a=(t=t||{}).sourceEncoding||"Unicode",o=t.outputEncoding,(t.autoencode||o)&&ke[ve].metadata&&ke[ve].metadata[a]&&ke[ve].metadata[a].encoding&&(i=ke[ve].metadata[a].encoding,!o&&ke[ve].encoding&&(o=ke[ve].encoding),!o&&i.codePages&&(o=i.codePages[0]),"string"==typeof o&&(o=i[o]),o)){for(l=!1,s=[],n=0,r=e.length;n<r;n++)(c=o[e.charCodeAt(n)])?s.push(String.fromCharCode(c)):s.push(e[n]),s[n].charCodeAt(0)>>8&&(l=!0);e=s.join("")}for(n=e.length;void 0===l&&0!==n;)e.charCodeAt(n-1)>>8&&(l=!0),n--;if(!l)return e;for(s=t.noBOM?[]:[254,255],n=0,r=e.length;n<r;n++){if((u=(c=e.charCodeAt(n))>>8)>>8)throw new Error("Character at position "+n+" of string '"+e+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");s.push(u),s.push(c-(u<<8))}return String.fromCharCode.apply(void 0,s)}(e,t).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},vt=p.__private__.beginPage=function(e){X[++Me]=[],je[Me]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(e[0]),topRightY:Number(e[1])}},yt(Me),J(X[z])},bt=function(e,t){var r,a,o;switch(n=t||n,"string"==typeof e&&(r=b(e.toLowerCase()),Array.isArray(r)&&(a=r[0],o=r[1])),Array.isArray(e)&&(a=e[0]*be,o=e[1]*be),isNaN(a)&&(a=i[0],o=i[1]),(a>14400||o>14400)&&(ne.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),a=Math.min(14400,a),o=Math.min(14400,o)),i=[a,o],n.substr(0,1)){case"l":o>a&&(i=[o,a]);break;case"p":a>o&&(i=[o,a])}vt(i),Qt($t),Q(sn),0!==fn&&Q(fn+" J"),0!==pn&&Q(pn+" j"),Be.publish("addPage",{pageNumber:Me})},xt=function(e){e>0&&e<=Me&&(X.splice(e,1),je.splice(e,1),Me--,z>Me&&(z=Me),this.setPage(z))},yt=function(e){e>0&&e<=Me&&(z=e)},wt=p.__private__.getNumberOfPages=p.getNumberOfPages=function(){return X.length-1},kt=function(e,t,n){var r,a=void 0;return n=n||{},e=void 0!==e?e:ke[ve].fontName,t=void 0!==t?t:ke[ve].fontStyle,r=e.toLowerCase(),void 0!==Ne[r]&&void 0!==Ne[r][t]?a=Ne[r][t]:void 0!==Ne[e]&&void 0!==Ne[e][t]?a=Ne[e][t]:!1===n.disableWarning&&ne.warn("Unable to look up font label for font '"+e+"', '"+t+"'. Refer to getFontList() for available fonts."),a||n.noFallback||null==(a=Ne.times[t])&&(a=Ne.times.normal),a},Nt=p.__private__.putInfo=function(){var e=Ye(),t=function(e){return e};for(var n in null!==h&&(t=Dt.encryptor(e,0)),Q("<<"),Q("/Producer ("+mt(t("jsPDF "+Fe.version))+")"),me)me.hasOwnProperty(n)&&me[n]&&Q("/"+n.substr(0,1).toUpperCase()+n.substr(1)+" ("+mt(t(me[n]))+")");Q("/CreationDate ("+mt(t(D))+")"),Q(">>"),Q("endobj")},St=p.__private__.putCatalog=function(e){var t=(e=e||{}).rootDictionaryObjId||Ze;switch(Ye(),Q("<<"),Q("/Type /Catalog"),Q("/Pages "+t+" 0 R"),ie||(ie="fullwidth"),ie){case"fullwidth":Q("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Q("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Q("/OpenAction [3 0 R /Fit]");break;case"original":Q("/OpenAction [3 0 R /XYZ null null 1]");break;default:var n=""+ie;"%"===n.substr(n.length-1)&&(ie=parseInt(ie)/100),"number"==typeof ie&&Q("/OpenAction [3 0 R /XYZ null null "+I(ie)+"]")}switch(fe||(fe="continuous"),fe){case"continuous":Q("/PageLayout /OneColumn");break;case"single":Q("/PageLayout /SinglePage");break;case"two":case"twoleft":Q("/PageLayout /TwoColumnLeft");break;case"tworight":Q("/PageLayout /TwoColumnRight")}he&&Q("/PageMode /"+he),Be.publish("putCatalog"),Q(">>"),Q("endobj")},Ct=p.__private__.putTrailer=function(){Q("trailer"),Q("<<"),Q("/Size "+(V+1)),Q("/Root "+V+" 0 R"),Q("/Info "+(V-1)+" 0 R"),null!==h&&Q("/Encrypt "+Dt.oid+" 0 R"),Q("/ID [ <"+F+"> <"+F+"> ]"),Q(">>")},Et=p.__private__.putHeader=function(){Q("%PDF-"+g),Q("%\xba\xdf\xac\xe0")},_t=p.__private__.putXRef=function(){var e="0000000000";Q("xref"),Q("0 "+(V+1)),Q("0000000000 65535 f ");for(var t=1;t<=V;t++)"function"==typeof H[t]?Q((e+H[t]()).slice(-10)+" 00000 n "):void 0!==H[t]?Q((e+H[t]).slice(-10)+" 00000 n "):Q("0000000000 00000 n ")},It=p.__private__.buildDocument=function(){V=0,q=0,G=[],H=[],K=[],Ze=$e(),et=$e(),J(G),Be.publish("buildDocument"),Et(),ot(),function(){Be.publish("putAdditionalObjects");for(var e=0;e<K.length;e++){var t=K[e];Je(t.objId,!0),Q(t.content),Q("endobj")}Be.publish("postPutAdditionalObjects")}(),ft(),null!==h&&(Dt.oid=Ye(),Q("<<"),Q("/Filter /Standard"),Q("/V "+Dt.v),Q("/R "+Dt.r),Q("/U <"+Dt.toHexString(Dt.U)+">"),Q("/O <"+Dt.toHexString(Dt.O)+">"),Q("/P "+Dt.P),Q(">>"),Q("endobj")),Nt(),St();var e=q;return _t(),Ct(),Q("startxref"),Q(""+e),Q("%%EOF"),J(X[z]),G.join("\n")},Tt=p.__private__.getBlob=function(e){return new Blob([te(e)],{type:"application/pdf"})},At=p.output=p.__private__.output=(Xe=function(e,t){switch("string"==typeof(t=t||{})?t={filename:t}:t.filename=t.filename||"generated.pdf",e){case void 0:return It();case"save":p.save(t.filename);break;case"arraybuffer":return te(It());case"blob":return Tt(It());case"bloburi":case"bloburl":if(void 0!==ee.URL&&"function"==typeof ee.URL.createObjectURL)return ee.URL&&ee.URL.createObjectURL(Tt(It()))||void 0;ne.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var n="",r=It();try{n=se(r)}catch(e){n=se(unescape(encodeURIComponent(r)))}return"data:application/pdf;filename="+t.filename+";base64,"+n;case"pdfobjectnewwindow":if("[object Window]"===Object.prototype.toString.call(ee)){var a="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",i=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';t.pdfObjectUrl&&(a=t.pdfObjectUrl,i="");var o='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+a+'"'+i+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(t)+");<\/script></body></html>",s=ee.open();return null!==s&&s.document.write(o),s}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if("[object Window]"===Object.prototype.toString.call(ee)){var l='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(t.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+t.filename+'" width="500px" height="400px" /></body></html>',c=ee.open();if(null!==c){c.document.write(l);var u=this;c.document.documentElement.querySelector("#pdfViewer").onload=function(){c.document.title=t.filename,c.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(u.output("bloburl"))}}return c}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if("[object Window]"!==Object.prototype.toString.call(ee))throw new Error("The option dataurlnewwindow just works in a browser-environment.");var h='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",t)+'"></iframe></body></html>',d=ee.open();if(null!==d&&(d.document.write(h),d.document.title=t.filename),d||"undefined"==typeof safari)return d;break;case"datauri":case"dataurl":return ee.document.location.href=this.output("datauristring",t);default:return null}},Xe.foo=function(){try{return Xe.apply(this,arguments)}catch(Xe){var e=Xe.stack||"";~e.indexOf(" at ")&&(e=e.split(" at ")[1]);var t="Error in function "+e.split("\n")[0].split("<")[0]+": "+Xe.message;if(!ee.console)throw new Error(t);ee.console.error(t,Xe),ee.alert&&alert(t)}},Xe.foo.bar=Xe,Xe.foo),Rt=function(e){return!0===Array.isArray(ze)&&ze.indexOf(e)>-1};switch(a){case"pt":be=1;break;case"mm":be=72/25.4;break;case"cm":be=72/2.54;break;case"in":be=72;break;case"px":be=1==Rt("px_scaling")?.75:96/72;break;case"pc":case"em":be=12;break;case"ex":be=6;break;default:if("number"!=typeof a)throw new Error("Invalid unit: "+a);be=a}var Dt=null;j(),L();var Ft=p.__private__.getPageInfo=p.getPageInfo=function(e){if(isNaN(e)||e%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:je[e].objId,pageNumber:e,pageContext:je[e]}},Ot=p.__private__.getPageInfoByObjId=function(e){if(isNaN(e)||e%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var t in je)if(je[t].objId===e)break;return Ft(t)},Lt=p.__private__.getCurrentPageInfo=p.getCurrentPageInfo=function(){return{objId:je[z].objId,pageNumber:z,pageContext:je[z]}};p.addPage=function(){return bt.apply(this,arguments),this},p.setPage=function(){return yt.apply(this,arguments),J.call(this,X[z]),this},p.insertPage=function(e){return this.addPage(),this.movePage(z,e),this},p.movePage=function(e,t){var n,r;if(e>t){n=X[e],r=je[e];for(var a=e;a>t;a--)X[a]=X[a-1],je[a]=je[a-1];X[t]=n,je[t]=r,this.setPage(t)}else if(e<t){n=X[e],r=je[e];for(var i=e;i<t;i++)X[i]=X[i+1],je[i]=je[i+1];X[t]=n,je[t]=r,this.setPage(t)}return this},p.deletePage=function(){return xt.apply(this,arguments),this},p.__private__.text=p.text=function(e,t,n,a,i){var o,s,l,c,u,h,d,p,g,m=(a=a||{}).scope||this;if("number"==typeof e&&"number"==typeof t&&("string"==typeof n||Array.isArray(n))){var v=n;n=t,t=e,e=v}if(arguments[3]instanceof He==0?(l=arguments[4],c=arguments[5],"object"===(0,r.A)(d=arguments[3])&&null!==d||("string"==typeof l&&(c=l,l=null),"string"==typeof d&&(c=d,d=null),"number"==typeof d&&(l=d,d=null),a={flags:d,angle:l,align:c})):(E("The transform parameter of text() with a Matrix value"),g=i),isNaN(t)||isNaN(n)||null==e)throw new Error("Invalid arguments passed to jsPDF.text");if(0===e.length)return m;var b,x="",k="number"==typeof a.lineHeightFactor?a.lineHeightFactor:Yt,N=m.internal.scaleFactor;function S(e){return e=e.split("\t").join(Array(a.TabLen||9).join(" ")),mt(e,d)}function _(e){for(var t,n=e.concat(),r=[],a=n.length;a--;)"string"==typeof(t=n.shift())?r.push(t):Array.isArray(e)&&(1===t.length||void 0===t[1]&&void 0===t[2])?r.push(t[0]):r.push([t[0],t[1],t[2]]);return r}function I(e,t){var n;if("string"==typeof e)n=t(e)[0];else if(Array.isArray(e)){for(var r,a,i=e.concat(),o=[],s=i.length;s--;)"string"==typeof(r=i.shift())?o.push(t(r)[0]):Array.isArray(r)&&"string"==typeof r[0]&&(a=t(r[0],r[1],r[2]),o.push([a[0],a[1],a[2]]));n=o}return n}var T=!1,R=!0;if("string"==typeof e)T=!0;else if(Array.isArray(e)){var D=e.concat();s=[];for(var F,O=D.length;O--;)("string"!=typeof(F=D.shift())||Array.isArray(F)&&"string"!=typeof F[0])&&(R=!1);T=R}if(!1===T)throw new Error('Type of text must be string or Array. "'+e+'" is not recognized.');"string"==typeof e&&(e=e.match(/[\r?\n]/)?e.split(/\r\n|\r|\n/g):[e]);var L=ae/m.internal.scaleFactor,P=L*(k-1);switch(a.baseline){case"bottom":n-=P;break;case"top":n+=L-P;break;case"hanging":n+=L-2*P;break;case"middle":n+=L/2-P}if((h=a.maxWidth||0)>0&&("string"==typeof e?e=m.splitTextToSize(e,h):"[object Array]"===Object.prototype.toString.call(e)&&(e=e.reduce(function(e,t){return e.concat(m.splitTextToSize(t,h))},[]))),o={text:e,x:t,y:n,options:a,mutex:{pdfEscape:mt,activeFontKey:ve,fonts:ke,activeFontSize:ae}},Be.publish("preProcessText",o),e=o.text,l=(a=o.options).angle,g instanceof He==0&&l&&"number"==typeof l){l*=Math.PI/180,0===a.rotationDirection&&(l=-l),w===y&&(l=-l);var M=Math.cos(l),j=Math.sin(l);g=new He(M,j,-j,M,0,0)}else l&&l instanceof He&&(g=l);w!==y||g||(g=qe),void 0!==(u=a.charSpace||hn)&&(x+=C(A(u))+" Tc\n",this.setCharSpace(this.getCharSpace()||0)),void 0!==(p=a.horizontalScale)&&(x+=C(100*p)+" Tz\n"),a.lang;var B=-1,z=void 0!==a.renderingMode?a.renderingMode:a.stroke,W=m.internal.getCurrentPageInfo().pageContext;switch(z){case 0:case!1:case"fill":B=0;break;case 1:case!0:case"stroke":B=1;break;case 2:case"fillThenStroke":B=2;break;case 3:case"invisible":B=3;break;case 4:case"fillAndAddForClipping":B=4;break;case 5:case"strokeAndAddPathForClipping":B=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":B=6;break;case 7:case"addToPathForClipping":B=7}var U=void 0!==W.usedRenderingMode?W.usedRenderingMode:-1;-1!==B?x+=B+" Tr\n":-1!==U&&(x+="0 Tr\n"),-1!==B&&(W.usedRenderingMode=B),c=a.align||"left";var V,H=ae*k,G=m.internal.pageSize.getWidth(),q=ke[ve];u=a.charSpace||hn,h=a.maxWidth||0,d=Object.assign({autoencode:!0,noBOM:!0},a.flags);var K=[],X=function(e){return m.getStringUnitWidth(e,{font:q,charSpace:u,fontSize:ae,doKerning:!1})*ae/N};if("[object Array]"===Object.prototype.toString.call(e)){var Y;s=_(e),"left"!==c&&(V=s.map(X));var $,J=0;if("right"===c){t-=V[0],e=[],O=s.length;for(var Z=0;Z<O;Z++)0===Z?($=nn(t),Y=rn(n)):($=A(J-V[Z]),Y=-H),e.push([s[Z],$,Y]),J=V[Z]}else if("center"===c){t-=V[0]/2,e=[],O=s.length;for(var ee=0;ee<O;ee++)0===ee?($=nn(t),Y=rn(n)):($=A((J-V[ee])/2),Y=-H),e.push([s[ee],$,Y]),J=V[ee]}else if("left"===c){e=[],O=s.length;for(var te=0;te<O;te++)e.push(s[te])}else if("justify"===c&&"Identity-H"===q.encoding){e=[],O=s.length,h=0!==h?h:G;for(var ne=0,re=0;re<O;re++)if(Y=0===re?rn(n):-H,$=0===re?nn(t):ne,re<O-1){var ie=A((h-V[re])/(s[re].split(" ").length-1)),oe=s[re].split(" ");e.push([oe[0]+" ",$,Y]),ne=0;for(var se=1;se<oe.length;se++){var le=(X(oe[se-1]+" "+oe[se])-X(oe[se]))*N+ie;se==oe.length-1?e.push([oe[se],le,0]):e.push([oe[se]+" ",le,0]),ne-=le}}else e.push([s[re],$,Y]);e.push(["",ne,0])}else{if("justify"!==c)throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(e=[],O=s.length,h=0!==h?h:G,re=0;re<O;re++)Y=0===re?rn(n):-H,$=0===re?nn(t):0,re<O-1?K.push(C(A((h-V[re])/(s[re].split(" ").length-1)))):K.push(0),e.push([s[re],$,Y])}}!0===("boolean"==typeof a.R2L?a.R2L:ue)&&(e=I(e,function(e,t,n){return[e.split("").reverse().join(""),t,n]})),o={text:e,x:t,y:n,options:a,mutex:{pdfEscape:mt,activeFontKey:ve,fonts:ke,activeFontSize:ae}},Be.publish("postProcessText",o),e=o.text,b=o.mutex.isHex||!1;var ce=ke[ve].encoding;"WinAnsiEncoding"!==ce&&"StandardEncoding"!==ce||(e=I(e,function(e,t,n){return[S(e),t,n]})),s=_(e),e=[];for(var he,de,fe,pe=Array.isArray(s[0])?1:0,ge="",me=function(e,t,n){var r="";return n instanceof He?(n="number"==typeof a.angle?Ge(n,new He(1,0,0,1,e,t)):Ge(new He(1,0,0,1,e,t),n),w===y&&(n=Ge(new He(1,0,0,-1,0,0),n)),r=n.join(" ")+" Tm\n"):r=C(e)+" "+C(t)+" Td\n",r},be=0;be<s.length;be++){switch(ge="",pe){case 1:fe=(b?"<":"(")+s[be][0]+(b?">":")"),he=parseFloat(s[be][1]),de=parseFloat(s[be][2]);break;case 0:fe=(b?"<":"(")+s[be]+(b?">":")"),he=nn(t),de=rn(n)}void 0!==K&&void 0!==K[be]&&(ge=K[be]+" Tw\n"),0===be?e.push(ge+me(he,de,g)+fe):0===pe?e.push(ge+fe):1===pe&&e.push(ge+me(he,de,g)+fe)}e=0===pe?e.join(" Tj\nT* "):e.join(" Tj\n"),e+=" Tj\n";var xe="BT\n/";return xe+=ve+" "+ae+" Tf\n",xe+=C(ae*k)+" TL\n",xe+=cn+"\n",xe+=x,xe+=e,Q(xe+="ET"),f[ve]=!0,m};var Pt=p.__private__.clip=p.clip=function(e){return Q("evenodd"===e?"W*":"W"),this};p.clipEvenOdd=function(){return Pt("evenodd")},p.__private__.discardPath=p.discardPath=function(){return Q("n"),this};var Mt=p.__private__.isValidStyle=function(e){var t=!1;return-1!==[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(e)&&(t=!0),t};p.__private__.setDefaultPathOperation=p.setDefaultPathOperation=function(e){return Mt(e)&&(u=e),this};var jt=p.__private__.getStyle=p.getStyle=function(e){var t=u;switch(e){case"D":case"S":t="S";break;case"F":t="f";break;case"FD":case"DF":t="B";break;case"f":case"f*":case"B":case"B*":t=e}return t},Bt=p.close=function(){return Q("h"),this};p.stroke=function(){return Q("S"),this},p.fill=function(e){return zt("f",e),this},p.fillEvenOdd=function(e){return zt("f*",e),this},p.fillStroke=function(e){return zt("B",e),this},p.fillStrokeEvenOdd=function(e){return zt("B*",e),this};var zt=function(e,t){"object"===(0,r.A)(t)?Vt(t,e):Q(e)},Wt=function(e){null===e||w===y&&void 0===e||(e=jt(e),Q(e))};function Ut(e,t,n,r,a){var i=new De(t||this.boundingBox,n||this.xStep,r||this.yStep,this.gState,a||this.matrix);i.stream=this.stream;var o=e+"$$"+this.cloneIndex+++"$$";return Ke(o,i),i}var Vt=function(e,t){var n=Ae[e.key],r=Ce[n];if(r instanceof Re)Q("q"),Q(Ht(t)),r.gState&&p.setGState(r.gState),Q(e.matrix.toString()+" cm"),Q("/"+n+" sh"),Q("Q");else if(r instanceof De){var a=new He(1,0,0,-1,0,Nn());e.matrix&&(a=a.multiply(e.matrix||qe),n=Ut.call(r,e.key,e.boundingBox,e.xStep,e.yStep,a).id),Q("q"),Q("/Pattern cs"),Q("/"+n+" scn"),r.gState&&p.setGState(r.gState),Q(t),Q("Q")}},Ht=function(e){switch(e){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Gt=p.moveTo=function(e,t){return Q(C(A(e))+" "+C(R(t))+" m"),this},qt=p.lineTo=function(e,t){return Q(C(A(e))+" "+C(R(t))+" l"),this},Kt=p.curveTo=function(e,t,n,r,a,i){return Q([C(A(e)),C(R(t)),C(A(n)),C(R(r)),C(A(a)),C(R(i)),"c"].join(" ")),this};p.__private__.line=p.line=function(e,t,n,r,a){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r)||!Mt(a))throw new Error("Invalid arguments passed to jsPDF.line");return w===x?this.lines([[n-e,r-t]],e,t,[1,1],a||"S"):this.lines([[n-e,r-t]],e,t,[1,1]).stroke()},p.__private__.lines=p.lines=function(e,t,n,r,a,i){var o,s,l,c,u,h,d,f,p,g,m,v;if("number"==typeof e&&(v=n,n=t,t=e,e=v),r=r||[1,1],i=i||!1,isNaN(t)||isNaN(n)||!Array.isArray(e)||!Array.isArray(r)||!Mt(a)||"boolean"!=typeof i)throw new Error("Invalid arguments passed to jsPDF.lines");for(Gt(t,n),o=r[0],s=r[1],c=e.length,g=t,m=n,l=0;l<c;l++)2===(u=e[l]).length?(g=u[0]*o+g,m=u[1]*s+m,qt(g,m)):(h=u[0]*o+g,d=u[1]*s+m,f=u[2]*o+g,p=u[3]*s+m,g=u[4]*o+g,m=u[5]*s+m,Kt(h,d,f,p,g,m));return i&&Bt(),Wt(a),this},p.path=function(e){for(var t=0;t<e.length;t++){var n=e[t],r=n.c;switch(n.op){case"m":Gt(r[0],r[1]);break;case"l":qt(r[0],r[1]);break;case"c":Kt.apply(this,r);break;case"h":Bt()}}return this},p.__private__.rect=p.rect=function(e,t,n,r,a){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r)||!Mt(a))throw new Error("Invalid arguments passed to jsPDF.rect");return w===x&&(r=-r),Q([C(A(e)),C(R(t)),C(A(n)),C(A(r)),"re"].join(" ")),Wt(a),this},p.__private__.triangle=p.triangle=function(e,t,n,r,a,i,o){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r)||isNaN(a)||isNaN(i)||!Mt(o))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[n-e,r-t],[a-n,i-r],[e-a,t-i]],e,t,[1,1],o,!0),this},p.__private__.roundedRect=p.roundedRect=function(e,t,n,r,a,i,o){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r)||isNaN(a)||isNaN(i)||!Mt(o))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var s=4/3*(Math.SQRT2-1);return a=Math.min(a,.5*n),i=Math.min(i,.5*r),this.lines([[n-2*a,0],[a*s,0,a,i-i*s,a,i],[0,r-2*i],[0,i*s,-a*s,i,-a,i],[2*a-n,0],[-a*s,0,-a,-i*s,-a,-i],[0,2*i-r],[0,-i*s,a*s,-i,a,-i]],e+a,t,[1,1],o,!0),this},p.__private__.ellipse=p.ellipse=function(e,t,n,r,a){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r)||!Mt(a))throw new Error("Invalid arguments passed to jsPDF.ellipse");var i=4/3*(Math.SQRT2-1)*n,o=4/3*(Math.SQRT2-1)*r;return Gt(e+n,t),Kt(e+n,t-o,e+i,t-r,e,t-r),Kt(e-i,t-r,e-n,t-o,e-n,t),Kt(e-n,t+o,e-i,t+r,e,t+r),Kt(e+i,t+r,e+n,t+o,e+n,t),Wt(a),this},p.__private__.circle=p.circle=function(e,t,n,r){if(isNaN(e)||isNaN(t)||isNaN(n)||!Mt(r))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(e,t,n,n,r)},p.setFont=function(e,t,n){return n&&(t=S(t,n)),ve=kt(e,t,{disableWarning:!1}),this};var Xt=p.__private__.getFont=p.getFont=function(){return ke[kt.apply(p,arguments)]};p.__private__.getFontList=p.getFontList=function(){var e,t,n={};for(e in Ne)if(Ne.hasOwnProperty(e))for(t in n[e]=[],Ne[e])Ne[e].hasOwnProperty(t)&&n[e].push(t);return n},p.addFont=function(e,t,n,r,a){var i=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&-1!==i.indexOf(arguments[3])?a=arguments[3]:arguments[3]&&-1==i.indexOf(arguments[3])&&(n=S(n,r)),gt.call(this,e,t,n,a=a||"Identity-H")};var Yt,$t=e.lineWidth||.200025,Jt=p.__private__.getLineWidth=p.getLineWidth=function(){return $t},Qt=p.__private__.setLineWidth=p.setLineWidth=function(e){return $t=e,Q(C(A(e))+" w"),this};p.__private__.setLineDash=Fe.API.setLineDash=Fe.API.setLineDashPattern=function(e,t){if(e=e||[],t=t||0,isNaN(t)||!Array.isArray(e))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return e=e.map(function(e){return C(A(e))}).join(" "),t=C(A(t)),Q("["+e+"] "+t+" d"),this};var Zt=p.__private__.getLineHeight=p.getLineHeight=function(){return ae*Yt};p.__private__.getLineHeight=p.getLineHeight=function(){return ae*Yt};var en=p.__private__.setLineHeightFactor=p.setLineHeightFactor=function(e){return"number"==typeof(e=e||1.15)&&(Yt=e),this},tn=p.__private__.getLineHeightFactor=p.getLineHeightFactor=function(){return Yt};en(e.lineHeight);var nn=p.__private__.getHorizontalCoordinate=function(e){return A(e)},rn=p.__private__.getVerticalCoordinate=function(e){return w===y?e:je[z].mediaBox.topRightY-je[z].mediaBox.bottomLeftY-A(e)},an=p.__private__.getHorizontalCoordinateString=p.getHorizontalCoordinateString=function(e){return C(nn(e))},on=p.__private__.getVerticalCoordinateString=p.getVerticalCoordinateString=function(e){return C(rn(e))},sn=e.strokeColor||"0 G";p.__private__.getStrokeColor=p.getDrawColor=function(){return tt(sn)},p.__private__.setStrokeColor=p.setDrawColor=function(e,t,n,r){return sn=nt({ch1:e,ch2:t,ch3:n,ch4:r,pdfColorType:"draw",precision:2}),Q(sn),this};var ln=e.fillColor||"0 g";p.__private__.getFillColor=p.getFillColor=function(){return tt(ln)},p.__private__.setFillColor=p.setFillColor=function(e,t,n,r){return ln=nt({ch1:e,ch2:t,ch3:n,ch4:r,pdfColorType:"fill",precision:2}),Q(ln),this};var cn=e.textColor||"0 g",un=p.__private__.getTextColor=p.getTextColor=function(){return tt(cn)};p.__private__.setTextColor=p.setTextColor=function(e,t,n,r){return cn=nt({ch1:e,ch2:t,ch3:n,ch4:r,pdfColorType:"text",precision:3}),this};var hn=e.charSpace,dn=p.__private__.getCharSpace=p.getCharSpace=function(){return parseFloat(hn||0)};p.__private__.setCharSpace=p.setCharSpace=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return hn=e,this};var fn=0;p.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},p.__private__.setLineCap=p.setLineCap=function(e){var t=p.CapJoinStyles[e];if(void 0===t)throw new Error("Line cap style of '"+e+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return fn=t,Q(t+" J"),this};var pn=0;p.__private__.setLineJoin=p.setLineJoin=function(e){var t=p.CapJoinStyles[e];if(void 0===t)throw new Error("Line join style of '"+e+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return pn=t,Q(t+" j"),this},p.__private__.setLineMiterLimit=p.__private__.setMiterLimit=p.setLineMiterLimit=p.setMiterLimit=function(e){if(e=e||0,isNaN(e))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Q(C(A(e))+" M"),this},p.GState=Te,p.setGState=function(e){(e="string"==typeof e?Oe[Le[e]]:gn(null,e)).equals(Pe)||(Q("/"+e.id+" gs"),Pe=e)};var gn=function(e,t){if(!e||!Le[e]){var n=!1;for(var r in Oe)if(Oe.hasOwnProperty(r)&&Oe[r].equals(t)){n=!0;break}if(n)t=Oe[r];else{var a="GS"+(Object.keys(Oe).length+1).toString(10);Oe[a]=t,t.id=a}return e&&(Le[e]=t.id),Be.publish("addGState",t),t}};p.addGState=function(e,t){return gn(e,t),this},p.saveGraphicsState=function(){return Q("q"),Se.push({key:ve,size:ae,color:cn}),this},p.restoreGraphicsState=function(){Q("Q");var e=Se.pop();return ve=e.key,ae=e.size,cn=e.color,Pe=null,this},p.setCurrentTransformationMatrix=function(e){return Q(e.toString()+" cm"),this},p.comment=function(e){return Q("#"+e),this};var mn=function(e,t){var n=e||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return n},set:function(e){isNaN(e)||(n=parseFloat(e))}});var r=t||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return r},set:function(e){isNaN(e)||(r=parseFloat(e))}});var a="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return a},set:function(e){a=e.toString()}}),this},vn=function(e,t,n,r){mn.call(this,e,t),this.type="rect";var a=n||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return a},set:function(e){isNaN(e)||(a=parseFloat(e))}});var i=r||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return i},set:function(e){isNaN(e)||(i=parseFloat(e))}}),this},bn=function(){this.page=Me,this.currentPage=z,this.pages=X.slice(0),this.pagesContext=je.slice(0),this.x=xe,this.y=ye,this.matrix=we,this.width=wn(z),this.height=Nn(z),this.outputDestination=$,this.id="",this.objectNumber=-1};bn.prototype.restore=function(){Me=this.page,z=this.currentPage,je=this.pagesContext,X=this.pages,xe=this.x,ye=this.y,we=this.matrix,kn(z,this.width),Sn(z,this.height),$=this.outputDestination};var xn=function(e,t,n,r,a){Ve.push(new bn),Me=z=0,X=[],xe=e,ye=t,we=a,vt([n,r])};for(var yn in p.beginFormObject=function(e,t,n,r,a){return xn(e,t,n,r,a),this},p.endFormObject=function(e){return function(e){if(Ue[e])Ve.pop().restore();else{var t=new bn,n="Xo"+(Object.keys(We).length+1).toString(10);t.id=n,Ue[e]=n,We[n]=t,Be.publish("addFormObject",t),Ve.pop().restore()}}(e),this},p.doFormObject=function(e,t){var n=We[Ue[e]];return Q("q"),Q(t.toString()+" cm"),Q("/"+n.id+" Do"),Q("Q"),this},p.getFormObject=function(e){var t=We[Ue[e]];return{x:t.x,y:t.y,width:t.width,height:t.height,matrix:t.matrix}},p.save=function(e,t){return e=e||"generated.pdf",(t=t||{}).returnPromise=t.returnPromise||!1,!1===t.returnPromise?(le(Tt(It()),e),"function"==typeof le.unload&&ee.setTimeout&&setTimeout(le.unload,911),this):new Promise(function(t,n){try{var r=le(Tt(It()),e);"function"==typeof le.unload&&ee.setTimeout&&setTimeout(le.unload,911),t(r)}catch(e){n(e.message)}})},Fe.API)Fe.API.hasOwnProperty(yn)&&("events"===yn&&Fe.API.events.length?function(e,t){var n,r,a;for(a=t.length-1;-1!==a;a--)n=t[a][0],r=t[a][1],e.subscribe.apply(e,[n].concat("function"==typeof r?[r]:r))}(Be,Fe.API.events):p[yn]=Fe.API[yn]);var wn=p.getPageWidth=function(e){return(je[e=e||z].mediaBox.topRightX-je[e].mediaBox.bottomLeftX)/be},kn=p.setPageWidth=function(e,t){je[e].mediaBox.topRightX=t*be+je[e].mediaBox.bottomLeftX},Nn=p.getPageHeight=function(e){return(je[e=e||z].mediaBox.topRightY-je[e].mediaBox.bottomLeftY)/be},Sn=p.setPageHeight=function(e,t){je[e].mediaBox.topRightY=t*be+je[e].mediaBox.bottomLeftY};return p.internal={pdfEscape:mt,getStyle:jt,getFont:Xt,getFontSize:oe,getCharSpace:dn,getTextColor:un,getLineHeight:Zt,getLineHeightFactor:tn,getLineWidth:Jt,write:Z,getHorizontalCoordinate:nn,getVerticalCoordinate:rn,getCoordinateString:an,getVerticalCoordinateString:on,collections:{},newObject:Ye,newAdditionalObject:Qe,newObjectDeferred:$e,newObjectDeferredBegin:Je,getFilters:rt,putStream:at,events:Be,scaleFactor:be,pageSize:{getWidth:function(){return wn(z)},setWidth:function(e){kn(z,e)},getHeight:function(){return Nn(z)},setHeight:function(e){Sn(z,e)}},encryptionOptions:h,encryption:Dt,getEncryptor:function(e){return null!==h?Dt.encryptor(e,0):function(e){return e}},output:At,getNumberOfPages:wt,pages:X,out:Q,f2:I,f3:T,getPageInfo:Ft,getPageInfoByObjId:Ot,getCurrentPageInfo:Lt,getPDFVersion:m,Point:mn,Rectangle:vn,Matrix:He,hasHotfix:Rt},Object.defineProperty(p.internal.pageSize,"width",{get:function(){return wn(z)},set:function(e){kn(z,e)},enumerable:!0,configurable:!0}),Object.defineProperty(p.internal.pageSize,"height",{get:function(){return Nn(z)},set:function(e){Sn(z,e)},enumerable:!0,configurable:!0}),function(e){for(var t=0,n=re.length;t<n;t++){var r=gt.call(this,e[t][0],e[t][1],e[t][2],re[t][3],!0);!1===d&&(f[r]=!0);var a=e[t][0].split("-");pt({id:r,fontName:a[0],fontStyle:a[1]||""})}Be.publish("addFonts",{fonts:ke,dictionary:Ne})}.call(p,re),ve="F1",bt(i,n),Be.publish("initialized"),p}Ee.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},Ee.prototype.toHexString=function(e){return e.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Ee.prototype.hexToBytes=function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(String.fromCharCode(parseInt(e.substr(n,2),16)));return t.join("")},Ee.prototype.processOwnerPassword=function(e,t){return Se(we(t).substr(0,5),e)},Ee.prototype.encryptor=function(e,t){var n=we(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(e){return Se(n,e)}},Te.prototype.equals=function(e){var t,n="id,objectNumber,equals";if(!e||(0,r.A)(e)!==(0,r.A)(this))return!1;var a=0;for(t in this)if(!(n.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t))return!1;if(this[t]!==e[t])return!1;a++}for(t in e)e.hasOwnProperty(t)&&n.indexOf(t)<0&&a--;return 0===a},Fe.API={events:[]},Fe.version="2.5.2";var Oe=Fe.API,Le=1,Pe=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Me=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},je=function(e){return e.toFixed(2)},Be=function(e){return e.toFixed(5)};Oe.__acroform__={};var ze=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},We=function(e){return e*Le},Ue=function(e){var t=new it,n=xt.internal.getHeight(e)||0,r=xt.internal.getWidth(e)||0;return t.BBox=[0,0,Number(je(r)),Number(je(n))],t},Ve=Oe.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},He=Oe.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},Ge=Oe.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return 0==(e&1<<t)?0:1},qe=Oe.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return Ge(e,t-1)},Ke=Oe.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return Ve(e,t-1)},Xe=Oe.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return He(e,t-1)},Ye=Oe.__acroform__.calculateCoordinates=function(e,t){var n=t.internal.getHorizontalCoordinate,r=t.internal.getVerticalCoordinate,a=e[0],i=e[1],o=e[2],s=e[3],l={};return l.lowerLeft_X=n(a)||0,l.lowerLeft_Y=r(i+s)||0,l.upperRight_X=n(a+o)||0,l.upperRight_Y=r(i)||0,[Number(je(l.lowerLeft_X)),Number(je(l.lowerLeft_Y)),Number(je(l.upperRight_X)),Number(je(l.upperRight_Y))]},$e=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],n=e._V||e.DV,r=Je(e,n),a=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+a+" "+je(r.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(r.text),t.push("ET"),t.push("Q"),t.push("EMC");var i=Ue(e);return i.scope=e.scope,i.stream=t.join("\n"),i}},Je=function(e,t){var n=0===e.fontSize?e.maxFontSize:e.fontSize,r={text:"",fontSize:""},a=(t=")"==(t="("==t.substr(0,1)?t.substr(1):t).substr(t.length-1)?t.substr(0,t.length-1):t).split(" ");a=e.multiline?a.map(function(e){return e.split("\n")}):a.map(function(e){return[e]});var i=n,o=xt.internal.getHeight(e)||0;o=o<0?-o:o;var s=xt.internal.getWidth(e)||0;s=s<0?-s:s;var l=function(t,n,r){if(t+1<a.length){var i=n+" "+a[t+1][0];return Qe(i,e,r).width<=s-4}return!1};i++;e:for(;i>0;){t="",i--;var c,u,h=Qe("3",e,i).height,d=e.multiline?o-i:(o-h)/2,f=d+=2,p=0,g=0,m=0;if(i<=0){t="(...) Tj\n",t+="% Width of Text: "+Qe(t,e,i=12).width+", FieldWidth:"+s+"\n";break}for(var v="",b=0,x=0;x<a.length;x++)if(a.hasOwnProperty(x)){var y=!1;if(1!==a[x].length&&m!==a[x].length-1){if((h+2)*(b+2)+2>o)continue e;v+=a[x][m],y=!0,g=x,x--}else{v=" "==(v+=a[x][m]+" ").substr(v.length-1)?v.substr(0,v.length-1):v;var w=parseInt(x),k=l(w,v,i),N=x>=a.length-1;if(k&&!N){v+=" ",m=0;continue}if(k||N){if(N)g=w;else if(e.multiline&&(h+2)*(b+2)+2>o)continue e}else{if(!e.multiline)continue e;if((h+2)*(b+2)+2>o)continue e;g=w}}for(var S="",C=p;C<=g;C++){var E=a[C];if(e.multiline){if(C===g){S+=E[m]+" ",m=(m+1)%E.length;continue}if(C===p){S+=E[E.length-1]+" ";continue}}S+=E[0]+" "}switch(S=" "==S.substr(S.length-1)?S.substr(0,S.length-1):S,u=Qe(S,e,i).width,e.textAlign){case"right":c=s-u-2;break;case"center":c=(s-u)/2;break;default:c=2}t+=je(c)+" "+je(f)+" Td\n",t+="("+Pe(S)+") Tj\n",t+=-je(c)+" 0 Td\n",f=-(i+2),u=0,p=y?g:g+1,b++,v=""}break}return r.text=t,r.fontSize=i,r},Qe=function(e,t,n){var r=t.scope.internal.getFont(t.fontName,t.fontStyle),a=t.scope.getStringUnitWidth(e,{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:t.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:a}},Ze={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},et=function(e,t){var n={type:"reference",object:e};void 0===t.internal.getPageInfo(e.page).pageContext.annotations.find(function(e){return e.type===n.type&&e.object===n.object})&&t.internal.getPageInfo(e.page).pageContext.annotations.push(n)},tt=function(e,t){if(t.scope=e,void 0!==e.internal&&(void 0===e.internal.acroformPlugin||!1===e.internal.acroformPlugin.isInitialized)){if(st.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(Ze)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Le=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new ot,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){var t;(t=e).internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0}),e.internal.events.subscribe("buildDocument",function(){!function(e){e.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var t=e.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];r.objId=void 0,r.hasAnnotation&&et(r,e)}}(e)}),e.internal.events.subscribe("putCatalog",function(){!function(e){if(void 0===e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("putCatalogCallback: Root missing.");e.internal.write("/AcroForm "+e.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")}(e)}),e.internal.events.subscribe("postPutPages",function(t){!function(e,t){var n=!e;for(var a in e||(t.internal.newObjectDeferredBegin(t.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),t.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),e=e||t.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(e.hasOwnProperty(a)){var i=e[a],o=[],s=i.Rect;if(i.Rect&&(i.Rect=Ye(i.Rect,t)),t.internal.newObjectDeferredBegin(i.objId,!0),i.DA=xt.createDefaultAppearanceStream(i),"object"===(0,r.A)(i)&&"function"==typeof i.getKeyValueListForStream&&(o=i.getKeyValueListForStream()),i.Rect=s,i.hasAppearanceStream&&!i.appearanceStreamContent){var l=$e(i);o.push({key:"AP",value:"<</N "+l+">>"}),t.internal.acroformPlugin.xForms.push(l)}if(i.appearanceStreamContent){var c="";for(var u in i.appearanceStreamContent)if(i.appearanceStreamContent.hasOwnProperty(u)){var h=i.appearanceStreamContent[u];if(c+="/"+u+" ",c+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var a in h)if(h.hasOwnProperty(a)){var d=h[a];"function"==typeof d&&(d=d.call(t,i)),c+="/"+a+" "+d+" ",t.internal.acroformPlugin.xForms.indexOf(d)>=0||t.internal.acroformPlugin.xForms.push(d)}}else"function"==typeof(d=h)&&(d=d.call(t,i)),c+="/"+a+" "+d,t.internal.acroformPlugin.xForms.indexOf(d)>=0||t.internal.acroformPlugin.xForms.push(d);c+=">>"}o.push({key:"AP",value:"<<\n"+c+">>"})}t.internal.putStream({additionalKeyValues:o,objectId:i.objId}),t.internal.out("endobj")}n&&function(e,t){for(var n in e)if(e.hasOwnProperty(n)){var a=n,i=e[n];t.internal.newObjectDeferredBegin(i.objId,!0),"object"===(0,r.A)(i)&&"function"==typeof i.putStream&&i.putStream(),delete e[a]}}(t.internal.acroformPlugin.xForms,t)}(t,e)}),e.internal.acroformPlugin.isInitialized=!0}},nt=Oe.__acroform__.arrayToPdfArray=function(e,t,n){var a=function(e){return e};if(Array.isArray(e)){for(var i="[",o=0;o<e.length;o++)switch(0!==o&&(i+=" "),(0,r.A)(e[o])){case"boolean":case"number":case"object":i+=e[o].toString();break;case"string":"/"!==e[o].substr(0,1)?(void 0!==t&&n&&(a=n.internal.getEncryptor(t)),i+="("+Pe(a(e[o].toString()))+")"):i+=e[o].toString()}return i+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},rt=function(e,t,n){var r=function(e){return e};return void 0!==t&&n&&(r=n.internal.getEncryptor(t)),(e=e||"").toString(),"("+Pe(r(e))+")"},at=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(void 0===this._objId){if(void 0===this.scope)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};at.prototype.toString=function(){return this.objId+" 0 R"},at.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},at.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(e){return"content"!=e&&"appearanceStreamContent"!=e&&"scope"!=e&&"objId"!=e&&"_"!=e.substring(0,1)});for(var n in t)if(!1===Object.getOwnPropertyDescriptor(this,t[n]).configurable){var r=t[n],a=this[r];a&&(Array.isArray(a)?e.push({key:r,value:nt(a,this.objId,this.scope)}):a instanceof at?(a.scope=this.scope,e.push({key:r,value:a.objId+" 0 R"})):"function"!=typeof a&&e.push({key:r,value:a}))}return e};var it=function(){at.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){e=t.trim()},get:function(){return e||null}})};ze(it,at);var ot=function(){at.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var t=function(e){return e};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+Pe(t(e))+")"}},set:function(t){e=t}})};ze(ot,at);var st=function e(){at.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(e){if(isNaN(e))throw new Error('Invalid value "'+e+'" for attribute F supplied.');t=e}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return Boolean(qe(t,3))},set:function(e){!0===Boolean(e)?this.F=Ke(t,3):this.F=Xe(t,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(e){if(isNaN(e))throw new Error('Invalid value "'+e+'" for attribute Ff supplied.');n=e}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(0!==r.length)return r},set:function(e){r=void 0!==e?e:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(e){r[0]=e}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(e){r[1]=e}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(e){r[2]=e}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(e){r[3]=e}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(e){switch(e){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=e;break;default:throw new Error('Invalid value "'+e+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof gt)return;i="FieldObject"+e.FieldNum++}var t=function(e){return e};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+Pe(t(i))+")"},set:function(e){i=e.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(e){i=e}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(e){o=e}});var s="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return s},set:function(e){s=e}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(e){l=e}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return void 0===c?50/Le:c},set:function(e){c=e}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(e){u=e}});var h="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!h||this instanceof gt||this instanceof vt))return rt(h,this.objId,this.scope)},set:function(e){e=e.toString(),h=e}});var d=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(d)return this instanceof dt==0?rt(d,this.objId,this.scope):d},set:function(e){e=e.toString(),d=this instanceof dt==0?"("===e.substr(0,1)?Me(e.substr(1,e.length-2)):Me(e):e}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof dt==1?Me(d.substr(1,d.length-1)):d},set:function(e){e=e.toString(),d=this instanceof dt==1?"/"+e:e}});var f=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(f)return f},set:function(e){this.V=e}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof dt==0?rt(f,this.objId,this.scope):f},set:function(e){e=e.toString(),f=this instanceof dt==0?"("===e.substr(0,1)?Me(e.substr(1,e.length-2)):Me(e):e}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof dt==1?Me(f.substr(1,f.length-1)):f},set:function(e){e=e.toString(),f=this instanceof dt==1?"/"+e:e}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var p,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(e){e=Boolean(e),g=e}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(p)return p},set:function(e){p=e}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return Boolean(qe(this.Ff,1))},set:function(e){!0===Boolean(e)?this.Ff=Ke(this.Ff,1):this.Ff=Xe(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return Boolean(qe(this.Ff,2))},set:function(e){!0===Boolean(e)?this.Ff=Ke(this.Ff,2):this.Ff=Xe(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return Boolean(qe(this.Ff,3))},set:function(e){!0===Boolean(e)?this.Ff=Ke(this.Ff,3):this.Ff=Xe(this.Ff,3)}});var m=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(null!==m)return m},set:function(e){if(-1===[0,1,2].indexOf(e))throw new Error('Invalid value "'+e+'" for attribute Q supplied.');m=e}}),Object.defineProperty(this,"textAlign",{get:function(){var e;switch(m){case 0:default:e="left";break;case 1:e="center";break;case 2:e="right"}return e},configurable:!0,enumerable:!0,set:function(e){switch(e){case"right":case 2:m=2;break;case"center":case 1:m=1;break;default:m=0}}})};ze(st,at);var lt=function(){st.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){e=t}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return nt(t,this.objId,this.scope)},set:function(e){var n,r;r=[],"string"==typeof(n=e)&&(r=function(e,t,n){n||(n=1);for(var r,a=[];r=t.exec(e);)a.push(r[n]);return a}(n,/\((.*?)\)/g)),t=r}}),this.getOptions=function(){return t},this.setOptions=function(e){t=e,this.sort&&t.sort()},this.addOption=function(e){e=(e=e||"").toString(),t.push(e),this.sort&&t.sort()},this.removeOption=function(e,n){for(n=n||!1,e=(e=e||"").toString();-1!==t.indexOf(e)&&(t.splice(t.indexOf(e),1),!1!==n););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return Boolean(qe(this.Ff,18))},set:function(e){!0===Boolean(e)?this.Ff=Ke(this.Ff,18):this.Ff=Xe(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return Boolean(qe(this.Ff,19))},set:function(e){!0===this.combo&&(!0===Boolean(e)?this.Ff=Ke(this.Ff,19):this.Ff=Xe(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return Boolean(qe(this.Ff,20))},set:function(e){!0===Boolean(e)?(this.Ff=Ke(this.Ff,20),t.sort()):this.Ff=Xe(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(qe(this.Ff,22))},set:function(e){!0===Boolean(e)?this.Ff=Ke(this.Ff,22):this.Ff=Xe(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(qe(this.Ff,23))},set:function(e){!0===Boolean(e)?this.Ff=Ke(this.Ff,23):this.Ff=Xe(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return Boolean(qe(this.Ff,27))},set:function(e){!0===Boolean(e)?this.Ff=Ke(this.Ff,27):this.Ff=Xe(this.Ff,27)}}),this.hasAppearanceStream=!1};ze(lt,st);var ct=function(){lt.call(this),this.fontName="helvetica",this.combo=!1};ze(ct,lt);var ut=function(){ct.call(this),this.combo=!0};ze(ut,ct);var ht=function(){ut.call(this),this.edit=!0};ze(ht,ut);var dt=function(){st.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return Boolean(qe(this.Ff,15))},set:function(e){!0===Boolean(e)?this.Ff=Ke(this.Ff,15):this.Ff=Xe(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return Boolean(qe(this.Ff,16))},set:function(e){!0===Boolean(e)?this.Ff=Ke(this.Ff,16):this.Ff=Xe(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return Boolean(qe(this.Ff,17))},set:function(e){!0===Boolean(e)?this.Ff=Ke(this.Ff,17):this.Ff=Xe(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return Boolean(qe(this.Ff,26))},set:function(e){!0===Boolean(e)?this.Ff=Ke(this.Ff,26):this.Ff=Xe(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(e){return e};if(this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),0!==Object.keys(t).length){var n,r=[];for(n in r.push("<<"),t)r.push("/"+n+" ("+Pe(e(t[n]))+")");return r.push(">>"),r.join("\n")}},set:function(e){"object"===(0,r.A)(e)&&(t=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(e){"string"==typeof e&&(t.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(t){e="/"+t}})};ze(dt,st);var ft=function(){dt.call(this),this.pushButton=!0};ze(ft,dt);var pt=function(){dt.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=void 0!==t?t:[]}})};ze(pt,dt);var gt=function(){var e,t;st.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(e){t=e}});var n,a={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(e){return e};this.scope&&(e=this.scope.internal.getEncryptor(this.objId));var t,n=[];for(t in n.push("<<"),a)n.push("/"+t+" ("+Pe(e(a[t]))+")");return n.push(">>"),n.join("\n")},set:function(e){"object"===(0,r.A)(e)&&(a=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return a.CA||""},set:function(e){"string"==typeof e&&(a.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(e){n=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(e){n="/"+e}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=xt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};ze(gt,st),pt.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var n=this.Kids[t];n.appearanceStreamContent=e.createAppearanceStream(n.optionName),n.caption=e.getCA()}},pt.prototype.createOption=function(e){var t=new gt;return t.Parent=this,t.optionName=e,this.Kids.push(t),yt.call(this.scope,t),t};var mt=function(){dt.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=xt.CheckBox.createAppearanceStream()};ze(mt,dt);var vt=function(){st.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return Boolean(qe(this.Ff,13))},set:function(e){!0===Boolean(e)?this.Ff=Ke(this.Ff,13):this.Ff=Xe(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(qe(this.Ff,21))},set:function(e){!0===Boolean(e)?this.Ff=Ke(this.Ff,21):this.Ff=Xe(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(qe(this.Ff,23))},set:function(e){!0===Boolean(e)?this.Ff=Ke(this.Ff,23):this.Ff=Xe(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return Boolean(qe(this.Ff,24))},set:function(e){!0===Boolean(e)?this.Ff=Ke(this.Ff,24):this.Ff=Xe(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return Boolean(qe(this.Ff,25))},set:function(e){!0===Boolean(e)?this.Ff=Ke(this.Ff,25):this.Ff=Xe(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return Boolean(qe(this.Ff,26))},set:function(e){!0===Boolean(e)?this.Ff=Ke(this.Ff,26):this.Ff=Xe(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};ze(vt,st);var bt=function(){vt.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return Boolean(qe(this.Ff,14))},set:function(e){!0===Boolean(e)?this.Ff=Ke(this.Ff,14):this.Ff=Xe(this.Ff,14)}}),this.password=!0};ze(bt,vt);var xt={CheckBox:{createAppearanceStream:function(){return{N:{On:xt.CheckBox.YesNormal},D:{On:xt.CheckBox.YesPushDown,Off:xt.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=Ue(e);t.scope=e.scope;var n=[],r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),i=Je(e,e.caption);return n.push("0.749023 g"),n.push("0 0 "+je(xt.internal.getWidth(e))+" "+je(xt.internal.getHeight(e))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+r+" "+je(i.fontSize)+" Tf "+a),n.push("BT"),n.push(i.text),n.push("ET"),n.push("Q"),n.push("EMC"),t.stream=n.join("\n"),t},YesNormal:function(e){var t=Ue(e);t.scope=e.scope;var n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color),a=[],i=xt.internal.getHeight(e),o=xt.internal.getWidth(e),s=Je(e,e.caption);return a.push("1 g"),a.push("0 0 "+je(o)+" "+je(i)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+je(o-1)+" "+je(i-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+n+" "+je(s.fontSize)+" Tf "+r),a.push(s.text),a.push("ET"),a.push("Q"),t.stream=a.join("\n"),t},OffPushDown:function(e){var t=Ue(e);t.scope=e.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+je(xt.internal.getWidth(e))+" "+je(xt.internal.getHeight(e))+" re"),n.push("f"),t.stream=n.join("\n"),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:xt.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=xt.RadioButton.Circle.YesNormal,t.D[e]=xt.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=Ue(e);t.scope=e.scope;var n=[],r=xt.internal.getWidth(e)<=xt.internal.getHeight(e)?xt.internal.getWidth(e)/4:xt.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var a=xt.internal.Bezier_C,i=Number((r*a).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+Be(xt.internal.getWidth(e)/2)+" "+Be(xt.internal.getHeight(e)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+i+" "+i+" "+r+" 0 "+r+" c"),n.push("-"+i+" "+r+" -"+r+" "+i+" -"+r+" 0 c"),n.push("-"+r+" -"+i+" -"+i+" -"+r+" 0 -"+r+" c"),n.push(i+" -"+r+" "+r+" -"+i+" "+r+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join("\n"),t},YesPushDown:function(e){var t=Ue(e);t.scope=e.scope;var n=[],r=xt.internal.getWidth(e)<=xt.internal.getHeight(e)?xt.internal.getWidth(e)/4:xt.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var a=Number((2*r).toFixed(5)),i=Number((a*xt.internal.Bezier_C).toFixed(5)),o=Number((r*xt.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Be(xt.internal.getWidth(e)/2)+" "+Be(xt.internal.getHeight(e)/2)+" cm"),n.push(a+" 0 m"),n.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),n.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),n.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),n.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+Be(xt.internal.getWidth(e)/2)+" "+Be(xt.internal.getHeight(e)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+o+" "+o+" "+r+" 0 "+r+" c"),n.push("-"+o+" "+r+" -"+r+" "+o+" -"+r+" 0 c"),n.push("-"+r+" -"+o+" -"+o+" -"+r+" 0 -"+r+" c"),n.push(o+" -"+r+" "+r+" -"+o+" "+r+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join("\n"),t},OffPushDown:function(e){var t=Ue(e);t.scope=e.scope;var n=[],r=xt.internal.getWidth(e)<=xt.internal.getHeight(e)?xt.internal.getWidth(e)/4:xt.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var a=Number((2*r).toFixed(5)),i=Number((a*xt.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Be(xt.internal.getWidth(e)/2)+" "+Be(xt.internal.getHeight(e)/2)+" cm"),n.push(a+" 0 m"),n.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),n.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),n.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),n.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join("\n"),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:xt.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=xt.RadioButton.Cross.YesNormal,t.D[e]=xt.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=Ue(e);t.scope=e.scope;var n=[],r=xt.internal.calculateCross(e);return n.push("q"),n.push("1 1 "+je(xt.internal.getWidth(e)-2)+" "+je(xt.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(je(r.x1.x)+" "+je(r.x1.y)+" m"),n.push(je(r.x2.x)+" "+je(r.x2.y)+" l"),n.push(je(r.x4.x)+" "+je(r.x4.y)+" m"),n.push(je(r.x3.x)+" "+je(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join("\n"),t},YesPushDown:function(e){var t=Ue(e);t.scope=e.scope;var n=xt.internal.calculateCross(e),r=[];return r.push("0.749023 g"),r.push("0 0 "+je(xt.internal.getWidth(e))+" "+je(xt.internal.getHeight(e))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+je(xt.internal.getWidth(e)-2)+" "+je(xt.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(je(n.x1.x)+" "+je(n.x1.y)+" m"),r.push(je(n.x2.x)+" "+je(n.x2.y)+" l"),r.push(je(n.x4.x)+" "+je(n.x4.y)+" m"),r.push(je(n.x3.x)+" "+je(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join("\n"),t},OffPushDown:function(e){var t=Ue(e);t.scope=e.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+je(xt.internal.getWidth(e))+" "+je(xt.internal.getHeight(e))+" re"),n.push("f"),t.stream=n.join("\n"),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+n}};xt.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=xt.internal.getWidth(e),n=xt.internal.getHeight(e),r=Math.min(t,n);return{x1:{x:(t-r)/2,y:(n-r)/2+r},x2:{x:(t-r)/2+r,y:(n-r)/2},x3:{x:(t-r)/2,y:(n-r)/2},x4:{x:(t-r)/2+r,y:(n-r)/2+r}}}},xt.internal.getWidth=function(e){var t=0;return"object"===(0,r.A)(e)&&(t=We(e.Rect[2])),t},xt.internal.getHeight=function(e){var t=0;return"object"===(0,r.A)(e)&&(t=We(e.Rect[3])),t};var yt=Oe.addField=function(e){if(tt(this,e),!(e instanceof st))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};Oe.AcroFormChoiceField=lt,Oe.AcroFormListBox=ct,Oe.AcroFormComboBox=ut,Oe.AcroFormEditBox=ht,Oe.AcroFormButton=dt,Oe.AcroFormPushButton=ft,Oe.AcroFormRadioButton=pt,Oe.AcroFormCheckBox=mt,Oe.AcroFormTextField=vt,Oe.AcroFormPasswordField=bt,Oe.AcroFormAppearance=xt,Oe.AcroForm={ChoiceField:lt,ListBox:ct,ComboBox:ut,EditBox:ht,Button:dt,PushButton:ft,RadioButton:pt,CheckBox:mt,TextField:vt,PasswordField:bt,Appearance:xt},Fe.AcroForm={ChoiceField:lt,ListBox:ct,ComboBox:ut,EditBox:ht,Button:dt,PushButton:ft,RadioButton:pt,CheckBox:mt,TextField:vt,PasswordField:bt,Appearance:xt};var wt=Fe.AcroForm;function kt(e){return e.reduce(function(e,t,n){return e[t]=n,e},{})}!function(e){e.__addimage__={};var t="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},a=e.__addimage__.getImageFileTypeByImageData=function(e,r){var a,i,o,s,l,c=t;if("RGBA"===(r=r||t)||void 0!==e.data&&e.data instanceof Uint8ClampedArray&&"height"in e&&"width"in e)return"RGBA";if(N(e))for(l in n)for(o=n[l],a=0;a<o.length;a+=1){for(s=!0,i=0;i<o[a].length;i+=1)if(void 0!==o[a][i]&&o[a][i]!==e[i]){s=!1;break}if(!0===s){c=l;break}}else for(l in n)for(o=n[l],a=0;a<o.length;a+=1){for(s=!0,i=0;i<o[a].length;i+=1)if(void 0!==o[a][i]&&o[a][i]!==e.charCodeAt(i)){s=!1;break}if(!0===s){c=l;break}}return c===t&&r!==t&&(c=r),c},i=function e(t){for(var n=this.internal.write,r=this.internal.putStream,a=(0,this.internal.getFilters)();-1!==a.indexOf("FlateEncode");)a.splice(a.indexOf("FlateEncode"),1);t.objectId=this.internal.newObject();var i=[];if(i.push({key:"Type",value:"/XObject"}),i.push({key:"Subtype",value:"/Image"}),i.push({key:"Width",value:t.width}),i.push({key:"Height",value:t.height}),t.colorSpace===v.INDEXED?i.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(t.palette.length/3-1)+" "+("sMask"in t&&void 0!==t.sMask?t.objectId+2:t.objectId+1)+" 0 R]"}):(i.push({key:"ColorSpace",value:"/"+t.colorSpace}),t.colorSpace===v.DEVICE_CMYK&&i.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),i.push({key:"BitsPerComponent",value:t.bitsPerComponent}),"decodeParameters"in t&&void 0!==t.decodeParameters&&i.push({key:"DecodeParms",value:"<<"+t.decodeParameters+">>"}),"transparency"in t&&Array.isArray(t.transparency)){for(var o="",s=0,l=t.transparency.length;s<l;s++)o+=t.transparency[s]+" "+t.transparency[s]+" ";i.push({key:"Mask",value:"["+o+"]"})}void 0!==t.sMask&&i.push({key:"SMask",value:t.objectId+1+" 0 R"});var c=void 0!==t.filter?["/"+t.filter]:void 0;if(r({data:t.data,additionalKeyValues:i,alreadyAppliedFilters:c,objectId:t.objectId}),n("endobj"),"sMask"in t&&void 0!==t.sMask){var u="/Predictor "+t.predictor+" /Colors 1 /BitsPerComponent "+t.bitsPerComponent+" /Columns "+t.width,h={width:t.width,height:t.height,colorSpace:"DeviceGray",bitsPerComponent:t.bitsPerComponent,decodeParameters:u,data:t.sMask};"filter"in t&&(h.filter=t.filter),e.call(this,h)}if(t.colorSpace===v.INDEXED){var d=this.internal.newObject();r({data:C(new Uint8Array(t.palette)),objectId:d}),n("endobj")}},o=function(){var e=this.internal.collections.addImage_images;for(var t in e)i.call(this,e[t])},s=function(){var e,t=this.internal.collections.addImage_images,n=this.internal.write;for(var r in t)n("/I"+(e=t[r]).index,e.objectId,"0","R")},l=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",s))},c=function(){var e=this.internal.collections.addImage_images;return l.call(this),e},u=function(){return Object.keys(this.internal.collections.addImage_images).length},h=function(t){return"function"==typeof e["process"+t.toUpperCase()]},d=function(e){return"object"===(0,r.A)(e)&&1===e.nodeType},f=function(t,n){if("IMG"===t.nodeName&&t.hasAttribute("src")){var r=""+t.getAttribute("src");if(0===r.indexOf("data:image/"))return oe(unescape(r).split("base64,").pop());var a=e.loadFile(r,!0);if(void 0!==a)return a}if("CANVAS"===t.nodeName){if(0===t.width||0===t.height)throw new Error("Given canvas must have data. Canvas width: "+t.width+", height: "+t.height);var i;switch(n){case"PNG":i="image/png";break;case"WEBP":i="image/webp";break;default:i="image/jpeg"}return oe(t.toDataURL(i,1).split("base64,").pop())}},p=function(e){var t=this.internal.collections.addImage_images;if(t)for(var n in t)if(e===t[n].alias)return t[n]},g=function(e,t,n){return e||t||(e=-96,t=-96),e<0&&(e=-1*n.width*72/e/this.internal.scaleFactor),t<0&&(t=-1*n.height*72/t/this.internal.scaleFactor),0===e&&(e=t*n.width/n.height),0===t&&(t=e*n.height/n.width),[e,t]},m=function(e,t,n,r,a,i){var o=g.call(this,n,r,a),s=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,u=c.call(this);if(n=o[0],r=o[1],u[a.index]=a,i){i*=Math.PI/180;var h=Math.cos(i),d=Math.sin(i),f=function(e){return e.toFixed(4)},p=[f(h),f(d),f(-1*d),f(h),0,0,"cm"]}this.internal.write("q"),i?(this.internal.write([1,"0","0",1,s(e),l(t+r),"cm"].join(" ")),this.internal.write(p.join(" ")),this.internal.write([s(n),"0","0",s(r),"0","0","cm"].join(" "))):this.internal.write([s(n),"0","0",s(r),s(e),l(t+r),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+a.index+" Do"),this.internal.write("Q")},v=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var b=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},x=e.__addimage__.sHashCode=function(e){var t,n,r=0;if("string"==typeof e)for(n=e.length,t=0;t<n;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;else if(N(e))for(n=e.byteLength/2,t=0;t<n;t++)r=(r<<5)-r+e[t],r|=0;return r},y=e.__addimage__.validateStringAsBase64=function(e){(e=e||"").toString().trim();var t=!0;return 0===e.length&&(t=!1),e.length%4!=0&&(t=!1),!1===/^[A-Za-z0-9+/]+$/.test(e.substr(0,e.length-2))&&(t=!1),!1===/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(e.substr(-2))&&(t=!1),t},w=e.__addimage__.extractImageFromDataUrl=function(e){var t=(e=e||"").split("base64,"),n=null;if(2===t.length){var r=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(t[0]);Array.isArray(r)&&(n={mimeType:r[1],charset:r[2],data:t[1]})}return n},k=e.__addimage__.supportsArrayBuffer=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array};e.__addimage__.isArrayBuffer=function(e){return k()&&e instanceof ArrayBuffer};var N=e.__addimage__.isArrayBufferView=function(e){return k()&&"undefined"!=typeof Uint32Array&&(e instanceof Int8Array||e instanceof Uint8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)},S=e.__addimage__.binaryStringToUint8Array=function(e){for(var t=e.length,n=new Uint8Array(t),r=0;r<t;r++)n[r]=e.charCodeAt(r);return n},C=e.__addimage__.arrayBufferToBinaryString=function(e){for(var t="",n=N(e)?e:new Uint8Array(e),r=0;r<n.length;r+=8192)t+=String.fromCharCode.apply(null,n.subarray(r,r+8192));return t};e.addImage=function(){var e,n,a,i,o,s,c,u,h;if("number"==typeof arguments[1]?(n=t,a=arguments[1],i=arguments[2],o=arguments[3],s=arguments[4],c=arguments[5],u=arguments[6],h=arguments[7]):(n=arguments[1],a=arguments[2],i=arguments[3],o=arguments[4],s=arguments[5],c=arguments[6],u=arguments[7],h=arguments[8]),"object"===(0,r.A)(e=arguments[0])&&!d(e)&&"imageData"in e){var f=e;e=f.imageData,n=f.format||n||t,a=f.x||a||0,i=f.y||i||0,o=f.w||f.width||o,s=f.h||f.height||s,c=f.alias||c,u=f.compression||u,h=f.rotation||f.angle||h}var p=this.internal.getFilters();if(void 0===u&&-1!==p.indexOf("FlateEncode")&&(u="SLOW"),isNaN(a)||isNaN(i))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var g=E.call(this,e,n,c,u);return m.call(this,a,i,o,s,g,h),this};var E=function(n,r,i,o){var s,l,c;if("string"==typeof n&&a(n)===t){n=unescape(n);var g=_(n,!1);(""!==g||void 0!==(g=e.loadFile(n,!0)))&&(n=g)}if(d(n)&&(n=f(n,r)),r=a(n,r),!h(r))throw new Error("addImage does not support files of type '"+r+"', please ensure that a plugin for '"+r+"' support is added.");if((null==(c=i)||0===c.length)&&(i=function(e){return"string"==typeof e||N(e)?x(e):N(e.data)?x(e.data):null}(n)),(s=p.call(this,i))||(k()&&(n instanceof Uint8Array||"RGBA"===r||(l=n,n=S(n))),s=this["process"+r.toUpperCase()](n,u.call(this),i,function(t){return t&&"string"==typeof t&&(t=t.toUpperCase()),t in e.image_compression?t:b.NONE}(o),l)),!s)throw new Error("An unknown error occurred whilst processing the image.");return s},_=e.__addimage__.convertBase64ToBinaryString=function(e,t){var n;t="boolean"!=typeof t||t;var r,a="";if("string"==typeof e){r=null!==(n=w(e))?n.data:e;try{a=oe(r)}catch(e){if(t)throw y(r)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+e.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return a};e.getImageProperties=function(n){var r,i,o="";if(d(n)&&(n=f(n)),"string"==typeof n&&a(n)===t&&(""===(o=_(n,!1))&&(o=e.loadFile(n)||""),n=o),i=a(n),!h(i))throw new Error("addImage does not support files of type '"+i+"', please ensure that a plugin for '"+i+"' support is added.");if(!k()||n instanceof Uint8Array||(n=S(n)),!(r=this["process"+i.toUpperCase()](n)))throw new Error("An unknown error occurred whilst processing the image");return r.fileType=i,r}}(Fe.API),function(e){var t=function(e){if(void 0!==e&&""!=e)return!0};Fe.API.events.push(["addPage",function(e){this.internal.getPageInfo(e.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(e){for(var n,r,a,i=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,s=this.internal.getPageInfoByObjId(e.objId),l=e.pageContext.annotations,c=!1,u=0;u<l.length&&!c;u++)switch((n=l[u]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(c=!0);break;case"reference":case"text":case"freetext":c=!0}if(0!=c){this.internal.write("/Annots [");for(var h=0;h<l.length;h++){n=l[h];var d=this.internal.pdfEscape,f=this.internal.getEncryptor(e.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var p=this.internal.newAdditionalObject(),g=this.internal.newAdditionalObject(),m=this.internal.getEncryptor(p.objId),v=n.title||"Note";a="<</Type /Annot /Subtype /Text "+(r="/Rect ["+i(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+i(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+d(m(n.contents))+")",a+=" /Popup "+g.objId+" 0 R",a+=" /P "+s.objId+" 0 R",a+=" /T ("+d(m(v))+") >>",p.content=a;var b=p.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(r="/Rect ["+i(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+i(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+b,n.open&&(a+=" /Open true"),a+=" >>",g.content=a,this.internal.write(p.objId,"0 R",g.objId,"0 R");break;case"freetext":r="/Rect ["+i(n.bounds.x)+" "+o(n.bounds.y)+" "+i(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var x=n.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+r+"/Contents ("+d(f(n.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+x+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(n.options.name){var y=this.annotations._nameMap[n.options.name];n.options.pageNumber=y.page,n.options.top=y.y}else n.options.top||(n.options.top=0);if(r="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",a="",n.options.url)a="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /A <</S /URI /URI ("+d(f(n.options.url))+") >>";else if(n.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,a+=" /FitV "+n.options.left+"]";break;default:var w=o(n.options.top);n.options.left=n.options.left||0,void 0===n.options.zoom&&(n.options.zoom=0),a+=" /XYZ "+n.options.left+" "+w+" "+n.options.zoom+"]"}""!=a&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),e.createAnnotation=function(e){var t=this.internal.getCurrentPageInfo();switch(e.type){case"link":this.link(e.bounds.x,e.bounds.y,e.bounds.w,e.bounds.h,e);break;case"text":case"freetext":t.pageContext.annotations.push(e)}},e.link=function(e,t,n,r,a){var i=this.internal.getCurrentPageInfo(),o=this.internal.getCoordinateString,s=this.internal.getVerticalCoordinateString;i.pageContext.annotations.push({finalBounds:{x:o(e),y:s(t),w:o(e+n),h:s(t+r)},options:a,type:"link"})},e.textWithLink=function(e,t,n,r){var a,i,o=this.getTextWidth(e),s=this.internal.getLineHeight()/this.internal.scaleFactor;if(void 0!==r.maxWidth){i=r.maxWidth;var l=this.splitTextToSize(e,i).length;a=Math.ceil(s*l)}else i=o,a=s;return this.text(e,t,n,r),n+=.2*s,"center"===r.align&&(t-=o/2),"right"===r.align&&(t-=o),this.link(t,n-s,i,a,r),o},e.getTextWidth=function(e){var t=this.internal.getFontSize();return this.getStringUnitWidth(e)*t/this.internal.scaleFactor}}(Fe.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];e.__arabicParser__={};var i=e.__arabicParser__.isInArabicSubstitutionA=function(e){return void 0!==t[e.charCodeAt(0)]},o=e.__arabicParser__.isArabicLetter=function(e){return"string"==typeof e&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(e)},s=e.__arabicParser__.isArabicEndLetter=function(e){return o(e)&&i(e)&&t[e.charCodeAt(0)].length<=2},l=e.__arabicParser__.isArabicAlfLetter=function(e){return o(e)&&a.indexOf(e.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(e){return o(e)&&i(e)&&t[e.charCodeAt(0)].length>=1};var c=e.__arabicParser__.arabicLetterHasFinalForm=function(e){return o(e)&&i(e)&&t[e.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(e){return o(e)&&i(e)&&t[e.charCodeAt(0)].length>=3};var u=e.__arabicParser__.arabicLetterHasMedialForm=function(e){return o(e)&&i(e)&&4==t[e.charCodeAt(0)].length},h=e.__arabicParser__.resolveLigatures=function(e){var t=0,r=n,a="",i=0;for(t=0;t<e.length;t+=1)void 0!==r[e.charCodeAt(t)]?(i++,"number"==typeof(r=r[e.charCodeAt(t)])&&(a+=String.fromCharCode(r),r=n,i=0),t===e.length-1&&(r=n,a+=e.charAt(t-(i-1)),t-=i-1,i=0)):(r=n,a+=e.charAt(t-i),t-=i,i=0);return a};e.__arabicParser__.isArabicDiacritic=function(e){return void 0!==e&&void 0!==r[e.charCodeAt(0)]};var d=e.__arabicParser__.getCorrectForm=function(e,t,n){return o(e)?!1===i(e)?-1:!c(e)||!o(t)&&!o(n)||!o(n)&&s(t)||s(e)&&!o(t)||s(e)&&l(t)||s(e)&&s(t)?0:u(e)&&o(t)&&!s(t)&&o(n)&&c(n)?3:s(e)||!o(n)?1:2:-1},f=function(e){var n=0,r=0,a=0,i="",s="",l="",c=(e=e||"").split("\\s+"),u=[];for(n=0;n<c.length;n+=1){for(u.push(""),r=0;r<c[n].length;r+=1)i=c[n][r],s=c[n][r-1],l=c[n][r+1],o(i)?(a=d(i,s,l),u[n]+=-1!==a?String.fromCharCode(t[i.charCodeAt(0)][a]):i):u[n]+=i;u[n]=h(u[n])}return u.join(" ")},p=e.__arabicParser__.processArabic=e.processArabic=function(){var e,t="string"==typeof arguments[0]?arguments[0]:arguments[0].text,n=[];if(Array.isArray(t)){var r=0;for(n=[],r=0;r<t.length;r+=1)Array.isArray(t[r])?n.push([f(t[r][0]),t[r][1],t[r][2]]):n.push([f(t[r])]);e=n}else e=f(t);return"string"==typeof arguments[0]?e:(arguments[0].text=e,arguments[0])};e.events.push(["preProcessText",p])}(Fe.API),Fe.API.autoPrint=function(e){var t;if("javascript"===((e=e||{}).variant=e.variant||"non-conform",e.variant))this.addJS("print({});");else this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")});return this},function(e){var t=function(){var e=void 0;Object.defineProperty(this,"pdf",{get:function(){return e},set:function(t){e=t}});var t=150;Object.defineProperty(this,"width",{get:function(){return t},set:function(e){t=isNaN(e)||!1===Number.isInteger(e)||e<0?150:e,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=t+1)}});var n=300;Object.defineProperty(this,"height",{get:function(){return n},set:function(e){n=isNaN(e)||!1===Number.isInteger(e)||e<0?300:e,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=n+1)}});var r=[];Object.defineProperty(this,"childNodes",{get:function(){return r},set:function(e){r=e}});var a={};Object.defineProperty(this,"style",{get:function(){return a},set:function(e){a=e}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(e,t){var n;if("2d"!==(e=e||"2d"))return null;for(n in t)this.pdf.context2d.hasOwnProperty(n)&&(this.pdf.context2d[n]=t[n]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Fe.API),function(e){var t={left:0,top:0,bottom:0,right:0},n=!1,a=function(){void 0===this.internal.__cell__&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new o,this.internal.__cell__.pages=1},o=function(){var e=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return e},set:function(t){e=t}});var t=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return t},set:function(e){t=e}});var n=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return n},set:function(e){n=e}});var r=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return r},set:function(e){r=e}});var a=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return a},set:function(e){a=e}});var i=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return i},set:function(e){i=e}});var o=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return o},set:function(e){o=e}}),this};o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},o.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(e){return a.call(this),this.internal.__cell__.headerFunction="function"==typeof e?e:void 0,this},e.getTextDimensions=function(e,t){a.call(this);var n=(t=t||{}).fontSize||this.getFontSize(),r=t.font||this.getFont(),i=t.scaleFactor||this.internal.scaleFactor,o=0,s=0,l=0,c=this;if(!Array.isArray(e)&&"string"!=typeof e){if("number"!=typeof e)throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");e=String(e)}var u=t.maxWidth;u>0?"string"==typeof e?e=this.splitTextToSize(e,u):"[object Array]"===Object.prototype.toString.call(e)&&(e=e.reduce(function(e,t){return e.concat(c.splitTextToSize(t,u))},[])):e=Array.isArray(e)?e:[e];for(var h=0;h<e.length;h++)o<(l=this.getStringUnitWidth(e[h],{font:r})*n)&&(o=l);return 0!==o&&(s=e.length),{w:o/=i,h:Math.max((s*n*this.getLineHeightFactor()-n*(this.getLineHeightFactor()-1))/i,0)}},e.cellAddPage=function(){a.call(this),this.addPage();var e=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new o(e.left,e.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=e.cell=function(){var e;e=arguments[0]instanceof o?arguments[0]:new o(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),a.call(this);var r=this.internal.__cell__.lastCell,i=this.internal.__cell__.padding,s=this.internal.__cell__.margins||t,l=this.internal.__cell__.tableHeaderRow,c=this.internal.__cell__.printHeaders;return void 0!==r.lineNumber&&(r.lineNumber===e.lineNumber?(e.x=(r.x||0)+(r.width||0),e.y=r.y||0):r.y+r.height+e.height+s.bottom>this.getPageHeight()?(this.cellAddPage(),e.y=s.top,c&&l&&(this.printHeaderRow(e.lineNumber,!0),e.y+=l[0].height)):e.y=r.y+r.height||e.y),void 0!==e.text[0]&&(this.rect(e.x,e.y,e.width,e.height,!0===n?"FD":void 0),"right"===e.align?this.text(e.text,e.x+e.width-i,e.y+i,{align:"right",baseline:"top"}):"center"===e.align?this.text(e.text,e.x+e.width/2,e.y+i,{align:"center",baseline:"top",maxWidth:e.width-i-i}):this.text(e.text,e.x+i,e.y+i,{align:"left",baseline:"top",maxWidth:e.width-i-i})),this.internal.__cell__.lastCell=e,this};e.table=function(e,n,c,u,h){if(a.call(this),!c)throw new Error("No data for PDF table.");var d,f,p,g,m=[],v=[],b=[],x={},y={},w=[],k=[],N=(h=h||{}).autoSize||!1,S=!1!==h.printHeaders,C=h.css&&void 0!==h.css["font-size"]?16*h.css["font-size"]:h.fontSize||12,E=h.margins||Object.assign({width:this.getPageWidth()},t),_="number"==typeof h.padding?h.padding:3,I=h.headerBackgroundColor||"#c8c8c8",T=h.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=S,this.internal.__cell__.margins=E,this.internal.__cell__.table_font_size=C,this.internal.__cell__.padding=_,this.internal.__cell__.headerBackgroundColor=I,this.internal.__cell__.headerTextColor=T,this.setFontSize(C),null==u)v=m=Object.keys(c[0]),b=m.map(function(){return"left"});else if(Array.isArray(u)&&"object"===(0,r.A)(u[0]))for(m=u.map(function(e){return e.name}),v=u.map(function(e){return e.prompt||e.name||""}),b=u.map(function(e){return e.align||"left"}),d=0;d<u.length;d+=1)y[u[d].name]=u[d].width*(19.049976/25.4);else Array.isArray(u)&&"string"==typeof u[0]&&(v=m=u,b=m.map(function(){return"left"}));if(N||Array.isArray(u)&&"string"==typeof u[0])for(d=0;d<m.length;d+=1){for(x[g=m[d]]=c.map(function(e){return e[g]}),this.setFont(void 0,"bold"),w.push(this.getTextDimensions(v[d],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),f=x[g],this.setFont(void 0,"normal"),p=0;p<f.length;p+=1)w.push(this.getTextDimensions(f[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);y[g]=Math.max.apply(null,w)+_+_,w=[]}if(S){var A={};for(d=0;d<m.length;d+=1)A[m[d]]={},A[m[d]].text=v[d],A[m[d]].align=b[d];var R=l.call(this,A,y);k=m.map(function(t){return new o(e,n,y[t],R,A[t].text,void 0,A[t].align)}),this.setTableHeaderRow(k),this.printHeaderRow(1,!1)}var D=u.reduce(function(e,t){return e[t.name]=t.align,e},{});for(d=0;d<c.length;d+=1){"rowStart"in h&&h.rowStart instanceof Function&&h.rowStart({row:d,data:c[d]},this);var F=l.call(this,c[d],y);for(p=0;p<m.length;p+=1){var O=c[d][m[p]];"cellStart"in h&&h.cellStart instanceof Function&&h.cellStart({row:d,col:p,data:O},this),s.call(this,new o(e,n,y[m[p]],F,O,d+2,D[m[p]]))}}return this.internal.__cell__.table_x=e,this.internal.__cell__.table_y=n,this};var l=function(e,t){var n=this.internal.__cell__.padding,r=this.internal.__cell__.table_font_size,a=this.internal.scaleFactor;return Object.keys(e).map(function(r){var a=e[r];return this.splitTextToSize(a.hasOwnProperty("text")?a.text:a,t[r]-n-n)},this).map(function(e){return this.getLineHeightFactor()*e.length*r/a+n+n},this).reduce(function(e,t){return Math.max(e,t)},0)};e.setTableHeaderRow=function(e){a.call(this),this.internal.__cell__.tableHeaderRow=e},e.printHeaderRow=function(e,t){if(a.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var r;if(n=!0,"function"==typeof this.internal.__cell__.headerFunction){var i=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new o(i[0],i[1],i[2],i[3],void 0,-1)}this.setFont(void 0,"bold");for(var l=[],c=0;c<this.internal.__cell__.tableHeaderRow.length;c+=1){r=this.internal.__cell__.tableHeaderRow[c].clone(),t&&(r.y=this.internal.__cell__.margins.top||0,l.push(r)),r.lineNumber=e;var u=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,r),this.setTextColor(u)}l.length>0&&this.setTableHeaderRow(l),this.setFont(void 0,"normal"),n=!1}}(Fe.API);var Nt={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},St=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Ct=kt(St),Et=[100,200,300,400,500,600,700,800,900],_t=kt(Et);function It(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),n=function(e){return Nt[e=e||"normal"]?e:"normal"}(e.style),r=function(e){return e?"number"==typeof e?e>=100&&e<=900&&e%100==0?e:400:/^\d00$/.test(e)?parseInt(e):"bold"===e?700:400:400}(e.weight),a=function(e){return"number"==typeof Ct[e=e||"normal"]?e:"normal"}(e.stretch);return{family:t,style:n,weight:r,stretch:a,src:e.src||[],ref:e.ref||{name:t,style:[a,n,r].join(" ")}}}function Tt(e,t,n,r){var a;for(a=n;a>=0&&a<t.length;a+=r)if(e[t[a]])return e[t[a]];for(a=n;a>=0&&a<t.length;a-=r)if(e[t[a]])return e[t[a]]}var At={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Rt={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Dt(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function Ft(e){return e.trimLeft()}function Ot(e,t){for(var n=0;n<e.length;){if(e.charAt(n)===t)return[e.substring(0,n),e.substring(n+1)];n+=1}return null}function Lt(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return null===t?null:[t[0],e.substring(t[0].length)]}var Pt,Mt,jt,Bt,zt=["times"];!function(e){var t,n,a,i,o,s,l,c,u,h=function(e){return e=e||{},this.isStrokeTransparent=e.isStrokeTransparent||!1,this.strokeOpacity=e.strokeOpacity||1,this.strokeStyle=e.strokeStyle||"#000000",this.fillStyle=e.fillStyle||"#000000",this.isFillTransparent=e.isFillTransparent||!1,this.fillOpacity=e.fillOpacity||1,this.font=e.font||"10px sans-serif",this.textBaseline=e.textBaseline||"alphabetic",this.textAlign=e.textAlign||"left",this.lineWidth=e.lineWidth||1,this.lineJoin=e.lineJoin||"miter",this.lineCap=e.lineCap||"butt",this.path=e.path||[],this.transform=void 0!==e.transform?e.transform.clone():new c,this.globalCompositeOperation=e.globalCompositeOperation||"normal",this.globalAlpha=e.globalAlpha||1,this.clip_path=e.clip_path||[],this.currentPoint=e.currentPoint||new s,this.miterLimit=e.miterLimit||10,this.lastPoint=e.lastPoint||new s,this.lineDashOffset=e.lineDashOffset||0,this.lineDash=e.lineDash||[],this.margin=e.margin||[0,0,0,0],this.prevPageLastElemOffset=e.prevPageLastElemOffset||0,this.ignoreClearRect="boolean"!=typeof e.ignoreClearRect||e.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new d(this),t=this.internal.f2,n=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,o=this.internal.getVerticalCoordinate,s=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,u=new h}]);var d=function(e){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var t=e;Object.defineProperty(this,"pdf",{get:function(){return t}});var n=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return n},set:function(e){n=Boolean(e)}});var r=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return r},set:function(e){r=Boolean(e)}});var a=0;Object.defineProperty(this,"posX",{get:function(){return a},set:function(e){isNaN(e)||(a=e)}});var i=0;Object.defineProperty(this,"posY",{get:function(){return i},set:function(e){isNaN(e)||(i=e)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(e){var t;"number"==typeof e?t=[e,e,e,e]:((t=new Array(4))[0]=e[0],t[1]=e.length>=2?e[1]:t[0],t[2]=e.length>=3?e[2]:t[0],t[3]=e.length>=4?e[3]:t[1]),u.margin=t}});var o=!1;Object.defineProperty(this,"autoPaging",{get:function(){return o},set:function(e){o=e}});var s=0;Object.defineProperty(this,"lastBreak",{get:function(){return s},set:function(e){s=e}});var l=[];Object.defineProperty(this,"pageBreaks",{get:function(){return l},set:function(e){l=e}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(e){e instanceof h&&(u=e)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(e){u.path=e}});var c=[];Object.defineProperty(this,"ctxStack",{get:function(){return c},set:function(e){c=e}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(e){var t;t=f(e),this.ctx.fillStyle=t.style,this.ctx.isFillTransparent=0===t.a,this.ctx.fillOpacity=t.a,this.pdf.setFillColor(t.r,t.g,t.b,{a:t.a}),this.pdf.setTextColor(t.r,t.g,t.b,{a:t.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(e){var t=f(e);this.ctx.strokeStyle=t.style,this.ctx.isStrokeTransparent=0===t.a,this.ctx.strokeOpacity=t.a,0===t.a?this.pdf.setDrawColor(255,255,255):(t.a,this.pdf.setDrawColor(t.r,t.g,t.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(e){-1!==["butt","round","square"].indexOf(e)&&(this.ctx.lineCap=e,this.pdf.setLineCap(e))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(e){isNaN(e)||(this.ctx.lineWidth=e,this.pdf.setLineWidth(e))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(e){-1!==["bevel","round","miter"].indexOf(e)&&(this.ctx.lineJoin=e,this.pdf.setLineJoin(e))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(e){isNaN(e)||(this.ctx.miterLimit=e,this.pdf.setMiterLimit(e))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(e){this.ctx.textBaseline=e}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(e){-1!==["right","end","center","left","start"].indexOf(e)&&(this.ctx.textAlign=e)}});var d=null;function p(e,t){if(null===d){var n=function(e){var t=[];return Object.keys(e).forEach(function(n){e[n].forEach(function(e){var r=null;switch(e){case"bold":r={family:n,weight:"bold"};break;case"italic":r={family:n,style:"italic"};break;case"bolditalic":r={family:n,weight:"bold",style:"italic"};break;case"":case"normal":r={family:n}}null!==r&&(r.ref={name:n,style:e},t.push(r))})}),t}(e.getFontList());d=function(e){for(var t={},n=0;n<e.length;++n){var r=It(e[n]),a=r.family,i=r.stretch,o=r.style,s=r.weight;t[a]=t[a]||{},t[a][i]=t[a][i]||{},t[a][i][o]=t[a][i][o]||{},t[a][i][o][s]=r}return t}(n.concat(t))}return d}var g=null;Object.defineProperty(this,"fontFaces",{get:function(){return g},set:function(e){d=null,g=e}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(e){var t;if(this.ctx.font=e,null!==(t=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(e))){var n=t[1],r=(t[2],t[3]),a=t[4],i=(t[5],t[6]),o=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(a)[2];a="px"===o?Math.floor(parseFloat(a)*this.pdf.internal.scaleFactor):"em"===o?Math.floor(parseFloat(a)*this.pdf.getFontSize()):Math.floor(parseFloat(a)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(a);var s=function(e){var t,n,r=[],a=e.trim();if(""===a)return zt;if(a in Rt)return[Rt[a]];for(;""!==a;){switch(n=null,t=(a=Ft(a)).charAt(0)){case'"':case"'":n=Ot(a.substring(1),t);break;default:n=Lt(a)}if(null===n)return zt;if(r.push(n[0]),""!==(a=Ft(n[1]))&&","!==a.charAt(0))return zt;a=a.replace(/^,/,"")}return r}(i);if(this.fontFaces){var l=function(e,t,n){for(var r=(n=n||{}).defaultFontFamily||"times",a=Object.assign({},At,n.genericFontFamilies||{}),i=null,o=null,s=0;s<t.length;++s)if(a[(i=It(t[s])).family]&&(i.family=a[i.family]),e.hasOwnProperty(i.family)){o=e[i.family];break}if(!(o=o||e[r]))throw new Error("Could not find a font-family for the rule '"+Dt(i)+"' and default family '"+r+"'.");if(o=function(e,t){if(t[e])return t[e];var n=Ct[e],r=n<=Ct.normal?-1:1,a=Tt(t,St,n,r);if(!a)throw new Error("Could not find a matching font-stretch value for "+e);return a}(i.stretch,o),o=function(e,t){if(t[e])return t[e];for(var n=Nt[e],r=0;r<n.length;++r)if(t[n[r]])return t[n[r]];throw new Error("Could not find a matching font-style for "+e)}(i.style,o),!(o=function(e,t){if(t[e])return t[e];if(400===e&&t[500])return t[500];if(500===e&&t[400])return t[400];var n=_t[e],r=Tt(t,Et,n,e<400?-1:1);if(!r)throw new Error("Could not find a matching font-weight for value "+e);return r}(i.weight,o)))throw new Error("Failed to resolve a font for the rule '"+Dt(i)+"'.");return o}(p(this.pdf,this.fontFaces),s.map(function(e){return{family:e,stretch:"normal",weight:r,style:n}}));this.pdf.setFont(l.ref.name,l.ref.style)}else{var c="";("bold"===r||parseInt(r,10)>=700||"bold"===n)&&(c="bold"),"italic"===n&&(c+="italic"),0===c.length&&(c="normal");for(var u="",h={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},d=0;d<s.length;d++){if(void 0!==this.pdf.internal.getFont(s[d],c,{noFallback:!0,disableWarning:!0})){u=s[d];break}if("bolditalic"===c&&void 0!==this.pdf.internal.getFont(s[d],"bold",{noFallback:!0,disableWarning:!0}))u=s[d],c="bold";else if(void 0!==this.pdf.internal.getFont(s[d],"normal",{noFallback:!0,disableWarning:!0})){u=s[d],c="normal";break}}if(""===u)for(var f=0;f<s.length;f++)if(h[s[f]]){u=h[s[f]];break}u=""===u?"Times":u,this.pdf.setFont(u,c)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(e){this.ctx.globalCompositeOperation=e}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(e){this.ctx.globalAlpha=e}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(e){this.ctx.lineDashOffset=e,j.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(e){this.ctx.lineDash=e,j.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(e){this.ctx.ignoreClearRect=Boolean(e)}})};d.prototype.setLineDash=function(e){this.lineDash=e},d.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},d.prototype.fill=function(){w.call(this,"fill",!1)},d.prototype.stroke=function(){w.call(this,"stroke",!1)},d.prototype.beginPath=function(){this.path=[{type:"begin"}]},d.prototype.moveTo=function(e,t){if(isNaN(e)||isNaN(t))throw ne.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var n=this.ctx.transform.applyToPoint(new s(e,t));this.path.push({type:"mt",x:n.x,y:n.y}),this.ctx.lastPoint=new s(e,t)},d.prototype.closePath=function(){var e=new s(0,0),t=0;for(t=this.path.length-1;-1!==t;t--)if("begin"===this.path[t].type&&"object"===(0,r.A)(this.path[t+1])&&"number"==typeof this.path[t+1].x){e=new s(this.path[t+1].x,this.path[t+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(e.x,e.y)},d.prototype.lineTo=function(e,t){if(isNaN(e)||isNaN(t))throw ne.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var n=this.ctx.transform.applyToPoint(new s(e,t));this.path.push({type:"lt",x:n.x,y:n.y}),this.ctx.lastPoint=new s(n.x,n.y)},d.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),w.call(this,null,!0)},d.prototype.quadraticCurveTo=function(e,t,n,r){if(isNaN(n)||isNaN(r)||isNaN(e)||isNaN(t))throw ne.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var a=this.ctx.transform.applyToPoint(new s(n,r)),i=this.ctx.transform.applyToPoint(new s(e,t));this.path.push({type:"qct",x1:i.x,y1:i.y,x:a.x,y:a.y}),this.ctx.lastPoint=new s(a.x,a.y)},d.prototype.bezierCurveTo=function(e,t,n,r,a,i){if(isNaN(a)||isNaN(i)||isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r))throw ne.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var o=this.ctx.transform.applyToPoint(new s(a,i)),l=this.ctx.transform.applyToPoint(new s(e,t)),c=this.ctx.transform.applyToPoint(new s(n,r));this.path.push({type:"bct",x1:l.x,y1:l.y,x2:c.x,y2:c.y,x:o.x,y:o.y}),this.ctx.lastPoint=new s(o.x,o.y)},d.prototype.arc=function(e,t,n,r,a,i){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r)||isNaN(a))throw ne.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(i=Boolean(i),!this.ctx.transform.isIdentity){var o=this.ctx.transform.applyToPoint(new s(e,t));e=o.x,t=o.y;var l=this.ctx.transform.applyToPoint(new s(0,n)),c=this.ctx.transform.applyToPoint(new s(0,0));n=Math.sqrt(Math.pow(l.x-c.x,2)+Math.pow(l.y-c.y,2))}Math.abs(a-r)>=2*Math.PI&&(r=0,a=2*Math.PI),this.path.push({type:"arc",x:e,y:t,radius:n,startAngle:r,endAngle:a,counterclockwise:i})},d.prototype.arcTo=function(e,t,n,r,a){throw new Error("arcTo not implemented.")},d.prototype.rect=function(e,t,n,r){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r))throw ne.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(e,t),this.lineTo(e+n,t),this.lineTo(e+n,t+r),this.lineTo(e,t+r),this.lineTo(e,t),this.lineTo(e+n,t),this.lineTo(e,t)},d.prototype.fillRect=function(e,t,n,r){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r))throw ne.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!p.call(this)){var a={};"butt"!==this.lineCap&&(a.lineCap=this.lineCap,this.lineCap="butt"),"miter"!==this.lineJoin&&(a.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(e,t,n,r),this.fill(),a.hasOwnProperty("lineCap")&&(this.lineCap=a.lineCap),a.hasOwnProperty("lineJoin")&&(this.lineJoin=a.lineJoin)}},d.prototype.strokeRect=function(e,t,n,r){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r))throw ne.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");g.call(this)||(this.beginPath(),this.rect(e,t,n,r),this.stroke())},d.prototype.clearRect=function(e,t,n,r){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r))throw ne.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(e,t,n,r))},d.prototype.save=function(e){e="boolean"!=typeof e||e;for(var t=this.pdf.internal.getCurrentPageInfo().pageNumber,n=0;n<this.pdf.internal.getNumberOfPages();n++)this.pdf.setPage(n+1),this.pdf.internal.out("q");if(this.pdf.setPage(t),e){this.ctx.fontSize=this.pdf.internal.getFontSize();var r=new h(this.ctx);this.ctxStack.push(this.ctx),this.ctx=r}},d.prototype.restore=function(e){e="boolean"!=typeof e||e;for(var t=this.pdf.internal.getCurrentPageInfo().pageNumber,n=0;n<this.pdf.internal.getNumberOfPages();n++)this.pdf.setPage(n+1),this.pdf.internal.out("Q");this.pdf.setPage(t),e&&0!==this.ctxStack.length&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},d.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var f=function(e){var t,n,r,a;if(!0===e.isCanvasGradient&&(e=e.getColor()),!e)return{r:0,g:0,b:0,a:0,style:e};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(e))t=0,n=0,r=0,a=0;else{var i=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(e);if(null!==i)t=parseInt(i[1]),n=parseInt(i[2]),r=parseInt(i[3]),a=1;else if(null!==(i=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(e)))t=parseInt(i[1]),n=parseInt(i[2]),r=parseInt(i[3]),a=parseFloat(i[4]);else{if(a=1,"string"==typeof e&&"#"!==e.charAt(0)){var o=new ce(e);e=o.ok?o.toHex():"#000000"}4===e.length?(t=e.substring(1,2),t+=t,n=e.substring(2,3),n+=n,r=e.substring(3,4),r+=r):(t=e.substring(1,3),n=e.substring(3,5),r=e.substring(5,7)),t=parseInt(t,16),n=parseInt(n,16),r=parseInt(r,16)}}return{r:t,g:n,b:r,a:a,style:e}},p=function(){return this.ctx.isFillTransparent||0==this.globalAlpha},g=function(){return Boolean(this.ctx.isStrokeTransparent||0==this.globalAlpha)};d.prototype.fillText=function(e,t,n,r){if(isNaN(t)||isNaN(n)||"string"!=typeof e)throw ne.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(r=isNaN(r)?void 0:r,!p.call(this)){var a=L(this.ctx.transform.rotation),i=this.ctx.transform.scaleX;T.call(this,{text:e,x:t,y:n,scale:i,angle:a,align:this.textAlign,maxWidth:r})}},d.prototype.strokeText=function(e,t,n,r){if(isNaN(t)||isNaN(n)||"string"!=typeof e)throw ne.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!g.call(this)){r=isNaN(r)?void 0:r;var a=L(this.ctx.transform.rotation),i=this.ctx.transform.scaleX;T.call(this,{text:e,x:t,y:n,scale:i,renderingMode:"stroke",angle:a,align:this.textAlign,maxWidth:r})}},d.prototype.measureText=function(e){if("string"!=typeof e)throw ne.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var t=this.pdf,n=this.pdf.internal.scaleFactor,r=t.internal.getFontSize(),a=t.getStringUnitWidth(e)*r/t.internal.scaleFactor;return new function(e){var t=(e=e||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return t}}),this}({width:a*=Math.round(96*n/72*1e4)/1e4})},d.prototype.scale=function(e,t){if(isNaN(e)||isNaN(t))throw ne.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var n=new c(e,0,0,t,0,0);this.ctx.transform=this.ctx.transform.multiply(n)},d.prototype.rotate=function(e){if(isNaN(e))throw ne.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var t=new c(Math.cos(e),Math.sin(e),-Math.sin(e),Math.cos(e),0,0);this.ctx.transform=this.ctx.transform.multiply(t)},d.prototype.translate=function(e,t){if(isNaN(e)||isNaN(t))throw ne.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var n=new c(1,0,0,1,e,t);this.ctx.transform=this.ctx.transform.multiply(n)},d.prototype.transform=function(e,t,n,r,a,i){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r)||isNaN(a)||isNaN(i))throw ne.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var o=new c(e,t,n,r,a,i);this.ctx.transform=this.ctx.transform.multiply(o)},d.prototype.setTransform=function(e,t,n,r,a,i){e=isNaN(e)?1:e,t=isNaN(t)?0:t,n=isNaN(n)?0:n,r=isNaN(r)?1:r,a=isNaN(a)?0:a,i=isNaN(i)?0:i,this.ctx.transform=new c(e,t,n,r,a,i)};var m=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};d.prototype.drawImage=function(e,t,n,r,a,i,o,s,u){var h=this.pdf.getImageProperties(e),d=1,f=1,p=1,g=1;void 0!==r&&void 0!==s&&(p=s/r,g=u/a,d=h.width/r*s/r,f=h.height/a*u/a),void 0===i&&(i=t,o=n,t=0,n=0),void 0!==r&&void 0===s&&(s=r,u=a),void 0===r&&void 0===s&&(s=h.width,u=h.height);for(var b,w=this.ctx.transform.decompose(),N=L(w.rotate.shx),S=new c,C=(S=(S=(S=S.multiply(w.translate)).multiply(w.skew)).multiply(w.scale)).applyToRectangle(new l(i-t*p,o-n*g,r*d,a*f)),E=v.call(this,C),_=[],I=0;I<E.length;I+=1)-1===_.indexOf(E[I])&&_.push(E[I]);if(y(_),this.autoPaging)for(var T=_[0],A=_[_.length-1],R=T;R<A+1;R++){this.pdf.setPage(R);var D=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],F=1===R?this.posY+this.margin[0]:this.margin[0],O=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],P=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],M=1===R?0:O+(R-2)*P;if(0!==this.ctx.clip_path.length){var j=this.path;b=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=x(b,this.posX+this.margin[3],-M+F+this.ctx.prevPageLastElemOffset),k.call(this,"fill",!0),this.path=j}var B=JSON.parse(JSON.stringify(C));B=x([B],this.posX+this.margin[3],-M+F+this.ctx.prevPageLastElemOffset)[0];var z=(R>T||R<A)&&m.call(this);z&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],D,P,null).clip().discardPath()),this.pdf.addImage(e,"JPEG",B.x,B.y,B.w,B.h,null,null,N),z&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(e,"JPEG",C.x,C.y,C.w,C.h,null,null,N)};var v=function(e,t,n){var r=[];t=t||this.pdf.internal.pageSize.width,n=n||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var a=this.posY+this.ctx.prevPageLastElemOffset;switch(e.type){default:case"mt":case"lt":r.push(Math.floor((e.y+a)/n)+1);break;case"arc":r.push(Math.floor((e.y+a-e.radius)/n)+1),r.push(Math.floor((e.y+a+e.radius)/n)+1);break;case"qct":var i=P(this.ctx.lastPoint.x,this.ctx.lastPoint.y,e.x1,e.y1,e.x,e.y);r.push(Math.floor((i.y+a)/n)+1),r.push(Math.floor((i.y+i.h+a)/n)+1);break;case"bct":var o=M(this.ctx.lastPoint.x,this.ctx.lastPoint.y,e.x1,e.y1,e.x2,e.y2,e.x,e.y);r.push(Math.floor((o.y+a)/n)+1),r.push(Math.floor((o.y+o.h+a)/n)+1);break;case"rect":r.push(Math.floor((e.y+a)/n)+1),r.push(Math.floor((e.y+e.h+a)/n)+1)}for(var s=0;s<r.length;s+=1)for(;this.pdf.internal.getNumberOfPages()<r[s];)b.call(this);return r},b=function(){var e=this.fillStyle,t=this.strokeStyle,n=this.font,r=this.lineCap,a=this.lineWidth,i=this.lineJoin;this.pdf.addPage(),this.fillStyle=e,this.strokeStyle=t,this.font=n,this.lineCap=r,this.lineWidth=a,this.lineJoin=i},x=function(e,t,n){for(var r=0;r<e.length;r++)switch(e[r].type){case"bct":e[r].x2+=t,e[r].y2+=n;case"qct":e[r].x1+=t,e[r].y1+=n;default:e[r].x+=t,e[r].y+=n}return e},y=function(e){return e.sort(function(e,t){return e-t})},w=function(e,t){for(var n,r,a=this.fillStyle,i=this.strokeStyle,o=this.lineCap,s=this.lineWidth,l=Math.abs(s*this.ctx.transform.scaleX),c=this.lineJoin,u=JSON.parse(JSON.stringify(this.path)),h=JSON.parse(JSON.stringify(this.path)),d=[],f=0;f<h.length;f++)if(void 0!==h[f].x)for(var p=v.call(this,h[f]),g=0;g<p.length;g+=1)-1===d.indexOf(p[g])&&d.push(p[g]);for(var w=0;w<d.length;w++)for(;this.pdf.internal.getNumberOfPages()<d[w];)b.call(this);if(y(d),this.autoPaging)for(var N=d[0],S=d[d.length-1],C=N;C<S+1;C++){this.pdf.setPage(C),this.fillStyle=a,this.strokeStyle=i,this.lineCap=o,this.lineWidth=l,this.lineJoin=c;var E=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],_=1===C?this.posY+this.margin[0]:this.margin[0],I=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],T=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],A=1===C?0:I+(C-2)*T;if(0!==this.ctx.clip_path.length){var R=this.path;n=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=x(n,this.posX+this.margin[3],-A+_+this.ctx.prevPageLastElemOffset),k.call(this,e,!0),this.path=R}if(r=JSON.parse(JSON.stringify(u)),this.path=x(r,this.posX+this.margin[3],-A+_+this.ctx.prevPageLastElemOffset),!1===t||0===C){var D=(C>N||C<S)&&m.call(this);D&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],E,T,null).clip().discardPath()),k.call(this,e,t),D&&this.pdf.restoreGraphicsState()}this.lineWidth=s}else this.lineWidth=l,k.call(this,e,t),this.lineWidth=s;this.path=u},k=function(e,t){if(("stroke"!==e||t||!g.call(this))&&("stroke"===e||t||!p.call(this))){for(var n,r,a=[],i=this.path,o=0;o<i.length;o++){var s=i[o];switch(s.type){case"begin":a.push({begin:!0});break;case"close":a.push({close:!0});break;case"mt":a.push({start:s,deltas:[],abs:[]});break;case"lt":var l=a.length;if(i[o-1]&&!isNaN(i[o-1].x)&&(n=[s.x-i[o-1].x,s.y-i[o-1].y],l>0))for(;l>=0;l--)if(!0!==a[l-1].close&&!0!==a[l-1].begin){a[l-1].deltas.push(n),a[l-1].abs.push(s);break}break;case"bct":n=[s.x1-i[o-1].x,s.y1-i[o-1].y,s.x2-i[o-1].x,s.y2-i[o-1].y,s.x-i[o-1].x,s.y-i[o-1].y],a[a.length-1].deltas.push(n);break;case"qct":var c=i[o-1].x+2/3*(s.x1-i[o-1].x),u=i[o-1].y+2/3*(s.y1-i[o-1].y),h=s.x+2/3*(s.x1-s.x),d=s.y+2/3*(s.y1-s.y),f=s.x,m=s.y;n=[c-i[o-1].x,u-i[o-1].y,h-i[o-1].x,d-i[o-1].y,f-i[o-1].x,m-i[o-1].y],a[a.length-1].deltas.push(n);break;case"arc":a.push({deltas:[],abs:[],arc:!0}),Array.isArray(a[a.length-1].abs)&&a[a.length-1].abs.push(s)}}r=t?null:"stroke"===e?"stroke":"fill";for(var v=!1,b=0;b<a.length;b++)if(a[b].arc)for(var x=a[b].abs,y=0;y<x.length;y++){var w=x[y];"arc"===w.type?C.call(this,w.x,w.y,w.radius,w.startAngle,w.endAngle,w.counterclockwise,void 0,t,!v):A.call(this,w.x,w.y),v=!0}else if(!0===a[b].close)this.pdf.internal.out("h"),v=!1;else if(!0!==a[b].begin){var k=a[b].start.x,N=a[b].start.y;R.call(this,a[b].deltas,k,N),v=!0}r&&E.call(this,r),t&&_.call(this)}},N=function(e){var t=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,n=t*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return e-n;case"top":return e+t-n;case"hanging":return e+t-2*n;case"middle":return e+t/2-n;default:return e}},S=function(e){return e+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};d.prototype.createLinearGradient=function(){var e=function(){};return e.colorStops=[],e.addColorStop=function(e,t){this.colorStops.push([e,t])},e.getColor=function(){return 0===this.colorStops.length?"#000000":this.colorStops[0][1]},e.isCanvasGradient=!0,e},d.prototype.createPattern=function(){return this.createLinearGradient()},d.prototype.createRadialGradient=function(){return this.createLinearGradient()};var C=function(e,t,n,r,a,i,o,s,l){for(var c=F.call(this,n,r,a,i),u=0;u<c.length;u++){var h=c[u];0===u&&(l?I.call(this,h.x1+e,h.y1+t):A.call(this,h.x1+e,h.y1+t)),D.call(this,e,t,h.x2,h.y2,h.x3,h.y3,h.x4,h.y4)}s?_.call(this):E.call(this,o)},E=function(e){switch(e){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},_=function(){this.pdf.clip(),this.pdf.discardPath()},I=function(e,t){this.pdf.internal.out(n(e)+" "+a(t)+" m")},T=function(e){var t;switch(e.align){case"right":case"end":t="right";break;case"center":t="center";break;default:t="left"}var n=this.pdf.getTextDimensions(e.text),r=N.call(this,e.y),a=S.call(this,r)-n.h,i=this.ctx.transform.applyToPoint(new s(e.x,r)),o=this.ctx.transform.decompose(),u=new c;u=(u=(u=u.multiply(o.translate)).multiply(o.skew)).multiply(o.scale);for(var h,d,f,p=this.ctx.transform.applyToRectangle(new l(e.x,r,n.w,n.h)),g=u.applyToRectangle(new l(e.x,a,n.w,n.h)),b=v.call(this,g),w=[],C=0;C<b.length;C+=1)-1===w.indexOf(b[C])&&w.push(b[C]);if(y(w),this.autoPaging)for(var E=w[0],_=w[w.length-1],I=E;I<_+1;I++){this.pdf.setPage(I);var T=1===I?this.posY+this.margin[0]:this.margin[0],A=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],R=this.pdf.internal.pageSize.height-this.margin[2],D=R-this.margin[0],F=this.pdf.internal.pageSize.width-this.margin[1],O=F-this.margin[3],L=1===I?0:A+(I-2)*D;if(0!==this.ctx.clip_path.length){var P=this.path;h=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=x(h,this.posX+this.margin[3],-1*L+T),k.call(this,"fill",!0),this.path=P}var M=x([JSON.parse(JSON.stringify(g))],this.posX+this.margin[3],-L+T+this.ctx.prevPageLastElemOffset)[0];e.scale>=.01&&(d=this.pdf.internal.getFontSize(),this.pdf.setFontSize(d*e.scale),f=this.lineWidth,this.lineWidth=f*e.scale);var j="text"!==this.autoPaging;if(j||M.y+M.h<=R){if(j||M.y>=T&&M.x<=F){var B=j?e.text:this.pdf.splitTextToSize(e.text,e.maxWidth||F-M.x)[0],z=x([JSON.parse(JSON.stringify(p))],this.posX+this.margin[3],-L+T+this.ctx.prevPageLastElemOffset)[0],W=j&&(I>E||I<_)&&m.call(this);W&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],O,D,null).clip().discardPath()),this.pdf.text(B,z.x,z.y,{angle:e.angle,align:t,renderingMode:e.renderingMode}),W&&this.pdf.restoreGraphicsState()}}else M.y<R&&(this.ctx.prevPageLastElemOffset+=R-M.y);e.scale>=.01&&(this.pdf.setFontSize(d),this.lineWidth=f)}else e.scale>=.01&&(d=this.pdf.internal.getFontSize(),this.pdf.setFontSize(d*e.scale),f=this.lineWidth,this.lineWidth=f*e.scale),this.pdf.text(e.text,i.x+this.posX,i.y+this.posY,{angle:e.angle,align:t,renderingMode:e.renderingMode,maxWidth:e.maxWidth}),e.scale>=.01&&(this.pdf.setFontSize(d),this.lineWidth=f)},A=function(e,t,r,i){r=r||0,i=i||0,this.pdf.internal.out(n(e+r)+" "+a(t+i)+" l")},R=function(e,t,n){return this.pdf.lines(e,t,n,null,null)},D=function(e,n,r,a,s,l,c,u){this.pdf.internal.out([t(i(r+e)),t(o(a+n)),t(i(s+e)),t(o(l+n)),t(i(c+e)),t(o(u+n)),"c"].join(" "))},F=function(e,t,n,r){for(var a=2*Math.PI,i=Math.PI/2;t>n;)t-=a;var o=Math.abs(n-t);o<a&&r&&(o=a-o);for(var s=[],l=r?-1:1,c=t;o>1e-5;){var u=c+l*Math.min(o,i);s.push(O.call(this,e,c,u)),o-=Math.abs(u-c),c=u}return s},O=function(e,t,n){var r=(n-t)/2,a=e*Math.cos(r),i=e*Math.sin(r),o=a,s=-i,l=o*o+s*s,c=l+o*a+s*i,u=4/3*(Math.sqrt(2*l*c)-c)/(o*i-s*a),h=o-u*s,d=s+u*o,f=h,p=-d,g=r+t,m=Math.cos(g),v=Math.sin(g);return{x1:e*Math.cos(t),y1:e*Math.sin(t),x2:h*m-d*v,y2:h*v+d*m,x3:f*m-p*v,y3:f*v+p*m,x4:e*Math.cos(n),y4:e*Math.sin(n)}},L=function(e){return 180*e/Math.PI},P=function(e,t,n,r,a,i){var o=e+.5*(n-e),s=t+.5*(r-t),c=a+.5*(n-a),u=i+.5*(r-i),h=Math.min(e,a,o,c),d=Math.max(e,a,o,c),f=Math.min(t,i,s,u),p=Math.max(t,i,s,u);return new l(h,f,d-h,p-f)},M=function(e,t,n,r,a,i,o,s){var c,u,h,d,f,p,g,m,v,b,x,y,w,k,N=n-e,S=r-t,C=a-n,E=i-r,_=o-a,I=s-i;for(u=0;u<41;u++)v=(g=(h=e+(c=u/40)*N)+c*((f=n+c*C)-h))+c*(f+c*(a+c*_-f)-g),b=(m=(d=t+c*S)+c*((p=r+c*E)-d))+c*(p+c*(i+c*I-p)-m),0==u?(x=v,y=b,w=v,k=b):(x=Math.min(x,v),y=Math.min(y,b),w=Math.max(w,v),k=Math.max(k,b));return new l(Math.round(x),Math.round(y),Math.round(w-x),Math.round(k-y))},j=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var e,t,n=(e=this.ctx.lineDash,t=this.ctx.lineDashOffset,JSON.stringify({lineDash:e,lineDashOffset:t}));this.prevLineDash!==n&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=n)}}}(Fe.API),function(e){var t=function(e){var t,n,r,a,i,o,s,l,c,u;for(/[^\x00-\xFF]/.test(e),n=[],r=0,a=(e+=t="\0\0\0\0".slice(e.length%4||4)).length;a>r;r+=4)0!==(i=(e.charCodeAt(r)<<24)+(e.charCodeAt(r+1)<<16)+(e.charCodeAt(r+2)<<8)+e.charCodeAt(r+3))?(o=(i=((i=((i=((i=(i-(u=i%85))/85)-(c=i%85))/85)-(l=i%85))/85)-(s=i%85))/85)%85,n.push(o+33,s+33,l+33,c+33,u+33)):n.push(122);return function(e,t){for(var n=t;n>0;n--)e.pop()}(n,t.length),String.fromCharCode.apply(String,n)+"~>"},n=function(e){var t,n,r,a,i,o=String,s="length",l=255,c="charCodeAt",u="slice",h="replace";for(e[u](-2),e=e[u](0,-2)[h](/\s/g,"")[h]("z","!!!!!"),r=[],a=0,i=(e+=t="uuuuu"[u](e[s]%5||5))[s];i>a;a+=5)n=52200625*(e[c](a)-33)+614125*(e[c](a+1)-33)+7225*(e[c](a+2)-33)+85*(e[c](a+3)-33)+(e[c](a+4)-33),r.push(l&n>>24,l&n>>16,l&n>>8,l&n);return function(e,t){for(var n=t;n>0;n--)e.pop()}(r,t[s]),o.fromCharCode.apply(o,r)},r=function(e){var t=new RegExp(/^([0-9A-Fa-f]{2})+$/);if(-1!==(e=e.replace(/\s/g,"")).indexOf(">")&&(e=e.substr(0,e.indexOf(">"))),e.length%2&&(e+="0"),!1===t.test(e))return"";for(var n="",r=0;r<e.length;r+=2)n+=String.fromCharCode("0x"+(e[r]+e[r+1]));return n},a=function(e){for(var t=new Uint8Array(e.length),n=e.length;n--;)t[n]=e.charCodeAt(n);return(t=J(t)).reduce(function(e,t){return e+String.fromCharCode(t)},"")};e.processDataByFilters=function(e,i){var o=0,s=e||"",l=[];for("string"==typeof(i=i||[])&&(i=[i]),o=0;o<i.length;o+=1)switch(i[o]){case"ASCII85Decode":case"/ASCII85Decode":s=n(s),l.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":s=t(s),l.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":s=r(s),l.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":s=s.split("").map(function(e){return("0"+e.charCodeAt().toString(16)).slice(-2)}).join("")+">",l.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":s=a(s),l.push("/FlateDecode");break;default:throw new Error('The filter: "'+i[o]+'" is not implemented')}return{data:s,reverseChain:l.reverse().join(" ")}}}(Fe.API),(Bt=Fe.API).loadFile=function(e,t,n){return function(e,t,n){t=!1!==t,n="function"==typeof n?n:function(){};var r=void 0;try{r=function(e,t,n){var r=new XMLHttpRequest,a=0,i=function(e){var t=e.length,n=[],r=String.fromCharCode;for(a=0;a<t;a+=1)n.push(r(255&e.charCodeAt(a)));return n.join("")};if(r.open("GET",e,!t),r.overrideMimeType("text/plain; charset=x-user-defined"),!1===t&&(r.onload=function(){200===r.status?n(i(this.responseText)):n(void 0)}),r.send(null),t&&200===r.status)return i(r.responseText)}(e,t,n)}catch(e){}return r}(e,t,n)},Bt.loadImageFile=Bt.loadFile,function(e){function t(){return(ee.html2canvas?Promise.resolve(ee.html2canvas):n.e(239).then(n.t.bind(n,5239,23))).catch(function(e){return Promise.reject(new Error("Could not load html2canvas: "+e))}).then(function(e){return e.default?e.default:e})}function a(){return(ee.DOMPurify?Promise.resolve(ee.DOMPurify):n.e(213).then(n.t.bind(n,6213,23))).catch(function(e){return Promise.reject(new Error("Could not load dompurify: "+e))}).then(function(e){return e.default?e.default:e})}var i=function(e){var t=(0,r.A)(e);return"undefined"===t?"undefined":"string"===t||e instanceof String?"string":"number"===t||e instanceof Number?"number":"function"===t||e instanceof Function?"function":e&&e.constructor===Array?"array":e&&1===e.nodeType?"element":"object"===t?"object":"unknown"},o=function(e,t){var n=document.createElement(e);for(var r in t.className&&(n.className=t.className),t.innerHTML&&t.dompurify&&(n.innerHTML=t.dompurify.sanitize(t.innerHTML)),t.style)n.style[r]=t.style[r];return n},s=function e(t){var n=Object.assign(e.convert(Promise.resolve()),JSON.parse(JSON.stringify(e.template))),r=e.convert(Promise.resolve(),n);return(r=r.setProgress(1,e,1,[e])).set(t)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(e,t){return e.__proto__=t||s.prototype,e},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(e,t){return this.then(function(){switch(t=t||function(e){switch(i(e)){case"string":return"string";case"element":return"canvas"===e.nodeName.toLowerCase()?"canvas":"element";default:return"unknown"}}(e)){case"string":return this.then(a).then(function(t){return this.set({src:o("div",{innerHTML:e,dompurify:t})})});case"element":return this.set({src:e});case"canvas":return this.set({canvas:e});case"img":return this.set({img:e});default:return this.error("Unknown source type.")}})},s.prototype.to=function(e){switch(e){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var e={position:"relative",display:"inline-block",width:("number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},t=function e(t,n){for(var r=3===t.nodeType?document.createTextNode(t.nodeValue):t.cloneNode(!1),a=t.firstChild;a;a=a.nextSibling)!0!==n&&1===a.nodeType&&"SCRIPT"===a.nodeName||r.appendChild(e(a,n));return 1===t.nodeType&&("CANVAS"===t.nodeName?(r.width=t.width,r.height=t.height,r.getContext("2d").drawImage(t,0,0)):"TEXTAREA"!==t.nodeName&&"SELECT"!==t.nodeName||(r.value=t.value),r.addEventListener("load",function(){r.scrollTop=t.scrollTop,r.scrollLeft=t.scrollLeft},!0)),r}(this.prop.src,this.opt.html2canvas.javascriptEnabled);"BODY"===t.tagName&&(e.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=o("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=o("div",{className:"html2pdf__container",style:e}),this.prop.container.appendChild(t),this.prop.container.firstChild.appendChild(o("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var e=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(e).then(t).then(function(e){var t=Object.assign({},this.opt.html2canvas);return delete t.onrendered,e(this.prop.container,t)}).then(function(e){(this.opt.html2canvas.onrendered||function(){})(e),this.prop.canvas=e,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var e=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(e).then(t).then(function(e){var t=this.opt.jsPDF,n=this.opt.fontFaces,r="number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,a=Object.assign({async:!0,allowTaint:!0,scale:r,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete a.onrendered,t.context2d.autoPaging=void 0===this.opt.autoPaging||this.opt.autoPaging,t.context2d.posX=this.opt.x,t.context2d.posY=this.opt.y,t.context2d.margin=this.opt.margin,t.context2d.fontFaces=n,n)for(var i=0;i<n.length;++i){var o=n[i],s=o.src.find(function(e){return"truetype"===e.format});s&&t.addFont(s.url,o.ref.name,o.ref.style)}return a.windowHeight=a.windowHeight||0,a.windowHeight=0==a.windowHeight?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):a.windowHeight,t.context2d.save(!0),e(this.prop.container,a)}).then(function(e){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(e),this.prop.canvas=e,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var e=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=e})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(e,t,n){return"img"===(n=n||"pdf").toLowerCase()||"image"===n.toLowerCase()?this.outputImg(e,t):this.outputPdf(e,t)},s.prototype.outputPdf=function(e,t){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(e,t)})},s.prototype.outputImg=function(e){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(e){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+e+'" is not supported.'}})},s.prototype.save=function(e){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(e?{filename:e}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(e){if("object"!==i(e))return this;var t=Object.keys(e||{}).map(function(t){if(t in s.template.prop)return function(){this.prop[t]=e[t]};switch(t){case"margin":return this.setMargin.bind(this,e.margin);case"jsPDF":return function(){return this.opt.jsPDF=e.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,e.pageSize);default:return function(){this.opt[t]=e[t]}}},this);return this.then(function(){return this.thenList(t)})},s.prototype.get=function(e,t){return this.then(function(){var n=e in s.template.prop?this.prop[e]:this.opt[e];return t?t(n):n})},s.prototype.setMargin=function(e){return this.then(function(){switch(i(e)){case"number":e=[e,e,e,e];case"array":if(2===e.length&&(e=[e[0],e[1],e[0],e[1]]),4===e.length)break;default:return this.error("Invalid margin array.")}this.opt.margin=e}).then(this.setPageSize)},s.prototype.setPageSize=function(e){function t(e,t){return Math.floor(e*t/72*96)}return this.then(function(){(e=e||Fe.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(e.inner={width:e.width-this.opt.margin[1]-this.opt.margin[3],height:e.height-this.opt.margin[0]-this.opt.margin[2]},e.inner.px={width:t(e.inner.width,e.k),height:t(e.inner.height,e.k)},e.inner.ratio=e.inner.height/e.inner.width),this.prop.pageSize=e})},s.prototype.setProgress=function(e,t,n,r){return null!=e&&(this.progress.val=e),null!=t&&(this.progress.state=t),null!=n&&(this.progress.n=n),null!=r&&(this.progress.stack=r),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(e,t,n,r){return this.setProgress(e?this.progress.val+e:null,t||null,n?this.progress.n+n:null,r?this.progress.stack.concat(r):null)},s.prototype.then=function(e,t){var n=this;return this.thenCore(e,t,function(e,t){return n.updateProgress(null,null,1,[e]),Promise.prototype.then.call(this,function(t){return n.updateProgress(null,e),t}).then(e,t).then(function(e){return n.updateProgress(1),e})})},s.prototype.thenCore=function(e,t,n){n=n||Promise.prototype.then,e&&(e=e.bind(this)),t&&(t=t.bind(this));var r=-1!==Promise.toString().indexOf("[native code]")&&"Promise"===Promise.name?this:s.convert(Object.assign({},this),Promise.prototype),a=n.call(r,e,t);return s.convert(a,this.__proto__)},s.prototype.thenExternal=function(e,t){return Promise.prototype.then.call(this,e,t)},s.prototype.thenList=function(e){var t=this;return e.forEach(function(e){t=t.thenCore(e)}),t},s.prototype.catch=function(e){e&&(e=e.bind(this));var t=Promise.prototype.catch.call(this,e);return s.convert(t,this)},s.prototype.catchExternal=function(e){return Promise.prototype.catch.call(this,e)},s.prototype.error=function(e){return this.then(function(){throw new Error(e)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,Fe.getPageSize=function(e,t,n){if("object"===(0,r.A)(e)){var a=e;e=a.orientation,t=a.unit||t,n=a.format||n}t=t||"mm",n=n||"a4",e=(""+(e||"P")).toLowerCase();var i,o=(""+n).toLowerCase(),s={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(t){case"pt":i=1;break;case"mm":i=72/25.4;break;case"cm":i=72/2.54;break;case"in":i=72;break;case"px":i=.75;break;case"pc":case"em":i=12;break;case"ex":i=6;break;default:throw"Invalid unit: "+t}var l,c=0,u=0;if(s.hasOwnProperty(o))c=s[o][1]/i,u=s[o][0]/i;else try{c=n[1],u=n[0]}catch(Bt){throw new Error("Invalid format: "+n)}if("p"===e||"portrait"===e)e="p",u>c&&(l=u,u=c,c=l);else{if("l"!==e&&"landscape"!==e)throw"Invalid orientation: "+e;e="l",c>u&&(l=u,u=c,c=l)}return{width:u,height:c,unit:t,k:i,orientation:e}},e.html=function(e,t){(t=t||{}).callback=t.callback||function(){},t.html2canvas=t.html2canvas||{},t.html2canvas.canvas=t.html2canvas.canvas||this.canvas,t.jsPDF=t.jsPDF||this,t.fontFaces=t.fontFaces?t.fontFaces.map(It):null;var n=new s(t);return t.worker?n:n.from(e).doCallback()}}(Fe.API),Fe.API.addJS=function(e){return jt=e,this.internal.events.subscribe("postPutResources",function(){Pt=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Pt+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),Mt=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+jt+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){void 0!==Pt&&void 0!==Mt&&this.internal.out("/Names <</JavaScript "+Pt+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var e=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var r=e.outline.render().split(/\r\n/),a=0;a<r.length;a++){var i=r[a],o=n.exec(i);if(null!=o){var s=o[1];e.internal.newObjectDeferredBegin(s,!1)}e.internal.write(i)}if(this.outline.createNamedDestinations){var l=this.internal.pages.length,c=[];for(a=0;a<l;a++){var u=e.internal.newObject();c.push(u);var h=e.internal.getPageInfo(a+1);e.internal.write("<< /D["+h.objId+" 0 R /XYZ null null null]>> endobj")}var d=e.internal.newObject();for(e.internal.write("<< /Names [ "),a=0;a<c.length;a++)e.internal.write("(page_"+(a+1)+")"+c[a]+" 0 R");e.internal.write(" ] >>","endobj"),t=e.internal.newObject(),e.internal.write("<< /Dests "+d+" 0 R"),e.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var e=this;e.outline={createNamedDestinations:!1,root:{children:[]}},e.outline.add=function(e,t,n){var r={title:t,options:n,children:[]};return null==e&&(e=this.root),e.children.push(r),r},e.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=e,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},e.outline.genIds_r=function(t){t.id=e.internal.newObjectDeferred();for(var n=0;n<t.children.length;n++)this.genIds_r(t.children[n])},e.outline.renderRoot=function(e){this.objStart(e),this.line("/Type /Outlines"),e.children.length>0&&(this.line("/First "+this.makeRef(e.children[0])),this.line("/Last "+this.makeRef(e.children[e.children.length-1]))),this.line("/Count "+this.count_r({count:0},e)),this.objEnd()},e.outline.renderItems=function(t){for(var n=this.ctx.pdf.internal.getVerticalCoordinateString,r=0;r<t.children.length;r++){var a=t.children[r];this.objStart(a),this.line("/Title "+this.makeString(a.title)),this.line("/Parent "+this.makeRef(t)),r>0&&this.line("/Prev "+this.makeRef(t.children[r-1])),r<t.children.length-1&&this.line("/Next "+this.makeRef(t.children[r+1])),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1])));var i=this.count=this.count_r({count:0},a);if(i>0&&this.line("/Count "+i),a.options&&a.options.pageNumber){var o=e.internal.getPageInfo(a.options.pageNumber);this.line("/Dest ["+o.objId+" 0 R /XYZ 0 "+n(0)+" 0]")}this.objEnd()}for(var s=0;s<t.children.length;s++)this.renderItems(t.children[s])},e.outline.line=function(e){this.ctx.val+=e+"\r\n"},e.outline.makeRef=function(e){return e.id+" 0 R"},e.outline.makeString=function(t){return"("+e.internal.pdfEscape(t)+")"},e.outline.objStart=function(e){this.ctx.val+="\r\n"+e.id+" 0 obj\r\n<<\r\n"},e.outline.objEnd=function(){this.ctx.val+=">> \r\nendobj\r\n"},e.outline.count_r=function(e,t){for(var n=0;n<t.children.length;n++)e.count++,this.count_r(e,t.children[n]);return e.count}}])}(Fe.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(e,n,r,a,i,o){var s,l=this.decode.DCT_DECODE,c=null;if("string"==typeof e||this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e)){switch(e=i||e,e=this.__addimage__.isArrayBuffer(e)?new Uint8Array(e):e,(s=function(e){for(var n,r=256*e.charCodeAt(4)+e.charCodeAt(5),a=e.length,i={width:0,height:0,numcomponents:1},o=4;o<a;o+=2){if(o+=r,-1!==t.indexOf(e.charCodeAt(o+1))){n=256*e.charCodeAt(o+5)+e.charCodeAt(o+6),i={width:256*e.charCodeAt(o+7)+e.charCodeAt(o+8),height:n,numcomponents:e.charCodeAt(o+9)};break}r=256*e.charCodeAt(o+2)+e.charCodeAt(o+3)}return i}(e=this.__addimage__.isArrayBufferView(e)?this.__addimage__.arrayBufferToBinaryString(e):e)).numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}c={data:e,width:s.width,height:s.height,colorSpace:o,bitsPerComponent:8,filter:l,index:n,alias:r}}return c}}(Fe.API);var Wt,Ut,Vt,Ht,Gt,qt=function(){var e,t,n;function r(e){var t,n,r,a,i,o,s,l,c,u,h,d,f,p;for(this.data=e,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},o=null;;){switch(t=this.readUInt32(),c=function(){var e,t;for(t=[],e=0;e<4;++e)t.push(String.fromCharCode(this.data[this.pos++]));return t}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(t);break;case"fcTL":o&&this.animation.frames.push(o),this.pos+=4,o={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},i=this.readUInt16(),a=this.readUInt16()||100,o.delay=1e3*i/a,o.disposeOp=this.data[this.pos++],o.blendOp=this.data[this.pos++],o.data=[];break;case"IDAT":case"fdAT":for("fdAT"===c&&(this.pos+=4,t-=4),e=(null!=o?o.data:void 0)||this.imgData,d=0;0<=t?d<t:d>t;0<=t?++d:--d)e.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(r=this.palette.length/3,this.transparency.indexed=this.read(t),this.transparency.indexed.length>r)throw new Error("More transparent colors than palette size");if((u=r-this.transparency.indexed.length)>0)for(f=0;0<=u?f<u:f>u;0<=u?++f:--f)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(t)[0];break;case 2:this.transparency.rgb=this.read(t)}break;case"tEXt":s=(h=this.read(t)).indexOf(0),l=String.fromCharCode.apply(String,h.slice(0,s)),this.text[l]=String.fromCharCode.apply(String,h.slice(s+1));break;case"IEND":return o&&this.animation.frames.push(o),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=4===(p=this.colorType)||6===p,n=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*n,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=t}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}r.prototype.read=function(e){var t,n;for(n=[],t=0;0<=e?t<e:t>e;0<=e?++t:--t)n.push(this.data[this.pos++]);return n},r.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.decodePixels=function(e){var t=this.pixelBitlength/8,n=new Uint8Array(this.width*this.height*t),r=0,a=this;if(null==e&&(e=this.imgData),0===e.length)return new Uint8Array(0);function i(i,o,s,l){var c,u,h,d,f,p,g,m,v,b,x,y,w,k,N,S,C,E,_,I,T,A=Math.ceil((a.width-i)/s),R=Math.ceil((a.height-o)/l),D=a.width==A&&a.height==R;for(k=t*A,y=D?n:new Uint8Array(k*R),p=e.length,w=0,u=0;w<R&&r<p;){switch(e[r++]){case 0:for(d=C=0;C<k;d=C+=1)y[u++]=e[r++];break;case 1:for(d=E=0;E<k;d=E+=1)c=e[r++],f=d<t?0:y[u-t],y[u++]=(c+f)%256;break;case 2:for(d=_=0;_<k;d=_+=1)c=e[r++],h=(d-d%t)/t,N=w&&y[(w-1)*k+h*t+d%t],y[u++]=(N+c)%256;break;case 3:for(d=I=0;I<k;d=I+=1)c=e[r++],h=(d-d%t)/t,f=d<t?0:y[u-t],N=w&&y[(w-1)*k+h*t+d%t],y[u++]=(c+Math.floor((f+N)/2))%256;break;case 4:for(d=T=0;T<k;d=T+=1)c=e[r++],h=(d-d%t)/t,f=d<t?0:y[u-t],0===w?N=S=0:(N=y[(w-1)*k+h*t+d%t],S=h&&y[(w-1)*k+(h-1)*t+d%t]),g=f+N-S,m=Math.abs(g-f),b=Math.abs(g-N),x=Math.abs(g-S),v=m<=b&&m<=x?f:b<=x?N:S,y[u++]=(c+v)%256;break;default:throw new Error("Invalid filter algorithm: "+e[r-1])}if(!D){var F=((o+w*l)*a.width+i)*t,O=w*k;for(d=0;d<A;d+=1){for(var L=0;L<t;L+=1)n[F++]=y[O++];F+=(s-1)*t}}w++}}return e=Q(e),1==a.interlaceMethod?(i(0,0,8,8),i(4,0,8,8),i(0,4,4,8),i(2,0,4,4),i(0,2,2,4),i(1,0,2,2),i(0,1,1,2)):i(0,0,1,1),n},r.prototype.decodePalette=function(){var e,t,n,r,a,i,o,s,l;for(n=this.palette,i=this.transparency.indexed||[],a=new Uint8Array((i.length||0)+n.length),r=0,e=0,t=o=0,s=n.length;o<s;t=o+=3)a[r++]=n[t],a[r++]=n[t+1],a[r++]=n[t+2],a[r++]=null!=(l=i[e++])?l:255;return a},r.prototype.copyToImageData=function(e,t){var n,r,a,i,o,s,l,c,u,h,d;if(r=this.colors,u=null,n=this.hasAlphaChannel,this.palette.length&&(u=null!=(d=this._decodedPalette)?d:this._decodedPalette=this.decodePalette(),r=4,n=!0),c=(a=e.data||e).length,o=u||t,i=s=0,1===r)for(;i<c;)l=u?4*t[i/4]:s,h=o[l++],a[i++]=h,a[i++]=h,a[i++]=h,a[i++]=n?o[l++]:255,s=l;else for(;i<c;)l=u?4*t[i/4]:s,a[i++]=o[l++],a[i++]=o[l++],a[i++]=o[l++],a[i++]=n?o[l++]:255,s=l},r.prototype.decode=function(){var e;return e=new Uint8Array(this.width*this.height*4),this.copyToImageData(e,this.decodePixels()),e};var a=function(){if("[object Window]"===Object.prototype.toString.call(ee)){try{t=ee.document.createElement("canvas"),n=t.getContext("2d")}catch(e){return!1}return!0}return!1};return a(),e=function(e){var r;if(!0===a())return n.width=e.width,n.height=e.height,n.clearRect(0,0,e.width,e.height),n.putImageData(e,0,0),(r=new Image).src=t.toDataURL(),r;throw new Error("This method requires a Browser with Canvas-capability.")},r.prototype.decodeFrames=function(t){var n,r,a,i,o,s,l,c;if(this.animation){for(c=[],r=o=0,s=(l=this.animation.frames).length;o<s;r=++o)n=l[r],a=t.createImageData(n.width,n.height),i=this.decodePixels(new Uint8Array(n.data)),this.copyToImageData(a,i),n.imageData=a,c.push(n.image=e(a));return c}},r.prototype.renderFrame=function(e,t){var n,r,a;return n=(r=this.animation.frames)[t],a=r[t-1],0===t&&e.clearRect(0,0,this.width,this.height),1===(null!=a?a.disposeOp:void 0)?e.clearRect(a.xOffset,a.yOffset,a.width,a.height):2===(null!=a?a.disposeOp:void 0)&&e.putImageData(a.imageData,a.xOffset,a.yOffset),0===n.blendOp&&e.clearRect(n.xOffset,n.yOffset,n.width,n.height),e.drawImage(n.image,n.xOffset,n.yOffset)},r.prototype.animate=function(e){var t,n,r,a,i,o,s=this;return n=0,o=this.animation,a=o.numFrames,r=o.frames,i=o.numPlays,(t=function(){var o,l;if(o=n++%a,l=r[o],s.renderFrame(e,o),a>1&&n/a<i)return s.animation._timeout=setTimeout(t,l.delay)})()},r.prototype.stopAnimation=function(){var e;return clearTimeout(null!=(e=this.animation)?e._timeout:void 0)},r.prototype.render=function(e){var t,n;return e._png&&e._png.stopAnimation(),e._png=this,e.width=this.width,e.height=this.height,t=e.getContext("2d"),this.animation?(this.decodeFrames(t),this.animate(t)):(n=t.createImageData(this.width,this.height),this.copyToImageData(n,this.decodePixels()),t.putImageData(n,0,0))},r}();function Kt(e){var t=0;if(71!==e[t++]||73!==e[t++]||70!==e[t++]||56!==e[t++]||56!=(e[t++]+1&253)||97!==e[t++])throw new Error("Invalid GIF 87a/89a header.");var n=e[t++]|e[t++]<<8,r=e[t++]|e[t++]<<8,a=e[t++],i=a>>7,o=1<<1+(7&a);e[t++],e[t++];var s=null,l=null;i&&(s=t,l=o,t+=3*o);var c=!0,u=[],h=0,d=null,f=0,p=null;for(this.width=n,this.height=r;c&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(11!==e[t]||78==e[t+1]&&69==e[t+2]&&84==e[t+3]&&83==e[t+4]&&67==e[t+5]&&65==e[t+6]&&80==e[t+7]&&69==e[t+8]&&50==e[t+9]&&46==e[t+10]&&48==e[t+11]&&3==e[t+12]&&1==e[t+13]&&0==e[t+16])t+=14,p=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((_=e[t++])>=0))throw Error("Invalid block size");if(0===_)break;t+=_}break;case 249:if(4!==e[t++]||0!==e[t+4])throw new Error("Invalid graphics extension block.");var g=e[t++];h=e[t++]|e[t++]<<8,d=e[t++],0==(1&g)&&(d=null),f=g>>2&7,t++;break;case 254:for(;;){if(!((_=e[t++])>=0))throw Error("Invalid block size");if(0===_)break;t+=_}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var m=e[t++]|e[t++]<<8,v=e[t++]|e[t++]<<8,b=e[t++]|e[t++]<<8,x=e[t++]|e[t++]<<8,y=e[t++],w=y>>6&1,k=1<<1+(7&y),N=s,S=l,C=!1;y>>7&&(C=!0,N=t,S=k,t+=3*k);var E=t;for(t++;;){var _;if(!((_=e[t++])>=0))throw Error("Invalid block size");if(0===_)break;t+=_}u.push({x:m,y:v,width:b,height:x,has_local_palette:C,palette_offset:N,palette_size:S,data_offset:E,data_length:t-E,transparent_index:d,interlaced:!!w,delay:h,disposal:f});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return p},this.frameInfo=function(e){if(e<0||e>=u.length)throw new Error("Frame index out of range.");return u[e]},this.decodeAndBlitFrameBGRA=function(t,r){var a=this.frameInfo(t),i=a.width*a.height,o=new Uint8Array(i);Xt(e,a.data_offset,o,i);var s=a.palette_offset,l=a.transparent_index;null===l&&(l=256);var c=a.width,u=n-c,h=c,d=4*(a.y*n+a.x),f=4*((a.y+a.height)*n+a.x),p=d,g=4*u;!0===a.interlaced&&(g+=4*n*7);for(var m=8,v=0,b=o.length;v<b;++v){var x=o[v];if(0===h&&(h=c,(p+=g)>=f&&(g=4*u+4*n*(m-1),p=d+(c+u)*(m<<1),m>>=1)),x===l)p+=4;else{var y=e[s+3*x],w=e[s+3*x+1],k=e[s+3*x+2];r[p++]=k,r[p++]=w,r[p++]=y,r[p++]=255}--h}},this.decodeAndBlitFrameRGBA=function(t,r){var a=this.frameInfo(t),i=a.width*a.height,o=new Uint8Array(i);Xt(e,a.data_offset,o,i);var s=a.palette_offset,l=a.transparent_index;null===l&&(l=256);var c=a.width,u=n-c,h=c,d=4*(a.y*n+a.x),f=4*((a.y+a.height)*n+a.x),p=d,g=4*u;!0===a.interlaced&&(g+=4*n*7);for(var m=8,v=0,b=o.length;v<b;++v){var x=o[v];if(0===h&&(h=c,(p+=g)>=f&&(g=4*u+4*n*(m-1),p=d+(c+u)*(m<<1),m>>=1)),x===l)p+=4;else{var y=e[s+3*x],w=e[s+3*x+1],k=e[s+3*x+2];r[p++]=y,r[p++]=w,r[p++]=k,r[p++]=255}--h}}}function Xt(e,t,n,r){for(var a=e[t++],i=1<<a,o=i+1,s=o+1,l=a+1,c=(1<<l)-1,u=0,h=0,d=0,f=e[t++],p=new Int32Array(4096),g=null;;){for(;u<16&&0!==f;)h|=e[t++]<<u,u+=8,1===f?f=e[t++]:--f;if(u<l)break;var m=h&c;if(h>>=l,u-=l,m!==i){if(m===o)break;for(var v=m<s?m:g,b=0,x=v;x>i;)x=p[x]>>8,++b;var y=x;if(d+b+(v!==m?1:0)>r)return void ne.log("Warning, gif stream longer than expected.");n[d++]=y;var w=d+=b;for(v!==m&&(n[d++]=y),x=v;b--;)x=p[x],n[--w]=255&x,x>>=8;null!==g&&s<4096&&(p[s++]=g<<8|y,s>=c+1&&l<12&&(++l,c=c<<1|1)),g=m}else s=o+1,c=(1<<(l=a+1))-1,g=null}return d!==r&&ne.log("Warning, gif stream shorter than expected."),n}function Yt(e){var t,n,r,a,i,o=Math.floor,s=new Array(64),l=new Array(64),c=new Array(64),u=new Array(64),h=new Array(65535),d=new Array(65535),f=new Array(64),p=new Array(64),g=[],m=0,v=7,b=new Array(64),x=new Array(64),y=new Array(64),w=new Array(256),k=new Array(2048),N=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],S=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],C=[0,1,2,3,4,5,6,7,8,9,10,11],E=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],_=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],I=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],T=[0,1,2,3,4,5,6,7,8,9,10,11],A=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],R=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function D(e,t){for(var n=0,r=0,a=new Array,i=1;i<=16;i++){for(var o=1;o<=e[i];o++)a[t[r]]=[],a[t[r]][0]=n,a[t[r]][1]=i,r++,n++;n*=2}return a}function F(e){for(var t=e[0],n=e[1]-1;n>=0;)t&1<<n&&(m|=1<<v),n--,--v<0&&(255==m?(O(255),O(0)):O(m),v=7,m=0)}function O(e){g.push(e)}function L(e){O(e>>8&255),O(255&e)}function P(e,t,n,r,a){for(var i,o=a[0],s=a[240],l=function(e,t){var n,r,a,i,o,s,l,c,u,h,d=0;for(u=0;u<8;++u){n=e[d],r=e[d+1],a=e[d+2],i=e[d+3],o=e[d+4],s=e[d+5],l=e[d+6];var p=n+(c=e[d+7]),g=n-c,m=r+l,v=r-l,b=a+s,x=a-s,y=i+o,w=i-o,k=p+y,N=p-y,S=m+b,C=m-b;e[d]=k+S,e[d+4]=k-S;var E=.707106781*(C+N);e[d+2]=N+E,e[d+6]=N-E;var _=.382683433*((k=w+x)-(C=v+g)),I=.5411961*k+_,T=1.306562965*C+_,A=.707106781*(S=x+v),R=g+A,D=g-A;e[d+5]=D+I,e[d+3]=D-I,e[d+1]=R+T,e[d+7]=R-T,d+=8}for(d=0,u=0;u<8;++u){n=e[d],r=e[d+8],a=e[d+16],i=e[d+24],o=e[d+32],s=e[d+40],l=e[d+48];var F=n+(c=e[d+56]),O=n-c,L=r+l,P=r-l,M=a+s,j=a-s,B=i+o,z=i-o,W=F+B,U=F-B,V=L+M,H=L-M;e[d]=W+V,e[d+32]=W-V;var G=.707106781*(H+U);e[d+16]=U+G,e[d+48]=U-G;var q=.382683433*((W=z+j)-(H=P+O)),K=.5411961*W+q,X=1.306562965*H+q,Y=.707106781*(V=j+P),$=O+Y,J=O-Y;e[d+40]=J+K,e[d+24]=J-K,e[d+8]=$+X,e[d+56]=$-X,d++}for(u=0;u<64;++u)h=e[u]*t[u],f[u]=h>0?h+.5|0:h-.5|0;return f}(e,t),c=0;c<64;++c)p[N[c]]=l[c];var u=p[0]-n;n=p[0],0==u?F(r[0]):(F(r[d[i=32767+u]]),F(h[i]));for(var g=63;g>0&&0==p[g];)g--;if(0==g)return F(o),n;for(var m,v=1;v<=g;){for(var b=v;0==p[v]&&v<=g;)++v;var x=v-b;if(x>=16){m=x>>4;for(var y=1;y<=m;++y)F(s);x&=15}i=32767+p[v],F(a[(x<<4)+d[i]]),F(h[i]),v++}return 63!=g&&F(o),n}function M(e){e=Math.min(Math.max(e,1),100),i!=e&&(function(e){for(var t=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],n=0;n<64;n++){var r=o((t[n]*e+50)/100);r=Math.min(Math.max(r,1),255),s[N[n]]=r}for(var a=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],i=0;i<64;i++){var h=o((a[i]*e+50)/100);h=Math.min(Math.max(h,1),255),l[N[i]]=h}for(var d=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],f=0,p=0;p<8;p++)for(var g=0;g<8;g++)c[f]=1/(s[N[f]]*d[p]*d[g]*8),u[f]=1/(l[N[f]]*d[p]*d[g]*8),f++}(e<50?Math.floor(5e3/e):Math.floor(200-2*e)),i=e)}this.encode=function(e,i){i&&M(i),g=new Array,m=0,v=7,L(65496),L(65504),L(16),O(74),O(70),O(73),O(70),O(0),O(1),O(1),O(0),L(1),L(1),O(0),O(0),function(){L(65499),L(132),O(0);for(var e=0;e<64;e++)O(s[e]);O(1);for(var t=0;t<64;t++)O(l[t])}(),function(e,t){L(65472),L(17),O(8),L(t),L(e),O(3),O(1),O(17),O(0),O(2),O(17),O(1),O(3),O(17),O(1)}(e.width,e.height),function(){L(65476),L(418),O(0);for(var e=0;e<16;e++)O(S[e+1]);for(var t=0;t<=11;t++)O(C[t]);O(16);for(var n=0;n<16;n++)O(E[n+1]);for(var r=0;r<=161;r++)O(_[r]);O(1);for(var a=0;a<16;a++)O(I[a+1]);for(var i=0;i<=11;i++)O(T[i]);O(17);for(var o=0;o<16;o++)O(A[o+1]);for(var s=0;s<=161;s++)O(R[s])}(),L(65498),L(12),O(3),O(1),O(0),O(2),O(17),O(3),O(17),O(0),O(63),O(0);var o=0,h=0,d=0;m=0,v=7,this.encode.displayName="_encode_";for(var f,p,w,N,D,j,B,z,W,U=e.data,V=e.width,H=e.height,G=4*V,q=0;q<H;){for(f=0;f<G;){for(D=G*q+f,B=-1,z=0,W=0;W<64;W++)j=D+(z=W>>3)*G+(B=4*(7&W)),q+z>=H&&(j-=G*(q+1+z-H)),f+B>=G&&(j-=f+B-G+4),p=U[j++],w=U[j++],N=U[j++],b[W]=(k[p]+k[w+256|0]+k[N+512|0]>>16)-128,x[W]=(k[p+768|0]+k[w+1024|0]+k[N+1280|0]>>16)-128,y[W]=(k[p+1280|0]+k[w+1536|0]+k[N+1792|0]>>16)-128;o=P(b,c,o,t,r),h=P(x,u,h,n,a),d=P(y,u,d,n,a),f+=32}q+=8}if(v>=0){var K=[];K[1]=v+1,K[0]=(1<<v+1)-1,F(K)}return L(65497),new Uint8Array(g)},e=e||50,function(){for(var e=String.fromCharCode,t=0;t<256;t++)w[t]=e(t)}(),t=D(S,C),n=D(I,T),r=D(E,_),a=D(A,R),function(){for(var e=1,t=2,n=1;n<=15;n++){for(var r=e;r<t;r++)d[32767+r]=n,h[32767+r]=[],h[32767+r][1]=n,h[32767+r][0]=r;for(var a=-(t-1);a<=-e;a++)d[32767+a]=n,h[32767+a]=[],h[32767+a][1]=n,h[32767+a][0]=t-1+a;e<<=1,t<<=1}}(),function(){for(var e=0;e<256;e++)k[e]=19595*e,k[e+256|0]=38470*e,k[e+512|0]=7471*e+32768,k[e+768|0]=-11059*e,k[e+1024|0]=-21709*e,k[e+1280|0]=32768*e+8421375,k[e+1536|0]=-27439*e,k[e+1792|0]=-5329*e}(),M(e)}function $t(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,-1===["BM","BA","CI","CP","IC","PT"].indexOf(this.flag))throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Jt(e){function t(e){if(!e)throw Error("assert :P")}function n(e,t,n){for(var r=0;4>r;r++)if(e[t+r]!=n.charCodeAt(r))return!0;return!1}function r(e,t,n,r,a){for(var i=0;i<a;i++)e[t+i]=n[r+i]}function a(e,t,n,r){for(var a=0;a<r;a++)e[t+a]=n}function i(e){return new Int32Array(e)}function o(e,t){for(var n=[],r=0;r<e;r++)n.push(new t);return n}function s(e,t){var n=[];return function e(n,r,a){for(var i=a[r],o=0;o<i&&(n.push(a.length>r+1?[]:new t),!(a.length<r+1));o++)e(n[o],r+1,a)}(n,0,e),n}var l=function(){var e=this;function l(e,t){for(var n=1<<t-1>>>0;e&n;)n>>>=1;return n?(e&n-1)+n:e}function c(e,n,r,a,i){t(!(a%r));do{e[n+(a-=r)]=i}while(0<a)}function u(e,n,r,a,o){if(t(2328>=o),512>=o)var s=i(512);else if(null==(s=i(o)))return 0;return function(e,n,r,a,o,s){var u,d,f=n,p=1<<r,g=i(16),m=i(16);for(t(0!=o),t(null!=a),t(null!=e),t(0<r),d=0;d<o;++d){if(15<a[d])return 0;++g[a[d]]}if(g[0]==o)return 0;for(m[1]=0,u=1;15>u;++u){if(g[u]>1<<u)return 0;m[u+1]=m[u]+g[u]}for(d=0;d<o;++d)u=a[d],0<a[d]&&(s[m[u]++]=d);if(1==m[15])return(a=new h).g=0,a.value=s[0],c(e,f,1,p,a),p;var v,b=-1,x=p-1,y=0,w=1,k=1,N=1<<r;for(d=0,u=1,o=2;u<=r;++u,o<<=1){if(w+=k<<=1,0>(k-=g[u]))return 0;for(;0<g[u];--g[u])(a=new h).g=u,a.value=s[d++],c(e,f+y,o,N,a),y=l(y,u)}for(u=r+1,o=2;15>=u;++u,o<<=1){if(w+=k<<=1,0>(k-=g[u]))return 0;for(;0<g[u];--g[u]){if(a=new h,(y&x)!=b){for(f+=N,v=1<<(b=u)-r;15>b&&!(0>=(v-=g[b]));)++b,v<<=1;p+=N=1<<(v=b-r),e[n+(b=y&x)].g=v+r,e[n+b].value=f-n-b}a.g=u-r,a.value=s[d++],c(e,f+(y>>r),o,N,a),y=l(y,u)}}return w!=2*m[15]-1?0:p}(e,n,r,a,o,s)}function h(){this.value=this.g=0}function d(){this.value=this.g=0}function f(){this.G=o(5,h),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Bn,d)}function p(e,n,r,a){t(null!=e),t(null!=n),t(2147483648>a),e.Ca=254,e.I=0,e.b=-8,e.Ka=0,e.oa=n,e.pa=r,e.Jd=n,e.Yc=r+a,e.Zc=4<=a?r+a-4+1:r,E(e)}function g(e,t){for(var n=0;0<t--;)n|=I(e,128)<<t;return n}function m(e,t){var n=g(e,t);return _(e)?-n:n}function v(e,n,r,a){var i,o=0;for(t(null!=e),t(null!=n),t(4294967288>a),e.Sb=a,e.Ra=0,e.u=0,e.h=0,4<a&&(a=4),i=0;i<a;++i)o+=n[r+i]<<8*i;e.Ra=o,e.bb=a,e.oa=n,e.pa=r}function b(e){for(;8<=e.u&&e.bb<e.Sb;)e.Ra>>>=8,e.Ra+=e.oa[e.pa+e.bb]<<Un-8>>>0,++e.bb,e.u-=8;N(e)&&(e.h=1,e.u=0)}function x(e,n){if(t(0<=n),!e.h&&n<=Wn){var r=k(e)&zn[n];return e.u+=n,b(e),r}return e.h=1,e.u=0}function y(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function w(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function k(e){return e.Ra>>>(e.u&Un-1)>>>0}function N(e){return t(e.bb<=e.Sb),e.h||e.bb==e.Sb&&e.u>Un}function S(e,t){e.u=t,e.h=N(e)}function C(e){e.u>=Vn&&(t(e.u>=Vn),b(e))}function E(e){t(null!=e&&null!=e.oa),e.pa<e.Zc?(e.I=(e.oa[e.pa++]|e.I<<8)>>>0,e.b+=8):(t(null!=e&&null!=e.oa),e.pa<e.Yc?(e.b+=8,e.I=e.oa[e.pa++]|e.I<<8):e.Ka?e.b=0:(e.I<<=8,e.b+=8,e.Ka=1))}function _(e){return g(e,1)}function I(e,t){var n=e.Ca;0>e.b&&E(e);var r=e.b,a=n*t>>>8,i=(e.I>>>r>a)+0;for(i?(n-=a,e.I-=a+1<<r>>>0):n=a+1,r=n,a=0;256<=r;)a+=8,r>>=8;return r=7^a+Hn[r],e.b-=r,e.Ca=(n<<r)-1,i}function T(e,t,n){e[t+0]=n>>24&255,e[t+1]=n>>16&255,e[t+2]=n>>8&255,e[t+3]=255&n}function A(e,t){return e[t+0]|e[t+1]<<8}function R(e,t){return A(e,t)|e[t+2]<<16}function D(e,t){return A(e,t)|A(e,t+2)<<16}function F(e,n){var r=1<<n;return t(null!=e),t(0<n),e.X=i(r),null==e.X?0:(e.Mb=32-n,e.Xa=n,1)}function O(e,n){t(null!=e),t(null!=n),t(e.Xa==n.Xa),r(n.X,0,e.X,0,1<<n.Xa)}function L(){this.X=[],this.Xa=this.Mb=0}function P(e,n,r,a){t(null!=r),t(null!=a);var i=r[0],o=a[0];return 0==i&&(i=(e*o+n/2)/n),0==o&&(o=(n*i+e/2)/e),0>=i||0>=o?0:(r[0]=i,a[0]=o,1)}function M(e,t){return e+(1<<t)-1>>>t}function j(e,t){return((4278255360&e)+(4278255360&t)>>>0&4278255360)+((16711935&e)+(16711935&t)>>>0&16711935)>>>0}function B(t,n){e[n]=function(n,r,a,i,o,s,l){var c;for(c=0;c<o;++c){var u=e[t](s[l+c-1],a,i+c);s[l+c]=j(n[r+c],u)}}}function z(){this.ud=this.hd=this.jd=0}function W(e,t){return((4278124286&(e^t))>>>1)+(e&t)>>>0}function U(e){return 0<=e&&256>e?e:0>e?0:255<e?255:void 0}function V(e,t){return U(e+(e-t+.5>>1))}function H(e,t,n){return Math.abs(t-n)-Math.abs(e-n)}function G(e,t,n,r,a,i,o){for(r=i[o-1],n=0;n<a;++n)i[o+n]=r=j(e[t+n],r)}function q(e,t,n,r,a){var i;for(i=0;i<n;++i){var o=e[t+i],s=o>>8&255,l=16711935&(l=(l=16711935&o)+((s<<16)+s));r[a+i]=(4278255360&o)+l>>>0}}function K(e,t){t.jd=255&e,t.hd=e>>8&255,t.ud=e>>16&255}function X(e,t,n,r,a,i){var o;for(o=0;o<r;++o){var s=t[n+o],l=s>>>8,c=s,u=255&(u=(u=s>>>16)+((e.jd<<24>>24)*(l<<24>>24)>>>5));c=255&(c=(c+=(e.hd<<24>>24)*(l<<24>>24)>>>5)+((e.ud<<24>>24)*(u<<24>>24)>>>5)),a[i+o]=(4278255360&s)+(u<<16)+c}}function Y(t,n,r,a,i){e[n]=function(e,t,n,r,o,s,l,c,u){for(r=l;r<c;++r)for(l=0;l<u;++l)o[s++]=i(n[a(e[t++])])},e[t]=function(t,n,o,s,l,c,u){var h=8>>t.b,d=t.Ea,f=t.K[0],p=t.w;if(8>h)for(t=(1<<t.b)-1,p=(1<<h)-1;n<o;++n){var g,m=0;for(g=0;g<d;++g)g&t||(m=a(s[l++])),c[u++]=i(f[m&p]),m>>=h}else e["VP8LMapColor"+r](s,l,f,p,c,u,n,o,d)}}function $(e,t,n,r,a){for(n=t+n;t<n;){var i=e[t++];r[a++]=i>>16&255,r[a++]=i>>8&255,r[a++]=255&i}}function J(e,t,n,r,a){for(n=t+n;t<n;){var i=e[t++];r[a++]=i>>16&255,r[a++]=i>>8&255,r[a++]=255&i,r[a++]=i>>24&255}}function Q(e,t,n,r,a){for(n=t+n;t<n;){var i=(o=e[t++])>>16&240|o>>12&15,o=240&o|o>>28&15;r[a++]=i,r[a++]=o}}function Z(e,t,n,r,a){for(n=t+n;t<n;){var i=(o=e[t++])>>16&248|o>>13&7,o=o>>5&224|o>>3&31;r[a++]=i,r[a++]=o}}function ee(e,t,n,r,a){for(n=t+n;t<n;){var i=e[t++];r[a++]=255&i,r[a++]=i>>8&255,r[a++]=i>>16&255}}function te(e,t,n,a,i,o){if(0==o)for(n=t+n;t<n;)T(a,((o=e[t++])[0]>>24|o[1]>>8&65280|o[2]<<8&16711680|o[3]<<24)>>>0),i+=32;else r(a,i,e,t,n)}function ne(t,n){e[n][0]=e[t+"0"],e[n][1]=e[t+"1"],e[n][2]=e[t+"2"],e[n][3]=e[t+"3"],e[n][4]=e[t+"4"],e[n][5]=e[t+"5"],e[n][6]=e[t+"6"],e[n][7]=e[t+"7"],e[n][8]=e[t+"8"],e[n][9]=e[t+"9"],e[n][10]=e[t+"10"],e[n][11]=e[t+"11"],e[n][12]=e[t+"12"],e[n][13]=e[t+"13"],e[n][14]=e[t+"0"],e[n][15]=e[t+"0"]}function re(e){return e==Vr||e==Hr||e==Gr||e==qr}function ae(){this.eb=[],this.size=this.A=this.fb=0}function ie(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function oe(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ae,this.f.kb=new ie,this.sd=null}function se(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function le(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function ce(e){return alert("todo:WebPSamplerProcessPlane"),e.T}function ue(e,t){var n=e.T,a=t.ba.f.RGBA,i=a.eb,o=a.fb+e.ka*a.A,s=va[t.ba.S],l=e.y,c=e.O,u=e.f,h=e.N,d=e.ea,f=e.W,p=t.cc,g=t.dc,m=t.Mc,v=t.Nc,b=e.ka,x=e.ka+e.T,y=e.U,w=y+1>>1;for(0==b?s(l,c,null,null,u,h,d,f,u,h,d,f,i,o,null,null,y):(s(t.ec,t.fc,l,c,p,g,m,v,u,h,d,f,i,o-a.A,i,o,y),++n);b+2<x;b+=2)p=u,g=h,m=d,v=f,h+=e.Rc,f+=e.Rc,o+=2*a.A,s(l,(c+=2*e.fa)-e.fa,l,c,p,g,m,v,u,h,d,f,i,o-a.A,i,o,y);return c+=e.fa,e.j+x<e.o?(r(t.ec,t.fc,l,c,y),r(t.cc,t.dc,u,h,w),r(t.Mc,t.Nc,d,f,w),n--):1&x||s(l,c,null,null,u,h,d,f,u,h,d,f,i,o+a.A,null,null,y),n}function he(e,n,r){var a=e.F,i=[e.J];if(null!=a){var o=e.U,s=n.ba.S,l=s==zr||s==Gr;n=n.ba.f.RGBA;var c=[0],u=e.ka;c[0]=e.T,e.Kb&&(0==u?--c[0]:(--u,i[0]-=e.width),e.j+e.ka+e.T==e.o&&(c[0]=e.o-e.j-u));var h=n.eb;u=n.fb+u*n.A,e=Cr(a,i[0],e.width,o,c,h,u+(l?0:3),n.A),t(r==c),e&&re(s)&&Nr(h,u,l,o,c,n.A)}return 0}function de(e){var t=e.ma,n=t.ba.S,r=11>n,a=n==Mr||n==Br||n==zr||n==Wr||12==n||re(n);if(t.memory=null,t.Ib=null,t.Jb=null,t.Nd=null,!Pn(t.Oa,e,a?11:12))return 0;if(a&&re(n)&&xn(),e.da)alert("todo:use_scaling");else{if(r){if(t.Ib=ce,e.Kb){if(n=e.U+1>>1,t.memory=i(e.U+2*n),null==t.memory)return 0;t.ec=t.memory,t.fc=0,t.cc=t.ec,t.dc=t.fc+e.U,t.Mc=t.cc,t.Nc=t.dc+n,t.Ib=ue,xn()}}else alert("todo:EmitYUV");a&&(t.Jb=he,r&&vn())}if(r&&!Ra){for(e=0;256>e;++e)Da[e]=89858*(e-128)+Ea>>Ca,La[e]=-22014*(e-128)+Ea,Oa[e]=-45773*(e-128),Fa[e]=113618*(e-128)+Ea>>Ca;for(e=_a;e<Ia;++e)t=76283*(e-16)+Ea>>Ca,Pa[e-_a]=Ge(t,255),Ma[e-_a]=Ge(t+8>>4,15);Ra=1}return 1}function fe(e){var n=e.ma,r=e.U,a=e.T;return t(!(1&e.ka)),0>=r||0>=a?0:(r=n.Ib(e,n),null!=n.Jb&&n.Jb(e,n,r),n.Dc+=r,1)}function pe(e){e.ma.memory=null}function ge(e,t,n,r){return 47!=x(e,8)?0:(t[0]=x(e,14)+1,n[0]=x(e,14)+1,r[0]=x(e,1),0!=x(e,3)?0:!e.h)}function me(e,t){if(4>e)return e+1;var n=e-2>>1;return(2+(1&e)<<n)+x(t,n)+1}function ve(e,t){return 120<t?t-120:1<=(n=((n=Qr[t-1])>>4)*e+(8-(15&n)))?n:1;var n}function be(e,t,n){var r=k(n),a=e[t+=255&r].g-8;return 0<a&&(S(n,n.u+8),r=k(n),t+=e[t].value,t+=r&(1<<a)-1),S(n,n.u+e[t].g),e[t].value}function xe(e,n,r){return r.g+=e.g,r.value+=e.value<<n>>>0,t(8>=r.g),e.g}function ye(e,n,r){var a=e.xc;return t((n=0==a?0:e.vc[e.md*(r>>a)+(n>>a)])<e.Wb),e.Ya[n]}function we(e,n,a,i){var o=e.ab,s=e.c*n,l=e.C;n=l+n;var c=a,u=i;for(i=e.Ta,a=e.Ua;0<o--;){var h=e.gc[o],d=l,f=n,p=c,g=u,m=(u=i,c=a,h.Ea);switch(t(d<f),t(f<=h.nc),h.hc){case 2:Kn(p,g,(f-d)*m,u,c);break;case 0:var v=d,b=f,x=u,y=c,w=(E=h).Ea;0==v&&(Gn(p,g,null,null,1,x,y),G(p,g+1,0,0,w-1,x,y+1),g+=w,y+=w,++v);for(var k=1<<E.b,N=k-1,S=M(w,E.b),C=E.K,E=E.w+(v>>E.b)*S;v<b;){var _=C,I=E,T=1;for(qn(p,g,x,y-w,1,x,y);T<w;){var A=(T&~N)+k;A>w&&(A=w),(0,Qn[_[I++]>>8&15])(p,g+ +T,x,y+T-w,A-T,x,y+T),T=A}g+=w,y+=w,++v&N||(E+=S)}f!=h.nc&&r(u,c-m,u,c+(f-d-1)*m,m);break;case 1:for(m=p,b=g,w=(p=h.Ea)-(y=p&~(x=(g=1<<h.b)-1)),v=M(p,h.b),k=h.K,h=h.w+(d>>h.b)*v;d<f;){for(N=k,S=h,C=new z,E=b+y,_=b+p;b<E;)K(N[S++],C),Zn(C,m,b,g,u,c),b+=g,c+=g;b<_&&(K(N[S++],C),Zn(C,m,b,w,u,c),b+=w,c+=w),++d&x||(h+=v)}break;case 3:if(p==u&&g==c&&0<h.b){for(b=u,p=m=c+(f-d)*m-(y=(f-d)*M(h.Ea,h.b)),g=u,x=c,v=[],y=(w=y)-1;0<=y;--y)v[y]=g[x+y];for(y=w-1;0<=y;--y)b[p+y]=v[y];Xn(h,d,f,u,m,u,c)}else Xn(h,d,f,p,g,u,c)}c=i,u=a}u!=a&&r(i,a,c,u,s)}function ke(e,n){var r=e.V,a=e.Ba+e.c*e.C,i=n-e.C;if(t(n<=e.l.o),t(16>=i),0<i){var o=e.l,s=e.Ta,l=e.Ua,c=o.width;if(we(e,i,r,a),i=l=[l],t((r=e.C)<(a=n)),t(o.v<o.va),a>o.o&&(a=o.o),r<o.j){var u=o.j-r;r=o.j,i[0]+=u*c}if(r>=a?r=0:(i[0]+=4*o.v,o.ka=r-o.j,o.U=o.va-o.v,o.T=a-r,r=1),r){if(l=l[0],11>(r=e.ca).S){var h=r.f.RGBA,d=(a=r.S,i=o.U,o=o.T,u=h.eb,h.A),f=o;for(h=h.fb+e.Ma*h.A;0<f--;){var p=s,g=l,m=i,v=u,b=h;switch(a){case Pr:er(p,g,m,v,b);break;case Mr:tr(p,g,m,v,b);break;case Vr:tr(p,g,m,v,b),Nr(v,b,0,m,1,0);break;case jr:ar(p,g,m,v,b);break;case Br:te(p,g,m,v,b,1);break;case Hr:te(p,g,m,v,b,1),Nr(v,b,0,m,1,0);break;case zr:te(p,g,m,v,b,0);break;case Gr:te(p,g,m,v,b,0),Nr(v,b,1,m,1,0);break;case Wr:nr(p,g,m,v,b);break;case qr:nr(p,g,m,v,b),Sr(v,b,m,1,0);break;case Ur:rr(p,g,m,v,b);break;default:t(0)}l+=c,h+=d}e.Ma+=o}else alert("todo:EmitRescaledRowsYUVA");t(e.Ma<=r.height)}}e.C=n,t(e.C<=e.i)}function Ne(e){var t;if(0<e.ua)return 0;for(t=0;t<e.Wb;++t){var n=e.Ya[t].G,r=e.Ya[t].H;if(0<n[1][r[1]+0].g||0<n[2][r[2]+0].g||0<n[3][r[3]+0].g)return 0}return 1}function Se(e,n,r,a,i,o){if(0!=e.Z){var s=e.qd,l=e.rd;for(t(null!=ma[e.Z]);n<r;++n)ma[e.Z](s,l,a,i,a,i,o),s=a,l=i,i+=o;e.qd=s,e.rd=l}}function Ce(e,n){var r=e.l.ma,a=0==r.Z||1==r.Z?e.l.j:e.C;if(a=e.C<a?a:e.C,t(n<=e.l.o),n>a){var i=e.l.width,o=r.ca,s=r.tb+i*a,l=e.V,c=e.Ba+e.c*a,u=e.gc;t(1==e.ab),t(3==u[0].hc),$n(u[0],a,n,l,c,o,s),Se(r,a,n,o,s,i)}e.C=e.Ma=n}function Ee(e,n,r,a,i,o,s){var l=e.$/a,c=e.$%a,u=e.m,h=e.s,d=r+e.$,f=d;i=r+a*i;var p=r+a*o,g=280+h.ua,m=e.Pb?l:16777216,v=0<h.ua?h.Wa:null,b=h.wc,x=d<p?ye(h,c,l):null;t(e.C<o),t(p<=i);var y=!1;e:for(;;){for(;y||d<p;){var w=0;if(l>=m){var E=d-r;t((m=e).Pb),m.wd=m.m,m.xd=E,0<m.s.ua&&O(m.s.Wa,m.s.vb),m=l+ea}if(c&b||(x=ye(h,c,l)),t(null!=x),x.Qb&&(n[d]=x.qb,y=!0),!y)if(C(u),x.jc){w=u,E=n;var _=d,I=x.pd[k(w)&Bn-1];t(x.jc),256>I.g?(S(w,w.u+I.g),E[_]=I.value,w=0):(S(w,w.u+I.g-256),t(256<=I.value),w=I.value),0==w&&(y=!0)}else w=be(x.G[0],x.H[0],u);if(u.h)break;if(y||256>w){if(!y)if(x.nd)n[d]=(x.qb|w<<8)>>>0;else{if(C(u),y=be(x.G[1],x.H[1],u),C(u),E=be(x.G[2],x.H[2],u),_=be(x.G[3],x.H[3],u),u.h)break;n[d]=(_<<24|y<<16|w<<8|E)>>>0}if(y=!1,++d,++c>=a&&(c=0,++l,null!=s&&l<=o&&!(l%16)&&s(e,l),null!=v))for(;f<d;)w=n[f++],v.X[(506832829*w&4294967295)>>>v.Mb]=w}else if(280>w){if(w=me(w-256,u),E=be(x.G[4],x.H[4],u),C(u),E=ve(a,E=me(E,u)),u.h)break;if(d-r<E||i-d<w)break e;for(_=0;_<w;++_)n[d+_]=n[d+_-E];for(d+=w,c+=w;c>=a;)c-=a,++l,null!=s&&l<=o&&!(l%16)&&s(e,l);if(t(d<=i),c&b&&(x=ye(h,c,l)),null!=v)for(;f<d;)w=n[f++],v.X[(506832829*w&4294967295)>>>v.Mb]=w}else{if(!(w<g))break e;for(y=w-280,t(null!=v);f<d;)w=n[f++],v.X[(506832829*w&4294967295)>>>v.Mb]=w;w=d,t(!(y>>>(E=v).Xa)),n[w]=E.X[y],y=!0}y||t(u.h==N(u))}if(e.Pb&&u.h&&d<i)t(e.m.h),e.a=5,e.m=e.wd,e.$=e.xd,0<e.s.ua&&O(e.s.vb,e.s.Wa);else{if(u.h)break e;null!=s&&s(e,l>o?o:l),e.a=0,e.$=d-r}return 1}return e.a=3,0}function _e(e){t(null!=e),e.vc=null,e.yc=null,e.Ya=null;var n=e.Wa;null!=n&&(n.X=null),e.vb=null,t(null!=e)}function Ie(){var t=new sn;return null==t?null:(t.a=0,t.xb=ga,ne("Predictor","VP8LPredictors"),ne("Predictor","VP8LPredictors_C"),ne("PredictorAdd","VP8LPredictorsAdd"),ne("PredictorAdd","VP8LPredictorsAdd_C"),Kn=q,Zn=X,er=$,tr=J,nr=Q,rr=Z,ar=ee,e.VP8LMapColor32b=Yn,e.VP8LMapColor8b=Jn,t)}function Te(e,n,r,s,l){var c=1,d=[e],p=[n],g=s.m,m=s.s,v=null,b=0;e:for(;;){if(r)for(;c&&x(g,1);){var y=d,w=p,N=s,E=1,_=N.m,I=N.gc[N.ab],T=x(_,2);if(N.Oc&1<<T)c=0;else{switch(N.Oc|=1<<T,I.hc=T,I.Ea=y[0],I.nc=w[0],I.K=[null],++N.ab,t(4>=N.ab),T){case 0:case 1:I.b=x(_,3)+2,E=Te(M(I.Ea,I.b),M(I.nc,I.b),0,N,I.K),I.K=I.K[0];break;case 3:var A,R=x(_,8)+1,D=16<R?0:4<R?1:2<R?2:3;if(y[0]=M(I.Ea,D),I.b=D,A=E=Te(R,1,0,N,I.K)){var O,L=R,P=I,B=1<<(8>>P.b),z=i(B);if(null==z)A=0;else{var W=P.K[0],U=P.w;for(z[0]=P.K[0][0],O=1;O<1*L;++O)z[O]=j(W[U+O],z[O-1]);for(;O<4*B;++O)z[O]=0;P.K[0]=null,P.K[0]=z,A=1}}E=A;break;case 2:break;default:t(0)}c=E}}if(d=d[0],p=p[0],c&&x(g,1)&&!(c=1<=(b=x(g,4))&&11>=b)){s.a=3;break e}var V;if(V=c)t:{var H,G,q,K=s,X=d,Y=p,$=b,J=r,Q=K.m,Z=K.s,ee=[null],te=1,ne=0,re=Zr[$];n:for(;;){if(J&&x(Q,1)){var ae=x(Q,3)+2,ie=M(X,ae),oe=M(Y,ae),se=ie*oe;if(!Te(ie,oe,0,K,ee))break n;for(ee=ee[0],Z.xc=ae,H=0;H<se;++H){var le=ee[H]>>8&65535;ee[H]=le,le>=te&&(te=le+1)}}if(Q.h)break n;for(G=0;5>G;++G){var ce=Yr[G];!G&&0<$&&(ce+=1<<$),ne<ce&&(ne=ce)}var ue=o(te*re,h),he=te,de=o(he,f);if(null==de)var fe=null;else t(65536>=he),fe=de;var pe=i(ne);if(null==fe||null==pe||null==ue){K.a=1;break n}var ge=ue;for(H=q=0;H<te;++H){var me=fe[H],ve=me.G,be=me.H,ye=0,we=1,ke=0;for(G=0;5>G;++G){ce=Yr[G],ve[G]=ge,be[G]=q,!G&&0<$&&(ce+=1<<$);r:{var Ne,Se=ce,Ce=K,Ie=pe,Ae=ge,Re=q,De=0,Fe=Ce.m,Oe=x(Fe,1);if(a(Ie,0,0,Se),Oe){var Le=x(Fe,1)+1,Pe=x(Fe,1),Me=x(Fe,0==Pe?1:8);Ie[Me]=1,2==Le&&(Ie[Me=x(Fe,8)]=1);var je=1}else{var Be=i(19),ze=x(Fe,4)+4;if(19<ze){Ce.a=3;var We=0;break r}for(Ne=0;Ne<ze;++Ne)Be[Jr[Ne]]=x(Fe,3);var Ue=void 0,Ve=void 0,He=Ce,Ge=Be,qe=Se,Ke=Ie,Xe=0,Ye=He.m,$e=8,Je=o(128,h);a:for(;u(Je,0,7,Ge,19);){if(x(Ye,1)){var Qe=2+2*x(Ye,3);if((Ue=2+x(Ye,Qe))>qe)break a}else Ue=qe;for(Ve=0;Ve<qe&&Ue--;){C(Ye);var Ze=Je[0+(127&k(Ye))];S(Ye,Ye.u+Ze.g);var et=Ze.value;if(16>et)Ke[Ve++]=et,0!=et&&($e=et);else{var tt=16==et,nt=et-16,rt=Xr[nt],at=x(Ye,Kr[nt])+rt;if(Ve+at>qe)break a;for(var it=tt?$e:0;0<at--;)Ke[Ve++]=it}}Xe=1;break a}Xe||(He.a=3),je=Xe}(je=je&&!Fe.h)&&(De=u(Ae,Re,8,Ie,Se)),je&&0!=De?We=De:(Ce.a=3,We=0)}if(0==We)break n;if(we&&1==$r[G]&&(we=0==ge[q].g),ye+=ge[q].g,q+=We,3>=G){var ot,st=pe[0];for(ot=1;ot<ce;++ot)pe[ot]>st&&(st=pe[ot]);ke+=st}}if(me.nd=we,me.Qb=0,we&&(me.qb=(ve[3][be[3]+0].value<<24|ve[1][be[1]+0].value<<16|ve[2][be[2]+0].value)>>>0,0==ye&&256>ve[0][be[0]+0].value&&(me.Qb=1,me.qb+=ve[0][be[0]+0].value<<8)),me.jc=!me.Qb&&6>ke,me.jc){var lt,ct=me;for(lt=0;lt<Bn;++lt){var ut=lt,ht=ct.pd[ut],dt=ct.G[0][ct.H[0]+ut];256<=dt.value?(ht.g=dt.g+256,ht.value=dt.value):(ht.g=0,ht.value=0,ut>>=xe(dt,8,ht),ut>>=xe(ct.G[1][ct.H[1]+ut],16,ht),ut>>=xe(ct.G[2][ct.H[2]+ut],0,ht),xe(ct.G[3][ct.H[3]+ut],24,ht))}}}Z.vc=ee,Z.Wb=te,Z.Ya=fe,Z.yc=ue,V=1;break t}V=0}if(!(c=V)){s.a=3;break e}if(0<b){if(m.ua=1<<b,!F(m.Wa,b)){s.a=1,c=0;break e}}else m.ua=0;var ft=s,pt=d,gt=p,mt=ft.s,vt=mt.xc;if(ft.c=pt,ft.i=gt,mt.md=M(pt,vt),mt.wc=0==vt?-1:(1<<vt)-1,r){s.xb=pa;break e}if(null==(v=i(d*p))){s.a=1,c=0;break e}c=(c=Ee(s,v,0,d,p,p,null))&&!g.h;break e}return c?(null!=l?l[0]=v:(t(null==v),t(r)),s.$=0,r||_e(m)):_e(m),c}function Ae(e,n){var r=e.c*e.i,a=r+n+16*n;return t(e.c<=n),e.V=i(a),null==e.V?(e.Ta=null,e.Ua=0,e.a=1,0):(e.Ta=e.V,e.Ua=e.Ba+r+n,1)}function Re(e,n){var r=e.C,a=n-r,i=e.V,o=e.Ba+e.c*r;for(t(n<=e.l.o);0<a;){var s=16<a?16:a,l=e.l.ma,c=e.l.width,u=c*s,h=l.ca,d=l.tb+c*r,f=e.Ta,p=e.Ua;we(e,s,i,o),Er(f,p,h,d,u),Se(l,r,r+s,h,d,c),a-=s,i+=s*e.c,r+=s}t(r==n),e.C=e.Ma=n}function De(){this.ub=this.yd=this.td=this.Rb=0}function Fe(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Oe(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function Le(){this.Yb=function(){var e=[];return function e(t,n,r){for(var a=r[n],i=0;i<a&&(t.push(r.length>n+1?[]:0),!(r.length<n+1));i++)e(t[i],n+1,r)}(e,0,[3,11]),e}()}function Pe(){this.jb=i(3),this.Wc=s([4,8],Le),this.Xc=s([4,17],Le)}function Me(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function je(){this.ld=this.La=this.dd=this.tc=0}function Be(){this.Na=this.la=0}function ze(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function We(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Ue(){this.uc=this.M=this.Nb=0,this.wa=Array(new je),this.Y=0,this.ya=Array(new We),this.aa=0,this.l=new qe}function Ve(){this.y=i(16),this.f=i(8),this.ea=i(8)}function He(){this.cb=this.a=0,this.sc="",this.m=new y,this.Od=new De,this.Kc=new Fe,this.ed=new Me,this.Qa=new Oe,this.Ic=this.$c=this.Aa=0,this.D=new Ue,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,y),this.ia=0,this.pb=o(4,ze),this.Pa=new Pe,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Ve),this.Hd=0,this.rb=Array(new Be),this.sb=0,this.wa=Array(new je),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new We),this.L=this.aa=0,this.gd=s([4,2],je),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Ge(e,t){return 0>e?0:e>t?t:e}function qe(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Ke(){var e=new He;return null!=e&&(e.a=0,e.sc="OK",e.cb=0,e.Xb=0,ra||(ra=Je)),e}function Xe(e,t,n){return 0==e.a&&(e.a=t,e.sc=n,e.cb=0),0}function Ye(e,t,n){return 3<=n&&157==e[t+0]&&1==e[t+1]&&42==e[t+2]}function $e(e,n){if(null==e)return 0;if(e.a=0,e.sc="OK",null==n)return Xe(e,2,"null VP8Io passed to VP8GetHeaders()");var r=n.data,i=n.w,o=n.ha;if(4>o)return Xe(e,7,"Truncated header.");var s=r[i+0]|r[i+1]<<8|r[i+2]<<16,l=e.Od;if(l.Rb=!(1&s),l.td=s>>1&7,l.yd=s>>4&1,l.ub=s>>5,3<l.td)return Xe(e,3,"Incorrect keyframe parameters.");if(!l.yd)return Xe(e,4,"Frame not displayable.");i+=3,o-=3;var c=e.Kc;if(l.Rb){if(7>o)return Xe(e,7,"cannot parse picture header");if(!Ye(r,i,o))return Xe(e,3,"Bad code word");c.c=16383&(r[i+4]<<8|r[i+3]),c.Td=r[i+4]>>6,c.i=16383&(r[i+6]<<8|r[i+5]),c.Ud=r[i+6]>>6,i+=7,o-=7,e.za=c.c+15>>4,e.Ub=c.i+15>>4,n.width=c.c,n.height=c.i,n.Da=0,n.j=0,n.v=0,n.va=n.width,n.o=n.height,n.da=0,n.ib=n.width,n.hb=n.height,n.U=n.width,n.T=n.height,a((s=e.Pa).jb,0,255,s.jb.length),t(null!=(s=e.Qa)),s.Cb=0,s.Bb=0,s.Fb=1,a(s.Zb,0,0,s.Zb.length),a(s.Lb,0,0,s.Lb)}if(l.ub>o)return Xe(e,7,"bad partition length");p(s=e.m,r,i,l.ub),i+=l.ub,o-=l.ub,l.Rb&&(c.Ld=_(s),c.Kd=_(s)),c=e.Qa;var u,h=e.Pa;if(t(null!=s),t(null!=c),c.Cb=_(s),c.Cb){if(c.Bb=_(s),_(s)){for(c.Fb=_(s),u=0;4>u;++u)c.Zb[u]=_(s)?m(s,7):0;for(u=0;4>u;++u)c.Lb[u]=_(s)?m(s,6):0}if(c.Bb)for(u=0;3>u;++u)h.jb[u]=_(s)?g(s,8):255}else c.Bb=0;if(s.Ka)return Xe(e,3,"cannot parse segment header");if((c=e.ed).zd=_(s),c.Tb=g(s,6),c.wb=g(s,3),c.Pc=_(s),c.Pc&&_(s)){for(h=0;4>h;++h)_(s)&&(c.vd[h]=m(s,6));for(h=0;4>h;++h)_(s)&&(c.od[h]=m(s,6))}if(e.L=0==c.Tb?0:c.zd?1:2,s.Ka)return Xe(e,3,"cannot parse filter header");var d=o;if(o=u=i,i=u+d,c=d,e.Xb=(1<<g(e.m,2))-1,d<3*(h=e.Xb))r=7;else{for(u+=3*h,c-=3*h,d=0;d<h;++d){var f=r[o+0]|r[o+1]<<8|r[o+2]<<16;f>c&&(f=c),p(e.Jc[+d],r,u,f),u+=f,c-=f,o+=3}p(e.Jc[+h],r,u,c),r=u<i?0:5}if(0!=r)return Xe(e,r,"cannot parse partitions");for(r=g(u=e.m,7),o=_(u)?m(u,4):0,i=_(u)?m(u,4):0,c=_(u)?m(u,4):0,h=_(u)?m(u,4):0,u=_(u)?m(u,4):0,d=e.Qa,f=0;4>f;++f){if(d.Cb){var v=d.Zb[f];d.Fb||(v+=r)}else{if(0<f){e.pb[f]=e.pb[0];continue}v=r}var b=e.pb[f];b.Sc[0]=ta[Ge(v+o,127)],b.Sc[1]=na[Ge(v+0,127)],b.Eb[0]=2*ta[Ge(v+i,127)],b.Eb[1]=101581*na[Ge(v+c,127)]>>16,8>b.Eb[1]&&(b.Eb[1]=8),b.Qc[0]=ta[Ge(v+h,117)],b.Qc[1]=na[Ge(v+u,127)],b.lc=v+u}if(!l.Rb)return Xe(e,4,"Not a key frame.");for(_(s),l=e.Pa,r=0;4>r;++r){for(o=0;8>o;++o)for(i=0;3>i;++i)for(c=0;11>c;++c)h=I(s,ca[r][o][i][c])?g(s,8):sa[r][o][i][c],l.Wc[r][o].Yb[i][c]=h;for(o=0;17>o;++o)l.Xc[r][o]=l.Wc[r][ua[o]]}return e.kc=_(s),e.kc&&(e.Bd=g(s,8)),e.cb=1}function Je(e,t,n,r,a,i,o){var s=t[a].Yb[n];for(n=0;16>a;++a){if(!I(e,s[n+0]))return a;for(;!I(e,s[n+1]);)if(s=t[++a].Yb[0],n=0,16==a)return 16;var l=t[a+1].Yb;if(I(e,s[n+2])){var c=e,u=0;if(I(c,(d=s)[(h=n)+3]))if(I(c,d[h+6])){for(s=0,h=2*(u=I(c,d[h+8]))+(d=I(c,d[h+9+u])),u=0,d=aa[h];d[s];++s)u+=u+I(c,d[s]);u+=3+(8<<h)}else I(c,d[h+7])?(u=7+2*I(c,165),u+=I(c,145)):u=5+I(c,159);else u=I(c,d[h+4])?3+I(c,d[h+5]):2;s=l[2]}else u=1,s=l[1];l=o+ia[a],0>(c=e).b&&E(c);var h,d=c.b,f=(h=c.Ca>>1)-(c.I>>d)>>31;--c.b,c.Ca+=f,c.Ca|=1,c.I-=(h+1&f)<<d,i[l]=((u^f)-f)*r[(0<a)+0]}return 16}function Qe(e){var t=e.rb[e.sb-1];t.la=0,t.Na=0,a(e.zc,0,0,e.zc.length),e.ja=0}function Ze(e,n){if(null==e)return 0;if(null==n)return Xe(e,2,"NULL VP8Io parameter in VP8Decode().");if(!e.cb&&!$e(e,n))return 0;if(t(e.cb),null==n.ac||n.ac(n)){n.ob&&(e.L=0);var s=Ba[e.L];if(2==e.L?(e.yb=0,e.zb=0):(e.yb=n.v-s>>4,e.zb=n.j-s>>4,0>e.yb&&(e.yb=0),0>e.zb&&(e.zb=0)),e.Va=n.o+15+s>>4,e.Hb=n.va+15+s>>4,e.Hb>e.za&&(e.Hb=e.za),e.Va>e.Ub&&(e.Va=e.Ub),0<e.L){var l=e.ed;for(s=0;4>s;++s){var c;if(e.Qa.Cb){var u=e.Qa.Lb[s];e.Qa.Fb||(u+=l.Tb)}else u=l.Tb;for(c=0;1>=c;++c){var h=e.gd[s][c],d=u;if(l.Pc&&(d+=l.vd[0],c&&(d+=l.od[0])),0<(d=0>d?0:63<d?63:d)){var f=d;0<l.wb&&(f=4<l.wb?f>>2:f>>1)>9-l.wb&&(f=9-l.wb),1>f&&(f=1),h.dd=f,h.tc=2*d+f,h.ld=40<=d?2:15<=d?1:0}else h.tc=0;h.La=c}}}s=0}else Xe(e,6,"Frame setup failed"),s=e.a;if(s=0==s){if(s){e.$c=0,0<e.Aa||(e.Ic=Wa);e:{s=e.Ic,l=4*(f=e.za);var p=32*f,g=f+1,m=0<e.L?f*(0<e.Aa?2:1):0,v=(2==e.Aa?2:1)*f;if((h=l+832+(c=3*(16*s+Ba[e.L])/2*p)+(u=null!=e.Fa&&0<e.Fa.length?e.Kc.c*e.Kc.i:0))!=h)s=0;else{if(h>e.Vb){if(e.Vb=0,e.Ec=i(h),e.Fc=0,null==e.Ec){s=Xe(e,1,"no memory during frame initialization.");break e}e.Vb=h}h=e.Ec,d=e.Fc,e.Ac=h,e.Bc=d,d+=l,e.Gd=o(p,Ve),e.Hd=0,e.rb=o(g+1,Be),e.sb=1,e.wa=m?o(m,je):null,e.Y=0,e.D.Nb=0,e.D.wa=e.wa,e.D.Y=e.Y,0<e.Aa&&(e.D.Y+=f),t(!0),e.oc=h,e.pc=d,d+=832,e.ya=o(v,We),e.aa=0,e.D.ya=e.ya,e.D.aa=e.aa,2==e.Aa&&(e.D.aa+=f),e.R=16*f,e.B=8*f,f=(p=Ba[e.L])*e.R,p=p/2*e.B,e.sa=h,e.ta=d+f,e.qa=e.sa,e.ra=e.ta+16*s*e.R+p,e.Ha=e.qa,e.Ia=e.ra+8*s*e.B+p,e.$c=0,d+=c,e.mb=u?h:null,e.nb=u?d:null,t(d+u<=e.Fc+e.Vb),Qe(e),a(e.Ac,e.Bc,0,l),s=1}}if(s){if(n.ka=0,n.y=e.sa,n.O=e.ta,n.f=e.qa,n.N=e.ra,n.ea=e.Ha,n.Vd=e.Ia,n.fa=e.R,n.Rc=e.B,n.F=null,n.J=0,!Rr){for(s=-255;255>=s;++s)_r[255+s]=0>s?-s:s;for(s=-1020;1020>=s;++s)Ir[1020+s]=-128>s?-128:127<s?127:s;for(s=-112;112>=s;++s)Tr[112+s]=-16>s?-16:15<s?15:s;for(s=-255;510>=s;++s)Ar[255+s]=0>s?0:255<s?255:s;Rr=1}ir=ct,or=it,lr=ot,cr=st,ur=lt,sr=at,hr=Xt,dr=Yt,fr=Qt,pr=Zt,gr=$t,mr=Jt,vr=en,br=tn,xr=Ut,yr=Vt,wr=Ht,kr=Gt,da[0]=St,da[1]=ht,da[2]=kt,da[3]=Nt,da[4]=Ct,da[5]=_t,da[6]=Et,da[7]=It,da[8]=At,da[9]=Tt,ha[0]=vt,ha[1]=ft,ha[2]=pt,ha[3]=gt,ha[4]=bt,ha[5]=xt,ha[6]=yt,fa[0]=Ot,fa[1]=dt,fa[2]=Rt,fa[3]=Dt,fa[4]=Pt,fa[5]=Lt,fa[6]=Mt,s=1}else s=0}s&&(s=function(e,n){for(e.M=0;e.M<e.Va;++e.M){var o,s=e.Jc[e.M&e.Xb],l=e.m,c=e;for(o=0;o<c.za;++o){var u=l,h=c,d=h.Ac,f=h.Bc+4*o,p=h.zc,g=h.ya[h.aa+o];if(h.Qa.Bb?g.$b=I(u,h.Pa.jb[0])?2+I(u,h.Pa.jb[2]):I(u,h.Pa.jb[1]):g.$b=0,h.kc&&(g.Ad=I(u,h.Bd)),g.Za=!I(u,145)+0,g.Za){var m=g.Ob,v=0;for(h=0;4>h;++h){var b,x=p[0+h];for(b=0;4>b;++b){x=la[d[f+b]][x];for(var y=oa[I(u,x[0])];0<y;)y=oa[2*y+I(u,x[y])];x=-y,d[f+b]=x}r(m,v,d,f,4),v+=4,p[0+h]=x}}else x=I(u,156)?I(u,128)?1:3:I(u,163)?2:0,g.Ob[0]=x,a(d,f,x,4),a(p,0,x,4);g.Dd=I(u,142)?I(u,114)?I(u,183)?1:3:2:0}if(c.m.Ka)return Xe(e,7,"Premature end-of-partition0 encountered.");for(;e.ja<e.za;++e.ja){if(c=s,u=(l=e).rb[l.sb-1],d=l.rb[l.sb+l.ja],o=l.ya[l.aa+l.ja],f=l.kc?o.Ad:0)u.la=d.la=0,o.Za||(u.Na=d.Na=0),o.Hc=0,o.Gc=0,o.ia=0;else{var w,k;if(u=d,d=c,f=l.Pa.Xc,p=l.ya[l.aa+l.ja],g=l.pb[p.$b],h=p.ad,m=0,v=l.rb[l.sb-1],x=b=0,a(h,m,0,384),p.Za)var N=0,S=f[3];else{y=i(16);var C=u.Na+v.Na;if(C=ra(d,f[1],C,g.Eb,0,y,0),u.Na=v.Na=(0<C)+0,1<C)ir(y,0,h,m);else{var E=y[0]+3>>3;for(y=0;256>y;y+=16)h[m+y]=E}N=1,S=f[0]}var _=15&u.la,T=15&v.la;for(y=0;4>y;++y){var A=1&T;for(E=k=0;4>E;++E)_=_>>1|(A=(C=ra(d,S,C=A+(1&_),g.Sc,N,h,m))>N)<<7,k=k<<2|(3<C?3:1<C?2:0!=h[m+0]),m+=16;_>>=4,T=T>>1|A<<7,b=(b<<8|k)>>>0}for(S=_,N=T>>4,w=0;4>w;w+=2){for(k=0,_=u.la>>4+w,T=v.la>>4+w,y=0;2>y;++y){for(A=1&T,E=0;2>E;++E)C=A+(1&_),_=_>>1|(A=0<(C=ra(d,f[2],C,g.Qc,0,h,m)))<<3,k=k<<2|(3<C?3:1<C?2:0!=h[m+0]),m+=16;_>>=2,T=T>>1|A<<5}x|=k<<4*w,S|=_<<4<<w,N|=(240&T)<<w}u.la=S,v.la=N,p.Hc=b,p.Gc=x,p.ia=43690&x?0:g.ia,f=!(b|x)}if(0<l.L&&(l.wa[l.Y+l.ja]=l.gd[o.$b][o.Za],l.wa[l.Y+l.ja].La|=!f),c.Ka)return Xe(e,7,"Premature end-of-file encountered.")}if(Qe(e),l=n,c=1,o=(s=e).D,u=0<s.L&&s.M>=s.zb&&s.M<=s.Va,0==s.Aa)e:{if(o.M=s.M,o.uc=u,On(s,o),c=1,o=(k=s.D).Nb,u=(x=Ba[s.L])*s.R,d=x/2*s.B,y=16*o*s.R,E=8*o*s.B,f=s.sa,p=s.ta-u+y,g=s.qa,h=s.ra-d+E,m=s.Ha,v=s.Ia-d+E,T=0==(_=k.M),b=_>=s.Va-1,2==s.Aa&&On(s,k),k.uc)for(A=(C=s).D.M,t(C.D.uc),k=C.yb;k<C.Hb;++k){N=k,S=A;var R=(D=(W=C).D).Nb;w=W.R;var D=D.wa[D.Y+N],F=W.sa,O=W.ta+16*R*w+16*N,L=D.dd,P=D.tc;if(0!=P)if(t(3<=P),1==W.L)0<N&&yr(F,O,w,P+4),D.La&&kr(F,O,w,P),0<S&&xr(F,O,w,P+4),D.La&&wr(F,O,w,P);else{var M=W.B,j=W.qa,B=W.ra+8*R*M+8*N,z=W.Ha,W=W.Ia+8*R*M+8*N;R=D.ld,0<N&&(dr(F,O,w,P+4,L,R),pr(j,B,z,W,M,P+4,L,R)),D.La&&(mr(F,O,w,P,L,R),br(j,B,z,W,M,P,L,R)),0<S&&(hr(F,O,w,P+4,L,R),fr(j,B,z,W,M,P+4,L,R)),D.La&&(gr(F,O,w,P,L,R),vr(j,B,z,W,M,P,L,R))}}if(s.ia&&alert("todo:DitherRow"),null!=l.put){if(k=16*_,_=16*(_+1),T?(l.y=s.sa,l.O=s.ta+y,l.f=s.qa,l.N=s.ra+E,l.ea=s.Ha,l.W=s.Ia+E):(k-=x,l.y=f,l.O=p,l.f=g,l.N=h,l.ea=m,l.W=v),b||(_-=x),_>l.o&&(_=l.o),l.F=null,l.J=null,null!=s.Fa&&0<s.Fa.length&&k<_&&(l.J=dn(s,l,k,_-k),l.F=s.mb,null==l.F&&0==l.F.length)){c=Xe(s,3,"Could not decode alpha data.");break e}k<l.j&&(x=l.j-k,k=l.j,t(!(1&x)),l.O+=s.R*x,l.N+=s.B*(x>>1),l.W+=s.B*(x>>1),null!=l.F&&(l.J+=l.width*x)),k<_&&(l.O+=l.v,l.N+=l.v>>1,l.W+=l.v>>1,null!=l.F&&(l.J+=l.v),l.ka=k-l.j,l.U=l.va-l.v,l.T=_-k,c=l.put(l))}o+1!=s.Ic||b||(r(s.sa,s.ta-u,f,p+16*s.R,u),r(s.qa,s.ra-d,g,h+8*s.B,d),r(s.Ha,s.Ia-d,m,v+8*s.B,d))}if(!c)return Xe(e,6,"Output aborted.")}return 1}(e,n)),null!=n.bc&&n.bc(n),s&=1}return s?(e.cb=0,s):0}function et(e,t,n,r,a){a=e[t+n+32*r]+(a>>3),e[t+n+32*r]=-256&a?0>a?0:255:a}function tt(e,t,n,r,a,i){et(e,t,0,n,r+a),et(e,t,1,n,r+i),et(e,t,2,n,r-i),et(e,t,3,n,r-a)}function nt(e){return(20091*e>>16)+e}function rt(e,t,n,r){var a,o=0,s=i(16);for(a=0;4>a;++a){var l=e[t+0]+e[t+8],c=e[t+0]-e[t+8],u=(35468*e[t+4]>>16)-nt(e[t+12]),h=nt(e[t+4])+(35468*e[t+12]>>16);s[o+0]=l+h,s[o+1]=c+u,s[o+2]=c-u,s[o+3]=l-h,o+=4,t++}for(a=o=0;4>a;++a)l=(e=s[o+0]+4)+s[o+8],c=e-s[o+8],u=(35468*s[o+4]>>16)-nt(s[o+12]),et(n,r,0,0,l+(h=nt(s[o+4])+(35468*s[o+12]>>16))),et(n,r,1,0,c+u),et(n,r,2,0,c-u),et(n,r,3,0,l-h),o++,r+=32}function at(e,t,n,r){var a=e[t+0]+4,i=35468*e[t+4]>>16,o=nt(e[t+4]),s=35468*e[t+1]>>16;tt(n,r,0,a+o,e=nt(e[t+1]),s),tt(n,r,1,a+i,e,s),tt(n,r,2,a-i,e,s),tt(n,r,3,a-o,e,s)}function it(e,t,n,r,a){rt(e,t,n,r),a&&rt(e,t+16,n,r+4)}function ot(e,t,n,r){or(e,t+0,n,r,1),or(e,t+32,n,r+128,1)}function st(e,t,n,r){var a;for(e=e[t+0]+4,a=0;4>a;++a)for(t=0;4>t;++t)et(n,r,t,a,e)}function lt(e,t,n,r){e[t+0]&&cr(e,t+0,n,r),e[t+16]&&cr(e,t+16,n,r+4),e[t+32]&&cr(e,t+32,n,r+128),e[t+48]&&cr(e,t+48,n,r+128+4)}function ct(e,t,n,r){var a,o=i(16);for(a=0;4>a;++a){var s=e[t+0+a]+e[t+12+a],l=e[t+4+a]+e[t+8+a],c=e[t+4+a]-e[t+8+a],u=e[t+0+a]-e[t+12+a];o[0+a]=s+l,o[8+a]=s-l,o[4+a]=u+c,o[12+a]=u-c}for(a=0;4>a;++a)s=(e=o[0+4*a]+3)+o[3+4*a],l=o[1+4*a]+o[2+4*a],c=o[1+4*a]-o[2+4*a],u=e-o[3+4*a],n[r+0]=s+l>>3,n[r+16]=u+c>>3,n[r+32]=s-l>>3,n[r+48]=u-c>>3,r+=64}function ut(e,t,n){var r,a=t-32,i=Or,o=255-e[a-1];for(r=0;r<n;++r){var s,l=i,c=o+e[t-1];for(s=0;s<n;++s)e[t+s]=l[c+e[a+s]];t+=32}}function ht(e,t){ut(e,t,4)}function dt(e,t){ut(e,t,8)}function ft(e,t){ut(e,t,16)}function pt(e,t){var n;for(n=0;16>n;++n)r(e,t+32*n,e,t-32,16)}function gt(e,t){var n;for(n=16;0<n;--n)a(e,t,e[t-1],16),t+=32}function mt(e,t,n){var r;for(r=0;16>r;++r)a(t,n+32*r,e,16)}function vt(e,t){var n,r=16;for(n=0;16>n;++n)r+=e[t-1+32*n]+e[t+n-32];mt(r>>5,e,t)}function bt(e,t){var n,r=8;for(n=0;16>n;++n)r+=e[t-1+32*n];mt(r>>4,e,t)}function xt(e,t){var n,r=8;for(n=0;16>n;++n)r+=e[t+n-32];mt(r>>4,e,t)}function yt(e,t){mt(128,e,t)}function wt(e,t,n){return e+2*t+n+2>>2}function kt(e,t){var n,a=t-32;for(a=new Uint8Array([wt(e[a-1],e[a+0],e[a+1]),wt(e[a+0],e[a+1],e[a+2]),wt(e[a+1],e[a+2],e[a+3]),wt(e[a+2],e[a+3],e[a+4])]),n=0;4>n;++n)r(e,t+32*n,a,0,a.length)}function Nt(e,t){var n=e[t-1],r=e[t-1+32],a=e[t-1+64],i=e[t-1+96];T(e,t+0,16843009*wt(e[t-1-32],n,r)),T(e,t+32,16843009*wt(n,r,a)),T(e,t+64,16843009*wt(r,a,i)),T(e,t+96,16843009*wt(a,i,i))}function St(e,t){var n,r=4;for(n=0;4>n;++n)r+=e[t+n-32]+e[t-1+32*n];for(r>>=3,n=0;4>n;++n)a(e,t+32*n,r,4)}function Ct(e,t){var n=e[t-1+0],r=e[t-1+32],a=e[t-1+64],i=e[t-1-32],o=e[t+0-32],s=e[t+1-32],l=e[t+2-32],c=e[t+3-32];e[t+0+96]=wt(r,a,e[t-1+96]),e[t+1+96]=e[t+0+64]=wt(n,r,a),e[t+2+96]=e[t+1+64]=e[t+0+32]=wt(i,n,r),e[t+3+96]=e[t+2+64]=e[t+1+32]=e[t+0+0]=wt(o,i,n),e[t+3+64]=e[t+2+32]=e[t+1+0]=wt(s,o,i),e[t+3+32]=e[t+2+0]=wt(l,s,o),e[t+3+0]=wt(c,l,s)}function Et(e,t){var n=e[t+1-32],r=e[t+2-32],a=e[t+3-32],i=e[t+4-32],o=e[t+5-32],s=e[t+6-32],l=e[t+7-32];e[t+0+0]=wt(e[t+0-32],n,r),e[t+1+0]=e[t+0+32]=wt(n,r,a),e[t+2+0]=e[t+1+32]=e[t+0+64]=wt(r,a,i),e[t+3+0]=e[t+2+32]=e[t+1+64]=e[t+0+96]=wt(a,i,o),e[t+3+32]=e[t+2+64]=e[t+1+96]=wt(i,o,s),e[t+3+64]=e[t+2+96]=wt(o,s,l),e[t+3+96]=wt(s,l,l)}function _t(e,t){var n=e[t-1+0],r=e[t-1+32],a=e[t-1+64],i=e[t-1-32],o=e[t+0-32],s=e[t+1-32],l=e[t+2-32],c=e[t+3-32];e[t+0+0]=e[t+1+64]=i+o+1>>1,e[t+1+0]=e[t+2+64]=o+s+1>>1,e[t+2+0]=e[t+3+64]=s+l+1>>1,e[t+3+0]=l+c+1>>1,e[t+0+96]=wt(a,r,n),e[t+0+64]=wt(r,n,i),e[t+0+32]=e[t+1+96]=wt(n,i,o),e[t+1+32]=e[t+2+96]=wt(i,o,s),e[t+2+32]=e[t+3+96]=wt(o,s,l),e[t+3+32]=wt(s,l,c)}function It(e,t){var n=e[t+0-32],r=e[t+1-32],a=e[t+2-32],i=e[t+3-32],o=e[t+4-32],s=e[t+5-32],l=e[t+6-32],c=e[t+7-32];e[t+0+0]=n+r+1>>1,e[t+1+0]=e[t+0+64]=r+a+1>>1,e[t+2+0]=e[t+1+64]=a+i+1>>1,e[t+3+0]=e[t+2+64]=i+o+1>>1,e[t+0+32]=wt(n,r,a),e[t+1+32]=e[t+0+96]=wt(r,a,i),e[t+2+32]=e[t+1+96]=wt(a,i,o),e[t+3+32]=e[t+2+96]=wt(i,o,s),e[t+3+64]=wt(o,s,l),e[t+3+96]=wt(s,l,c)}function Tt(e,t){var n=e[t-1+0],r=e[t-1+32],a=e[t-1+64],i=e[t-1+96];e[t+0+0]=n+r+1>>1,e[t+2+0]=e[t+0+32]=r+a+1>>1,e[t+2+32]=e[t+0+64]=a+i+1>>1,e[t+1+0]=wt(n,r,a),e[t+3+0]=e[t+1+32]=wt(r,a,i),e[t+3+32]=e[t+1+64]=wt(a,i,i),e[t+3+64]=e[t+2+64]=e[t+0+96]=e[t+1+96]=e[t+2+96]=e[t+3+96]=i}function At(e,t){var n=e[t-1+0],r=e[t-1+32],a=e[t-1+64],i=e[t-1+96],o=e[t-1-32],s=e[t+0-32],l=e[t+1-32],c=e[t+2-32];e[t+0+0]=e[t+2+32]=n+o+1>>1,e[t+0+32]=e[t+2+64]=r+n+1>>1,e[t+0+64]=e[t+2+96]=a+r+1>>1,e[t+0+96]=i+a+1>>1,e[t+3+0]=wt(s,l,c),e[t+2+0]=wt(o,s,l),e[t+1+0]=e[t+3+32]=wt(n,o,s),e[t+1+32]=e[t+3+64]=wt(r,n,o),e[t+1+64]=e[t+3+96]=wt(a,r,n),e[t+1+96]=wt(i,a,r)}function Rt(e,t){var n;for(n=0;8>n;++n)r(e,t+32*n,e,t-32,8)}function Dt(e,t){var n;for(n=0;8>n;++n)a(e,t,e[t-1],8),t+=32}function Ft(e,t,n){var r;for(r=0;8>r;++r)a(t,n+32*r,e,8)}function Ot(e,t){var n,r=8;for(n=0;8>n;++n)r+=e[t+n-32]+e[t-1+32*n];Ft(r>>4,e,t)}function Lt(e,t){var n,r=4;for(n=0;8>n;++n)r+=e[t+n-32];Ft(r>>3,e,t)}function Pt(e,t){var n,r=4;for(n=0;8>n;++n)r+=e[t-1+32*n];Ft(r>>3,e,t)}function Mt(e,t){Ft(128,e,t)}function jt(e,t,n){var r=e[t-n],a=e[t+0],i=3*(a-r)+Dr[1020+e[t-2*n]-e[t+n]],o=Fr[112+(i+4>>3)];e[t-n]=Or[255+r+Fr[112+(i+3>>3)]],e[t+0]=Or[255+a-o]}function Bt(e,t,n,r){var a=e[t+0],i=e[t+n];return Lr[255+e[t-2*n]-e[t-n]]>r||Lr[255+i-a]>r}function zt(e,t,n,r){return 4*Lr[255+e[t-n]-e[t+0]]+Lr[255+e[t-2*n]-e[t+n]]<=r}function Wt(e,t,n,r,a){var i=e[t-3*n],o=e[t-2*n],s=e[t-n],l=e[t+0],c=e[t+n],u=e[t+2*n],h=e[t+3*n];return 4*Lr[255+s-l]+Lr[255+o-c]>r?0:Lr[255+e[t-4*n]-i]<=a&&Lr[255+i-o]<=a&&Lr[255+o-s]<=a&&Lr[255+h-u]<=a&&Lr[255+u-c]<=a&&Lr[255+c-l]<=a}function Ut(e,t,n,r){var a=2*r+1;for(r=0;16>r;++r)zt(e,t+r,n,a)&&jt(e,t+r,n)}function Vt(e,t,n,r){var a=2*r+1;for(r=0;16>r;++r)zt(e,t+r*n,1,a)&&jt(e,t+r*n,1)}function Ht(e,t,n,r){var a;for(a=3;0<a;--a)Ut(e,t+=4*n,n,r)}function Gt(e,t,n,r){var a;for(a=3;0<a;--a)Vt(e,t+=4,n,r)}function qt(e,t,n,r,a,i,o,s){for(i=2*i+1;0<a--;){if(Wt(e,t,n,i,o))if(Bt(e,t,n,s))jt(e,t,n);else{var l=e,c=t,u=n,h=l[c-2*u],d=l[c-u],f=l[c+0],p=l[c+u],g=l[c+2*u],m=27*(b=Dr[1020+3*(f-d)+Dr[1020+h-p]])+63>>7,v=18*b+63>>7,b=9*b+63>>7;l[c-3*u]=Or[255+l[c-3*u]+b],l[c-2*u]=Or[255+h+v],l[c-u]=Or[255+d+m],l[c+0]=Or[255+f-m],l[c+u]=Or[255+p-v],l[c+2*u]=Or[255+g-b]}t+=r}}function Kt(e,t,n,r,a,i,o,s){for(i=2*i+1;0<a--;){if(Wt(e,t,n,i,o))if(Bt(e,t,n,s))jt(e,t,n);else{var l=e,c=t,u=n,h=l[c-u],d=l[c+0],f=l[c+u],p=Fr[112+(4+(g=3*(d-h))>>3)],g=Fr[112+(g+3>>3)],m=p+1>>1;l[c-2*u]=Or[255+l[c-2*u]+m],l[c-u]=Or[255+h+g],l[c+0]=Or[255+d-p],l[c+u]=Or[255+f-m]}t+=r}}function Xt(e,t,n,r,a,i){qt(e,t,n,1,16,r,a,i)}function Yt(e,t,n,r,a,i){qt(e,t,1,n,16,r,a,i)}function $t(e,t,n,r,a,i){var o;for(o=3;0<o;--o)Kt(e,t+=4*n,n,1,16,r,a,i)}function Jt(e,t,n,r,a,i){var o;for(o=3;0<o;--o)Kt(e,t+=4,1,n,16,r,a,i)}function Qt(e,t,n,r,a,i,o,s){qt(e,t,a,1,8,i,o,s),qt(n,r,a,1,8,i,o,s)}function Zt(e,t,n,r,a,i,o,s){qt(e,t,1,a,8,i,o,s),qt(n,r,1,a,8,i,o,s)}function en(e,t,n,r,a,i,o,s){Kt(e,t+4*a,a,1,8,i,o,s),Kt(n,r+4*a,a,1,8,i,o,s)}function tn(e,t,n,r,a,i,o,s){Kt(e,t+4,1,a,8,i,o,s),Kt(n,r+4,1,a,8,i,o,s)}function nn(){this.ba=new oe,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new le,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function rn(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function an(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function on(){this.ua=0,this.Wa=new L,this.vb=new L,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new f,this.yc=new h}function sn(){this.xb=this.a=0,this.l=new qe,this.ca=new oe,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new w,this.Pb=0,this.wd=new w,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new on,this.ab=0,this.gc=o(4,an),this.Oc=0}function ln(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new qe,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function cn(e,t,n,r,a,i,o){for(e=null==e?0:e[t+0],t=0;t<o;++t)a[i+t]=e+n[r+t]&255,e=a[i+t]}function un(e,t,n,r,a,i,o){var s;if(null==e)cn(null,null,n,r,a,i,o);else for(s=0;s<o;++s)a[i+s]=e[t+s]+n[r+s]&255}function hn(e,t,n,r,a,i,o){if(null==e)cn(null,null,n,r,a,i,o);else{var s,l=e[t+0],c=l,u=l;for(s=0;s<o;++s)c=u+(l=e[t+s])-c,u=n[r+s]+(-256&c?0>c?0:255:c)&255,c=l,a[i+s]=u}}function dn(e,n,a,o){var s=n.width,l=n.o;if(t(null!=e&&null!=n),0>a||0>=o||a+o>l)return null;if(!e.Cc){if(null==e.ga){var c;if(e.ga=new ln,(c=null==e.ga)||(c=n.width*n.o,t(0==e.Gb.length),e.Gb=i(c),e.Uc=0,null==e.Gb?c=0:(e.mb=e.Gb,e.nb=e.Uc,e.rc=null,c=1),c=!c),!c){c=e.ga;var u=e.Fa,h=e.P,d=e.qc,f=e.mb,p=e.nb,g=h+1,m=d-1,b=c.l;if(t(null!=u&&null!=f&&null!=n),ma[0]=null,ma[1]=cn,ma[2]=un,ma[3]=hn,c.ca=f,c.tb=p,c.c=n.width,c.i=n.height,t(0<c.c&&0<c.i),1>=d)n=0;else if(c.$a=3&u[h+0],c.Z=u[h+0]>>2&3,c.Lc=u[h+0]>>4&3,h=u[h+0]>>6&3,0>c.$a||1<c.$a||4<=c.Z||1<c.Lc||h)n=0;else if(b.put=fe,b.ac=de,b.bc=pe,b.ma=c,b.width=n.width,b.height=n.height,b.Da=n.Da,b.v=n.v,b.va=n.va,b.j=n.j,b.o=n.o,c.$a)e:{t(1==c.$a),n=Ie();t:for(;;){if(null==n){n=0;break e}if(t(null!=c),c.mc=n,n.c=c.c,n.i=c.i,n.l=c.l,n.l.ma=c,n.l.width=c.c,n.l.height=c.i,n.a=0,v(n.m,u,g,m),!Te(c.c,c.i,1,n,null))break t;if(1==n.ab&&3==n.gc[0].hc&&Ne(n.s)?(c.ic=1,u=n.c*n.i,n.Ta=null,n.Ua=0,n.V=i(u),n.Ba=0,null==n.V?(n.a=1,n=0):n=1):(c.ic=0,n=Ae(n,c.c)),!n)break t;n=1;break e}c.mc=null,n=0}else n=m>=c.c*c.i;c=!n}if(c)return null;1!=e.ga.Lc?e.Ga=0:o=l-a}t(null!=e.ga),t(a+o<=l);e:{if(n=(u=e.ga).c,l=u.l.o,0==u.$a){if(g=e.rc,m=e.Vc,b=e.Fa,h=e.P+1+a*n,d=e.mb,f=e.nb+a*n,t(h<=e.P+e.qc),0!=u.Z)for(t(null!=ma[u.Z]),c=0;c<o;++c)ma[u.Z](g,m,b,h,d,f,n),g=d,m=f,f+=n,h+=n;else for(c=0;c<o;++c)r(d,f,b,h,n),g=d,m=f,f+=n,h+=n;e.rc=g,e.Vc=m}else{if(t(null!=u.mc),n=a+o,t(null!=(c=u.mc)),t(n<=c.i),c.C>=n)n=1;else if(u.ic||vn(),u.ic){u=c.V,g=c.Ba,m=c.c;var x=c.i,y=(b=1,h=c.$/m,d=c.$%m,f=c.m,p=c.s,c.$),w=m*x,k=m*n,S=p.wc,E=y<k?ye(p,d,h):null;t(y<=w),t(n<=x),t(Ne(p));t:for(;;){for(;!f.h&&y<k;){if(d&S||(E=ye(p,d,h)),t(null!=E),C(f),256>(x=be(E.G[0],E.H[0],f)))u[g+y]=x,++y,++d>=m&&(d=0,++h<=n&&!(h%16)&&Ce(c,h));else{if(!(280>x)){b=0;break t}x=me(x-256,f);var _,I=be(E.G[4],E.H[4],f);if(C(f),!(y>=(I=ve(m,I=me(I,f)))&&w-y>=x)){b=0;break t}for(_=0;_<x;++_)u[g+y+_]=u[g+y+_-I];for(y+=x,d+=x;d>=m;)d-=m,++h<=n&&!(h%16)&&Ce(c,h);y<k&&d&S&&(E=ye(p,d,h))}t(f.h==N(f))}Ce(c,h>n?n:h);break t}!b||f.h&&y<w?(b=0,c.a=f.h?5:3):c.$=y,n=b}else n=Ee(c,c.V,c.Ba,c.c,c.i,n,Re);if(!n){o=0;break e}}a+o>=l&&(e.Cc=1),o=1}if(!o)return null;if(e.Cc&&(null!=(o=e.ga)&&(o.mc=null),e.ga=null,0<e.Ga))return alert("todo:WebPDequantizeLevels"),null}return e.nb+a*s}function fn(e,t,n,r,a,i){for(;0<a--;){var o,s=e,l=t+(n?1:0),c=e,u=t+(n?0:3);for(o=0;o<r;++o){var h=c[u+4*o];255!=h&&(h*=32897,s[l+4*o+0]=s[l+4*o+0]*h>>23,s[l+4*o+1]=s[l+4*o+1]*h>>23,s[l+4*o+2]=s[l+4*o+2]*h>>23)}t+=i}}function pn(e,t,n,r,a){for(;0<r--;){var i;for(i=0;i<n;++i){var o=e[t+2*i+0],s=15&(c=e[t+2*i+1]),l=4369*s,c=(240&c|c>>4)*l>>16;e[t+2*i+0]=(240&o|o>>4)*l>>16&240|(15&o|o<<4)*l>>16>>4&15,e[t+2*i+1]=240&c|s}t+=a}}function gn(e,t,n,r,a,i,o,s){var l,c,u=255;for(c=0;c<a;++c){for(l=0;l<r;++l){var h=e[t+l];i[o+4*l]=h,u&=h}t+=n,o+=s}return 255!=u}function mn(e,t,n,r,a){var i;for(i=0;i<a;++i)n[r+i]=e[t+i]>>8}function vn(){Nr=fn,Sr=pn,Cr=gn,Er=mn}function bn(n,r,a){e[n]=function(e,n,i,o,s,l,c,u,h,d,f,p,g,m,v,b,x){var y,w=x-1>>1,k=s[l+0]|c[u+0]<<16,N=h[d+0]|f[p+0]<<16;t(null!=e);var S=3*k+N+131074>>2;for(r(e[n+0],255&S,S>>16,g,m),null!=i&&(S=3*N+k+131074>>2,r(i[o+0],255&S,S>>16,v,b)),y=1;y<=w;++y){var C=s[l+y]|c[u+y]<<16,E=h[d+y]|f[p+y]<<16,_=k+C+N+E+524296,I=_+2*(C+N)>>3;S=I+k>>1,k=(_=_+2*(k+E)>>3)+C>>1,r(e[n+2*y-1],255&S,S>>16,g,m+(2*y-1)*a),r(e[n+2*y-0],255&k,k>>16,g,m+(2*y-0)*a),null!=i&&(S=_+N>>1,k=I+E>>1,r(i[o+2*y-1],255&S,S>>16,v,b+(2*y-1)*a),r(i[o+2*y+0],255&k,k>>16,v,b+(2*y+0)*a)),k=C,N=E}1&x||(S=3*k+N+131074>>2,r(e[n+x-1],255&S,S>>16,g,m+(x-1)*a),null!=i&&(S=3*N+k+131074>>2,r(i[o+x-1],255&S,S>>16,v,b+(x-1)*a)))}}function xn(){va[Pr]=ba,va[Mr]=ya,va[jr]=xa,va[Br]=wa,va[zr]=ka,va[Wr]=Na,va[Ur]=Sa,va[Vr]=ya,va[Hr]=wa,va[Gr]=ka,va[qr]=Na}function yn(e){return e&~Aa?0>e?0:255:e>>Ta}function wn(e,t){return yn((19077*e>>8)+(26149*t>>8)-14234)}function kn(e,t,n){return yn((19077*e>>8)-(6419*t>>8)-(13320*n>>8)+8708)}function Nn(e,t){return yn((19077*e>>8)+(33050*t>>8)-17685)}function Sn(e,t,n,r,a){r[a+0]=wn(e,n),r[a+1]=kn(e,t,n),r[a+2]=Nn(e,t)}function Cn(e,t,n,r,a){r[a+0]=Nn(e,t),r[a+1]=kn(e,t,n),r[a+2]=wn(e,n)}function En(e,t,n,r,a){var i=kn(e,t,n);t=i<<3&224|Nn(e,t)>>3,r[a+0]=248&wn(e,n)|i>>5,r[a+1]=t}function _n(e,t,n,r,a){var i=240&Nn(e,t)|15;r[a+0]=240&wn(e,n)|kn(e,t,n)>>4,r[a+1]=i}function In(e,t,n,r,a){r[a+0]=255,Sn(e,t,n,r,a+1)}function Tn(e,t,n,r,a){Cn(e,t,n,r,a),r[a+3]=255}function An(e,t,n,r,a){Sn(e,t,n,r,a),r[a+3]=255}function Ge(e,t){return 0>e?0:e>t?t:e}function Rn(t,n,r){e[t]=function(e,t,a,i,o,s,l,c,u){for(var h=c+(-2&u)*r;c!=h;)n(e[t+0],a[i+0],o[s+0],l,c),n(e[t+1],a[i+0],o[s+0],l,c+r),t+=2,++i,++s,c+=2*r;1&u&&n(e[t+0],a[i+0],o[s+0],l,c)}}function Dn(e,t,n){return 0==n?0==e?0==t?6:5:0==t?4:0:n}function Fn(e,t,n,r,a){switch(e>>>30){case 3:or(t,n,r,a,0);break;case 2:sr(t,n,r,a);break;case 1:cr(t,n,r,a)}}function On(e,t){var n,i,o=t.M,s=t.Nb,l=e.oc,c=e.pc+40,u=e.oc,h=e.pc+584,d=e.oc,f=e.pc+600;for(n=0;16>n;++n)l[c+32*n-1]=129;for(n=0;8>n;++n)u[h+32*n-1]=129,d[f+32*n-1]=129;for(0<o?l[c-1-32]=u[h-1-32]=d[f-1-32]=129:(a(l,c-32-1,127,21),a(u,h-32-1,127,9),a(d,f-32-1,127,9)),i=0;i<e.za;++i){var p=t.ya[t.aa+i];if(0<i){for(n=-1;16>n;++n)r(l,c+32*n-4,l,c+32*n+12,4);for(n=-1;8>n;++n)r(u,h+32*n-4,u,h+32*n+4,4),r(d,f+32*n-4,d,f+32*n+4,4)}var g=e.Gd,m=e.Hd+i,v=p.ad,b=p.Hc;if(0<o&&(r(l,c-32,g[m].y,0,16),r(u,h-32,g[m].f,0,8),r(d,f-32,g[m].ea,0,8)),p.Za){var x=l,y=c-32+16;for(0<o&&(i>=e.za-1?a(x,y,g[m].y[15],4):r(x,y,g[m+1].y,0,4)),n=0;4>n;n++)x[y+128+n]=x[y+256+n]=x[y+384+n]=x[y+0+n];for(n=0;16>n;++n,b<<=2)x=l,y=c+ja[n],da[p.Ob[n]](x,y),Fn(b,v,16*+n,x,y)}else if(x=Dn(i,o,p.Ob[0]),ha[x](l,c),0!=b)for(n=0;16>n;++n,b<<=2)Fn(b,v,16*+n,l,c+ja[n]);for(n=p.Gc,x=Dn(i,o,p.Dd),fa[x](u,h),fa[x](d,f),b=v,x=u,y=h,255&(p=n|0)&&(170&p?lr(b,256,x,y):ur(b,256,x,y)),p=d,b=f,255&(n>>=8)&&(170&n?lr(v,320,p,b):ur(v,320,p,b)),o<e.Ub-1&&(r(g[m].y,0,l,c+480,16),r(g[m].f,0,u,h+224,8),r(g[m].ea,0,d,f+224,8)),n=8*s*e.B,g=e.sa,m=e.ta+16*i+16*s*e.R,v=e.qa,p=e.ra+8*i+n,b=e.Ha,x=e.Ia+8*i+n,n=0;16>n;++n)r(g,m+n*e.R,l,c+32*n,16);for(n=0;8>n;++n)r(v,p+n*e.B,u,h+32*n,8),r(b,x+n*e.B,d,f+32*n,8)}}function Ln(e,r,a,i,o,s,l,c,u){var h=[0],d=[0],f=0,p=null!=u?u.kd:0,g=null!=u?u:new rn;if(null==e||12>a)return 7;g.data=e,g.w=r,g.ha=a,r=[r],a=[a],g.gb=[g.gb];e:{var m=r,b=a,x=g.gb;if(t(null!=e),t(null!=b),t(null!=x),x[0]=0,12<=b[0]&&!n(e,m[0],"RIFF")){if(n(e,m[0]+8,"WEBP")){x=3;break e}var y=D(e,m[0]+4);if(12>y||4294967286<y){x=3;break e}if(p&&y>b[0]-8){x=7;break e}x[0]=y,m[0]+=12,b[0]-=12}x=0}if(0!=x)return x;for(y=0<g.gb[0],a=a[0];;){e:{var k=e;b=r,x=a;var N=h,S=d,C=m=[0];if((I=f=[f])[0]=0,8>x[0])x=7;else{if(!n(k,b[0],"VP8X")){if(10!=D(k,b[0]+4)){x=3;break e}if(18>x[0]){x=7;break e}var E=D(k,b[0]+8),_=1+R(k,b[0]+12);if(2147483648<=_*(k=1+R(k,b[0]+15))){x=3;break e}null!=C&&(C[0]=E),null!=N&&(N[0]=_),null!=S&&(S[0]=k),b[0]+=18,x[0]-=18,I[0]=1}x=0}}if(f=f[0],m=m[0],0!=x)return x;if(b=!!(2&m),!y&&f)return 3;if(null!=s&&(s[0]=!!(16&m)),null!=l&&(l[0]=b),null!=c&&(c[0]=0),l=h[0],m=d[0],f&&b&&null==u){x=0;break}if(4>a){x=7;break}if(y&&f||!y&&!f&&!n(e,r[0],"ALPH")){a=[a],g.na=[g.na],g.P=[g.P],g.Sa=[g.Sa];e:{E=e,x=r,y=a;var I=g.gb;N=g.na,S=g.P,C=g.Sa,_=22,t(null!=E),t(null!=y),k=x[0];var T=y[0];for(t(null!=N),t(null!=C),N[0]=null,S[0]=null,C[0]=0;;){if(x[0]=k,y[0]=T,8>T){x=7;break e}var A=D(E,k+4);if(4294967286<A){x=3;break e}var F=8+A+1&-2;if(_+=F,0<I&&_>I){x=3;break e}if(!n(E,k,"VP8 ")||!n(E,k,"VP8L")){x=0;break e}if(T[0]<F){x=7;break e}n(E,k,"ALPH")||(N[0]=E,S[0]=k+8,C[0]=A),k+=F,T-=F}}if(a=a[0],g.na=g.na[0],g.P=g.P[0],g.Sa=g.Sa[0],0!=x)break}a=[a],g.Ja=[g.Ja],g.xa=[g.xa];e:if(I=e,x=r,y=a,N=g.gb[0],S=g.Ja,C=g.xa,E=x[0],k=!n(I,E,"VP8 "),_=!n(I,E,"VP8L"),t(null!=I),t(null!=y),t(null!=S),t(null!=C),8>y[0])x=7;else{if(k||_){if(I=D(I,E+4),12<=N&&I>N-12){x=3;break e}if(p&&I>y[0]-8){x=7;break e}S[0]=I,x[0]+=8,y[0]-=8,C[0]=_}else C[0]=5<=y[0]&&47==I[E+0]&&!(I[E+4]>>5),S[0]=y[0];x=0}if(a=a[0],g.Ja=g.Ja[0],g.xa=g.xa[0],r=r[0],0!=x)break;if(4294967286<g.Ja)return 3;if(null==c||b||(c[0]=g.xa?2:1),l=[l],m=[m],g.xa){if(5>a){x=7;break}c=l,p=m,b=s,null==e||5>a?e=0:5<=a&&47==e[r+0]&&!(e[r+4]>>5)?(y=[0],I=[0],N=[0],v(S=new w,e,r,a),ge(S,y,I,N)?(null!=c&&(c[0]=y[0]),null!=p&&(p[0]=I[0]),null!=b&&(b[0]=N[0]),e=1):e=0):e=0}else{if(10>a){x=7;break}c=m,null==e||10>a||!Ye(e,r+3,a-3)?e=0:(p=e[r+0]|e[r+1]<<8|e[r+2]<<16,b=16383&(e[r+7]<<8|e[r+6]),e=16383&(e[r+9]<<8|e[r+8]),1&p||3<(p>>1&7)||!(p>>4&1)||p>>5>=g.Ja||!b||!e?e=0:(l&&(l[0]=b),c&&(c[0]=e),e=1))}if(!e)return 3;if(l=l[0],m=m[0],f&&(h[0]!=l||d[0]!=m))return 3;null!=u&&(u[0]=g,u.offset=r-u.w,t(4294967286>r-u.w),t(u.offset==u.ha-a));break}return 0==x||7==x&&f&&null==u?(null!=s&&(s[0]|=null!=g.na&&0<g.na.length),null!=i&&(i[0]=l),null!=o&&(o[0]=m),0):x}function Pn(e,t,n){var r=t.width,a=t.height,i=0,o=0,s=r,l=a;if(t.Da=null!=e&&0<e.Da,t.Da&&(s=e.cd,l=e.bd,i=e.v,o=e.j,11>n||(i&=-2,o&=-2),0>i||0>o||0>=s||0>=l||i+s>r||o+l>a))return 0;if(t.v=i,t.j=o,t.va=i+s,t.o=o+l,t.U=s,t.T=l,t.da=null!=e&&0<e.da,t.da){if(!P(s,l,n=[e.ib],i=[e.hb]))return 0;t.ib=n[0],t.hb=i[0]}return t.ob=null!=e&&e.ob,t.Kb=null==e||!e.Sd,t.da&&(t.ob=t.ib<3*r/4&&t.hb<3*a/4,t.Kb=0),1}function Mn(e){if(null==e)return 2;if(11>e.S){var t=e.f.RGBA;t.fb+=(e.height-1)*t.A,t.A=-t.A}else t=e.f.kb,e=e.height,t.O+=(e-1)*t.fa,t.fa=-t.fa,t.N+=(e-1>>1)*t.Ab,t.Ab=-t.Ab,t.W+=(e-1>>1)*t.Db,t.Db=-t.Db,null!=t.F&&(t.J+=(e-1)*t.lb,t.lb=-t.lb);return 0}function jn(e,t,n,r){if(null==r||0>=e||0>=t)return 2;if(null!=n){if(n.Da){var a=n.cd,o=n.bd,s=-2&n.v,l=-2&n.j;if(0>s||0>l||0>=a||0>=o||s+a>e||l+o>t)return 2;e=a,t=o}if(n.da){if(!P(e,t,a=[n.ib],o=[n.hb]))return 2;e=a[0],t=o[0]}}r.width=e,r.height=t;e:{var c=r.width,u=r.height;if(e=r.S,0>=c||0>=u||!(e>=Pr&&13>e))e=2;else{if(0>=r.Rd&&null==r.sd){s=o=a=t=0;var h=(l=c*Ua[e])*u;if(11>e||(o=(u+1)/2*(t=(c+1)/2),12==e&&(s=(a=c)*u)),null==(u=i(h+2*o+s))){e=1;break e}r.sd=u,11>e?((c=r.f.RGBA).eb=u,c.fb=0,c.A=l,c.size=h):((c=r.f.kb).y=u,c.O=0,c.fa=l,c.Fd=h,c.f=u,c.N=0+h,c.Ab=t,c.Cd=o,c.ea=u,c.W=0+h+o,c.Db=t,c.Ed=o,12==e&&(c.F=u,c.J=0+h+2*o),c.Tc=s,c.lb=a)}if(t=1,a=r.S,o=r.width,s=r.height,a>=Pr&&13>a)if(11>a)e=r.f.RGBA,t&=(l=Math.abs(e.A))*(s-1)+o<=e.size,t&=l>=o*Ua[a],t&=null!=e.eb;else{e=r.f.kb,l=(o+1)/2,h=(s+1)/2,c=Math.abs(e.fa),u=Math.abs(e.Ab);var d=Math.abs(e.Db),f=Math.abs(e.lb),p=f*(s-1)+o;t&=c*(s-1)+o<=e.Fd,t&=u*(h-1)+l<=e.Cd,t=(t&=d*(h-1)+l<=e.Ed)&c>=o&u>=l&d>=l,t&=null!=e.y,t&=null!=e.f,t&=null!=e.ea,12==a&&(t&=f>=o,t&=p<=e.Tc,t&=null!=e.F)}else t=0;e=t?0:2}}return 0!=e||null!=n&&n.fd&&(e=Mn(r)),e}var Bn=64,zn=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Wn=24,Un=32,Vn=8,Hn=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];B("Predictor0","PredictorAdd0"),e.Predictor0=function(){return 4278190080},e.Predictor1=function(e){return e},e.Predictor2=function(e,t,n){return t[n+0]},e.Predictor3=function(e,t,n){return t[n+1]},e.Predictor4=function(e,t,n){return t[n-1]},e.Predictor5=function(e,t,n){return W(W(e,t[n+1]),t[n+0])},e.Predictor6=function(e,t,n){return W(e,t[n-1])},e.Predictor7=function(e,t,n){return W(e,t[n+0])},e.Predictor8=function(e,t,n){return W(t[n-1],t[n+0])},e.Predictor9=function(e,t,n){return W(t[n+0],t[n+1])},e.Predictor10=function(e,t,n){return W(W(e,t[n-1]),W(t[n+0],t[n+1]))},e.Predictor11=function(e,t,n){var r=t[n+0];return 0>=H(r>>24&255,e>>24&255,(t=t[n-1])>>24&255)+H(r>>16&255,e>>16&255,t>>16&255)+H(r>>8&255,e>>8&255,t>>8&255)+H(255&r,255&e,255&t)?r:e},e.Predictor12=function(e,t,n){var r=t[n+0];return(U((e>>24&255)+(r>>24&255)-((t=t[n-1])>>24&255))<<24|U((e>>16&255)+(r>>16&255)-(t>>16&255))<<16|U((e>>8&255)+(r>>8&255)-(t>>8&255))<<8|U((255&e)+(255&r)-(255&t)))>>>0},e.Predictor13=function(e,t,n){var r=t[n-1];return(V((e=W(e,t[n+0]))>>24&255,r>>24&255)<<24|V(e>>16&255,r>>16&255)<<16|V(e>>8&255,r>>8&255)<<8|V(255&e,255&r))>>>0};var Gn=e.PredictorAdd0;e.PredictorAdd1=G,B("Predictor2","PredictorAdd2"),B("Predictor3","PredictorAdd3"),B("Predictor4","PredictorAdd4"),B("Predictor5","PredictorAdd5"),B("Predictor6","PredictorAdd6"),B("Predictor7","PredictorAdd7"),B("Predictor8","PredictorAdd8"),B("Predictor9","PredictorAdd9"),B("Predictor10","PredictorAdd10"),B("Predictor11","PredictorAdd11"),B("Predictor12","PredictorAdd12"),B("Predictor13","PredictorAdd13");var qn=e.PredictorAdd2;Y("ColorIndexInverseTransform","MapARGB","32b",function(e){return e>>8&255},function(e){return e}),Y("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(e){return e},function(e){return e>>8&255});var Kn,Xn=e.ColorIndexInverseTransform,Yn=e.MapARGB,$n=e.VP8LColorIndexInverseTransformAlpha,Jn=e.MapAlpha,Qn=e.VP8LPredictorsAdd=[];Qn.length=16,(e.VP8LPredictors=[]).length=16,(e.VP8LPredictorsAdd_C=[]).length=16,(e.VP8LPredictors_C=[]).length=16;var Zn,er,tr,nr,rr,ar,ir,or,sr,lr,cr,ur,hr,dr,fr,pr,gr,mr,vr,br,xr,yr,wr,kr,Nr,Sr,Cr,Er,_r=i(511),Ir=i(2041),Tr=i(225),Ar=i(767),Rr=0,Dr=Ir,Fr=Tr,Or=Ar,Lr=_r,Pr=0,Mr=1,jr=2,Br=3,zr=4,Wr=5,Ur=6,Vr=7,Hr=8,Gr=9,qr=10,Kr=[2,3,7],Xr=[3,3,11],Yr=[280,256,256,256,40],$r=[0,1,1,1,0],Jr=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Qr=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Zr=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],ea=8,ta=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],na=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],ra=null,aa=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],ia=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],oa=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],sa=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],la=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],ca=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],ua=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],ha=[],da=[],fa=[],pa=1,ga=2,ma=[],va=[];bn("UpsampleRgbLinePair",Sn,3),bn("UpsampleBgrLinePair",Cn,3),bn("UpsampleRgbaLinePair",An,4),bn("UpsampleBgraLinePair",Tn,4),bn("UpsampleArgbLinePair",In,4),bn("UpsampleRgba4444LinePair",_n,2),bn("UpsampleRgb565LinePair",En,2);var ba=e.UpsampleRgbLinePair,xa=e.UpsampleBgrLinePair,ya=e.UpsampleRgbaLinePair,wa=e.UpsampleBgraLinePair,ka=e.UpsampleArgbLinePair,Na=e.UpsampleRgba4444LinePair,Sa=e.UpsampleRgb565LinePair,Ca=16,Ea=1<<Ca-1,_a=-227,Ia=482,Ta=6,Aa=(256<<Ta)-1,Ra=0,Da=i(256),Fa=i(256),Oa=i(256),La=i(256),Pa=i(Ia-_a),Ma=i(Ia-_a);Rn("YuvToRgbRow",Sn,3),Rn("YuvToBgrRow",Cn,3),Rn("YuvToRgbaRow",An,4),Rn("YuvToBgraRow",Tn,4),Rn("YuvToArgbRow",In,4),Rn("YuvToRgba4444Row",_n,2),Rn("YuvToRgb565Row",En,2);var ja=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Ba=[0,2,8],za=[8,7,6,4,4,2,2,2,1,1,1,1],Wa=1;this.WebPDecodeRGBA=function(e,n,r,a,i){var o=Mr,s=new nn,l=new oe;s.ba=l,l.S=o,l.width=[l.width],l.height=[l.height];var c=l.width,u=l.height,h=new se;if(null==h||null==e)var d=2;else t(null!=h),d=Ln(e,n,r,h.width,h.height,h.Pd,h.Qd,h.format,null);if(0!=d?c=0:(null!=c&&(c[0]=h.width[0]),null!=u&&(u[0]=h.height[0]),c=1),c){l.width=l.width[0],l.height=l.height[0],null!=a&&(a[0]=l.width),null!=i&&(i[0]=l.height);e:{if(a=new qe,(i=new rn).data=e,i.w=n,i.ha=r,i.kd=1,n=[0],t(null!=i),(0==(e=Ln(i.data,i.w,i.ha,null,null,null,n,null,i))||7==e)&&n[0]&&(e=4),0==(n=e)){if(t(null!=s),a.data=i.data,a.w=i.w+i.offset,a.ha=i.ha-i.offset,a.put=fe,a.ac=de,a.bc=pe,a.ma=s,i.xa){if(null==(e=Ie())){s=1;break e}if(function(e,n){var r=[0],a=[0],i=[0];t:for(;;){if(null==e)return 0;if(null==n)return e.a=2,0;if(e.l=n,e.a=0,v(e.m,n.data,n.w,n.ha),!ge(e.m,r,a,i)){e.a=3;break t}if(e.xb=ga,n.width=r[0],n.height=a[0],!Te(r[0],a[0],1,e,null))break t;return 1}return t(0!=e.a),0}(e,a)){if(a=0==(n=jn(a.width,a.height,s.Oa,s.ba))){t:{a=e;n:for(;;){if(null==a){a=0;break t}if(t(null!=a.s.yc),t(null!=a.s.Ya),t(0<a.s.Wb),t(null!=(r=a.l)),t(null!=(i=r.ma)),0!=a.xb){if(a.ca=i.ba,a.tb=i.tb,t(null!=a.ca),!Pn(i.Oa,r,Br)){a.a=2;break n}if(!Ae(a,r.width))break n;if(r.da)break n;if((r.da||re(a.ca.S))&&vn(),11>a.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),null!=a.ca.f.kb.F&&vn()),a.Pb&&0<a.s.ua&&null==a.s.vb.X&&!F(a.s.vb,a.s.Wa.Xa)){a.a=1;break n}a.xb=0}if(!Ee(a,a.V,a.Ba,a.c,a.i,r.o,ke))break n;i.Dc=a.Ma,a=1;break t}t(0!=a.a),a=0}a=!a}a&&(n=e.a)}else n=e.a}else{if(null==(e=new Ke)){s=1;break e}if(e.Fa=i.na,e.P=i.P,e.qc=i.Sa,$e(e,a)){if(0==(n=jn(a.width,a.height,s.Oa,s.ba))){if(e.Aa=0,r=s.Oa,t(null!=(i=e)),null!=r){if(0<(c=0>(c=r.Md)?0:100<c?255:255*c/100)){for(u=h=0;4>u;++u)12>(d=i.pb[u]).lc&&(d.ia=c*za[0>d.lc?0:d.lc]>>3),h|=d.ia;h&&(alert("todo:VP8InitRandom"),i.ia=1)}i.Ga=r.Id,100<i.Ga?i.Ga=100:0>i.Ga&&(i.Ga=0)}Ze(e,a)||(n=e.a)}}else n=e.a}0==n&&null!=s.Oa&&s.Oa.fd&&(n=Mn(s.ba))}s=n}o=0!=s?null:11>o?l.f.RGBA.eb:l.f.kb.y}else o=null;return o};var Ua=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(e,t){for(var n="",r=0;r<4;r++)n+=String.fromCharCode(e[t++]);return n}function u(e,t){return(e[t+0]|e[t+1]<<8|e[t+2]<<16)>>>0}function h(e,t){return(e[t+0]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}new l;var d=[0],f=[0],p=[],g=new l,m=e,v=function(e,t){var n={},r=0,a=!1,i=0,o=0;if(n.frames=[],!function(e,t){for(var n=0;n<4;n++)if(e[t+n]!="RIFF".charCodeAt(n))return!0;return!1}(e,t)){var s,l;for(h(e,t+=4),t+=8;t<e.length;){var d=c(e,t),f=h(e,t+=4);t+=4;var p=f+(1&f);switch(d){case"VP8 ":case"VP8L":void 0===n.frames[r]&&(n.frames[r]={}),(v=n.frames[r]).src_off=a?o:t-8,v.src_size=i+f+8,r++,a&&(a=!1,i=0,o=0);break;case"VP8X":(v=n.header={}).feature_flags=e[t];var g=t+4;v.canvas_width=1+u(e,g),g+=3,v.canvas_height=1+u(e,g),g+=3;break;case"ALPH":a=!0,i=p+8,o=t-8;break;case"ANIM":(v=n.header).bgcolor=h(e,t),g=t+4,v.loop_count=(s=e)[(l=g)+0]|s[l+1]<<8,g+=2;break;case"ANMF":var m,v;(v=n.frames[r]={}).offset_x=2*u(e,t),t+=3,v.offset_y=2*u(e,t),t+=3,v.width=1+u(e,t),t+=3,v.height=1+u(e,t),t+=3,v.duration=u(e,t),t+=3,m=e[t++],v.dispose=1&m,v.blend=m>>1&1}"ANMF"!=d&&(t+=p)}return n}}(m,0);v.response=m,v.rgbaoutput=!0,v.dataurl=!1;var b=v.header?v.header:null,x=v.frames?v.frames:null;if(b){b.loop_counter=b.loop_count,d=[b.canvas_height],f=[b.canvas_width];for(var y=0;y<x.length&&0!=x[y].blend;y++);}var w=x[0],k=g.WebPDecodeRGBA(m,w.src_off,w.src_size,f,d);w.rgba=k,w.imgwidth=f[0],w.imgheight=d[0];for(var N=0;N<f[0]*d[0]*4;N++)p[N]=k[N];return this.width=f,this.height=d,this.data=p,this}!function(e){var t=function(t,r,l,c){var u=4,h=i;switch(c){case e.image_compression.FAST:u=1,h=a;break;case e.image_compression.MEDIUM:u=6,h=o;break;case e.image_compression.SLOW:u=9,h=s}var d=J(t=n(t,r,l,h),{level:u});return e.__addimage__.arrayBufferToBinaryString(d)},n=function(e,t,n,r){for(var a,i,o,s=e.length/t,l=new Uint8Array(e.length+s),h=c(),d=0;d<s;d+=1){if(o=d*t,a=e.subarray(o,o+t),r)l.set(r(a,n,i),o+d);else{for(var f,p=h.length,g=[];f<p;f+=1)g[f]=h[f](a,n,i);var m=u(g.concat());l.set(g[m],o+d)}i=a}return l},r=function(e){var t=Array.apply([],e);return t.unshift(0),t},a=function(e,t){var n,r=[],a=e.length;r[0]=1;for(var i=0;i<a;i+=1)n=e[i-t]||0,r[i+1]=e[i]-n+256&255;return r},i=function(e,t,n){var r,a=[],i=e.length;a[0]=2;for(var o=0;o<i;o+=1)r=n&&n[o]||0,a[o+1]=e[o]-r+256&255;return a},o=function(e,t,n){var r,a,i=[],o=e.length;i[0]=3;for(var s=0;s<o;s+=1)r=e[s-t]||0,a=n&&n[s]||0,i[s+1]=e[s]+256-(r+a>>>1)&255;return i},s=function(e,t,n){var r,a,i,o,s=[],c=e.length;s[0]=4;for(var u=0;u<c;u+=1)r=e[u-t]||0,a=n&&n[u]||0,i=n&&n[u-t]||0,o=l(r,a,i),s[u+1]=e[u]-o+256&255;return s},l=function(e,t,n){if(e===t&&t===n)return e;var r=Math.abs(t-n),a=Math.abs(e-n),i=Math.abs(e+t-n-n);return r<=a&&r<=i?e:a<=i?t:n},c=function(){return[r,a,i,o,s]},u=function(e){var t=e.map(function(e){return e.reduce(function(e,t){return e+Math.abs(t)},0)});return t.indexOf(Math.min.apply(null,t))};e.processPNG=function(n,r,a,i){var o,s,l,c,u,h,d,f,p,g,m,v,b,x,y,w=this.decode.FLATE_DECODE,k="";if(this.__addimage__.isArrayBuffer(n)&&(n=new Uint8Array(n)),this.__addimage__.isArrayBufferView(n)){if(n=(l=new qt(n)).imgData,s=l.bits,o=l.colorSpace,u=l.colors,-1!==[4,6].indexOf(l.colorType)){if(8===l.bits){p=(f=32==l.pixelBitlength?new Uint32Array(l.decodePixels().buffer):16==l.pixelBitlength?new Uint16Array(l.decodePixels().buffer):new Uint8Array(l.decodePixels().buffer)).length,m=new Uint8Array(p*l.colors),g=new Uint8Array(p);var N,S=l.pixelBitlength-l.bits;for(x=0,y=0;x<p;x++){for(b=f[x],N=0;N<S;)m[y++]=b>>>N&255,N+=l.bits;g[x]=b>>>N&255}}if(16===l.bits){p=(f=new Uint32Array(l.decodePixels().buffer)).length,m=new Uint8Array(p*(32/l.pixelBitlength)*l.colors),g=new Uint8Array(p*(32/l.pixelBitlength)),v=l.colors>1,x=0,y=0;for(var C=0;x<p;)b=f[x++],m[y++]=b>>>0&255,v&&(m[y++]=b>>>16&255,b=f[x++],m[y++]=b>>>0&255),g[C++]=b>>>16&255;s=8}i!==e.image_compression.NONE?(n=t(m,l.width*l.colors,l.colors,i),d=t(g,l.width,1,i)):(n=m,d=g,w=void 0)}if(3===l.colorType&&(o=this.color_spaces.INDEXED,h=l.palette,l.transparency.indexed)){var E=l.transparency.indexed,_=0;for(x=0,p=E.length;x<p;++x)_+=E[x];if((_/=255)===p-1&&-1!==E.indexOf(0))c=[E.indexOf(0)];else if(_!==p){for(f=l.decodePixels(),g=new Uint8Array(f.length),x=0,p=f.length;x<p;x++)g[x]=E[f[x]];d=t(g,l.width,1)}}var I=function(t){var n;switch(t){case e.image_compression.FAST:n=11;break;case e.image_compression.MEDIUM:n=13;break;case e.image_compression.SLOW:n=14;break;default:n=12}return n}(i);return w===this.decode.FLATE_DECODE&&(k="/Predictor "+I+" "),k+="/Colors "+u+" /BitsPerComponent "+s+" /Columns "+l.width,(this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n))&&(n=this.__addimage__.arrayBufferToBinaryString(n)),(d&&this.__addimage__.isArrayBuffer(d)||this.__addimage__.isArrayBufferView(d))&&(d=this.__addimage__.arrayBufferToBinaryString(d)),{alias:a,data:n,index:r,filter:w,decodeParameters:k,transparency:c,palette:h,sMask:d,predictor:I,width:l.width,height:l.height,bitsPerComponent:s,colorSpace:o}}}}(Fe.API),function(e){e.processGIF89A=function(t,n,r,a){var i=new Kt(t),o=i.width,s=i.height,l=[];i.decodeAndBlitFrameRGBA(0,l);var c={data:l,width:o,height:s},u=new Yt(100).encode(c,100);return e.processJPEG.call(this,u,n,r,a)},e.processGIF87A=e.processGIF89A}(Fe.API),$t.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,16===this.bitPP&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=0===this.colors?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:a,green:r,blue:n,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},$t.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(e){ne.log("bit decode error:"+e)}},$t.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),n=t%4;for(e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,a=0;a<t;a++)for(var i=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+8*a*4,s=0;s<8&&8*a+s<this.width;s++){var l=this.palette[i>>7-s&1];this.data[o+4*s]=l.blue,this.data[o+4*s+1]=l.green,this.data[o+4*s+2]=l.red,this.data[o+4*s+3]=255}0!==n&&(this.pos+=4-n)}},$t.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,a=0;a<e;a++){var i=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+2*a*4,s=i>>4,l=15&i,c=this.palette[s];if(this.data[o]=c.blue,this.data[o+1]=c.green,this.data[o+2]=c.red,this.data[o+3]=255,2*a+1>=this.width)break;c=this.palette[l],this.data[o+4]=c.blue,this.data[o+4+1]=c.green,this.data[o+4+2]=c.red,this.data[o+4+3]=255}0!==t&&(this.pos+=4-t)}},$t.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+4*r;if(a<this.palette.length){var o=this.palette[a];this.data[i]=o.red,this.data[i+1]=o.green,this.data[i+2]=o.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}0!==e&&(this.pos+=4-e)}},$t.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(i&t)/t*255|0,s=(i>>5&t)/t*255|0,l=(i>>10&t)/t*255|0,c=i>>15?255:0,u=r*this.width*4+4*a;this.data[u]=l,this.data[u+1]=s,this.data[u+2]=o,this.data[u+3]=c}this.pos+=e}},$t.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),n=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(o&t)/t*255|0,l=(o>>5&n)/n*255|0,c=(o>>11)/t*255|0,u=a*this.width*4+4*i;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=s,this.data[u+3]=255}this.pos+=e}},$t.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*n;this.data[o]=i,this.data[o+1]=a,this.data[o+2]=r,this.data[o+3]=255}this.pos+=this.width%4}},$t.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*n;this.data[s]=i,this.data[s+1]=a,this.data[s+2]=r,this.data[s+3]=o}},$t.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,n,r,a){var i=new $t(t,!1),o=i.width,s=i.height,l={data:i.getData(),width:o,height:s},c=new Yt(100).encode(l,100);return e.processJPEG.call(this,c,n,r,a)}}(Fe.API),Jt.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,n,r,a){var i=new Jt(t,!1),o=i.width,s=i.height,l={data:i.getData(),width:o,height:s},c=new Yt(100).encode(l,100);return e.processJPEG.call(this,c,n,r,a)}}(Fe.API),Fe.API.processRGBA=function(e,t,n){for(var r=e.data,a=r.length,i=new Uint8Array(a/4*3),o=new Uint8Array(a/4),s=0,l=0,c=0;c<a;c+=4){var u=r[c],h=r[c+1],d=r[c+2],f=r[c+3];i[s++]=u,i[s++]=h,i[s++]=d,o[l++]=f}var p=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:p,index:t,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Fe.API.setLanguage=function(e){return void 0===this.internal.languageSettings&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),void 0!=={af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]&&(this.internal.languageSettings.languageCode=e,!1===this.internal.languageSettings.isSubscribed&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Wt=Fe.API,Ut=Wt.getCharWidthsArray=function(e,t){var n,a,i=(t=t||{}).font||this.internal.getFont(),o=t.fontSize||this.internal.getFontSize(),s=t.charSpace||this.internal.getCharSpace(),l=t.widths?t.widths:i.metadata.Unicode.widths,c=l.fof?l.fof:1,u=t.kerning?t.kerning:i.metadata.Unicode.kerning,h=u.fof?u.fof:1,d=!1!==t.doKerning,f=0,p=e.length,g=0,m=l[0]||c,v=[];for(n=0;n<p;n++)a=e.charCodeAt(n),"function"==typeof i.metadata.widthOfString?v.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(a))+s*(1e3/o)||0)/1e3):(f=d&&"object"===(0,r.A)(u[a])&&!isNaN(parseInt(u[a][g],10))?u[a][g]/h:0,v.push((l[a]||m)/c+f)),g=a;return v},Vt=Wt.getStringUnitWidth=function(e,t){var n=(t=t||{}).fontSize||this.internal.getFontSize(),r=t.font||this.internal.getFont(),a=t.charSpace||this.internal.getCharSpace();return Wt.processArabic&&(e=Wt.processArabic(e)),"function"==typeof r.metadata.widthOfString?r.metadata.widthOfString(e,n,a)/n:Ut.apply(this,arguments).reduce(function(e,t){return e+t},0)},Ht=function(e,t,n,r){for(var a=[],i=0,o=e.length,s=0;i!==o&&s+t[i]<n;)s+=t[i],i++;a.push(e.slice(0,i));var l=i;for(s=0;i!==o;)s+t[i]>r&&(a.push(e.slice(l,i)),s=0,l=i),s+=t[i],i++;return l!==i&&a.push(e.slice(l,i)),a},Gt=function(e,t,n){n||(n={});var r,a,i,o,s,l,c,u=[],h=[u],d=n.textIndent||0,f=0,p=0,g=e.split(" "),m=Ut.apply(this,[" ",n])[0];if(l=-1===n.lineIndent?g[0].length+2:n.lineIndent||0){var v=Array(l).join(" "),b=[];g.map(function(e){(e=e.split(/\s*\n/)).length>1?b=b.concat(e.map(function(e,t){return(t&&e.length?"\n":"")+e})):b.push(e[0])}),g=b,l=Vt.apply(this,[v,n])}for(i=0,o=g.length;i<o;i++){var x=0;if(r=g[i],l&&"\n"==r[0]&&(r=r.substr(1),x=1),d+f+(p=(a=Ut.apply(this,[r,n])).reduce(function(e,t){return e+t},0))>t||x){if(p>t){for(s=Ht.apply(this,[r,a,t-(d+f),t]),u.push(s.shift()),u=[s.pop()];s.length;)h.push([s.shift()]);p=a.slice(r.length-(u[0]?u[0].length:0)).reduce(function(e,t){return e+t},0)}else u=[r];h.push(u),d=p+l,f=m}else u.push(r),d+=f+p,f=m}return c=l?function(e,t){return(t?v:"")+e.join(" ")}:function(e){return e.join(" ")},h.map(c)},Wt.splitTextToSize=function(e,t,n){var r,a=(n=n||{}).fontSize||this.internal.getFontSize(),i=function(e){if(e.widths&&e.kerning)return{widths:e.widths,kerning:e.kerning};var t=this.internal.getFont(e.fontName,e.fontStyle);return t.metadata.Unicode?{widths:t.metadata.Unicode.widths||{0:1},kerning:t.metadata.Unicode.kerning||{}}:{font:t.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,n);r=Array.isArray(e)?e:String(e).split(/\r?\n/);var o=1*this.internal.scaleFactor*t/a;i.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/a:0,i.lineIndent=n.lineIndent;var s,l,c=[];for(s=0,l=r.length;s<l;s++)c=c.concat(Gt.apply(this,[r[s],o,i]));return c},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",n={},a={},i=0;i<16;i++)n[t[i]]="0123456789abcdef"[i],a["0123456789abcdef"[i]]=t[i];var o=function(e){return"0x"+parseInt(e,10).toString(16)},s=e.__fontmetrics__.compress=function(e){var t,n,i,l,c=["{"];for(var u in e){if(t=e[u],isNaN(parseInt(u,10))?n="'"+u+"'":(u=parseInt(u,10),n=(n=o(u).slice(2)).slice(0,-1)+a[n.slice(-1)]),"number"==typeof t)t<0?(i=o(t).slice(3),l="-"):(i=o(t).slice(2),l=""),i=l+i.slice(0,-1)+a[i.slice(-1)];else{if("object"!==(0,r.A)(t))throw new Error("Don't know what to do with value type "+(0,r.A)(t)+".");i=s(t)}c.push(n+i)}return c.push("}"),c.join("")},l=e.__fontmetrics__.uncompress=function(e){if("string"!=typeof e)throw new Error("Invalid argument passed to uncompress.");for(var t,r,a,i,o={},s=1,l=o,c=[],u="",h="",d=e.length-1,f=1;f<d;f+=1)"'"==(i=e[f])?t?(a=t.join(""),t=void 0):t=[]:t?t.push(i):"{"==i?(c.push([l,a]),l={},a=void 0):"}"==i?((r=c.pop())[0][r[1]]=l,a=void 0,l=r[0]):"-"==i?s=-1:void 0===a?n.hasOwnProperty(i)?(u+=n[i],a=parseInt(u,16)*s,s=1,u=""):u+=i:n.hasOwnProperty(i)?(h+=n[i],l[a]=parseInt(h,16)*s,s=1,a=void 0,h=""):h+=i;return o},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},h={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(e){var t=e.font,n=h.Unicode[t.postScriptName];n&&(t.metadata.Unicode={},t.metadata.Unicode.widths=n.widths,t.metadata.Unicode.kerning=n.kerning);var r=u.Unicode[t.postScriptName];r&&(t.metadata.Unicode.encoding=r,t.encoding=r.codePages[0])}])}(Fe.API),function(e){var t=function(e){for(var t=e.length,n=new Uint8Array(t),r=0;r<t;r++)n[r]=e.charCodeAt(r);return n};e.API.events.push(["addFont",function(n){var r=void 0,a=n.font,i=n.instance;if(!a.isStandardFont){if(void 0===i)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if("string"!=typeof(r=!1===i.existsFileInVFS(a.postScriptName)?i.loadFile(a.postScriptName):i.getFileFromVFS(a.postScriptName)))throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");!function(n,r){r=/^\x00\x01\x00\x00/.test(r)?t(r):t(oe(r)),n.metadata=e.API.TTFFont.open(r),n.metadata.Unicode=n.metadata.Unicode||{encoding:{},kerning:{},widths:[]},n.metadata.glyIdsUsed=[0]}(a,r)}}])}(Fe),function(){function e(){return(ee.canvg?Promise.resolve(ee.canvg):n.e(455).then(n.bind(n,8455))).catch(function(e){return Promise.reject(new Error("Could not load canvg: "+e))}).then(function(e){return e.default?e.default:e})}Fe.API.addSvgAsImage=function(t,n,r,a,i,o,s,l){if(isNaN(n)||isNaN(r))throw ne.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(a)||isNaN(i))throw ne.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=a,c.height=i;var u=c.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,c.width,c.height);var h={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},d=this;return e().then(function(e){return e.fromString(u,t,h)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(e){return e.render(h)}).then(function(){d.addImage(c.toDataURL("image/jpeg",1),n,r,a,i,s,l)})}}(),Fe.API.putTotalPages=function(e){var t,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),n=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var a=0;a<this.internal.pages[r].length;a++)this.internal.pages[r][a]=this.internal.pages[r][a].replace(t,n);return this},Fe.API.viewerPreferences=function(e,t){var n;e=e||{},t=t||!1;var a,i,o,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(s),c=[],u=0,h=0,d=0;function f(e,t){var n,r=!1;for(n=0;n<e.length;n+=1)e[n]===t&&(r=!0);return r}if(void 0===this.internal.viewerpreferences&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,"reset"===e||!0===t){var p=l.length;for(d=0;d<p;d+=1)n[l[d]].value=n[l[d]].defaultValue,n[l[d]].explicitSet=!1}if("object"===(0,r.A)(e))for(i in e)if(o=e[i],f(l,i)&&void 0!==o){if("boolean"===n[i].type&&"boolean"==typeof o)n[i].value=o;else if("name"===n[i].type&&f(n[i].valueSet,o))n[i].value=o;else if("integer"===n[i].type&&Number.isInteger(o))n[i].value=o;else if("array"===n[i].type){for(u=0;u<o.length;u+=1)if(a=!0,1===o[u].length&&"number"==typeof o[u][0])c.push(String(o[u]-1));else if(o[u].length>1){for(h=0;h<o[u].length;h+=1)"number"!=typeof o[u][h]&&(a=!1);!0===a&&c.push([o[u][0]-1,o[u][1]-1].join(" "))}n[i].value="["+c.join(" ")+"]"}else n[i].value=n[i].defaultValue;n[i].explicitSet=!0}return!1===this.internal.viewerpreferences.isSubscribed&&(this.internal.events.subscribe("putCatalog",function(){var e,t=[];for(e in n)!0===n[e].explicitSet&&("name"===n[e].type?t.push("/"+e+" /"+n[e].value):t.push("/"+e+" "+n[e].value));0!==t.length&&this.internal.write("/ViewerPreferences\n<<\n"+t.join("\n")+"\n>>")}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},function(e){var t=function(){var e='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',t=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),n=unescape(encodeURIComponent(e)),r=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),a=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),i=unescape(encodeURIComponent("</x:xmpmeta>")),o=n.length+r.length+a.length+t.length+i.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+o+" >>"),this.internal.write("stream"),this.internal.write(t+n+r+a+i),this.internal.write("endstream"),this.internal.write("endobj")},n=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(e,r){return void 0===this.internal.__metadata__&&(this.internal.__metadata__={metadata:e,namespaceuri:r||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",n),this.internal.events.subscribe("postPutResources",t)),this}}(Fe.API),function(e){var t=e.API,n=t.pdfEscape16=function(e,t){for(var n,r=t.metadata.Unicode.widths,a=["","0","00","000","0000"],i=[""],o=0,s=e.length;o<s;++o){if(n=t.metadata.characterToGlyph(e.charCodeAt(o)),t.metadata.glyIdsUsed.push(n),t.metadata.toUnicode[n]=e.charCodeAt(o),-1==r.indexOf(n)&&(r.push(n),r.push([parseInt(t.metadata.widthOfGlyph(n),10)])),"0"==n)return i.join("");n=n.toString(16),i.push(a[4-n.length],n)}return i.join("")},r=function(e){var t,n,r,a,i,o,s;for(i="/CIDInit /ProcSet findresource begin\n12 dict begin\nbegincmap\n/CIDSystemInfo <<\n  /Registry (Adobe)\n  /Ordering (UCS)\n  /Supplement 0\n>> def\n/CMapName /Adobe-Identity-UCS def\n/CMapType 2 def\n1 begincodespacerange\n<0000><ffff>\nendcodespacerange",r=[],o=0,s=(n=Object.keys(e).sort(function(e,t){return e-t})).length;o<s;o++)t=n[o],r.length>=100&&(i+="\n"+r.length+" beginbfchar\n"+r.join("\n")+"\nendbfchar",r=[]),void 0!==e[t]&&null!==e[t]&&"function"==typeof e[t].toString&&(a=("0000"+e[t].toString(16)).slice(-4),t=("0000"+(+t).toString(16)).slice(-4),r.push("<"+t+"><"+a+">"));return r.length&&(i+="\n"+r.length+" beginbfchar\n"+r.join("\n")+"\nendbfchar\n"),i+"endcmap\nCMapName currentdict /CMap defineresource pop\nend\nend"};t.events.push(["putFont",function(t){!function(t){var n=t.font,a=t.out,i=t.newObject,o=t.putStream;if(n.metadata instanceof e.API.TTFFont&&"Identity-H"===n.encoding){for(var s=n.metadata.Unicode.widths,l=n.metadata.subset.encode(n.metadata.glyIdsUsed,1),c="",u=0;u<l.length;u++)c+=String.fromCharCode(l[u]);var h=i();o({data:c,addLength1:!0,objectId:h}),a("endobj");var d=i();o({data:r(n.metadata.toUnicode),addLength1:!0,objectId:d}),a("endobj");var f=i();a("<<"),a("/Type /FontDescriptor"),a("/FontName /"+_e(n.fontName)),a("/FontFile2 "+h+" 0 R"),a("/FontBBox "+e.API.PDFObject.convert(n.metadata.bbox)),a("/Flags "+n.metadata.flags),a("/StemV "+n.metadata.stemV),a("/ItalicAngle "+n.metadata.italicAngle),a("/Ascent "+n.metadata.ascender),a("/Descent "+n.metadata.decender),a("/CapHeight "+n.metadata.capHeight),a(">>"),a("endobj");var p=i();a("<<"),a("/Type /Font"),a("/BaseFont /"+_e(n.fontName)),a("/FontDescriptor "+f+" 0 R"),a("/W "+e.API.PDFObject.convert(s)),a("/CIDToGIDMap /Identity"),a("/DW 1000"),a("/Subtype /CIDFontType2"),a("/CIDSystemInfo"),a("<<"),a("/Supplement 0"),a("/Registry (Adobe)"),a("/Ordering ("+n.encoding+")"),a(">>"),a(">>"),a("endobj"),n.objectNumber=i(),a("<<"),a("/Type /Font"),a("/Subtype /Type0"),a("/ToUnicode "+d+" 0 R"),a("/BaseFont /"+_e(n.fontName)),a("/Encoding /"+n.encoding),a("/DescendantFonts ["+p+" 0 R]"),a(">>"),a("endobj"),n.isAlreadyPutted=!0}}(t)}]),t.events.push(["putFont",function(t){!function(t){var n=t.font,a=t.out,i=t.newObject,o=t.putStream;if(n.metadata instanceof e.API.TTFFont&&"WinAnsiEncoding"===n.encoding){for(var s=n.metadata.rawData,l="",c=0;c<s.length;c++)l+=String.fromCharCode(s[c]);var u=i();o({data:l,addLength1:!0,objectId:u}),a("endobj");var h=i();o({data:r(n.metadata.toUnicode),addLength1:!0,objectId:h}),a("endobj");var d=i();a("<<"),a("/Descent "+n.metadata.decender),a("/CapHeight "+n.metadata.capHeight),a("/StemV "+n.metadata.stemV),a("/Type /FontDescriptor"),a("/FontFile2 "+u+" 0 R"),a("/Flags 96"),a("/FontBBox "+e.API.PDFObject.convert(n.metadata.bbox)),a("/FontName /"+_e(n.fontName)),a("/ItalicAngle "+n.metadata.italicAngle),a("/Ascent "+n.metadata.ascender),a(">>"),a("endobj"),n.objectNumber=i();for(var f=0;f<n.metadata.hmtx.widths.length;f++)n.metadata.hmtx.widths[f]=parseInt(n.metadata.hmtx.widths[f]*(1e3/n.metadata.head.unitsPerEm));a("<</Subtype/TrueType/Type/Font/ToUnicode "+h+" 0 R/BaseFont/"+_e(n.fontName)+"/FontDescriptor "+d+" 0 R/Encoding/"+n.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(n.metadata.hmtx.widths)+">>"),a("endobj"),n.isAlreadyPutted=!0}}(t)}]);var a=function(e){var t,r=e.text||"",a=e.x,i=e.y,o=e.options||{},s=e.mutex||{},l=s.pdfEscape,c=s.activeFontKey,u=s.fonts,h=c,d="",f=0,p="",g=u[h].encoding;if("Identity-H"!==u[h].encoding)return{text:r,x:a,y:i,options:o,mutex:s};for(p=r,h=c,Array.isArray(r)&&(p=r[0]),f=0;f<p.length;f+=1)u[h].metadata.hasOwnProperty("cmap")&&(t=u[h].metadata.cmap.unicode.codeMap[p[f].charCodeAt(0)]),t||p[f].charCodeAt(0)<256&&u[h].metadata.hasOwnProperty("Unicode")?d+=p[f]:d+="";var m="";return parseInt(h.slice(1))<14||"WinAnsiEncoding"===g?m=l(d,h).split("").map(function(e){return e.charCodeAt(0).toString(16)}).join(""):"Identity-H"===g&&(m=n(d,u[h])),s.isHex=!0,{text:m,x:a,y:i,options:o,mutex:s}};t.events.push(["postProcessText",function(e){var t=e.text||"",n=[],r={text:t,x:e.x,y:e.y,options:e.options,mutex:e.mutex};if(Array.isArray(t)){var i=0;for(i=0;i<t.length;i+=1)Array.isArray(t[i])&&3===t[i].length?n.push([a(Object.assign({},r,{text:t[i][0]})).text,t[i][1],t[i][2]]):n.push(a(Object.assign({},r,{text:t[i]})).text);e.text=n}else e.text=a(Object.assign({},r,{text:t})).text}])}(Fe),function(e){var t=function(){return void 0===this.internal.vFS&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(e){return t.call(this),void 0!==this.internal.vFS[e]},e.addFileToVFS=function(e,n){return t.call(this),this.internal.vFS[e]=n,this},e.getFileFromVFS=function(e){return t.call(this),void 0!==this.internal.vFS[e]?this.internal.vFS[e]:null}}(Fe.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(e){var n,r,a,i,o,s,l,c=t,u=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],d={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},f={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},p=["(",")","(","<",">","<","[","]","[","{","}","{","\xab","\xbb","\xab","\u2039","\u203a","\u2039","\u2045","\u2046","\u2045","\u207d","\u207e","\u207d","\u208d","\u208e","\u208d","\u2264","\u2265","\u2264","\u2329","\u232a","\u2329","\ufe59","\ufe5a","\ufe59","\ufe5b","\ufe5c","\ufe5b","\ufe5d","\ufe5e","\ufe5d","\ufe64","\ufe65","\ufe64"],g=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),m=!1,v=0;this.__bidiEngine__={};var b=function(e){var t=e.charCodeAt(),n=t>>8,r=f[n];return void 0!==r?c[256*r+(255&t)]:252===n||253===n?"AL":g.test(n)?"L":8===n?"R":"N"},x=function(e){for(var t,n=0;n<e.length;n++){if("L"===(t=b(e.charAt(n))))return!1;if("R"===t)return!0}return!1},y=function(e,t,o,s){var l,c,u,h,d=t[s];switch(d){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":m=!1;break;case"N":case"AN":break;case"EN":m&&(d="AN");break;case"AL":m=!0,d="R";break;case"WS":case"BN":d="N";break;case"CS":s<1||s+1>=t.length||"EN"!==(l=o[s-1])&&"AN"!==l||"EN"!==(c=t[s+1])&&"AN"!==c?d="N":m&&(c="AN"),d=c===l?c:"N";break;case"ES":d="EN"===(l=s>0?o[s-1]:"B")&&s+1<t.length&&"EN"===t[s+1]?"EN":"N";break;case"ET":if(s>0&&"EN"===o[s-1]){d="EN";break}if(m){d="N";break}for(u=s+1,h=t.length;u<h&&"ET"===t[u];)u++;d=u<h&&"EN"===t[u]?"EN":"N";break;case"NSM":if(a&&!i){for(h=t.length,u=s+1;u<h&&"NSM"===t[u];)u++;if(u<h){var f=e[s],p=f>=1425&&f<=2303||64286===f;if(l=t[u],p&&("R"===l||"AL"===l)){d="R";break}}}d=s<1||"B"===(l=t[s-1])?"N":o[s-1];break;case"B":m=!1,n=!0,d=v;break;case"S":r=!0,d="N"}return d},w=function(e,t,n){var r=e.split("");return n&&k(r,n,{hiLevel:v}),r.reverse(),t&&t.reverse(),r.join("")},k=function(e,t,a){var i,o,s,l,c,f=-1,p=e.length,g=0,x=[],w=v?h:u,k=[];for(m=!1,n=!1,r=!1,o=0;o<p;o++)k[o]=b(e[o]);for(s=0;s<p;s++){if(c=g,x[s]=y(e,k,x,s),i=240&(g=w[c][d[x[s]]]),g&=15,t[s]=l=w[g][5],i>0)if(16===i){for(o=f;o<s;o++)t[o]=1;f=-1}else f=-1;if(w[g][6])-1===f&&(f=s);else if(f>-1){for(o=f;o<s;o++)t[o]=l;f=-1}"B"===k[s]&&(t[s]=0),a.hiLevel|=l}r&&function(e,t,n){for(var r=0;r<n;r++)if("S"===e[r]){t[r]=v;for(var a=r-1;a>=0&&"WS"===e[a];a--)t[a]=v}}(k,t,p)},N=function(e,t,r,a,i){if(!(i.hiLevel<e)){if(1===e&&1===v&&!n)return t.reverse(),void(r&&r.reverse());for(var o,s,l,c,u=t.length,h=0;h<u;){if(a[h]>=e){for(l=h+1;l<u&&a[l]>=e;)l++;for(c=h,s=l-1;c<s;c++,s--)o=t[c],t[c]=t[s],t[s]=o,r&&(o=r[c],r[c]=r[s],r[s]=o);h=l}h++}}},S=function(e,t,n){var r=e.split(""),a={hiLevel:v};return n||(n=[]),k(r,n,a),function(e,t,n){if(0!==n.hiLevel&&l)for(var r,a=0;a<e.length;a++)1===t[a]&&(r=p.indexOf(e[a]))>=0&&(e[a]=p[r+1])}(r,n,a),N(2,r,t,n,a),N(1,r,t,n,a),r.join("")};return this.__bidiEngine__.doBidiReorder=function(e,t,n){if(function(e,t){if(t)for(var n=0;n<e.length;n++)t[n]=n;void 0===i&&(i=x(e)),void 0===s&&(s=x(e))}(e,t),a||!o||s)if(a&&o&&i^s)v=i?1:0,e=w(e,t,n);else if(!a&&o&&s)v=i?1:0,e=S(e,t,n),e=w(e,t);else if(!a||i||o||s){if(a&&!o&&i^s)e=w(e,t),i?(v=0,e=S(e,t,n)):(v=1,e=S(e,t,n),e=w(e,t));else if(a&&i&&!o&&s)v=1,e=S(e,t,n),e=w(e,t);else if(!a&&!o&&i^s){var r=l;i?(v=1,e=S(e,t,n),v=0,l=!1,e=S(e,t,n),l=r):(v=0,e=S(e,t,n),e=w(e,t),v=1,l=!1,e=S(e,t,n),l=r,e=w(e,t))}}else v=0,e=S(e,t,n);else v=i?1:0,e=S(e,t,n);return e},this.__bidiEngine__.setOptions=function(e){e&&(a=e.isInputVisual,o=e.isOutputVisual,i=e.isInputRtl,s=e.isOutputRtl,l=e.isSymmetricSwapping)},this.__bidiEngine__.setOptions(e),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(e){var t=e.text,r=(e.x,e.y,e.options||{}),a=(e.mutex,r.lang,[]);if(r.isInputVisual="boolean"!=typeof r.isInputVisual||r.isInputVisual,n.setOptions(r),"[object Array]"===Object.prototype.toString.call(t)){var i=0;for(a=[],i=0;i<t.length;i+=1)"[object Array]"===Object.prototype.toString.call(t[i])?a.push([n.doBidiReorder(t[i][0]),t[i][1],t[i][2]]):a.push([n.doBidiReorder(t[i])]);e.text=a}else e.text=n.doBidiReorder(t);n.setOptions({isInputVisual:!0})}])}(Fe),Fe.API.TTFFont=function(){function e(e){var t;if(this.rawData=e,t=this.contents=new Zt(e),this.contents.pos=4,"ttcf"===t.readString(4))throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new xn(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new en(this.contents),this.head=new rn(this),this.name=new hn(this),this.cmap=new on(this),this.toUnicode={},this.hhea=new sn(this),this.maxp=new dn(this),this.hmtx=new fn(this),this.post=new cn(this),this.os2=new ln(this),this.loca=new bn(this),this.glyf=new gn(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var e,t,n,r,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var t,n,r,a;for(a=[],t=0,n=(r=this.bbox).length;t<n;t++)e=r[t],a.push(Math.round(e*this.scaleFactor));return a}.call(this),this.stemV=0,this.post.exists?(n=255&(r=this.post.italic_angle),0!=(32768&(t=r>>16))&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=1===(a=this.familyClass)||2===a||3===a||4===a||5===a||7===a,this.isScript=10===this.familyClass,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),0!==this.italicAngle&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(e){var t;return(null!=(t=this.cmap.unicode)?t.codeMap[e]:void 0)||0},e.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},e.prototype.widthOfString=function(e,t,n){var r,a,i,o;for(i=0,a=0,o=(e=""+e).length;0<=o?a<o:a>o;a=0<=o?++a:--a)r=e.charCodeAt(a),i+=this.widthOfGlyph(this.characterToGlyph(r))+n*(1e3/t)||0;return i*(t/1e3)},e.prototype.lineHeight=function(e,t){var n;return null==t&&(t=!1),n=t?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},e}();var Qt,Zt=function(){function e(e){this.data=null!=e?e:[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(e){return this.data[this.pos++]=e},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},e.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},e.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},e.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},e.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},e.prototype.readString=function(e){var t,n;for(n=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)n[t]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(e){var t,n,r;for(r=[],t=0,n=e.length;0<=n?t<n:t>n;t=0<=n?++t:--t)r.push(this.writeByte(e.charCodeAt(t)));return r},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(e){return this.writeInt16(e)},e.prototype.readLongLong=function(){var e,t,n,r,a,i,o,s;return e=this.readByte(),t=this.readByte(),n=this.readByte(),r=this.readByte(),a=this.readByte(),i=this.readByte(),o=this.readByte(),s=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^n)+4294967296*(255^r)+16777216*(255^a)+65536*(255^i)+256*(255^o)+(255^s)+1):72057594037927940*e+281474976710656*t+1099511627776*n+4294967296*r+16777216*a+65536*i+256*o+s},e.prototype.writeLongLong=function(e){var t,n;return t=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(e){return this.writeInt32(e)},e.prototype.read=function(e){var t,n;for(t=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)t.push(this.readByte());return t},e.prototype.write=function(e){var t,n,r,a;for(a=[],n=0,r=e.length;n<r;n++)t=e[n],a.push(this.writeByte(t));return a},e}(),en=function(){var e;function t(e){var t,n,r;for(this.scalarType=e.readInt(),this.tableCount=e.readShort(),this.searchRange=e.readShort(),this.entrySelector=e.readShort(),this.rangeShift=e.readShort(),this.tables={},n=0,r=this.tableCount;0<=r?n<r:n>r;n=0<=r?++n:--n)t={tag:e.readString(4),checksum:e.readInt(),offset:e.readInt(),length:e.readInt()},this.tables[t.tag]=t}return t.prototype.encode=function(t){var n,r,a,i,o,s,l,c,u,h,d,f,p;for(p in d=Object.keys(t).length,s=Math.log(2),u=16*Math.floor(Math.log(d)/s),i=Math.floor(u/s),c=16*d-u,(r=new Zt).writeInt(this.scalarType),r.writeShort(d),r.writeShort(u),r.writeShort(i),r.writeShort(c),a=16*d,l=r.pos+a,o=null,f=[],t)for(h=t[p],r.writeString(p),r.writeInt(e(h)),r.writeInt(l),r.writeInt(h.length),f=f.concat(h),"head"===p&&(o=l),l+=h.length;l%4;)f.push(0),l++;return r.write(f),n=2981146554-e(r.data),r.pos=o+8,r.writeUInt32(n),r.data},e=function(e){var t,n,r,a;for(e=pn.call(e);e.length%4;)e.push(0);for(r=new Zt(e),n=0,t=0,a=e.length;t<a;t=t+=4)n+=r.readUInt32();return 4294967295&n},t}(),tn={}.hasOwnProperty,nn=function(e,t){for(var n in t)tn.call(t,n)&&(e[n]=t[n]);function r(){this.constructor=e}return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};Qt=function(){function e(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var rn=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return nn(e,Qt),e.prototype.tag="head",e.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},e.prototype.encode=function(e){var t;return(t=new Zt).writeInt(this.version),t.writeInt(this.revision),t.writeInt(this.checkSumAdjustment),t.writeInt(this.magicNumber),t.writeShort(this.flags),t.writeShort(this.unitsPerEm),t.writeLongLong(this.created),t.writeLongLong(this.modified),t.writeShort(this.xMin),t.writeShort(this.yMin),t.writeShort(this.xMax),t.writeShort(this.yMax),t.writeShort(this.macStyle),t.writeShort(this.lowestRecPPEM),t.writeShort(this.fontDirectionHint),t.writeShort(e),t.writeShort(this.glyphDataFormat),t.data},e}(),an=function(){function e(e,t){var n,r,a,i,o,s,l,c,u,h,d,f,p,g,m,v,b;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),u=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=3===this.platformID&&1===this.encodingID&&4===this.format||0===this.platformID&&4===this.format,this.codeMap={},this.format){case 0:for(s=0;s<256;++s)this.codeMap[s]=e.readByte();break;case 4:for(d=e.readUInt16(),h=d/2,e.pos+=6,a=function(){var t,n;for(n=[],s=t=0;0<=h?t<h:t>h;s=0<=h?++t:--t)n.push(e.readUInt16());return n}(),e.pos+=2,p=function(){var t,n;for(n=[],s=t=0;0<=h?t<h:t>h;s=0<=h?++t:--t)n.push(e.readUInt16());return n}(),l=function(){var t,n;for(n=[],s=t=0;0<=h?t<h:t>h;s=0<=h?++t:--t)n.push(e.readUInt16());return n}(),c=function(){var t,n;for(n=[],s=t=0;0<=h?t<h:t>h;s=0<=h?++t:--t)n.push(e.readUInt16());return n}(),r=(this.length-e.pos+this.offset)/2,o=function(){var t,n;for(n=[],s=t=0;0<=r?t<r:t>r;s=0<=r?++t:--t)n.push(e.readUInt16());return n}(),s=m=0,b=a.length;m<b;s=++m)for(g=a[s],n=v=f=p[s];f<=g?v<=g:v>=g;n=f<=g?++v:--v)0===c[s]?i=n+l[s]:0!==(i=o[c[s]/2+(n-f)-(h-s)]||0)&&(i+=l[s]),this.codeMap[n]=65535&i}e.pos=u}return e.encode=function(e,t){var n,r,a,i,o,s,l,c,u,h,d,f,p,g,m,v,b,x,y,w,k,N,S,C,E,_,I,T,A,R,D,F,O,L,P,M,j,B,z,W,U,V,H,G,q,K;switch(T=new Zt,i=Object.keys(e).sort(function(e,t){return e-t}),t){case"macroman":for(p=0,g=function(){var e=[];for(f=0;f<256;++f)e.push(0);return e}(),v={0:0},a={},A=0,O=i.length;A<O;A++)null==v[H=e[r=i[A]]]&&(v[H]=++p),a[r]={old:e[r],new:v[e[r]]},g[r]=v[e[r]];return T.writeUInt16(1),T.writeUInt16(0),T.writeUInt32(12),T.writeUInt16(0),T.writeUInt16(262),T.writeUInt16(0),T.write(g),{charMap:a,subtable:T.data,maxGlyphID:p+1};case"unicode":for(_=[],u=[],b=0,v={},n={},m=l=null,R=0,L=i.length;R<L;R++)null==v[y=e[r=i[R]]]&&(v[y]=++b),n[r]={old:y,new:v[y]},o=v[y]-r,null!=m&&o===l||(m&&u.push(m),_.push(r),l=o),m=r;for(m&&u.push(m),u.push(65535),_.push(65535),C=2*(S=_.length),N=2*Math.pow(Math.log(S)/Math.LN2,2),h=Math.log(N/2)/Math.LN2,k=2*S-N,s=[],w=[],d=[],f=D=0,P=_.length;D<P;f=++D){if(E=_[f],c=u[f],65535===E){s.push(0),w.push(0);break}if(E-(I=n[E].new)>=32768)for(s.push(0),w.push(2*(d.length+S-f)),r=F=E;E<=c?F<=c:F>=c;r=E<=c?++F:--F)d.push(n[r].new);else s.push(I-E),w.push(0)}for(T.writeUInt16(3),T.writeUInt16(1),T.writeUInt32(12),T.writeUInt16(4),T.writeUInt16(16+8*S+2*d.length),T.writeUInt16(0),T.writeUInt16(C),T.writeUInt16(N),T.writeUInt16(h),T.writeUInt16(k),U=0,M=u.length;U<M;U++)r=u[U],T.writeUInt16(r);for(T.writeUInt16(0),V=0,j=_.length;V<j;V++)r=_[V],T.writeUInt16(r);for(G=0,B=s.length;G<B;G++)o=s[G],T.writeUInt16(o);for(q=0,z=w.length;q<z;q++)x=w[q],T.writeUInt16(x);for(K=0,W=d.length;K<W;K++)p=d[K],T.writeUInt16(p);return{charMap:n,subtable:T.data,maxGlyphID:b+1}}},e}(),on=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return nn(e,Qt),e.prototype.tag="cmap",e.prototype.parse=function(e){var t,n,r;for(e.pos=this.offset,this.version=e.readUInt16(),r=e.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=r?n<r:n>r;n=0<=r?++n:--n)t=new an(e,this.offset),this.tables.push(t),t.isUnicode&&null==this.unicode&&(this.unicode=t);return!0},e.encode=function(e,t){var n,r;return null==t&&(t="macroman"),n=an.encode(e,t),(r=new Zt).writeUInt16(0),r.writeUInt16(1),n.table=r.data.concat(n.subtable),n},e}(),sn=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return nn(e,Qt),e.prototype.tag="hhea",e.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},e}(),ln=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return nn(e,Qt),e.prototype.tag="OS/2",e.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var t,n;for(n=[],t=0;t<10;++t)n.push(e.readByte());return n}(),this.charRange=function(){var t,n;for(n=[],t=0;t<4;++t)n.push(e.readInt());return n}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var t,n;for(n=[],t=0;t<2;t=++t)n.push(e.readInt());return n}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},e}(),cn=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return nn(e,Qt),e.prototype.tag="post",e.prototype.parse=function(e){var t,n,r;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var a;for(n=e.readUInt16(),this.glyphNameIndex=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],r=[];e.pos<this.offset+this.length;)t=e.readByte(),r.push(this.names.push(e.readString(t)));return r;case 151552:return n=e.readUInt16(),this.offsets=e.read(n);case 262144:return this.map=function(){var t,n,r;for(r=[],a=t=0,n=this.file.maxp.numGlyphs;0<=n?t<n:t>n;a=0<=n?++t:--t)r.push(e.readUInt32());return r}.call(this)}},e}(),un=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},hn=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return nn(e,Qt),e.prototype.tag="name",e.prototype.parse=function(e){var t,n,r,a,i,o,s,l,c,u,h;for(e.pos=this.offset,e.readShort(),t=e.readShort(),o=e.readShort(),n=[],a=0;0<=t?a<t:a>t;a=0<=t?++a:--a)n.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+o+e.readShort()});for(s={},a=c=0,u=n.length;c<u;a=++c)r=n[a],e.pos=r.offset,l=e.readString(r.length),i=new un(l,r),null==s[h=r.nameID]&&(s[h]=[]),s[r.nameID].push(i);this.strings=s,this.copyright=s[0],this.fontFamily=s[1],this.fontSubfamily=s[2],this.uniqueSubfamily=s[3],this.fontName=s[4],this.version=s[5];try{this.postscriptName=s[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch(e){this.postscriptName=s[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=s[7],this.manufacturer=s[8],this.designer=s[9],this.description=s[10],this.vendorUrl=s[11],this.designerUrl=s[12],this.license=s[13],this.licenseUrl=s[14],this.preferredFamily=s[15],this.preferredSubfamily=s[17],this.compatibleFull=s[18],this.sampleText=s[19]},e}(),dn=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return nn(e,Qt),e.prototype.tag="maxp",e.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},e}(),fn=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return nn(e,Qt),e.prototype.tag="hmtx",e.prototype.parse=function(e){var t,n,r,a,i,o,s;for(e.pos=this.offset,this.metrics=[],t=0,o=this.file.hhea.numberOfMetrics;0<=o?t<o:t>o;t=0<=o?++t:--t)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(r=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var n,a;for(a=[],t=n=0;0<=r?n<r:n>r;t=0<=r?++n:--n)a.push(e.readInt16());return a}(),this.widths=function(){var e,t,n,r;for(r=[],e=0,t=(n=this.metrics).length;e<t;e++)a=n[e],r.push(a.advance);return r}.call(this),n=this.widths[this.widths.length-1],s=[],t=i=0;0<=r?i<r:i>r;t=0<=r?++i:--i)s.push(this.widths.push(n));return s},e.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},e}(),pn=[].slice,gn=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return nn(e,Qt),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(e){var t,n,r,a,i,o,s,l,c,u;return e in this.cache?this.cache[e]:(a=this.file.loca,t=this.file.contents,n=a.indexOf(e),0===(r=a.lengthOf(e))?this.cache[e]=null:(t.pos=this.offset+n,i=(o=new Zt(t.read(r))).readShort(),l=o.readShort(),u=o.readShort(),s=o.readShort(),c=o.readShort(),this.cache[e]=-1===i?new vn(o,l,u,s,c):new mn(o,i,l,u,s,c),this.cache[e]))},e.prototype.encode=function(e,t,n){var r,a,i,o,s;for(i=[],a=[],o=0,s=t.length;o<s;o++)r=e[t[o]],a.push(i.length),r&&(i=i.concat(r.encode(n)));return a.push(i.length),{table:i,offsets:a}},e}(),mn=function(){function e(e,t,n,r,a,i){this.raw=e,this.numberOfContours=t,this.xMin=n,this.yMin=r,this.xMax=a,this.yMax=i,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),vn=function(){function e(e,t,n,r,a){var i,o;for(this.raw=e,this.xMin=t,this.yMin=n,this.xMax=r,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],i=this.raw;o=i.readShort(),this.glyphOffsets.push(i.pos),this.glyphIDs.push(i.readUInt16()),32&o;)i.pos+=1&o?4:2,128&o?i.pos+=8:64&o?i.pos+=4:8&o&&(i.pos+=2)}return e.prototype.encode=function(){var e,t,n;for(t=new Zt(pn.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)t.pos=this.glyphOffsets[e];return t.data},e}(),bn=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return nn(e,Qt),e.prototype.tag="loca",e.prototype.parse=function(e){var t,n;return e.pos=this.offset,t=this.file.head.indexToLocFormat,this.offsets=0===t?function(){var t,r;for(r=[],n=0,t=this.length;n<t;n+=2)r.push(2*e.readUInt16());return r}.call(this):function(){var t,r;for(r=[],n=0,t=this.length;n<t;n+=4)r.push(e.readUInt32());return r}.call(this)},e.prototype.indexOf=function(e){return this.offsets[e]},e.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},e.prototype.encode=function(e,t){for(var n=new Uint32Array(this.offsets.length),r=0,a=0,i=0;i<n.length;++i)if(n[i]=r,a<t.length&&t[a]==i){++a,n[i]=r;var o=this.offsets[i],s=this.offsets[i+1]-o;s>0&&(r+=s)}for(var l=new Array(4*n.length),c=0;c<n.length;++c)l[4*c+3]=255&n[c],l[4*c+2]=(65280&n[c])>>8,l[4*c+1]=(16711680&n[c])>>16,l[4*c]=(4278190080&n[c])>>24;return l},e}(),xn=function(){function e(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var e,t,n,r,a;for(t in r=this.font.cmap.tables[0].codeMap,e={},a=this.subset)n=a[t],e[t]=r[n];return e},e.prototype.glyphsFor=function(e){var t,n,r,a,i,o,s;for(r={},i=0,o=e.length;i<o;i++)r[a=e[i]]=this.font.glyf.glyphFor(a);for(a in t=[],r)(null!=(n=r[a])?n.compound:void 0)&&t.push.apply(t,n.glyphIDs);if(t.length>0)for(a in s=this.glyphsFor(t))n=s[a],r[a]=n;return r},e.prototype.encode=function(e,t){var n,r,a,i,o,s,l,c,u,h,d,f,p,g,m;for(r in n=on.encode(this.generateCmap(),"unicode"),i=this.glyphsFor(e),d={0:0},m=n.charMap)d[(s=m[r]).old]=s.new;for(f in h=n.maxGlyphID,i)f in d||(d[f]=h++);return c=function(e){var t,n;for(t in n={},e)n[e[t]]=t;return n}(d),u=Object.keys(c).sort(function(e,t){return e-t}),p=function(){var e,t,n;for(n=[],e=0,t=u.length;e<t;e++)o=u[e],n.push(c[o]);return n}(),a=this.font.glyf.encode(i,p,d),l=this.font.loca.encode(a.offsets,p),g={cmap:this.font.cmap.raw(),glyf:a.table,loca:l,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(g["OS/2"]=this.font.os2.raw()),this.font.directory.encode(g)},e}();Fe.API.PDFObject=function(){var e;function t(){}return e=function(e,t){return(Array(t+1).join("0")+e).slice(-t)},t.convert=function(n){var r,a,i,o;if(Array.isArray(n))return"["+function(){var e,a,i;for(i=[],e=0,a=n.length;e<a;e++)r=n[e],i.push(t.convert(r));return i}().join(" ")+"]";if("string"==typeof n)return"/"+n;if(null!=n?n.isString:void 0)return"("+n+")";if(n instanceof Date)return"(D:"+e(n.getUTCFullYear(),4)+e(n.getUTCMonth(),2)+e(n.getUTCDate(),2)+e(n.getUTCHours(),2)+e(n.getUTCMinutes(),2)+e(n.getUTCSeconds(),2)+"Z)";if("[object Object]"==={}.toString.call(n)){for(a in i=["<<"],n)o=n[a],i.push("/"+a+" "+t.convert(o));return i.push(">>"),i.join("\n")}return""+n},t}();const yn=Fe},7950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(2730)},8108:()=>{},8590:()=>{},8853:(e,t,n)=>{"use strict";e.exports=n(7234)},9016:function(e,t,n){var r;!function(e,a){function i(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function o(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function s(e,t){var n=new i(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&o(r,n),a.state=function(){return o(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.xorwow=s}(0,e=n.nmd(e),n.amdD)},9538:function(e,t,n){var r;!function(e,a){function i(e){var t=this;t.next=function(){var e,n,r=t.x,a=t.i;return e=r[a],n=(e^=e>>>7)^e<<24,n^=(e=r[a+1&7])^e>>>10,n^=(e=r[a+3&7])^e>>>3,n^=(e=r[a+4&7])^e<<7,e=r[a+7&7],n^=(e^=e<<13)^e<<9,r[a]=n,t.i=a+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function o(e,t){return t.x=e.x.slice(),t.i=e.i,t}function s(e,t){null==e&&(e=+new Date);var n=new i(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.x&&o(r,n),a.state=function(){return o(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.xorshift7=s}(0,e=n.nmd(e),n.amdD)}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.m=e,n.amdD=function(){throw new Error("define cannot be used indirect")},n.amdO={},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,a){if(1&a&&(r=this(r)),8&a)return r;if("object"===typeof r&&r){if(4&a&&r.__esModule)return r;if(16&a&&"function"===typeof r.then)return r}var i=Object.create(null);n.r(i);var o={};e=e||[null,t({}),t([]),t(t)];for(var s=2&a&&r;("object"==typeof s||"function"==typeof s)&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach(e=>o[e]=()=>r[e]);return o.default=()=>r,n.d(i,o),i}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce((t,r)=>(n.f[r](e,t),t),[])),n.u=e=>"static/js/"+e+"."+{213:"ec25a578",239:"5a5b05d9",455:"056fcc07"}[e]+".chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="mutants-academy-ashuras-tribe-client:";n.l=(r,a,i,o)=>{if(e[r])e[r].push(a);else{var s,l;if(void 0!==i)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var h=c[u];if(h.getAttribute("src")==r||h.getAttribute("data-webpack")==t+i){s=h;break}}s||(l=!0,(s=document.createElement("script")).charset="utf-8",n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",t+i),s.src=r),e[r]=[a];var d=(t,n)=>{s.onerror=s.onload=null,clearTimeout(f);var a=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),a&&a.forEach(e=>e(n)),t)return t(n)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=d.bind(null,s.onerror),s.onload=d.bind(null,s.onload),l&&document.head.appendChild(s)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n.p="/",(()=>{var e={792:0};n.f.j=(t,r)=>{var a=n.o(e,t)?e[t]:void 0;if(0!==a)if(a)r.push(a[2]);else{var i=new Promise((n,r)=>a=e[t]=[n,r]);r.push(a[2]=i);var o=n.p+n.u(t),s=new Error;n.l(o,r=>{if(n.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+i+": "+o+")",s.name="ChunkLoadError",s.type=i,s.request=o,a[1](s)}},"chunk-"+t,t)}};var t=(t,r)=>{var a,i,[o,s,l]=r,c=0;if(o.some(t=>0!==e[t])){for(a in s)n.o(s,a)&&(n.m[a]=s[a]);if(l)l(n)}for(t&&t(r);c<o.length;c++)i=o[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0},r=self.webpackChunkmutants_academy_ashuras_tribe_client=self.webpackChunkmutants_academy_ashuras_tribe_client||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),(()=>{"use strict";var e={};n.r(e),n.d(e,{hasBrowserEnv:()=>yr,hasStandardBrowserEnv:()=>kr,hasStandardBrowserWebWorkerEnv:()=>Nr,navigator:()=>wr,origin:()=>Sr});var t={};n.r(t),n.d(t,{assertParamsValid:()=>$I,computeFlatOffset:()=>cT,computeOutShape:()=>QI,getNormalizedAxes:()=>nT,isSliceContinous:()=>lT,maskToAxes:()=>JI,parseSliceParams:()=>uT,sliceInfo:()=>hT,startForAxis:()=>oT,startIndicesWithElidedDims:()=>rT,stopForAxis:()=>sT,stopIndicesWithElidedDims:()=>aT,stridesForAxis:()=>iT,stridesWithElidedDims:()=>ZI});var r={};n.r(r),n.d(r,{collectGatherOpShapeInfo:()=>TF,computeOutShape:()=>IF,segOpComputeOptimalWindowSize:()=>_F});var a={};n.r(a),n.d(a,{ERF_A1:()=>GD,ERF_A2:()=>qD,ERF_A3:()=>KD,ERF_A4:()=>XD,ERF_A5:()=>YD,ERF_P:()=>HD,PARALLELIZE_THRESHOLD:()=>AD,RowPartitionType:()=>CD,SELU_SCALE:()=>VD,SELU_SCALEALPHA:()=>UD,applyActivation:()=>IR,assertAndGetBroadcastShape:()=>FI,assertAxesAreInnerMostDims:()=>wA,assertParamsConsistent:()=>ND,assignToTypedArray:()=>tF,axesAreInnerMostDims:()=>vA,calculateShapes:()=>WD,checkEinsumDimSizes:()=>uF,checkPadOnDimRoundingMode:()=>AT,combineLocations:()=>bA,combineRaggedTensorToTensorShapes:()=>ED,complexWithEvenIndex:()=>QD,complexWithOddIndex:()=>ZD,computeConv2DInfo:()=>xT,computeConv3DInfo:()=>yT,computeDefaultPad:()=>wT,computeDilation2DInfo:()=>mT,computeOptimalWindowSize:()=>RD,computeOutAndReduceShapes:()=>xA,computeOutShape:()=>SD,computePool2DInfo:()=>vT,computePool3DInfo:()=>bT,convertConv2DDataFormat:()=>TT,decodeEinsumEquation:()=>lF,eitherStridesOrDilationsAreOne:()=>_T,expandShapeToKeepDim:()=>yA,exponent:()=>rF,exponents:()=>nF,fromStringArrayToUint8:()=>RF,fromUint8ToStringArray:()=>AF,getAxesPermutation:()=>kA,getBroadcastDims:()=>RI,getComplexWithIndex:()=>eF,getEinsumComputePath:()=>hF,getEinsumPermutation:()=>cF,getFusedBiasGradient:()=>_R,getFusedDyActivation:()=>ER,getImageCenter:()=>DD,getInnerMostAxes:()=>SA,getPermuted:()=>OD,getRaggedRank:()=>ID,getReductionAxes:()=>DI,getReshaped:()=>FD,getReshapedPermuted:()=>LD,getRowPartitionTypesHelper:()=>_D,getSliceBeginCoords:()=>PD,getSliceSize:()=>MD,getSparseFillEmptyRowsIndicesDenseShapeMismatch:()=>gF,getSparseFillEmptyRowsNegativeIndexErrorMessage:()=>mF,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:()=>vF,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:()=>yF,getSparseReshapeInputOutputMismatchErrorMessage:()=>kF,getSparseReshapeInputOutputMultipleErrorMessage:()=>wF,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:()=>bF,getSparseReshapeNegativeOutputDimErrorMessage:()=>xF,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:()=>EF,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:()=>NF,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:()=>SF,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:()=>CF,getUndoAxesPermutation:()=>NA,isIdentityPermutation:()=>dF,log:()=>HC,mergeRealAndImagArrays:()=>$D,prepareAndValidate:()=>jD,prepareSplitSize:()=>pF,segment_util:()=>r,shouldFuse:()=>TR,slice_util:()=>t,splitRealAndImagArrays:()=>JD,stridesOrDilationsArePositive:()=>IT,tupleValuesAreOne:()=>ET,upcastType:()=>UE,validateDefaultValueShape:()=>TD,validateInput:()=>zD,validateUpdateShape:()=>BD,warn:()=>VC});var i={};n.r(i),n.d(i,{mx:()=>IV,XI:()=>yH,Nk:()=>wH,f6:()=>NH,ct:()=>NV,YG:()=>EH,hH:()=>DH,z3:()=>mG,sG:()=>_G,uM:()=>DG,vS:()=>YG,qB:()=>rq,GG:()=>iq,lg:()=>uq,rq:()=>sq,cu:()=>Nq,WR:()=>yq,GE:()=>Eq,px:()=>Iq,jC:()=>Vq,He:()=>qq,hE:()=>nK,BF:()=>lG,Dk:()=>dK,cl:()=>yK,_B:()=>FK,ub:()=>jK,_f:()=>WK,Ku:()=>KK,qy:()=>YK,Zy:()=>sX,bu:()=>uX,zv:()=>pV,dH:()=>MV,HS:()=>mH,yH:()=>AX,l3:()=>DX,z9:()=>OX,x6:()=>BX,_m:()=>qX,eW:()=>JX,GK:()=>eY,SP:()=>rY,yr:()=>iY,dl:()=>jG,Dw:()=>hY,xT:()=>gY,_X:()=>HV,wz:()=>kY});var o={};n.r(o),n.d(o,{Decoder:()=>uie,Encoder:()=>lie,PacketType:()=>sie,protocol:()=>oie});var s,l=n(5043),c=n.t(l,2),u=n(4391);function h(){return h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},h.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(s||(s={}));const d="popstate";function f(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function p(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(ci){}}}function g(e,t){return{usr:e.state,key:e.key,idx:t}}function m(e,t,n,r){return void 0===n&&(n=null),h({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?b(t):t,{state:n,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function v(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function b(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function x(e,t,n,r){void 0===r&&(r={});let{window:a=document.defaultView,v5Compat:i=!1}=r,o=a.history,l=s.Pop,c=null,u=p();function p(){return(o.state||{idx:null}).idx}function b(){l=s.Pop;let e=p(),t=null==e?null:e-u;u=e,c&&c({action:l,location:y.location,delta:t})}function x(e){let t="null"!==a.location.origin?a.location.origin:a.location.href,n="string"===typeof e?e:v(e);return n=n.replace(/ $/,"%20"),f(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==u&&(u=0,o.replaceState(h({},o.state,{idx:u}),""));let y={get action(){return l},get location(){return e(a,o)},listen(e){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(d,b),c=e,()=>{a.removeEventListener(d,b),c=null}},createHref:e=>t(a,e),createURL:x,encodeLocation(e){let t=x(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){l=s.Push;let r=m(y.location,e,t);n&&n(r,e),u=p()+1;let h=g(r,u),d=y.createHref(r);try{o.pushState(h,"",d)}catch(f){if(f instanceof DOMException&&"DataCloneError"===f.name)throw f;a.location.assign(d)}i&&c&&c({action:l,location:y.location,delta:1})},replace:function(e,t){l=s.Replace;let r=m(y.location,e,t);n&&n(r,e),u=p();let a=g(r,u),h=y.createHref(r);o.replaceState(a,"",h),i&&c&&c({action:l,location:y.location,delta:0})},go:e=>o.go(e)};return y}var y;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(y||(y={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function w(e,t,n){return void 0===n&&(n="/"),k(e,t,n,!1)}function k(e,t,n,r){let a=P(("string"===typeof t?b(t):t).pathname||"/",n);if(null==a)return null;let i=N(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(i);let o=null;for(let s=0;null==o&&s<i.length;++s){let e=L(a);o=F(i[s],e,r)}return o}function N(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");let a=(e,a,i)=>{let o={relativePath:void 0===i?e.path||"":i,caseSensitive:!0===e.caseSensitive,childrenIndex:a,route:e};o.relativePath.startsWith("/")&&(f(o.relativePath.startsWith(r),'Absolute route path "'+o.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),o.relativePath=o.relativePath.slice(r.length));let s=H([r,o.relativePath]),l=n.concat(o);e.children&&e.children.length>0&&(f(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+s+'".'),N(e.children,t,l,s)),(null!=e.path||e.index)&&t.push({path:s,score:D(s,e.index),routesMeta:l})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let r of S(e.path))a(e,t,r);else a(e,t)}),t}function S(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,a=n.endsWith("?"),i=n.replace(/\?$/,"");if(0===r.length)return a?[i,""]:[i];let o=S(r.join("/")),s=[];return s.push(...o.map(e=>""===e?i:[i,e].join("/"))),a&&s.push(...o),s.map(t=>e.startsWith("/")&&""===t?"/":t)}const C=/^:[\w-]+$/,E=3,_=2,I=1,T=10,A=-2,R=e=>"*"===e;function D(e,t){let n=e.split("/"),r=n.length;return n.some(R)&&(r+=A),t&&(r+=_),n.filter(e=>!R(e)).reduce((e,t)=>e+(C.test(t)?E:""===t?I:T),r)}function F(e,t,n){void 0===n&&(n=!1);let{routesMeta:r}=e,a={},i="/",o=[];for(let s=0;s<r.length;++s){let e=r[s],l=s===r.length-1,c="/"===i?t:t.slice(i.length)||"/",u=O({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),h=e.route;if(!u&&l&&n&&!r[r.length-1].route.index&&(u=O({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(a,u.params),o.push({params:a,pathname:H([i,u.pathname]),pathnameBase:G(H([i,u.pathnameBase])),route:h}),"/"!==u.pathnameBase&&(i=H([i,u.pathnameBase]))}return o}function O(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);p("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)"));e.endsWith("*")?(r.push({paramName:"*"}),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))");let i=new RegExp(a,t?void 0:"i");return[i,r]}(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),s=a.slice(1),l=r.reduce((e,t,n)=>{let{paramName:r,isOptional:a}=t;if("*"===r){let e=s[n]||"";o=i.slice(0,i.length-e.length).replace(/(.)\/+$/,"$1")}const l=s[n];return e[r]=a&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{});return{params:l,pathname:i,pathnameBase:o,pattern:e}}function L(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return p(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function P(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}const M=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function j(e,t){void 0===t&&(t="/");let n,{pathname:r,search:a="",hash:i=""}="string"===typeof e?b(e):e;if(r)if((e=>M.test(e))(r))n=r;else{if(r.includes("//")){let e=r;r=r.replace(/\/\/+/g,"/"),p(!1,"Pathnames cannot have embedded double slashes - normalizing "+e+" -> "+r)}n=r.startsWith("/")?B(r.substring(1),"/"):B(r,t)}else n=t;return{pathname:n,search:q(a),hash:K(i)}}function B(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}function z(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function W(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function U(e,t){let n=W(e);return t?n.map((e,t)=>t===n.length-1?e.pathname:e.pathnameBase):n.map(e=>e.pathnameBase)}function V(e,t,n,r){let a;void 0===r&&(r=!1),"string"===typeof e?a=b(e):(a=h({},e),f(!a.pathname||!a.pathname.includes("?"),z("?","pathname","search",a)),f(!a.pathname||!a.pathname.includes("#"),z("#","pathname","hash",a)),f(!a.search||!a.search.includes("#"),z("#","search","hash",a)));let i,o=""===e||""===a.pathname,s=o?"/":a.pathname;if(null==s)i=n;else{let e=t.length-1;if(!r&&s.startsWith("..")){let t=s.split("/");for(;".."===t[0];)t.shift(),e-=1;a.pathname=t.join("/")}i=e>=0?t[e]:"/"}let l=j(a,i),c=s&&"/"!==s&&s.endsWith("/"),u=(o||"."===s)&&n.endsWith("/");return l.pathname.endsWith("/")||!c&&!u||(l.pathname+="/"),l}const H=e=>e.join("/").replace(/\/\/+/g,"/"),G=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),q=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",K=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function X(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const Y=["post","put","patch","delete"],J=(new Set(Y),["get",...Y]);new Set(J),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function Q(){return Q=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Q.apply(this,arguments)}const Z=l.createContext(null);const ee=l.createContext(null);const te=l.createContext(null);const ne=l.createContext(null);const re=l.createContext({outlet:null,matches:[],isDataRoute:!1});const ae=l.createContext(null);function ie(){return null!=l.useContext(ne)}function oe(){return ie()||f(!1),l.useContext(ne).location}function se(e){l.useContext(te).static||l.useLayoutEffect(e)}function le(){let{isDataRoute:e}=l.useContext(re);return e?function(){let{router:e}=xe(ve.UseNavigateStable),t=we(be.UseNavigateStable),n=l.useRef(!1);se(()=>{n.current=!0});let r=l.useCallback(function(r,a){void 0===a&&(a={}),n.current&&("number"===typeof r?e.navigate(r):e.navigate(r,Q({fromRouteId:t},a)))},[e,t]);return r}():function(){ie()||f(!1);let e=l.useContext(Z),{basename:t,future:n,navigator:r}=l.useContext(te),{matches:a}=l.useContext(re),{pathname:i}=oe(),o=JSON.stringify(U(a,n.v7_relativeSplatPath)),s=l.useRef(!1);se(()=>{s.current=!0});let c=l.useCallback(function(n,a){if(void 0===a&&(a={}),!s.current)return;if("number"===typeof n)return void r.go(n);let l=V(n,JSON.parse(o),i,"path"===a.relative);null==e&&"/"!==t&&(l.pathname="/"===l.pathname?t:H([t,l.pathname])),(a.replace?r.replace:r.push)(l,a.state,a)},[t,r,o,i,e]);return c}()}function ce(){let{matches:e}=l.useContext(re),t=e[e.length-1];return t?t.params:{}}function ue(e,t){let{relative:n}=void 0===t?{}:t,{future:r}=l.useContext(te),{matches:a}=l.useContext(re),{pathname:i}=oe(),o=JSON.stringify(U(a,r.v7_relativeSplatPath));return l.useMemo(()=>V(e,JSON.parse(o),i,"path"===n),[e,o,i,n])}function he(e,t,n,r){ie()||f(!1);let{navigator:a}=l.useContext(te),{matches:i}=l.useContext(re),o=i[i.length-1],c=o?o.params:{},u=(o&&o.pathname,o?o.pathnameBase:"/");o&&o.route;let h,d=oe();if(t){var p;let e="string"===typeof t?b(t):t;"/"===u||(null==(p=e.pathname)?void 0:p.startsWith(u))||f(!1),h=e}else h=d;let g=h.pathname||"/",m=g;if("/"!==u){let e=u.replace(/^\//,"").split("/");m="/"+g.replace(/^\//,"").split("/").slice(e.length).join("/")}let v=w(e,{pathname:m});let x=me(v&&v.map(e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:H([u,a.encodeLocation?a.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?u:H([u,a.encodeLocation?a.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),i,n,r);return t&&x?l.createElement(ne.Provider,{value:{location:Q({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:s.Pop}},x):x}function de(){let e=function(){var e;let t=l.useContext(ae),n=ye(be.UseRouteError),r=we(be.UseRouteError);if(void 0!==t)return t;return null==(e=n.errors)?void 0:e[r]}(),t=X(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r};return l.createElement(l.Fragment,null,l.createElement("h2",null,"Unexpected Application Error!"),l.createElement("h3",{style:{fontStyle:"italic"}},t),n?l.createElement("pre",{style:a},n):null,null)}const fe=l.createElement(de,null);class pe extends l.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?l.createElement(re.Provider,{value:this.props.routeContext},l.createElement(ae.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ge(e){let{routeContext:t,match:n,children:r}=e,a=l.useContext(Z);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),l.createElement(re.Provider,{value:t},r)}function me(e,t,n,r){var a;if(void 0===t&&(t=[]),void 0===n&&(n=null),void 0===r&&(r=null),null==e){var i;if(!n)return null;if(n.errors)e=n.matches;else{if(!(null!=(i=r)&&i.v7_partialHydration&&0===t.length&&!n.initialized&&n.matches.length>0))return null;e=n.matches}}let o=e,s=null==(a=n)?void 0:a.errors;if(null!=s){let e=o.findIndex(e=>e.route.id&&void 0!==(null==s?void 0:s[e.route.id]));e>=0||f(!1),o=o.slice(0,Math.min(o.length,e+1))}let c=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let l=0;l<o.length;l++){let e=o[l];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(u=l),e.route.id){let{loaderData:t,errors:r}=n,a=e.route.loader&&void 0===t[e.route.id]&&(!r||void 0===r[e.route.id]);if(e.route.lazy||a){c=!0,o=u>=0?o.slice(0,u+1):[o[0]];break}}}return o.reduceRight((e,r,a)=>{let i,h=!1,d=null,f=null;var p;n&&(i=s&&r.route.id?s[r.route.id]:void 0,d=r.route.errorElement||fe,c&&(u<0&&0===a?(p="route-fallback",!1||ke[p]||(ke[p]=!0),h=!0,f=null):u===a&&(h=!0,f=r.route.hydrateFallbackElement||null)));let g=t.concat(o.slice(0,a+1)),m=()=>{let t;return t=i?d:h?f:r.route.Component?l.createElement(r.route.Component,null):r.route.element?r.route.element:e,l.createElement(ge,{match:r,routeContext:{outlet:e,matches:g,isDataRoute:null!=n},children:t})};return n&&(r.route.ErrorBoundary||r.route.errorElement||0===a)?l.createElement(pe,{location:n.location,revalidation:n.revalidation,component:d,error:i,children:m(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):m()},null)}var ve=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(ve||{}),be=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(be||{});function xe(e){let t=l.useContext(Z);return t||f(!1),t}function ye(e){let t=l.useContext(ee);return t||f(!1),t}function we(e){let t=function(){let e=l.useContext(re);return e||f(!1),e}(),n=t.matches[t.matches.length-1];return n.route.id||f(!1),n.route.id}const ke={};function Ne(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}c.startTransition;function Se(e){let{to:t,replace:n,state:r,relative:a}=e;ie()||f(!1);let{future:i,static:o}=l.useContext(te),{matches:s}=l.useContext(re),{pathname:c}=oe(),u=le(),h=V(t,U(s,i.v7_relativeSplatPath),c,"path"===a),d=JSON.stringify(h);return l.useEffect(()=>u(JSON.parse(d),{replace:n,state:r,relative:a}),[u,d,a,n,r]),null}function Ce(e){f(!1)}function Ee(e){let{basename:t="/",children:n=null,location:r,navigationType:a=s.Pop,navigator:i,static:o=!1,future:c}=e;ie()&&f(!1);let u=t.replace(/^\/*/,"/"),h=l.useMemo(()=>({basename:u,navigator:i,static:o,future:Q({v7_relativeSplatPath:!1},c)}),[u,c,i,o]);"string"===typeof r&&(r=b(r));let{pathname:d="/",search:p="",hash:g="",state:m=null,key:v="default"}=r,x=l.useMemo(()=>{let e=P(d,u);return null==e?null:{location:{pathname:e,search:p,hash:g,state:m,key:v},navigationType:a}},[u,d,p,g,m,v,a]);return null==x?null:l.createElement(te.Provider,{value:h},l.createElement(ne.Provider,{children:n,value:x}))}function _e(e){let{children:t,location:n}=e;return he(Ie(t),n)}new Promise(()=>{});l.Component;function Ie(e,t){void 0===t&&(t=[]);let n=[];return l.Children.forEach(e,(e,r)=>{if(!l.isValidElement(e))return;let a=[...t,r];if(e.type===l.Fragment)return void n.push.apply(n,Ie(e.props.children,a));e.type!==Ce&&f(!1),e.props.index&&e.props.children&&f(!1);let i={id:e.props.id||a.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(i.children=Ie(e.props.children,a)),n.push(i)}),n}var Te=n(7950),Ae=n.t(Te,2);function Re(){return Re=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Re.apply(this,arguments)}function De(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const Fe=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Oe=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"];try{window.__reactRouterVersion="6"}catch(ci){}const Le=l.createContext({isTransitioning:!1});new Map;const Pe=c.startTransition;Ae.flushSync,c.useId;function Me(e){let{basename:t,children:n,future:r,window:a}=e,i=l.useRef();var o;null==i.current&&(i.current=(void 0===(o={window:a,v5Compat:!0})&&(o={}),x(function(e,t){let{pathname:n,search:r,hash:a}=e.location;return m("",{pathname:n,search:r,hash:a},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:v(t)},null,o)));let s=i.current,[c,u]=l.useState({action:s.action,location:s.location}),{v7_startTransition:h}=r||{},d=l.useCallback(e=>{h&&Pe?Pe(()=>u(e)):u(e)},[u,h]);return l.useLayoutEffect(()=>s.listen(d),[s,d]),l.useEffect(()=>Ne(r),[r]),l.createElement(Ee,{basename:t,children:n,location:c.location,navigationType:c.action,navigator:s,future:r})}const je="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,Be=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ze=l.forwardRef(function(e,t){let n,{onClick:r,relative:a,reloadDocument:i,replace:o,state:s,target:c,to:u,preventScrollReset:h,viewTransition:d}=e,p=De(e,Fe),{basename:g}=l.useContext(te),m=!1;if("string"===typeof u&&Be.test(u)&&(n=u,je))try{let e=new URL(window.location.href),t=u.startsWith("//")?new URL(e.protocol+u):new URL(u),n=P(t.pathname,g);t.origin===e.origin&&null!=n?u=n+t.search+t.hash:m=!0}catch(ci){}let b=function(e,t){let{relative:n}=void 0===t?{}:t;ie()||f(!1);let{basename:r,navigator:a}=l.useContext(te),{hash:i,pathname:o,search:s}=ue(e,{relative:n}),c=o;return"/"!==r&&(c="/"===o?r:H([r,o])),a.createHref({pathname:c,search:s,hash:i})}(u,{relative:a}),x=function(e,t){let{target:n,replace:r,state:a,preventScrollReset:i,relative:o,viewTransition:s}=void 0===t?{}:t,c=le(),u=oe(),h=ue(e,{relative:o});return l.useCallback(t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,n)){t.preventDefault();let n=void 0!==r?r:v(u)===v(h);c(e,{replace:n,state:a,preventScrollReset:i,relative:o,viewTransition:s})}},[u,c,h,r,a,n,e,i,o,s])}(u,{replace:o,state:s,target:c,preventScrollReset:h,relative:a,viewTransition:d});return l.createElement("a",Re({},p,{href:n||b,onClick:m||i?r:function(e){r&&r(e),e.defaultPrevented||x(e)},ref:t,target:c}))});const We=l.forwardRef(function(e,t){let{"aria-current":n="page",caseSensitive:r=!1,className:a="",end:i=!1,style:o,to:s,viewTransition:c,children:u}=e,h=De(e,Oe),d=ue(s,{relative:h.relative}),p=oe(),g=l.useContext(ee),{navigator:m,basename:v}=l.useContext(te),b=null!=g&&function(e,t){void 0===t&&(t={});let n=l.useContext(Le);null==n&&f(!1);let{basename:r}=He(Ue.useViewTransitionState),a=ue(e,{relative:t.relative});if(!n.isTransitioning)return!1;let i=P(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=P(n.nextLocation.pathname,r)||n.nextLocation.pathname;return null!=O(a.pathname,o)||null!=O(a.pathname,i)}(d)&&!0===c,x=m.encodeLocation?m.encodeLocation(d).pathname:d.pathname,y=p.pathname,w=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;r||(y=y.toLowerCase(),w=w?w.toLowerCase():null,x=x.toLowerCase()),w&&v&&(w=P(w,v)||w);const k="/"!==x&&x.endsWith("/")?x.length-1:x.length;let N,S=y===x||!i&&y.startsWith(x)&&"/"===y.charAt(k),C=null!=w&&(w===x||!i&&w.startsWith(x)&&"/"===w.charAt(x.length)),E={isActive:S,isPending:C,isTransitioning:b},_=S?n:void 0;N="function"===typeof a?a(E):[a,S?"active":null,C?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let I="function"===typeof o?o(E):o;return l.createElement(ze,Re({},h,{"aria-current":_,className:N,ref:t,style:I,to:s,viewTransition:c}),"function"===typeof u?u(E):u)});var Ue,Ve;function He(e){let t=l.useContext(Z);return t||f(!1),t}(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Ue||(Ue={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Ve||(Ve={}));var Ge={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},qe=l.createContext&&l.createContext(Ge),Ke=["attr","size","title"];function Xe(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function Ye(){return Ye=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ye.apply(this,arguments)}function $e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$e(Object(n),!0).forEach(function(t){Qe(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$e(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Qe(e,t,n){return t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ze(e){return e&&e.map((e,t)=>l.createElement(e.tag,Je({key:t},e.attr),Ze(e.child)))}function et(e){return t=>l.createElement(tt,Ye({attr:Je({},e.attr)},t),Ze(e.child))}function tt(e){var t=t=>{var n,{attr:r,size:a,title:i}=e,o=Xe(e,Ke),s=a||t.size||"1em";return t.className&&(n=t.className),e.className&&(n=(n?n+" ":"")+e.className),l.createElement("svg",Ye({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,o,{className:n,style:Je(Je({color:e.color||t.color},t.style),e.style),height:s,width:s,xmlns:"http://www.w3.org/2000/svg"}),i&&l.createElement("title",null,i),e.children)};return void 0!==qe?l.createElement(qe.Consumer,null,e=>t(e)):t(Ge)}function nt(e){return et({tag:"svg",attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M143 352.3L7 216.3c-9.4-9.4-9.4-24.6 0-33.9l22.6-22.6c9.4-9.4 24.6-9.4 33.9 0l96.4 96.4 96.4-96.4c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9l-136 136c-9.2 9.4-24.4 9.4-33.8 0z"},child:[]}]})(e)}function rt(e){return et({tag:"svg",attr:{viewBox:"0 0 256 512"},child:[{tag:"path",attr:{d:"M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9 0l-22.6-22.6c-9.4-9.4-9.4-24.6 0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6 0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9 0l136 136c9.5 9.4 9.5 24.6.1 34z"},child:[]}]})(e)}function at(e){return et({tag:"svg",attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M177 159.7l136 136c9.4 9.4 9.4 24.6 0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9 0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9 0L7 329.7c-9.4-9.4-9.4-24.6 0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"},child:[]}]})(e)}function it(e){return et({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0L7 273c-9.4-9.4-9.4-24.6 0-33.9L201.4 44.7c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-.4 34.3L136.6 216H424c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24H136.6l120.5 114.8c9.8 9.3 10 24.8.4 34.3z"},child:[]}]})(e)}function ot(e){return et({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119.034 8 8 119.033 8 256s111.034 248 248 248 248-111.034 248-248S392.967 8 256 8zm130.108 117.892c65.448 65.448 70 165.481 20.677 235.637L150.47 105.216c70.204-49.356 170.226-44.735 235.638 20.676zM125.892 386.108c-65.448-65.448-70-165.481-20.677-235.637L361.53 406.784c-70.203 49.356-170.226 44.736-235.638-20.676z"},child:[]}]})(e)}function st(e){return et({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"},child:[]}]})(e)}function lt(e){return et({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 512c35.32 0 63.97-28.65 63.97-64H160.03c0 35.35 28.65 64 63.97 64zm215.39-149.71c-19.32-20.76-55.47-51.99-55.47-154.29 0-77.7-54.48-139.9-127.94-155.16V32c0-17.67-14.32-32-31.98-32s-31.98 14.33-31.98 32v20.84C118.56 68.1 64.08 130.3 64.08 208c0 102.3-36.15 133.53-55.47 154.29-6 6.45-8.66 14.16-8.61 21.71.11 16.4 12.98 32 32.1 32h383.8c19.12 0 32-15.6 32.1-32 .05-7.55-2.61-15.27-8.61-21.71z"},child:[]}]})(e)}function ct(e){return et({tag:"svg",attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M296 160H180.6l42.6-129.8C227.2 15 215.7 0 200 0H56C44 0 33.8 8.9 32.2 20.8l-32 240C-1.7 275.2 9.5 288 24 288h118.7L96.6 482.5c-3.6 15.2 8 29.5 23.3 29.5 8.4 0 16.4-4.4 20.8-12l176-304c9.3-15.9-2.2-36-20.7-36z"},child:[]}]})(e)}function ut(e){return et({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M436 480h-20V24c0-13.255-10.745-24-24-24H56C42.745 0 32 10.745 32 24v456H12c-6.627 0-12 5.373-12 12v20h448v-20c0-6.627-5.373-12-12-12zM128 76c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12V76zm0 96c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40zm52 148h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12zm76 160h-64v-84c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v84zm64-172c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40zm0-96c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40zm0-96c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12V76c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40z"},child:[]}]})(e)}function ht(e){return et({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M0 464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V192H0v272zm320-196c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM192 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM64 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zM400 64h-48V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H160V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H48C21.5 64 0 85.5 0 112v48h448v-48c0-26.5-21.5-48-48-48z"},child:[]}]})(e)}function dt(e){return et({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M436 160H12c-6.627 0-12-5.373-12-12v-36c0-26.51 21.49-48 48-48h48V12c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v52h128V12c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v52h48c26.51 0 48 21.49 48 48v36c0 6.627-5.373 12-12 12zM12 192h424c6.627 0 12 5.373 12 12v260c0 26.51-21.49 48-48 48H48c-26.51 0-48-21.49-48-48V204c0-6.627 5.373-12 12-12zm333.296 95.947l-28.169-28.398c-4.667-4.705-12.265-4.736-16.97-.068L194.12 364.665l-45.98-46.352c-4.667-4.705-12.266-4.736-16.971-.068l-28.397 28.17c-4.705 4.667-4.736 12.265-.068 16.97l82.601 83.269c4.667 4.705 12.265 4.736 16.97.068l142.953-141.805c4.705-4.667 4.736-12.265.068-16.97z"},child:[]}]})(e)}function ft(e){return et({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M512 144v288c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V144c0-26.5 21.5-48 48-48h88l12.3-32.9c7-18.7 24.9-31.1 44.9-31.1h125.5c20 0 37.9 12.4 44.9 31.1L376 96h88c26.5 0 48 21.5 48 48zM376 288c0-66.2-53.8-120-120-120s-120 53.8-120 120 53.8 120 120 120 120-53.8 120-120zm-32 0c0 48.5-39.5 88-88 88s-88-39.5-88-88 39.5-88 88-88 88 39.5 88 88z"},child:[]}]})(e)}function pt(e){return et({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M496 384H64V80c0-8.84-7.16-16-16-16H16C7.16 64 0 71.16 0 80v336c0 17.67 14.33 32 32 32h464c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16zM464 96H345.94c-21.38 0-32.09 25.85-16.97 40.97l32.4 32.4L288 242.75l-73.37-73.37c-12.5-12.5-32.76-12.5-45.25 0l-68.69 68.69c-6.25 6.25-6.25 16.38 0 22.63l22.62 22.62c6.25 6.25 16.38 6.25 22.63 0L192 237.25l73.37 73.37c12.5 12.5 32.76 12.5 45.25 0l96-96 32.4 32.4c15.12 15.12 40.97 4.41 40.97-16.97V112c.01-8.84-7.15-16-15.99-16z"},child:[]}]})(e)}function gt(e){return et({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"},child:[]}]})(e)}function mt(e){return et({tag:"svg",attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"},child:[]}]})(e)}function vt(e){return et({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M336 64h-80c0-35.3-28.7-64-64-64s-64 28.7-64 64H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zM96 424c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm96-192c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zm128 368c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16z"},child:[]}]})(e)}function bt(e){return et({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256,8C119,8,8,119,8,256S119,504,256,504,504,393,504,256,393,8,256,8Zm92.49,313h0l-20,25a16,16,0,0,1-22.49,2.5h0l-67-49.72a40,40,0,0,1-15-31.23V112a16,16,0,0,1,16-16h32a16,16,0,0,1,16,16V256l58,42.5A16,16,0,0,1,348.49,321Z"},child:[]}]})(e)}function xt(e){return et({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(e)}function yt(e){return et({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M512.1 191l-8.2 14.3c-3 5.3-9.4 7.5-15.1 5.4-11.8-4.4-22.6-10.7-32.1-18.6-4.6-3.8-5.8-10.5-2.8-15.7l8.2-14.3c-6.9-8-12.3-17.3-15.9-27.4h-16.5c-6 0-11.2-4.3-12.2-10.3-2-12-2.1-24.6 0-37.1 1-6 6.2-10.4 12.2-10.4h16.5c3.6-10.1 9-19.4 15.9-27.4l-8.2-14.3c-3-5.2-1.9-11.9 2.8-15.7 9.5-7.9 20.4-14.2 32.1-18.6 5.7-2.1 12.1.1 15.1 5.4l8.2 14.3c10.5-1.9 21.2-1.9 31.7 0L552 6.3c3-5.3 9.4-7.5 15.1-5.4 11.8 4.4 22.6 10.7 32.1 18.6 4.6 3.8 5.8 10.5 2.8 15.7l-8.2 14.3c6.9 8 12.3 17.3 15.9 27.4h16.5c6 0 11.2 4.3 12.2 10.3 2 12 2.1 24.6 0 37.1-1 6-6.2 10.4-12.2 10.4h-16.5c-3.6 10.1-9 19.4-15.9 27.4l8.2 14.3c3 5.2 1.9 11.9-2.8 15.7-9.5 7.9-20.4 14.2-32.1 18.6-5.7 2.1-12.1-.1-15.1-5.4l-8.2-14.3c-10.4 1.9-21.2 1.9-31.7 0zm-10.5-58.8c38.5 29.6 82.4-14.3 52.8-52.8-38.5-29.7-82.4 14.3-52.8 52.8zM386.3 286.1l33.7 16.8c10.1 5.8 14.5 18.1 10.5 29.1-8.9 24.2-26.4 46.4-42.6 65.8-7.4 8.9-20.2 11.1-30.3 5.3l-29.1-16.8c-16 13.7-34.6 24.6-54.9 31.7v33.6c0 11.6-8.3 21.6-19.7 23.6-24.6 4.2-50.4 4.4-75.9 0-11.5-2-20-11.9-20-23.6V418c-20.3-7.2-38.9-18-54.9-31.7L74 403c-10 5.8-22.9 3.6-30.3-5.3-16.2-19.4-33.3-41.6-42.2-65.7-4-10.9.4-23.2 10.5-29.1l33.3-16.8c-3.9-20.9-3.9-42.4 0-63.4L12 205.8c-10.1-5.8-14.6-18.1-10.5-29 8.9-24.2 26-46.4 42.2-65.8 7.4-8.9 20.2-11.1 30.3-5.3l29.1 16.8c16-13.7 34.6-24.6 54.9-31.7V57.1c0-11.5 8.2-21.5 19.6-23.5 24.6-4.2 50.5-4.4 76-.1 11.5 2 20 11.9 20 23.6v33.6c20.3 7.2 38.9 18 54.9 31.7l29.1-16.8c10-5.8 22.9-3.6 30.3 5.3 16.2 19.4 33.2 41.6 42.1 65.8 4 10.9.1 23.2-10 29.1l-33.7 16.8c3.9 21 3.9 42.5 0 63.5zm-117.6 21.1c59.2-77-28.7-164.9-105.7-105.7-59.2 77 28.7 164.9 105.7 105.7zm243.4 182.7l-8.2 14.3c-3 5.3-9.4 7.5-15.1 5.4-11.8-4.4-22.6-10.7-32.1-18.6-4.6-3.8-5.8-10.5-2.8-15.7l8.2-14.3c-6.9-8-12.3-17.3-15.9-27.4h-16.5c-6 0-11.2-4.3-12.2-10.3-2-12-2.1-24.6 0-37.1 1-6 6.2-10.4 12.2-10.4h16.5c3.6-10.1 9-19.4 15.9-27.4l-8.2-14.3c-3-5.2-1.9-11.9 2.8-15.7 9.5-7.9 20.4-14.2 32.1-18.6 5.7-2.1 12.1.1 15.1 5.4l8.2 14.3c10.5-1.9 21.2-1.9 31.7 0l8.2-14.3c3-5.3 9.4-7.5 15.1-5.4 11.8 4.4 22.6 10.7 32.1 18.6 4.6 3.8 5.8 10.5 2.8 15.7l-8.2 14.3c6.9 8 12.3 17.3 15.9 27.4h16.5c6 0 11.2 4.3 12.2 10.3 2 12 2.1 24.6 0 37.1-1 6-6.2 10.4-12.2 10.4h-16.5c-3.6 10.1-9 19.4-15.9 27.4l8.2 14.3c3 5.2 1.9 11.9-2.8 15.7-9.5 7.9-20.4 14.2-32.1 18.6-5.7 2.1-12.1-.1-15.1-5.4l-8.2-14.3c-10.4 1.9-21.2 1.9-31.7 0zM501.6 431c38.5 29.6 82.4-14.3 52.8-52.8-38.5-29.6-82.4 14.3-52.8 52.8z"},child:[]}]})(e)}function wt(e){return et({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M0 432c0 26.5 21.5 48 48 48h480c26.5 0 48-21.5 48-48V256H0v176zm192-68c0-6.6 5.4-12 12-12h136c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H204c-6.6 0-12-5.4-12-12v-40zm-128 0c0-6.6 5.4-12 12-12h72c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zM576 80v48H0V80c0-26.5 21.5-48 48-48h480c26.5 0 48 21.5 48 48z"},child:[]}]})(e)}function kt(e){return et({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M528 448H112c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h416c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16zm64-320c-26.5 0-48 21.5-48 48 0 7.1 1.6 13.7 4.4 19.8L476 239.2c-15.4 9.2-35.3 4-44.2-11.6L350.3 85C361 76.2 368 63 368 48c0-26.5-21.5-48-48-48s-48 21.5-48 48c0 15 7 28.2 17.7 37l-81.5 142.6c-8.9 15.6-28.9 20.8-44.2 11.6l-72.3-43.4c2.7-6 4.4-12.7 4.4-19.8 0-26.5-21.5-48-48-48S0 149.5 0 176s21.5 48 48 48c2.6 0 5.2-.4 7.7-.8L128 416h384l72.3-192.8c2.5.4 5.1.8 7.7.8 26.5 0 48-21.5 48-48s-21.5-48-48-48z"},child:[]}]})(e)}function Nt(e){return et({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M104 96H56c-13.3 0-24 10.7-24 24v104H8c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h24v104c0 13.3 10.7 24 24 24h48c13.3 0 24-10.7 24-24V120c0-13.3-10.7-24-24-24zm528 128h-24V120c0-13.3-10.7-24-24-24h-48c-13.3 0-24 10.7-24 24v272c0 13.3 10.7 24 24 24h48c13.3 0 24-10.7 24-24V288h24c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM456 32h-48c-13.3 0-24 10.7-24 24v168H256V56c0-13.3-10.7-24-24-24h-48c-13.3 0-24 10.7-24 24v400c0 13.3 10.7 24 24 24h48c13.3 0 24-10.7 24-24V288h128v168c0 13.3 10.7 24 24 24h48c13.3 0 24-10.7 24-24V56c0-13.3-10.7-24-24-24z"},child:[]}]})(e)}function St(e){return et({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"},child:[]}]})(e)}function Ct(e){return et({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"},child:[]}]})(e)}function Et(e){return et({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},child:[]}]})(e)}function _t(e){return et({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M320 400c-75.85 0-137.25-58.71-142.9-133.11L72.2 185.82c-13.79 17.3-26.48 35.59-36.72 55.59a32.35 32.35 0 0 0 0 29.19C89.71 376.41 197.07 448 320 448c26.91 0 52.87-4 77.89-10.46L346 397.39a144.13 144.13 0 0 1-26 2.61zm313.82 58.1l-110.55-85.44a331.25 331.25 0 0 0 81.25-102.07 32.35 32.35 0 0 0 0-29.19C550.29 135.59 442.93 64 320 64a308.15 308.15 0 0 0-147.32 37.7L45.46 3.37A16 16 0 0 0 23 6.18L3.37 31.45A16 16 0 0 0 6.18 53.9l588.36 454.73a16 16 0 0 0 22.46-2.81l19.64-25.27a16 16 0 0 0-2.82-22.45zm-183.72-142l-39.3-30.38A94.75 94.75 0 0 0 416 256a94.76 94.76 0 0 0-121.31-92.21A47.65 47.65 0 0 1 304 192a46.64 46.64 0 0 1-1.54 10l-73.61-56.89A142.31 142.31 0 0 1 320 112a143.92 143.92 0 0 1 144 144c0 21.63-5.29 41.79-13.9 60.11z"},child:[]}]})(e)}function It(e){return et({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"},child:[]}]})(e)}function Tt(e){return et({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm60.1 106.5L224 336l60.1 93.5c5.1 8-.6 18.5-10.1 18.5h-34.9c-4.4 0-8.5-2.4-10.6-6.3C208.9 405.5 192 373 192 373c-6.4 14.8-10 20-36.6 68.8-2.1 3.9-6.1 6.3-10.5 6.3H110c-9.5 0-15.2-10.5-10.1-18.5l60.3-93.5-60.3-93.5c-5.2-8 .6-18.5 10.1-18.5h34.8c4.4 0 8.5 2.4 10.6 6.3 26.1 48.8 20 33.6 36.6 68.5 0 0 6.1-11.7 36.6-68.5 2.1-3.9 6.2-6.3 10.6-6.3H274c9.5-.1 15.2 10.4 10.1 18.4zM384 121.9v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"},child:[]}]})(e)}function At(e){return et({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M377 105L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9zm-153 31V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zM64 72c0-4.42 3.58-8 8-8h80c4.42 0 8 3.58 8 8v16c0 4.42-3.58 8-8 8H72c-4.42 0-8-3.58-8-8V72zm0 80v-16c0-4.42 3.58-8 8-8h80c4.42 0 8 3.58 8 8v16c0 4.42-3.58 8-8 8H72c-4.42 0-8-3.58-8-8zm144 263.88V440c0 4.42-3.58 8-8 8h-16c-4.42 0-8-3.58-8-8v-24.29c-11.29-.58-22.27-4.52-31.37-11.35-3.9-2.93-4.1-8.77-.57-12.14l11.75-11.21c2.77-2.64 6.89-2.76 10.13-.73 3.87 2.42 8.26 3.72 12.82 3.72h28.11c6.5 0 11.8-5.92 11.8-13.19 0-5.95-3.61-11.19-8.77-12.73l-45-13.5c-18.59-5.58-31.58-23.42-31.58-43.39 0-24.52 19.05-44.44 42.67-45.07V232c0-4.42 3.58-8 8-8h16c4.42 0 8 3.58 8 8v24.29c11.29.58 22.27 4.51 31.37 11.35 3.9 2.93 4.1 8.77.57 12.14l-11.75 11.21c-2.77 2.64-6.89 2.76-10.13.73-3.87-2.43-8.26-3.72-12.82-3.72h-28.11c-6.5 0-11.8 5.92-11.8 13.19 0 5.95 3.61 11.19 8.77 12.73l45 13.5c18.59 5.58 31.58 23.42 31.58 43.39 0 24.53-19.05 44.44-42.67 45.07z"},child:[]}]})(e)}function Rt(e){return et({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M181.9 256.1c-5-16-4.9-46.9-2-46.9 8.4 0 7.6 36.9 2 46.9zm-1.7 47.2c-7.7 20.2-17.3 43.3-28.4 62.7 18.3-7 39-17.2 62.9-21.9-12.7-9.6-24.9-23.4-34.5-40.8zM86.1 428.1c0 .8 13.2-5.4 34.9-40.2-6.7 6.3-29.1 24.5-34.9 40.2zM248 160h136v328c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V24C0 10.7 10.7 0 24 0h200v136c0 13.2 10.8 24 24 24zm-8 171.8c-20-12.2-33.3-29-42.7-53.8 4.5-18.5 11.6-46.6 6.2-64.2-4.7-29.4-42.4-26.5-47.8-6.8-5 18.3-.4 44.1 8.1 77-11.6 27.6-28.7 64.6-40.8 85.8-.1 0-.1.1-.2.1-27.1 13.9-73.6 44.5-54.5 68 5.6 6.9 16 10 21.5 10 17.9 0 35.7-18 61.1-61.8 25.8-8.5 54.1-19.1 79-23.2 21.7 11.8 47.1 19.5 64 19.5 29.2 0 31.2-32 19.7-43.4-13.9-13.6-54.3-9.7-73.6-7.2zM377 105L279 7c-4.5-4.5-10.6-7-17-7h-6v128h128v-6.1c0-6.3-2.5-12.4-7-16.9zm-74.1 255.3c4.1-2.7-2.5-11.9-42.8-9 37.1 15.8 42.8 9 42.8 9z"},child:[]}]})(e)}function Dt(e){return et({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.976 0H24.028C2.71 0-8.047 25.866 7.058 40.971L192 225.941V432c0 7.831 3.821 15.17 10.237 19.662l80 55.98C298.02 518.69 320 507.493 320 487.98V225.941l184.947-184.97C520.021 25.896 509.338 0 487.976 0z"},child:[]}]})(e)}function Ft(e){return et({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z"},child:[]}]})(e)}function Ot(e){return et({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"},child:[]}]})(e)}function Lt(e){return et({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M528 32H48C21.5 32 0 53.5 0 80v16h576V80c0-26.5-21.5-48-48-48zM0 432c0 26.5 21.5 48 48 48h480c26.5 0 48-21.5 48-48V128H0v304zm352-232c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16c0 4.4-3.6 8-8 8H360c-4.4 0-8-3.6-8-8v-16zm0 64c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16c0 4.4-3.6 8-8 8H360c-4.4 0-8-3.6-8-8v-16zm0 64c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16c0 4.4-3.6 8-8 8H360c-4.4 0-8-3.6-8-8v-16zM176 192c35.3 0 64 28.7 64 64s-28.7 64-64 64-64-28.7-64-64 28.7-64 64-64zM67.1 396.2C75.5 370.5 99.6 352 128 352h8.2c12.3 5.1 25.7 8 39.8 8s27.6-2.9 39.8-8h8.2c28.4 0 52.5 18.5 60.9 44.2 3.2 9.9-5.2 19.8-15.6 19.8H82.7c-10.4 0-18.8-10-15.6-19.8z"},child:[]}]})(e)}function Pt(e){return et({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"},child:[]}]})(e)}function Mt(e){return et({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M464 480H48c-26.51 0-48-21.49-48-48V80c0-26.51 21.49-48 48-48h416c26.51 0 48 21.49 48 48v352c0 26.51-21.49 48-48 48zM128 120c-22.091 0-40 17.909-40 40s17.909 40 40 40 40-17.909 40-40-17.909-40-40-40zm0 96c-22.091 0-40 17.909-40 40s17.909 40 40 40 40-17.909 40-40-17.909-40-40-40zm0 96c-22.091 0-40 17.909-40 40s17.909 40 40 40 40-17.909 40-40-17.909-40-40-40zm288-136v-32c0-6.627-5.373-12-12-12H204c-6.627 0-12 5.373-12 12v32c0 6.627 5.373 12 12 12h200c6.627 0 12-5.373 12-12zm0 96v-32c0-6.627-5.373-12-12-12H204c-6.627 0-12 5.373-12 12v32c0 6.627 5.373 12 12 12h200c6.627 0 12-5.373 12-12zm0 96v-32c0-6.627-5.373-12-12-12H204c-6.627 0-12 5.373-12 12v32c0 6.627 5.373 12 12 12h200c6.627 0 12-5.373 12-12z"},child:[]}]})(e)}function jt(e){return et({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M400 224h-24v-72C376 68.2 307.8 0 224 0S72 68.2 72 152v72H48c-26.5 0-48 21.5-48 48v192c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V272c0-26.5-21.5-48-48-48zm-104 0H152v-72c0-39.7 32.3-72 72-72s72 32.3 72 72v72z"},child:[]}]})(e)}function Bt(e){return et({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M223.75 130.75L154.62 15.54A31.997 31.997 0 0 0 127.18 0H16.03C3.08 0-4.5 14.57 2.92 25.18l111.27 158.96c29.72-27.77 67.52-46.83 109.56-53.39zM495.97 0H384.82c-11.24 0-21.66 5.9-27.44 15.54l-69.13 115.21c42.04 6.56 79.84 25.62 109.56 53.38L509.08 25.18C516.5 14.57 508.92 0 495.97 0zM256 160c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm92.52 157.26l-37.93 36.96 8.97 52.22c1.6 9.36-8.26 16.51-16.65 12.09L256 393.88l-46.9 24.65c-8.4 4.45-18.25-2.74-16.65-12.09l8.97-52.22-37.93-36.96c-6.82-6.64-3.05-18.23 6.35-19.59l52.43-7.64 23.43-47.52c2.11-4.28 6.19-6.39 10.28-6.39 4.11 0 8.22 2.14 10.33 6.39l23.43 47.52 52.43 7.64c9.4 1.36 13.17 12.95 6.35 19.59z"},child:[]}]})(e)}function zt(e){return et({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M621.16 54.46C582.37 38.19 543.55 32 504.75 32c-123.17-.01-246.33 62.34-369.5 62.34-30.89 0-61.76-3.92-92.65-13.72-3.47-1.1-6.95-1.62-10.35-1.62C15.04 79 0 92.32 0 110.81v317.26c0 12.63 7.23 24.6 18.84 29.46C57.63 473.81 96.45 480 135.25 480c123.17 0 246.34-62.35 369.51-62.35 30.89 0 61.76 3.92 92.65 13.72 3.47 1.1 6.95 1.62 10.35 1.62 17.21 0 32.25-13.32 32.25-31.81V83.93c-.01-12.64-7.24-24.6-18.85-29.47zM48 132.22c20.12 5.04 41.12 7.57 62.72 8.93C104.84 170.54 79 192.69 48 192.69v-60.47zm0 285v-47.78c34.37 0 62.18 27.27 63.71 61.4-22.53-1.81-43.59-6.31-63.71-13.62zM320 352c-44.19 0-80-42.99-80-96 0-53.02 35.82-96 80-96s80 42.98 80 96c0 53.03-35.83 96-80 96zm272 27.78c-17.52-4.39-35.71-6.85-54.32-8.44 5.87-26.08 27.5-45.88 54.32-49.28v57.72zm0-236.11c-30.89-3.91-54.86-29.7-55.81-61.55 19.54 2.17 38.09 6.23 55.81 12.66v48.89z"},child:[]}]})(e)}function Wt(e){return et({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M608 64H32C14.33 64 0 78.33 0 96v320c0 17.67 14.33 32 32 32h576c17.67 0 32-14.33 32-32V96c0-17.67-14.33-32-32-32zM48 400v-64c35.35 0 64 28.65 64 64H48zm0-224v-64h64c0 35.35-28.65 64-64 64zm272 176c-44.19 0-80-42.99-80-96 0-53.02 35.82-96 80-96s80 42.98 80 96c0 53.03-35.83 96-80 96zm272 48h-64c0-35.35 28.65-64 64-64v64zm0-224c-35.35 0-64-28.65-64-64h64v64z"},child:[]}]})(e)}function Ut(e){return et({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M283.211 512c78.962 0 151.079-35.925 198.857-94.792 7.068-8.708-.639-21.43-11.562-19.35-124.203 23.654-238.262-71.576-238.262-196.954 0-72.222 38.662-138.635 101.498-174.394 9.686-5.512 7.25-20.197-3.756-22.23A258.156 258.156 0 0 0 283.211 0c-141.309 0-256 114.511-256 256 0 141.309 114.511 256 256 256z"},child:[]}]})(e)}function Vt(e){return et({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"},child:[]}]})(e)}function Ht(e){return et({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M358.4 3.2L320 48 265.6 3.2a15.9 15.9 0 0 0-19.2 0L192 48 137.6 3.2a15.9 15.9 0 0 0-19.2 0L64 48 25.6 3.2C15-4.7 0 2.8 0 16v480c0 13.2 15 20.7 25.6 12.8L64 464l54.4 44.8a15.9 15.9 0 0 0 19.2 0L192 464l54.4 44.8a15.9 15.9 0 0 0 19.2 0L320 464l38.4 44.8c10.5 7.9 25.6.4 25.6-12.8V16c0-13.2-15-20.7-25.6-12.8zM320 360c0 4.4-3.6 8-8 8H72c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h240c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H72c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h240c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H72c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h240c4.4 0 8 3.6 8 8v16z"},child:[]}]})(e)}function Gt(e){return et({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(e)}function qt(e){return et({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M416 448h-84c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h84c17.7 0 32-14.3 32-32V160c0-17.7-14.3-32-32-32h-84c-6.6 0-12-5.4-12-12V76c0-6.6 5.4-12 12-12h84c53 0 96 43 96 96v192c0 53-43 96-96 96zm-47-201L201 79c-15-15-41-4.5-41 17v96H24c-13.3 0-24 10.7-24 24v96c0 13.3 10.7 24 24 24h136v96c0 21.5 26 32 41 17l168-168c9.3-9.4 9.3-24.6 0-34z"},child:[]}]})(e)}function Kt(e){return et({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497 273L329 441c-15 15-41 4.5-41-17v-96H152c-13.3 0-24-10.7-24-24v-96c0-13.3 10.7-24 24-24h136V88c0-21.4 25.9-32 41-17l168 168c9.3 9.4 9.3 24.6 0 34zM192 436v-40c0-6.6-5.4-12-12-12H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h84c6.6 0 12-5.4 12-12V76c0-6.6-5.4-12-12-12H96c-53 0-96 43-96 96v192c0 53 43 96 96 96h84c6.6 0 12-5.4 12-12z"},child:[]}]})(e)}function Xt(e){return et({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"},child:[]}]})(e)}function Yt(e){return et({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96 96-43.1 96-96-43.1-96-96-96zm246.4 80.5l-94.7-47.3 33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5-47.4-94.8c-6.4-12.8-24.6-12.8-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4-94.7 47.4c-12.8 6.4-12.8 24.6 0 31l94.7 47.3-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.4-33.5 47.3 94.7c6.4 12.8 24.6 12.8 31 0l47.3-94.7 100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4 94.7-47.3c13-6.5 13-24.7.2-31.1zm-155.9 106c-49.9 49.9-131.1 49.9-181 0-49.9-49.9-49.9-131.1 0-181 49.9-49.9 131.1-49.9 181 0 49.9 49.9 49.9 131.1 0 181z"},child:[]}]})(e)}function $t(e){return et({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M370.72 133.28C339.458 104.008 298.888 87.962 255.848 88c-77.458.068-144.328 53.178-162.791 126.85-1.344 5.363-6.122 9.15-11.651 9.15H24.103c-7.498 0-13.194-6.807-11.807-14.176C33.933 94.924 134.813 8 256 8c66.448 0 126.791 26.136 171.315 68.685L463.03 40.97C478.149 25.851 504 36.559 504 57.941V192c0 13.255-10.745 24-24 24H345.941c-21.382 0-32.09-25.851-16.971-40.971l41.75-41.749zM32 296h134.059c21.382 0 32.09 25.851 16.971 40.971l-41.75 41.75c31.262 29.273 71.835 45.319 114.876 45.28 77.418-.07 144.315-53.144 162.787-126.849 1.344-5.363 6.122-9.15 11.651-9.15h57.304c7.498 0 13.194 6.807 11.807 14.176C478.067 417.076 377.187 504 256 504c-66.448 0-126.791-26.136-171.315-68.685L48.97 471.03C33.851 486.149 8 475.441 8 454.059V320c0-13.255 10.745-24 24-24z"},child:[]}]})(e)}function Jt(e){return et({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M288 32C128.94 32 0 160.94 0 320c0 52.8 14.25 102.26 39.06 144.8 5.61 9.62 16.3 15.2 27.44 15.2h443c11.14 0 21.83-5.58 27.44-15.2C561.75 422.26 576 372.8 576 320c0-159.06-128.94-288-288-288zm0 64c14.71 0 26.58 10.13 30.32 23.65-1.11 2.26-2.64 4.23-3.45 6.67l-9.22 27.67c-5.13 3.49-10.97 6.01-17.64 6.01-17.67 0-32-14.33-32-32S270.33 96 288 96zM96 384c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32zm48-160c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32zm246.77-72.41l-61.33 184C343.13 347.33 352 364.54 352 384c0 11.72-3.38 22.55-8.88 32H232.88c-5.5-9.45-8.88-20.28-8.88-32 0-33.94 26.5-61.43 59.9-63.59l61.34-184.01c4.17-12.56 17.73-19.45 30.36-15.17 12.57 4.19 19.35 17.79 15.17 30.36zm14.66 57.2l15.52-46.55c3.47-1.29 7.13-2.23 11.05-2.23 17.67 0 32 14.33 32 32s-14.33 32-32 32c-11.38-.01-20.89-6.28-26.57-15.22zM480 384c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32z"},child:[]}]})(e)}function Qt(e){return et({tag:"svg",attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(e)}function Zt(e){return et({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"},child:[]}]})(e)}function en(e){return et({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M296 384h-80c-13.3 0-24-10.7-24-24V192h-87.7c-17.8 0-26.7-21.5-14.1-34.1L242.3 5.7c7.5-7.5 19.8-7.5 27.3 0l152.2 152.2c12.6 12.6 3.7 34.1-14.1 34.1H320v168c0 13.3-10.7 24-24 24zm216-8v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h136v8c0 30.9 25.1 56 56 56h80c30.9 0 56-25.1 56-56v-8h136c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"},child:[]}]})(e)}function tn(e){return et({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4zm323-128.4l-27.8-28.1c-4.6-4.7-12.1-4.7-16.8-.1l-104.8 104-45.5-45.8c-4.6-4.7-12.1-4.7-16.8-.1l-28.1 27.9c-4.7 4.6-4.7 12.1-.1 16.8l81.7 82.3c4.6 4.7 12.1 4.7 16.8.1l141.3-140.2c4.6-4.7 4.7-12.2.1-16.8z"},child:[]}]})(e)}function nn(e){return et({tag:"svg",attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 96c48.6 0 88 39.4 88 88s-39.4 88-88 88-88-39.4-88-88 39.4-88 88-88zm0 344c-58.7 0-111.3-26.6-146.5-68.2 18.8-35.4 55.6-59.8 98.5-59.8 2.4 0 4.8.4 7.1 1.1 13 4.2 26.6 6.9 40.9 6.9 14.3 0 28-2.7 40.9-6.9 2.3-.7 4.7-1.1 7.1-1.1 42.9 0 79.7 24.4 98.5 59.8C359.3 421.4 306.7 448 248 448z"},child:[]}]})(e)}function rn(e){return et({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h274.9c-2.4-6.8-3.4-14-2.6-21.3l6.8-60.9 1.2-11.1 7.9-7.9 77.3-77.3c-24.5-27.7-60-45.5-99.9-45.5zm45.3 145.3l-6.8 61c-1.1 10.2 7.5 18.8 17.6 17.6l60.9-6.8 137.9-137.9-71.7-71.7-137.9 137.8zM633 268.9L595.1 231c-9.3-9.3-24.5-9.3-33.8 0l-37.8 37.8-4.1 4.1 71.8 71.7 41.8-41.8c9.3-9.4 9.3-24.5 0-33.9z"},child:[]}]})(e)}function an(e){return et({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z"},child:[]}]})(e)}function on(e){return et({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M624 208h-64v-64c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v64h-64c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h64v64c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16v-64h64c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16zm-400 48c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"},child:[]}]})(e)}function sn(e){return et({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M622.3 271.1l-115.2-45c-4.1-1.6-12.6-3.7-22.2 0l-115.2 45c-10.7 4.2-17.7 14-17.7 24.9 0 111.6 68.7 188.8 132.9 213.9 9.6 3.7 18 1.6 22.2 0C558.4 489.9 640 420.5 640 296c0-10.9-7-20.7-17.7-24.9zM496 462.4V273.3l95.5 37.3c-5.6 87.1-60.9 135.4-95.5 151.8zM224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm96 40c0-2.5.8-4.8 1.1-7.2-2.5-.1-4.9-.8-7.5-.8h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c6.8 0 13.3-1.5 19.2-4-54-42.9-99.2-116.7-99.2-212z"},child:[]}]})(e)}function ln(e){return et({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M630.6 364.9l-90.3-90.2c-12-12-28.3-18.7-45.3-18.7h-79.3c-17.7 0-32 14.3-32 32v79.2c0 17 6.7 33.2 18.7 45.2l90.3 90.2c12.5 12.5 32.8 12.5 45.3 0l92.5-92.5c12.6-12.5 12.6-32.7.1-45.2zm-182.8-21c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24c0 13.2-10.7 24-24 24zm-223.8-88c70.7 0 128-57.3 128-128C352 57.3 294.7 0 224 0S96 57.3 96 128c0 70.6 57.3 127.9 128 127.9zm127.8 111.2V294c-12.2-3.6-24.9-6.2-38.2-6.2h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 287.9 0 348.1 0 422.3v41.6c0 26.5 21.5 48 48 48h352c15.5 0 29.1-7.5 37.9-18.9l-58-58c-18.1-18.1-28.1-42.2-28.1-67.9z"},child:[]}]})(e)}function cn(e){return et({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"},child:[]}]})(e)}function un(e){return et({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm448 0c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm32 32h-64c-17.6 0-33.5 7.1-45.1 18.6 40.3 22.1 68.9 62 75.1 109.4h66c17.7 0 32-14.3 32-32v-32c0-35.3-28.7-64-64-64zm-256 0c61.9 0 112-50.1 112-112S381.9 32 320 32 208 82.1 208 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zm-223.7-13.4C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4z"},child:[]}]})(e)}var hn=n(4980);function dn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function fn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dn(Object(n),!0).forEach(function(t){(0,hn.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dn(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function pn(e,t){return function(){return e.apply(t,arguments)}}const{toString:gn}=Object.prototype,{getPrototypeOf:mn}=Object,{iterator:vn,toStringTag:bn}=Symbol,xn=(e=>t=>{const n=gn.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),yn=e=>(e=e.toLowerCase(),t=>xn(t)===e),wn=e=>t=>typeof t===e,{isArray:kn}=Array,Nn=wn("undefined");function Sn(e){return null!==e&&!Nn(e)&&null!==e.constructor&&!Nn(e.constructor)&&_n(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Cn=yn("ArrayBuffer");const En=wn("string"),_n=wn("function"),In=wn("number"),Tn=e=>null!==e&&"object"===typeof e,An=e=>{if("object"!==xn(e))return!1;const t=mn(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(bn in e)&&!(vn in e)},Rn=yn("Date"),Dn=yn("File"),Fn=yn("Blob"),On=yn("FileList"),Ln=yn("URLSearchParams"),[Pn,Mn,jn,Bn]=["ReadableStream","Request","Response","Headers"].map(yn);function zn(e,t){let n,r,{allOwnKeys:a=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!==e&&"undefined"!==typeof e)if("object"!==typeof e&&(e=[e]),kn(e))for(n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else{if(Sn(e))return;const r=a?Object.getOwnPropertyNames(e):Object.keys(e),i=r.length;let o;for(n=0;n<i;n++)o=r[n],t.call(null,e[o],o,e)}}function Wn(e,t){if(Sn(e))return null;t=t.toLowerCase();const n=Object.keys(e);let r,a=n.length;for(;a-- >0;)if(r=n[a],t===r.toLowerCase())return r;return null}const Un="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:n.g,Vn=e=>!Nn(e)&&e!==Un;const Hn=(Gn="undefined"!==typeof Uint8Array&&mn(Uint8Array),e=>Gn&&e instanceof Gn);var Gn;const qn=yn("HTMLFormElement"),Kn=(e=>{let{hasOwnProperty:t}=e;return(e,n)=>t.call(e,n)})(Object.prototype),Xn=yn("RegExp"),Yn=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};zn(n,(n,a)=>{let i;!1!==(i=t(n,a,e))&&(r[a]=i||n)}),Object.defineProperties(e,r)};const $n=yn("AsyncFunction"),Jn=(Qn="function"===typeof setImmediate,Zn=_n(Un.postMessage),Qn?setImmediate:Zn?((e,t)=>(Un.addEventListener("message",n=>{let{source:r,data:a}=n;r===Un&&a===e&&t.length&&t.shift()()},!1),n=>{t.push(n),Un.postMessage(e,"*")}))("axios@".concat(Math.random()),[]):e=>setTimeout(e));var Qn,Zn;const er="undefined"!==typeof queueMicrotask?queueMicrotask.bind(Un):"undefined"!==typeof process&&process.nextTick||Jn,tr={isArray:kn,isArrayBuffer:Cn,isBuffer:Sn,isFormData:e=>{let t;return e&&("function"===typeof FormData&&e instanceof FormData||_n(e.append)&&("formdata"===(t=xn(e))||"object"===t&&_n(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&Cn(e.buffer),t},isString:En,isNumber:In,isBoolean:e=>!0===e||!1===e,isObject:Tn,isPlainObject:An,isEmptyObject:e=>{if(!Tn(e)||Sn(e))return!1;try{return 0===Object.keys(e).length&&Object.getPrototypeOf(e)===Object.prototype}catch(ci){return!1}},isReadableStream:Pn,isRequest:Mn,isResponse:jn,isHeaders:Bn,isUndefined:Nn,isDate:Rn,isFile:Dn,isBlob:Fn,isRegExp:Xn,isFunction:_n,isStream:e=>Tn(e)&&_n(e.pipe),isURLSearchParams:Ln,isTypedArray:Hn,isFileList:On,forEach:zn,merge:function e(){const{caseless:t,skipUndefined:n}=Vn(this)&&this||{},r={},a=(a,i)=>{const o=t&&Wn(r,i)||i;An(r[o])&&An(a)?r[o]=e(r[o],a):An(a)?r[o]=e({},a):kn(a)?r[o]=a.slice():n&&Nn(a)||(r[o]=a)};for(let i=0,o=arguments.length;i<o;i++)arguments[i]&&zn(arguments[i],a);return r},extend:function(e,t,n){let{allOwnKeys:r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return zn(t,(t,r)=>{n&&_n(t)?e[r]=pn(t,n):e[r]=t},{allOwnKeys:r}),e},trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,r)=>{let a,i,o;const s={};if(t=t||{},null==e)return t;do{for(a=Object.getOwnPropertyNames(e),i=a.length;i-- >0;)o=a[i],r&&!r(o,e,t)||s[o]||(t[o]=e[o],s[o]=!0);e=!1!==n&&mn(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:xn,kindOfTest:yn,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return-1!==r&&r===n},toArray:e=>{if(!e)return null;if(kn(e))return e;let t=e.length;if(!In(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const n=(e&&e[vn]).call(e);let r;for(;(r=n.next())&&!r.done;){const n=r.value;t.call(e,n[0],n[1])}},matchAll:(e,t)=>{let n;const r=[];for(;null!==(n=e.exec(t));)r.push(n);return r},isHTMLForm:qn,hasOwnProperty:Kn,hasOwnProp:Kn,reduceDescriptors:Yn,freezeMethods:e=>{Yn(e,(t,n)=>{if(_n(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const r=e[n];_n(r)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))})},toObjectSet:(e,t)=>{const n={},r=e=>{e.forEach(e=>{n[e]=!0})};return kn(e)?r(e):r(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,t,n){return t.toUpperCase()+n}),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:Wn,global:Un,isContextDefined:Vn,isSpecCompliantForm:function(e){return!!(e&&_n(e.append)&&"FormData"===e[bn]&&e[vn])},toJSONObject:e=>{const t=new Array(10),n=(e,r)=>{if(Tn(e)){if(t.indexOf(e)>=0)return;if(Sn(e))return e;if(!("toJSON"in e)){t[r]=e;const a=kn(e)?[]:{};return zn(e,(e,t)=>{const i=n(e,r+1);!Nn(i)&&(a[t]=i)}),t[r]=void 0,a}}return e};return n(e,0)},isAsyncFn:$n,isThenable:e=>e&&(Tn(e)||_n(e))&&_n(e.then)&&_n(e.catch),setImmediate:Jn,asap:er,isIterable:e=>null!=e&&_n(e[vn])};function nr(e,t,n,r,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),a&&(this.response=a,this.status=a.status?a.status:null)}tr.inherits(nr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:tr.toJSONObject(this.config),code:this.code,status:this.status}}});const rr=nr.prototype,ar={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{ar[e]={value:e}}),Object.defineProperties(nr,ar),Object.defineProperty(rr,"isAxiosError",{value:!0}),nr.from=(e,t,n,r,a,i)=>{const o=Object.create(rr);tr.toFlatObject(e,o,function(e){return e!==Error.prototype},e=>"isAxiosError"!==e);const s=e&&e.message?e.message:"Error",l=null==t&&e?e.code:t;return nr.call(o,s,l,n,r,a),e&&null==o.cause&&Object.defineProperty(o,"cause",{value:e,configurable:!0}),o.name=e&&e.name||"Error",i&&Object.assign(o,i),o};const ir=nr;function or(e){return tr.isPlainObject(e)||tr.isArray(e)}function sr(e){return tr.endsWith(e,"[]")?e.slice(0,-2):e}function lr(e,t,n){return e?e.concat(t).map(function(e,t){return e=sr(e),!n&&t?"["+e+"]":e}).join(n?".":""):t}const cr=tr.toFlatObject(tr,{},null,function(e){return/^is[A-Z]/.test(e)});const ur=function(e,t,n){if(!tr.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const r=(n=tr.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(e,t){return!tr.isUndefined(t[e])})).metaTokens,a=n.visitor||c,i=n.dots,o=n.indexes,s=(n.Blob||"undefined"!==typeof Blob&&Blob)&&tr.isSpecCompliantForm(t);if(!tr.isFunction(a))throw new TypeError("visitor must be a function");function l(e){if(null===e)return"";if(tr.isDate(e))return e.toISOString();if(tr.isBoolean(e))return e.toString();if(!s&&tr.isBlob(e))throw new ir("Blob is not supported. Use a Buffer instead.");return tr.isArrayBuffer(e)||tr.isTypedArray(e)?s&&"function"===typeof Blob?new Blob([e]):Buffer.from(e):e}function c(e,n,a){let s=e;if(e&&!a&&"object"===typeof e)if(tr.endsWith(n,"{}"))n=r?n:n.slice(0,-2),e=JSON.stringify(e);else if(tr.isArray(e)&&function(e){return tr.isArray(e)&&!e.some(or)}(e)||(tr.isFileList(e)||tr.endsWith(n,"[]"))&&(s=tr.toArray(e)))return n=sr(n),s.forEach(function(e,r){!tr.isUndefined(e)&&null!==e&&t.append(!0===o?lr([n],r,i):null===o?n:n+"[]",l(e))}),!1;return!!or(e)||(t.append(lr(a,n,i),l(e)),!1)}const u=[],h=Object.assign(cr,{defaultVisitor:c,convertValue:l,isVisitable:or});if(!tr.isObject(e))throw new TypeError("data must be an object");return function e(n,r){if(!tr.isUndefined(n)){if(-1!==u.indexOf(n))throw Error("Circular reference detected in "+r.join("."));u.push(n),tr.forEach(n,function(n,i){!0===(!(tr.isUndefined(n)||null===n)&&a.call(t,n,tr.isString(i)?i.trim():i,r,h))&&e(n,r?r.concat(i):[i])}),u.pop()}}(e),t};function hr(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(e){return t[e]})}function dr(e,t){this._pairs=[],e&&ur(e,this,t)}const fr=dr.prototype;fr.append=function(e,t){this._pairs.push([e,t])},fr.toString=function(e){const t=e?function(t){return e.call(this,t,hr)}:hr;return this._pairs.map(function(e){return t(e[0])+"="+t(e[1])},"").join("&")};const pr=dr;function gr(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function mr(e,t,n){if(!t)return e;const r=n&&n.encode||gr;tr.isFunction(n)&&(n={serialize:n});const a=n&&n.serialize;let i;if(i=a?a(t,n):tr.isURLSearchParams(t)?t.toString():new pr(t,n).toString(r),i){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e}const vr=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){tr.forEach(this.handlers,function(t){null!==t&&e(t)})}},br={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},xr={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:pr,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},yr="undefined"!==typeof window&&"undefined"!==typeof document,wr="object"===typeof navigator&&navigator||void 0,kr=yr&&(!wr||["ReactNative","NativeScript","NS"].indexOf(wr.product)<0),Nr="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,Sr=yr&&window.location.href||"http://localhost",Cr=fn(fn({},e),xr);const Er=function(e){function t(e,n,r,a){let i=e[a++];if("__proto__"===i)return!0;const o=Number.isFinite(+i),s=a>=e.length;if(i=!i&&tr.isArray(r)?r.length:i,s)return tr.hasOwnProp(r,i)?r[i]=[r[i],n]:r[i]=n,!o;r[i]&&tr.isObject(r[i])||(r[i]=[]);return t(e,n,r[i],a)&&tr.isArray(r[i])&&(r[i]=function(e){const t={},n=Object.keys(e);let r;const a=n.length;let i;for(r=0;r<a;r++)i=n[r],t[i]=e[i];return t}(r[i])),!o}if(tr.isFormData(e)&&tr.isFunction(e.entries)){const n={};return tr.forEachEntry(e,(e,r)=>{t(function(e){return tr.matchAll(/\w+|\[(\w*)]/g,e).map(e=>"[]"===e[0]?"":e[1]||e[0])}(e),r,n,0)}),n}return null};const _r={transitional:br,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",r=n.indexOf("application/json")>-1,a=tr.isObject(e);a&&tr.isHTMLForm(e)&&(e=new FormData(e));if(tr.isFormData(e))return r?JSON.stringify(Er(e)):e;if(tr.isArrayBuffer(e)||tr.isBuffer(e)||tr.isStream(e)||tr.isFile(e)||tr.isBlob(e)||tr.isReadableStream(e))return e;if(tr.isArrayBufferView(e))return e.buffer;if(tr.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let i;if(a){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return ur(e,new Cr.classes.URLSearchParams,fn({visitor:function(e,t,n,r){return Cr.isNode&&tr.isBuffer(e)?(this.append(t,e.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((i=tr.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return ur(i?{"files[]":e}:e,t&&new t,this.formSerializer)}}return a||r?(t.setContentType("application/json",!1),function(e,t,n){if(tr.isString(e))try{return(t||JSON.parse)(e),tr.trim(e)}catch(ci){if("SyntaxError"!==ci.name)throw ci}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||_r.transitional,n=t&&t.forcedJSONParsing,r="json"===this.responseType;if(tr.isResponse(e)||tr.isReadableStream(e))return e;if(e&&tr.isString(e)&&(n&&!this.responseType||r)){const n=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e,this.parseReviver)}catch(ci){if(n){if("SyntaxError"===ci.name)throw ir.from(ci,ir.ERR_BAD_RESPONSE,this,null,this.response);throw ci}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Cr.classes.FormData,Blob:Cr.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};tr.forEach(["delete","get","head","post","put","patch"],e=>{_r.headers[e]={}});const Ir=_r,Tr=tr.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Ar=Symbol("internals");function Rr(e){return e&&String(e).trim().toLowerCase()}function Dr(e){return!1===e||null==e?e:tr.isArray(e)?e.map(Dr):String(e)}function Fr(e,t,n,r,a){return tr.isFunction(r)?r.call(this,t,n):(a&&(t=n),tr.isString(t)?tr.isString(r)?-1!==t.indexOf(r):tr.isRegExp(r)?r.test(t):void 0:void 0)}class Or{constructor(e){e&&this.set(e)}set(e,t,n){const r=this;function a(e,t,n){const a=Rr(t);if(!a)throw new Error("header name must be a non-empty string");const i=tr.findKey(r,a);(!i||void 0===r[i]||!0===n||void 0===n&&!1!==r[i])&&(r[i||t]=Dr(e))}const i=(e,t)=>tr.forEach(e,(e,n)=>a(e,n,t));if(tr.isPlainObject(e)||e instanceof this.constructor)i(e,t);else if(tr.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))i((e=>{const t={};let n,r,a;return e&&e.split("\n").forEach(function(e){a=e.indexOf(":"),n=e.substring(0,a).trim().toLowerCase(),r=e.substring(a+1).trim(),!n||t[n]&&Tr[n]||("set-cookie"===n?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t})(e),t);else if(tr.isObject(e)&&tr.isIterable(e)){let n,r,a={};for(const t of e){if(!tr.isArray(t))throw TypeError("Object iterator must return a key-value pair");a[r=t[0]]=(n=a[r])?tr.isArray(n)?[...n,t[1]]:[n,t[1]]:t[1]}i(a,t)}else null!=e&&a(t,e,n);return this}get(e,t){if(e=Rr(e)){const n=tr.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}(e);if(tr.isFunction(t))return t.call(this,e,n);if(tr.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Rr(e)){const n=tr.findKey(this,e);return!(!n||void 0===this[n]||t&&!Fr(0,this[n],n,t))}return!1}delete(e,t){const n=this;let r=!1;function a(e){if(e=Rr(e)){const a=tr.findKey(n,e);!a||t&&!Fr(0,n[a],a,t)||(delete n[a],r=!0)}}return tr.isArray(e)?e.forEach(a):a(e),r}clear(e){const t=Object.keys(this);let n=t.length,r=!1;for(;n--;){const a=t[n];e&&!Fr(0,this[a],a,e,!0)||(delete this[a],r=!0)}return r}normalize(e){const t=this,n={};return tr.forEach(this,(r,a)=>{const i=tr.findKey(n,a);if(i)return t[i]=Dr(r),void delete t[a];const o=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,n)=>t.toUpperCase()+n)}(a):String(a).trim();o!==a&&delete t[a],t[o]=Dr(r),n[o]=!0}),this}concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.constructor.concat(this,...t)}toJSON(e){const t=Object.create(null);return tr.forEach(this,(n,r)=>{null!=n&&!1!==n&&(t[r]=e&&tr.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(e=>{let[t,n]=e;return t+": "+n}).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e){const t=new this(e);for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return r.forEach(e=>t.set(e)),t}static accessor(e){const t=(this[Ar]=this[Ar]={accessors:{}}).accessors,n=this.prototype;function r(e){const r=Rr(e);t[r]||(!function(e,t){const n=tr.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(e,n,a){return this[r].call(this,t,e,n,a)},configurable:!0})})}(n,e),t[r]=!0)}return tr.isArray(e)?e.forEach(r):r(e),this}}Or.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),tr.reduceDescriptors(Or.prototype,(e,t)=>{let{value:n}=e,r=t[0].toUpperCase()+t.slice(1);return{get:()=>n,set(e){this[r]=e}}}),tr.freezeMethods(Or);const Lr=Or;function Pr(e,t){const n=this||Ir,r=t||n,a=Lr.from(r.headers);let i=r.data;return tr.forEach(e,function(e){i=e.call(n,i,a.normalize(),t?t.status:void 0)}),a.normalize(),i}function Mr(e){return!(!e||!e.__CANCEL__)}function jr(e,t,n){ir.call(this,null==e?"canceled":e,ir.ERR_CANCELED,t,n),this.name="CanceledError"}tr.inherits(jr,ir,{__CANCEL__:!0});const Br=jr;function zr(e,t,n){const r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(new ir("Request failed with status code "+n.status,[ir.ERR_BAD_REQUEST,ir.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}const Wr=function(e,t){e=e||10;const n=new Array(e),r=new Array(e);let a,i=0,o=0;return t=void 0!==t?t:1e3,function(s){const l=Date.now(),c=r[o];a||(a=l),n[i]=s,r[i]=l;let u=o,h=0;for(;u!==i;)h+=n[u++],u%=e;if(i=(i+1)%e,i===o&&(o=(o+1)%e),l-a<t)return;const d=c&&l-c;return d?Math.round(1e3*h/d):void 0}};const Ur=function(e,t){let n,r,a=0,i=1e3/t;const o=function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();a=i,n=null,r&&(clearTimeout(r),r=null),e(...t)};return[function(){const e=Date.now(),t=e-a;for(var s=arguments.length,l=new Array(s),c=0;c<s;c++)l[c]=arguments[c];t>=i?o(l,e):(n=l,r||(r=setTimeout(()=>{r=null,o(n)},i-t)))},()=>n&&o(n)]},Vr=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=0;const a=Wr(50,250);return Ur(n=>{const i=n.loaded,o=n.lengthComputable?n.total:void 0,s=i-r,l=a(s);r=i;e({loaded:i,total:o,progress:o?i/o:void 0,bytes:s,rate:l||void 0,estimated:l&&o&&i<=o?(o-i)/l:void 0,event:n,lengthComputable:null!=o,[t?"download":"upload"]:!0})},n)},Hr=(e,t)=>{const n=null!=e;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},Gr=e=>function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return tr.asap(()=>e(...n))},qr=Cr.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,Cr.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(Cr.origin),Cr.navigator&&/(msie|trident)/i.test(Cr.navigator.userAgent)):()=>!0,Kr=Cr.hasStandardBrowserEnv?{write(e,t,n,r,a,i,o){if("undefined"===typeof document)return;const s=["".concat(e,"=").concat(encodeURIComponent(t))];tr.isNumber(n)&&s.push("expires=".concat(new Date(n).toUTCString())),tr.isString(r)&&s.push("path=".concat(r)),tr.isString(a)&&s.push("domain=".concat(a)),!0===i&&s.push("secure"),tr.isString(o)&&s.push("SameSite=".concat(o)),document.cookie=s.join("; ")},read(e){if("undefined"===typeof document)return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read:()=>null,remove(){}};function Xr(e,t,n){let r=!function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}(t);return e&&(r||0==n)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const Yr=e=>e instanceof Lr?fn({},e):e;function $r(e,t){t=t||{};const n={};function r(e,t,n,r){return tr.isPlainObject(e)&&tr.isPlainObject(t)?tr.merge.call({caseless:r},e,t):tr.isPlainObject(t)?tr.merge({},t):tr.isArray(t)?t.slice():t}function a(e,t,n,a){return tr.isUndefined(t)?tr.isUndefined(e)?void 0:r(void 0,e,0,a):r(e,t,0,a)}function i(e,t){if(!tr.isUndefined(t))return r(void 0,t)}function o(e,t){return tr.isUndefined(t)?tr.isUndefined(e)?void 0:r(void 0,e):r(void 0,t)}function s(n,a,i){return i in t?r(n,a):i in e?r(void 0,n):void 0}const l={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:s,headers:(e,t,n)=>a(Yr(e),Yr(t),0,!0)};return tr.forEach(Object.keys(fn(fn({},e),t)),function(r){const i=l[r]||a,o=i(e[r],t[r],r);tr.isUndefined(o)&&i!==s||(n[r]=o)}),n}const Jr=e=>{const t=$r({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:a,xsrfCookieName:i,headers:o,auth:s}=t;if(t.headers=o=Lr.from(o),t.url=mr(Xr(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),s&&o.set("Authorization","Basic "+btoa((s.username||"")+":"+(s.password?unescape(encodeURIComponent(s.password)):""))),tr.isFormData(n))if(Cr.hasStandardBrowserEnv||Cr.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(tr.isFunction(n.getHeaders)){const e=n.getHeaders(),t=["content-type","content-length"];Object.entries(e).forEach(e=>{let[n,r]=e;t.includes(n.toLowerCase())&&o.set(n,r)})}if(Cr.hasStandardBrowserEnv&&(r&&tr.isFunction(r)&&(r=r(t)),r||!1!==r&&qr(t.url))){const e=a&&i&&Kr.read(i);e&&o.set(a,e)}return t},Qr="undefined"!==typeof XMLHttpRequest&&function(e){return new Promise(function(t,n){const r=Jr(e);let a=r.data;const i=Lr.from(r.headers).normalize();let o,s,l,c,u,{responseType:h,onUploadProgress:d,onDownloadProgress:f}=r;function p(){c&&c(),u&&u(),r.cancelToken&&r.cancelToken.unsubscribe(o),r.signal&&r.signal.removeEventListener("abort",o)}let g=new XMLHttpRequest;function m(){if(!g)return;const r=Lr.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders());zr(function(e){t(e),p()},function(e){n(e),p()},{data:h&&"text"!==h&&"json"!==h?g.response:g.responseText,status:g.status,statusText:g.statusText,headers:r,config:e,request:g}),g=null}g.open(r.method.toUpperCase(),r.url,!0),g.timeout=r.timeout,"onloadend"in g?g.onloadend=m:g.onreadystatechange=function(){g&&4===g.readyState&&(0!==g.status||g.responseURL&&0===g.responseURL.indexOf("file:"))&&setTimeout(m)},g.onabort=function(){g&&(n(new ir("Request aborted",ir.ECONNABORTED,e,g)),g=null)},g.onerror=function(t){const r=t&&t.message?t.message:"Network Error",a=new ir(r,ir.ERR_NETWORK,e,g);a.event=t||null,n(a),g=null},g.ontimeout=function(){let t=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const a=r.transitional||br;r.timeoutErrorMessage&&(t=r.timeoutErrorMessage),n(new ir(t,a.clarifyTimeoutError?ir.ETIMEDOUT:ir.ECONNABORTED,e,g)),g=null},void 0===a&&i.setContentType(null),"setRequestHeader"in g&&tr.forEach(i.toJSON(),function(e,t){g.setRequestHeader(t,e)}),tr.isUndefined(r.withCredentials)||(g.withCredentials=!!r.withCredentials),h&&"json"!==h&&(g.responseType=r.responseType),f&&([l,u]=Vr(f,!0),g.addEventListener("progress",l)),d&&g.upload&&([s,c]=Vr(d),g.upload.addEventListener("progress",s),g.upload.addEventListener("loadend",c)),(r.cancelToken||r.signal)&&(o=t=>{g&&(n(!t||t.type?new Br(null,e,g):t),g.abort(),g=null)},r.cancelToken&&r.cancelToken.subscribe(o),r.signal&&(r.signal.aborted?o():r.signal.addEventListener("abort",o)));const v=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(r.url);v&&-1===Cr.protocols.indexOf(v)?n(new ir("Unsupported protocol "+v+":",ir.ERR_BAD_REQUEST,e)):g.send(a||null)})},Zr=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let n,r=new AbortController;const a=function(e){if(!n){n=!0,o();const t=e instanceof Error?e:this.reason;r.abort(t instanceof ir?t:new Br(t instanceof Error?t.message:t))}};let i=t&&setTimeout(()=>{i=null,a(new ir("timeout ".concat(t," of ms exceeded"),ir.ETIMEDOUT))},t);const o=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach(e=>{e.unsubscribe?e.unsubscribe(a):e.removeEventListener("abort",a)}),e=null)};e.forEach(e=>e.addEventListener("abort",a));const{signal:s}=r;return s.unsubscribe=()=>tr.asap(o),s}};function ea(e,t){this.v=e,this.k=t}function ta(e){return function(){return new na(e.apply(this,arguments))}}function na(e){var t,n;function r(t,n){try{var i=e[t](n),o=i.value,s=o instanceof ea;Promise.resolve(s?o.v:o).then(function(n){if(s){var l="return"===t?"return":"next";if(!o.k||n.done)return r(l,n);n=e[l](n).value}a(i.done?"return":"normal",n)},function(e){r("throw",e)})}catch(e){a("throw",e)}}function a(e,a){switch(e){case"return":t.resolve({value:a,done:!0});break;case"throw":t.reject(a);break;default:t.resolve({value:a,done:!1})}(t=t.next)?r(t.key,t.arg):n=null}this._invoke=function(e,a){return new Promise(function(i,o){var s={key:e,arg:a,resolve:i,reject:o,next:null};n?n=n.next=s:(t=n=s,r(e,a))})},"function"!=typeof e.return&&(this.return=void 0)}function ra(e){return new ea(e,0)}function aa(e){var t={},n=!1;function r(t,r){return n=!0,r=new Promise(function(n){n(e[t](r))}),{done:!1,value:new ea(r,1)}}return t["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},t.next=function(e){return n?(n=!1,e):r("next",e)},"function"==typeof e.throw&&(t.throw=function(e){if(n)throw n=!1,e;return r("throw",e)}),"function"==typeof e.return&&(t.return=function(e){return n?(n=!1,e):r("return",e)}),t}function ia(e){var t,n,r,a=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,r=Symbol.iterator);a--;){if(n&&null!=(t=e[n]))return t.call(e);if(r&&null!=(t=e[r]))return new oa(t.call(e));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function oa(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then(function(e){return{value:e,done:t}})}return oa=function(e){this.s=e,this.n=e.next},oa.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new oa(e)}na.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},na.prototype.next=function(e){return this._invoke("next",e)},na.prototype.throw=function(e){return this._invoke("throw",e)},na.prototype.return=function(e){return this._invoke("return",e)};const sa=function*(e,t){let n=e.byteLength;if(!t||n<t)return void(yield e);let r,a=0;for(;a<n;)r=a+t,yield e.slice(a,r),a=r},la=function(){var e=ta(function*(e,t){var n,r=!1,a=!1;try{for(var i,o=ia(ca(e));r=!(i=yield ra(o.next())).done;r=!1){const e=i.value;yield*aa(ia(sa(e,t)))}}catch(s){a=!0,n=s}finally{try{r&&null!=o.return&&(yield ra(o.return()))}finally{if(a)throw n}}});return function(t,n){return e.apply(this,arguments)}}(),ca=function(){var e=ta(function*(e){if(e[Symbol.asyncIterator])return void(yield*aa(ia(e)));const t=e.getReader();try{for(;;){const{done:e,value:n}=yield ra(t.read());if(e)break;yield n}}finally{yield ra(t.cancel())}});return function(t){return e.apply(this,arguments)}}(),ua=(e,t,n,r)=>{const a=la(e,t);let i,o=0,s=e=>{i||(i=!0,r&&r(e))};return new ReadableStream({async pull(e){try{const{done:t,value:r}=await a.next();if(t)return s(),void e.close();let i=r.byteLength;if(n){let e=o+=i;n(e)}e.enqueue(new Uint8Array(r))}catch(t){throw s(t),t}},cancel:e=>(s(e),a.return())},{highWaterMark:2})},{isFunction:ha}=tr,da=(e=>{let{Request:t,Response:n}=e;return{Request:t,Response:n}})(tr.global),{ReadableStream:fa,TextEncoder:pa}=tr.global,ga=function(e){try{for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return!!e(...n)}catch(ci){return!1}},ma=e=>{e=tr.merge.call({skipUndefined:!0},da,e);const{fetch:t,Request:n,Response:r}=e,a=t?ha(t):"function"===typeof fetch,i=ha(n),o=ha(r);if(!a)return!1;const s=a&&ha(fa),l=a&&("function"===typeof pa?(c=new pa,e=>c.encode(e)):async e=>new Uint8Array(await new n(e).arrayBuffer()));var c;const u=i&&s&&ga(()=>{let e=!1;const t=new n(Cr.origin,{body:new fa,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),h=o&&s&&ga(()=>tr.isReadableStream(new r("").body)),d={stream:h&&(e=>e.body)};a&&["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!d[e]&&(d[e]=(t,n)=>{let r=t&&t[e];if(r)return r.call(t);throw new ir("Response type '".concat(e,"' is not supported"),ir.ERR_NOT_SUPPORT,n)})});const f=async(e,t)=>{const r=tr.toFiniteNumber(e.getContentLength());return null==r?(async e=>{if(null==e)return 0;if(tr.isBlob(e))return e.size;if(tr.isSpecCompliantForm(e)){const t=new n(Cr.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return tr.isArrayBufferView(e)||tr.isArrayBuffer(e)?e.byteLength:(tr.isURLSearchParams(e)&&(e+=""),tr.isString(e)?(await l(e)).byteLength:void 0)})(t):r};return async e=>{let{url:a,method:o,data:s,signal:l,cancelToken:c,timeout:p,onDownloadProgress:g,onUploadProgress:m,responseType:v,headers:b,withCredentials:x="same-origin",fetchOptions:y}=Jr(e),w=t||fetch;v=v?(v+"").toLowerCase():"text";let k=Zr([l,c&&c.toAbortSignal()],p),N=null;const S=k&&k.unsubscribe&&(()=>{k.unsubscribe()});let C;try{if(m&&u&&"get"!==o&&"head"!==o&&0!==(C=await f(b,s))){let e,t=new n(a,{method:"POST",body:s,duplex:"half"});if(tr.isFormData(s)&&(e=t.headers.get("content-type"))&&b.setContentType(e),t.body){const[e,n]=Hr(C,Vr(Gr(m)));s=ua(t.body,65536,e,n)}}tr.isString(x)||(x=x?"include":"omit");const t=i&&"credentials"in n.prototype,l=fn(fn({},y),{},{signal:k,method:o.toUpperCase(),headers:b.normalize().toJSON(),body:s,duplex:"half",credentials:t?x:void 0});N=i&&new n(a,l);let c=await(i?w(N,y):w(a,l));const p=h&&("stream"===v||"response"===v);if(h&&(g||p&&S)){const e={};["status","statusText","headers"].forEach(t=>{e[t]=c[t]});const t=tr.toFiniteNumber(c.headers.get("content-length")),[n,a]=g&&Hr(t,Vr(Gr(g),!0))||[];c=new r(ua(c.body,65536,n,()=>{a&&a(),S&&S()}),e)}v=v||"text";let E=await d[tr.findKey(d,v)||"text"](c,e);return!p&&S&&S(),await new Promise((t,n)=>{zr(t,n,{data:E,headers:Lr.from(c.headers),status:c.status,statusText:c.statusText,config:e,request:N})})}catch(E){if(S&&S(),E&&"TypeError"===E.name&&/Load failed|fetch/i.test(E.message))throw Object.assign(new ir("Network Error",ir.ERR_NETWORK,e,N),{cause:E.cause||E});throw ir.from(E,E&&E.code,e,N)}}},va=new Map,ba=e=>{let t=e&&e.env||{};const{fetch:n,Request:r,Response:a}=t,i=[r,a,n];let o,s,l=i.length,c=va;for(;l--;)o=i[l],s=c.get(o),void 0===s&&c.set(o,s=l?new Map:ma(t)),c=s;return s},xa=(ba(),{http:null,xhr:Qr,fetch:{get:ba}});tr.forEach(xa,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(ci){}Object.defineProperty(e,"adapterName",{value:t})}});const ya=e=>"- ".concat(e),wa=e=>tr.isFunction(e)||null===e||!1===e;const ka={getAdapter:function(e,t){e=tr.isArray(e)?e:[e];const{length:n}=e;let r,a;const i={};for(let o=0;o<n;o++){let n;if(r=e[o],a=r,!wa(r)&&(a=xa[(n=String(r)).toLowerCase()],void 0===a))throw new ir("Unknown adapter '".concat(n,"'"));if(a&&(tr.isFunction(a)||(a=a.get(t))))break;i[n||"#"+o]=a}if(!a){const e=Object.entries(i).map(e=>{let[t,n]=e;return"adapter ".concat(t," ")+(!1===n?"is not supported by the environment":"is not available in the build")});let t=n?e.length>1?"since :\n"+e.map(ya).join("\n"):" "+ya(e[0]):"as no adapter specified";throw new ir("There is no suitable adapter to dispatch the request "+t,"ERR_NOT_SUPPORT")}return a},adapters:xa};function Na(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Br(null,e)}function Sa(e){Na(e),e.headers=Lr.from(e.headers),e.data=Pr.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return ka.getAdapter(e.adapter||Ir.adapter,e)(e).then(function(t){return Na(e),t.data=Pr.call(e,e.transformResponse,t),t.headers=Lr.from(t.headers),t},function(t){return Mr(t)||(Na(e),t&&t.response&&(t.response.data=Pr.call(e,e.transformResponse,t.response),t.response.headers=Lr.from(t.response.headers))),Promise.reject(t)})}const Ca="1.13.2",Ea={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Ea[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const _a={};Ea.transitional=function(e,t,n){function r(e,t){return"[Axios v"+Ca+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return(n,a,i)=>{if(!1===e)throw new ir(r(a," has been removed"+(t?" in "+t:"")),ir.ERR_DEPRECATED);return t&&!_a[a]&&(_a[a]=!0,console.warn(r(a," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,a,i)}},Ea.spelling=function(e){return(t,n)=>(console.warn("".concat(n," is likely a misspelling of ").concat(e)),!0)};const Ia={assertOptions:function(e,t,n){if("object"!==typeof e)throw new ir("options must be an object",ir.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let a=r.length;for(;a-- >0;){const i=r[a],o=t[i];if(o){const t=e[i],n=void 0===t||o(t,i,e);if(!0!==n)throw new ir("option "+i+" must be "+n,ir.ERR_BAD_OPTION_VALUE);continue}if(!0!==n)throw new ir("Unknown option "+i,ir.ERR_BAD_OPTION)}},validators:Ea},Ta=Ia.validators;class Aa{constructor(e){this.defaults=e||{},this.interceptors={request:new vr,response:new vr}}async request(e,t){try{return await this._request(e,t)}catch(n){if(n instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const t=e.stack?e.stack.replace(/^.+\n/,""):"";try{n.stack?t&&!String(n.stack).endsWith(t.replace(/^.+\n.+\n/,""))&&(n.stack+="\n"+t):n.stack=t}catch(ci){}}throw n}}_request(e,t){"string"===typeof e?(t=t||{}).url=e:t=e||{},t=$r(this.defaults,t);const{transitional:n,paramsSerializer:r,headers:a}=t;void 0!==n&&Ia.assertOptions(n,{silentJSONParsing:Ta.transitional(Ta.boolean),forcedJSONParsing:Ta.transitional(Ta.boolean),clarifyTimeoutError:Ta.transitional(Ta.boolean)},!1),null!=r&&(tr.isFunction(r)?t.paramsSerializer={serialize:r}:Ia.assertOptions(r,{encode:Ta.function,serialize:Ta.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Ia.assertOptions(t,{baseUrl:Ta.spelling("baseURL"),withXsrfToken:Ta.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let i=a&&tr.merge(a.common,a[t.method]);a&&tr.forEach(["delete","get","head","post","put","patch","common"],e=>{delete a[e]}),t.headers=Lr.concat(i,a);const o=[];let s=!0;this.interceptors.request.forEach(function(e){"function"===typeof e.runWhen&&!1===e.runWhen(t)||(s=s&&e.synchronous,o.unshift(e.fulfilled,e.rejected))});const l=[];let c;this.interceptors.response.forEach(function(e){l.push(e.fulfilled,e.rejected)});let u,h=0;if(!s){const e=[Sa.bind(this),void 0];for(e.unshift(...o),e.push(...l),u=e.length,c=Promise.resolve(t);h<u;)c=c.then(e[h++],e[h++]);return c}u=o.length;let d=t;for(;h<u;){const e=o[h++],t=o[h++];try{d=e(d)}catch(f){t.call(this,f);break}}try{c=Sa.call(this,d)}catch(f){return Promise.reject(f)}for(h=0,u=l.length;h<u;)c=c.then(l[h++],l[h++]);return c}getUri(e){return mr(Xr((e=$r(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}}tr.forEach(["delete","get","head","options"],function(e){Aa.prototype[e]=function(t,n){return this.request($r(n||{},{method:e,url:t,data:(n||{}).data}))}}),tr.forEach(["post","put","patch"],function(e){function t(t){return function(n,r,a){return this.request($r(a||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}Aa.prototype[e]=t(),Aa.prototype[e+"Form"]=t(!0)});const Ra=Aa;class Da{constructor(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(e){t=e});const n=this;this.promise.then(e=>{if(!n._listeners)return;let t=n._listeners.length;for(;t-- >0;)n._listeners[t](e);n._listeners=null}),this.promise.then=e=>{let t;const r=new Promise(e=>{n.subscribe(e),t=e}).then(e);return r.cancel=function(){n.unsubscribe(t)},r},e(function(e,r,a){n.reason||(n.reason=new Br(e,r,a),t(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;const t=new Da(function(t){e=t});return{token:t,cancel:e}}}const Fa=Da;const Oa={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Oa).forEach(e=>{let[t,n]=e;Oa[n]=t});const La=Oa;const Pa=function e(t){const n=new Ra(t),r=pn(Ra.prototype.request,n);return tr.extend(r,Ra.prototype,n,{allOwnKeys:!0}),tr.extend(r,n,null,{allOwnKeys:!0}),r.create=function(n){return e($r(t,n))},r}(Ir);Pa.Axios=Ra,Pa.CanceledError=Br,Pa.CancelToken=Fa,Pa.isCancel=Mr,Pa.VERSION=Ca,Pa.toFormData=ur,Pa.AxiosError=ir,Pa.Cancel=Pa.CanceledError,Pa.all=function(e){return Promise.all(e)},Pa.spread=function(e){return function(t){return e.apply(null,t)}},Pa.isAxiosError=function(e){return tr.isObject(e)&&!0===e.isAxiosError},Pa.mergeConfig=$r,Pa.AxiosHeaders=Lr,Pa.formToJSON=e=>Er(tr.isHTMLForm(e)?new FormData(e):e),Pa.getAdapter=ka.getAdapter,Pa.HttpStatusCode=La,Pa.default=Pa;const Ma=Pa.create({baseURL:"http://localhost:5000/api"});Ma.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers["x-auth-token"]=t),e},e=>Promise.reject(e)),Ma.interceptors.response.use(e=>e,e=>{var t;return 401===(null===(t=e.response)||void 0===t?void 0:t.status)&&(localStorage.removeItem("token"),window.location.href="/"),Promise.reject(e)});const ja=Ma;var Ba=n(579);const za=e=>{let{setUser:t}=e;const[n,r]=(0,l.useState)(null),[a,i]=(0,l.useState)(null),[o,s]=(0,l.useState)({email:"",password:""}),[c,u]=(0,l.useState)([]),[h,d]=(0,l.useState)(null),[f,p]=(0,l.useState)(null),[g,m]=(0,l.useState)(!1),[v,b]=(0,l.useState)(""),[x,y]=(0,l.useState)(!1),[w,k]=(0,l.useState)(!1),[N,S]=(0,l.useState)(""),[C,E]=(0,l.useState)(""),[_,I]=(0,l.useState)(""),T=le();(0,l.useEffect)(()=>{if(a&&"fighter"===n){(async()=>{m(!0);try{const e=await ja.get("/fighters/list?tenant=".concat(a.slug));u(e.data)}catch(e){p("Failed to fetch fighter list.")}finally{m(!1)}})()}},[a,n]);const A=e=>{if(!e)return"";return e.split(" ").map(e=>e[0]).join("").toUpperCase().substring(0,2)},R=()=>{i(null),r(null),p(null),d(null),b(""),S(""),E(""),I("")},D=c.filter(e=>e.name.toLowerCase().includes(v.toLowerCase())||e.rfid.toLowerCase().includes(v.toLowerCase()));return(0,Ba.jsxs)("div",{className:"relative min-h-screen w-full overflow-hidden bg-gray-900 flex items-center justify-center selection:bg-pink-500 selection:text-white font-sans",children:[(0,Ba.jsxs)("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden z-0 pointer-events-none",children:[(0,Ba.jsx)("div",{className:"absolute top-0 left-1/4 w-96 h-96 bg-purple-600 rounded-full mix-blend-multiply filter blur-3xl opacity-40 animate-blob"}),(0,Ba.jsx)("div",{className:"absolute top-0 right-1/4 w-96 h-96 bg-blue-600 rounded-full mix-blend-multiply filter blur-3xl opacity-40 animate-blob animation-delay-2000"}),(0,Ba.jsx)("div",{className:"absolute -bottom-32 left-1/3 w-96 h-96 bg-pink-600 rounded-full mix-blend-multiply filter blur-3xl opacity-40 animate-blob animation-delay-4000"})]}),(0,Ba.jsx)("div",{className:"absolute inset-0 z-0 bg-gray-900/60 backdrop-blur-sm"}),(0,Ba.jsx)("div",{className:"relative z-10 w-full max-w-4xl px-4 transition-all duration-500",children:(0,Ba.jsxs)("div",{className:"bg-white/10 backdrop-blur-xl border border-white/20 shadow-2xl rounded-3xl overflow-hidden flex flex-col min-h-[500px]",children:[(0,Ba.jsxs)("div",{className:"p-8 text-center border-b border-white/10 relative",children:[(0,Ba.jsx)("div",{className:"inline-block p-1 bg-gradient-to-br from-white/20 to-transparent rounded-full mb-4 backdrop-blur-md shadow-lg ring-1 ring-white/30",children:(0,Ba.jsx)("img",{src:(null===h||void 0===h?void 0:h.profilePhoto)||"/logo.png",alt:"Logo",className:"w-20 h-20 rounded-full object-cover",onError:e=>{e.target.src="/logo.png"}})}),(0,Ba.jsx)("h1",{className:"text-3xl md:text-4xl font-extrabold text-white tracking-tight drop-shadow-lg",children:h?h.name:a?a.name:"Mutants Academy"}),(0,Ba.jsx)("p",{className:"text-blue-200 text-sm font-medium tracking-wider uppercase mt-2",children:h?"Enter Password":n?"".concat(n," Portal"):"Welcome Warrior"})]}),(0,Ba.jsx)("div",{className:"p-8 flex-grow flex flex-col justify-center items-center w-full",children:n?a?"fighter"!==n||h?(0,Ba.jsxs)("div",{className:"w-full max-w-md animate-fade-in",children:[(0,Ba.jsxs)("form",{onSubmit:"admin"===n?async e=>{e.preventDefault(),p(null),m(!0);try{const e=await ja.post("/auth/login",fn(fn({},o),{},{role:"admin",tenantSlug:null===a||void 0===a?void 0:a.slug}));localStorage.setItem("token",e.data.token),t(e.data.user),T("/admin/dashboard")}catch(n){p("Invalid admin credentials.")}finally{m(!1)}}:async e=>{if(e.preventDefault(),h){p(null),m(!0);try{const{data:e}=await ja.post("/auth/login",{email:h.email,password:_,role:"fighter",tenantSlug:null===a||void 0===a?void 0:a.slug});localStorage.setItem("token",e.token),t(e.user),T(e.user.profile_completed?"/fighter":"/fighter/complete-profile")}catch(i){var n,r;p((null===(n=i.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.msg)||"Invalid password.")}finally{m(!1)}}},className:"space-y-5",children:["admin"===n&&(0,Ba.jsxs)("div",{className:"relative group",children:[(0,Ba.jsx)(cn,{className:"absolute left-4 top-4 text-gray-400 group-focus-within:text-white transition-colors"}),(0,Ba.jsx)("input",{type:"email",value:o.email,onChange:e=>s(fn(fn({},o),{},{email:e.target.value})),placeholder:"admin@example.com",className:"w-full pl-12 pr-4 py-4 bg-black/20 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:bg-black/40 focus:border-white/30 transition-all",required:!0})]}),(0,Ba.jsxs)("div",{className:"relative group",children:[(0,Ba.jsx)(jt,{className:"absolute left-4 top-4 text-gray-400 group-focus-within:text-white transition-colors"}),(0,Ba.jsx)("input",{type:"admin"===n?x?"text":"password":w?"text":"password",value:"admin"===n?o.password:_,onChange:e=>"admin"===n?s(fn(fn({},o),{},{password:e.target.value})):I(e.target.value),placeholder:"Password",className:"w-full pl-12 pr-12 py-4 bg-black/20 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:bg-black/40 focus:border-white/30 transition-all",required:!0}),(0,Ba.jsx)("button",{type:"button",onClick:()=>"admin"===n?y(!x):k(!w),className:"absolute right-4 top-4 text-gray-400 hover:text-white transition-colors",children:"admin"===n?x?(0,Ba.jsx)(_t,{}):(0,Ba.jsx)(It,{}):w?(0,Ba.jsx)(_t,{}):(0,Ba.jsx)(It,{})})]}),(0,Ba.jsx)("div",{className:"flex justify-end",children:(0,Ba.jsx)(ze,{to:"/forgot-password",className:"text-sm text-blue-300 hover:text-white transition-colors",children:"Forgot Password?"})}),f&&(0,Ba.jsx)("div",{className:"p-3 rounded-lg bg-red-500/20 border border-red-500/40 text-red-200 text-sm text-center animate-pulse",children:f}),(0,Ba.jsx)("button",{type:"submit",disabled:g,className:"w-full py-4 font-bold text-white rounded-xl shadow-lg transform transition-all duration-300 hover:scale-[1.02] flex justify-center items-center ".concat("admin"===n?"bg-gradient-to-r from-red-600 to-red-800 hover:from-red-500 hover:to-red-700":"bg-gradient-to-r from-blue-600 to-blue-800 hover:from-blue-500 hover:to-blue-700"),children:g?"Authenticating...":"Sign In"})]}),(0,Ba.jsx)("div",{className:"text-center mt-6",children:(0,Ba.jsxs)("button",{onClick:"fighter"===n?()=>{d(null),I("")}:R,className:"text-gray-400 hover:text-white text-sm flex items-center justify-center gap-2 mx-auto transition-colors",children:[(0,Ba.jsx)(it,{})," ","fighter"===n?"Back to Fighters":"Back to Gym"]})})]}):(0,Ba.jsxs)("div",{className:"w-full animate-fade-in",children:[(0,Ba.jsxs)("div",{className:"relative mb-6 max-w-md mx-auto",children:[(0,Ba.jsx)(Gt,{className:"absolute left-4 top-3.5 text-gray-400 group-focus-within:text-white transition-colors"}),(0,Ba.jsx)("input",{type:"text",placeholder:"Search your name...",className:"w-full pl-12 pr-4 py-3 bg-black/20 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:bg-black/40 focus:border-white/30 transition-all glass-card",value:v,onChange:e=>b(e.target.value)})]}),g?(0,Ba.jsx)("div",{className:"text-center text-white/50 py-10",children:"Loading roster..."}):(0,Ba.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4 max-h-[350px] overflow-y-auto pr-2 custom-scrollbar",children:[D.map(e=>(0,Ba.jsxs)("div",{onClick:()=>(e=>{d(e),p(null),I("")})(e),className:"glass-card group rounded-2xl p-4 flex flex-col items-center cursor-pointer transition-all duration-300 hover:scale-105 hover:bg-white/10 hover:border-white/20",children:[(0,Ba.jsx)("div",{className:"w-16 h-16 rounded-full overflow-hidden border-2 border-transparent group-hover:border-red-400 mb-3 transition-all relative flex items-center justify-center",style:{backgroundColor:e.profilePhoto?"transparent":"#EF4444"},children:e.profilePhoto?(0,Ba.jsx)("img",{src:e.profilePhoto,alt:e.name,className:"w-full h-full object-cover",onError:e=>{e.target.src="/logo.png"}}):(0,Ba.jsx)("span",{className:"text-white text-xl font-bold",children:A(e.name)})}),(0,Ba.jsx)("h4",{className:"text-white font-semibold text-sm text-center truncate w-full",children:e.name}),(0,Ba.jsx)("p",{className:"text-xs text-gray-400 truncate w-full text-center",children:e.rfid})]},e._id)),0===D.length&&(0,Ba.jsx)("p",{className:"col-span-full text-center text-gray-500",children:"No fighters found."})]}),(0,Ba.jsx)("div",{className:"text-center mt-6",children:(0,Ba.jsxs)("button",{onClick:R,className:"text-gray-400 hover:text-white text-sm transition-colors duration-300 flex items-center justify-center gap-1 mx-auto",children:[(0,Ba.jsx)(it,{size:14})," Change Gym"]})})]}):(0,Ba.jsx)("div",{className:"w-full max-w-md animate-fade-in",children:(0,Ba.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),N.trim()){m(!0),E("");try{const e=await ja.get("/tenants/".concat(N));i(e.data)}catch(t){E("Gym not found. Please check the ID.")}finally{m(!1)}}else E("Please enter a company name")},className:"space-y-6",children:[(0,Ba.jsxs)("div",{className:"relative group",children:[(0,Ba.jsx)(ut,{className:"absolute left-4 top-4 text-gray-400 group-focus-within:text-white transition-colors"}),(0,Ba.jsx)("input",{type:"text",placeholder:"Enter Gym ID (e.g. mutants)",className:"w-full pl-12 pr-4 py-4 bg-black/20 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:bg-black/40 focus:border-white/30 transition-all",value:N,onChange:e=>S(e.target.value)})]}),C&&(0,Ba.jsx)("div",{className:"text-red-300 text-sm text-center bg-red-500/20 p-2 rounded-lg",children:C}),(0,Ba.jsx)("button",{type:"submit",disabled:g,className:"w-full py-4 bg-white/10 hover:bg-white/20 border border-white/20 rounded-xl text-white font-bold transition-all",children:g?"Searching...":"Continue"}),(0,Ba.jsx)("div",{className:"text-center",children:(0,Ba.jsx)("button",{type:"button",onClick:R,className:"text-gray-400 hover:text-white text-sm",children:"Back"})})]})}):(0,Ba.jsxs)("div",{className:"w-full max-w-md space-y-4 animate-fade-in",children:[(0,Ba.jsxs)("button",{onClick:()=>r("admin"),className:"group w-full relative overflow-hidden rounded-2xl p-[1px] transition-all hover:scale-[1.02]",children:[(0,Ba.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-red-500 to-orange-500 opacity-50 group-hover:opacity-100 transition-opacity"}),(0,Ba.jsxs)("div",{className:"relative flex items-center p-6 bg-gray-900/90 rounded-2xl h-full",children:[(0,Ba.jsx)("div",{className:"p-3 bg-red-500/20 rounded-full mr-4 text-red-400",children:(0,Ba.jsx)(sn,{size:24})}),(0,Ba.jsxs)("div",{className:"text-left",children:[(0,Ba.jsx)("h3",{className:"text-lg font-bold text-white",children:"Admin Access"}),(0,Ba.jsx)("p",{className:"text-xs text-gray-400",children:"Manage gym, fighters & settings"})]})]})]}),(0,Ba.jsxs)("button",{onClick:()=>r("fighter"),className:"group w-full relative overflow-hidden rounded-2xl p-[1px] transition-all hover:scale-[1.02]",children:[(0,Ba.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-500 to-cyan-500 opacity-50 group-hover:opacity-100 transition-opacity"}),(0,Ba.jsxs)("div",{className:"relative flex items-center p-6 bg-gray-900/90 rounded-2xl h-full",children:[(0,Ba.jsx)("div",{className:"p-3 bg-blue-500/20 rounded-full mr-4 text-blue-400",children:(0,Ba.jsx)(Nt,{size:24})}),(0,Ba.jsxs)("div",{className:"text-left",children:[(0,Ba.jsx)("h3",{className:"text-lg font-bold text-white",children:"Fighter Access"}),(0,Ba.jsx)("p",{className:"text-xs text-gray-400",children:"View stats, attendance & profile"})]})]})]}),(0,Ba.jsx)("div",{className:"text-center mt-4",children:(0,Ba.jsx)("button",{onClick:()=>T("/superadmin/login"),className:"text-gray-400 hover:text-purple-400 text-sm transition-colors",children:"Super Admin Login"})})]})})]})})]})};function Wa(e){return et({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"},child:[]},{tag:"polyline",attr:{points:"12 5 19 12 12 19"},child:[]}]})(e)}function Ua(e){return et({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"},child:[]},{tag:"polyline",attr:{points:"22 4 12 14.01 9 11.01"},child:[]}]})(e)}function Va(e){return et({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"polyline",attr:{points:"12 6 12 12 16 14"},child:[]}]})(e)}function Ha(e){return et({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"4",y:"4",width:"16",height:"16",rx:"2",ry:"2"},child:[]},{tag:"rect",attr:{x:"9",y:"9",width:"6",height:"6"},child:[]},{tag:"line",attr:{x1:"9",y1:"1",x2:"9",y2:"4"},child:[]},{tag:"line",attr:{x1:"15",y1:"1",x2:"15",y2:"4"},child:[]},{tag:"line",attr:{x1:"9",y1:"20",x2:"9",y2:"23"},child:[]},{tag:"line",attr:{x1:"15",y1:"20",x2:"15",y2:"23"},child:[]},{tag:"line",attr:{x1:"20",y1:"9",x2:"23",y2:"9"},child:[]},{tag:"line",attr:{x1:"20",y1:"14",x2:"23",y2:"14"},child:[]},{tag:"line",attr:{x1:"1",y1:"9",x2:"4",y2:"9"},child:[]},{tag:"line",attr:{x1:"1",y1:"14",x2:"4",y2:"14"},child:[]}]})(e)}function Ga(e){return et({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"3",y1:"12",x2:"21",y2:"12"},child:[]},{tag:"line",attr:{x1:"3",y1:"6",x2:"21",y2:"6"},child:[]},{tag:"line",attr:{x1:"3",y1:"18",x2:"21",y2:"18"},child:[]}]})(e)}function qa(e){return et({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"polygon",attr:{points:"10 8 16 12 10 16 10 8"},child:[]}]})(e)}function Ka(e){return et({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"9",cy:"7",r:"4"},child:[]},{tag:"path",attr:{d:"M23 21v-2a4 4 0 0 0-3-3.87"},child:[]},{tag:"path",attr:{d:"M16 3.13a4 4 0 0 1 0 7.75"},child:[]}]})(e)}function Xa(e){return et({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"},child:[]},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"},child:[]}]})(e)}const Ya=[{label:"Platform",target:"features"},{label:"Benefits",target:"benefits"},{label:"Demo",target:"demo"},{label:"Pricing",target:"pricing"},{label:"Testimonials",target:"testimonials"},{label:"FAQ",target:"faq"}],$a=[{title:"AI-ready Attendance",description:"Hybrid RFID + face recognition stack that keeps every class accountable in seconds.",icon:function(e){return et({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"},child:[]}]})(e)}},{title:"Realtime dashboards",description:"See every fighter's training streak, readiness, and gaps with live updating metrics.",icon:function(e){return et({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 6 13.5 15.5 8.5 10.5 1 18"},child:[]},{tag:"polyline",attr:{points:"17 6 23 6 23 12"},child:[]}]})(e)}},{title:"Automated workflows",description:"Smart nudges, doubt resolution queues, and leveling checkpoints built-in.",icon:function(e){return et({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"},child:[]}]})(e)}}],Ja=[{title:"Unified control room",description:"Admins operate the entire academy from a single panel that ties together people, progress, and performance."},{title:"Motivated fighters",description:"Fighters see clear goals, milestones, and streak rewards that keep them progressing every week."},{title:"Operational clarity",description:"Forecast staffing, prep certifications, and de-risk events with proactive alerts."}],Qa=[{name:"Starter",price:"$49",cadence:"per month",description:"Perfect for boutique academies getting started with digital ops.",features:["30 fighters included","Attendance automation","1 admin seat","Email support"],cta:"Launch Starter"},{name:"Growth",highlight:!0,price:"$129",cadence:"per month",description:"Everything you need to run a multi-location combat program.",features:["120 fighters included","Advanced analytics","3 admin seats","Priority support"],cta:"Scale with Growth"},{name:"Elite",price:"Custom",cadence:"engagement",description:"White-glove enablement for franchises and enterprise training orgs.",features:["Unlimited fighters","Dedicated CSM","Custom integrations","On-site onboarding"],cta:"Talk to Sales"}],Za=[{quote:"Mutants Academy turned our chaotic attendance manual into a 2-minute ritual. Fighters love the instant feedback.",name:"Coach Aisha Bhatt",role:"Head Coach, Iron Circle"},{quote:"Level tracking and doubt queues brought transparency. We finally know who needs help before belt tests.",name:"Santiago Rivera",role:"Program Director, Pulse Combat"},{quote:"Our admin overhead dropped by 40%. The platform pays for itself every quarter.",name:"Mei Chen",role:"Operations Lead, Titan Dojo"}],ei=[{question:"How long does onboarding take?",answer:"Most academies launch within a single week. We migrate your rosters, set up attendance devices, and train staff."},{question:"Does it work with our existing RFID cards?",answer:"Yes. We support common RFID/NFC standards and can ship pre-configured readers if needed."},{question:"Is fighter data secure?",answer:"All data is encrypted in transit and at rest. Role-based access keeps sensitive information locked down."},{question:"Can we export reports?",answer:"Absolutely. Download CSV/PDF summaries for attendance, progress, leveling, and payout operations anytime."}],ti=()=>{const[e,t]=(0,l.useState)(!1),[n,r]=(0,l.useState)(0),a=e=>{(e=>{const t=document.getElementById(e);t&&t.scrollIntoView({behavior:"smooth",block:"start"})})(e),t(!1)};return(0,Ba.jsxs)("div",{className:"bg-neutral text-slate-800 min-h-screen",children:[(0,Ba.jsxs)("div",{className:"relative isolate overflow-hidden text-white bg-gradient-to-r from-slate-950 via-slate-900 to-slate-800",children:[(0,Ba.jsx)("div",{className:"absolute inset-0 opacity-70 bg-[radial-gradient(circle_at_top_left,_rgba(59,130,246,0.45),_transparent_55%)]"}),(0,Ba.jsx)("div",{className:"absolute inset-0 opacity-60 bg-[radial-gradient(circle_at_bottom_right,_rgba(16,185,129,0.35),_transparent_60%)]"}),(0,Ba.jsx)("div",{className:"absolute inset-0 bg-gradient-to-b from-slate-900/40 via-transparent to-slate-950/80"}),(0,Ba.jsxs)("div",{className:"relative z-10",children:[(0,Ba.jsxs)("header",{className:"mx-auto px-6 lg:px-8 py-6 flex items-center justify-between",children:[(0,Ba.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ba.jsx)("div",{className:"h-10 w-10 rounded-2xl bg-accent/20 border border-white/20 flex items-center justify-center font-bold",children:"MA"}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("p",{className:"text-xl font-semibold",children:"Mutants Academy"}),(0,Ba.jsx)("p",{className:"text-xs text-white/70 tracking-widest uppercase",children:"Combat Platform"})]})]}),(0,Ba.jsxs)("nav",{className:"hidden lg:flex items-center space-x-8 text-sm uppercase tracking-wide",children:[Ya.map(e=>(0,Ba.jsx)("button",{onClick:()=>a(e.target),className:"text-white/80 hover:text-white transition",children:e.label},e.target)),(0,Ba.jsx)(ze,{to:"/login",className:"inline-flex items-center space-x-2 bg-white text-primary font-semibold px-5 py-2 rounded-full hover:bg-accent hover:text-white transition",children:(0,Ba.jsx)("span",{children:"Login"})}),(0,Ba.jsx)(ze,{to:"/signup",className:"inline-flex items-center space-x-2 bg-accent text-white font-semibold px-5 py-2 rounded-full hover:bg-accent/80 transition",children:(0,Ba.jsx)("span",{children:"Sign Up"})})]}),(0,Ba.jsx)("button",{className:"lg:hidden text-white text-2xl",onClick:()=>t(e=>!e),"aria-label":"Toggle navigation menu",children:e?(0,Ba.jsx)(Xa,{}):(0,Ba.jsx)(Ga,{})})]}),e&&(0,Ba.jsxs)("div",{className:"lg:hidden px-6 pb-6 text-white space-y-4",children:[Ya.map(e=>(0,Ba.jsx)("button",{onClick:()=>a(e.target),className:"block w-full text-left py-2 text-lg font-semibold",children:e.label},e.target)),(0,Ba.jsx)(ze,{to:"/login",onClick:()=>t(!1),className:"inline-flex w-full items-center justify-center space-x-2 bg-white text-primary font-semibold px-5 py-3 rounded-full hover:bg-accent hover:text-white transition",children:(0,Ba.jsx)("span",{children:"Login"})}),(0,Ba.jsx)(ze,{to:"/signup",onClick:()=>t(!1),className:"inline-flex w-full items-center justify-center space-x-2 bg-accent text-white font-semibold px-5 py-3 rounded-full hover:bg-accent/80 transition",children:(0,Ba.jsx)("span",{children:"Sign Up"})})]}),(0,Ba.jsx)("section",{className:"mx-auto px-6 lg:px-8 pb-16 pt-10 lg:pt-16",children:(0,Ba.jsxs)("div",{className:"grid lg:grid-cols-[1.1fr_0.9fr] gap-12 items-center",children:[(0,Ba.jsxs)("div",{className:"space-y-8",children:[(0,Ba.jsxs)("p",{className:"inline-flex items-center space-x-2 text-sm uppercase tracking-[0.3em] text-white/60",children:[(0,Ba.jsx)("span",{className:"h-px w-8 bg-white/40"}),(0,Ba.jsx)("span",{children:"Combat ops cloud"})]}),(0,Ba.jsx)("h1",{className:"text-4xl sm:text-5xl lg:text-6xl leading-tight font-semibold",children:"Elite training orchestration for high-growth academies."}),(0,Ba.jsx)("p",{className:"text-lg text-white/80",children:"Mutants Academy unifies attendance, leveling, doubts, and coaching workflows so teams can train harder and ship results faster."}),(0,Ba.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,Ba.jsxs)(ze,{to:"/login",className:"inline-flex items-center space-x-3 bg-accent text-white font-semibold px-6 py-3 rounded-full shadow-lg shadow-accent/30 hover:-translate-y-0.5 transition transform",children:[(0,Ba.jsx)("span",{children:"Go to Console"}),(0,Ba.jsx)(Wa,{})]}),(0,Ba.jsxs)("button",{onClick:()=>a("demo"),className:"inline-flex items-center space-x-3 border border-white/30 bg-white/10 backdrop-blur px-6 py-3 rounded-full hover:bg-white/20 transition",children:[(0,Ba.jsx)(qa,{className:"text-xl"}),(0,Ba.jsx)("span",{children:"Watch Demo"})]})]}),(0,Ba.jsxs)("div",{className:"grid grid-cols-2 gap-6 text-white/80",children:[(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("p",{className:"text-4xl font-bold",children:"12k+"}),(0,Ba.jsx)("p",{className:"text-sm uppercase tracking-wide",children:"Sessions automated"})]}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("p",{className:"text-4xl font-bold",children:"97%"}),(0,Ba.jsx)("p",{className:"text-sm uppercase tracking-wide",children:"Attendance accuracy"})]})]})]}),(0,Ba.jsxs)("div",{className:"relative",children:[(0,Ba.jsx)("div",{className:"absolute -inset-4 bg-accent/20 blur-3xl rounded-[56px]"}),(0,Ba.jsx)("div",{className:"relative bg-white/5 border border-white/10 rounded-[48px] aspect-video flex items-center justify-center",children:(0,Ba.jsx)("div",{className:"bg-gradient-to-br from-accent/20 to-accent/5 border border-accent/20 rounded-[40px] w-[90%] h-[90%] flex items-center justify-center",children:(0,Ba.jsx)(qa,{className:"text-5xl text-accent"})})})]})]})})]})]}),(0,Ba.jsx)("section",{id:"features",className:"py-20 bg-white",children:(0,Ba.jsxs)("div",{className:"mx-auto px-6 lg:px-8 max-w-7xl",children:[(0,Ba.jsxs)("div",{className:"text-center max-w-3xl mx-auto mb-16",children:[(0,Ba.jsxs)("p",{className:"inline-flex items-center space-x-2 text-sm uppercase tracking-[0.3em] text-slate-500 mb-4",children:[(0,Ba.jsx)("span",{className:"h-px w-8 bg-slate-400"}),(0,Ba.jsx)("span",{children:"Platform capabilities"})]}),(0,Ba.jsx)("h2",{className:"text-3xl sm:text-4xl font-bold text-slate-900 mb-6",children:"Precision tools for modern academies"}),(0,Ba.jsx)("p",{className:"text-lg text-slate-600",children:"Purpose-built features that eliminate manual work and surface actionable insights."})]}),(0,Ba.jsx)("div",{className:"grid md:grid-cols-3 gap-8",children:$a.map((e,t)=>{const n=e.icon;return(0,Ba.jsxs)("div",{className:"bg-slate-50 rounded-2xl p-6 border border-slate-200 hover:border-accent/30 hover:shadow-lg transition",children:[(0,Ba.jsx)("div",{className:"w-12 h-12 rounded-xl bg-accent/10 border border-accent/20 flex items-center justify-center mb-6",children:(0,Ba.jsx)(n,{className:"text-accent text-xl"})}),(0,Ba.jsx)("h3",{className:"text-xl font-semibold text-slate-900 mb-3",children:e.title}),(0,Ba.jsx)("p",{className:"text-slate-600",children:e.description})]},t)})})]})}),(0,Ba.jsx)("section",{id:"benefits",className:"py-20 bg-slate-50",children:(0,Ba.jsx)("div",{className:"mx-auto px-6 lg:px-8 max-w-7xl",children:(0,Ba.jsxs)("div",{className:"grid lg:grid-cols-2 gap-16 items-center",children:[(0,Ba.jsxs)("div",{children:[(0,Ba.jsxs)("p",{className:"inline-flex items-center space-x-2 text-sm uppercase tracking-[0.3em] text-slate-500 mb-4",children:[(0,Ba.jsx)("span",{className:"h-px w-8 bg-slate-400"}),(0,Ba.jsx)("span",{children:"Proven outcomes"})]}),(0,Ba.jsx)("h2",{className:"text-3xl sm:text-4xl font-bold text-slate-900 mb-6",children:"Measurable impact across your academy"}),(0,Ba.jsx)("div",{className:"space-y-8",children:Ja.map((e,t)=>(0,Ba.jsxs)("div",{className:"flex gap-4",children:[(0,Ba.jsx)("div",{className:"flex-shrink-0 mt-1",children:(0,Ba.jsx)(Ua,{className:"text-accent text-xl"})}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:e.title}),(0,Ba.jsx)("p",{className:"text-slate-600",children:e.description})]})]},t))})]}),(0,Ba.jsxs)("div",{className:"bg-gradient-to-br from-accent/10 to-accent/5 rounded-3xl p-8 border border-accent/20",children:[(0,Ba.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-6 mb-6",children:[(0,Ba.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Ba.jsx)("span",{className:"font-semibold text-slate-900",children:"Weekly Attendance"}),(0,Ba.jsx)("span",{className:"text-sm text-slate-500",children:"Last 30 days"})]}),(0,Ba.jsx)("div",{className:"h-32 flex items-end gap-2",children:[65,78,82,75,90,85,92].map((e,t)=>(0,Ba.jsxs)("div",{className:"flex-1 flex flex-col items-center",children:[(0,Ba.jsx)("div",{className:"w-full bg-gradient-to-t from-accent to-accent/80 rounded-t-sm",style:{height:"".concat(e,"%")}}),(0,Ba.jsx)("span",{className:"text-xs text-slate-500 mt-2",children:t+1})]},t))})]}),(0,Ba.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Ba.jsxs)("div",{className:"bg-white rounded-xl p-4 border border-slate-200",children:[(0,Ba.jsx)("p",{className:"text-2xl font-bold text-slate-900",children:"89%"}),(0,Ba.jsx)("p",{className:"text-sm text-slate-600",children:"Avg. retention"})]}),(0,Ba.jsxs)("div",{className:"bg-white rounded-xl p-4 border border-slate-200",children:[(0,Ba.jsx)("p",{className:"text-2xl font-bold text-slate-900",children:"2.1x"}),(0,Ba.jsx)("p",{className:"text-sm text-slate-600",children:"Faster leveling"})]})]})]})]})})}),(0,Ba.jsx)("section",{id:"demo",className:"py-20 bg-white",children:(0,Ba.jsxs)("div",{className:"mx-auto px-6 lg:px-8 max-w-4xl text-center",children:[(0,Ba.jsxs)("p",{className:"inline-flex items-center space-x-2 text-sm uppercase tracking-[0.3em] text-slate-500 mb-4",children:[(0,Ba.jsx)("span",{className:"h-px w-8 bg-slate-400"}),(0,Ba.jsx)("span",{children:"Interactive preview"})]}),(0,Ba.jsx)("h2",{className:"text-3xl sm:text-4xl font-bold text-slate-900 mb-6",children:"See the platform in action"}),(0,Ba.jsx)("p",{className:"text-lg text-slate-600 mb-12 max-w-2xl mx-auto",children:"Watch how Mutants Academy transforms academy operations from chaos to clarity."}),(0,Ba.jsxs)("div",{className:"relative bg-gradient-to-br from-slate-900 to-slate-800 rounded-3xl overflow-hidden border border-slate-700 aspect-video max-w-4xl mx-auto",children:[(0,Ba.jsx)("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_center,_rgba(59,130,246,0.15),_transparent_70%)]"}),(0,Ba.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,Ba.jsxs)("button",{className:"inline-flex items-center space-x-3 bg-accent text-white font-semibold px-8 py-4 rounded-full shadow-lg hover:bg-accent/90 transition",children:[(0,Ba.jsx)(qa,{className:"text-2xl"}),(0,Ba.jsx)("span",{children:"Play Demo (2:47)"})]})}),(0,Ba.jsxs)("div",{className:"absolute bottom-4 left-4 right-4 flex justify-between items-center",children:[(0,Ba.jsx)("div",{className:"text-white/80 text-sm",children:"Platform Tour"}),(0,Ba.jsx)("div",{className:"text-white/60 text-sm",children:"2:47"})]})]})]})}),(0,Ba.jsx)("section",{id:"pricing",className:"py-20 bg-slate-50",children:(0,Ba.jsxs)("div",{className:"mx-auto px-6 lg:px-8 max-w-7xl",children:[(0,Ba.jsxs)("div",{className:"text-center max-w-3xl mx-auto mb-16",children:[(0,Ba.jsxs)("p",{className:"inline-flex items-center space-x-2 text-sm uppercase tracking-[0.3em] text-slate-500 mb-4",children:[(0,Ba.jsx)("span",{className:"h-px w-8 bg-slate-400"}),(0,Ba.jsx)("span",{children:"Simple pricing"})]}),(0,Ba.jsx)("h2",{className:"text-3xl sm:text-4xl font-bold text-slate-900 mb-6",children:"Plans that scale with your academy"}),(0,Ba.jsx)("p",{className:"text-lg text-slate-600",children:"Start free, then pay as you grow. All plans include core features."})]}),(0,Ba.jsx)("div",{className:"grid md:grid-cols-3 gap-8 max-w-5xl mx-auto",children:Qa.map((e,t)=>(0,Ba.jsxs)("div",{className:"rounded-2xl p-8 border ".concat(e.highlight?"border-accent bg-gradient-to-b from-accent/5 to-white relative ring-1 ring-accent/20 shadow-lg shadow-accent/10":"border-slate-200 bg-white"),children:[e.highlight&&(0,Ba.jsx)("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-accent text-white px-4 py-1 rounded-full text-sm font-semibold",children:"MOST POPULAR"}),(0,Ba.jsx)("h3",{className:"text-xl font-semibold mb-2 ".concat((e.highlight,"text-slate-900")),children:e.name}),(0,Ba.jsxs)("div",{className:"mb-4",children:[(0,Ba.jsx)("span",{className:"text-4xl font-bold text-slate-900",children:e.price}),e.cadence&&(0,Ba.jsxs)("span",{className:"text-slate-600",children:[" ",e.cadence]})]}),(0,Ba.jsx)("p",{className:"mb-6 ".concat(e.highlight?"text-slate-700":"text-slate-600"),children:e.description}),(0,Ba.jsx)("ul",{className:"mb-8 space-y-3",children:e.features.map((t,n)=>(0,Ba.jsxs)("li",{className:"flex items-center",children:[(0,Ba.jsx)(Ua,{className:"mr-2 ".concat(e.highlight?"text-accent":"text-slate-400")}),(0,Ba.jsx)("span",{className:e.highlight?"text-slate-700":"text-slate-600",children:t})]},n))}),(0,Ba.jsx)(ze,{to:"/signup",className:"w-full py-3 rounded-lg font-semibold text-center transition ".concat(e.highlight?"bg-accent text-white hover:bg-accent/90 shadow-md shadow-accent/20":"bg-slate-100 text-slate-900 hover:bg-slate-200"),children:e.cta})]},t))})]})}),(0,Ba.jsx)("section",{id:"testimonials",className:"py-20 bg-white",children:(0,Ba.jsxs)("div",{className:"mx-auto px-6 lg:px-8 max-w-7xl",children:[(0,Ba.jsxs)("div",{className:"text-center max-w-3xl mx-auto mb-16",children:[(0,Ba.jsxs)("p",{className:"inline-flex items-center space-x-2 text-sm uppercase tracking-[0.3em] text-slate-500 mb-4",children:[(0,Ba.jsx)("span",{className:"h-px w-8 bg-slate-400"}),(0,Ba.jsx)("span",{children:"Trusted by pros"})]}),(0,Ba.jsx)("h2",{className:"text-3xl sm:text-4xl font-bold text-slate-900 mb-6",children:"Loved by academy leaders worldwide"}),(0,Ba.jsx)("p",{className:"text-lg text-slate-600 mb-10 max-w-2xl mx-auto",children:"Join thousands of academy leaders who trust Mutants Academy to streamline operations and boost fighter performance."})]}),(0,Ba.jsx)("div",{className:"grid md:grid-cols-3 gap-8",children:Za.map((e,t)=>(0,Ba.jsxs)("div",{className:"bg-slate-50 rounded-2xl p-8 border border-slate-200",children:[(0,Ba.jsx)("div",{className:"text-accent mb-4",children:"\u2605".repeat(5)}),(0,Ba.jsxs)("p",{className:"text-lg text-slate-700 mb-6 italic",children:['"',e.quote,'"']}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("p",{className:"font-semibold text-slate-900",children:e.name}),(0,Ba.jsx)("p",{className:"text-slate-600",children:e.role})]})]},t))})]})}),(0,Ba.jsx)("section",{id:"faq",className:"py-20 bg-slate-50",children:(0,Ba.jsxs)("div",{className:"mx-auto px-6 lg:px-8 max-w-4xl",children:[(0,Ba.jsxs)("div",{className:"text-center max-w-3xl mx-auto mb-16",children:[(0,Ba.jsxs)("p",{className:"inline-flex items-center space-x-2 text-sm uppercase tracking-[0.3em] text-slate-500 mb-4",children:[(0,Ba.jsx)("span",{className:"h-px w-8 bg-slate-400"}),(0,Ba.jsx)("span",{children:"Questions answered"})]}),(0,Ba.jsx)("h2",{className:"text-3xl sm:text-4xl font-bold text-slate-900 mb-6",children:"Frequently asked questions"})]}),(0,Ba.jsx)("div",{className:"space-y-4",children:ei.map((e,t)=>(0,Ba.jsxs)("div",{className:"bg-white rounded-2xl border border-slate-200 overflow-hidden",children:[(0,Ba.jsxs)("button",{className:"w-full flex justify-between items-center p-6 text-left",onClick:()=>(e=>{r(t=>t===e?-1:e)})(t),children:[(0,Ba.jsx)("span",{className:"font-semibold text-slate-900",children:e.question}),(0,Ba.jsx)(Wa,{className:"transform transition-transform ".concat(n===t?"rotate-90":"")})]}),n===t&&(0,Ba.jsx)("div",{className:"px-6 pb-6 text-slate-600",children:e.answer})]},t))})]})}),(0,Ba.jsx)("section",{className:"py-20 bg-gradient-to-r from-slate-900 to-slate-800 text-white",children:(0,Ba.jsxs)("div",{className:"mx-auto px-6 lg:px-8 max-w-4xl text-center",children:[(0,Ba.jsx)("h2",{className:"text-3xl sm:text-4xl font-bold mb-6",children:"Ready to transform your academy?"}),(0,Ba.jsx)("p",{className:"text-lg text-slate-300 mb-10 max-w-2xl mx-auto",children:"Join thousands of academy leaders who trust Mutants Academy to streamline operations and boost fighter performance."}),(0,Ba.jsxs)("div",{className:"flex flex-wrap justify-center gap-4",children:[(0,Ba.jsx)(ze,{to:"/signup",className:"inline-flex items-center space-x-3 bg-accent text-white font-semibold px-8 py-4 rounded-full shadow-lg hover:bg-accent/90 transition",children:(0,Ba.jsx)("span",{children:"Start Free Trial"})}),(0,Ba.jsx)(ze,{to:"/login",className:"inline-flex items-center space-x-3 border border-white/30 bg-white/10 backdrop-blur px-8 py-4 rounded-full hover:bg-white/20 transition",children:(0,Ba.jsx)("span",{children:"Login"})})]})]})}),(0,Ba.jsx)("footer",{className:"bg-slate-900 text-slate-400 py-16",children:(0,Ba.jsxs)("div",{className:"mx-auto px-6 lg:px-8 max-w-7xl",children:[(0,Ba.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-12",children:[(0,Ba.jsxs)("div",{className:"lg:col-span-2",children:[(0,Ba.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,Ba.jsx)("div",{className:"h-10 w-10 rounded-2xl bg-accent/20 border border-white/20 flex items-center justify-center font-bold text-white",children:"MA"}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("p",{className:"text-xl font-semibold text-white",children:"Mutants Academy"}),(0,Ba.jsx)("p",{className:"text-xs text-white/70 tracking-widest uppercase",children:"Combat Platform"})]})]}),(0,Ba.jsx)("p",{className:"mb-6 max-w-sm",children:"Elite training orchestration for high-growth academies worldwide."}),(0,Ba.jsxs)("div",{className:"flex space-x-4",children:[(0,Ba.jsx)("a",{href:"#",className:"text-slate-400 hover:text-white transition",children:(0,Ba.jsx)(Ka,{className:"text-xl"})}),(0,Ba.jsx)("a",{href:"#",className:"text-slate-400 hover:text-white transition",children:(0,Ba.jsx)(Va,{className:"text-xl"})}),(0,Ba.jsx)("a",{href:"#",className:"text-slate-400 hover:text-white transition",children:(0,Ba.jsx)(Ha,{className:"text-xl"})})]})]}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("h4",{className:"text-white font-semibold mb-6",children:"Product"}),(0,Ba.jsxs)("ul",{className:"space-y-4",children:[(0,Ba.jsx)("li",{children:(0,Ba.jsx)("a",{href:"#",className:"hover:text-white transition",children:"Features"})}),(0,Ba.jsx)("li",{children:(0,Ba.jsx)("a",{href:"#",className:"hover:text-white transition",children:"Solutions"})}),(0,Ba.jsx)("li",{children:(0,Ba.jsx)("a",{href:"#",className:"hover:text-white transition",children:"Pricing"})}),(0,Ba.jsx)("li",{children:(0,Ba.jsx)("a",{href:"#",className:"hover:text-white transition",children:"Demo"})})]})]}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("h4",{className:"text-white font-semibold mb-6",children:"Resources"}),(0,Ba.jsxs)("ul",{className:"space-y-4",children:[(0,Ba.jsx)("li",{children:(0,Ba.jsx)("a",{href:"#",className:"hover:text-white transition",children:"Blog"})}),(0,Ba.jsx)("li",{children:(0,Ba.jsx)("a",{href:"#",className:"hover:text-white transition",children:"Documentation"})}),(0,Ba.jsx)("li",{children:(0,Ba.jsx)("a",{href:"#",className:"hover:text-white transition",children:"Guides"})}),(0,Ba.jsx)("li",{children:(0,Ba.jsx)("a",{href:"#",className:"hover:text-white transition",children:"Support"})})]})]}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("h4",{className:"text-white font-semibold mb-6",children:"Company"}),(0,Ba.jsxs)("ul",{className:"space-y-4",children:[(0,Ba.jsx)("li",{children:(0,Ba.jsx)("a",{href:"#",className:"hover:text-white transition",children:"About"})}),(0,Ba.jsx)("li",{children:(0,Ba.jsx)("a",{href:"#",className:"hover:text-white transition",children:"Careers"})}),(0,Ba.jsx)("li",{children:(0,Ba.jsx)("a",{href:"#",className:"hover:text-white transition",children:"Contact"})}),(0,Ba.jsx)("li",{children:(0,Ba.jsx)("a",{href:"#",className:"hover:text-white transition",children:"Partners"})})]})]})]}),(0,Ba.jsx)("div",{className:"border-t border-slate-800 mt-16 pt-8 text-sm text-center",children:(0,Ba.jsxs)("p",{children:["\xa9 ",(new Date).getFullYear()," Mutants Academy. All rights reserved."]})})]})})]})},ni=()=>{const e=le(),[t,n]=(0,l.useState)({gymName:"",gymSlug:"",email:"",password:"",confirmPassword:"",phone:"",street:"",city:"",state:"",zipCode:"",country:""}),[r,a]=(0,l.useState)(!1),[i,o]=(0,l.useState)(""),[s,c]=(0,l.useState)(!1),{gymName:u,gymSlug:h,email:d,password:f,confirmPassword:p,phone:g,street:m,city:v,state:b,zipCode:x,country:y}=t,w=e=>{if(n(fn(fn({},t),{},{[e.target.name]:e.target.value})),"gymName"===e.target.name){const t=e.target.value.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"");n(e=>fn(fn({},e),{},{gymSlug:t}))}};return(0,Ba.jsx)("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:(0,Ba.jsxs)("div",{className:"max-w-2xl w-full space-y-8",children:[(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-white",children:"Create Your Gym"}),(0,Ba.jsx)("p",{className:"mt-2 text-center text-sm text-gray-400",children:"Set up your gym management system"})]}),i&&(0,Ba.jsx)("div",{className:"bg-red-900 border border-red-700 text-red-200 px-4 py-3 rounded relative",role:"alert",children:(0,Ba.jsx)("span",{className:"block sm:inline",children:i})}),s&&(0,Ba.jsx)("div",{className:"bg-green-900 border border-green-700 text-green-200 px-4 py-3 rounded relative",role:"alert",children:(0,Ba.jsx)("span",{className:"block sm:inline",children:"Gym created successfully! Redirecting to login page..."})}),(0,Ba.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:async t=>{if(t.preventDefault(),f===p)if(f.length<6)o("Password must be at least 6 characters");else{a(!0),o("");try{const t={street:m,city:v,state:b,zipCode:x,country:y},n=await ja.post("/tenants/signup",{gymName:u,gymSlug:h,email:d,password:f,phone:g,address:t});localStorage.setItem("token",n.data.token),c(!0),setTimeout(()=>{e("/login?gym=".concat(n.data.tenant.slug))},2e3)}catch(i){var n,r;o((null===(n=i.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.msg)||"An error occurred during signup")}finally{a(!1)}}else o("Passwords do not match")},children:[(0,Ba.jsxs)("div",{className:"grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6",children:[(0,Ba.jsx)("div",{className:"sm:col-span-6",children:(0,Ba.jsx)("h3",{className:"text-lg font-medium text-white mb-4",children:"Gym Information"})}),(0,Ba.jsxs)("div",{className:"sm:col-span-3",children:[(0,Ba.jsx)("label",{htmlFor:"gymName",className:"block text-sm font-medium text-gray-300",children:"Gym Name"}),(0,Ba.jsx)("div",{className:"mt-1",children:(0,Ba.jsx)("input",{id:"gymName",name:"gymName",type:"text",required:!0,value:u,onChange:w,className:"appearance-none block w-full px-3 py-2 border border-gray-700 rounded-md shadow-sm placeholder-gray-500 bg-gray-800 text-white focus:outline-none focus:ring-red-500 focus:border-red-500 sm:text-sm"})})]}),(0,Ba.jsxs)("div",{className:"sm:col-span-3",children:[(0,Ba.jsx)("label",{htmlFor:"gymSlug",className:"block text-sm font-medium text-gray-300",children:"Gym URL Slug"}),(0,Ba.jsxs)("div",{className:"mt-1",children:[(0,Ba.jsx)("input",{id:"gymSlug",name:"gymSlug",type:"text",required:!0,value:h,onChange:w,className:"appearance-none block w-full px-3 py-2 border border-gray-700 rounded-md shadow-sm placeholder-gray-500 bg-gray-800 text-white focus:outline-none focus:ring-red-500 focus:border-red-500 sm:text-sm"}),(0,Ba.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"This will be your gym's unique identifier in the URL"})]})]}),(0,Ba.jsx)("div",{className:"sm:col-span-6",children:(0,Ba.jsx)("h3",{className:"text-lg font-medium text-white mb-4 mt-6",children:"Admin Credentials"})}),(0,Ba.jsxs)("div",{className:"sm:col-span-3",children:[(0,Ba.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-300",children:"Admin Email"}),(0,Ba.jsx)("div",{className:"mt-1",children:(0,Ba.jsx)("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:d,onChange:w,className:"appearance-none block w-full px-3 py-2 border border-gray-700 rounded-md shadow-sm placeholder-gray-500 bg-gray-800 text-white focus:outline-none focus:ring-red-500 focus:border-red-500 sm:text-sm"})})]}),(0,Ba.jsxs)("div",{className:"sm:col-span-3",children:[(0,Ba.jsx)("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-300",children:"Phone Number"}),(0,Ba.jsx)("div",{className:"mt-1",children:(0,Ba.jsx)("input",{id:"phone",name:"phone",type:"tel",value:g,onChange:w,className:"appearance-none block w-full px-3 py-2 border border-gray-700 rounded-md shadow-sm placeholder-gray-500 bg-gray-800 text-white focus:outline-none focus:ring-red-500 focus:border-red-500 sm:text-sm"})})]}),(0,Ba.jsxs)("div",{className:"sm:col-span-3",children:[(0,Ba.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300",children:"Password"}),(0,Ba.jsx)("div",{className:"mt-1",children:(0,Ba.jsx)("input",{id:"password",name:"password",type:"password",autoComplete:"new-password",required:!0,value:f,onChange:w,className:"appearance-none block w-full px-3 py-2 border border-gray-700 rounded-md shadow-sm placeholder-gray-500 bg-gray-800 text-white focus:outline-none focus:ring-red-500 focus:border-red-500 sm:text-sm"})})]}),(0,Ba.jsxs)("div",{className:"sm:col-span-3",children:[(0,Ba.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-300",children:"Confirm Password"}),(0,Ba.jsx)("div",{className:"mt-1",children:(0,Ba.jsx)("input",{id:"confirmPassword",name:"confirmPassword",type:"password",autoComplete:"new-password",required:!0,value:p,onChange:w,className:"appearance-none block w-full px-3 py-2 border border-gray-700 rounded-md shadow-sm placeholder-gray-500 bg-gray-800 text-white focus:outline-none focus:ring-red-500 focus:border-red-500 sm:text-sm"})})]}),(0,Ba.jsx)("div",{className:"sm:col-span-6",children:(0,Ba.jsx)("h3",{className:"text-lg font-medium text-white mb-4 mt-6",children:"Gym Address"})}),(0,Ba.jsxs)("div",{className:"sm:col-span-6",children:[(0,Ba.jsx)("label",{htmlFor:"street",className:"block text-sm font-medium text-gray-300",children:"Street Address"}),(0,Ba.jsx)("div",{className:"mt-1",children:(0,Ba.jsx)("input",{id:"street",name:"street",type:"text",value:m,onChange:w,className:"appearance-none block w-full px-3 py-2 border border-gray-700 rounded-md shadow-sm placeholder-gray-500 bg-gray-800 text-white focus:outline-none focus:ring-red-500 focus:border-red-500 sm:text-sm"})})]}),(0,Ba.jsxs)("div",{className:"sm:col-span-2",children:[(0,Ba.jsx)("label",{htmlFor:"city",className:"block text-sm font-medium text-gray-300",children:"City"}),(0,Ba.jsx)("div",{className:"mt-1",children:(0,Ba.jsx)("input",{id:"city",name:"city",type:"text",value:v,onChange:w,className:"appearance-none block w-full px-3 py-2 border border-gray-700 rounded-md shadow-sm placeholder-gray-500 bg-gray-800 text-white focus:outline-none focus:ring-red-500 focus:border-red-500 sm:text-sm"})})]}),(0,Ba.jsxs)("div",{className:"sm:col-span-2",children:[(0,Ba.jsx)("label",{htmlFor:"state",className:"block text-sm font-medium text-gray-300",children:"State / Province"}),(0,Ba.jsx)("div",{className:"mt-1",children:(0,Ba.jsx)("input",{id:"state",name:"state",type:"text",value:b,onChange:w,className:"appearance-none block w-full px-3 py-2 border border-gray-700 rounded-md shadow-sm placeholder-gray-500 bg-gray-800 text-white focus:outline-none focus:ring-red-500 focus:border-red-500 sm:text-sm"})})]}),(0,Ba.jsxs)("div",{className:"sm:col-span-2",children:[(0,Ba.jsx)("label",{htmlFor:"zipCode",className:"block text-sm font-medium text-gray-300",children:"ZIP / Postal Code"}),(0,Ba.jsx)("div",{className:"mt-1",children:(0,Ba.jsx)("input",{id:"zipCode",name:"zipCode",type:"text",value:x,onChange:w,className:"appearance-none block w-full px-3 py-2 border border-gray-700 rounded-md shadow-sm placeholder-gray-500 bg-gray-800 text-white focus:outline-none focus:ring-red-500 focus:border-red-500 sm:text-sm"})})]}),(0,Ba.jsxs)("div",{className:"sm:col-span-6",children:[(0,Ba.jsx)("label",{htmlFor:"country",className:"block text-sm font-medium text-gray-300",children:"Country"}),(0,Ba.jsx)("div",{className:"mt-1",children:(0,Ba.jsx)("input",{id:"country",name:"country",type:"text",value:y,onChange:w,className:"appearance-none block w-full px-3 py-2 border border-gray-700 rounded-md shadow-sm placeholder-gray-500 bg-gray-800 text-white focus:outline-none focus:ring-red-500 focus:border-red-500 sm:text-sm"})})]})]}),(0,Ba.jsx)("div",{className:"flex items-center justify-between",children:(0,Ba.jsx)("div",{className:"text-sm",children:(0,Ba.jsx)(ze,{to:"/login",className:"font-medium text-red-600 hover:text-red-500",children:"Already have an account?"})})}),(0,Ba.jsx)("div",{children:(0,Ba.jsx)("button",{type:"submit",disabled:r,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50",children:r?"Creating Gym...":"Create Gym"})})]})]})})},ri=()=>{const[e,t]=(0,l.useState)([]),[n,r]=(0,l.useState)(!0),[a,i]=(0,l.useState)(""),[o,s]=(0,l.useState)("");(0,l.useEffect)(()=>{(async()=>{try{const e=await ja.get("/fighters/roster");t(e.data)}catch(e){i("Failed to fetch fighters."),console.error(e)}finally{r(!1)}})()},[]);const c=e.filter(e=>e.name.toLowerCase().includes(o.toLowerCase())||e.email.toLowerCase().includes(o.toLowerCase())||e.fighterBatchNo.toLowerCase().includes(o.toLowerCase()));return n?(0,Ba.jsx)("p",{children:"Loading fighters..."}):a?(0,Ba.jsx)("p",{className:"text-red-500",children:a}):(0,Ba.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,Ba.jsx)("input",{type:"text",placeholder:"Search fighters...",className:"mb-4 p-2 border rounded w-full",onChange:e=>s(e.target.value)}),(0,Ba.jsx)("div",{className:"overflow-x-auto",children:(0,Ba.jsxs)("table",{className:"min-w-full bg-white",children:[(0,Ba.jsx)("thead",{children:(0,Ba.jsxs)("tr",{children:[(0,Ba.jsx)("th",{className:"py-2 px-4 border-b",children:"Fighter Name"}),(0,Ba.jsx)("th",{className:"py-2 px-4 border-b",children:"Batch Number"}),(0,Ba.jsx)("th",{className:"py-2 px-4 border-b",children:"RFID"}),(0,Ba.jsx)("th",{className:"py-2 px-4 border-b",children:"Email"}),(0,Ba.jsx)("th",{className:"py-2 px-4 border-b",children:"Actions"})]})}),(0,Ba.jsx)("tbody",{children:c.map(n=>(0,Ba.jsxs)("tr",{children:[(0,Ba.jsx)("td",{className:"py-2 px-4 border-b text-center",children:n.name}),(0,Ba.jsx)("td",{className:"py-2 px-4 border-b text-center",children:n.fighterBatchNo}),(0,Ba.jsx)("td",{className:"py-2 px-4 border-b text-center",children:n.rfid}),(0,Ba.jsx)("td",{className:"py-2 px-4 border-b text-center",children:n.email}),(0,Ba.jsx)("td",{className:"py-2 px-4 border-b text-center",children:(0,Ba.jsxs)("div",{className:"flex justify-center items-center space-x-2",children:[(0,Ba.jsx)(ze,{to:"/admin/fighter/".concat(n._id),className:"text-blue-500 hover:text-blue-700",children:(0,Ba.jsx)(It,{})}),(0,Ba.jsx)(ze,{to:"/admin/edit-fighter/".concat(n._id),className:"text-green-500 hover:text-green-700",children:(0,Ba.jsx)(St,{})}),(0,Ba.jsx)("button",{onClick:()=>(async n=>{if(window.confirm("Are you sure you want to delete this fighter?"))try{await ja.delete("/fighters/".concat(n)),t(e.filter(e=>e._id!==n))}catch(r){i("Failed to delete fighter."),console.error(r)}})(n._id),className:"text-red-500 hover:text-red-700",children:(0,Ba.jsx)(Zt,{})})]})})]},n._id))})]})})]})},ai=()=>{const[e,t]=(0,l.useState)([]),[n,r]=(0,l.useState)(!0);(0,l.useEffect)(()=>{(async()=>{try{const e=await ja.get("/fighters/roster");t(e.data)}catch(e){console.error("Error fetching fighters:",e)}finally{r(!1)}})()},[]);return n?(0,Ba.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,Ba.jsxs)("div",{className:"text-center text-gray-500",children:[(0,Ba.jsx)("div",{className:"loader ease-linear rounded-full border-8 border-t-8 border-gray-200 h-32 w-32 mb-4"}),(0,Ba.jsx)("h2",{className:"text-xl font-semibold",children:"Loading Fighters..."}),(0,Ba.jsx)("p",{children:"Please wait a moment."})]})}):(0,Ba.jsxs)("div",{className:"bg-white p-6 md:p-8 rounded-xl shadow-lg",children:[(0,Ba.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("h2",{className:"text-3xl font-bold text-gray-800",children:"Fighters Dashboard"}),(0,Ba.jsx)("p",{className:"text-gray-500 mt-1",children:"Manage and view all registered fighters."})]}),(0,Ba.jsx)("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto",children:(0,Ba.jsx)(ze,{to:"/admin/add-fighter",className:"bg-red-600 text-white px-5 py-2.5 rounded-lg font-semibold hover:bg-red-700 transition duration-300 text-center shadow-md hover:shadow-lg",children:"+ Add Fighter"})})]}),(0,Ba.jsx)(ri,{fighters:e,handleDelete:async n=>{if(window.confirm("Are you sure you want to delete this fighter?"))try{await ja.delete("/fighters/".concat(n)),t(e.filter(e=>e._id!==n)),alert("Fighter deleted successfully!")}catch(r){console.error("Error deleting fighter:",r),alert("Error deleting fighter.")}}})]})},ii=()=>{const[e,t]=(0,l.useState)(null),[n,r]=(0,l.useState)(!0);if((0,l.useEffect)(()=>{(async()=>{try{const e=await ja.get("/fighters/dashboard-stats");t(e.data)}catch(e){console.error("Error fetching dashboard stats:",e)}finally{r(!1)}})()},[]),n)return(0,Ba.jsx)("div",{className:"p-8 text-center text-gray-500",children:"Loading dashboard..."});const a=e=>{let{title:t,value:n,subtitle:r,icon:a,color:i="blue"}=e;return(0,Ba.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6 border-l-4 border-".concat(i,"-500"),children:(0,Ba.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("p",{className:"text-gray-600 text-sm font-medium",children:t}),(0,Ba.jsx)("p",{className:"text-2xl font-bold text-".concat(i,"-600"),children:n}),r&&(0,Ba.jsx)("p",{className:"text-gray-500 text-xs mt-1",children:r})]}),(0,Ba.jsx)("div",{className:"text-".concat(i,"-500 text-3xl"),children:a})]})})};return(0,Ba.jsxs)("div",{className:"p-4 md:p-8",children:[(0,Ba.jsxs)("div",{className:"mb-8",children:[(0,Ba.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Dashboard Overview"}),(0,Ba.jsx)("p",{className:"text-gray-600",children:"Complete analytics and insights for your gym"})]}),e&&(0,Ba.jsxs)("div",{className:"space-y-8",children:[(0,Ba.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,Ba.jsx)(a,{title:"Total Fighters",value:e.totalFighters,icon:"\ud83d\udc65",color:"blue"}),(0,Ba.jsx)(a,{title:"Profile Completed",value:e.profileCompleted,subtitle:"".concat(e.profilePending," pending"),icon:"\u2705",color:"green"}),(0,Ba.jsx)(a,{title:"Recent Joinings",value:e.recentJoinings,subtitle:"Last 30 days",icon:"\ud83d\udcc8",color:"purple"}),(0,Ba.jsx)(a,{title:"Assessed Fighters",value:e.topFighters.length,subtitle:"With grade scores",icon:"\ud83c\udfc6",color:"yellow"})]}),(0,Ba.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,Ba.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Ba.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"\ud83c\udfc6 Top Performing Fighters"}),e.topFighters.length>0?(0,Ba.jsx)("div",{className:"space-y-3",children:e.topFighters.map((e,t)=>{var n;return(0,Ba.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-md",children:[(0,Ba.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ba.jsx)("span",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white font-bold ".concat(0===t?"bg-yellow-500":1===t?"bg-gray-400":2===t?"bg-yellow-600":"bg-blue-500"),children:t+1}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("p",{className:"font-medium text-gray-800",children:e.name}),(0,Ba.jsxs)("p",{className:"text-sm text-gray-500",children:["Batch: ",e.fighterBatchNo]})]})]}),(0,Ba.jsxs)("div",{className:"text-right",children:[(0,Ba.jsx)("p",{className:"font-bold text-lg text-green-600",children:null===(n=e.assessment)||void 0===n?void 0:n.specialGradeScore}),(0,Ba.jsx)("p",{className:"text-xs text-gray-500",children:"Grade Score"})]})]},e._id)})}):(0,Ba.jsx)("p",{className:"text-gray-500 text-center py-4",children:"No fighters assessed yet"})]}),(0,Ba.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Ba.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"\ud83d\udcca Demographics"}),(0,Ba.jsxs)("div",{className:"mb-6",children:[(0,Ba.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Gender Distribution"}),(0,Ba.jsxs)("div",{className:"space-y-2",children:[(0,Ba.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ba.jsx)("span",{className:"text-sm text-gray-600",children:"Male"}),(0,Ba.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ba.jsx)("div",{className:"w-24 bg-gray-200 rounded-full h-2",children:(0,Ba.jsx)("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:"".concat(e.totalFighters>0?e.genderDistribution.male/e.totalFighters*100:0,"%")}})}),(0,Ba.jsx)("span",{className:"text-sm font-medium",children:e.genderDistribution.male})]})]}),(0,Ba.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ba.jsx)("span",{className:"text-sm text-gray-600",children:"Female"}),(0,Ba.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ba.jsx)("div",{className:"w-24 bg-gray-200 rounded-full h-2",children:(0,Ba.jsx)("div",{className:"bg-pink-500 h-2 rounded-full",style:{width:"".concat(e.totalFighters>0?e.genderDistribution.female/e.totalFighters*100:0,"%")}})}),(0,Ba.jsx)("span",{className:"text-sm font-medium",children:e.genderDistribution.female})]})]})]})]}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Age Groups"}),(0,Ba.jsx)("div",{className:"space-y-2",children:e.ageGroups.map(e=>(0,Ba.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ba.jsx)("span",{className:"text-sm text-gray-600",children:e._id}),(0,Ba.jsx)("span",{className:"text-sm font-medium bg-gray-100 px-2 py-1 rounded",children:e.count})]},e._id))})]})]})]}),(0,Ba.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Ba.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"\ud83d\udca1 Key Insights"}),(0,Ba.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,Ba.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,Ba.jsx)("h4",{className:"font-medium text-blue-800 mb-2",children:"Growth Rate"}),(0,Ba.jsxs)("p",{className:"text-sm text-blue-600",children:[e.recentJoinings," new fighters joined in the last 30 days"]})]}),(0,Ba.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,Ba.jsx)("h4",{className:"font-medium text-green-800 mb-2",children:"Completion Rate"}),(0,Ba.jsxs)("p",{className:"text-sm text-green-600",children:[e.totalFighters>0?"".concat(Math.round(e.profileCompleted/e.totalFighters*100),"%"):"0%"," of fighters have completed profiles"]})]}),(0,Ba.jsxs)("div",{className:"bg-purple-50 p-4 rounded-lg",children:[(0,Ba.jsx)("h4",{className:"font-medium text-purple-800 mb-2",children:"Assessment Rate"}),(0,Ba.jsxs)("p",{className:"text-sm text-purple-600",children:[e.totalFighters>0?"".concat(Math.round(e.topFighters.length/e.totalFighters*100),"%"):"0%"," of fighters have been assessed"]})]})]})]})]})]})};var oi=n(7029),si=n.n(oi),li=function(e,t){return(li=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function ci(e,t){function n(){this.constructor=e}li(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function ui(e,t,n,r){return new(n||(n=Promise))(function(a,i){function o(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){e.done?a(e.value):new n(function(t){t(e.value)}).then(o,s)}l((r=r.apply(e,t||[])).next())})}function hi(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var di=function(){function e(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return e.prototype.setPlatform=function(e,t){null!=this.platform&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+t+"."),this.platformName=e,this.platform=t},e.prototype.registerFlag=function(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){var r=this.urlFlags[e];console.warn("Setting feature override from URL "+e+": "+r+"."),this.set(e,r)}},e.prototype.get=function(e){return e in this.flags||(this.flags[e]=this.evaluateFlag(e)),this.flags[e]},e.prototype.getNumber=function(e){return this.get(e)},e.prototype.getBool=function(e){return this.get(e)},e.prototype.getFlags=function(){return this.flags},Object.defineProperty(e.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),e.prototype.set=function(e,t){if(null==this.flagRegistry[e])throw new Error("Cannot set flag "+e+" as it has not been registered.");this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)},e.prototype.evaluateFlag=function(e){if(null==this.flagRegistry[e])throw new Error("Cannot evaluate flag '"+e+"': no evaluation function found.");return this.flagRegistry[e].evaluationFn()},e.prototype.setFlags=function(e){this.flags=Object.assign({},e)},e.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},e.prototype.populateURLFlags=function(){var e=this;if(void 0!==this.global&&void 0!==this.global.location&&void 0!==this.global.location.search){var t,n,r=(t=this.global.location.search,n={},t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return function(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}(n,t[0],t[1]),t.join("=")}),n);"tfjsflags"in r&&r.tfjsflags.split(",").forEach(function(t){var n=t.split(":"),r=n[0],a=n[1];e.urlFlags[r]=function(e,t){if("true"===(t=t.toLowerCase())||"false"===t)return"true"===t;if(""+ +t===t)return+t;throw new Error("Could not parse value flag value "+t+" for flag "+e+".")}(r,a)})}},e}();function fi(){return pi}var pi=null,gi=new Map,mi=new Map;function vi(e,t){var n=wi(e,t);return gi.get(n)}function bi(e){for(var t=gi.entries(),n=[];;){var r=t.next(),a=r.done,i=r.value;if(a)break;var o=i[0],s=i[1];o.split("_")[0]===e&&n.push(s)}return n}function xi(e){var t=e.kernelName,n=e.backendName,r=wi(t,n);if(gi.has(r))throw new Error("The kernel '"+t+"' for backend '"+n+"' is already registered");gi.set(r,e)}function yi(e){var t=e.kernelName;mi.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),mi.set(t,e)}function wi(e,t){return t+"_"+e}function ki(e){for(var t=e.length,n=0,r=0;t>0;)r=Math.random()*t|0,n=e[--t],e[t]=e[r],e[r]=n}function Ni(e,t,n){return Math.max(e,Math.min(t,n))}function Si(e){return e%2==0?e:e+1}function Ci(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function Ei(e,t){if(!e)throw new Error("string"==typeof t?t:t())}function _i(e,t,n){void 0===n&&(n=""),Ei(Ri(e,t),function(){return n+" Shapes "+e+" and "+t+" must match"})}function Ii(e){Ei(null!=e,function(){return"The input to the tensor constructor must be a non-null value."})}function Ti(e,t,n){if(void 0===t&&(t=[]),void 0===n&&(n=!1),null==t&&(t=[]),Array.isArray(e)||Gi(e)&&!n)for(var r=0;r<e.length;++r)Ti(e[r],t,n);else t.push(e);return t}function Ai(e){if(0===e.length)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function Ri(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Di(e){return e%1==0}function Fi(e){if(null!=Math.tanh)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function Oi(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function Li(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function Pi(e,t,n){return void 0===t&&(t=function(e){return 0}),new Promise(function(r,a){var i=0,o=function(){if(e())r();else{i++;var s=t(i);null!=n&&i>=n?a():setTimeout(o,s)}};o()})}function Mi(e,t){for(var n=1,r=-1,a=0;a<e.length;++a)if(e[a]>=0)n*=e[a];else if(-1===e[a]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+a);r=a}else if(e[a]<0)throw Error("Shapes can not be < 0. Found "+e[a]+" at dim "+a);if(-1===r){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(0===n)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+n);var i=e.slice();return i[r]=t/n,i}function ji(e,t){var n=t.length;return Ei((e=null==e?t.map(function(e,t){return t}):[].concat(e)).every(function(e){return e>=-n&&e<n}),function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+e}),Ei(e.every(function(e){return Di(e)}),function(){return"All values in axis param must be integers but got axis "+e}),e.map(function(e){return e<0?n+e:e})}function Bi(e,t){for(var n=[],r=[],a=null!=t&&Array.isArray(t)&&0===t.length,i=null==t||a?null:ji(t,e).sort(),o=0,s=0;s<e.length;++s){if(null!=i){if(i[o]===s&&1!==e[s])throw new Error("Can't squeeze axis "+s+" since its dim '"+e[s]+"' is not 1");(null==i[o]||i[o]>s)&&1===e[s]&&(n.push(e[s]),r.push(s)),i[o]<=s&&o++}1!==e[s]&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function zi(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else{if("bool"!==e)throw new Error("Unknown data type "+e);n=new Uint8Array(t)}return n}function Wi(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error("Unknown data type "+e);n=new Array(t)}return n}function Ui(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+t+" being uploaded contains "+r+".")}}function Vi(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}function Hi(e,t){return"complex64"!==t&&("float32"!==t||"complex64"===e)&&("int32"!==t||"float32"===e||"complex64"===e)&&("bool"!==t||"bool"!==e)}function Gi(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function qi(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype "+e)}function Ki(e){if(null==e)return 0;var t=0;return e.forEach(function(e){return t+=e.length}),t}function Xi(e){return"string"==typeof e||e instanceof String}function Yi(e){return"boolean"==typeof e}function $i(e){return"number"==typeof e}function Ji(e){return Array.isArray(e)?Ji(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":$i(e)?"float32":Xi(e)?"string":Yi(e)?"bool":"float32"}function Qi(e){return!!(e&&e.constructor&&e.call&&e.apply)}function Zi(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}function eo(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function to(e,t,n){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=Ti(e)),n&&Ui(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){for(var r=new Uint8Array(e.length),a=0;a<r.length;++a)0!==Math.round(e[a])&&(r[a]=1);return r}throw new Error("Unknown data type "+t)}function no(e,t){if(0===e.length)return t[0];var n=e.reduce(function(e,t){return e*t});if(0===n)return[];if(n!==t.length)throw new Error("["+e+"] does not match the input size.");return function e(t,n,r){var a=new Array;if(1===n.length)for(var i=n[0],o=0;o<i;o++)a[o]=r[t+o];else{i=n[0];var s=n.slice(1),l=s.reduce(function(e,t){return e*t});for(o=0;o<i;o++)a[o]=e(t+o*l,s,r)}return a}(0,e,t)}function ro(e,t){for(var n=ao(e,t),r=0;r<n.length;r++)n[r]=1;return n}function ao(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type "+t)}function io(){return fi().platform.now()}function oo(e){e.forEach(function(t){Ei(Number.isInteger(t)&&t>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+e+"]."})})}function so(e,t){return void 0===t&&(t="utf-8"),t=t||"utf-8",fi().platform.encode(e,t)}function lo(e,t){return void 0===t&&(t="utf-8"),t=t||"utf-8",fi().platform.decode(e,t)}function co(e,t,n){if(0===t)return 0;if(1===t)return e[0];for(var r=e[e.length-1],a=0;a<e.length-1;++a)r+=n[a]*e[a];return r}function uo(e,t,n){if(0===t)return[];if(1===t)return[e];for(var r=new Array(t),a=0;a<r.length-1;++a)r[a]=Math.floor(e/n[a]),e-=r[a]*n[a];return r[r.length-1]=e,r}Object.freeze({shuffle:ki,clamp:Ni,nearestLargerEven:Si,sum:Ci,randUniform:function(e,t){var n=Math.random();return t*n+(1-n)*e},distSquared:function(e,t){for(var n=0,r=0;r<e.length;r++){var a=Number(e[r])-Number(t[r]);n+=a*a}return n},assert:Ei,assertShapesMatch:_i,assertNonNull:Ii,flatten:Ti,sizeFromShape:Ai,isScalarShape:function(e){return 0===e.length},arraysEqual:Ri,isInt:Di,tanh:Fi,sizeToSquarishShape:Oi,createShuffledIndices:function(e){for(var t=new Uint32Array(e),n=0;n<e;++n)t[n]=n;return ki(t),t},rightPad:Li,repeatedTry:Pi,inferFromImplicitShape:Mi,parseAxisParam:ji,squeezeShape:Bi,getTypedArrayFromDType:zi,getArrayFromDType:Wi,checkConversionForErrors:Ui,isValidDtype:Vi,hasEncodingLoss:Hi,isTypedArray:Gi,bytesPerElement:qi,bytesFromStringArray:Ki,isString:Xi,isBoolean:Yi,isNumber:$i,inferDtype:Ji,isFunction:Qi,nearestDivisor:Zi,computeStrides:eo,toTypedArray:to,toNestedArray:no,makeOnesTypedArray:ro,makeZerosTypedArray:ao,now:io,assertNonNegativeIntegerDimensions:oo,fetch:function(e,t){return fi().platform.fetch(e,t)},encodeString:so,decodeString:lo,locToIndex:co,indexToLoc:uo});var ho=function(){function e(e,t){this.backendTimer=e,this.logger=t,null==t&&(this.logger=new fo)}return e.prototype.profileKernel=function(e,t,n){var r,a=this,i=this.backendTimer.time(function(){r=n()});return r.forEach(function(n){n.data().then(function(r){!function(e,t,n){if("float32"!==t)return!1;for(var r=0;r<e.length;r++){var a=e[r];if(isNaN(a)||!isFinite(a))return console.warn("Found "+a+" in the result of '"+n+"'"),!0}}(r,n.dtype,e),i.then(function(i){var o="";null!=i.getExtraProfileInfo&&(o=i.getExtraProfileInfo()),a.logger.logKernelProfile(e,n,r,i.kernelMs,t,o)})})}),r},e}(),fo=function(){function e(){}return e.prototype.logKernelProfile=function(e,t,n,r,a,i){var o="number"==typeof r?Li(r+"ms",9):r.error,s=Li(e,25),l=t.rank,c=t.size,u=Li(t.shape.toString(),14),h="";for(var d in a){var f=a[d].shape||t.shape,p=f.length;h+=d+": "+p+"D "+(p>0?f:"")+" "}console.log("%c"+s+"\t%c"+o+"\t%c"+l+"D "+u+"\t%c"+c+"\t%c"+h+"\t%c"+i,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},e}();function po(e,t,n){return Li(Array.isArray(e)?parseFloat(e[0].toFixed(7))+" + "+parseFloat(e[1].toFixed(7))+"j":Xi(e)?"'"+e+"'":"bool"===n?go(e):parseFloat(e.toFixed(7)).toString(),t)}function go(e){return 0===e?"false":"true"}function mo(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var vo=function(){function e(e,t,n){var r=this;if(this.dtype=t,this.shape=e.slice(),this.size=Ai(e),null!=n){var a=n.length;Ei(a===this.size,function(){return"Length of values '"+a+"' does not match the size inferred by the shape '"+r.size+"'."})}if("complex64"===t)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||Wi(t,this.size),this.strides=eo(e)}return e.prototype.set=function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),Ei(n.length===this.rank,function(){return"The number of provided coordinates ("+n.length+") must match the rank ("+t.rank+")"});var a=this.locToIndex(n);this.values[a]=e},e.prototype.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];0===e.length&&(e=[0]);for(var n=0,r=0,a=e;r<a.length;r++){var i=a[r];if(i<0||i>=this.shape[n]){var o="Requested out of range element at "+e+".   Buffer shape="+this.shape;throw new Error(o)}n++}for(var s=e[e.length-1],l=0;l<e.length-1;++l)s+=this.strides[l]*e[l];return this.values[s]},e.prototype.locToIndex=function(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];for(var t=e[e.length-1],n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t},e.prototype.indexToLoc=function(e){if(0===this.rank)return[];if(1===this.rank)return[e];for(var t=new Array(this.shape.length),n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return bo().makeTensor(this.values,this.shape,this.dtype)},e}(),bo=null,xo=null,yo=null,wo=function(){function e(e,t,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=Ai(e),this.strides=eo(e),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}return e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),Ei(1===this.size,function(){return"The array must have only 1 element."}),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(e,t){return this.throwIfDisposed(),this.reshape([e,t])},e.prototype.as3D=function(e,t,n){return this.throwIfDisposed(),this.reshape([e,t,n])},e.prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),this.reshape([e,t,n,r])},e.prototype.as5D=function(e,t,n,r,a){return this.throwIfDisposed(),this.reshape([e,t,n,r,a])},e.prototype.asType=function(e){return this.throwIfDisposed(),xo.cast(this,e)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.buffer=function(){return ui(this,void 0,void 0,function(){var e;return hi(this,function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,xo.buffer(this.shape,this.dtype,e)]}})})},e.prototype.bufferSync=function(){return xo.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.array=function(){return ui(this,void 0,void 0,function(){var e;return hi(this,function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,no(this.shape,e)]}})})},e.prototype.arraySync=function(){return no(this.shape,this.dataSync())},e.prototype.data=function(){return ui(this,void 0,void 0,function(){var e,t;return hi(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),e=bo().read(this.dataId),"string"!==this.dtype?[3,2]:[4,e];case 1:t=n.sent();try{return[2,t.map(function(e){return lo(e)})]}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}case 2:return[2,e]}})})},e.prototype.dataSync=function(){this.throwIfDisposed();var e=bo().readSync(this.dataId);if("string"===this.dtype)try{return e.map(function(e){return lo(e)})}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e},e.prototype.bytes=function(){return ui(this,void 0,void 0,function(){var e;return hi(this,function(t){switch(t.label){case 0:return this.throwIfDisposed(),[4,bo().read(this.dataId)];case 1:return e=t.sent(),"string"===this.dtype?[2,e]:[2,new Uint8Array(e.buffer)]}})})},e.prototype.dispose=function(){this.isDisposed||(bo().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(e){return void 0===e&&(e=!1),xo.print(this,e)},e.prototype.reshape=function(e){return this.throwIfDisposed(),xo.reshape(this,e)},e.prototype.reshapeAs=function(e){return this.throwIfDisposed(),this.reshape(e.shape)},e.prototype.expandDims=function(e){return void 0===e&&(e=0),xo.expandDims(this,e)},e.prototype.cumsum=function(e,t,n){return void 0===e&&(e=0),void 0===t&&(t=!1),void 0===n&&(n=!1),xo.cumsum(this,e,t,n)},e.prototype.squeeze=function(e){return this.throwIfDisposed(),xo.squeeze(this,e)},e.prototype.clone=function(){return this.throwIfDisposed(),xo.clone(this)},e.prototype.oneHot=function(e,t,n){return this.throwIfDisposed(),xo.oneHot(this,e,t,n)},e.prototype.toString=function(e){return void 0===e&&(e=!1),function(e,t,n,r){var a=eo(t),i=function(e,t,n,r){var a=Ai(t),i=r[r.length-1],o=new Array(i).fill(0),s=t.length,l="complex64"===n?mo(e):e;if(s>1)for(var c=0;c<a/i;c++)for(var u=c*i,h=0;h<i;h++)o[h]=Math.max(o[h],po(l[u+h],0,n).length);return o}(e,t,n,a),o=t.length,s=function e(t,n,r,a,i,o){void 0===o&&(o=!0);var s="complex64"===r?2:1,l=n[0],c=n.length;if(0===c)return"complex64"===r?[po(mo(t)[0],0,r)]:"bool"===r?[go(t[0])]:[t[0].toString()];if(1===c){if(l>20){var u=3*s,h=Array.from(t.slice(0,u)),d=Array.from(t.slice((l-3)*s,l*s));return"complex64"===r&&(h=mo(h),d=mo(d)),["["+h.map(function(e,t){return po(e,i[t],r)}).join(", ")+", ..., "+d.map(function(e,t){return po(e,i[l-3+t],r)}).join(", ")+"]"]}return["["+("complex64"===r?mo(t):Array.from(t)).map(function(e,t){return po(e,i[t],r)}).join(", ")+"]"]}var f=n.slice(1),p=a.slice(1),g=a[0]*s,m=[];if(l>20){for(var v=0;v<3;v++){var b=(x=v*g)+g;m.push.apply(m,e(t.slice(x,b),f,r,p,i,!1))}for(m.push("..."),v=l-3;v<l;v++)b=(x=v*g)+g,m.push.apply(m,e(t.slice(x,b),f,r,p,i,v===l-1))}else for(v=0;v<l;v++){var x;b=(x=v*g)+g,m.push.apply(m,e(t.slice(x,b),f,r,p,i,v===l-1))}var y=2===c?",":"";for(m[0]="["+m[0]+y,v=1;v<m.length-1;v++)m[v]=" "+m[v]+y;var w=",\n";for(v=2;v<c;v++)w+="\n";return m[m.length-1]=" "+m[m.length-1]+"]"+(o?"":w),m}(e,t,n,a,i),l=["Tensor"];return r&&(l.push("  dtype: "+n),l.push("  rank: "+o),l.push("  shape: ["+t+"]"),l.push("  values:")),l.push(s.map(function(e){return"    "+e}).join("\n")),l.join("\n")}(this.dataSync(),this.shape,this.dtype,e)},e.prototype.tile=function(e){return this.throwIfDisposed(),xo.tile(this,e)},e.prototype.gather=function(e,t){return void 0===t&&(t=0),this.throwIfDisposed(),xo.gather(this,e,t)},e.prototype.matMul=function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=!1),this.throwIfDisposed(),xo.matMul(this,e,t,n)},e.prototype.dot=function(e){return this.throwIfDisposed(),xo.dot(this,e)},e.prototype.norm=function(e,t,n){return void 0===e&&(e="euclidean"),void 0===t&&(t=null),void 0===n&&(n=!1),this.throwIfDisposed(),xo.norm(this,e,t,n)},e.prototype.slice=function(e,t){return this.throwIfDisposed(),xo.slice(this,e,t)},e.prototype.reverse=function(e){return this.throwIfDisposed(),xo.reverse(this,e)},e.prototype.concat=function(t,n){return void 0===n&&(n=0),this.throwIfDisposed(),t instanceof e&&(t=[t]),xo.concat([this].concat(t),n)},e.prototype.split=function(e,t){return void 0===t&&(t=0),this.throwIfDisposed(),xo.split(this,e,t)},e.prototype.stack=function(e,t){return void 0===t&&(t=0),xo.stack([this,e],t)},e.prototype.unstack=function(e){return void 0===e&&(e=0),xo.unstack(this,e)},e.prototype.pad=function(e,t){return void 0===t&&(t=0),xo.pad(this,e,t)},e.prototype.batchNormalization=function(e,t,n,r,a){return void 0===n&&(n=.001),yo("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(e,t,a,r,n)},e.prototype.batchNorm=function(e,t,n,r,a){return void 0===a&&(a=.001),this.throwIfDisposed(),xo.batchNorm(this,e,t,n,r,a)},e.prototype.all=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),xo.all(this,e,t)},e.prototype.any=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),xo.any(this,e,t)},e.prototype.logSumExp=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),xo.logSumExp(this,e,t)},e.prototype.sum=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),xo.sum(this,e,t)},e.prototype.prod=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),xo.prod(this,e,t)},e.prototype.mean=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),xo.mean(this,e,t)},e.prototype.min=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),xo.min(this,e,t)},e.prototype.max=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),xo.max(this,e,t)},e.prototype.argMin=function(e){return void 0===e&&(e=null),this.throwIfDisposed(),xo.argMin(this,e)},e.prototype.argMax=function(e){return void 0===e&&(e=null),this.throwIfDisposed(),xo.argMax(this,e)},e.prototype.cast=function(e){return this.throwIfDisposed(),xo.cast(this,e)},e.prototype.add=function(e){return this.throwIfDisposed(),xo.add(this,e)},e.prototype.addStrict=function(e){return this.throwIfDisposed(),xo.addStrict(this,e)},e.prototype.atan2=function(e){return this.throwIfDisposed(),xo.atan2(this,e)},e.prototype.sub=function(e){return this.throwIfDisposed(),xo.sub(this,e)},e.prototype.subStrict=function(e){return this.throwIfDisposed(),xo.subStrict(this,e)},e.prototype.pow=function(e){return this.throwIfDisposed(),xo.pow(this,e)},e.prototype.powStrict=function(e){return this.throwIfDisposed(),xo.powStrict(this,e)},e.prototype.mul=function(e){return this.throwIfDisposed(),xo.mul(this,e)},e.prototype.mulStrict=function(e){return this.throwIfDisposed(),xo.mulStrict(this,e)},e.prototype.div=function(e){return this.throwIfDisposed(),xo.div(this,e)},e.prototype.divNoNan=function(e){return this.throwIfDisposed(),xo.divNoNan(this,e)},e.prototype.floorDiv=function(e){return this.throwIfDisposed(),xo.floorDiv(this,e)},e.prototype.divStrict=function(e){return this.throwIfDisposed(),xo.divStrict(this,e)},e.prototype.minimum=function(e){return this.throwIfDisposed(),xo.minimum(this,e)},e.prototype.minimumStrict=function(e){return this.throwIfDisposed(),xo.minimumStrict(this,e)},e.prototype.maximum=function(e){return this.throwIfDisposed(),xo.maximum(this,e)},e.prototype.maximumStrict=function(e){return this.throwIfDisposed(),xo.maximumStrict(this,e)},e.prototype.mod=function(e){return this.throwIfDisposed(),xo.mod(this,e)},e.prototype.modStrict=function(e){return this.throwIfDisposed(),xo.modStrict(this,e)},e.prototype.squaredDifferenceStrict=function(e){return this.throwIfDisposed(),xo.squaredDifferenceStrict(this,e)},e.prototype.transpose=function(e){return this.throwIfDisposed(),xo.transpose(this,e)},e.prototype.notEqual=function(e){return this.throwIfDisposed(),xo.notEqual(this,e)},e.prototype.notEqualStrict=function(e){return this.throwIfDisposed(),xo.notEqualStrict(this,e)},e.prototype.less=function(e){return this.throwIfDisposed(),xo.less(this,e)},e.prototype.lessStrict=function(e){return this.throwIfDisposed(),xo.lessStrict(this,e)},e.prototype.equal=function(e){return this.throwIfDisposed(),xo.equal(this,e)},e.prototype.equalStrict=function(e){return this.throwIfDisposed(),xo.equalStrict(this,e)},e.prototype.lessEqual=function(e){return this.throwIfDisposed(),xo.lessEqual(this,e)},e.prototype.lessEqualStrict=function(e){return this.throwIfDisposed(),xo.lessEqualStrict(this,e)},e.prototype.greater=function(e){return this.throwIfDisposed(),xo.greater(this,e)},e.prototype.greaterStrict=function(e){return this.throwIfDisposed(),xo.greaterStrict(this,e)},e.prototype.greaterEqual=function(e){return this.throwIfDisposed(),xo.greaterEqual(this,e)},e.prototype.greaterEqualStrict=function(e){return this.throwIfDisposed(),xo.greaterEqualStrict(this,e)},e.prototype.logicalAnd=function(e){return this.throwIfDisposed(),xo.logicalAnd(this,e)},e.prototype.logicalOr=function(e){return this.throwIfDisposed(),xo.logicalOr(this,e)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),xo.logicalNot(this)},e.prototype.logicalXor=function(e){return this.throwIfDisposed(),xo.logicalXor(this,e)},e.prototype.where=function(e,t){return this.throwIfDisposed(),xo.where(e,this,t)},e.prototype.neg=function(){return this.throwIfDisposed(),xo.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),xo.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),xo.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),xo.sign(this)},e.prototype.isNaN=function(){return this.throwIfDisposed(),xo.isNaN(this)},e.prototype.isInf=function(){return this.throwIfDisposed(),xo.isInf(this)},e.prototype.isFinite=function(){return this.throwIfDisposed(),xo.isFinite(this)},e.prototype.exp=function(){return this.throwIfDisposed(),xo.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),xo.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),xo.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),xo.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),xo.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),xo.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),xo.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),xo.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),xo.abs(this)},e.prototype.clipByValue=function(e,t){return this.throwIfDisposed(),xo.clipByValue(this,e,t)},e.prototype.relu=function(){return this.throwIfDisposed(),xo.relu(this)},e.prototype.relu6=function(){return this.throwIfDisposed(),xo.relu6(this)},e.prototype.elu=function(){return this.throwIfDisposed(),xo.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),xo.selu(this)},e.prototype.leakyRelu=function(e){return void 0===e&&(e=.2),this.throwIfDisposed(),xo.leakyRelu(this,e)},e.prototype.prelu=function(e){return this.throwIfDisposed(),xo.prelu(this,e)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),xo.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),xo.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),xo.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),xo.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),xo.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),xo.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),xo.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),xo.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),xo.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),xo.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),xo.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),xo.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),xo.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),xo.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),xo.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),xo.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),xo.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),xo.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),xo.round(this)},e.prototype.step=function(e){return void 0===e&&(e=0),this.throwIfDisposed(),xo.step(this,e)},e.prototype.softmax=function(e){return void 0===e&&(e=-1),this.throwIfDisposed(),xo.softmax(this,e)},e.prototype.logSoftmax=function(e){return void 0===e&&(e=-1),this.throwIfDisposed(),xo.logSoftmax(this,e)},e.prototype.resizeBilinear=function(e,t){return void 0===t&&(t=!1),this.throwIfDisposed(),xo.image.resizeBilinear(this,e,t)},e.prototype.resizeNearestNeighbor=function(e,t){return void 0===t&&(t=!1),this.throwIfDisposed(),xo.image.resizeNearestNeighbor(this,e,t)},e.prototype.conv1d=function(e,t,n,r,a,i){return void 0===r&&(r="NWC"),void 0===a&&(a=1),this.throwIfDisposed(),xo.conv1d(this,e,t,n,r,a,i)},e.prototype.conv2d=function(e,t,n,r,a,i){return void 0===r&&(r="NHWC"),void 0===a&&(a=[1,1]),this.throwIfDisposed(),xo.conv2d(this,e,t,n,r,a,i)},e.prototype.conv2dTranspose=function(e,t,n,r,a){return this.throwIfDisposed(),xo.conv2dTranspose(this,e,t,n,r,a)},e.prototype.depthwiseConv2D=function(e,t,n,r,a,i){return void 0===r&&(r="NHWC"),void 0===a&&(a=[1,1]),this.throwIfDisposed(),xo.depthwiseConv2d(this,e,t,n,r,a,i)},e.prototype.separableConv2d=function(e,t,n,r,a,i){return void 0===a&&(a=[1,1]),void 0===i&&(i="NHWC"),this.throwIfDisposed(),xo.separableConv2d(this,e,t,n,r,a,i)},e.prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),xo.avgPool(this,e,t,n,r)},e.prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),xo.maxPool(this,e,t,n,r)},e.prototype.localResponseNormalization=function(e,t,n,r){return void 0===e&&(e=5),void 0===t&&(t=1),void 0===n&&(n=1),void 0===r&&(r=.5),xo.localResponseNormalization(this,e,t,n,r)},e.prototype.pool=function(e,t,n,r,a){return this.throwIfDisposed(),xo.pool(this,e,t,n,r,a)},e.prototype.variable=function(e,t,n){return void 0===e&&(e=!0),this.throwIfDisposed(),bo().makeVariable(this,e,t,n)},e.prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),xo.unsortedSegmentSum(this,e,t)},e.prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),xo.batchToSpaceND(this,e,t)},e.prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),xo.spaceToBatchND(this,e,t)},e.prototype.topk=function(e,t){return void 0===e&&(e=1),void 0===t&&(t=!0),this.throwIfDisposed(),xo.topk(this,e,t)},e.prototype.stridedSlice=function(e,t,n,r,a,i,o,s){return void 0===r&&(r=0),void 0===a&&(a=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),this.throwIfDisposed(),xo.stridedSlice(this,e,t,n,r,a,i,o,s)},e.prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),xo.depthToSpace(this,e,t)},e.prototype.fft=function(){return this.throwIfDisposed(),xo.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),xo.spectral.ifft(this)},e.prototype.rfft=function(){return this.throwIfDisposed(),xo.spectral.rfft(this)},e.prototype.irfft=function(){return this.throwIfDisposed(),xo.spectral.irfft(this)},e}();Object.defineProperty(wo,Symbol.hasInstance,{value:function(e){return!!e&&null!=e.dataId&&null!=e.shape&&null!=e.dtype}});var ko,No,So,Co,Eo,_o=function(e){function t(t,n,r,a){var i=e.call(this,t.shape,t.dtype,t.dataId,a)||this;return i.trainable=n,i.name=r,i}return ci(t,e),t.prototype.assign=function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value ("+e.dtype+") and previous value ("+this.dtype+") must match");if(!Ri(e.shape,this.shape))throw new Error("shape of the new value ("+e.shape+") and previous value ("+this.shape+") must match");bo().disposeTensor(this),this.dataId=e.dataId,bo().incRef(this,null)},t.prototype.dispose=function(){bo().disposeVariable(this),this.isDisposedInternal=!0},t}(wo);Object.defineProperty(_o,Symbol.hasInstance,{value:function(e){return e instanceof wo&&null!=e.assign&&e.assign instanceof Function}}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(ko||(ko={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(No||(No={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(So||(So={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(Co||(Co={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(Eo||(Eo={}));var Io={float32:Co,int32:No,bool:So,complex64:Eo};function To(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error("Can not upcast "+e+" with "+t)}return Io[e][t]}function Ao(e){return To(e,"int32")}function Ro(e,t){if(e.dtype===t.dtype)return[e,t];var n=To(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function Do(e,t){Ei(e.dtype===t.dtype,function(){return"The dtypes of the first("+e.dtype+") and second("+t.dtype+") input must match"})}function Fo(e){var t=[];return function e(t,n,r){if(null!=t)if(t instanceof wo)n.push(t);else if(a=t,Array.isArray(a)||"object"==typeof a){var a,i=t;for(var o in i){var s=i[o];r.has(s)||(r.add(s),e(s,n,r))}}}(e,t,new Set),t}Object.freeze({makeTypesMatch:Ro,assertTypesMatch:Do,isTensorInList:function(e,t){return t.some(function(t){return t.id===e.id})},getTensorsInContainer:Fo});var Oo,Lo=function(){function e(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return e.prototype.dispose=function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()},e}(),Po=function(){function e(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Lo}return e.prototype.ready=function(){return ui(this,void 0,void 0,function(){var e,t,n;return hi(this,function(r){switch(r.label){case 0:if(null!=this.pendingBackendInit)return[2,this.pendingBackendInit.then(function(){})];if(null!=this.backendInstance)return[2];e=this.getSortedBackends(),t=0,r.label=1;case 1:return t<e.length?(n=e[t],[4,this.initializeBackend(n).success]):[3,5];case 2:return r.sent()?[4,this.setBackend(n)]:[3,4];case 3:return r.sent(),[2];case 4:return t++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(e.prototype,"backend",{get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var e=this.initializeBackendsAndReturnBest(),t=e.name;if(e.asyncInit)throw new Error("The highest priority backend '"+t+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance},enumerable:!0,configurable:!0}),e.prototype.backendNames=function(){return Object.keys(this.registryFactory)},e.prototype.findBackend=function(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;if(this.initializeBackend(e).asyncInit)return null}return this.registry[e]},e.prototype.findBackendFactory=function(e){return e in this.registryFactory?this.registryFactory[e].factory:null},e.prototype.registerBackend=function(e,t,n){return void 0===n&&(n=1),e in this.registryFactory?(console.warn(e+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)},e.prototype.setBackend=function(e){return ui(this,void 0,void 0,function(){var t,n,r;return hi(this,function(a){switch(a.label){case 0:if(null==this.registryFactory[e])throw new Error("Backend name '"+e+"' not found in registry");return this.backendName=e,null!=this.registry[e]?[3,4]:(this.backendInstance=null,t=this.initializeBackend(e),n=t.success,t.asyncInit?[4,n]:[3,2]);case 1:return r=a.sent(),[3,3];case 2:r=n,a.label=3;case 3:if(!r)return[2,!1];a.label=4;case 4:return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new ho(this.backendInstance),[2,!0]}})})},e.prototype.setupRegisteredKernels=function(){var e=this;bi(this.backendName).forEach(function(t){null!=t.setupFunc&&t.setupFunc(e.backendInstance)})},e.prototype.disposeRegisteredKernels=function(e){var t=this;bi(e).forEach(function(n){null!=n.disposeFunc&&n.disposeFunc(t.registry[e])})},e.prototype.initializeBackend=function(e){var t=this,n=this.registryFactory[e];if(null==n)throw new Error("Cannot initialize backend "+e+", no registration found.");try{var r=n.factory();if(Promise.resolve(r)===r){var a=++this.pendingBackendInitId,i=r.then(function(n){return!(a<t.pendingBackendInitId)&&(t.registry[e]=n,t.pendingBackendInit=null,!0)}).catch(function(n){return!(a<t.pendingBackendInitId)&&(t.pendingBackendInit=null,console.warn("Initialization of backend "+e+" failed"),console.warn(n.stack||n.message),!1)});return this.pendingBackendInit=i,{success:i,asyncInit:!0}}return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(t){return console.warn("Initialization of backend "+e+" failed"),console.warn(t.stack||t.message),{success:!1,asyncInit:!1}}},e.prototype.removeBackend=function(e){if(!(e in this.registryFactory))throw new Error(e+" backend not found in registry");this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},e.prototype.getSortedBackends=function(){var e=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(t,n){return e.registryFactory[n].priority-e.registryFactory[t].priority})},e.prototype.initializeBackendsAndReturnBest=function(){for(var e=this.getSortedBackends(),t=0;t<e.length;t++){var n=e[t],r=this.initializeBackend(n),a=r.success,i=r.asyncInit;if(i||a)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")},e.prototype.moveData=function(e,t){var n=this.state.tensorInfo.get(t),r=n.backend,a=this.readSync(t);r.disposeData(t),n.backend=e,e.move(t,a,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},e.prototype.tidy=function(e,t){var n,r=this,a=null;if(null==t){if("function"!=typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!=typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");a=e}return this.scopedRun(function(){return r.startScope(a)},function(){return r.endScope(n)},function(){return(n=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n})},e.prototype.scopedRun=function(e,t,n){e();try{var r=n();return t(),r}catch(e){throw t(),e}},e.prototype.nextTensorId=function(){return e.nextTensorId++},e.prototype.nextVariableId=function(){return e.nextVariableId++},e.prototype.clone=function(e){var t=this.makeTensorFromDataId(e.dataId,e.shape,e.dtype),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],function(e){return{x:function(){return e.toFloat()}}},[]),t},e.prototype.runKernel=function(e,t,n,r,a){return this.runKernelFunc(null,t,null,e,n,r,a)},e.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},e.prototype.checkKernelForMemLeak=function(e,t,n){var r=this.backend.numDataIds(),a=0;n.forEach(function(e){a+="complex64"===e.dtype?3:1});var i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-t-a-i;if(o>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+o+" data ids) after running '"+e+"'")},e.prototype.runKernelFunc=function(e,t,n,r,a,i,o){var s,l=this;void 0===i&&(i=[]),void 0===o&&(o=[]);var c=[],u=this.isTapeOn();null==r&&(r=null!=this.state.activeScope?this.state.activeScope.name:"");var h,d=function(e){u&&(c=e.map(function(e){return l.keep(l.clone(e))}))},f=this.state.numBytes,p=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var g,m=vi(r,this.backendName);return h=null!=m?function(){var e=l.backend.numDataIds();g=m.kernelFunc({inputs:t,attrs:a,backend:l.backend});var n=Array.isArray(g)?g:[g];l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(r,e,n);var s=n.map(function(e){var t=e.dataId,n=e.shape,r=e.dtype;return l.makeTensorFromDataId(t,n,r)}),c=s.filter(function(e,t){return o[t]});return d((i||[]).slice().concat(c)),s}:function(){var t=l.backend.numDataIds();g=l.tidy(function(){return e(l.backend,d)});var n=Array.isArray(g)?g:[g];return l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(r,t,n),n},this.scopedRun(function(){return l.state.kernelDepth++},function(){return l.state.kernelDepth--},function(){s=l.ENV.getBool("DEBUG")?l.profiler.profileKernel(r,t,function(){return h()}):h()}),u&&this.addTapeNode(r,t,s,n,c),this.state.profiling&&this.state.activeProfile.kernels.push({name:r,bytesAdded:this.state.numBytes-f,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-p,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(t).map(function(e){return t[e].shape}),outputShapes:s.map(function(e){return e.shape})}),Array.isArray(g)?s:s[0]},e.prototype.makeTensor=function(e,t,n,r){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;var a=e;"string"===n&&Xi(e[0])&&(a=e.map(function(e){return so(e)}));var i=r.write(a,t,n),o=new wo(t,n,i,this.nextTensorId());if(this.incRef(o,r),"string"===n){var s=this.state.tensorInfo.get(i),l=Ki(a);this.state.numBytes+=l-s.bytes,s.bytes=l}return o},e.prototype.makeTensorFromDataId=function(e,t,n,r){var a=new wo(t,n=n||"float32",e,this.nextTensorId());return this.incRef(a,r),a},e.prototype.makeVariable=function(e,t,n,r){void 0===t&&(t=!0),n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.asType(r));var a=new _o(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[a.name])throw new Error("Variable with name "+a.name+" was already registered");return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a},e.prototype.incRef=function(e,t){var n=this.state.tensorInfo.has(e.dataId)?this.state.tensorInfo.get(e.dataId).refCount:0;if(this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++,0===n){this.state.numDataBuffers++;var r=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(r=e.size*qi(e.dtype)),this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:r,refCount:0}),this.state.numBytes+=r}this.state.tensorInfo.get(e.dataId).refCount++,e instanceof _o||this.track(e)},e.prototype.disposeTensor=function(e){if(this.state.tensorInfo.has(e.dataId)){this.state.numTensors--,"string"===e.dtype&&this.state.numStringTensors--;var t=this.state.tensorInfo.get(e.dataId);t.refCount<=1?("complex64"!==e.dtype&&(this.state.numBytes-=t.bytes),this.state.numDataBuffers--,t.backend.disposeData(e.dataId),this.state.tensorInfo.delete(e.dataId)):this.state.tensorInfo.get(e.dataId).refCount--}},e.prototype.disposeVariables=function(){for(var e in this.state.registeredVariables){var t=this.state.registeredVariables[e];this.disposeVariable(t)}},e.prototype.disposeVariable=function(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]},e.prototype.memory=function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e},e.prototype.profile=function(e){return ui(this,void 0,void 0,function(){var t,n;return hi(this,function(r){return this.state.profiling=!0,t=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(e){return e.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n,[2,this.state.activeProfile]})})},e.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth},e.prototype.addTapeNode=function(e,t,n,r,a){var i=this,o={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:a},s=function(e){return mi.get(e)}(e);null!=s&&(r=s.gradFunc),null!=r&&(o.gradient=function(e){return e=e.map(function(e,t){if(null==e){var r=n[t],a=ao(r.size,r.dtype);return i.makeTensor(a,r.shape,r.dtype)}return e}),r(e.length>1?e:e[0],a)}),this.state.activeTape.push(o)},e.prototype.keep=function(e){return e.kept=!0,e},e.prototype.startTape=function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++},e.prototype.endTape=function(){this.state.gradientDepth--},e.prototype.startScope=function(e){var t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t},e.prototype.endScope=function(e){for(var t=this,n=Fo(e),r=new Set(n.map(function(e){return e.id})),a=0;a<this.state.activeScope.track.length;a++){var i=this.state.activeScope.track[a];i.kept||r.has(i.id)||i.dispose()}var o=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(function(e){e.kept||e.scopeId!==o.id||t.track(e)})},e.prototype.gradients=function(e,t,n,r){var a=this;if(void 0===r&&(r=!1),Ei(t.length>0,function(){return"gradients() received an empty list of xs."}),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '"+n.dtype+"'");var i=this.scopedRun(function(){return a.startTape()},function(){return a.endTape()},function(){return a.tidy("forward",e)});Ei(i instanceof wo,function(){return"The result y returned by f() must be a tensor."});var o=function(e,t,n){for(var r={},a={},i=0;i<t.length;i++)r[t[i].id]=!0;for(i=0;i<e.length;i++){var o=(p=e[i]).inputs;for(var s in o){for(var l=o[s],c=!1,u=0;u<t.length;u++)if(r[l.id]){p.outputs.forEach(function(e){return r[e.id]=!0}),c=!0,a[p.id]=!0;break}if(c)break}}var h={};h[n.id]=!0;var d={};for(i=e.length-1;i>=0;i--)for(o=(p=e[i]).inputs,u=0;u<p.outputs.length;u++)if(h[p.outputs[u].id]){for(var s in o)h[o[s].id]=!0,d[p.id]=!0;break}var f=[];for(i=0;i<e.length;i++){var p;if(a[(p=e[i]).id]&&d[p.id]){var g={};for(var s in p.inputs){var m=p.inputs[s];r[m.id]&&(g[s]=m)}var v=Object.assign({},p);v.inputs=g,v.outputs=p.outputs,f.push(v)}}return f}(this.state.activeTape,t,i);if(!r&&0===o.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var e,r,s={};s[i.id]=null==n?(r=ro(Ai(e=i.shape),"float32"),Mo.makeTensor(r,e,"float32")):n,function(e,t,n){for(var r=function(r){var a=t[r],i=[];if(a.outputs.forEach(function(t){var n=e[t.id];null!=n?i.push(n):i.push(null)}),null==a.gradient)throw new Error("Cannot compute gradient: gradient function not found for "+a.kernelName+".");var o=a.gradient(i),s=function(t){if(!(t in o))throw new Error("Cannot backprop through input "+t+". Available gradients found: "+Object.keys(o)+".");var r=n(function(){return o[t]()});if("float32"!==r.dtype)throw new Error("Error in gradient for op "+a.kernelName+". The gradient of input "+t+" must have 'float32' dtype, but has '"+r.dtype+"'");var i=a.inputs[t];if(!Ri(r.shape,i.shape))throw new Error("Error in gradient for op "+a.kernelName+". The gradient of input '"+t+"' has shape '"+r.shape+"', which does not match the shape of the input '"+i.shape+"'");if(null==e[i.id])e[i.id]=r;else{var s=e[i.id];e[i.id]=s.add(r),s.dispose()}};for(var l in a.inputs)s(l)},a=t.length-1;a>=0;a--)r(a)}(s,o,function(e){return a.tidy(e)});var l=t.map(function(e){return s[e.id]});return 0===a.state.gradientDepth&&(a.state.activeTape.forEach(function(e){for(var t=0,n=e.saved;t<n.length;t++)n[t].dispose()}),a.state.activeTape=null),{value:i,grads:l}})},e.prototype.customGrad=function(e){var t=this;return Ei(Qi(e),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var n,r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];Ei(r.every(function(e){return e instanceof wo}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var i={};return r.forEach(function(e,t){i[t]=e}),t.runKernelFunc(function(t,a){return Ei((n=e.apply(void 0,r.concat([a]))).value instanceof wo,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),Ei(Qi(n.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),n.value},i,function(e,t){var a=n.gradFunc(e,t),i=Array.isArray(a)?a:[a];Ei(i.length===r.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),Ei(i.every(function(e){return e instanceof wo}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var o={};return i.forEach(function(e,t){o[t]=function(){return e}}),o})}},e.prototype.readSync=function(e){return this.state.tensorInfo.get(e).backend.readSync(e)},e.prototype.read=function(e){return this.state.tensorInfo.get(e).backend.read(e)},e.prototype.time=function(e){return ui(this,void 0,void 0,function(){var t,n;return hi(this,function(r){switch(r.label){case 0:return t=io(),[4,this.backend.time(e)];case 1:return(n=r.sent()).wallMs=io()-t,[2,n]}})})},e.prototype.track=function(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e},Object.defineProperty(e.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),e.prototype.reset=function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Lo,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},e.nextTensorId=0,e.nextVariableId=0,e}(),Mo=function(){var e=function(){if(null==Oo){var e=void 0;if("undefined"!=typeof window)e=window;else if("undefined"!=typeof n.g)e=n.g;else if("undefined"!=typeof process)e=process;else{if("undefined"==typeof self)throw new Error("Could not find a global object");e=self}Oo=e}return Oo}();if(null==e._tfengine){var t=new di(e);e._tfengine=new Po(t)}return function(e){pi=e}(e._tfengine.ENV),bo=function(){return e._tfengine},e._tfengine}();function jo(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}var Bo=fi();Bo.registerFlag("DEBUG",function(){return!1},function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),Bo.registerFlag("IS_BROWSER",function(){return jo()}),Bo.registerFlag("IS_NODE",function(){return"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node}),Bo.registerFlag("IS_CHROME",function(){return"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),Bo.registerFlag("PROD",function(){return!1}),Bo.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return Bo.getBool("DEBUG")}),Bo.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),Bo.registerFlag("IS_TEST",function(){return!1});var zo,Wo,Uo,Vo={},Ho={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Go(e,t){Vo[e]=t}function qo(e){e in Vo||(Vo[e]=function(e){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var t=function(e){if("undefined"!=typeof OffscreenCanvas&&2===e)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(e);return t.addEventListener("webglcontextlost",function(t){t.preventDefault(),delete Vo[e]},!1),1===e?t.getContext("webgl",Ho)||t.getContext("experimental-webgl",Ho):t.getContext("webgl2",Ho)}(e));var t=Vo[e];return t.isContextLost()?(delete Vo[e],qo(e)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),Vo[e])}function Ko(e,t){return[t,e]}function Xo(e){var t=Ai(e);return Oi(Math.ceil(t/4))}function Yo(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function $o(e,t){var n,r,a,i,o,s,l,c,u,h=e;return 2===fi().getNumber("WEBGL_VERSION")?(n=h.R32F,r=h.R16F,a=h.RGBA16F,i=h.RGBA32F,o=h.RED,s=4,l=1,c=h.HALF_FLOAT,u=h.FLOAT):(n=e.RGBA,r=e.RGBA,a=e.RGBA,i=h.RGBA,o=e.RGBA,s=4,l=4,c=null!=t?t.HALF_FLOAT_OES:null,u=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:o,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:l,textureTypeHalfFloat:c,textureTypeFloat:u}}function Jo(e,t,n){var r=n();return t&&function(e){var t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+Zo(e,t))}(e),r}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(zo||(zo={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(Wo||(Wo={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Uo||(Uo={}));function Qo(e){return!!(fi().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||5.96e-8<Math.abs(e)&&Math.abs(e)<65504)}function Zo(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function es(e,t,n){return Ns(e,t,function(){return e.getExtension(n)},'Extension "'+n+'" not supported on this browser.')}function ts(e,t,n){var r=Ns(e,t,function(){return e.createShader(e.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(Jo(e,t,function(){return e.shaderSource(r,n)}),Jo(e,t,function(){return e.compileShader(r)}),!1===e.getShaderParameter(r,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function ns(e,t,n){var r=Ns(e,t,function(){return e.createShader(e.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(Jo(e,t,function(){return e.shaderSource(r,n)}),Jo(e,t,function(){return e.compileShader(r)}),!1===e.getShaderParameter(r,e.COMPILE_STATUS))throw function(e,t){var n=is.exec(t);if(null==n)return console.log("Couldn't parse line number in error: "+t),void console.log(e);for(var r=+n[1],a=e.split("\n"),i=a.length.toString().length+2,o=a.map(function(e,t){return Li((t+1).toString(),i)+e}),s=0,l=0;l<o.length;l++)s=Math.max(o[l].length,s);var c=o.slice(0,r-1),u=o.slice(r-1,r),h=o.slice(r);console.log(c.join("\n")),console.log(t.split("\n")[0]),console.log("%c "+Li(u[0],s),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(h.join("\n"))}(n,e.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var rs,as,is=/ERROR: [0-9]+:([0-9]+):/g;function os(e,t){return Ns(e,t,function(){return e.createProgram()},"Unable to create WebGLProgram.")}function ss(e,t,n){if(Jo(e,t,function(){return e.linkProgram(n)}),!1===e.getProgramParameter(n,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function ls(e,t,n){if(Jo(e,t,function(){return e.validateProgram(n)}),!1===e.getProgramParameter(n,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function cs(e,t,n){var r=Ns(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return Jo(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),Jo(e,t,function(){return e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function us(e,t,n){var r=Ns(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return Jo(e,t,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r)}),Jo(e,t,function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function hs(e,t){return Ns(e,t,function(){return e.createTexture()},"Unable to create WebGLTexture.")}function ds(e,t){var n=fi().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="["+e+"x"+t+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n)throw r="["+e+"x"+t+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU ["+n+"x"+n+"].")}function fs(e,t){return Ns(e,t,function(){return e.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function ps(e,t,n,r,a,i,o,s){var l=e.getAttribLocation(n,r);return-1!==l&&(Jo(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,a)}),Jo(e,t,function(){return e.vertexAttribPointer(l,i,e.FLOAT,!1,o,s)}),Jo(e,t,function(){return e.enableVertexAttribArray(l)}),!0)}function gs(e,t,n,r){Ss(e,r),Jo(e,t,function(){return e.activeTexture(e.TEXTURE0+r)}),Jo(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)})}function ms(e,t,n,r){return Ns(e,t,function(){return e.getUniformLocation(n,r)},'uniform "'+r+'" not present in program.')}function vs(e,t,n){return e.getUniformLocation(t,n)}function bs(e,t,n,r,a,i){Jo(e,t,function(){return gs(e,t,r,i)}),Jo(e,t,function(){return e.uniform1i(a,i)})}function xs(e,t,n,r){Jo(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,r)}),Jo(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0)})}function ys(e,t,n){Jo(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)}),Jo(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)})}function ws(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+ks(e,t))}function ks(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function Ns(e,t,n,r){var a=Jo(e,t,function(){return n()});if(null==a)throw new Error(r);return a}function Ss(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n)throw new Error("textureUnit must be in [gl.TEXTURE0, gl.TEXTURE"+n+"].")}function Cs(e,t){return void 0===t&&(t=2),Ai(e.slice(0,e.length-t))}function Es(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function _s(e){var t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[Cs(e)].concat(Es(e))),t}function Is(e,t){var n;void 0===t&&(t=!1);var r=fi().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(r*=2,1===(e=e.map(function(t,n){return n>=e.length-2?Si(e[n]):e[n]})).length&&(e=[2,e[0]])),2!==e.length){var a=Bi(e);e=a.newShape}var i=Ai(e);if(e.length<=1&&i<=r)return[1,i];if(2===e.length&&e[0]<=r&&e[1]<=r)return e;if(3===e.length&&e[0]*e[1]<=r&&e[2]<=r)return[e[0]*e[1],e[2]];if(3===e.length&&e[0]<=r&&e[1]*e[2]<=r)return[e[0],e[1]*e[2]];if(4===e.length&&e[0]*e[1]*e[2]<=r&&e[3]<=r)return[e[0]*e[1]*e[2],e[3]];if(4===e.length&&e[0]<=r&&e[1]*e[2]*e[3]<=r)return[e[0],e[1]*e[2]*e[3]];if(t){var o=Cs(e),s=2,l=2;return e.length&&(s=(n=Es(e))[0],l=n[1]),Oi(i=o*(s/2)*(l/2)).map(function(e){return 2*e})}return Oi(i)}function Ts(e){return e%2==0}function As(e,t){if(Ri(e=e.slice(-2),t=t.slice(-2)))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r)return!0;if(Ts(n)&&Ts(r)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&Ts(e[0])&&Ts(t[0])}function Rs(e){if(null==rs){var t=qo(e);rs=t.getParameter(t.MAX_TEXTURE_SIZE)}return rs}function Ds(e){if(null==as){var t=qo(e);as=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,as)}function Fs(e){if(0===e)return 0;var t=qo(e);return Os(t,"EXT_disjoint_timer_query_webgl2")&&2===e?2:Os(t,"EXT_disjoint_timer_query")?1:0}function Os(e,t){return null!=e.getExtension(t)}function Ls(e){try{if(null!=qo(e))return!0}catch(e){return!1}return!1}function Ps(e){if(0===e)return!1;var t=qo(e);if(1===e){if(!Os(t,"OES_texture_float"))return!1}else if(!Os(t,"EXT_color_buffer_float"))return!1;return js(t)}function Ms(e){if(0===e)return!1;var t=qo(e);if(1!==e){if(Os(t,"EXT_color_buffer_float"))return js(t);if(Os(t,"EXT_color_buffer_half_float")){var n=t.getExtension("EXT_color_buffer_half_float");return function(e,t){var n=$o(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var a=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,a),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);var i=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(a),i}(t,n)}return!1}return!!Os(t,"OES_texture_float")&&!!Os(t,"WEBGL_color_buffer_float")&&js(t)}function js(e){var t=$o(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),a}function Bs(e){return 2===e&&null!=qo(e).fenceSync}var zs=Object.freeze({callAndCheck:Jo,canBeRepresented:Qo,getWebGLErrorMessage:Zo,getExtensionOrThrow:es,createVertexShader:ts,createFragmentShader:ns,createProgram:os,linkProgram:ss,validateProgram:ls,createStaticVertexBuffer:cs,createStaticIndexBuffer:us,getNumChannels:function(){return 2===fi().getNumber("WEBGL_VERSION")?1:4},createTexture:hs,validateTextureSize:ds,createFramebuffer:fs,bindVertexBufferToProgramAttribute:ps,bindTextureUnit:gs,unbindTextureUnit:function(e,t,n){Ss(e,n),Jo(e,t,function(){return e.activeTexture(e.TEXTURE0+n)}),Jo(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})},getProgramUniformLocationOrThrow:ms,getProgramUniformLocation:vs,bindTextureToProgramUniformSampler:bs,bindCanvasToFramebuffer:function(e,t){Jo(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)}),Jo(e,t,function(){return e.viewport(0,0,e.canvas.width,e.canvas.height)}),Jo(e,t,function(){return e.scissor(0,0,e.canvas.width,e.canvas.height)})},bindColorTextureToFramebuffer:xs,unbindColorTextureFromFramebuffer:ys,validateFramebuffer:ws,getFramebufferErrorMessage:ks,getBatchDim:Cs,getRowsCols:Es,getShapeAs3D:_s,getTextureShapeFromLogicalShape:Is,isReshapeFree:As,getWebGLMaxTextureSize:Rs,resetMaxTextureSize:function(){rs=null},resetMaxTexturesInShader:function(){as=null},getMaxTexturesInShader:Ds,getWebGLDisjointQueryTimerVersion:Fs,hasExtension:Os,isWebGLVersionEnabled:Ls,isCapableOfRenderingToFloatTexture:Ps,isDownloadFloatTextureEnabled:Ms,isWebGLFenceEnabled:Bs}),Ws=fi();function Us(e){fi().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function Vs(e,t){return Mo.tidy(e,t)}function Hs(e){Fo(e).forEach(function(e){return e.dispose()})}function Gs(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];fi().getBool("IS_TEST")||console.warn.apply(console,e)}function qs(e,t){var n=e;if(Gi(e))return"string"===t?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||Gi(n)&&"string"!==t;)r.push(n.length),n=n[0];return Array.isArray(e)&&fi().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function e(t,n,r){if(r=r||[],Array.isArray(t)||Gi(t)){Ei(n.length>0,function(){return"Element arr["+r.join("][")+"] should be a primitive, but is an array of "+t.length+" elements"}),Ei(t.length===n[0],function(){return"Element arr["+r.join("][")+"] should have "+n[0]+" elements, but has "+t.length+" elements"});for(var a=n.slice(1),i=0;i<t.length;++i)e(t[i],a,r.concat(i))}else Ei(0===n.length,function(){return"Element arr["+r.join("][")+"] is a primitive, but should be an array/TypedArray of "+n[0]+" elements"})}(e,r,[]),r}function Ks(e,t,n,r){if(null!=e&&("numeric"!==e&&e!==t||"numeric"===e&&"string"===t))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+e+" tensor, but got "+t+" tensor")}function Xs(e,t,n,r){if(void 0===r&&(r="numeric"),e instanceof wo)return Ks(r,e.dtype,t,n),e;var a=Ji(e);if("string"!==a&&["bool","int32","float32"].indexOf(r)>=0&&(a=r),Ks(r,a,t,n),null==e||!Gi(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e){var i=null==e?"null":e.constructor.name;throw new Error("Argument '"+t+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+i+"'")}var o=qs(e,a);Gi(e)||Array.isArray(e)||(e=[e]);var s="string"!==a?to(e,a,fi().getBool("DEBUG")):Ti(e,[],!0);return Mo.makeTensor(s,o,a)}function Ys(e,t,n,r){if(void 0===r&&(r="numeric"),!Array.isArray(e))throw new Error("Argument "+t+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return e.map(function(e,r){return Xs(e,t+"["+r+"]",n)},r)}function $s(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function Js(e,t,n){for(var r=e.length+t.length,a=[],i=0,o=0,s=0;s<r;s++)-1===n.indexOf(s)?a.push(e[i++]):a.push(t[o++]);return a}function Qs(e,t){for(var n=[],r=e.length,a=0;a<r;a++)-1===t.indexOf(a)&&n.push(e[a]);return[n,t.map(function(t){return e[t]})]}function Zs(e,t){return Js(e,t.map(function(e){return 1}),t)}function el(e,t,n){Ei($s(t,n),function(){return e+" supports only inner-most axes for now. Got axes "+t+" and rank-"+n+" input."})}function tl(e,t){if($s(e,t))return null;for(var n=[],r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach(function(e){return n.push(e)}),n}function nl(e){return e.map(function(e,t){return[t,e]}).sort(function(e,t){return e[1]-t[1]}).map(function(e){return e[0]})}function rl(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}function al(e,t){var n=e[0].length;e.forEach(function(e,t){Ei(e.length===n,function(){return"Error in concat"+n+"D: rank of tensors["+t+"] must be the same as the rank of the rest ("+n+")"})}),Ei(t>=0&&t<n,function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."});var r=e[0];e.forEach(function(e,a){for(var i=0;i<n;i++)Ei(i===t||e[i]===r[i],function(){return"Error in concat"+n+"D: Shape of tensors["+a+"] ("+e+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+a+"."})})}function il(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}function ol(e){var t=Object.keys(e);if(1!==t.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var a=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Mo.startScope(n);try{var a=r.apply(void 0,e);return a instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),Mo.endScope(a),a}catch(e){throw Mo.endScope(null),e}};return Object.defineProperty(a,"name",{value:n,configurable:!0}),a}Ws.registerFlag("HAS_WEBGL",function(){return Ws.getNumber("WEBGL_VERSION")>0}),Ws.registerFlag("WEBGL_VERSION",function(){return Ls(2)?2:Ls(1)?1:0}),Ws.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return 2===Ws.get("WEBGL_VERSION")}),Ws.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),Ws.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),Ws.registerFlag("WEBGL_PACK",function(){return Ws.getBool("HAS_WEBGL")}),Ws.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return Ws.getBool("WEBGL_PACK")}),Ws.registerFlag("WEBGL_PACK_CLIP",function(){return Ws.getBool("WEBGL_PACK")}),Ws.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),Ws.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return Ws.getBool("WEBGL_PACK")}),Ws.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return Ws.getBool("WEBGL_PACK")}),Ws.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return Ws.getBool("WEBGL_PACK")}),Ws.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return Ws.getBool("WEBGL_PACK")}),Ws.registerFlag("WEBGL_PACK_REDUCE",function(){return Ws.getBool("WEBGL_PACK")}),Ws.registerFlag("WEBGL_LAZILY_UNPACK",function(){return Ws.getBool("WEBGL_PACK")}),Ws.registerFlag("WEBGL_CONV_IM2COL",function(){return Ws.getBool("WEBGL_PACK")}),Ws.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return Rs(Ws.getNumber("WEBGL_VERSION"))}),Ws.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return Ds(Ws.getNumber("WEBGL_VERSION"))}),Ws.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var e=Ws.getNumber("WEBGL_VERSION");return 0===e?0:Fs(e)}),Ws.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return Ws.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(e=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))));var e}),Ws.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return Ps(Ws.getNumber("WEBGL_VERSION"))}),Ws.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!Ws.getBool("WEBGL_FORCE_F16_TEXTURES")&&Ws.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),Ws.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return Ms(Ws.getNumber("WEBGL_VERSION"))}),Ws.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return Bs(Ws.getNumber("WEBGL_VERSION"))}),Ws.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return Ws.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),yo=Us;var sl=ol({complex_:function(e,t){var n=Xs(e,"real","complex"),r=Xs(t,"imag","complex");return _i(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),Mo.runKernelFunc(function(e){return e.complex(n,r)},{$real:n,$imag:r})}}),ll=ol({real_:function(e){var t=Xs(e,"input","real");return Mo.runKernelFunc(function(e){return e.real(t)},{$input:t})}}),cl=ol({imag_:function(e){var t=Xs(e,"input","imag");return Mo.runKernelFunc(function(e){return e.imag(t)},{$input:t})}});function ul(e,t,n){return hl(e,t,qs(e,n),n)}function hl(e,t,n,r){if(null==r&&(r=Ji(e)),"complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Gi(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){oo(t);var a=Ai(t),i=Ai(n);Ei(a===i,function(){return"Based on the provided shape, ["+t+"], the tensor should have "+a+" values but has "+i});for(var o=0;o<n.length;++o){var s=n[o],l=o!==n.length-1||s!==Ai(t.slice(o));Ei(n[o]===t[o]||!l,function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+t+"). "})}}return Gi(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==r?to(e,r,fi().getBool("DEBUG")):Ti(e,[],!0),Mo.makeTensor(e,t,r)}function dl(e,t){if((Gi(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&Gi(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return hl(e,[],[],t)}function fl(e,t){Ii(e);var n=qs(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return hl(e,null,n,t)}function pl(e,t,n){if(Ii(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");var r=qs(e,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return hl(e,t,r,n)}function gl(e,t,n){if(Ii(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");var r=qs(e,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return hl(e,t,r,n)}function ml(e,t,n){if(Ii(e),null!=t&&4!==t.length)throw new Error("tensor4d() requires shape to have four numbers");var r=qs(e,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return hl(e,t,r,n)}function vl(e,t){if(void 0===t&&(t="float32"),"complex64"===t){var n=vl(e,"float32"),r=bl(e,"float32");return sl(n,r)}var a=ro(Ai(e),t);return Mo.makeTensor(a,e,t)}function bl(e,t){if(void 0===t&&(t="float32"),"complex64"===t){var n=bl(e,"float32"),r=bl(e,"float32");return sl(n,r)}var a=ao(Ai(e),t);return Mo.makeTensor(a,e,t)}function xl(e,t,n){return Mo.runKernelFunc(function(r){return r.fill(e,t,n)},{})}function yl(e,t,n,r){if(void 0===n&&(n=1),void 0===r&&(r="float32"),0===n)throw new Error("Cannot have a step of zero");if(e===t||e<t&&n<0||t<e&&n>1)return bl([0],r);var a=ao(Math.abs(Math.ceil((t-e)/n)),r);t<e&&1===n&&(n=-1),a[0]=e;for(var i=1;i<a.length;i++)a[i]=a[i-1]+n;return fl(a,r)}var wl=ol({onesLike_:function(e){var t=Xs(e,"x","onesLike");if("complex64"===t.dtype){var n=wl(ll(t)),r=kl(cl(t));return sl(n,r)}return Mo.runKernelFunc(function(e){return e.onesLike(t)},{$x:t},function(e,t){return{$x:function(){return kl(e)}}})}}),kl=ol({zerosLike_:function(e){var t=Xs(e,"x","zerosLike");return Mo.runKernelFunc(function(e){return e.zerosLike(t)},{$x:t},function(e,t){return{$x:function(){return kl(e)}}})}}),Nl=ol({concat_:function(e,t){void 0===t&&(t=0),Ei(e.length>=1,function(){return"Pass at least one tensor to concat"});var n=Ys(e,"tensors","concat");"complex64"===n[0].dtype&&n.forEach(function(e){if("complex64"!==e.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype "+e.dtype+". ")}),t=ji(t,n[0].shape)[0];var r=il(n.map(function(e){return e.shape}),t);if(0===Ai(r))return ul([],r);if(1===(n=n.filter(function(e){return e.size>0})).length)return n[0];var a=n.map(function(e){return e.shape});al(a,t);var i=n,o={axis:t};return Mo.runKernelFunc(function(e){return e.concat(n,t)},i,function(e){var n=a.map(function(e){return e[t]});return Il(e,n,t).map(function(e){return function(){return e}})},"Concat",o)}}),Sl=ol({concat1d_:function(e){return Nl(e,0)}}),Cl=ol({concat2d_:function(e,t){return Nl(e,t)}}),El=ol({concat3d_:function(e,t){return Nl(e,t)}}),_l=ol({concat4d_:function(e,t){return Nl(e,t)}}),Il=ol({split_:function(e,t,n){void 0===n&&(n=0);var r,a=Xs(e,"x","split");return n=ji(n,a.shape)[0],"number"==typeof t?(Ei(a.shape[n]%t==0,function(){return"Number of splits must evenly divide the axis."}),r=new Array(t).fill(a.shape[n]/t)):(Ei(a.shape[n]===t.reduce(function(e,t){return e+t}),function(){return"The sum of sizes must match the size of the axis dimension."}),r=t),Mo.runKernelFunc(function(e){return e.split(a,r,n)},{$x:a},function(e){return{$x:function(){return Nl(e,n)}}})}});function Tl(e,t){return e(t={exports:{}},t.exports),t.exports}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof n.g?n.g:"undefined"!=typeof self&&self;var Al=Tl(function(e){!function(e,t){function n(e){var t,n=this,r=(t=4022871197,function(e){e=e.toString();for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)});n.next=function(){var e=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=e-(n.c=0|e)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(e),n.s0<0&&(n.s0+=1),n.s1-=r(e),n.s1<0&&(n.s1+=1),n.s2-=r(e),n.s2<0&&(n.s2+=1),r=null}function r(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function a(e,t){var a=new n(e),i=t&&t.state,o=a.next;return o.int32=function(){return 4294967296*a.next()|0},o.double=function(){return o()+11102230246251565e-32*(2097152*o()|0)},o.quick=o,i&&("object"==typeof i&&r(i,a),o.state=function(){return r(a,{})}),o}t&&t.exports?t.exports=a:this.alea=a}(0,e)}),Rl=Tl(function(e){!function(e,t){function n(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function r(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function a(e,t){var a=new n(e),i=t&&t.state,o=function(){return(a.next()>>>0)/4294967296};return o.double=function(){do{var e=((a.next()>>>11)+(a.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=a.next,o.quick=o,i&&("object"==typeof i&&r(i,a),o.state=function(){return r(a,{})}),o}t&&t.exports?t.exports=a:this.xor128=a}(0,e)}),Dl=Tl(function(e){!function(e,t){function n(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function r(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function a(e,t){var a=new n(e),i=t&&t.state,o=function(){return(a.next()>>>0)/4294967296};return o.double=function(){do{var e=((a.next()>>>11)+(a.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=a.next,o.quick=o,i&&("object"==typeof i&&r(i,a),o.state=function(){return r(a,{})}),o}t&&t.exports?t.exports=a:this.xorwow=a}(0,e)}),Fl=Tl(function(e){!function(e,t){function n(e){var t=this;t.next=function(){var e,n,r=t.x,a=t.i;return e=r[a],n=(e^=e>>>7)^e<<24,n^=(e=r[a+1&7])^e>>>10,n^=(e=r[a+3&7])^e>>>3,n^=(e=r[a+4&7])^e<<7,e=r[a+7&7],n^=(e^=e<<13)^e<<9,r[a]=n,t.i=a+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function r(e,t){return t.x=e.x.slice(),t.i=e.i,t}function a(e,t){null==e&&(e=+new Date);var a=new n(e),i=t&&t.state,o=function(){return(a.next()>>>0)/4294967296};return o.double=function(){do{var e=((a.next()>>>11)+(a.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=a.next,o.quick=o,i&&(i.x&&r(i,a),o.state=function(){return r(a,{})}),o}t&&t.exports?t.exports=a:this.xorshift7=a}(0,e)}),Ol=Tl(function(e){!function(e,t){function n(e){var t=this;t.next=function(){var e,n,r=t.w,a=t.X,i=t.i;return t.w=r=r+1640531527|0,n=a[i+34&127],e=a[i=i+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=a[i]=n^e,t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,a,i,o,s=[],l=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,l=Math.max(l,t.length)),a=0,i=-32;i<l;++i)t&&(r^=t.charCodeAt((i+32)%t.length)),0===i&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(o=o+1640531527|0,a=0==(n=s[127&i]^=r+o)?a+1:0);for(a>=128&&(s[127&(t&&t.length||0)]=-1),a=127,i=512;i>0;--i)r=s[a+34&127],n=s[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[a]=r^n;e.w=o,e.X=s,e.i=a}(t,e)}function r(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function a(e,t){null==e&&(e=+new Date);var a=new n(e),i=t&&t.state,o=function(){return(a.next()>>>0)/4294967296};return o.double=function(){do{var e=((a.next()>>>11)+(a.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=a.next,o.quick=o,i&&(i.X&&r(i,a),o.state=function(){return r(a,{})}),o}t&&t.exports?t.exports=a:this.xor4096=a}(0,e)}),Ll=Tl(function(e){!function(e,t){function n(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,a=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^a,t.a=a-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function r(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function a(e,t){var a=new n(e),i=t&&t.state,o=function(){return(a.next()>>>0)/4294967296};return o.double=function(){do{var e=((a.next()>>>11)+(a.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=a.next,o.quick=o,i&&("object"==typeof i&&r(i,a),o.state=function(){return r(a,{})}),o}t&&t.exports?t.exports=a:this.tychei=a}(0,e)}),Pl=Tl(function(e){!function(t,r){var a,i=this,o=256,s="random",l=r.pow(o,6),c=r.pow(2,52),u=2*c,h=255;function d(e,n,h){var d=[],v=g(function e(t,n){var r,a=[],i=typeof t;if(n&&"object"==i)for(r in t)try{a.push(e(t[r],n-1))}catch(e){}return a.length?a:"string"==i?t:t+"\0"}((n=1==n?{entropy:!0}:n||{}).entropy?[e,m(t)]:null==e?function(){try{var e;return a&&(e=a.randomBytes)?e=e(o):(e=new Uint8Array(o),(i.crypto||i.msCrypto).getRandomValues(e)),m(e)}catch(e){var n=i.navigator,r=n&&n.plugins;return[+new Date,i,r,i.screen,m(t)]}}():e,3),d),b=new f(d),x=function(){for(var e=b.g(6),t=l,n=0;e<c;)e=(e+n)*o,t*=o,n=b.g(1);for(;e>=u;)e/=2,t/=2,n>>>=1;return(e+n)/t};return x.int32=function(){return 0|b.g(4)},x.quick=function(){return b.g(4)/4294967296},x.double=x,g(m(b.S),t),(n.pass||h||function(e,t,n,a){return a&&(a.S&&p(a,b),e.state=function(){return p(b,{})}),n?(r[s]=e,t):e})(x,v,"global"in n?n.global:this==r,n.state)}function f(e){var t,n=e.length,r=this,a=0,i=r.i=r.j=0,s=r.S=[];for(n||(e=[n++]);a<o;)s[a]=a++;for(a=0;a<o;a++)s[a]=s[i=h&i+e[a%n]+(t=s[a])],s[i]=t;(r.g=function(e){for(var t,n=0,a=r.i,i=r.j,s=r.S;e--;)t=s[a=h&a+1],n=n*o+s[h&(s[a]=s[i=h&i+t])+(s[i]=t)];return r.i=a,r.j=i,n})(o)}function p(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function g(e,t){for(var n,r=e+"",a=0;a<r.length;)t[h&a]=h&(n^=19*t[h&a])+r.charCodeAt(a++);return m(t)}function m(e){return String.fromCharCode.apply(0,e)}if(r["seed"+s]=d,g(r.random(),t),e.exports){e.exports=d;try{a=n(385)}catch(e){}}}([],Math)});Pl.alea=Al,Pl.xor128=Rl,Pl.xorwow=Dl,Pl.xorshift7=Fl,Pl.xor4096=Ol,Pl.tychei=Ll;var Ml=Pl.alea,jl=function(){function e(e,t,n,r,a){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var i=a||Math.random();this.random=Ml(i.toString())}return e.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,n,r=!1;!r;){var a=void 0,i=void 0,o=void 0;do{o=(a=2*this.random()-1)*a+(i=2*this.random()-1)*i}while(o>=1||0===o);var s=Math.sqrt(-2*Math.log(o)/o);t=this.mean+this.stdDev*a*s,n=this.mean+this.stdDev*i*s,this.truncated&&!this.isValidTruncated(t)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(t)},e.prototype.convertValue=function(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)},e.prototype.isValidTruncated=function(e){return e<=this.upper&&e>=this.lower},e}(),Bl=function(){function e(e,t,n,r){this.alpha=e,this.beta=1/t,this.dtype=n;var a=r||Math.random();this.randu=Ml(a.toString()),this.randn=new jl(0,1,n,!1,this.randu()),this.d=e<1?e+2/3:e-1/3,this.c=1/Math.sqrt(9*this.d)}return e.prototype.nextValue=function(){for(var e,t,n,r,a,i;;){do{r=this.randn.nextValue(),i=1+this.c*r}while(i<=0);if(i*=i*i,t=1-.331*(e=r*r)*e,n=.5*e+this.d*(1-i+Math.log(i)),(a=this.randu())<t||Math.log(a)<n)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)},e.prototype.convertValue=function(e){return"float32"===this.dtype?e:Math.round(e)},e}(),zl=function(){function e(e,t,n,r){var a=this;if(void 0===e&&(e=0),void 0===t&&(t=1),this.canReturnFloat=function(){return null==a.dtype||"float32"===a.dtype},this.min=e,this.range=t-e,this.dtype=n,null==r&&(r=Math.random()),"number"==typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+e+" - "+t+" <= 1 and dtype is not float");this.random=Ml(r)}return e.prototype.convertValue=function(e){return this.canReturnFloat()?e:Math.round(e)},e.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},e}();function Wl(e,t,n){return void 0===t&&(t="float32"),t=t||"float32",oo(e),new vo(e,t,n)}var Ul=ol({batchToSpaceND_:function(e,t,n){var r=Xs(e,"x","batchToSpaceND"),a=t.reduce(function(e,t){return e*t});return Ei(r.rank>=1+t.length,function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+t.length}),Ei(n.length===t.length,function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+t.length}),Ei(r.shape[0]%a==0,function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+a}),Mo.runKernelFunc(function(e){return e.batchToSpaceND(r,t,n)},{$x:r},function(e){return{$x:function(){return e.spaceToBatchND(t,n)}}})}}),Vl=ol({broadcastTo_:function(e,t){var n=Xs(e,"broadcastTo","x"),r=n.shape;if(t.some(function(e){return!(e>0)||e%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<n.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+n.rank+".");if(t.length>n.rank){for(var a=n.shape.slice();a.length<t.length;)a.unshift(1);n=n.reshape(a)}for(var i=Array.from(t),o=t.length-1;o>=0;o--)if(n.shape[o]===t[o])i[o]=1;else if(1!==n.shape[o])throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+t+"].");var s=i.map(function(e,t){return e>1?t:-1}).filter(function(e){return e>=0});return 0===s.length?n.clone():Mo.runKernelFunc(function(e){return e.tile(n,i)},{input:n},function(e){return{input:function(){return e.sum(s,!0)}}})}}),Hl=ol({cast_:function(e,t){var n=Xs(e,"x","cast");if(!Vi(t))throw new Error("Failed to cast to unknown dtype "+t);if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");var r={dtype:t};return Mo.runKernelFunc(function(e){return e.cast(n,t)},{x:n},function(e){return{x:function(){return e.clone()}}},"Cast",r)}}),Gl=ol({clone_:function(e){var t=Xs(e,"x","clone",null);return Mo.runKernelFunc(function(){return Mo.makeTensorFromDataId(t.dataId,t.shape,t.dtype)},{$x:t},function(e){return{$x:function(){return e.toFloat()}}})}}),ql=ol({cumsum_:function(e,t,n,r){void 0===t&&(t=0),void 0===n&&(n=!1),void 0===r&&(r=!1);var a=Xs(e,"x","cumsum"),i=tl([t|=0],a.rank),o=a;null!=i&&(o=a.transpose(i));var s=rl(1,a.rank)[0],l=Mo.runKernelFunc(function(e){return e.cumsum(o,s,n,r)},{permutedX:o},function(e){return{permutedX:function(){return e.cumsum(t,n,!r)}}});return null!=i&&(l=l.transpose(i)),l}}),Kl=ol({depthToSpace_:function(e,t,n){void 0===n&&(n="NHWC");var r=Xs(e,"x","depthToSpace"),a="NHWC"===n?r.shape[1]:r.shape[2],i="NHWC"===n?r.shape[2]:r.shape[3],o="NHWC"===n?r.shape[3]:r.shape[1];return Ei(a*t>=0,function(){return"Negative dimension size caused by overflow when multiplying\n      "+a+" and "+t+"  for depthToSpace with input shape\n      "+r.shape}),Ei(i*t>=0,function(){return"Negative dimension size caused by overflow when multiplying\n      "+i+" and "+t+" for depthToSpace with input shape\n          "+r.shape}),Ei(o%(t*t)==0,function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+o+" for depthToSpace with input shape "+r.shape}),Mo.runKernelFunc(function(e){return e.depthToSpace(r,t,n)},{$x:r})}}),Xl=ol({expandDims_:function(e,t){void 0===t&&(t=0);var n=Xs(e,"x","expandDims",null);Ei(t<=n.rank,function(){return"Axis must be <= rank of the tensor"});var r=n.shape.slice();return t<0&&(Ei(-(n.rank+1)<=t,function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"}),t=n.rank+t+1),r.splice(t,0,1),sc(n,r)}}),Yl=ol({eye_:function(e,t,n,r){void 0===r&&(r="float32"),null==t&&(t=e);for(var a=Wl([e,t],r),i=e<=t?e:t,o=0;o<i;++o)a.set(1,o,o);var s=a.toTensor().as2D(e,t);if(null==n)return s;if(1===n.length)return hc(Xl(s,0),[n[0],1,1]);if(2===n.length)return hc(Xl(Xl(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return hc(Xl(Xl(Xl(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),$l=ol({multinomial_:function(e,t,n,r){void 0===r&&(r=!1);var a=Xs(e,"logits","multinomial"),i=a.size,o=a.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(o>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+o);n=n||Math.random();var s=1===o?a.as2D(1,-1):a,l=Mo.runKernelFunc(function(e){return e.multinomial(s,r,t,n)},{logits2D:s});return 1===o?l.as1D():l}}),Jl=ol({oneHot_:function(e,t,n,r){if(void 0===n&&(n=1),void 0===r&&(r=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var a=Xs(e,"indices","oneHot","int32"),i=a.shape.concat([t]);return a=a.flatten(),Mo.runKernelFunc(function(e){return e.oneHot(a,t,n,r)},{$indices:a},function(e){return{$indices:function(){return bl(a.shape,"float32")}}}).reshape(i)}}),Ql=ol({pad_:function(e,t,n){void 0===n&&(n=0);var r=Xs(e,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var a={paddings:t,constantValue:n};return Mo.runKernelFunc(function(e){return e.pad(r,t,n)},{x:r},function(e){var n=t.map(function(e){return e[0]});return{x:function(){return e.slice(n,r.shape)}}},"PadV2",a)}}),Zl=ol({pad1d_:function(e,t,n){return void 0===n&&(n=0),Ei(2===t.length,function(){return"Invalid number of paddings. Must be length of 2."}),Ql(e,[t],n)}}),ec=ol({pad2d_:function(e,t,n){return void 0===n&&(n=0),Ei(2===t.length&&2===t[0].length&&2===t[1].length,function(){return"Invalid number of paddings. Must be length of 2 each."}),Ql(e,t,n)}}),tc=ol({pad3d_:function(e,t,n){return void 0===n&&(n=0),Ei(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,function(){return"Invalid number of paddings. Must be length of 2 each."}),Ql(e,t,n)}}),nc=ol({pad4d_:function(e,t,n){return void 0===n&&(n=0),Ei(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,function(){return"Invalid number of paddings. Must be length of 2 each."}),Ql(e,t,n)}}),rc=ol({rand_:function(e,t,n){var r=Ai(e),a=null;if(null==n||"float32"===n)a=new Float32Array(r);else if("int32"===n)a=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type "+n);a=new Uint8Array(r)}for(var i=0;i<r;i++)a[i]=t();return Mo.makeTensor(a,e,n)}}),ac=ol({randomNormal_:function(e,t,n,r,a){if(void 0===t&&(t=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var i=new jl(t,n,r,!1,a),o=Wl(e,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}}),ic=ol({randomGamma_:function(e,t,n,r,a){if(void 0===n&&(n=1),void 0===r&&(r="float32"),null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type "+r);for(var i=new Bl(t,n,r,a),o=Wl(e,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}}),oc=ol({randomUniform_:function(e,t,n,r,a){void 0===t&&(t=0),void 0===n&&(n=1),void 0===r&&(r="float32");for(var i=Wl(e,r),o=new zl(t,n,null,a),s=0;s<i.values.length;s++)i.values[s]=o.nextValue();return i.toTensor()}}),sc=ol({reshape_:function(e,t){var n=Xs(e,"x","reshape",null);t=Mi(t,n.size),Ei(n.size===Ai(t),function(){return"new shape and old shape must have the same number of elements."});var r={shape:t};return Mo.runKernelFunc(function(e){return e.reshape(n,t)},{x:n},function(e){return{x:function(){return e.reshape(n.shape)}}},"Reshape",r)}}),lc=ol({spaceToBatchND_:function(e,t,n){var r=Xs(e,"x","spaceToBatchND");return Ei(r.rank>=1+t.length,function(){return"input rank "+r.rank+" should be > than [blockShape] "+t.length}),Ei(n.length===t.length,function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+t.length}),Ei(r.shape.reduce(function(e,r,a){return a>0&&a<=t.length?e&&(r+n[a-1][0]+n[a-1][1])%t[a-1]==0:e},!0),function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+t.toString()}),Mo.runKernelFunc(function(e){return e.spaceToBatchND(r,t,n)},{$x:r},function(e){return{$x:function(){return e.batchToSpaceND(t,n)}}})}}),cc=ol({squeeze_:function(e,t){var n=Xs(e,"x","squeeze");return sc(n,Bi(n.shape,t).newShape)}}),uc=ol({stack_:function(e,t){void 0===t&&(t=0);var n=Ys(e,"tensors","stack");if(Ei(n.length>=1,function(){return"Pass at least one tensor to tf.stack"}),1===n.length)return n[0].expandDims(t);var r=n[0].rank,a=n[0].shape,i=n[0].dtype;Ei(t<=r,function(){return"Axis must be <= rank of the tensor"}),n.forEach(function(e){_i(a,e.shape,"All tensors passed to stack must have matching shapes")}),n.forEach(function(e){Ei(i===e.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var o=n.map(function(e){return e.expandDims(t)});return Nl(o,t)}}),hc=ol({tile_:function(e,t){var n=Xs(e,"x","tile",null);Ei(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+t+"."});var r=[n],a={reps:t};return Mo.runKernelFunc(function(e,r){var a=e.tile(n,t);return r([n]),a},{x:n},function(e,n){var r=n[0];return{x:function(){var n=kl(r);if(1===r.rank)for(var a=0;a<t[0];++a)n=n.add(e.slice([a*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(a=0;a<t[0];++a)for(var i=0;i<t[1];++i)n=n.add(e.slice([a*r.shape[0],i*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(a=0;a<t[0];++a)for(i=0;i<t[1];++i)for(var o=0;o<t[2];++o)n=n.add(e.slice([a*r.shape[0],i*r.shape[1],o*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+r.rank+" tensors yet.");for(a=0;a<t[0];++a)for(i=0;i<t[1];++i)for(o=0;o<t[2];++o)for(var s=0;s<t[3];++s)n=n.add(e.slice([a*r.shape[0],i*r.shape[1],o*r.shape[2],s*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return n}}},"Tile",a,r)}}),dc=ol({truncatedNormal_:function(e,t,n,r,a){if(void 0===t&&(t=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var i=new jl(t,n,r,!0,a),o=Wl(e,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}}),fc=ol({unstack_:function(e,t){void 0===t&&(t=0),t=t||0;var n=Xs(e,"x","unstack");Ei(t>=-n.shape.length&&t<n.shape.length,function(){return"Axis = "+t+" is not in [-"+n.shape.length+", "+n.shape.length+")"}),t<0&&(t+=n.shape.length);var r={axis:t};return Mo.runKernelFunc(function(e){return e.unstack(n,t)},{x:n},function(e){return{x:function(){return uc(e,t)}}},"Unpack",r)}});function pc(e,t,n,r){void 0===r&&(r=!0);var a=[];if(r)(a=a.concat(t.slice(0))).push(e[0]/n),a=a.concat(e.slice(1));else{a=a.concat(e[0]);for(var i=t.length,o=0;o<i;++o)a=a.concat([e[o+1]/t[o],t[o]]);a=a.concat(e.slice(i+1))}return a}function gc(e,t,n){void 0===n&&(n=!0);var r=[];if(n){r.push(t);for(var a=t+1;a<e;++a)a<=2*t?(r.push(a),r.push(a-(t+1))):r.push(a)}else{var i=[],o=[];for(a=1;a<e;++a)a>=2*t+1||a%2==1?o.push(a):i.push(a);r.push.apply(r,i),r.push(0),r.push.apply(r,o)}return r}function mc(e,t,n,r){void 0===r&&(r=!0);var a=[];r?a.push(e[0]/n):a.push(e[0]*n);for(var i=1;i<e.length;++i)i<=t.length?r?a.push(t[i-1]*e[i]):a.push(e[i]/t[i-1]):a.push(e[i]);return a}function vc(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function bc(e,t,n){for(var r=e.slice(0,1),a=0;a<n;++a)r.push(e[a+1]-t[a][0]-t[a][1]);return r}function xc(e,t){if(e.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if("int32"!==t.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>e.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+e.rank);if(0===e.size)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+e.shape+".");for(var n=t.shape,r=n[n.length-1],a=1,i=0;i<n.length-1;++i)a*=n[i];var o=e.shape,s=n.slice();s.pop();var l=1;for(i=r;i<e.rank;++i)l*=o[i],s.push(o[i]);var c=eo(e.shape).map(function(e){return e/l}).concat([1]).slice(0,r);return[s,a,l,c]}Object.freeze({prepareAndValidate:xc});function yc(e){return e<=30?e:Zi(e,Math.floor(Math.sqrt(e)))}function wc(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+t.shape+", shape: "+e+", sliceDim: "+r+", and batchDim: "+a+".";if(n.rank<a)throw new Error(i+" update.rank < "+a+". ");if(e.length<r+(n.rank-a))throw new Error(i+" Output shape length < "+(r+(n.rank-a)));if(n.rank!==a+e.length-r)throw new Error(i+" update.rank != "+(a+e.length-r));for(var o=0;o<a;++o)if(n.shape[o]!==t.shape[o])throw new Error(i+" updates.shape["+o+"] ("+n.shape[o]+") != indices.shape["+o+"] ("+t.shape[o]+").");for(o=0;o<n.rank-a;++o)if(n.shape[o+a]!==e[o+r])throw new Error(i+" updates.shape["+(o+a)+"] ("+n.shape[o+a]+") != shape["+(o+a)+"] ("+e[o+a]+")")}function kc(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+e.rank+".");if("int32"!==t.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(0===n.length){if(0===t.size)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(0===e.size)throw new Error("Updates specified for empty output. updates shape: "+e.shape)}wc(n,t,e)}function Nc(e,t,n){for(var r=t.shape.length,a=r>1?t.shape[r-1]:1,i=n.length,o=1,s=a;s<i;++s)o*=n[s];var l=a<1?1:a;return{sliceRank:a,numUpdates:Ai(t.shape)/l,sliceSize:o,strides:eo(n.slice(0,a)).concat([1]),outputSize:Ai(n)}}Object.freeze({validateUpdateShape:wc,validateInput:kc,calculateShapes:Nc});function Sc(e,t,n){Ei(e.rank===t.length,function(){return"Error in slice"+e.rank+"D: Length of begin "+t+" must match the rank of the array ("+e.rank+")."}),Ei(e.rank===n.length,function(){return"Error in slice"+e.rank+"D: Length of size "+n+" must match the rank of the array ("+e.rank+")."});for(var r=function(r){Ei(t[r]+n[r]<=e.shape[r],function(){return"Error in slice"+e.rank+"D: begin["+r+"] + size["+r+"] ("+(t[r]+n[r])+") would overflow input.shape["+r+"] ("+e.shape[r]+")"})},a=0;a<e.rank;++a)r(a)}function Cc(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function Ec(e,t,n){for(var r=[],a=0;a<e.length;a++)r[a]=Math.ceil((t[a]-e[a])/n[a]);return r}function _c(e,t,n,r,a){var i=t[a],o=n[a]||1;(e&1<<a||null==i)&&(i=o>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[a];return i<0&&(i+=s),Ni(0,i,s-1)}function Ic(e,t,n,r,a){var i=t[a],o=n[a]||1;(e&1<<a||null==i)&&(i=o>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[a];return i<0&&(i+=s),o>0?Ni(0,i,s):Ni(-1,i,s-1)}function Tc(e,t,n){for(var r=n.length,a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(a=r+1;a<n.length;a++)if(t[a]>0||n[a]!==e[a])return!1;return!0}function Ac(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}Object.freeze({assertParamsValid:Sc,maskToAxes:Cc,computeOutShape:Ec,startForAxis:_c,stopForAxis:Ic,isSliceContinous:Tc,computeFlatOffset:Ac});function Rc(e){return Mo.customGrad(e)}var Dc=ol({softmax_:function(e,t){void 0===t&&(t=-1);var n=Xs(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+t);return Mo.runKernelFunc(function(e,r){var a=e.softmax(n,t);return r([a]),a},{logits:n},function(e,n){var r=n[0],a=e.mul(r);return{logits:function(){return a.sub(a.sum([t],!0).mul(r))}}},"Softmax",{dim:t},[],[!0])}}),Fc=ol({logSoftmax_:function(e,t){void 0===t&&(t=-1);var n=Xs(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+t);return Rc(function(e,n){var r=e.max(t,!0),a=e.sub(r),i=a.toFloat().sub(a.exp().sum(t,!0).log());return n([i]),{value:i,gradFunc:function(e,n){var r=n[0].exp();return e.sub(e.sum(t,!0).mul(r))}}})(n)}}),Oc=function(){function e(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}return e.prototype.get=function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)},e.prototype.set=function(e,t){this.dataIdsCount++,this.data.set(e,t)},e.prototype.has=function(e){return this.data.has(e)},e.prototype.delete=function(e){return this.dataIdsCount--,this.data.delete(e)},e.prototype.numDataIds=function(){return this.dataIdsCount},e}(),Lc=function(){function e(){}return e.prototype.time=function(e){return Pc("time")},e.prototype.read=function(e){return Pc("read")},e.prototype.readSync=function(e){return Pc("readSync")},e.prototype.numDataIds=function(){return Pc("numDataIds")},e.prototype.disposeData=function(e){return Pc("disposeData")},e.prototype.write=function(e,t,n){return Pc("write")},e.prototype.move=function(e,t,n,r){return Pc("move")},e.prototype.memory=function(){return Pc("memory")},e.prototype.floatPrecision=function(){return Pc("floatPrecision")},e.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},e.prototype.batchMatMul=function(e,t,n,r){return Pc("batchMatMul")},e.prototype.fusedBatchMatMul=function(e){return e.a,e.b,e.transposeA,e.transposeB,e.bias,e.activation,e.preluActivationWeights,Pc("fusedBatchMatMul")},e.prototype.slice=function(e,t,n){return Pc("slice")},e.prototype.stridedSlice=function(e,t,n,r){return Pc("stridedSlice")},e.prototype.unstack=function(e,t){return Pc("unstack")},e.prototype.reverse=function(e,t){return Pc("reverse")},e.prototype.concat=function(e,t){return Pc("concat")},e.prototype.neg=function(e){return Pc("neg")},e.prototype.add=function(e,t){return Pc("add")},e.prototype.addN=function(e){return Pc("addN")},e.prototype.subtract=function(e,t){return Pc("subtract")},e.prototype.multiply=function(e,t){return Pc("multiply")},e.prototype.realDivide=function(e,t){return Pc("realDivide")},e.prototype.floorDiv=function(e,t){return Pc("floorDiv")},e.prototype.sum=function(e,t){return Pc("sum")},e.prototype.prod=function(e,t){return Pc("prod")},e.prototype.unsortedSegmentSum=function(e,t,n){return Pc("unsortedSegmentSum")},e.prototype.argMin=function(e,t){return Pc("argMin")},e.prototype.argMax=function(e,t){return Pc("argMax")},e.prototype.equal=function(e,t){return Pc("equal")},e.prototype.notEqual=function(e,t){return Pc("notEqual")},e.prototype.less=function(e,t){return Pc("less")},e.prototype.lessEqual=function(e,t){return Pc("lessEqual")},e.prototype.greater=function(e,t){return Pc("greater")},e.prototype.greaterEqual=function(e,t){return Pc("greaterEqual")},e.prototype.logicalNot=function(e){return Pc("logicalNot")},e.prototype.logicalAnd=function(e,t){return Pc("logicalAnd")},e.prototype.logicalOr=function(e,t){return Pc("logicalOr")},e.prototype.where=function(e){return Pc("where")},e.prototype.select=function(e,t,n){return Pc("select")},e.prototype.topk=function(e,t,n){return Pc("topk")},e.prototype.min=function(e,t){return Pc("min")},e.prototype.minimum=function(e,t){return Pc("minimum")},e.prototype.mod=function(e,t){return Pc("mod")},e.prototype.max=function(e,t){return Pc("max")},e.prototype.maximum=function(e,t){return Pc("maximum")},e.prototype.all=function(e,t){return Pc("all")},e.prototype.any=function(e,t){return Pc("any")},e.prototype.squaredDifference=function(e,t){return Pc("squaredDifference")},e.prototype.ceil=function(e){return Pc("ceil")},e.prototype.floor=function(e){return Pc("floor")},e.prototype.round=function(e){return Pc("round")},e.prototype.sign=function(e){return Pc("sign")},e.prototype.isNaN=function(e){return Pc("isNaN")},e.prototype.isInf=function(e){return Pc("isInf")},e.prototype.isFinite=function(e){return Pc("isFinite")},e.prototype.pow=function(e,t){return Pc("pow")},e.prototype.exp=function(e){return Pc("exp")},e.prototype.expm1=function(e){return Pc("expm1")},e.prototype.softmax=function(e,t){return Pc("softmax")},e.prototype.log=function(e){return Pc("log")},e.prototype.log1p=function(e){return Pc("log1p")},e.prototype.sqrt=function(e){return Pc("sqrt")},e.prototype.rsqrt=function(e){return Pc("rsqrt")},e.prototype.square=function(e){return Pc("square")},e.prototype.reciprocal=function(e){return Pc("reciprocal")},e.prototype.relu=function(e){return Pc("relu")},e.prototype.relu6=function(e){return Pc("relu6")},e.prototype.prelu=function(e,t){return Pc("prelu")},e.prototype.elu=function(e){return Pc("elu")},e.prototype.eluDer=function(e,t){return Pc("eluDer")},e.prototype.selu=function(e){return Pc("selu")},e.prototype.int=function(e){return Pc("int")},e.prototype.clip=function(e,t,n){return Pc("clip")},e.prototype.abs=function(e){return Pc("abs")},e.prototype.complexAbs=function(e){return Pc("complexAbs")},e.prototype.sigmoid=function(e){return Pc("sigmoid")},e.prototype.softplus=function(e){return Pc("softplus")},e.prototype.sin=function(e){return Pc("sin")},e.prototype.cos=function(e){return Pc("cos")},e.prototype.tan=function(e){return Pc("tan")},e.prototype.asin=function(e){return Pc("asin")},e.prototype.acos=function(e){return Pc("acos")},e.prototype.atan=function(e){return Pc("atan")},e.prototype.atan2=function(e,t){return Pc("atan2")},e.prototype.sinh=function(e){return Pc("sinh")},e.prototype.cosh=function(e){return Pc("cosh")},e.prototype.tanh=function(e){return Pc("tanh")},e.prototype.asinh=function(e){return Pc("asinh")},e.prototype.acosh=function(e){return Pc("acosh")},e.prototype.atanh=function(e){return Pc("atanh")},e.prototype.erf=function(e){return Pc("erf")},e.prototype.step=function(e,t){return Pc("step")},e.prototype.fusedConv2d=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,Pc("fusedConv2d")},e.prototype.conv2d=function(e,t,n){return Pc("conv2d")},e.prototype.conv2dDerInput=function(e,t,n){return Pc("conv2dDerInput")},e.prototype.conv2dDerFilter=function(e,t,n){return Pc("conv2dDerFilter")},e.prototype.fusedDepthwiseConv2D=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,Pc("fusedDepthwiseConv2D")},e.prototype.depthwiseConv2D=function(e,t,n){return Pc("depthwiseConv2D")},e.prototype.depthwiseConv2DDerInput=function(e,t,n){return Pc("depthwiseConv2DDerInput")},e.prototype.depthwiseConv2DDerFilter=function(e,t,n){return Pc("depthwiseConv2DDerFilter")},e.prototype.conv3d=function(e,t,n){return Pc("conv3d")},e.prototype.conv3dDerInput=function(e,t,n){return Pc("conv3dDerInput")},e.prototype.conv3dDerFilter=function(e,t,n){return Pc("conv3dDerFilter")},e.prototype.maxPool=function(e,t){return Pc("maxPool")},e.prototype.maxPoolBackprop=function(e,t,n,r){return Pc("maxPoolBackprop")},e.prototype.avgPool=function(e,t){return Pc("avgPool")},e.prototype.avgPoolBackprop=function(e,t,n){return Pc("avgPoolBackprop")},e.prototype.avgPool3d=function(e,t){return Pc("avgPool3d")},e.prototype.avgPool3dBackprop=function(e,t,n){return Pc("avgPool3dBackprop")},e.prototype.maxPool3d=function(e,t){return Pc("maxPool3d")},e.prototype.maxPool3dBackprop=function(e,t,n,r){return Pc("maxPool3dBackprop")},e.prototype.reshape=function(e,t){return Pc("reshape")},e.prototype.cast=function(e,t){return Pc("cast")},e.prototype.tile=function(e,t){return Pc("tile")},e.prototype.pad=function(e,t,n){return Pc("pad")},e.prototype.transpose=function(e,t){return Pc("transpose")},e.prototype.gather=function(e,t,n){return Pc("gather")},e.prototype.gatherND=function(e,t){return Pc("gatherND")},e.prototype.scatterND=function(e,t,n){return Pc("scatterND")},e.prototype.batchToSpaceND=function(e,t,n){return Pc("batchToSpaceND")},e.prototype.spaceToBatchND=function(e,t,n){return Pc("spaceToBatchND")},e.prototype.resizeBilinear=function(e,t,n,r){return Pc("resizeBilinear")},e.prototype.resizeBilinearBackprop=function(e,t,n){return Pc("resizeBilinearBackprop")},e.prototype.resizeNearestNeighbor=function(e,t,n,r){return Pc("resizeNearestNeighbor")},e.prototype.resizeNearestNeighborBackprop=function(e,t,n){return Pc("resizeNearestNeighborBackprop")},e.prototype.batchNormalization=function(e,t,n,r,a,i){return Pc("batchNormalization")},e.prototype.localResponseNormalization4D=function(e,t,n,r,a){return Pc("localResponseNormalization4D")},e.prototype.LRNGrad=function(e,t,n,r,a,i,o){return Pc("LRNGrad")},e.prototype.multinomial=function(e,t,n,r){return Pc("multinomial")},e.prototype.oneHot=function(e,t,n,r){return Pc("oneHot")},e.prototype.cumsum=function(e,t,n,r){return Pc("cumsum")},e.prototype.nonMaxSuppression=function(e,t,n,r,a){return Pc("nonMaxSuppression")},e.prototype.fft=function(e){return Pc("fft")},e.prototype.ifft=function(e){return Pc("ifft")},e.prototype.complex=function(e,t){return Pc("complex")},e.prototype.real=function(e){return Pc("real")},e.prototype.imag=function(e){return Pc("imag")},e.prototype.cropAndResize=function(e,t,n,r,a,i){return Pc("cropAndResize")},e.prototype.depthToSpace=function(e,t,n){return Pc("depthToSpace")},e.prototype.split=function(e,t,n){return Pc("split")},e.prototype.sparseToDense=function(e,t,n,r){return Pc("sparseToDense")},e.prototype.diag=function(e){return Pc("diag")},e.prototype.fill=function(e,t,n){return Pc("fill")},e.prototype.onesLike=function(e){return Pc("onesLike")},e.prototype.zerosLike=function(e){return Pc("zerosLike")},e.prototype.linspace=function(e,t,n){return Pc("linspace")},e.prototype.dispose=function(){return Pc("dispose")},e}();function Pc(e){throw new Error("'"+e+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function Mc(e,t){for(var n=e.length,r=[],a=0;a<n;a++){var i=n-1-a,o=e[i]||1;(t[t.length-1-a]||1)>1&&1===o&&r.unshift(i)}return r}function jc(e,t){for(var n=[],r=0;r<t.length;r++){var a=e[e.length-r-1],i=t.length-r-1,o=t[i];(null==a||1===a&&o>1)&&n.unshift(i)}return n}function Bc(e,t){for(var n=[],r=Math.max(e.length,t.length),a=0;a<r;a++){var i=e[e.length-a-1];null==i&&(i=1);var o=t[t.length-a-1];if(null==o&&(o=1),1===i)n.unshift(o);else if(1===o)n.unshift(i);else{if(i!==o)throw Error("Operands could not be broadcast together with shapes "+e+" and "+t+".");n.unshift(i)}}return n}function zc(e,t,n,r,a,i,o){void 0===o&&(o="channelsLast");var s,l=Gc(t),c=l[0],u=l[1];if("channelsLast"===o)s=[c,u,e[3],e[3]];else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat "+o);s=[c,u,e[1],e[1]]}return Uc(e,s,n,r,a,i,!1,o)}function Wc(e,t,n,r,a,i,o){void 0===o&&(o="NDHWC");var s,l,c=qc(t),u=c[0],h=c[1],d=c[2];if("NDHWC"===o)l="channelsLast",s=[u,h,d,e[4],e[4]];else{if("NCDHW"!==o)throw new Error("Unknown dataFormat "+o);l="channelsFirst",s=[u,h,d,e[1],e[1]]}return Vc(e,s,n,r,a,!1,l,i)}function Uc(e,t,n,r,a,i,o,s){void 0===o&&(o=!1),void 0===s&&(s="channelsLast");var l=[-1,-1,-1,-1],c=l[0],u=l[1],h=l[2],d=l[3];if("channelsLast"===s)c=e[0],u=e[1],h=e[2],d=e[3];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat "+s);c=e[0],d=e[1],u=e[2],h=e[3]}var f,p=t[0],g=t[1],m=t[3],v=Gc(n),b=v[0],x=v[1],y=Gc(r),w=y[0],k=y[1],N=Kc(p,w),S=Kc(g,k),C=function(e,t,n,r,a,i,o,s){var l,c,u;if("number"==typeof e){l={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};var h=function(e,t,n,r,a){null==r&&(r=Hc(e,t,n));var i=e[1],o=Xc((e[0]-t+2*r)/n+1,a);Ei(Di(o),function(){return"The output # of rows ("+o+") must be an integer. Change the stride and/or zero pad parameters"});var s=Xc((i-t+2*r)/n+1,a);return Ei(Di(s),function(){return"The output # of columns ("+s+") must be an integer. Change the stride and/or zero pad parameters"}),[o,s]}([t,n],i,r,e,s);c=h[0],u=h[1]}else if("same"===e){c=Math.ceil(t/r),u=Math.ceil(n/a);var d=Math.max(0,(c-1)*r+i-t),f=Math.max(0,(u-1)*a+o-n),p=Math.floor(d/2),g=d-p,m=Math.floor(f/2);l={top:p,bottom:g,left:m,right:f-m,type:"SAME"}}else{if("valid"!==e)throw Error("Unknown padding parameter: "+e);l={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((t-i+1)/r),u=Math.ceil((n-o+1)/a)}return{padInfo:l,outHeight:c,outWidth:u}}(a,u,h,b,x,N,S,i),E=C.padInfo,_=C.outHeight,I=C.outWidth,T=o?m*d:m;return"channelsFirst"===s?f=[c,T,_,I]:"channelsLast"===s&&(f=[c,_,I,T]),{batchSize:c,dataFormat:s,inHeight:u,inWidth:h,inChannels:d,outHeight:_,outWidth:I,outChannels:T,padInfo:E,strideHeight:b,strideWidth:x,filterHeight:p,filterWidth:g,effectiveFilterHeight:N,effectiveFilterWidth:S,dilationHeight:w,dilationWidth:k,inShape:e,outShape:f,filterShape:t}}function Vc(e,t,n,r,a,i,o,s){void 0===i&&(i=!1),void 0===o&&(o="channelsLast");var l=[-1,-1,-1,-1,-1],c=l[0],u=l[1],h=l[2],d=l[3],f=l[4];if("channelsLast"===o)c=e[0],u=e[1],h=e[2],d=e[3],f=e[4];else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat "+o);c=e[0],f=e[1],u=e[2],h=e[3],d=e[4]}var p,g=t[0],m=t[1],v=t[2],b=t[4],x=qc(n),y=x[0],w=x[1],k=x[2],N=qc(r),S=N[0],C=N[1],E=N[2],_=Kc(g,S),I=Kc(m,C),T=Kc(v,E),A=function(e,t,n,r,a,i,o,s,l,c,u){var h,d,f,p;if("number"==typeof e){h={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};var g=function(e,t,n,r,a,i){null==a&&(a=Hc(e,t,r));var o=e[1],s=e[2],l=Xc((e[0]-t+2*a)/r+1,i);Ei(Di(l),function(){return"The output # of depths ("+l+") must be an integer. Change the stride and/or zero pad parameters"});var c=Xc((o-t+2*a)/r+1,i);Ei(Di(c),function(){return"The output # of rows ("+c+") must be an integer. Change the stride and/or zero pad parameters"});var u=Xc((s-t+2*a)/r+1,i);return Ei(Di(u),function(){return"The output # of columns ("+u+") must be an integer. Change the stride and/or zero pad parameters"}),[l,c,u,1]}([t,n,r,1],s,0,a,e,u);d=g[0],f=g[1],p=g[2]}else if("same"===e){var m=((d=Math.ceil(t/a))-1)*a+s-t,v=((f=Math.ceil(n/i))-1)*i+l-n,b=((p=Math.ceil(r/o))-1)*o+c-r,x=Math.floor(m/2),y=m-x,w=Math.floor(v/2),k=v-w,N=Math.floor(b/2);h={top:w,bottom:k,left:N,right:b-N,front:x,back:y,type:"SAME"}}else{if("valid"!==e)throw Error("Unknown padding parameter: "+e);h={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},d=Math.ceil((t-s+1)/a),f=Math.ceil((n-l+1)/i),p=Math.ceil((r-c+1)/o)}return{padInfo:h,outDepth:d,outHeight:f,outWidth:p}}(a,u,h,d,y,w,k,_,I,T,s),R=A.padInfo,D=A.outDepth,F=A.outHeight,O=A.outWidth,L=i?b*f:b;return"channelsFirst"===o?p=[c,L,D,F,O]:"channelsLast"===o&&(p=[c,D,F,O,L]),{batchSize:c,dataFormat:o,inDepth:u,inHeight:h,inWidth:d,inChannels:f,outDepth:D,outHeight:F,outWidth:O,outChannels:L,padInfo:R,strideDepth:y,strideHeight:w,strideWidth:k,filterDepth:g,filterHeight:m,filterWidth:v,effectiveFilterDepth:_,effectiveFilterHeight:I,effectiveFilterWidth:T,dilationDepth:S,dilationHeight:C,dilationWidth:E,inShape:e,outShape:p,filterShape:t}}function Hc(e,t,n,r){void 0===r&&(r=1);var a=Kc(t,r);return Math.floor((e[0]*(n-1)-n+a)/2)}function Gc(e){return"number"==typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function qc(e){return"number"==typeof e?[e,e,e]:e}function Kc(e,t){return t<=1?e:e+(e-1)*(t-1)}function Xc(e,t){if(!t)return e;switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode "+t)}}function Yc(e){var t=Gc(e),n=t[0],r=t[1],a=t[2];return 1===n&&1===r&&1===a}function $c(e,t){return Yc(e)||Yc(t)}function Jc(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error("Unknown dataFormat "+e)}function Qc(e,t,n){if("complex64"===t){if("complex64"===e.dtype)return e.clone();var r=bl(e.shape),a=e.toFloat(),i=n.complex(a,r);return r.dispose(),a.dispose(),i}if(!Hi(e.dtype,t))return Mo.makeTensorFromDataId(e.dataId,e.shape,t);if("complex64"===e.dtype){var o=n.real(e);return i=o.cast(t),o.dispose(),i}if("int32"===t)return n.int(e);if("bool"===t){var s=dl(0,e.dtype);return i=n.notEqual(e,s),s.dispose(),i}throw new Error("Error in Cast: failed to cast "+e.dtype+" to "+t)}function Zc(e,t){return Mo.makeTensorFromDataId(e.dataId,t,e.dtype)}function eu(e,t,n){var r=(t-e)/(n-1),a=ao(n,"float32");a[0]=e;for(var i=1;i<a.length;i++)a[i]=a[i-1]+r;return fl(a,"float32")}Object.freeze({castTensor:Qc,reshapeTensor:Zc,linspaceImpl:eu,upcastType:To,axesAreInnerMostDims:$s,combineLocations:Js,computeOutAndReduceShapes:Qs,expandShapeToKeepDim:Zs,assertAxesAreInnerMostDims:el,getAxesPermutation:tl,getUndoAxesPermutation:nl,getInnerMostAxes:rl,getBroadcastDims:Mc,getReductionAxes:jc,assertAndGetBroadcastShape:Bc,assertParamsConsistent:al,computeOutShape:il,computePool2DInfo:zc,computePool3DInfo:Wc,computeConv2DInfo:Uc,computeConv3DInfo:Vc,computeDefaultPad:Hc,tupleValuesAreOne:Yc,eitherStridesOrDilationsAreOne:$c,convertConv2DDataFormat:Jc,PARALLELIZE_THRESHOLD:30,computeOptimalWindowSize:yc});function tu(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+e.length+", imag: "+t.length+".");for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function nu(e,t){return{real:e[2*t],imag:e[2*t+1]}}function ru(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function au(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}function iu(e,t,n){var r=function(e,t,n){return function(e,t,n){for(var r=0,a=e.length,i=0,o=!1;r<a;){var s=n(t,e[i=r+(a-r>>>1)]);s>0?r=i+1:(a=i,o=!s)}return o?r:-r-1}(e,t,n||ou)}(e,t,n),a=r<0?-(r+1):r;e.splice(a,0,t)}function ou(e,t){return e>t?1:e<t?-1:0}function su(e,t,n,r,a){return cu(e,t,n,r,a,0).selectedIndices}function lu(e,t,n,r,a,i){var o=cu(e,t,n,r,a,i,!0);return o.numValidOutputs.dispose(),{selectedIndices:o.selectedIndices,selectedScores:o.selectedScores}}function cu(e,t,n,r,a,i,o,s){void 0===o&&(o=!1),void 0===s&&(s=!1);for(var l=Array.from(t).map(function(e,t){return{score:e,boxIndex:t,suppressBeginIndex:0}}).filter(function(e){return e.score>a}).sort(du),c=i>0?-.5/i:0,u=[],h=[];u.length<n&&l.length>0;){var d=l.pop(),f=d.score,p=d.boxIndex,g=d.suppressBeginIndex;if(f<a)break;for(var m=!1,v=u.length-1;v>=g;--v){var b=uu(e,p,u[v]);if(b>=r){m=!0;break}if(d.score=d.score*hu(r,c,b),d.score<=a)break}d.suppressBeginIndex=u.length,m||(d.score===f?(u.push(p),h.push(d.score)):d.score>a&&iu(l,d,du))}var x=u.length;return s&&(u.fill(0,x),h.fill(0,x)),{selectedIndices:fl(u,"int32"),selectedScores:fl(h,"float32"),numValidOutputs:dl(x,"int32")}}function uu(e,t,n){var r=e.subarray(4*t,4*t+4),a=e.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),c=Math.min(a[0],a[2]),u=Math.min(a[1],a[3]),h=Math.max(a[0],a[2]),d=Math.max(a[1],a[3]),f=(s-i)*(l-o),p=(h-c)*(d-u);if(f<=0||p<=0)return 0;var g=Math.max(i,c),m=Math.max(o,u),v=Math.min(s,h),b=Math.min(l,d),x=Math.max(v-g,0)*Math.max(b-m,0);return x/(f+p-x)}function hu(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function du(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function fu(e,t,n){var r=new Array(e.rank).fill(0),a=e.shape.slice();return t.map(function(t){a[n]=t;var i=e.slice(r,a);return r[n]+=t,i})}function pu(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];var a=Wl(n,e.dtype);for(r=0;r<a.values.length;++r){for(var i=a.indexToLoc(r),o=new Array(e.rank),s=0;s<o.length;s++)o[s]=i[s]%e.shape[s];var l=e.locToIndex(o);a.values[r]=e.values[l]}return a.toTensor()}function gu(e,t,n,r,a){for(var i=t[t.length-1],o=[e.length/i,i],s=o[0],l=o[1],c=zi(n,s*r),u=zi("int32",s*r),h=0;h<s;h++){for(var d=h*l,f=e.subarray(d,d+l),p=[],g=0;g<f.length;g++)p.push({value:f[g],index:g});p.sort(function(e,t){return t.value-e.value});var m=h*r,v=c.subarray(m,m+r),b=u.subarray(m,m+r);for(g=0;g<r;g++)v[g]=p[g].value,b[g]=p[g].index}var x=t.slice();return x[x.length-1]=r,[ul(c,x,n),ul(u,x,"int32")]}function mu(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);var a=Wl(e,"int32"),i=Wl([n.length,e.length],"int32");for(r=0;r<n.length;r++){var o=a.indexToLoc(n[r]),s=r*e.length;i.values.set(o,s)}return i.toTensor()}var vu=function(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map(function(e,t){return"T"+t});var n=[];this.variableNames.forEach(function(e){n.push("float v"+e+" = get"+e+"AtOutCoords();")});var r=this.variableNames.map(function(e){return"v"+e}).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        float result = "+r+";\n        setOutput(result);\n      }\n    "},bu=function(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map(function(e,t){return"T"+t});var n=[];this.variableNames.forEach(function(e){n.push("vec4 v"+e+" = get"+e+"AtOutCoords();")});var r=this.variableNames.map(function(e){return"v"+e}).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        vec4 result = "+r+";\n        setOutput(result);\n      }\n    "},xu=function(e,t,n){this.variableNames=["A"];var r=e.windowSize,a=e.batchSize,i=e.inSize,o=Math.ceil(i/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[a,o];var s="max"===t?">":"<",l=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+r+";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < "+r+"; i++) {\n          int inIdx = "+l+";\n          float candidate = getA(batch, inIdx);\n          if (candidate "+s+" bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    "};function yu(e,t){return["x","y","z","w","u","v"].slice(0,t).map(function(t){return e+"."+t})}function wu(e,t){return 1===t?[e]:yu(e,t)}function ku(){var e,t,n,r,a,i,o,s,l,c;return 2===fi().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",r="in",a="texture",i="outputColor",o="out vec4 outputColor;",s="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",l="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",r="varying",a="texture2D",i="gl_FragColor",o="",s="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",l="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:a,output:i,defineOutput:o,defineSpecialNaN:s,defineSpecialInf:l,defineRound:c}}function Nu(e,t,n){void 0===n&&(n="index");var r=eo(t);return r.map(function(t,a){return"int "+e[a]+" = "+n+" / "+t+"; "+(a===r.length-1?"int "+e[a+1]+" = "+n+" - "+e[a]+" * "+t:"index -= "+e[a]+" * "+t)+";"}).join("")}function Su(e){var t=eo(e).map(function(e){return e.toString()});return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * "+t[0]+" + coords.y * "+t[1]+" + coords.z;\n  }\n"}var Cu="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n";function Eu(e,t,n,r){var a=[];e.forEach(function(e){var t=Ai(e.shapeInfo.logicalShape);e.shapeInfo.isUniform?a.push("uniform float "+e.name+(t>1?"["+t+"]":"")+";"):(a.push("uniform sampler2D "+e.name+";"),a.push("uniform int offset"+e.name+";"))});var i,o,s=a.join("\n"),l=e.map(function(e){return function(e,t,n){void 0===n&&(n=!1);var r="";r+=n?Iu(e):_u(e);var a=e.shapeInfo.logicalShape,i=t.logicalShape;return a.length<=i.length&&(r+=n?function(e,t){var n,r=e.name,a=r.charAt(0).toUpperCase()+r.slice(1),i="get"+a+"AtOutCoords",o=e.shapeInfo.logicalShape.length,s=t.logicalShape.length,l=Mc(e.shapeInfo.logicalShape,t.logicalShape),c=Lu(s),u=s-o,h=["x","y","z","w","u","v"];n=0===o?"":s<2&&l.length>=1?"coords = 0;":l.map(function(e){return"coords."+h[e+u]+" = 0;"}).join("\n");var d;d=s<2&&o>0?"coords":e.shapeInfo.logicalShape.map(function(e,t){return"coords."+h[t+u]}).join(", ");var f="return outputValue;",p=1===Ai(e.shapeInfo.logicalShape),g=1===Ai(t.logicalShape);if(1!==o||p||g){if(p&&!g)f=1===s?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(l.length){var m=o-2,v=o-1;l.indexOf(m)>-1&&l.indexOf(v)>-1?f="return vec4(outputValue.x);":l.indexOf(m)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":l.indexOf(v)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}}else f="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 "+i+"() {\n      "+c+" coords = getOutputCoords();\n      "+n+"\n      vec4 outputValue = get"+a+"("+d+");\n      "+f+"\n    }\n  "}(e,t):function(e,t){var n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",i=t.texShape,o=e.shapeInfo.texShape,s=e.shapeInfo.logicalShape.length,l=t.logicalShape.length;if(!e.shapeInfo.isUniform&&s===l&&null==e.shapeInfo.flatOffset&&Ri(o,i))return"\n      float "+a+"() {\n        return sampleTexture("+n+", resultUV);\n      }\n    ";var c,u=Lu(l),h=Mc(e.shapeInfo.logicalShape,t.logicalShape),d=l-s,f=["x","y","z","w","u","v"];c=0===s?"":l<2&&h.length>=1?"coords = 0;":h.map(function(e){return"coords."+f[e+d]+" = 0;"}).join("\n");var p;return p=l<2&&s>0?"coords":e.shapeInfo.logicalShape.map(function(e,t){return"coords."+f[t+d]}).join(", "),"\n    float "+a+"() {\n      "+u+" coords = getOutputCoords();\n      "+c+"\n      return get"+r+"("+p+");\n    }\n  "}(e,t)),r}(e,t,r)}).join("\n"),c=t.texShape,u=ku(),h=function(e){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return "+e.texture2D+"(textureSampler, uv).r;\n    }\n  "}(u),d=function(e){return e.version+"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    "+e.varyingFs+" vec2 resultUV;\n    "+e.defineOutput+"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    "+e.defineSpecialNaN+"\n    "+e.defineSpecialInf+"\n    "+e.defineRound+"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    "+Tu+"\n    "+Au+"\n    "+Ru+"\n  "}(u);return t.isPacked?(i=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return 1===n[0]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * "+n[1]+".0);\n      }\n    ":1===n[1]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * "+n[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      return 2 * (resTexRC.x * "+n[1]+" + resTexRC.y);\n    }\n  "}(0,t);case 2:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(Ri(e,t))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2("+n[0]+", "+n[1]+"));\n      }\n    ";var r=Math.ceil(e[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec2(r, c);\n    }\n  "}(e,t);case 3:return n=e,r=t,a=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],o=(i=Math.ceil(n[2]/2))*Math.ceil(n[1]/2),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+a[0]+", "+a[1]+"));\n      int index = resTexRC.x * "+a[1]+" + resTexRC.y;\n\n      int b = index / "+o+";\n      index -= b * "+o+";\n\n      int r = 2 * (index / "+i+");\n      int c = imod(index, "+i+") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";default:return function(e,t){for(var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[e.length-1]/2),a=r*Math.ceil(e[e.length-2]/2),i=a,o="",s="b, r, c",l=2;l<e.length-1;l++)o="\n      int b"+l+" = index / "+(i*=e[e.length-l-1])+";\n      index -= b"+l+" * "+i+";\n    "+o,s="b"+l+", "+s;return"\n    ivec"+e.length+" getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n\n      "+o+"\n\n      int b = index / "+a+";\n      index -= b * "+a+";\n\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec"+e.length+"("+s+");\n    }\n  "}(e,t)}var n,r,a,i,o}(t.logicalShape,c),o=function(e){return"\n    void setOutput(vec4 val) {\n      "+e.output+" = val;\n    }\n  "}(u)):(i=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t){return 1===t[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * "+t[1]+".0);\n      }\n    ":1===t[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * "+t[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+t[0]+", "+t[1]+"));\n      return resTexRC.x * "+t[1]+" + resTexRC.y;\n    }\n  "}(0,t);case 2:return function(e,t){return Ri(e,t)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2("+t[0]+", "+t[1]+"));\n      }\n    ":1===e[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+t[0]+", "+t[1]+"));\n        int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":1===e[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+t[0]+", "+t[1]+"));\n        int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n      int r = index / "+e[1]+";\n      int c = index - r * "+e[1]+";\n      return ivec2(r, c);\n    }\n  "}(e,t);case 3:return n=t,r=Nu(["r","c","d"],e),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      "+r+"\n      return ivec3(r, c, d);\n    }\n  ";case 4:return function(e,t){var n=Nu(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n      "+n+"\n      return ivec4(r, c, d, d2);\n    }\n  "}(e,t);case 5:return function(e,t){var n=Nu(["r","c","d","d2","d3"],e);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2("+t[0]+",\n                             "+t[1]+"));\n\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  "}(e,t);case 6:return function(e,t){var n=Nu(["r","c","d","d2","d3","d4"],e);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  "}(e,t);default:throw new Error(e.length+"-D output sampling is not yet supported")}var n,r}(t.logicalShape,c),o=function(e){return"\n    void setOutput(float val) {\n      "+e.output+" = vec4(val, 0, 0, 0);\n    }\n  "}(u)),r&&(d+=Du),[d,h,o,s,i,l,n].join("\n")}function _u(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"float "+n+"() {return "+t+";}";var r=e.shapeInfo.texShape,a=r[0],i=r[1];if(1===a&&1===i)return"\n      float "+n+"() {\n        return sampleTexture("+t+", halfCR);\n      }\n    ";var o=e.shapeInfo.texShape;return"\n    float "+n+"() {\n      vec2 uv = uvFromFlat("+o[0]+", "+o[1]+", "+Fu(t)+");\n      return sampleTexture("+t+", uv);\n    }\n  "}(e);case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"\n      float "+n+"(int index) {\n        "+Ou(e)+"\n      }\n    ";var r=e.shapeInfo.texShape,a=r[0],i=r[1];if(1===i&&1===a)return"\n      float "+n+"(int index) {\n        return sampleTexture("+t+", halfCR);\n      }\n    ";var o=Fu(t);return 1===i?"\n      float "+n+"(int index) {\n        vec2 uv = vec2(0.5, (float(index + "+o+") + 0.5) / "+a+".0);\n        return sampleTexture("+t+", uv);\n      }\n    ":1===a?"\n      float "+n+"(int index) {\n        vec2 uv = vec2((float(index + "+o+") + 0.5) / "+i+".0, 0.5);\n        return sampleTexture("+t+", uv);\n      }\n    ":"\n    float "+n+"(int index) {\n      vec2 uv = uvFromFlat("+a+", "+i+", index + "+o+");\n      return sampleTexture("+t+", uv);\n    }\n  "}(e);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape;if(null!=a&&Ri(t,a)){var i=a[0];return"\n    float "+r+"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2("+a[1]+".0, "+i+".0);\n      return sampleTexture("+n+", uv);\n    }\n  "}var o=Bi(t),s=o.newShape,l=o.keptDims,c=s;if(c.length<t.length)return"\n      "+_u(Pu(e,c))+"\n      float "+r+"(int row, int col) {\n        return "+r+"("+Mu(["row","col"],l)+");\n      }\n    ";if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2("+t[1]+", 1)));\n        "+Ou(e)+"\n      }\n    ";var u=a[0],h=a[1],d=Fu(n);return 1===h?"\n    float "+r+"(int row, int col) {\n      float index = dot(vec3(row, col, "+d+"), vec3("+t[1]+", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / "+u+".0);\n      return sampleTexture("+n+", uv);\n    }\n  ":1===u?"\n    float "+r+"(int row, int col) {\n      float index = dot(vec3(row, col, "+d+"), vec3("+t[1]+", 1, 1));\n      vec2 uv = vec2((index + 0.5) / "+h+".0, 0.5);\n      return sampleTexture("+n+", uv);\n    }\n  ":"\n  float "+r+"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * "+t[1]+" + col + "+d+";\n    vec2 uv = uvFromFlat("+u+", "+h+", index);\n    return sampleTexture("+n+", uv);\n  }\n"}(e);case 3:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[1]*t[2],i=t[2],o=Bi(t),s=o.newShape,l=o.keptDims,c=s;if(c.length<t.length)return"\n        "+_u(Pu(e,c))+"\n        float "+r+"(int row, int col, int depth) {\n          return "+r+"("+Mu(["row","col","depth"],l)+");\n        }\n      ";if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3("+a+", "+i+", 1)));\n        "+Ou(e)+"\n      }\n    ";var u=e.shapeInfo.texShape,h=u[0],d=u[1],f=e.shapeInfo.flatOffset;return d===a&&null==f?"\n        float "+r+"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2("+i+", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2("+d+".0, "+h+".0);\n          return sampleTexture("+n+", uv);\n        }\n      ":d===i&&null==f?"\n    float "+r+"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2("+t[1]+", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+d+".0, "+h+".0);\n      return sampleTexture("+n+", uv);\n    }\n  ":"\n      float "+r+"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * "+a+" + col * "+i+" + depth + "+Fu(n)+";\n        vec2 uv = uvFromFlat("+h+", "+d+", index);\n        return sampleTexture("+n+", uv);\n      }\n  "}(e);case 4:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[3],i=t[2]*a,o=t[1]*i,s=Bi(t),l=s.newShape,c=s.keptDims;if(l.length<t.length)return"\n      "+_u(Pu(e,l))+"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        return "+r+"("+Mu(["row","col","depth","depth2"],c)+");\n      }\n    ";if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4("+o+", "+i+", "+a+", 1)));\n        "+Ou(e)+"\n      }\n    ";var u=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,d=h[0],f=h[1];return f===o&&null==u?"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3("+i+", "+a+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+f+".0, "+d+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":f===a&&null==u?"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3("+t[1]*t[2]+", "+t[2]+", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+f+".0, "+d+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":"\n    float "+r+"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+o+" + col * "+i+" +\n          depth * "+a+" + depth2;\n      vec2 uv = uvFromFlat("+d+", "+f+", index + "+Fu(n)+");\n      return sampleTexture("+n+", uv);\n    }\n  "}(e);case 5:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[4],i=t[3]*a,o=t[2]*i,s=t[1]*o,l=Bi(t),c=l.newShape,u=l.keptDims;if(c.length<t.length)return"\n      "+_u(Pu(e,c))+"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        return "+r+"("+Mu(["row","col","depth","depth2","depth3"],u)+");\n      }\n    ";if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+s+", "+o+", "+i+", "+a+")) +\n          depth3;\n        "+Ou(e)+"\n      }\n    ";var h=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,f=d[0],p=d[1];return p===s&&null==h?"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4("+o+", "+i+", "+a+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+p+".0, "+f+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":p===a&&null==h?"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+t[1]*t[2]*t[3]+",\n               "+t[2]*t[3]+", "+t[3]+", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+p+".0, "+f+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":"\n    float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+s+" + col * "+o+" + depth * "+i+" +\n          depth2 * "+a+" + depth3 + "+Fu(n)+";\n      vec2 uv = uvFromFlat("+f+", "+p+", index);\n      return sampleTexture("+n+", uv);\n    }\n  "}(e);case 6:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=Bi(t),i=a.newShape,o=a.keptDims;if(i.length<t.length)return"\n      "+_u(Pu(e,i))+"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return "+r+"("+Mu(["row","col","depth","depth2","depth3","depth4"],o)+");\n      }\n    ";var s=t[5],l=t[4]*s,c=t[3]*l,u=t[2]*c,h=t[1]*u;if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4("+h+", "+u+", "+c+", "+l+")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2("+s+", 1)));\n        "+Ou(e)+"\n      }\n    ";var d=e.shapeInfo.flatOffset,f=e.shapeInfo.texShape,p=f[0],g=f[1];return g===h&&null==d?"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4("+u+", "+c+", "+l+", "+s+")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+g+".0, "+p+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":g===s&&null==d?"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4("+t[1]*t[2]*t[3]*t[4]+",\n               "+t[2]*t[3]*t[4]+",\n               "+t[3]*t[4]+",\n               "+t[4]+")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+g+".0, "+p+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":"\n    float "+r+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+h+" + col * "+u+" + depth * "+c+" +\n          depth2 * "+l+" + depth3 * "+s+" + depth4 + "+Fu(n)+";\n      vec2 uv = uvFromFlat("+p+", "+g+", index);\n      return sampleTexture("+n+", uv);\n    }\n  "}(e);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function Iu(e){var t;switch(e.shapeInfo.logicalShape.length){case 0:return"\n    vec4 "+("get"+(t=e.name).charAt(0).toUpperCase()+t.slice(1))+"() {\n      return "+ku().texture2D+"("+t+", halfCR);\n    }\n  ";case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=e.shapeInfo.texShape,a=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],i=ku();return"\n    vec4 "+n+"(int index) {\n      vec2 uv = packedUVfrom1D(\n        "+a[0]+", "+a[1]+", index);\n      return "+i.texture2D+"("+t+", uv);\n    }\n  "}(e);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,i=a[0],o=a[1],s=ku();if(null!=a&&Ri(t,a))return"\n      vec4 "+r+"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2("+o+".0, "+i+".0);\n\n        return "+s.texture2D+"("+n+", uv);\n      }\n    ";var l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return"\n    vec4 "+r+"(int row, int col) {\n      vec2 uv = packedUVfrom2D("+Math.ceil(t[1]/2)+", "+l[0]+", "+l[1]+", row, col);\n      return "+s.texture2D+"("+n+", uv);\n    }\n  "}(e);case 3:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,i=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(1===t[0])return"\n        "+Iu(Pu(e,t.slice(1)))+"\n        vec4 "+r+"(int b, int row, int col) {\n          return "+r+"("+Mu(["b","row","col"],[1,2])+");\n        }\n      ";var o=i[0],s=i[1],l=Math.ceil(t[2]/2);return"\n    vec4 "+r+"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        "+o+", "+s+", "+l*Math.ceil(t[1]/2)+", "+l+", b, row, col);\n      return "+ku().texture2D+"("+n+", uv);\n    }\n  "}(e);default:return function(e){for(var t=e.shapeInfo.logicalShape,n=t.length,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],s=o[0],l=o[1],c=Math.ceil(t[n-1]/2),u=c*Math.ceil(t[n-2]/2),h="int b, int row, int col",d="b * "+u+" + (row / 2) * "+c+" + (col / 2)",f=2;f<n-1;f++)h="int b"+f+", "+h,d="b"+f+" * "+(u*=t[n-f-1])+" + "+d;return"\n    vec4 "+a+"("+h+") {\n      int index = "+d+";\n      int texR = index / "+l+";\n      int texC = index - texR * "+l+";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+l+", "+s+");\n      return "+ku().texture2D+"("+r+", uv);\n    }\n  "}(e)}}var Tu="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Au="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Ru="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Du="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function Fu(e){return"offset"+e}function Ou(e){var t=e.name,n=Ai(e.shapeInfo.logicalShape);return n<2?"return "+t+";":"\n    for (int i = 0; i < "+n+"; i++) {\n      if (i == index) {\n        return "+t+"[i];\n      }\n    }\n  "}function Lu(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank "+e+" is not yet supported")}function Pu(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function Mu(e,t){return t.map(function(t){return e[t]}).join(", ")}var ju=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,Ei(e.length>2,function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."});var a=e[e.length-1],i=Math.ceil(a/t);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");var o,s,l=this.outputShape,c=l.length,u=Lu(c),h=wu("coords",c);if(1===i){var d=Lu(s=c+1);o="\n        "+d+" sourceLocR = "+d+"("+h.join()+", 0);\n        ++"+h[c-1]+";\n        "+d+" sourceLocG = "+d+"("+h.join()+", 0);\n        ++"+h[c-2]+";\n        "+d+" sourceLocA = "+d+"("+h.join()+", 0);\n        --"+h[c-1]+";\n        "+d+" sourceLocB = "+d+"("+h.join()+", 0);\n        --"+h[c-2]+";"}else s=c,o="\n        "+u+" sourceLocR = coords;\n        ++"+h[c-1]+";\n        "+u+" sourceLocG = coords;\n        ++"+h[c-2]+";\n        "+u+" sourceLocA = coords;\n        --"+h[c-1]+";\n        "+u+" sourceLocB = coords;\n        --"+h[c-2]+";";var f=["x","y","z","w","u","v"].slice(0,s),p="."+f[s-1],g=f.map(function(e){return"int "+e}),m=wu("sourceLocR",s-1).concat("inIdx.r"),v=wu("sourceLocG",s-1).concat("inIdx.g"),b=wu("sourceLocB",s-1).concat("inIdx.b"),x=wu("sourceLocA",s-1).concat("inIdx.a"),y="max"===n?"greaterThan":"lessThan",w=r?"":"\n          inIdx = round(vec4(getBestIndicesAChannel("+m.join()+"),\n                             getBestIndicesAChannel("+v.join()+"),\n                             getBestIndicesAChannel("+b.join()+"),\n                             getBestIndicesAChannel("+x.join()+")));",k="vec4(\n            getAChannel("+m.join()+"),\n            hasNextCol ? getAChannel("+v.join()+") : 0.,\n            hasNextRow ? getAChannel("+b.join()+") : 0.,\n            hasNextRow && hasNextCol ? getAChannel("+x.join()+") : 0.)",N=r?"":"\n      float getBestIndicesAChannel("+g.join()+") {\n        return getChannel(getBestIndicesA("+f.join()+"),\n                                          vec2("+f.slice(-2).join()+"));\n      }";this.userCode="\n      float getAChannel("+g.join()+") {\n        return getChannel(getA("+f.join()+"),\n                               vec2("+f.slice(-2).join()+"));\n      }\n      "+N+"\n      void main() {\n        "+u+" coords = getOutputCoords();\n        bool hasNextCol = "+h[c-1]+" < "+(l[c-1]-1)+";\n        bool hasNextRow = "+h[c-2]+" < "+(l[c-2]-1)+";\n        "+o+"\n        ivec4 srcIdx = ivec4(sourceLocR"+p+", sourceLocG"+p+",\n          sourceLocB"+p+", sourceLocA"+p+") * "+t+";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = "+k+";\n\n        for (int i = 0; i < "+t+"; i++) {\n          inIdx = srcIdx;\n          "+w+"\n          vec4 candidate = "+k+";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4("+y+"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    "},Bu=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i=e.dilationHeight,o=e.dilationWidth,s=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=s-1-e.padInfo.top,u=l-1-e.padInfo.left,h=1/(t*n);this.userCode="\n      const ivec2 pads = ivec2("+c+", "+u+");\n      const float avgMultiplier = float("+h+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+s+";\n            wR += "+i+") {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+l+";\n            wC+= "+o+") {\n            float dyC = float(dyCCorner + wC) / "+a+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},zu=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,a=e.strideDepth,i=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,l=e.dilationHeight,c=e.dilationWidth,u=e.effectiveFilterDepth,h=e.effectiveFilterHeight,d=e.effectiveFilterWidth,f=u-1-e.padInfo.front,p=h-1-e.padInfo.top,g=d-1-e.padInfo.left,m=1/(t*n*r);this.userCode="\n      const ivec3 pads = ivec3("+f+", "+p+", "+g+");\n      const float avgMultiplier = float("+m+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+u+";\n            wD += "+s+") {\n          float dyD = float(dyDCorner + wD) / "+a+".0;\n\n          if (dyD < 0.0 || dyD >= "+e.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+h+";\n              wR += "+l+") {\n            float dyR = float(dyRCorner + wR) / "+i+".0;\n\n            if (dyR < 0.0 || dyR >= "+e.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+d+";\n                wC += "+c+") {\n              float dyC = float(dyCCorner + wC) / "+o+".0;\n\n              if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Wu=function(e,t,n,r,a,i){this.outputShape=[],this.variableNames=["x","mean","variance"],Bc(e,t),Bc(e,n);var o="0.0";null!=r&&(Bc(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var s="1.0";null!=a&&(Bc(e,a),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = "+o+";\n        float scale = "+s+";\n        float inv = scale * inversesqrt(variance + float("+i+"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    "},Uu=function(e,t,n,r,a,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Bc(e,t),Bc(e,n);var o="vec4(0.0)";null!=r&&(Bc(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var s="vec4(1.0)";null!=a&&(Bc(e,a),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        vec4 offset = "+o+";\n        vec4 scale = "+s+";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4("+i+"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    "},Vu=function(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Bc(t,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        "+e+"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    "},Hu="return a + b;",Gu="return a - b;",qu="return a * b;",Ku="return (a < 0.) ? b * a : a;",Xu=function(e,t,n){this.variableNames=["A","B"],this.outputShape=Bc(t,n),this.userCode="\n      float binaryOperation(float a, float b) {\n        "+e+"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    "},Yu="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",$u=function(e,t,n,r){void 0===r&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Bc(t,n);var a=this.outputShape.length,i="";if(r)if(0===a||1===Ai(this.outputShape))i="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(i="\n          "+Lu(a)+" coords = getOutputCoords();\n        ",1===a)i+="\n            result.y = (coords + 1) >= "+this.outputShape[0]+" ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ";else{var o=wu("coords",a);i+="\n            bool nextRowOutOfBounds =\n              ("+o[a-2]+" + 1) >= "+this.outputShape[a-2]+";\n            bool nextColOutOfBounds =\n              ("+o[a-1]+" + 1) >= "+this.outputShape[a-1]+";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        "+e+"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        "+i+"\n\n        setOutput(result);\n      }\n    "},Ju=function(){function e(e){this.variableNames=["A"],this.outputShape=e,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e,t){var n=this;return function(r,a){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(a,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(a,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}},e}(),Qu=function(){function e(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e,t){var n=this;return function(r,a){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(a,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(a,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}},e}(),Zu=function(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "},eh=function(e){this.outputShape=[],this.outputShape=il(e,1),this.variableNames=e.map(function(e,t){return"T"+t});var t=new Array(e.length-1);t[0]=e[0][1];for(var n=1;n<t.length;n++)t[n]=t[n-1]+e[n][1];var r=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<t.length;n++){var a=t[n-1];r.push("else if (yC < "+t[n]+") setOutput(getT"+n+"(yR, yC-"+a+"));")}var i=t.length,o=t[t.length-1];r.push("else setOutput(getT"+i+"(yR, yC-"+o+"));"),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        "+r.join("\n        ")+"\n      }\n    "},th=function(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=il(e,t);var n=this.outputShape,r=n.length,a=Lu(r),i=wu("coords",r),o=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map(function(e,t){return"T"+t});var s=new Array(e.length-1);s[0]=e[0][t];for(var l=1;l<s.length;l++)s[l]=s[l-1]+e[l][t];var c=o[t],u=o.slice(-2),h=o.join(),d="if ("+c+" < "+s[0]+") {\n        return getChannel(\n            getT0("+h+"), vec2("+u.join()+"));\n        }";for(l=1;l<s.length;l++){var f=s[l-1];d+="\n        if ("+c+" < "+s[l]+"  && "+c+" >= "+s[l-1]+") {\n          return getChannel(\n            getT"+l+"("+nh(o,c,f)+"),\n            vec2("+nh(u,c,f)+"));\n        }"}var p=s.length,g=s[s.length-1];d+="\n        return getChannel(\n          getT"+p+"("+nh(o,c,g)+"),\n          vec2("+nh(u,c,g)+"));",this.userCode="\n      float getValue("+o.map(function(e){return"int "+e})+") {\n        "+d+"\n      }\n\n      void main() {\n        "+a+" coords = getOutputCoords();\n        vec4 result = vec4(getValue("+i+"), 0., 0., 0.);\n\n        "+i[r-1]+" = "+i[r-1]+" + 1;\n        if ("+i[r-1]+" < "+n[r-1]+") {\n          result.g = getValue("+i+");\n        }\n\n        "+i[r-2]+" = "+i[r-2]+" + 1;\n        if ("+i[r-2]+" < "+n[r-2]+") {\n          result.a = getValue("+i+");\n        }\n\n        "+i[r-1]+" = "+i[r-1]+" - 1;\n        if ("+i[r-2]+" < "+n[r-2]+" &&\n            "+i[r-1]+" < "+n[r-1]+") {\n          result.b = getValue("+i+");\n        }\n        setOutput(result);\n      }\n    "};function nh(e,t,n){var r=e.indexOf(t);return e.map(function(e,t){return t===r?e+" - "+n:e}).join()}var rh=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,i="channelsLast"===e.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n            int xR = wR + yR * "+t+" - "+r+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n              int xC = wC + yC * "+n+" - "+a+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              if ("+i+") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},ah=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i="channelsLast"===e.dataFormat,o=t-1-e.padInfo.top,s=n-1-e.padInfo.left,l=i?1:2,c=i?2:3,u=i?3:1;this.userCode="\n      const ivec2 pads = ivec2("+o+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords["+u+"];\n\n        ivec2 dyCorner = ivec2(coords["+l+"], coords["+c+"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+t+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+t+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+a+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            for (int d2 = 0; d2 < "+e.outChannels+"; d2++) {\n\n              if ("+i+") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},ih=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,a=e.padInfo.front,i=e.padInfo.top,o=e.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yF = 0; yF < "+e.outDepth+"; yF++) {\n            int xF = wF + yF * "+t+" - "+a+";\n\n            if (xF < 0 || xF >= "+e.inDepth+") {\n              continue;\n            }\n\n            for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n              int xR = wR + yR * "+n+" - "+i+";\n\n              if (xR < 0 || xR >= "+e.inHeight+") {\n                continue;\n              }\n\n              for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n                int xC = wC + yC * "+r+" - "+o+";\n\n                if (xC < 0 || xC >= "+e.inWidth+") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},oh=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,a=e.strideDepth,i=e.strideHeight,o=e.strideWidth,s=t-1-e.padInfo.front,l=n-1-e.padInfo.top,c=r-1-e.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3("+s+", "+l+", "+c+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+t+"; wF++) {\n          float dyF = float(dyFCorner + wF) / "+a+".0;\n\n          if (dyF < 0.0 || dyF >= "+e.outDepth+".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = "+t+" - 1 - wF;\n\n          for (int wR = 0; wR < "+n+"; wR++) {\n            float dyR = float(dyRCorner + wR) / "+i+".0;\n\n            if (dyR < 0.0 || dyR >= "+e.outHeight+".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = "+n+" - 1 - wR;\n\n            for (int wC = 0; wC < "+r+"; wC++) {\n              float dyC = float(dyCCorner + wC) / "+o+".0;\n\n              if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = "+r+" - 1 - wC;\n\n              for (int d2 = 0; d2 < "+e.outChannels+"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},sh=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * "+i+" + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n            int xR = wR + yR * "+t+" - "+r+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n              int xC = wC + yC * "+n+" - "+a+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},lh=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i=t-1-e.padInfo.top,o=n-1-e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode="\n      const ivec2 pads = ivec2("+i+", "+o+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < "+t+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+t+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+a+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < "+s+"; dm++) {\n              int d2 = d1 * "+s+" + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},ch=function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var a=e.padInfo.top,i=e.padInfo.left,o=e.strideHeight,s=e.strideWidth,l=e.dilationHeight,c=e.dilationWidth,u=e.filterHeight,h=e.filterWidth,d=4*Math.floor(e.inChannels/4),f=e.inChannels%4,p="channelsLast"===e.dataFormat,g=p?1:2,m=p?2:3,v=p?3:1,b="",x="";n&&(b=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"\n          float activation(float x) {\n            "+n+"\n          }\n        ",x="result = activation(result);");var y=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+b+"\n\n      const ivec2 strides = ivec2("+o+", "+s+");\n      const ivec2 pads = ivec2("+a+", "+i+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords["+v+"];\n\n        ivec2 xRCCorner =\n            ivec2(coords["+g+"], coords["+m+"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+u+"; wR++) {\n          int xR = xRCorner + wR * "+l+";\n\n          if (xR < 0 || xR >= "+e.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+h+"; wC++) {\n            int xC = xCCorner + wC * "+c+";\n\n            if (xC < 0 || xC >= "+e.inWidth+") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < "+d+"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if ("+p+") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if ("+(1===f)+") {\n\n              if ("+p+") {\n                dotProd +=\n                    getX(batch, xR, xC, "+d+") *\n                    getW(wR, wC, "+d+", d2);\n              } else {\n                dotProd +=\n                    getX(batch, "+d+", xR, xC) *\n                    getW(wR, wC, "+d+", d2);\n              }\n\n            } else if ("+(2===f)+") {\n              vec2 wValues = vec2(\n                getW(wR, wC, "+d+", d2),\n                getW(wR, wC, "+d+" + 1, d2)\n              );\n\n              if ("+p+") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, "+d+"),\n                  getX(batch, xR, xC, "+d+" + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, "+d+", xR, xC),\n                  getX(batch, "+d+" + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if ("+(3===f)+") {\n              vec3 wValues = vec3(\n                getW(wR, wC, "+d+", d2),\n                getW(wR, wC, "+d+" + 1, d2),\n                getW(wR, wC, "+d+" + 2, d2)\n              );\n\n              if ("+p+") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, "+d+"),\n                  getX(batch, xR, xC, "+d+" + 1),\n                  getX(batch, xR, xC, "+d+" + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, "+d+", xR, xC),\n                  getX(batch, "+d+" + 1, xR, xC),\n                  getX(batch, "+d+" + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        "+y+"\n        "+x+"\n        setOutput(result);\n      }\n    "},uh=function(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,a=e.strideDepth,i=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,l=e.dilationHeight,c=e.dilationWidth,u=e.filterDepth,h=e.filterHeight,d=e.filterWidth,f=4*Math.floor(e.inChannels/4),p=e.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3("+a+", "+i+", "+o+");\n      const ivec3 pads = ivec3("+t+", "+n+", "+r+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+u+"; wF++) {\n          int xF = xFCorner + wF * "+s+";\n\n          if (xF < 0 || xF >= "+e.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+h+"; wR++) {\n            int xR = xRCorner + wR * "+l+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+d+"; wC++) {\n              int xC = xCCorner + wC * "+c+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < "+f+"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if ("+(1===p)+") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, "+f+") *\n                  getW(wF, wR, wC, "+f+", d2);\n              } else if ("+(2===p)+") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, "+f+"),\n                  getX(batch, xF, xR, xC, "+f+" + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, "+f+", d2),\n                  getW(wF, wR, wC, "+f+" + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if ("+(3===p)+") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, "+f+"),\n                  getX(batch, xF, xR, xC, "+f+" + 1),\n                  getX(batch, xF, xR, xC, "+f+" + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, "+f+", d2),\n                  getW(wF, wR, wC, "+f+" + 1, d2),\n                  getW(wF, wR, wC, "+f+" + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},hh=function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var a=e.inHeight,i=e.inWidth,o=e.padInfo.top,s=e.padInfo.left,l=e.strideHeight,c=e.strideWidth,u=e.dilationHeight,h=e.dilationWidth,d=e.filterHeight,f=e.filterWidth,p=e.outChannels/e.inChannels,g="",m="";n&&(g=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"\n          float activation(float x) {\n            "+n+"\n          }\n        ",m="result = activation(result);");var v=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+g+"\n\n      const ivec2 strides = ivec2("+l+", "+c+");\n      const ivec2 pads = ivec2("+o+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / "+p+";\n        int q = d2 - d1 * "+p+";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < "+d+"; wR++) {\n          int xR = xRCorner + wR * "+u+";\n\n          if (xR < 0 || xR >= "+a+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+f+"; wC++) {\n            int xC = xCCorner + wC * "+h+";\n\n            if (xC < 0 || xC >= "+i+") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        "+v+"\n        "+m+"\n        setOutput(result);\n      }\n    "},dh=function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.outShape;for(var a=e.inHeight,i=e.inWidth,o=e.padInfo.top,s=e.padInfo.left,l=e.strideHeight,c=e.strideWidth,u=e.dilationHeight,h=e.dilationWidth,d=e.filterHeight,f=e.filterWidth,p=f,g="int xR; int xC; int xCOffset;",m=0;m<d;m++)for(var v=0;v<f;v++)g+="\n          vec4 xTexelR"+m+"C"+2*v+" = vec4(0.);\n          vec4 wR"+m+"C"+v+" = vec4(0.);\n          vec4 xR"+m+"C"+v+" = vec4(0.);";for(m=0;m<d;m++)for(var b=0;b<p;b++){if(g+="\n          xR = xRCorner + "+m*u+";\n          xC = xCCorner + "+(v=2*b)*h+";\n        ",1===c){if(v<f&&(g+=s%2==1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < "+a+" && xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+m+"C"+v+" = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= "+i+") {\n                    xTexelR"+m+"C"+v+".zw = vec2(0.);\n                  }\n                } else {\n                  xTexelR"+m+"C"+v+" = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < "+a+" && xCOffset >= 0 && xCOffset < "+i+") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= "+i+") {\n                    previous.zw = vec2(0.);\n                  }\n\n                  xR"+m+"C"+v+" = vec4(previous.zw, xTexelR"+m+"C"+v+".xy);\n                } else {\n                  xR"+m+"C"+v+" = vec4(0, 0, xTexelR"+m+"C"+v+".xy);\n                }\n              ":"\n                if(xR >= 0 && xR < "+a+" && xC >= 0 && xC < "+i+") {\n                  xTexelR"+m+"C"+v+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+m+"C"+v+" = vec4(0.);\n                }\n\n                xR"+m+"C"+v+" = xTexelR"+m+"C"+v+";\n              ",v+1<f)){var x=s%2==0?Si(h):h;h%2==0&&s%2==1||h%2!=0&&s%2!=1?(g+="\n                  xCOffset = xC + "+s%2+" + "+x+";\n\n                  if(xR >= 0 && xR < "+a+" &&\n                    xCOffset >= 0 && xCOffset < "+i+") {\n                    xTexelR"+m+"C"+(v+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n                ",h>1&&(g+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < "+a+" &&\n                      xCOffset >= 0 && xCOffset < "+i+") {\n                      xTexelR"+m+"C"+v+" = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR"+m+"C"+v+" = vec4(0.);\n                    }\n                  "),g+="\n                  xR"+m+"C"+(v+1)+" = vec4(\n                    xTexelR"+m+"C"+v+".zw, xTexelR"+m+"C"+(v+2)+".xy);\n                "):g+="\n                  xCOffset = xC + "+x+";\n\n                  if(xR >= 0 && xR < "+a+" &&\n                    xCOffset >= 0 && xCOffset < "+i+") {\n                    xTexelR"+m+"C"+(v+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR"+m+"C"+(v+1)+" = xTexelR"+m+"C"+(v+2)+";\n                "}}else v<f&&(g+="\n              if(xR >= 0 && xR < "+a+") {\n            ",s%2==1?(g+="\n                xCOffset = xC + 1 - "+c+";\n                if(xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+m+"C"+v+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+m+"C"+v+" = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < "+i+") {\n                  xTexelR"+m+"C"+(v+2)+" = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR"+m+"C"+(v+2)+" = vec4(0.);\n                }\n\n                xR"+m+"C"+v+" = vec4(\n                  xTexelR"+m+"C"+v+".zw, xTexelR"+m+"C"+(v+2)+".zw);\n              ",v+1<f&&(g+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + "+c+";\n                  if(xCOffset >= 0 && xCOffset < "+i+") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR"+m+"C"+(v+1)+" = vec4(xTexelR"+m+"C"+(v+2)+".xy, final.xy);\n                ")):(g+="\n                if(xC >= 0 && xC < "+i+") {\n                  xTexelR"+m+"C"+v+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+m+"C"+v+" = vec4(0.);\n                }\n\n                xCOffset = xC + "+c+";\n                if(xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+m+"C"+(v+2)+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+m+"C"+(v+2)+" = vec4(0.);\n                }\n\n                xR"+m+"C"+v+" = vec4(\n                  xTexelR"+m+"C"+v+".xy, xTexelR"+m+"C"+(v+2)+".xy);\n              ",v+1<f&&(g+="\n                  xR"+m+"C"+(v+1)+" = vec4(\n                    xTexelR"+m+"C"+v+".zw, xTexelR"+m+"C"+(v+2)+".zw);\n                ")),g+="}");v<f&&(g+="\n            vec4 wTexelR"+m+"C"+v+" = getW("+m+", "+v+", d1, q);\n            wR"+m+"C"+v+" = vec4(wTexelR"+m+"C"+v+".xz, wTexelR"+m+"C"+v+".xz);\n          ",v+1<f&&(g+="\n              vec4 wTexelR"+m+"C"+(v+1)+" = getW("+m+", "+(v+1)+", d1, q);\n              wR"+m+"C"+(v+1)+" =\n                vec4(wTexelR"+m+"C"+(v+1)+".xz, wTexelR"+m+"C"+(v+1)+".xz);"))}for(m=0;m<d;m++)for(v=0;v<f;v++)g+="dotProd += xR"+m+"C"+v+" * wR"+m+"C"+v+";";var y="",w="";n&&(y=r?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"vec4 activation(vec4 x) {\n          "+n+"\n        }",w="result = activation(result);");var k=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+y+"\n\n      const ivec2 strides = ivec2("+l+", "+c+");\n      const ivec2 pads = ivec2("+o+", "+s+");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        "+g+"\n\n        vec4 result = dotProd;\n        "+k+"\n        "+w+"\n        setOutput(result);\n      }\n    "},fh=function(e,t,n,r,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=e[0],o=e[1],s=e[2],l=e[3],c=t[0],u=n[0],h=n[1];this.outputShape=[c,u,h,l];var d="bilinear"===r?1:0,f=[o-1+".0",s-1+".0"],p=f[0],g=f[1],m=u>1?[""+(o-1)/(u-1),"(y2-y1) * height_ratio","y1*"+p+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+p],v=m[0],b=m[1],x=m[2],y=h>1?[""+(s-1)/(h-1),"(x2-x1) * width_ratio","x1*"+g+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+g],w=y[0],k=y[1],N=y[2];this.userCode="\n      const float height_ratio = float("+v+");\n      const float width_ratio = float("+w+");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= "+i+") {\n          return;\n        }\n\n        float height_scale = "+b+";\n        float width_scale = "+k+";\n\n        float in_y = "+x+";\n        if( in_y < 0.0 || in_y > "+p+" ) {\n          setOutput(float("+a+"));\n          return;\n        }\n        float in_x = "+N+";\n        if( in_x < 0.0 || in_x > "+g+" ) {\n          setOutput(float("+a+"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if("+d+" == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    "},ph=function(e,t,n){this.variableNames=["x"],this.outputShape=e;var r=e.length,a=e[e.length-1],i=n?"<":">";this.userCode="\n      int getIndex(int i) {\n        "+(n?"return "+a+" -i - 1;":"return i;")+"\n      }\n\n      void main() {\n        "+Lu(r)+" coords = getOutputCoords();\n        int end = "+gh(r,"coords")+";\n        float val = 0.0;\n        for (int i = "+a+" - 1; i >= 0; i -= 1) {\n          int idx = getIndex(i);\n          if (idx "+i+" end) {\n            continue;\n          }\n          if (idx == end && "+t+") {\n            continue;\n          }\n          "+gh(r,"coords")+" = idx;\n          val += getX("+function(e,t){if(1===e)return""+t;if(2===e)return t+".x, "+t+".y";if(3===e)return t+".x, "+t+".y, "+t+".z";if(4===e)return t+".x, "+t+".y, "+t+".z, "+t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}(r,"coords")+");\n        }\n        setOutput(val);\n      }\n    "};function gh(e,t){if(1===e)return""+t;if(2===e)return t+".y";if(3===e)return t+".z";if(4===e)return t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}var mh=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=zo.DENSE;var t=Xo(e),n=ku();this.outputShape=e,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+Nu(["r","c","d"],e)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+t[0]+", "+t[1]+"));\n        int index = 4 * (resTexRC.x * "+t[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        "+n.output+" = result;\n      }\n    "},vh=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=zo.DENSE;var t=Xo(e),n=ku();this.outputShape=e,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+Nu(["r","c","d"],e)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+t[0]+", "+t[1]+"));\n        int index = 4 * (resTexRC.x * "+t[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        "+n.output+" = result;\n      }\n    "},bh=function(){function e(e,t,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = "+this.getHeightCoordString()+";\n      int w = "+this.getWidthCoordString()+";\n      int d = "+this.getDepthCoordString()+";\n\n      int in_h = h / "+t+";\n      int offset_h = imod(h, "+t+");\n      int in_w = w / "+t+";\n      int offset_w = imod(w, "+t+");\n      int offset_d = (offset_h * "+t+" + offset_w) *\n        "+this.getOutputDepthSize()+";\n      int in_d = d + offset_d;\n\n      float result = "+this.getInputSamplingString()+";\n      setOutput(result);\n    }\n  "}return e.prototype.getHeightCoordString=function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"},e.prototype.getWidthCoordString=function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"},e.prototype.getDepthCoordString=function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"},e.prototype.getOutputDepthSize=function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]},e.prototype.getInputSamplingString=function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},e}(),xh=function(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "},yh=function(e){this.variableNames=["A"],this.outTexUsage=Wo.DOWNLOAD;var t=ku();this.outputShape=e,this.userCode="\n      "+Cu+"\n\n      void main() {\n        float x = getAAtOutCoords();\n        "+t.output+" = encode_float(x);\n      }\n    "},wh=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Wo.DOWNLOAD;var t=ku();this.outputShape=e,this.userCode="\n      "+Cu+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        "+t.output+" = encode_float(x);\n      }\n    "},kh=function(e,t,n){void 0===n&&(n=!1),this.variableNames=["A"];var r=ku(),a=t[0],i=t[1];this.outputShape=e;var o="result";n&&(o="floor(result * 255. + 0.5)"),this.userCode="\n      "+Su(e)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n        \n        int r = flatIndex / "+i+";\n        int c = imod(flatIndex, "+i+");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2("+i+".0, "+a+".0);\n        vec4 values = "+r.texture2D+"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        "+r.output+" = vec4("+o+", 0., 0., 0.);\n      }\n    "},Nh=function(e,t,n){void 0===n&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=ku(),a=t[0],i=t[1];this.outputShape=e;var o="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var l=0;l<=1;l++)for(var c=0;c<=1;c++){var u=2*l+c;o+="\n          localCoords = coords;\n          if(localCoords[2] + "+c+" < "+e[2]+") {\n            localCoords[2] += "+c+";\n            if(localCoords[1] + "+l+" < "+e[1]+") {\n              localCoords[1] += "+l+";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / "+i+";\n              c = imod(flatIndex, "+i+");\n              uv = (vec2(c, r) + halfCR) / vec2("+i+".0, "+a+".0);\n              values = "+r.texture2D+"(A, uv);\n\n              if(offset == 0) {\n                result["+u+"] = values[0];\n              } else if(offset == 1) {\n                result["+u+"] = values[1];\n              } else if(offset == 2) {\n                result["+u+"] = values[2];\n              } else {\n                result["+u+"] = values[3];\n              }\n            }\n          }\n        "}this.userCode="\n      "+Su(e)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        "+o+"\n\n        "+r.output+" = "+s+";\n      }\n    "},Sh=function(e,t,n){this.variableNames=["real","imag"];var r=t[1];this.outputShape=t;var a=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,i=n?r+".0":"1.0";this.userCode="\n      const float exponentMultiplier = "+a+";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        "+e+"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float("+r+");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < "+r+"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / "+i+";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    "},Ch=function(){function e(e,t){this.outputShape=[],this.variableNames=["x"],this.outputShape=e,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;return function(n,r){null==t.valueLoc&&(t.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(t.valueLoc,e)}},e}(),Eh=function(e,t,n){this.variableNames=["A","indices"];var r=e.slice();r[n]=t,this.outputShape=r,this.rank=r.length;var a=Lu(this.rank),i=function(e,t){var n=e.length;if(n>4)throw Error("Gather for rank "+n+" is not yet supported");if(1===n)return"int(getIndices(resRC))";for(var r=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],i=0;i<e.length;i++)i===t?a.push("int(getIndices("+r[i]+"))"):a.push(""+r[i]);return a.join()}(e,n);this.userCode="\n      void main() {\n        "+a+" resRC = getOutputCoords();\n        setOutput(getA("+i+"));\n      }\n    "},_h=function(e,t,n){this.sliceDim=e,this.strides=t,this.variableNames=["x","indices"],this.outputShape=n;var r=Lu(t.length),a=Lu(n.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode="\n        "+r+" strides = "+r+"("+this.strides+");\n         void main() {\n          "+a+" coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < "+this.sliceDim+"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * "+i+";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      "};function Ih(e,t){var n=ku();return ts(e,t,n.version+"\n    precision highp float;\n    "+n.attribute+" vec3 clipSpacePos;\n    "+n.attribute+" vec2 uv;\n    "+n.varyingVs+" vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }")}function Th(e,t){return cs(e,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function Ah(e,t){return us(e,t,new Uint16Array([0,1,2,2,1,3]))}function Rh(e,t,n,r,a,i,o){ds(n,r);var s=hs(e,t),l=e.TEXTURE_2D;return Jo(e,t,function(){return e.bindTexture(l,s)}),Jo(e,t,function(){return e.texParameteri(l,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)}),Jo(e,t,function(){return e.texParameteri(l,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}),Jo(e,t,function(){return e.texParameteri(l,e.TEXTURE_MIN_FILTER,e.NEAREST)}),Jo(e,t,function(){return e.texParameteri(l,e.TEXTURE_MAG_FILTER,e.NEAREST)}),Jo(e,t,function(){return e.texImage2D(l,0,a,n,r,0,i,o,null)}),Jo(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)}),s}function Dh(e,t,n,r,a){var i=Ko(n,r);return Rh(e,t,i[0],i[1],a.internalFormatFloat,a.textureFormatFloat,e.FLOAT)}function Fh(e,t,n,r,a){var i=Ko(n,r);return Rh(e,t,i[0],i[1],a.internalFormatHalfFloat,a.textureFormatFloat,a.textureTypeHalfFloat)}function Oh(e,t,n,r,a){var i=Ko(n,r);return Rh(e,t,i[0],i[1],e.RGBA,e.RGBA,e.UNSIGNED_BYTE)}function Lh(e,t,n,r,a){var i=Yo(n,r);return Rh(e,t,i[0],i[1],a.internalFormatPackedFloat,e.RGBA,e.FLOAT)}function Ph(e,t,n,r,a){var i=Yo(n,r);return Rh(e,t,i[0],i[1],a.internalFormatPackedHalfFloat,e.RGBA,a.textureTypeHalfFloat)}function Mh(e,t,n,r){return Jo(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),ps(e,t,n,"clipSpacePos",r,3,20,0)&&ps(e,t,n,"uv",r,2,20,12)}function jh(e,t,n,r,a,i,o){var s,l,c;Jo(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),i instanceof Uint8Array?(s=new Uint8Array(r*a*4),l=e.UNSIGNED_BYTE,c=e.RGBA):(s=new Float32Array(r*a*4),l=e.FLOAT,c=o.internalFormatPackedFloat),s.set(i),Jo(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,c,r,a,0,e.RGBA,l,s)}),Jo(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function Bh(e,t,n,r){Jo(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),r.data instanceof Uint8Array?Jo(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r.width,r.height,0,e.RGBA,e.UNSIGNED_BYTE,r.data)}):Jo(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r)}),Jo(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function zh(e,t,n,r,a){var i=e.createBuffer();Jo(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,i)});var o=16*n*r;return Jo(e,t,function(){return e.bufferData(e.PIXEL_PACK_BUFFER,o,e.STREAM_READ)}),Jo(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,0)}),Jo(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}),i}function Wh(e,t,n){var r=e,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}function Uh(e,t,n,r,a){var i=Ko(n,r),o=i[0],s=i[1],l=new Uint8Array(n*r*4);return Jo(e,t,function(){return e.readPixels(0,0,o,s,a.downloadTextureFormat,e.UNSIGNED_BYTE,l)}),new Float32Array(l.buffer)}function Vh(e,t,n,r,a,i,o,s){var l=e,c=new Float32Array(function(e,t){var n=Yo(e,t);return n[0]*n[1]*4}(i,o));return l.bindBuffer(l.PIXEL_PACK_BUFFER,t),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function Hh(e,t,n,r){var a=new Float32Array(n*r*4);return Jo(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,a)}),a}var Gh=Object.freeze({createVertexShader:Ih,createVertexBuffer:Th,createIndexBuffer:Ah,createFloat32MatrixTexture:Dh,createFloat16MatrixTexture:Fh,createUnsignedBytesMatrixTexture:Oh,createPackedMatrixTexture:Lh,createFloat16PackedMatrixTexture:Ph,bindVertexProgramAttributeStreams:Mh,uploadDenseMatrixToTexture:jh,uploadPixelDataToTexture:Bh,createBufferFromOutputTexture:zh,downloadFloat32MatrixFromBuffer:Wh,downloadByteEncodedFloatMatrixFromOutputTexture:Uh,downloadPackedMatrixFromBuffer:Vh,downloadMatrixFromPackedOutputTexture:Hh}),qh=function(){function e(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var t=fi().getNumber("WEBGL_VERSION");null!=e?(this.gl=e,Go(t,e)):this.gl=qo(t);var n="WEBGL_color_buffer_float";if(1===fi().getNumber("WEBGL_VERSION")){if(this.textureFloatExtension=es(this.gl,this.debug,"OES_texture_float"),Os(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=es(this.gl,this.debug,"OES_texture_half_float");else if(fi().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),Os(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=es(this.gl,this.debug,"EXT_color_buffer_half_float");else if(fi().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",Os(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!Os(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=Th(this.gl,this.debug),this.indexBuffer=Ah(this.gl,this.debug),this.framebuffer=fs(this.gl,this.debug),this.textureConfig=$o(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(e.prototype,"debug",{get:function(){return fi().getBool("DEBUG")},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var e=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;Jo(t,this.debug,function(){return t.finish()}),Jo(t,this.debug,function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)}),Jo(t,this.debug,function(){return t.deleteFramebuffer(e.framebuffer)}),Jo(t,this.debug,function(){return t.bindBuffer(t.ARRAY_BUFFER,null)}),Jo(t,this.debug,function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}),Jo(t,this.debug,function(){return t.deleteBuffer(e.indexBuffer)}),this.disposed=!0}},e.prototype.createFloat32MatrixTexture=function(e,t){return this.throwIfDisposed(),Dh(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.createFloat16MatrixTexture=function(e,t){return this.throwIfDisposed(),Fh(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.createUnsignedBytesMatrixTexture=function(e,t){return this.throwIfDisposed(),Oh(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.uploadPixelDataToTexture=function(e,t){this.throwIfDisposed(),Bh(this.gl,this.debug,e,t)},e.prototype.uploadDenseMatrixToTexture=function(e,t,n,r){this.throwIfDisposed(),jh(this.gl,this.debug,e,t,n,r,this.textureConfig)},e.prototype.createFloat16PackedMatrixTexture=function(e,t){return this.throwIfDisposed(),Ph(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.createPackedMatrixTexture=function(e,t){return this.throwIfDisposed(),Lh(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.deleteMatrixTexture=function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(ys(this.gl,this.debug,this.framebuffer),this.outputTexture=null),Jo(this.gl,this.debug,function(){return t.gl.deleteTexture(e)})},e.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(e,t,n){var r=this;return this.downloadMatrixDriver(e,function(){return Uh(r.gl,r.debug,t,n,r.textureConfig)})},e.prototype.downloadPackedMatrixFromBuffer=function(e,t,n,r,a,i){return Vh(this.gl,e,0,0,0,a,i,this.textureConfig)},e.prototype.downloadFloat32MatrixFromBuffer=function(e,t){return Wh(this.gl,e,t)},e.prototype.createBufferFromTexture=function(e,t,n){this.bindTextureToFrameBuffer(e);var r=zh(this.gl,this.debug,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r},e.prototype.createAndWaitForFence=function(){var e=this.createFence(this.gl);return this.pollFence(e)},e.prototype.createFence=function(e){var t,n,r=this;if(fi().getBool("WEBGL_FENCE_API_ENABLED")){var a=e,i=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=function(){var e=a.clientWaitSync(i,0,0);return e===a.ALREADY_SIGNALED||e===a.CONDITION_SATISFIED},t=i}else fi().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(t,fi().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:t,isFencePassed:n}},e.prototype.downloadMatrixFromPackedTexture=function(e,t,n){var r=this;return this.downloadMatrixDriver(e,function(){return Hh(r.gl,r.debug,t,n)})},e.prototype.createProgram=function(e){this.throwIfDisposed();var t=this.gl,n=ns(t,this.debug,e),r=Ih(t,this.debug),a=os(t,this.debug);return Jo(t,this.debug,function(){return t.attachShader(a,r)}),Jo(t,this.debug,function(){return t.attachShader(a,n)}),ss(t,this.debug,a),this.debug&&ls(t,this.debug,a),this.vertexAttrsAreBound||(this.setProgram(a),this.vertexAttrsAreBound=Mh(t,this.debug,this.program,this.vertexBuffer)),a},e.prototype.deleteProgram=function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&Jo(this.gl,this.debug,function(){return t.gl.deleteProgram(e)})},e.prototype.setProgram=function(e){var t=this;this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&ls(this.gl,this.debug,this.program),Jo(this.gl,this.debug,function(){return t.gl.useProgram(e)})},e.prototype.getUniformLocation=function(e,t,n){return void 0===n&&(n=!0),this.throwIfDisposed(),n?ms(this.gl,this.debug,e,t):vs(this.gl,e,t)},e.prototype.getAttributeLocation=function(e,t){var n=this;return this.throwIfDisposed(),Jo(this.gl,this.debug,function(){return n.gl.getAttribLocation(e,t)})},e.prototype.getUniformLocationNoThrow=function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)},e.prototype.setInputMatrixTexture=function(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),bs(this.gl,this.debug,this.program,e,t,n)},e.prototype.setOutputMatrixTexture=function(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)},e.prototype.setOutputPackedMatrixTexture=function(e,t,n){this.throwIfDisposed();var r=Yo(t,n),a=r[0],i=r[1];this.setOutputMatrixTextureDriver(e,a,i)},e.prototype.setOutputMatrixWriteRegion=function(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)},e.prototype.setOutputPackedMatrixWriteRegion=function(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},e.prototype.debugValidate=function(){null!=this.program&&ls(this.gl,this.debug,this.program),ws(this.gl)},e.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;this.debug&&this.debugValidate(),Jo(e,this.debug,function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)})},e.prototype.blockUntilAllProgramsCompleted=function(){var e=this;this.throwIfDisposed(),Jo(this.gl,this.debug,function(){return e.gl.finish()})},e.prototype.getQueryTimerExtension=function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=es(this.gl,this.debug,2===fi().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},e.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},e.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},e.prototype.beginQuery=function(){if(2===fi().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),a=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,a),a},e.prototype.endQuery=function(){if(2!==fi().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT)}},e.prototype.waitForQueryAndGetTime=function(e){return ui(this,void 0,void 0,function(){var t=this;return hi(this,function(n){switch(n.label){case 0:return[4,Pi(function(){return t.disposed||t.isQueryAvailable(e,fi().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return n.sent(),[2,this.getQueryTime(e,fi().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},e.prototype.getQueryTime=function(e,t){if(0===t)return null;if(2===t){var n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6},e.prototype.isQueryAvailable=function(e,t){if(0===t)return!0;if(2===t){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}return a=(r=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT),null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint},e.prototype.pollFence=function(e){var t=this;return new Promise(function(n){t.addItemToPoll(function(){return e.isFencePassed()},function(){return n()})})},e.prototype.pollItems=function(){for(var e=function(e){for(var t=0;t<e.length&&e[t]();++t);return t-1}(this.itemsToPoll.map(function(e){return e.isDoneFn})),t=0;t<=e;++t)(0,this.itemsToPoll[t].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(e+1)},e.prototype.addItemToPoll=function(e,t){var n=this;this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1||Pi(function(){return n.pollItems(),0===n.itemsToPoll.length})},e.prototype.bindTextureToFrameBuffer=function(e){this.throwIfDisposed(),xs(this.gl,this.debug,e,this.framebuffer),this.debug&&ws(this.gl)},e.prototype.unbindTextureToFrameBuffer=function(){null!=this.outputTexture?(xs(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&ws(this.gl)):ys(this.gl,this.debug,this.framebuffer)},e.prototype.downloadMatrixDriver=function(e,t){this.bindTextureToFrameBuffer(e);var n=t();return this.unbindTextureToFrameBuffer(),n},e.prototype.setOutputMatrixTextureDriver=function(e,t,n){this.throwIfDisposed();var r=this.gl;xs(r,this.debug,e,this.framebuffer),this.debug&&ws(r),this.outputTexture=e,Jo(r,this.debug,function(){return r.viewport(0,0,t,n)}),Jo(r,this.debug,function(){return r.scissor(0,0,t,n)})},e.prototype.setOutputMatrixWriteRegionDriver=function(e,t,n,r){var a=this;this.throwIfDisposed(),Jo(this.gl,this.debug,function(){return a.gl.scissor(e,t,n,r)})},e.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},e.prototype.throwIfNoProgram=function(){if(null==this.program)throw new Error("No GPU program is currently set.")},e}();function Kh(e,t){if(e.length!==t.length)throw Error("Binary was compiled with "+e.length+" inputs, but was executed with "+t.length+" inputs");e.forEach(function(e,n){var r=e.logicalShape,a=t[n],i=a.shape;if(!Ri(r,i))throw Error("Binary was compiled with different shapes than the current args. Shapes "+r+" and "+i+" must match");if(!e.isUniform||!a.isUniform){var o=e.texShape,s=a.isUniform?null:a.texData.texShape;if(!Ri(o,s))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+o+" and "+s+" must match")}})}var Xh=function(e,t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var r=n.filterWidth,a=n.inChannels,i=n.strideWidth,o=n.strideHeight,s=n.padInfo,l=n.outWidth,c=n.dilationWidth,u=n.dilationHeight,h=n.dataFormat,d=s.left,f=s.top,p=a*r,g=ku(),m="channelsLast"===h,v=m?0:1,b=m?1:2,x="",y=0;y<=1;y++)for(var w=0;w<=1;w++)x+="\n          blockIndex = rc.y + "+w+";\n          pos = rc.x + "+y+";\n\n          if(blockIndex < "+e[1]+" && pos < "+e[0]+") {\n            offsetY = int(blockIndex / ("+l+")) * "+o+" - "+f+";\n            d0 = offsetY + "+u+" * (pos / "+p+");\n\n            if(d0 < "+t[v]+" && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), "+l+".) * "+i+". - "+d+".);\n              d1 = offsetX + "+c+" * (int(mod(float(pos), "+p+".) / "+a+".));\n\n              if(d1 < "+t[b]+" && d1 >= 0) {\n\n                ch = int(mod(float(pos), "+a+".));\n\n                if ("+m+") {\n                  innerDims = vec2(d1, ch);\n                  result["+(2*y+w)+"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result["+(2*y+w)+"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ";this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        "+x+"\n\n        "+g.output+" = result;\n      }\n    "},Yh=function(e,t,n,r,a){this.variableNames=["x"],this.outputShape=[];var i,o=t,s=e[3]-1;this.outputShape=e;var l="float("+n+") + float("+r+") * sum";i=.5===a?"inversesqrt("+l+")":1===a?"1.0/("+l+")":"exp(log("+l+") * float(-"+a+"));",this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -"+o+"; j <= "+o+"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  "+s+") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * "+i+";\n        setOutput(val);\n      }\n    "},$h=function(e,t,n,r,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=a,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < "+this.depth+"; ++d) {\n          int depthBegin = int(max(0.0, float(d - "+t+")));\n          int depthEnd = int(min(float("+this.depth+"),\n              float(d + "+t+" + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = "+this.depth+";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float("+r+") * norm + float("+n+");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float("+r+")\n                * float("+a+")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * "+a+");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    "},Jh=function(e,t,n,r,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var i,o=t,s=e[3]-1;this.outputShape=e;var l="float("+n+") + float("+r+") * sum";i=.5===a?"inversesqrt("+l+")":1===a?"1.0/("+l+")":"exp(log("+l+") * float(-"+a+"));",this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < "+this.outputShape[3]+";\n        bool hasNextRow = c < "+this.outputShape[2]+";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - "+o+";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - "+o+"; j <= "+o+"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2("+s+"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * "+i+";\n        setOutput(result);\n      }\n    "},Qh=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,a=e.effectiveFilterHeight,i=e.effectiveFilterWidth,o=a-1-e.padInfo.top,s=i-1-e.padInfo.left,l=a*i-1;this.userCode="\n      const ivec2 pads = ivec2("+o+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+a+";\n          wR += "+r+") {\n          float dyR = float(dyRCorner + wR) / "+t+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+i+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+n+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = "+l+" - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * "+i+" + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Zh=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,a=e.dilationDepth,i=e.dilationHeight,o=e.dilationWidth,s=e.effectiveFilterDepth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,u=s-1-e.padInfo.front,h=l-1-e.padInfo.top,d=c-1-e.padInfo.left,f=s*l*c-1;this.userCode="\n      const ivec3 pads = ivec3("+u+", "+h+", "+d+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+s+";\n           wD += "+a+") {\n          float dyD = float(dyDCorner + wD) / "+t+".0;\n\n          if (dyD < 0.0 || dyD >= "+e.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+l+";\n              wR += "+i+") {\n            float dyR = float(dyRCorner + wR) / "+n+".0;\n\n            if (dyR < 0.0 || dyR >= "+e.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+c+";\n                wC += "+o+") {\n              float dyC = float(dyCCorner + wC) / "+r+".0;\n\n              if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = "+f+" -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * "+l+" * "+c+" +\n                  wR * "+c+" + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},ed=function(e,t,n,r,a,i,o){void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===a&&(a=!1),void 0===i&&(i=null),void 0===o&&(o=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var s=n?e[1]:e[2],l=Math.ceil(s/2),c=n?"i * 2, rc.y":"rc.y, i * 2",u=r?"rc.z, i * 2":"i * 2, rc.z",h=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],d=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],f="",p="";i&&(f=o?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+i+"\n        }":"vec4 activation(vec4 x) {\n          "+i+"\n        }",p="result = activation(result);");var g=a?"result += getBiasAtOutCoords();":"";a&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+f+"\n\n      const float sharedDimension = "+l+".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < "+l+"; i++) {\n          vec4 a = getMatrixA(rc.x, "+c+");\n          vec4 b = getMatrixB(rc.x, "+u+");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += ("+h[0]+" * "+d[0]+");\n          result += ("+h[1]+" * "+d[1]+");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        "+g+"\n\n        "+p+"\n\n        setOutput(result);\n      }\n    "},td=function(){function e(e,t,n){this.variableNames=["probs"],this.outputShape=[e,n],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < "+(t-1)+"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float("+(t-1)+"));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;return function(n,r){null==t.seedLoc&&(t.seedLoc=n.getUniformLocation(r,"seed")),n.gl.uniform1f(t.seedLoc,e)}},e}(),nd=function(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float("+r+"), float("+n+"),\n                      float(index == coords.y)));\n      }\n    "},rd=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e;var t=e.length;if(0===t)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var n=wu("rc",t),r=Lu(t),a=function(e,t,n){if(1===e)return"rc > "+t[0];for(var r="",a=e-2;a<e;a++)r+=n[a]+" >= "+t[a],a<e-1&&(r+="||");return r}(t,e,n),i=function(e,t,n,r){if(1===e)return"";var a=r.slice(-2);return"\n    int r = "+a[0]+";\n    int c = "+a[1]+";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= "+t+";\n    bool rEdge = rp1 >= "+n+";\n  "}(t,e[e.length-1],e[e.length-2],n),o=function(e,t){var n=e.length,r=function(e,t){for(var n=[],r=0;r<=1;r++)for(var a=0;a<=1;a++){for(var i=(0===r?"r":"rp1")+", "+(0===a?"c":"cp1"),o=2;o<e;o++)i=t[t.length-1-o]+","+i;n.push(i)}return n}(n,t);return 1===n?"getA(rc),\n            rc + 1 >= "+e[0]+" ? 0. : getA(rc + 1),\n            0, 0":"getA("+r[0]+"),\n          cEdge ? 0. : getA("+r[1]+"),\n          rEdge ? 0. : getA("+r[2]+"),\n          rEdge || cEdge ? 0. : getA("+r[3]+")"}(e,n);this.userCode="\n        void main() {\n          "+r+" rc = getOutputCoords();\n\n          if("+a+") {\n            setOutput(vec4(0));\n          } else {\n            "+i+"\n\n            setOutput(vec4("+o+"));\n          }\n        }\n      "}},ad=function(e,t,n){this.variableNames=["x"],this.outputShape=t.map(function(t,n){return t[0]+e[n]+t[1]});var r=e.length,a=Lu(r),i=t.map(function(e){return e[0]}).join(","),o=t.map(function(t,n){return t[0]+e[n]}).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?"\n      "+a+" start = "+a+"("+i+");\n      "+a+" end = "+a+"("+o+");\n\n      void main() {\n        "+a+" outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float("+n+"));\n        } else {\n          "+a+" coords = outC - start;\n          setOutput(getX("+s+"));\n        }\n      }\n    ":"\n        int start = "+i+";\n        int end = "+o+";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float("+n+"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      "},id=function(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(function(t,n){return t[0]+e[n]+t[1]});for(var r=e.length,a=Lu(r),i=t.map(function(e){return e[0]}).join(","),o=t.map(function(t,n){return t[0]+e[n]}).join(","),s=wu("rc",r),l=wu("source",r),c=s[r-1]+" < "+this.outputShape[r-1],u=1===r?"source":"vec2("+l.slice(-2).join()+")",h=[a+" rc = outputLoc;",s[r-1]+" += 1;\n       if("+c+") {\n      ",1===r?"":"}\n       rc = outputLoc;\n       "+s[r-2]+" += 1;\n       if("+s[r-2]+" < "+this.outputShape[r-2]+") {",1===r?"":"  "+s[r-1]+" += 1;\n         if("+c+") {"],d=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",f="",p=0,g=1===r?2:4;p<g;p++)f+="\n        "+h[p]+"\n        if ("+d+") {\n          result["+p+"] = float("+n+");\n        } else {\n          "+a+" source = rc - start;\n          result["+p+"] = getChannel(getX("+l.join()+"), "+u+");\n        }\n      ";f+=1===r?"} ":"}}",this.userCode="\n      const "+a+" start = "+a+"("+i+");\n      const "+a+" end = "+a+"("+o+");\n\n      void main() {\n        "+a+" outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        "+f+"\n        setOutput(result);\n      }\n    "},od=function(e,t,n){if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,a=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,s=e.dilationWidth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,u=e.padInfo.top,h=e.padInfo.left;this.outputShape=e.outShape;var d="avg"===t,f="0.0";if(d||(f="-1.0 / 1e-20"),n)this.userCode="\n        const ivec2 strides = ivec2("+a+", "+i+");\n        const ivec2 pads = ivec2("+u+", "+h+");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < "+l+";\n              wR += "+o+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+c+";\n                wC += "+s+") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = wR * "+c+" + wC;\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var p=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(p="avgValue / count");var g=4*Math.floor(r/4),m=r%4,v="\n      if ("+d+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec2 strides = ivec2("+a+", "+i+");\n      const ivec2 pads = ivec2("+u+", "+h+");\n      const float initializationValue = "+f+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= "+e.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+f+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < "+l+";\n            wR += "+o+") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+e.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+g+"; wC += 4) {\n            int xC = xCCorner + wC * "+s+";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              getValue(batch, xR, xC + 2 * "+s+", d),\n              getValue(batch, xR, xC + 3 * "+s+", d)\n            );\n\n            "+v+"\n          }\n\n          int xC = xCCorner + "+g+";\n          if ("+(1===m)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            "+v+"\n          } else if ("+(2===m)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              initializationValue,\n              initializationValue\n            );\n\n            "+v+"\n          } else if ("+(3===m)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              getValue(batch, xR, xC + 2 * "+s+", d),\n              initializationValue\n            );\n\n            "+v+"\n          }\n        }\n        setOutput("+p+");\n      }\n    "}},sd=function(e,t,n){if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,a=e.strideDepth,i=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,l=e.dilationHeight,c=e.dilationWidth,u=e.effectiveFilterDepth,h=e.effectiveFilterHeight,d=e.effectiveFilterWidth,f=e.padInfo.front,p=e.padInfo.top,g=e.padInfo.left;this.outputShape=e.outShape;var m="avg"===t,v="0.0";if(m||(v="-1.0 / 1e-20"),n)this.userCode="\n        const ivec3 strides =\n            ivec3("+a+", "+i+", "+o+");\n        const ivec3 pads = ivec3("+f+", "+p+", "+g+");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < "+u+";\n              wD += "+s+") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= "+e.inDepth+") {\n              continue;\n            }\n\n            for (int wR = 0; wR < "+h+";\n                wR += "+l+") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= "+e.inHeight+") {\n                continue;\n              }\n\n              for (int wC = 0; wC < "+d+";\n                  wC += "+c+") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= "+e.inWidth+") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value >= currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition =\n                      wD * "+h+" * "+d+" +\n                      wR * "+d+" + wC;;\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var b=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(b="avgValue / count");var x=4*Math.floor(r/4),y=r%4,w="\n      if ("+m+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec3 strides =\n        ivec3("+a+", "+i+", "+o+");\n      const ivec3 pads = ivec3("+f+", "+p+", "+g+");\n      const float initializationValue = "+v+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= "+e.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+v+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < "+u+";\n            wD += "+s+") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= "+e.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+h+";\n            wR += "+l+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+x+"; wC += 4) {\n              int xC = xCCorner + wC * "+c+";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+c+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+c+", ch),\n                getValue(batch, xD, xR, xC + 3 * "+c+", ch)\n              );\n\n              "+w+"\n            }\n\n            int xC = xCCorner + "+x+";\n            if ("+(1===y)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              "+w+"\n            } else if ("+(2===y)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+c+", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              "+w+"\n            } else if ("+(3===y)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+c+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+c+", ch),\n                initializationValue\n              );\n\n              "+w+"\n            }\n          }\n          setOutput("+b+");\n        }\n      }\n    "}},ld=function(e,t){this.variableNames=["x"];var n=e.windowSize,r=e.batchSize,a=e.inSize,i=Math.ceil(a/n);this.outputShape=[r,i];var o="0.0",s="";"prod"===t?o="1.0":"min"===t?(o="1.0 / 1e-20",s="min"):"max"===t&&(o="-1.0 / 1e-20",s="max");var l=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===t?l="sumValue":"prod"===t?l="prodValue":"all"===t?l="allValue":"any"===t&&(l="anyValue");var c=4*Math.floor(n/4),u=n%4,h="\n      if ("+("sum"===t)+") {\n        sumValue += dot(values, ones);\n      } else if ("+("prod"===t)+") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = "+s+"(values, minMaxValue);\n      }\n    ",d="vec4";"all"===t?(o="1.0",h="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",d="bvec4"):"any"===t&&(o="0.0",h="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",d="bvec4");var f="";a%n>0&&(f="\n        if (inIdx < 0 || inIdx >= "+a+") {\n          return initializationValue;\n        }\n      "),this.userCode="\n      const float initializationValue = "+o+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        "+f+"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+n+";\n\n        vec4 minMaxValue = vec4("+o+");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < "+c+"; i += 4) {\n          int inIdx = inOffset + i;\n          "+d+" values = "+d+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          "+h+"\n        }\n\n        int inIdx = inOffset + "+c+";\n        if ("+(1===u)+") {\n          "+d+" values = "+d+"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          "+h+"\n        } else if ("+(2===u)+") {\n          "+d+" values = "+d+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          "+h+"\n        } else if ("+(3===u)+") {\n          "+d+" values = "+d+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          "+h+"\n        }\n        setOutput("+l+");\n      }\n    "},cd=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var n="",r=0;r<4;r++){var a="thisRC = rc;";r%2==1&&(a+="thisRC.z += 1;"),r>1&&(a+="thisRC.y += 1;"),n+="\n        "+a+"\n        "+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+"\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result["+r+"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        "+(r>0?"}":"")+"\n      "}this.userCode="\n      \n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      "+Nu(["r","c","d"],t)+"\n      return ivec3(r, c, d);\n    }\n  \n      "+Su(e)+"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = "+e[1]+";\n        int cols = "+e[2]+";\n\n        "+n+"\n\n        setOutput(result);\n      }\n    "},ud=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,a=r[1],i=r[2],o=e.shape,s=o[1],l=o[2],c=[n&&s>1?a-1:a,n&&l>1?i-1:i],u=[n&&s>1?s-1:s,n&&l>1?l-1:l],h=c[0]/u[0],d=c[1]/u[1],f=1/h,p=1/d,g=2*Math.ceil(f)+2,m=2*Math.ceil(p)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+h+");\n        const float widthScale = float("+d+");\n\n        const float invHeightScale = float("+f+");\n        const float invWidthScale = float("+p+");\n\n        const int winHeight = int("+g+");\n        const int winWidth = int("+m+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+l+") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), "+(a-1)+".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), "+(i-1)+".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},hd=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var a=e[0],i=e[1],o=e[2],s=e[3];this.outputShape=[a,t,n,s];var l=[r&&t>1?i-1:i,r&&n>1?o-1:o],c=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+l[0]/c[0]+",\n          "+l[1]/c[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+o+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    "},dd=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var a=e[0],i=e[1],o=e[2],s=e[3];this.outputShape=[a,t,n,s];var l=[r&&t>1?i-1:i,r&&n>1?o-1:o],c=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          "+l[0]/c[0]+",\n          "+l[1]/c[1]+",\n          "+l[1]/c[1]+");\n      const vec3 inputShapeRC = vec3("+i+".0, "+o+".0,\n                                     "+o+".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < "+(s-1)+";\n        bool hasNextRow = coords.z < "+(n-1)+";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    "},fd=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,a=r[1],i=r[2],o=e.shape,s=o[1],l=o[2],c=[n&&s>1?a-1:a,n&&l>1?i-1:i],u=[n&&s>1?s-1:s,n&&l>1?l-1:l],h=c[0]/u[0],d=c[1]/u[1],f=1/h,p=1/d,g=2*Math.ceil(f)+2,m=2*Math.ceil(p)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+h+");\n        const float widthScale = float("+d+");\n\n        const float invHeightScale = float("+f+");\n        const float invWidthScale = float("+p+");\n\n        const int winHeight = int("+g+");\n        const int winWidth = int("+m+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+l+") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float("+c[0]+") *\n                (float(dyR) / float("+u[0]+"));\n\n            float sourceFracCol =\n                float("+c[1]+") *\n                  (float(dyC) / float("+u[1]+"));\n\n            int sourceNearestRow = int(min(\n                float(int("+a+") - 1),\n                "+n+" ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int("+i+") - 1),\n                "+n+" ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},pd=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var a=e[0],i=e[1],o=e[2],s=e[3];this.outputShape=[a,t,n,s];var l=[r&&t>1?i-1:i,r&&n>1?o-1:o],c=[r&&t>1?t-1:t,r&&n>1?n-1:n],u=r?"0.5":"0.0";this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+l[0]/c[0]+",\n          "+l[1]/c[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+o+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + "+u+")));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    "},gd=function(e,t){this.variableNames=["x"];var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=e,1!==n){var r=e.map(function(n,r){return function(n){return-1!==t.indexOf(n)&&1!==e[n]?e[n]+" - coords["+n+"] - 1":"coords["+n+"]"}(r)}).join(","),a=Lu(n);this.userCode="\n      void main() {\n        "+a+" coords = getOutputCoords();\n        setOutput(getX("+r+"));\n      }\n    "}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX("+e[0]+" - coord - 1));\n        }\n      "},md=function(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=e;var r=wu("rc",n),a=r[n-1]+" + 1 < "+this.outputShape[n-1],i=r[n-2]+" + 1 < "+this.outputShape[n-2],o=Lu(n);function s(n){var r=e.map(function(r,a){return function(n,r){return-1!==t.indexOf(n)&&1!==e[n]?e[n]+" - "+r[n]+" - 1":""+r[n]}(a,n)});return"getChannel(getX("+r.join(",")+"), vec2("+r.slice(-2).join(",")+"))"}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX("+e[0]+" - rc - 1),\n            "+e[0]+" - rc - 1);\n          if("+a+"){\n              result.g = getChannel(getX("+e[0]+" - (rc  + 1) - 1),\n                "+e[0]+" - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      ":"\n        void main() {\n          "+o+" rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = "+function(e){return s(e)}(r.slice())+";\n          if("+a+"){\n            result.g = "+function(e){return e[n-1]="("+e[n-1]+" + 1)",s(e)}(r.slice())+";\n          }\n          if("+i+") {\n            result.b = "+function(e){return e[n-2]="("+e[n-2]+" + 1)",s(e)}(r.slice())+";\n            if("+a+") {\n              result.a = "+function(e){return e[n-1]="("+e[n-1]+" + 1)",e[n-2]="("+e[n-2]+" + 1)",s(e)}(r.slice())+";\n            }\n          }\n          setOutput(result);\n        }\n    "},vd=function(e,t,n,r,a,i,o){void 0===o&&(o=!0),this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var s=Lu(a.length),l=Lu(i.length),c="";1===n?c="i":2===n&&(c="i, j");var u="getIndices("+c+")",h="";1===r?h="i":2===r&&(h="i, coords[1]");var d="getUpdates("+h+")",f=t>1?"strides[j]":"strides";this.userCode="\n        "+s+" strides = "+s+"("+a+");\n\n        void main() {\n          "+l+" coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < "+e+"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < "+t+"; j++) {\n              int index = round("+u+");\n              flattenedIndex += index * "+f+";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += "+d+";\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      "},bd=function(e,t){this.variableNames=["x","segmentIds"];var n=e.windowSize,r=e.batchSize,a=e.inSize,i=e.numSegments,o=i*Math.ceil(a/n);this.outputShape=[r,o];var s=4*Math.floor(n/4),l=n%4,c="\n        sumValue += dot(values, segFilter);\n    ",u="";a%n>0&&(u="\n        if (inIdx < 0 || inIdx >= "+a+") {\n          return initializationValue;\n        }\n      ");var h="";a%n>0&&(h="\n        if (inIdx < 0 || inIdx >= "+a+") {\n          return -1.0;\n        }\n      "),this.userCode="\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        "+u+"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        "+h+"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          "+i+")) * float("+n+"));\n        int currentSeg = int(mod(float(outIdx), float("+i+")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < "+s+"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          "+c+"\n        }\n\n        int inIdx = inOffset + "+s+";\n        if ("+(1===l)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          "+c+"\n        } else if ("+(2===l)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          "+c+"\n        } else if ("+(3===l)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          "+c+"\n        }\n        setOutput(sumValue);\n      }\n    "},xd=function(e,t,n){var r,a;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank "+n+" is not yet supported");if(1===n)a="resRC",r="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],s=[],l=0;l<t.length;l++)s.push(""+i[l]),l<e&&o.push(""+i[l]);r=o.join(),a=s.join()}var c=Lu(n);this.userCode="\n      void main() {\n        "+c+" resRC = getOutputCoords();\n        float cVal = getC("+r+");\n        if (cVal >= 1.0) {\n          setOutput(getA("+a+"));\n        } else {\n          setOutput(getB("+a+"));\n        }\n      }\n    "},yd=function(){function e(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;var t,n=Lu(this.rank),r="uniform int start["+this.rank+"];",a=function(e){if(1===e)return"sourceLoc";if(e<=6)return wd.slice(0,e).map(function(e){return"sourceLoc."+e}).join(",");throw Error("Slicing for rank "+e+" is not yet supported")}(this.rank);t="\n        "+n+" sourceLoc;\n        "+n+" coords = getOutputCoords();\n        "+e.map(function(e,t){return"sourceLoc."+wd[t]+" = start["+t+"] + coords."+wd[t]+";"}).join("\n")+"\n      ",this.userCode="\n      "+r+"\n      void main() {\n        "+t+"\n        setOutput(getSource("+a+"));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}},e}(),wd=["x","y","z","w","u","v"],kd=function(){function e(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length;var t=Lu(this.rank),n=wu("coords",this.rank),r=wu("sourceLoc",this.rank),a=1===this.rank?"sourceLoc":"vec2("+r.slice(-2).join()+")",i="getChannel(getSource("+r.join()+"), "+a+")",o="\n      result.x = "+i+";\n      if (++"+n[this.rank-1]+" < "+e[this.rank-1]+") {\n        ++"+r[this.rank-1]+";\n        result.y = "+i+";\n        --"+r[this.rank-1]+";\n      }\n    ",s=1===this.rank?"":"\n      --"+n[this.rank-1]+";\n      if (++"+n[this.rank-2]+" < "+e[this.rank-2]+") {\n        ++"+r[this.rank-2]+";\n        result.z = "+i+";\n        if (++"+n[this.rank-1]+" < "+e[this.rank-1]+") {\n          ++"+r[this.rank-1]+";\n          result.w = "+i+";\n        }\n      }\n    ",l=this.rank<=4?"sourceLoc = coords +\n            "+t+"("+e.map(function(e,t){return"start["+t+"]"}).join()+");":e.map(function(e,t){return r[t]+" = "+n[t]+" + start["+t+"];"}).join("\n");this.userCode="\n      uniform int start["+this.rank+"];\n      void main() {\n        "+t+" coords = getOutputCoords();\n        "+t+" sourceLoc;\n        "+l+"\n        vec4 result = vec4(0.);\n        "+o+"\n        "+s+"\n        setOutput(result);\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}},e}(),Nd=function(e,t,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,a=Lu(n.length),i=Lu(n.length),o="";if(1===r)o="coords * strides + begin";else{var s=0;o=n.map(function(e,t){return s++,1===n.length?"coords * strides["+t+"] + begin["+t+"]":"coords["+(s-1)+"] * strides["+t+"] + begin["+t+"]"}).join(",")}this.userCode="\n      "+a+" begin = "+a+"("+e+");\n      "+a+" strides = "+a+"("+t+");\n\n      void main() {\n        "+i+" coords = getOutputCoords();\n        setOutput(getX("+o+"));\n      }\n    "},Sd=function(){function e(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return e.prototype.acquireTexture=function(e,t,n){var r,a=Cd(t,n),i=Ed(e,a,n);if(i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]),this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var o=this.freeTextures[i].shift();return this.usedTextures[i].push(o),o}return this.numUsedTextures++,this.log(),a===Uo.PACKED_2X2_FLOAT32?r=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):a===Uo.PACKED_2X2_FLOAT16?r=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):a===Uo.UNPACKED_FLOAT32?r=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):a===Uo.UNPACKED_FLOAT16?r=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):a===Uo.PACKED_4X1_UNSIGNED_BYTE&&(r=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(r),r},e.prototype.releaseTexture=function(e,t,n,r){if(null!=this.freeTextures){var a=Ed(t,Cd(n,r),r);a in this.freeTextures||(this.freeTextures[a]=[]),this.freeTextures[a].push(e),this.numFreeTextures++,this.numUsedTextures--;var i=this.usedTextures[a],o=i.indexOf(e);if(o<0)throw new Error("Cannot release a texture that was never provided by this texture manager");i.splice(o,1),this.log()}},e.prototype.log=function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+e+")")}},e.prototype.getNumUsedTextures=function(){return this.numUsedTextures},e.prototype.getNumFreeTextures=function(){return this.numFreeTextures},e.prototype.dispose=function(){var e=this;if(null!=this.freeTextures){for(var t in this.freeTextures)this.freeTextures[t].forEach(function(t){e.gpgpu.deleteMatrixTexture(t)});for(var t in this.usedTextures)this.usedTextures[t].forEach(function(t){e.gpgpu.deleteMatrixTexture(t)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},e}();function Cd(e,t){if(e===Wo.UPLOAD)return Uo.PACKED_2X2_FLOAT32;if(e===Wo.RENDER||null==e)return function(e){return fi().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?Uo.PACKED_2X2_FLOAT32:Uo.UNPACKED_FLOAT32:e?Uo.PACKED_2X2_FLOAT16:Uo.UNPACKED_FLOAT16}(t);if(e===Wo.DOWNLOAD||e===Wo.PIXELS)return Uo.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+e)}function Ed(e,t,n){return e[0]+"_"+e[1]+"_"+t+"_"+n}var _d=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[r]*t[r];this.outputShape=n,this.rank=n.length;var a=Lu(this.rank),i=function(e){var t=e.length;if(t>5)throw Error("Tile for rank "+t+" is not yet supported");if(1===t)return"imod(resRC, "+e[0]+")";for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],a=0;a<e.length;a++)r.push("imod("+n[a]+", "+e[a]+")");return r.join()}(e);this.userCode="\n      void main() {\n        "+a+" resRC = getOutputCoords();\n        setOutput(getA("+i+"));\n      }\n    "},Id=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];this.outputShape=n,this.rank=n.length;var a=Lu(this.rank),i=function(e){var t=e.length;if(t>6)throw Error("Transpose for rank "+t+" is not yet supported");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t),a=0;a<e.length;a++)r[e[a]]=n[a];return r.join()}(t);this.userCode="\n    void main() {\n      "+a+" resRC = getOutputCoords();\n      setOutput(getA("+i+"));\n    }\n    "},Td=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var a=Lu(this.rank),i=yu("rc",this.rank),o=new Array(this.rank);for(r=0;r<t.length;r++)o[t[r]]=i[r];var s="vec2("+o.slice(-2).join()+")",l="++"+i[this.rank-1]+" < "+n[this.rank-1],c="getChannel(getA("+o.join()+"), "+s+")";this.userCode="\n    void main() {\n      "+a+" rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = "+c+";\n      if("+l+") {\n        result[1] = "+c+";\n      }\n      --"+i[this.rank-1]+";\n      if(++"+i[this.rank-2]+" < "+n[this.rank-2]+") {\n        result[2] = "+c+";\n        if("+l+") {\n          result[3] = "+c+";\n        }\n      }\n      setOutput(result);\n    }\n    "},Ad=1.7580993408473768,Rd=1.0507009873554805,Dd=function(e,t){this.variableNames=["A"],this.outputShape=e,this.userCode="\n      float unaryOperation(float x) {\n        "+t+"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},Fd="if (isnan(x)) return x;",Od="return abs(x);",Ld=Fd+"\n  return (x < 0.0) ? 0.0 : x;\n",Pd=Fd+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",Md="return (x >= 0.0) ? x : (exp(x) - 1.0);",jd="\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = "+Ad+";\n  float scale = "+Rd+";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n",Bd="return -x;",zd="return ceil(x);",Wd="return floor(x);",Ud="return exp(x);",Vd="return exp(x) - 1.0;",Hd=Fd+"\n  return sin(x);\n",Gd=Fd+"\n  return cos(x);\n",qd=Fd+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n",Kd=Fd+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n",Xd=Fd+"\n  return atan(x);\n",Yd=Fd+"return log(x + sqrt(x * x + 1.0));",$d=Fd+"\n  if (x < 1.0) return NAN;\n  return log(x + sqrt(x * x - 1.0));",Jd=Fd+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;",Qd="return x;",Zd="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",ef="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",tf="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",nf=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        "+t+"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},rf=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e;var t=e.length,n=wu("rc",t),r=Lu(t),a=function(e,t){if(1===e)return"rc";for(var n="",r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(t,n),i=n.slice(-2),o=t<=1?"rc":"vec2("+i.join(",")+")";this.userCode="\n      void main() {\n        "+r+" rc = getOutputCoords();\n        vec4 packedInput = getA("+a+");\n\n        setOutput(getChannel(packedInput, "+o+"));\n      }\n    "},af={};function of(e,t){if(void 0===t&&(t=!1),"linear"===e)return"return x;";if("relu"===e)return t?Zd:Ld;if("elu"===e)return t?tf:Md;if("relu6"===e)return t?ef:Pd;if("prelu"===e)return t?Yu:Ku;throw new Error("Activation "+e+" has not been implemented for the WebGL backend.")}var sf=function(e){function t(t){var n,r=e.call(this)||this;if(r.pendingRead=new WeakMap,r.pendingDisposal=new WeakSet,r.dataRefCount=new WeakMap,r.numBytesInGPU=0,r.uploadWaitMs=0,r.downloadWaitMs=0,r.warnedAboutMemory=!1,r.pendingDeletes=0,r.disposed=!1,!fi().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==t){var a=qo(fi().getNumber("WEBGL_VERSION"));r.binaryCache=((n=fi().getNumber("WEBGL_VERSION"))in af||(af[n]={}),af[n]),r.gpgpu=new qh(a),r.canvas=a.canvas,r.gpgpuCreatedLocally=!0}else r.gpgpu=t,r.binaryCache={},r.gpgpuCreatedLocally=!1,r.canvas=t.gl.canvas;return r.textureManager=new Sd(r.gpgpu),r.numMBBeforeWarning=null==fi().global.screen?1024:fi().global.screen.height*fi().global.screen.width*window.devicePixelRatio*600/1024/1024,r.texData=new Oc(r,Mo),r}return ci(t,e),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.write=function(e,t,n){if(fi().getBool("DEBUG")&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var r={};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:Wo.UPLOAD}),r},t.prototype.move=function(e,t,n,r){if(fi().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:Wo.UPLOAD})},t.prototype.readSync=function(e){var t=this.texData.get(e),n=t.values,r=t.dtype,a=t.complexTensors,i=t.slice,o=t.shape,s=t.isPacked;if(null!=i){var l;l=s?new nf(o,Qd):new Dd(o,Qd);var c=this.runWebGLProgram(l,[{dataId:e,shape:o,dtype:r}],r),u=this.readSync(c.dataId);return this.disposeData(c.dataId),u}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===r)return n;var h,d,f=null!=this.activeTimers;return f&&(h=io()),d="complex64"===r?tu(a.real.dataSync(),a.imag.dataSync()):this.getValuesFromTexture(e),f&&(this.downloadWaitMs+=io()-h),this.convertAndCacheOnCPU(e,d)},t.prototype.read=function(e){return ui(this,void 0,void 0,function(){var t,n,r,a,i,o,s,l,c,u,h,d,f,p,g,m,v,b,x,y,w,k;return hi(this,function(N){switch(N.label){case 0:if(this.pendingRead.has(e))return t=this.pendingRead.get(e),[2,new Promise(function(e){return t.push(e)})];if(n=this.texData.get(e),r=n.values,a=n.shape,i=n.slice,o=n.dtype,s=n.complexTensors,l=n.isPacked,null!=i)return void 0,c=l?new nf(a,Qd):new Dd(a,Qd),u=this.runWebGLProgram(c,[{dataId:e,shape:a,dtype:o}],o),h=this.read(u.dataId),this.disposeData(u.dataId),[2,h];if(null!=r)return[2,this.convertAndCacheOnCPU(e)];if(!fi().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===fi().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return d=null,"complex64"!==o&&fi().get("WEBGL_BUFFER_SUPPORTED")&&(f=this.decode(e),p=this.texData.get(f.dataId),d=(k=this.gpgpu).createBufferFromTexture.apply(k,[p.texture].concat(Xo(a)))),this.pendingRead.set(e,[]),"complex64"===o?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:N.sent(),N.label=2;case 2:return"complex64"!==o?[3,4]:[4,Promise.all([s.real.data(),s.imag.data()])];case 3:return m=N.sent(),v=m[0],b=m[1],g=tu(v,b),[3,5];case 4:null==d?g=this.getValuesFromTexture(e):(x=Ai(a),g=this.gpgpu.downloadFloat32MatrixFromBuffer(d,x)),N.label=5;case 5:return null!=f&&this.disposeData(f.dataId),y=this.convertAndCacheOnCPU(e,g),w=this.pendingRead.get(e),this.pendingRead.delete(e),w.forEach(function(e){return e(y)}),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e),this.pendingDeletes--),[2,y]}})})},t.prototype.checkNumericalProblems=function(e){if(null!=e)for(var t=0;t<e.length;t++){var n=e[t];if(!Qo(n)){if(fi().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value "+n+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value "+n+" cannot be represented on this device.")}}},t.prototype.getValuesFromTexture=function(e){var t,n=this.texData.get(e),r=n.shape,a=n.dtype,i=n.isPacked,o=Ai(r);if(fi().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var s=this.decode(e),l=this.texData.get(s.dataId),c=(t=this.gpgpu).downloadMatrixFromPackedTexture.apply(t,[l.texture].concat(Xo(r))).subarray(0,o);return this.disposeData(s.dataId),c}var u=fi().getBool("WEBGL_PACK")&&!0===i,h=u?_s(r):r,d=u?new wh(h):new yh(h),f=this.runWebGLProgram(d,[{shape:h,dtype:a,dataId:e}],"float32"),p=this.texData.get(f.dataId),g=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(p.texture,p.texShape[0],p.texShape[1]).subarray(0,o);return this.disposeData(f.dataId),g},t.prototype.time=function(e){return ui(this,void 0,void 0,function(){var t,n,r,a,i,o,s;return hi(this,function(l){switch(l.label){case 0:return t=this.activeTimers,n=[],r=!1,null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,e(),a=Ti(this.activeTimers.map(function(e){return e.query})).filter(function(e){return null!=e}),i=Ti(this.activeTimers.map(function(e){return e.name})).filter(function(e){return null!=e}),this.activeTimers=t,r&&(this.programTimersStack=null),o={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},fi().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(a)]:[3,2];case 1:return s=l.sent(),o.kernelMs=Ci(s),o.getExtraProfileInfo=function(){return s.map(function(e,t){return{name:i[t],ms:e}}).map(function(e){return e.name+": "+e.ms}).join(", ")},[3,3];case 2:o.kernelMs={error:"WebGL query timers are not supported in this environment."},l.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,o]}})})},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return fi().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:io(),endMs:null}},t.prototype.endTimer=function(e){return fi().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=io(),e)},t.prototype.getQueryTime=function(e){return ui(this,void 0,void 0,function(){var t;return hi(this,function(n){return fi().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(e)]:[2,(t=e).endMs-t.startMs]})})},t.prototype.disposeData=function(e){if(!this.pendingDisposal.has(e)){if(this.pendingRead.has(e))return this.pendingDisposal.add(e),void this.pendingDeletes++;if(this.texData.has(e)){this.releaseGPUData(e);var t=this.texData.get(e).complexTensors;null!=t&&(t.real.dispose(),t.imag.dispose()),this.texData.delete(e)}}},t.prototype.releaseGPUData=function(e){var t=this.texData.get(e),n=t.texture,r=t.dtype,a=t.texShape,i=t.usage,o=t.isPacked,s=t.slice,l=s&&s.origDataId||e,c=this.dataRefCount.get(l);c>1?this.dataRefCount.set(l,c-1):(this.dataRefCount.delete(l),null!=n&&(this.numBytesInGPU-=this.computeBytes(a,r),this.textureManager.releaseTexture(n,a,i,o)));var u=this.texData.get(e);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null},t.prototype.getTexture=function(e){return this.uploadToGPU(e),this.texData.get(e).texture},t.prototype.getDataInfo=function(e){return this.texData.get(e)},t.prototype.getCPUBackend=function(){return fi().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=Mo.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(e,t){var n=this;return void 0===t&&(t=128),null!=this.getCPUBackend()&&e.every(function(e){return null==n.texData.get(e.dataId).texture&&e.size<t})},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(e,t){var n=this.makeOutput(e.shape,"complex64");return this.texData.get(n.dataId).complexTensors={real:Mo.keep(e.clone()),imag:Mo.keep(t.clone())},n},t.prototype.real=function(e){return this.texData.get(e.dataId).complexTensors.real.clone()},t.prototype.imag=function(e){return this.texData.get(e.dataId).complexTensors.imag.clone()},t.prototype.slice=function(e,t,n){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.slice(e,t,n);if(0===Ai(n))return ul([],n,e.dtype);var r=this.texData.get(e.dataId).isPacked,a=Tc(e.shape,t,n);if(r||!a){var i=fi().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new kd(n):new yd(n),o=i.getCustomSetupFunc(t);return this.compileAndRun(i,[e],null,o)}return this.uploadToGPU(e.dataId),this.shallowSlice(e,t,n)},t.prototype.shallowSlice=function(e,t,n){var r=this.texData.get(e.dataId),a=this.makeOutput(n,e.dtype),i=this.texData.get(a.dataId);Object.assign(i,r),i.shape=n,i.dtype=e.dtype;var o=Ac(t,e.strides);r.slice&&(o+=r.slice.flatOffset),i.slice={flatOffset:o,origDataId:r.slice&&r.slice.origDataId||e.dataId};var s=this.dataRefCount.get(i.slice.origDataId)||1;return this.dataRefCount.set(i.slice.origDataId,s+1),a},t.prototype.stridedSlice=function(e,t,n,r){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.stridedSlice(e,t,n,r);var a=Ec(t,n,r);if(a.some(function(e){return 0===e}))return ul([],a);var i=new Nd(t,r,a);return this.compileAndRun(i,[e])},t.prototype.reverse=function(e,t){var n=fi().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new md(e.shape,t):new gd(e.shape,t);return this.compileAndRun(n,[e])},t.prototype.concat=function(e,t){if("complex64"===e[0].dtype){var n=e.map(function(e){return ll(e)}),r=e.map(function(e){return cl(e)});return sl(this.concat(n,t),this.concat(r,t))}if(this.shouldExecuteOnCPU(e))return this.cpuBackend.concat(e,t);if(1===e.length)return e[0];if(e.length>fi().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var a=Math.floor(e.length/2),i=this.concat(e.slice(0,a),t),o=this.concat(e.slice(a),t);return this.concat([i,o],t)}if(fi().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&e[0].rank>1){var s=new th(e.map(function(e){return e.shape}),t);return this.compileAndRun(s,e)}var l=il(e.map(function(e){return e.shape}),t),c=e.map(function(e){return e.as2D(-1,Ai(e.shape.slice(t)))}),u=new eh(c.map(function(e){return e.shape}));return this.compileAndRun(u,c).reshape(l)},t.prototype.neg=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.neg(e);if(fi().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Bd,e.dtype);var t=new Dd(e.shape,Bd);return this.compileAndRun(t,[e])},t.prototype.batchMatMul=function(e,t,n,r){var a=n?e.shape[2]:e.shape[1],i=r?t.shape[1]:t.shape[2],o=n?e.shape[1]:e.shape[2],s=e.shape[0];if((1===a||1===i)&&o>1e3){n&&(e=e.transpose([0,2,1])),r&&(t=t.transpose([0,2,1]));var l=1===i?e:e.as3D(s,o,1),c=1===i?2:1,u=1===i?t.as3D(s,1,o):t;return this.multiply(l,u).sum(c,!0)}var h=To(e.dtype,t.dtype),d=new ed(e.shape,[s,a,i],n,r);return this.compileAndRun(d,[e,t],h)},t.prototype.fusedBatchMatMul=function(e){var t=e.a,n=e.b,r=e.transposeA,a=e.transposeB,i=e.bias,o=e.activation,s=e.preluActivationWeights,l=r?t.shape[2]:t.shape[1],c=a?n.shape[1]:n.shape[2],u=t.shape[0],h=To(t.dtype,n.dtype),d=null!=i,f=null!=s,p=o?of(o,!0):null,g=new ed(t.shape,[u,l,c],r,a,d,p,f),m=[t,n];return i&&m.push(i),s&&m.push(s),this.compileAndRun(g,m,h)},t.prototype.multiply=function(e,t){if("complex64"===e.dtype){var n=this.texData.get(e.dataId),r=this.texData.get(t.dataId),a=new Vu("return areal * breal - aimag * bimag;",e.shape,t.shape),i=new Vu("return areal * bimag + aimag * breal;",e.shape,t.shape),o=[this.makeComplexComponentTensorInfo(e,n.complexTensors.real),this.makeComplexComponentTensorInfo(e,n.complexTensors.imag),this.makeComplexComponentTensorInfo(t,r.complexTensors.real),this.makeComplexComponentTensorInfo(t,r.complexTensors.imag)],s=this.compileAndRun(a,o),l=this.compileAndRun(i,o),c=this.complex(s,l);return s.dispose(),l.dispose(),c}if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.multiply(e,t);if(fi().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,qu,e.dtype);var u=new Xu(qu,e.shape,t.shape);return this.compileAndRun(u,[e,t],e.dtype)},t.prototype.batchNormalization=function(e,t,n,r,a,i){var o=[e,t,n],s=null;null!=i&&(s=i.shape,o.push(i));var l=null;if(null!=a&&(l=a.shape,o.push(a)),fi().getBool("WEBGL_PACK_NORMALIZATION")){var c=new Uu(e.shape,t.shape,n.shape,s,l,r);return this.compileAndRun(c,o)}var u=new Wu(e.shape,t.shape,n.shape,s,l,r);return this.compileAndRun(u,o)},t.prototype.localResponseNormalization4D=function(e,t,n,r,a){var i=fi().getBool("WEBGL_PACK_NORMALIZATION")?new Jh(e.shape,t,n,r,a):new Yh(e.shape,t,n,r,a);return this.compileAndRun(i,[e])},t.prototype.LRNGrad=function(e,t,n,r,a,i,o){var s=new $h(t.shape,r,a,i,o);return this.compileAndRun(s,[t,n,e])},t.prototype.tile=function(e,t){if("string"===e.dtype){var n=this.readSync(e.dataId).map(function(e){return lo(e)});return pu(Wl(e.shape,e.dtype,n),t)}var r=new _d(e.shape,t);return this.compileAndRun(r,[e])},t.prototype.pad=function(e,t,n){var r=fi().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new id(e.shape,t,n):new ad(e.shape,t,n);return this.compileAndRun(r,[e])},t.prototype.transpose=function(e,t){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.transpose(e,t);var n=fi().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Td(e.shape,t):new Id(e.shape,t);return this.compileAndRun(n,[e])},t.prototype.gather=function(e,t,n){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.gather(e,t,n);var r=new Eh(e.shape,t.size,n);return this.compileAndRun(r,[e,t])},t.prototype.batchToSpaceND=function(e,t,n){Ei(e.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var r=t.reduce(function(e,t){return e*t}),a=pc(e.shape,t,r),i=gc(a.length,t.length),o=mc(e.shape,t,r),s=vc(n,t.length),l=bc(o,n,t.length);return e.reshape(a).transpose(i).reshape(o).slice(s,l)},t.prototype.spaceToBatchND=function(e,t,n){Ei(e.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var r=t.reduce(function(e,t){return e*t}),a=[[0,0]];a.push.apply(a,n);for(var i=1+t.length;i<e.shape.length;++i)a.push([0,0]);var o=e.pad(a),s=pc(o.shape,t,r,!1),l=gc(s.length,t.length,!1),c=mc(o.shape,t,r,!1);return o.reshape(s).transpose(l).reshape(c)},t.prototype.reduce=function(e,t,n){var r=e.shape[0],a=e.shape[1],i=yc(a),o=new ld({windowSize:i,inSize:a,batchSize:r},t),s=this.compileAndRun(o,[e],n);return 1===s.shape[1]?s:this.reduce(s,t,n)},t.prototype.argReduce=function(e,t,n){void 0===n&&(n=null);var r=e.shape[0],a=e.shape[1];null!=n&&(r=n.shape[0],a=n.shape[1]);var i=yc(a),o=new xu({windowSize:i,inSize:a,batchSize:r},t,null==n),s=[e];null!=n&&s.push(n);var l=this.compileAndRun(o,s,"int32");return 1===l.shape[1]?l:this.argReduce(e,t,l)},t.prototype.argReducePacked=function(e,t,n){void 0===n&&(n=null);var r=null!=n?n.shape:e.shape,a=yc(r[r.length-1]),i=new ju(r,a,t,null==n),o=null==n?[e]:[e,n],s=this.compileAndRun(i,o,"int32");return s.rank===e.rank?this.argReducePacked(e,t,s):s},t.prototype.sum=function(e,t){el("sum",t,e.rank);var n=Qs(e.shape,t),r=n[0],a=Ai(n[1]),i=e.as2D(-1,a),o=Ao(e.dtype);return this.reduce(i,"sum",o).reshape(r)},t.prototype.prod=function(e,t){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.prod(e,t);var n=Qs(e.shape,t),r=n[0],a=Ai(n[1]),i=e.as2D(-1,a),o=Ao(e.dtype);return this.reduce(i,"prod",o).reshape(r)},t.prototype.unsortedSegmentSum=function(e,t,n){var r=0,a=tl([r],e.rank),i=e;null!=a&&(i=e.transpose(a),r=rl(1,e.rank)[0]);var o=function(e,t,n){for(var r=[],a=e.length,i=0;i<a;i++)i!==t?r.push(e[i]):r.push(n);return r}(i.shape,r,n),s=Ai([i.shape[r]]),l=i.as2D(-1,s),c=Ao(e.dtype),u=this.segOpCompute(l,"unsortedSegmentSum",t,c,n).reshape(o);return null!=a&&(u=u.transpose(nl(a))),u},t.prototype.segOpCompute=function(e,t,n,r,a){var i=e.shape[0],o=e.shape[1],s=function(e,t){var n,r=!1;for(e<=30?(n=e,r=!0):n=Zi(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=Zi(e,n+1);return n}(o,a),l=new bd({windowSize:s,inSize:o,batchSize:i,numSegments:a},t),c=this.compileAndRun(l,[e,n],r);return c.shape[1]===a?c:(n=yl(0,a).tile([o/s]),this.segOpCompute(c,t,n,r,a))},t.prototype.argMinMaxReduce=function(e,t,n){var r=[t];if(el("arg"+n.charAt(0).toUpperCase()+n.slice(1),r,e.rank),!fi().getBool("WEBGL_PACK_REDUCE")||e.rank<=2){var a=Qs(e.shape,r),i=a[0],o=Ai(a[1]),s=e.as2D(-1,o);return this.argReduce(s,n).reshape(i)}return this.argReducePacked(e,n)},t.prototype.argMin=function(e,t){return this.argMinMaxReduce(e,t,"min")},t.prototype.argMax=function(e,t){return this.argMinMaxReduce(e,t,"max")},t.prototype.cumsum=function(e,t,n,r){if(t!==e.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(e.rank-1)+" but got axis="+t);var a=new ph(e.shape,n,r);return this.compileAndRun(a,[e])},t.prototype.equal=function(e,t){if(fi().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(equal(a, b));\n","bool");var n=new Xu("return float(a == b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.notEqual=function(e,t){if(fi().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(notEqual(a, b));\n","bool");var n=new Xu("return float(a != b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.less=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.less(e,t);if(fi().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(lessThan(a, b));\n","bool");var n=new Xu("return float(a < b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.lessEqual=function(e,t){if(fi().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(lessThanEqual(a, b));\n","bool");var n=new Xu("return float(a <= b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.greater=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.greater(e,t);if(fi().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(greaterThan(a, b));\n","bool");var n=new Xu("return float(a > b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.greaterEqual=function(e,t){if(fi().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(greaterThanEqual(a, b));\n","bool");var n=new Xu("return float(a >= b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.logicalNot=function(e){var t=new Dd(e.shape,"return float(!(x >= 1.0));");return this.compileAndRun(t,[e])},t.prototype.logicalAnd=function(e,t){if(fi().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n","bool");var n=new Xu("return float(a >= 1.0 && b >= 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.logicalOr=function(e,t){if(fi().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n","bool");var n=new Xu("return float(a >= 1.0 || b >= 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.select=function(e,t,n){var r=new xd(e.rank,t.shape,t.rank);return this.compileAndRun(r,[e,t,n],To(t.dtype,n.dtype))},t.prototype.where=function(e){Gs("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var t=e.dataSync();return mu(e.shape,t)},t.prototype.topk=function(e,t,n){return gu(e.dataSync(),e.shape,e.dtype,t)},t.prototype.min=function(e,t){el("min",t,e.rank);var n=Qs(e.shape,t),r=n[0],a=Ai(n[1]),i=e.as2D(-1,a);return this.reduce(i,"min",i.dtype).reshape(r)},t.prototype.minimum=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.minimum(e,t);var n=fi().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new $u("\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new Xu("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.mod=function(e,t){var n=fi().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new $u("\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new Xu("if (b == 0.0) return NAN;\n  return mod(a, b);",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.max=function(e,t){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.max(e,t);el("max",t,e.rank);var n=Qs(e.shape,t),r=n[0],a=Ai(n[1]),i=e.as2D(-1,a);return this.reduce(i,"max",i.dtype).reshape(r)},t.prototype.maximum=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.maximum(e,t);var n=fi().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new $u("\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new Xu("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.all=function(e,t){el("all",t,e.rank);var n=Qs(e.shape,t),r=n[0],a=Ai(n[1]),i=e.as2D(-1,a);return this.reduce(i,"all",i.dtype).reshape(r)},t.prototype.any=function(e,t){el("any",t,e.rank);var n=Qs(e.shape,t),r=n[0],a=Ai(n[1]),i=e.as2D(-1,a);return this.reduce(i,"any",i.dtype).reshape(r)},t.prototype.realDivide=function(e,t){if(fi().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n","float32",!0);var n=new Xu("\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",e.shape,t.shape);return this.compileAndRun(n,[e,t],"float32")},t.prototype.floorDiv=function(e,t){if(fi().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n","int32");var n=new Xu("\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",e.shape,t.shape);return this.compileAndRun(n,[e,t],"int32")},t.prototype.add=function(e,t){if("complex64"===e.dtype&&"complex64"===t.dtype)return this.complexSeparableBinaryOp(e,t,Hu);if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.add(e,t);var n=To(e.dtype,t.dtype);if(fi().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,Hu,n);var r=new Xu(Hu,e.shape,t.shape);return this.compileAndRun(r,[e,t],n)},t.prototype.packedUnaryOp=function(e,t,n){var r=new nf(e.shape,t);return this.compileAndRun(r,[e],n)},t.prototype.packedBinaryOp=function(e,t,n,r,a){void 0===a&&(a=!1);var i=new $u(n,e.shape,t.shape,a);return this.compileAndRun(i,[e,t],r)},t.prototype.complexSeparableBinaryOp=function(e,t,n){var r=this,a=this.texData.get(e.dataId),i=this.texData.get(t.dataId),o=[[a.complexTensors.real,i.complexTensors.real],[a.complexTensors.imag,i.complexTensors.imag]].map(function(a){var i=a[0],o=a[1],s=r.makeComplexComponentTensorInfo(e,i),l=r.makeComplexComponentTensorInfo(t,o),c=new Xu(n,e.shape,t.shape);return r.compileAndRun(c,[s,l],To(i.dtype,o.dtype))}),s=o[0],l=o[1],c=this.complex(s,l);return s.dispose(),l.dispose(),c},t.prototype.makeComplexComponentTensorInfo=function(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}},t.prototype.addN=function(e){if(1===e.length)return e[0];if(e.length>fi().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var t=Math.floor(e.length/2),n=this.addN(e.slice(0,t)),r=this.addN(e.slice(t));return this.addN([n,r])}var a=e.map(function(e){return e.dtype}).reduce(function(e,t){return To(e,t)}),i=e.map(function(e){return e.shape}),o=fi().getBool("WEBGL_PACK")?new bu(e[0].shape,i):new vu(e[0].shape,i);return this.compileAndRun(o,e,a)},t.prototype.subtract=function(e,t){if("complex64"===e.dtype&&"complex64"===t.dtype)return this.complexSeparableBinaryOp(e,t,Gu);if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.subtract(e,t);var n=To(e.dtype,t.dtype);if(fi().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,Gu,e.dtype);var r=new Xu(Gu,e.shape,t.shape);return this.compileAndRun(r,[e,t],n)},t.prototype.pow=function(e,t){var n=fi().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new $u("\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new Xu("\nif(a < 0.0 && floor(b) < b){\n  return NAN;\n}\nif (b == 0.0) {\n  return 1.0;\n}\nreturn (round(mod(b, 2.0)) != 1) ?\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",e.shape,t.shape),r=To(e.dtype,t.dtype);return this.compileAndRun(n,[e,t],r)},t.prototype.ceil=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.ceil(e);if(fi().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,zd,e.dtype);var t=new Dd(e.shape,zd);return this.compileAndRun(t,[e])},t.prototype.floor=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.floor(e);if(fi().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Wd,e.dtype);var t=new Dd(e.shape,Wd);return this.compileAndRun(t,[e])},t.prototype.sign=function(e){var t=new Dd(e.shape,"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n");return this.compileAndRun(t,[e])},t.prototype.isNaN=function(e){var t=new Dd(e.shape,"return float(isnan(x));");return this.compileAndRun(t,[e],"bool")},t.prototype.isInf=function(e){var t=new Dd(e.shape,"return float(isinf(x));");return this.compileAndRun(t,[e],"bool")},t.prototype.isFinite=function(e){var t=new Dd(e.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(t,[e],"bool")},t.prototype.round=function(e){var t=new Dd(e.shape,"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n");return this.compileAndRun(t,[e])},t.prototype.exp=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.exp(e);if(fi().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Ud,e.dtype);var t=new Dd(e.shape,Ud);return this.compileAndRun(t,[e])},t.prototype.expm1=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.expm1(e);if(fi().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Vd,e.dtype);var t=new Dd(e.shape,Vd);return this.compileAndRun(t,[e])},t.prototype.softmax=function(e,t){var n=ji([t],e.shape),r=this.max(e,n),a=Zs(r.shape,n),i=this.subtract(e,r.reshape(a)),o=this.exp(i),s=this.sum(o,n).reshape(a);return this.realDivide(o,s)},t.prototype.log=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.log(e);if(fi().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",e.dtype);var t=new Dd(e.shape,"if (x < 0.0) return NAN;\n  return log(x);");return this.compileAndRun(t,[e])},t.prototype.log1p=function(e){var t=new Dd(e.shape,"return log(1.0 + x);");return this.compileAndRun(t,[e])},t.prototype.sqrt=function(e){var t=new Dd(e.shape,"return sqrt(x);");return this.compileAndRun(t,[e])},t.prototype.rsqrt=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.rsqrt(e);var t=new Dd(e.shape,"return inversesqrt(x);");return this.compileAndRun(t,[e])},t.prototype.reciprocal=function(e){var t=new Dd(e.shape,"return 1.0 / x;");return this.compileAndRun(t,[e])},t.prototype.relu=function(e){var t;return t=fi().getBool("WEBGL_PACK")?new nf(e.shape,Zd):new Dd(e.shape,Ld),this.compileAndRun(t,[e])},t.prototype.relu6=function(e){var t;return t=fi().getBool("WEBGL_PACK")?new nf(e.shape,ef):new Dd(e.shape,Pd),this.compileAndRun(t,[e])},t.prototype.prelu=function(e,t){var n=fi().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new $u(Yu,e.shape,t.shape):new Xu(Ku,e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.elu=function(e){if(fi().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,tf,e.dtype);var t=new Dd(e.shape,Md);return this.compileAndRun(t,[e])},t.prototype.eluDer=function(e,t){var n=fi().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new $u("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",e.shape,t.shape):new Xu("return (b >= 1.0) ? a : a * (b + 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.selu=function(e){var t=new Dd(e.shape,jd);return this.compileAndRun(t,[e])},t.prototype.int=function(e){var t=new Dd(e.shape,"return float(int(x));");return this.compileAndRun(t,[e],"int32")},t.prototype.clip=function(e,t,n){var r,a=(r=fi().getBool("WEBGL_PACK_CLIP")?new Qu(e.shape):new Ju(e.shape)).getCustomSetupFunc(t,n);return this.compileAndRun(r,[e],null,a)},t.prototype.abs=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.abs(e);if(fi().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Od,e.dtype);var t=new Dd(e.shape,Od);return this.compileAndRun(t,[e])},t.prototype.complexAbs=function(e){var t=this.texData.get(e.dataId),n=new Zu(e.shape),r=[this.makeComplexComponentTensorInfo(e,t.complexTensors.real),this.makeComplexComponentTensorInfo(e,t.complexTensors.imag)];return this.compileAndRun(n,r)},t.prototype.sigmoid=function(e){var t=new Dd(e.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(t,[e])},t.prototype.softplus=function(e){var t=new Dd(e.shape,"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n");return this.compileAndRun(t,[e])},t.prototype.sin=function(e){var t=new Dd(e.shape,Hd);return this.compileAndRun(t,[e])},t.prototype.cos=function(e){var t=new Dd(e.shape,Gd);return this.compileAndRun(t,[e])},t.prototype.tan=function(e){var t=new Dd(e.shape,"return tan(x);");return this.compileAndRun(t,[e])},t.prototype.asin=function(e){var t=new Dd(e.shape,qd);return this.compileAndRun(t,[e])},t.prototype.acos=function(e){var t=new Dd(e.shape,Kd);return this.compileAndRun(t,[e])},t.prototype.atan=function(e){var t=new Dd(e.shape,Xd);return this.compileAndRun(t,[e])},t.prototype.atan2=function(e,t){var n=fi().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new $u("\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new Xu("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.sinh=function(e){var t=new Dd(e.shape,"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n");return this.compileAndRun(t,[e])},t.prototype.cosh=function(e){var t=new Dd(e.shape,"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n");return this.compileAndRun(t,[e])},t.prototype.tanh=function(e){var t=new Dd(e.shape,"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n");return this.compileAndRun(t,[e])},t.prototype.asinh=function(e){var t=new Dd(e.shape,Yd);return this.compileAndRun(t,[e])},t.prototype.acosh=function(e){var t=new Dd(e.shape,$d);return this.compileAndRun(t,[e])},t.prototype.atanh=function(e){var t=new Dd(e.shape,Jd);return this.compileAndRun(t,[e])},t.prototype.erf=function(e){var t=new Dd(e.shape,'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = 0.3275911;\n  float a1 = 0.254829592;\n  float a2 = -0.284496736;\n  float a3 = 1.421413741;\n  float a4 = -1.453152027;\n  float a5 = 1.061405429;\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n');return this.compileAndRun(t,[e])},t.prototype.step=function(e,t){var n=new Dd(e.shape,function(e){return void 0===e&&(e=0),Fd+"\n    return x > 0.0 ? 1.0 : float("+e+");\n  "}(t));return this.compileAndRun(n,[e])},t.prototype.conv2dByMatMul=function(e,t,n,r,a,i){var o=e.shape,s=this.texData.get(e.dataId),l=n.inChannels,c=o[0]*o[1]*o[2],u=n.outChannels,h="channelsLast"===n.dataFormat,d=(1===c||1===u)&&l>1e3,f=o[2]%2!=0&&!!s.isPacked;if(d||!fi().getBool("WEBGL_LAZILY_UNPACK")||!fi().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!f){var p=h?o[0]*o[1]*o[2]:o[0]*o[2]*o[3],g=this.reshape(e,[1,p,n.inChannels]),m=this.reshape(t,[1,n.inChannels,n.outChannels]);return this.reshape(this.fusedBatchMatMul({a:g,b:m,transposeA:!1,transposeB:!1,bias:r,activation:a,preluActivationWeights:i}),n.outShape)}var v=h?o[0]*o[1]*(o[2]+1):o[0]*o[2]*(o[3]+1),b={dataId:e.dataId,shape:[1,v,n.inChannels],dtype:e.dtype},x=s.shape;s.shape=s.shape.slice(),s.shape[s.shape.length-2]++,Ei(As(s.shape,b.shape),function(){return"packed reshape "+s.shape+" to "+b.shape+" isn't free"});var y=this.reshape(t,[1,n.inChannels,n.outChannels]),w=this.fusedBatchMatMul({a:b,b:y,transposeA:!1,transposeB:!1,bias:r,activation:a,preluActivationWeights:i}),k=this.texData.get(w.dataId);return Ei(k.isPacked,function(){return"batchMatMul result is expected to be packed"}),s.shape=x,k.shape=n.outShape,Mo.makeTensorFromDataId(w.dataId,n.outShape,w.dtype)},t.prototype.conv2dWithIm2Row=function(e,t,n,r,a,i){var o=n.filterWidth,s=n.filterHeight,l=n.inChannels,c=n.outWidth,u=n.outHeight,h="channelsLast"===n.dataFormat,d=o*s*l,f=u*c,p=[d,f],g=e.squeeze([0]),m=t.reshape([1,d,-1]),v=new Xh(p,g.shape,n),b=this.compileAndRun(v,[g]).reshape([1,p[0],p[1]]),x=null!=r,y=null!=i,w=a?of(a,!0):null,k=new ed(b.shape,[1,f,n.outChannels],!0,!1,x,w,y),N=[b,m];r&&N.push(r),y&&N.push(i);var S=this.compileAndRun(k,N);return h?S.reshape([1,u,c,n.outChannels]):S.reshape([1,n.outChannels,u,c])},t.prototype.fusedConv2d=function(e){var t=e.input,n=e.filter,r=e.convInfo,a=e.bias,i=e.activation,o=e.preluActivationWeights;if(1===r.filterHeight&&1===r.filterWidth&&1===r.dilationHeight&&1===r.dilationWidth&&1===r.strideHeight&&1===r.strideWidth&&("SAME"===r.padInfo.type||"VALID"===r.padInfo.type))return this.conv2dByMatMul(t,n,r,a,i,o);if(fi().getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,n,r,a,i,o);var s=null!=a,l=null!=o,c=i?of(i,!1):null,u=new ch(r,s,c,l),h=[t,n];return a&&h.push(a),o&&h.push(o),this.compileAndRun(u,h)},t.prototype.conv2d=function(e,t,n){if(1===n.filterHeight&&1===n.filterWidth&&1===n.dilationHeight&&1===n.dilationWidth&&1===n.strideHeight&&1===n.strideWidth&&("SAME"===n.padInfo.type||"VALID"===n.padInfo.type))return this.conv2dByMatMul(e,t,n);if(fi().getBool("WEBGL_CONV_IM2COL")&&1===e.shape[0])return this.conv2dWithIm2Row(e,t,n);var r=new ch(n);return this.compileAndRun(r,[e,t])},t.prototype.conv2dDerInput=function(e,t,n){var r=new ah(n);return this.compileAndRun(r,[e,t])},t.prototype.conv2dDerFilter=function(e,t,n){var r=new rh(n);return this.compileAndRun(r,[e,t])},t.prototype.fusedDepthwiseConv2D=function(e){var t,n=e.input,r=e.filter,a=e.convInfo,i=e.bias,o=e.activation,s=e.preluActivationWeights,l=fi().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1,c=o?of(o,l):null,u=[n,r],h=null!=i,d=null!=s;return h&&u.push(i),d&&u.push(s),l?(t=new dh(a,h,c,d),this.compileAndRun(t,u)):(t=new hh(a,h,c,d),this.compileAndRun(t,u))},t.prototype.depthwiseConv2D=function(e,t,n){var r;return fi().getBool("WEBGL_PACK_DEPTHWISECONV")&&n.strideWidth<=2&&n.outChannels/n.inChannels==1?(r=new dh(n),this.compileAndRun(r,[e,t])):(r=new hh(n),this.compileAndRun(r,[e,t]))},t.prototype.depthwiseConv2DDerInput=function(e,t,n){var r=new lh(n);return this.compileAndRun(r,[e,t])},t.prototype.depthwiseConv2DDerFilter=function(e,t,n){var r=new sh(n);return this.compileAndRun(r,[e,t])},t.prototype.conv3d=function(e,t,n){var r=new uh(n);return this.compileAndRun(r,[e,t])},t.prototype.conv3dDerInput=function(e,t,n){var r=new oh(n);return this.compileAndRun(r,[e,t])},t.prototype.conv3dDerFilter=function(e,t,n){var r=new ih(n);return this.compileAndRun(r,[e,t])},t.prototype.maxPool=function(e,t){var n=new od(t,"max",!1);return this.compileAndRun(n,[e])},t.prototype.avgPool=function(e,t){var n=new od(t,"avg",!1);return this.compileAndRun(n,[e],"float32")},t.prototype.maxPoolBackprop=function(e,t,n,r){var a=new od(r,"max",!0),i=this.compileAndRun(a,[t]),o=new Qh(r),s=this.compileAndRun(o,[e,i],t.dtype);return i.dispose(),s},t.prototype.avgPoolBackprop=function(e,t,n){var r=new Bu(n);return this.compileAndRun(r,[e],t.dtype)},t.prototype.cast=function(e,t){return Qc(e,t,this)},t.prototype.unstack=function(e,t){for(var n=e.shape[t],r=new Array(e.rank-1),a=0,i=0;i<e.rank;i++)i!==t&&(r[a++]=e.shape[i]);var o=new Array(e.rank).fill(0),s=e.shape.slice();s[t]=1;var l=new Array(n);for(i=0;i<l.length;i++)o[t]=i,l[i]=this.slice(e,o,s).reshape(r);return l},t.prototype.avgPool3d=function(e,t){var n=new sd(t,"avg",!1);return this.compileAndRun(n,[e],"float32")},t.prototype.avgPool3dBackprop=function(e,t,n){var r=new zu(n);return this.compileAndRun(r,[e],t.dtype)},t.prototype.maxPool3d=function(e,t){var n=new sd(t,"max",!1);return this.compileAndRun(n,[e],"float32")},t.prototype.maxPool3dBackprop=function(e,t,n,r){var a=new sd(r,"max",!0),i=this.compileAndRun(a,[t]),o=new Zh(r),s=this.compileAndRun(o,[e,i],t.dtype);return i.dispose(),s},t.prototype.reshape=function(e,t){var n=this.texData.get(e.dataId);if(n.isPacked&&!As(e.shape,t)&&(null===n.texture||!As(n.shape,t))){var r=this.packedReshape(e,t);return Mo.makeTensorFromDataId(r.dataId,r.shape,r.dtype)}return Zc(e,t)},t.prototype.resizeBilinear=function(e,t,n,r){var a=fi().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new dd(e.shape,t,n,r):new hd(e.shape,t,n,r);return this.compileAndRun(a,[e],"float32")},t.prototype.resizeBilinearBackprop=function(e,t,n){var r=new ud(e,t,n);return this.compileAndRun(r,[e])},t.prototype.resizeNearestNeighbor=function(e,t,n,r){var a=new pd(e.shape,t,n,r);return this.compileAndRun(a,[e])},t.prototype.resizeNearestNeighborBackprop=function(e,t,n){var r=new fd(e,t,n);return this.compileAndRun(r,[e])},t.prototype.multinomial=function(e,t,n,r){var a=t?e:Dc(e),i=a.shape[0],o=a.shape[1],s=new td(i,o,n),l=s.getCustomSetupFunc(r);return this.compileAndRun(s,[a],"int32",l)},t.prototype.oneHot=function(e,t,n,r){var a=new nd(e.size,t,n,r);return this.compileAndRun(a,[e])},t.prototype.diag=function(e){var t=new xh(e.size);return this.compileAndRun(t,[e])},t.prototype.nonMaxSuppression=function(e,t,n,r,a){return Gs("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),su(e.dataSync(),t.dataSync(),n,r,a)},t.prototype.cropAndResize=function(e,t,n,r,a,i){var o=new fh(e.shape,t.shape,r,a,i);return this.compileAndRun(o,[e,t,n],"float32")},t.prototype.depthToSpace=function(e,t,n){Ei(t>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+t});var r=e.shape[0],a="NHWC"===n?e.shape[1]:e.shape[2],i="NHWC"===n?e.shape[2]:e.shape[3],o="NHWC"===n?e.shape[3]:e.shape[1],s=a*t,l=i*t,c=o/(t*t),u=new bh("NHWC"===n?[r,s,l,c]:[r,c,s,l],t,n);return this.compileAndRun(u,[e])},t.prototype.split=function(e,t,n){return fu(e,t,n)},t.prototype.scatterND=function(e,t,n){var r=Nc(0,e,n),a=r.sliceRank,i=r.numUpdates,o=r.sliceSize,s=r.strides,l=r.outputSize,c=[l/o,o],u=e.reshape([i,a]),h=t.reshape([i,o]);if(0===l)return Zc(ul([]),n);var d=dl(0),f=new vd(i,a,u.rank,h.rank,s,c);return this.compileAndRun(f,[h,u,d]).reshape(n)},t.prototype.sparseToDense=function(e,t,n,r){var a=Nc(0,e,n),i=a.sliceRank,o=a.numUpdates,s=a.strides,l=a.outputSize,c=new vd(o,i,e.rank,t.rank,s,[l,1],!1);return this.compileAndRun(c,[t,e,r]).reshape(n)},t.prototype.fft=function(e){return this.fftImpl(e,!1)},t.prototype.ifft=function(e){return this.fftImpl(e,!0)},t.prototype.fftImpl=function(e,t){var n=this.texData.get(e.dataId),r=new Sh("return real * expR - imag * expI;",e.shape,t),a=new Sh("return real * expI + imag * expR;",e.shape,t),i=[this.makeComplexComponentTensorInfo(e,n.complexTensors.real),this.makeComplexComponentTensorInfo(e,n.complexTensors.imag)],o=this.compileAndRun(r,i),s=this.compileAndRun(a,i),l=this.complex(o,s).as2D(e.shape[0],e.shape[1]);return o.dispose(),s.dispose(),l},t.prototype.gatherND=function(e,t){var n=t.shape,r=n[n.length-1],a=xc(e,t),i=a[0],o=a[1],s=a[2],l=a[3],c=t.reshape([o,r]),u=e.reshape([e.size/s,s]),h=new _h(r,l,[o,s]);return this.compileAndRun(h,[u,c]).reshape(i)},t.prototype.fill=function(e,t,n){if("string"===(n=n||Ji(t))){var r=Wi(n,Ai(e));return r.fill(t),Mo.makeTensor(r,e,n,this)}var a=new Ch(e,t),i=a.getCustomSetupFunc(t);return this.compileAndRun(a,[],n,i)},t.prototype.onesLike=function(e){if("string"===e.dtype)throw new Error("onesLike is not supported under string dtype");return this.fill(e.shape,1,e.dtype)},t.prototype.zerosLike=function(e){return this.fill(e.shape,"string"===e.dtype?"":0,e.dtype)},t.prototype.linspace=function(e,t,n){return eu(e,t,n)},t.prototype.makeTensorInfo=function(e,t){var n=this.write(null,e,t);return this.texData.get(n).usage=null,{dataId:n,shape:e,dtype:t}},t.prototype.makeOutput=function(e,t){var n=this.makeTensorInfo(e,t).dataId;return Mo.makeTensorFromDataId(n,e,t,this)},t.prototype.unpackTensor=function(e){var t=new rf(e.shape);return this.runWebGLProgram(t,[e],e.dtype)},t.prototype.packTensor=function(e){var t=new rd(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)},t.prototype.packedReshape=function(e,t){var n=[Cs(e.shape)].concat(Es(e.shape)),r={dtype:e.dtype,shape:n,dataId:e.dataId},a=[Cs(t)].concat(Es(t)),i=new cd(a,n),o=this.runWebGLProgram(i,[r],e.dtype,null,!0);return{dataId:o.dataId,shape:t,dtype:o.dtype}},t.prototype.decode=function(e){var t,n=this.texData.get(e),r=n.isPacked,a=n.shape,i=n.dtype,o=_s(a);return t=r?new vh(o):new mh(o),{dtype:i,shape:a,dataId:this.runWebGLProgram(t,[{shape:o,dtype:i,dataId:e}],i,null,!0).dataId}},t.prototype.runWebGLProgram=function(e,t,n,r,a){var i=this;void 0===a&&(a=!1);var o=this.makeTensorInfo(e.outputShape,n),s=this.texData.get(o.dataId);if(e.packedOutput&&(s.isPacked=!0),e.outPackingScheme===zo.DENSE){var l=Xo(e.outputShape);s.texShape=l.map(function(e){return 2*e})}if(null!=e.outTexUsage&&(s.usage=e.outTexUsage),0===Ai(o.shape))return s.values=zi(o.dtype,0),o;var c=[],u=t.map(function(t){if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=i.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&Ai(t.shape)<=fi().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}else if(!!n.isPacked!=!!e.packedInputs)t=n.isPacked?i.unpackTensor(t):i.packTensor(t),c.push(t),n=i.texData.get(t.dataId);else if(n.isPacked&&!As(n.shape,t.shape)){var r=t,a=t.shape;t.shape=n.shape,t=i.packedReshape(t,a),c.push(t),n=i.texData.get(t.dataId),r.shape=a}return i.uploadToGPU(t.dataId),{shape:t.shape,texData:n,isUniform:!1}});this.uploadToGPU(o.dataId);var h,d={shape:o.shape,texData:s,isUniform:!1},f=function(e,t,n){var r="";t.concat(n).forEach(function(e){var t=null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0,n=e.isUniform?"uniform":e.texData.texShape;r+=e.shape+"_"+n+"_"+t});var a=e.userCode;return e.constructor.name+"_"+r+"_"+a}(e,u,d),p=this.getAndSaveBinary(f,function(){return function(e,t,n,r){var a=t.userCode,i=n.map(function(e,n){var r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}}),o=i.map(function(e){return e.shapeInfo}),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},l=Eu(i,s,a,t.packedInputs),c=e.createProgram(l),u=null,h=e.getUniformLocation(c,"NAN",!1);1===fi().getNumber("WEBGL_VERSION")&&(u=e.getUniformLocation(c,"INFINITY",!1));for(var d={},f=0;f<t.variableNames.length;f++){var p=t.variableNames[f];d[p]=e.getUniformLocation(c,p,!1),d["offset"+p]=e.getUniformLocation(c,"offset"+p,!1)}return{program:t,source:l,webGLProgram:c,uniformLocations:d,inShapeInfos:o,outShapeInfo:s,infLoc:u,nanLoc:h}}(i.gpgpu,e,u,d)}),g=null!=this.activeTimers;if(g&&(h=this.startTimer()),function(e,t,n,r,a){Kh(t.inShapeInfos,n),Kh([t.outShapeInfo],[r]);var i=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(i,o[0],o[1]):e.setOutputMatrixTexture(i,o[0],o[1]),e.setProgram(t.webGLProgram),1===fi().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN),n.forEach(function(n,r){var a=t.program.variableNames[r],i=t.uniformLocations[a],o=t.uniformLocations["offset"+a];if(null!=i)if(n.isUniform)if(Ai(n.shape)<2)e.gl.uniform1f(i,n.uniformValues[0]);else{var s=n.uniformValues;s instanceof Float32Array||(s=new Float32Array(s)),e.gl.uniform1fv(i,s)}else null!=n.texData.slice&&null!=o&&e.gl.uniform1i(o,n.texData.slice.flatOffset),e.setInputMatrixTexture(n.texData.texture,i,r)}),null!=a&&a(e,t.webGLProgram),e.executeProgram()}(this.gpgpu,p,u,d,r),c.forEach(function(e){return i.disposeData(e.dataId)}),g&&(h=this.endTimer(h),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(h)})),!fi().getBool("WEBGL_LAZILY_UNPACK")&&s.isPacked&&!1===a){var m=this.unpackTensor(o);return this.disposeData(o.dataId),m}return o},t.prototype.compileAndRun=function(e,t,n,r,a){void 0===a&&(a=!1),n=n||t[0].dtype;var i=this.runWebGLProgram(e,t,n,r,a);return Mo.makeTensorFromDataId(i.dataId,i.shape,i.dtype)},t.prototype.getAndSaveBinary=function(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){var e=this;this.disposed||(fi().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(t){e.gpgpu.deleteProgram(e.binaryCache[t].webGLProgram),delete e.binaryCache[t]}),this.textureManager.dispose(),null!=this.canvas&&"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var e=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=Vs(function(){if(!fi().get("WEBGL_RENDER_FLOAT32_ENABLED")){var t=fi().getBool("DEBUG");fi().set("DEBUG",!1);var n=e.abs(dl(1e-8)).dataSync()[0];if(fi().set("DEBUG",t),n>0)return 32}return 16})),this.floatPrecisionValue},t.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},t.prototype.uploadToGPU=function(e){var t,n=this.texData.get(e),r=n.shape,a=n.dtype,i=n.values,o=n.texture,s=n.usage,l=n.isPacked;if(null==o){var c,u=null!=this.activeTimers;u&&(c=io());var h=n.texShape;if(null==h&&(h=Is(r,l),n.texShape=h),null!=i){var d=_s(r),f=void 0,p=h[1],g=h[0],m=i instanceof Uint8Array;l?(p=(t=Yo(h[0],h[1]))[0],g=t[1],f=new Nh(d,[g,p],m)):f=new kh(d,[g,p],m);var v=this.makeTensorInfo([g,p],a);this.texData.get(v.dataId).usage=m?Wo.PIXELS:Wo.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(v.dataId),p,g,i);var b=this.runWebGLProgram(f,[v],a,null,!0),x=this.texData.get(b.dataId);n.texture=x.texture,n.texShape=x.texShape,n.isPacked=x.isPacked,n.usage=x.usage,this.disposeData(v.dataId),this.texData.delete(b.dataId),n.values=null,u&&(this.uploadWaitMs+=io()-c)}else{var y=this.acquireTexture(h,s,a,l);n.texture=y}}},t.prototype.convertAndCacheOnCPU=function(e,t){var n=this.texData.get(e),r=n.dtype;return this.releaseGPUData(e),null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){for(var n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length),r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}throw new Error("Unknown dtype "+t)}(t,r)),n.values},t.prototype.acquireTexture=function(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+a+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(e,t,r)},t.prototype.computeBytes=function(e,t){return e[0]*e[1]*qi(t)},t}(Lc);jo()&&Mo.registerBackend("webgl",function(){return new sf},2);var lf=ol({square_:function(e){var t=Xs(e,"x","square"),n=[t];return Mo.runKernelFunc(function(e,n){return n([t]),e.square(t)},{x:t},null,"Square",{},n,[])}}),cf="SquaredDifference",uf=ol({squaredDifference_:function(e,t){var n,r=Xs(e,"a","squaredDifference"),a=Xs(t,"b","squaredDifference");n=Ro(r,a),r=n[0],a=n[1],Bc(r.shape,a.shape);var i={a:r,b:a},o=[r,a];return Mo.runKernelFunc(function(e,t){var n=e.squaredDifference(r,a);return t([r,a]),n},i,function(e,t){var n=t[0],r=t[1],a=dl(2);return{a:function(){return e.mul(n.sub(r).mul(a))},b:function(){return e.mul(r.sub(n).mul(a))}}},cf,{},o,[])}}),hf=ol({abs_:function(e){var t=Xs(e,"x","abs");return"complex64"===t.dtype?Mo.runKernelFunc(function(e){return e.complexAbs(t)},{$x:t}):Mo.runKernelFunc(function(e,n){var r=e.abs(t);return n([t]),r},{x:t},function(e,t){var n=t[0];return{x:function(){return e.mul(n.toFloat().step(-1))}}},"Abs")}}),df=ol({acos_:function(e){var t=Xs(e,"x","acos");return Mo.runKernelFunc(function(e,n){var r=e.acos(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.divStrict(dl(1).sub(n.toFloat().square()).sqrt()).neg()}}})}}),ff=ol({acosh_:function(e){var t=Xs(e,"x","acosh");return Mo.runKernelFunc(function(e,n){var r=e.acosh(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.divStrict(n.toFloat().square().sub(1).sqrt())}}})}}),pf=ol({asin_:function(e){var t=Xs(e,"x","asin");return Mo.runKernelFunc(function(e,n){var r=e.asin(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.divStrict(dl(1).sub(n.toFloat().square()).sqrt())}}})}}),gf=ol({asinh_:function(e){var t=Xs(e,"x","asinh");return Mo.runKernelFunc(function(e,n){var r=e.asinh(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.divStrict(dl(1).add(n.toFloat().square()).sqrt())}}})}}),mf=ol({atan_:function(e){var t=Xs(e,"x","atan");return Mo.runKernelFunc(function(e,n){var r=e.atan(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.div(n.toFloat().square().add(1))}}})}}),vf=ol({atanh_:function(e){var t=Xs(e,"x","atanh");return Mo.runKernelFunc(function(e,n){var r=e.atanh(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.div(dl(1).sub(n.toFloat().square()))}}})}}),bf=ol({ceil_:function(e){var t=Xs(e,"x","ceil");return Mo.runKernelFunc(function(e){return e.ceil(t)},{$x:t},function(e){return{$x:function(){return kl(e)}}})}}),xf=ol({clipByValue_:function(e,t,n){var r=Xs(e,"x","clipByValue");Ei(t<=n,function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+n+")."});var a=[r],i={min:t,max:n};return Mo.runKernelFunc(function(e,a){var i=e.clip(r,t,n);return a([r]),i},{x:r},function(e,r){var a=r[0];return{x:function(){return e.where(a.greaterEqual(t).logicalAnd(a.lessEqual(n)),kl(e))}}},"ClipByValue",i,a)}}),yf=ol({cos_:function(e){var t=Xs(e,"x","cos"),n=[t];return Mo.runKernelFunc(function(e,n){var r=e.cos(t);return n([t]),r},{x:t},function(e,t){var n=t[0];return{x:function(){return n.toFloat().sin().neg().mul(e)}}},"Cos",{},n)}}),wf=ol({cosh_:function(e){var t=Xs(e,"x","cosh");return Mo.runKernelFunc(function(e,n){var r=e.cosh(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return n.toFloat().sinh().mulStrict(e)}}})}}),kf=ol({erf_:function(e){var t=Xs(e,"x","erf");return Ei("int32"===t.dtype||"float32"===t.dtype,function(){return"Input dtype must be `int32` or `float32`."}),"int32"===t.dtype&&(t=t.toFloat()),Mo.runKernelFunc(function(e,n){var r=e.erf(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.mul(n.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),Nf=ol({exp_:function(e){var t=Xs(e,"x","exp");return Mo.runKernelFunc(function(e,n){var r=e.exp(t);return n([r]),r},{x:t},function(e,t){return{x:function(){return e.mulStrict(t[0])}}},"Exp",{},[],[!0])}}),Sf=ol({expm1_:function(e){var t=Xs(e,"x","expm1");return Mo.runKernelFunc(function(e,n){var r=e.expm1(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.mul(n.exp())}}})}}),Cf=ol({floor_:function(e){var t=Xs(e,"x","floor");return Mo.runKernelFunc(function(e){return e.floor(t)},{$x:t},function(e){return{$x:function(){return kl(e)}}})}}),Ef=ol({log_:function(e){var t=Xs(e,"x","log"),n=[t];return Mo.runKernelFunc(function(e,n){var r=e.log(t);return n([t]),r},{x:t},function(e,t){var n=t[0];return{x:function(){return e.div(n.toFloat())}}},"Log",{},n)}}),_f=ol({log1p_:function(e){var t=Xs(e,"x","log1p");return Mo.runKernelFunc(function(e,n){var r=e.log1p(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.div(n.add(1))}}})}}),If=ol({logSigmoid_:function(e){var t=Xs(e,"x","logSigmoid");return Mo.runKernelFunc(function(e,n){var r=e.softplus(t.neg()).neg();return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.mul(n.neg().sigmoid())}}})}}),Tf=ol({neg_:function(e){var t=Xs(e,"x","neg"),n=[t];return Mo.runKernelFunc(function(e){return e.neg(t)},{x:t},function(e){return{x:function(){return e.neg()}}},"Neg",{},n)}}),Af=ol({reciprocal_:function(e){var t=Xs(e,"x","reciprocal");return Mo.runKernelFunc(function(e,n){var r=e.reciprocal(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.div(n.square().neg())}}})}}),Rf=ol({round_:function(e){var t=Xs(e,"x","round");return Mo.runKernelFunc(function(e){return e.round(t)},{$x:t},function(e){return{$x:function(){return kl(e)}}})}}),Df=ol({rsqrt_:function(e){var t=Xs(e,"x","rsqrt"),n=[t];return Mo.runKernelFunc(function(e,n){var r=e.rsqrt(t);return n([t]),r},{x:t},function(e,t){var n=t[0];return{x:function(){return e.div(n.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},n)}}),Ff=ol({sigmoid_:function(e){var t=Xs(e,"x","sigmoid");return Mo.runKernelFunc(function(e,n){var r=e.sigmoid(t);return n([r]),r},{x:t},function(e,t){var n=t[0];return{x:function(){return e.mul(n.mul(dl(1).sub(n)))}}},"Sigmoid")}}),Of=ol({sign_:function(e){var t=Xs(e,"x","sign");return Mo.runKernelFunc(function(e){return e.sign(t)},{$x:t},function(e){return{$x:function(){return kl(e)}}})}}),Lf=ol({isNaN_:function(e){var t=Xs(e,"x","isNaN");return Mo.runKernelFunc(function(e){return e.isNaN(t)},{$x:t},function(e){return{$x:function(){return kl(e)}}})}}),Pf=ol({isInf_:function(e){var t=Xs(e,"x","isInf");return Mo.runKernelFunc(function(e){return e.isInf(t)},{$x:t},function(e){return{$x:function(){return kl(e)}}})}}),Mf=ol({isFinite_:function(e){var t=Xs(e,"x","isFinite");return Mo.runKernelFunc(function(e){return e.isFinite(t)},{$x:t},function(e){return{$x:function(){return kl(e)}}})}}),jf=ol({sin_:function(e){var t=Xs(e,"x","sin"),n=[t];return Mo.runKernelFunc(function(e,n){var r=e.sin(t);return n([t]),r},{x:t},function(e,t){var n=t[0];return{x:function(){return n.toFloat().cos().mul(e)}}},"Sin",{},n)}}),Bf=ol({sinh_:function(e){var t=Xs(e,"x","sinh");return Mo.runKernelFunc(function(e,n){var r=e.sinh(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return n.toFloat().cosh().mulStrict(e)}}})}}),zf=ol({softplus_:function(e){var t=Xs(e,"x","softplus");return Mo.runKernelFunc(function(e,n){var r=e.softplus(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.mul(n.sigmoid())}}})}}),Wf=ol({sqrt_:function(e){var t=Xs(e,"x","sqrt");return Mo.runKernelFunc(function(e,n){var r=e.sqrt(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.div(n.toFloat().sqrt().mul(2))}}})}}),Uf=ol({step_:function(e,t){void 0===t&&(t=0);var n=Xs(e,"x","step");return Mo.runKernelFunc(function(e){return e.step(n,t)},{$x:n},function(e){return{$x:function(){return kl(e)}}})}}),Vf=ol({tan_:function(e){var t=Xs(e,"x","tan");return Mo.runKernelFunc(function(e,n){var r=e.tan(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return e.div(n.cos().square())}}})}}),Hf=ol({tanh_:function(e){var t=Xs(e,"x","tanh");return Mo.runKernelFunc(function(e,n){var r=e.tanh(t);return n([r]),r},{x:t},function(e,t){var n=t[0];return{x:function(){return dl(1).sub(n.square()).mulStrict(e)}}},"Tanh",{},null,[!0])}});function Gf(e,t,n,r,a,i){var o,s,l=Xs(e,"x","batchNorm"),c=Xs(t,"mean","batchNorm"),u=Xs(n,"variance","batchNorm");return null!=a&&(o=Xs(a,"scale","batchNorm")),null!=r&&(s=Xs(r,"offset","batchNorm")),Ei(2===l.rank,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+l.rank+"."}),Ei(2===c.rank||1===c.rank,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+c.rank+"."}),Ei(2===u.rank||1===u.rank,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+u.rank+"."}),null!=o&&Ei(2===o.rank||1===o.rank,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+o.rank+"."}),null!=s&&Ei(2===s.rank||1===s.rank,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."}),Xf(l,c,u,s,o,i)}function qf(e,t,n,r,a,i){var o,s,l=Xs(e,"x","batchNorm"),c=Xs(t,"mean","batchNorm"),u=Xs(n,"variance","batchNorm");return null!=a&&(o=Xs(a,"scale","batchNorm")),null!=r&&(s=Xs(r,"offset","batchNorm")),Ei(3===l.rank,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+l.rank+"."}),Ei(3===c.rank||1===c.rank,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+c.rank+"."}),Ei(3===u.rank||1===u.rank,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+u.rank+"."}),null!=o&&Ei(3===o.rank||1===o.rank,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+o.rank+"."}),null!=s&&Ei(3===s.rank||1===s.rank,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."}),Xf(l,c,u,s,o,i)}function Kf(e,t,n,r,a,i){var o,s,l=Xs(e,"x","batchNorm"),c=Xs(t,"mean","batchNorm"),u=Xs(n,"variance","batchNorm");return null!=a&&(o=Xs(a,"scale","batchNorm")),null!=r&&(s=Xs(r,"offset","batchNorm")),Ei(4===l.rank,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+l.rank+"."}),Ei(4===c.rank||1===c.rank,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+c.rank+"."}),Ei(4===u.rank||1===u.rank,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+u.rank+"."}),null!=o&&Ei(4===o.rank||1===o.rank,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+o.rank+"."}),null!=s&&Ei(4===s.rank||1===s.rank,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."}),Xf(l,c,u,s,o,i)}function Xf(e,t,n,r,a,i){null==i&&(i=.001);var o,s,l,c=Xs(e,"x","batchNorm"),u=Xs(t,"mean","batchNorm"),h=Xs(n,"variance","batchNorm");null!=a&&(o=Xs(a,"scale","batchNorm")),null!=r&&(s=Xs(r,"offset","batchNorm")),Ei(u.rank===h.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),Ei(null==s||u.rank===s.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),Ei(null==o||u.rank===o.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),l=0===c.rank||1===c.rank?c.as4D(1,1,1,c.size):2===c.rank?c.as4D(1,1,c.shape[0],c.shape[1]):3===c.rank?c.as4D(1,c.shape[0],c.shape[1],c.shape[2]):c;var d=[c,u,h,o];return Mo.runKernelFunc(function(e,t){var n=e.batchNormalization(l,Yf(u),Yf(h),i,Yf(o),Yf(s));return t([c,u,h,o]),n},{x:c,mean:u,variance:h,scale:o,offset:s},function(e,t){var n=t,r=n[0],a=n[1],o=n[2],s=n[3],c=null==s?dl(1):s,u=jc(a.shape,l.shape),h=[];if(1===a.rank){for(var d=0;d<l.shape.length-1;++d)h.push(l.shape[d]);h.push(1)}var f=r.sub(a),p=e.mul(c),g=Df(o.add(dl(i))),m=g.mul(g).mul(g).mul(dl(-.5));return{x:function(){return 1===a.rank?e.mul(hc(g.as4D(1,1,1,a.shape[0]),h)).mul(c).reshape(r.shape):e.mul(g).mul(c).reshape(r.shape)},mean:function(){var e=g.mul(dl(-1)).mul(p);return 1===a.rank&&(e=e.sum(u)),e.reshape(a.shape)},variance:function(){var e=m.mul(f).mul(p);return 1===a.rank&&(e=e.sum(u)),e.reshape(a.shape)},scale:function(){var t=f.mul(g),n=e.mul(t);return 1===a.rank&&(n=n.sum(u)),n.reshape(a.shape)},offset:function(){var t=e;return 1===a.rank&&(t=t.sum(u)),t.reshape(a.shape)}}},"BatchNormalization",{varianceEpsilon:i},d).reshape(c.shape)}function Yf(e){return null==e?null:0===e.rank?e.as1D():1===e.rank?e:2===e.rank?e.as4D(1,1,e.shape[0],e.shape[1]):3===e.rank?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}function $f(){Us("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var Jf=ol({batchNormalization2d_:function(e,t,n,r,a,i){return void 0===r&&(r=.001),$f(),Gf(e,t,n,i,a,r)}}),Qf=ol({batchNormalization3d_:function(e,t,n,r,a,i){return void 0===r&&(r=.001),$f(),qf(e,t,n,i,a,r)}}),Zf=ol({batchNormalization4d_:function(e,t,n,r,a,i){return void 0===r&&(r=.001),$f(),Kf(e,t,n,i,a,r)}}),ep=ol({batchNormalization_:function(e,t,n,r,a,i){return void 0===r&&(r=.001),$f(),Xf(e,t,n,i,a,r)}}),tp=ol({batchNorm_:Xf}),np=ol({batchNorm2d_:Gf}),rp=ol({batchNorm3d_:qf}),ap=ol({batchNorm4d_:Kf}),ip=ol({logicalAnd_:function(e,t){var n=Xs(e,"a","logicalAnd","bool"),r=Xs(t,"b","logicalAnd","bool");return Bc(n.shape,r.shape),Mo.runKernelFunc(function(e){return e.logicalAnd(n,r)},{a:n,b:r},null,"LogicalAnd")}}),op=ol({logicalNot_:function(e){var t=Xs(e,"x","logicalNot","bool");return Mo.runKernelFunc(function(e){return e.logicalNot(t)},{$x:t})}}),sp=ol({logicalOr_:function(e,t){var n=Xs(e,"a","logicalOr","bool"),r=Xs(t,"b","logicalOr","bool");return Bc(n.shape,r.shape),Mo.runKernelFunc(function(e){return e.logicalOr(n,r)},{$a:n,$b:r})}}),lp=ol({logicalXor_:function(e,t){var n=Xs(e,"a","logicalXor","bool"),r=Xs(t,"b","logicalXor","bool");return Bc(n.shape,r.shape),sp(e,t).logicalAnd(ip(e,t).logicalNot())}}),cp=ol({where_:function(e,t,n){var r=Xs(t,"a","where"),a=Xs(n,"b","where"),i=Xs(e,"condition","where","bool");return _i(r.shape,a.shape,"Error in where: "),1===i.rank?Ei(i.shape[0]===r.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):_i(i.shape,a.shape,"Error in where: "),Mo.runKernelFunc(function(e,t){var n=e.select(i,r,a);return t([i]),n},{$condition:i,$a:r,$b:a},function(e,t){var n=t[0];return{$condition:function(){return kl(n).toFloat()},$a:function(){return e.mul(n.cast(e.dtype))},$b:function(){return e.mul(n.logicalNot().cast(e.dtype))}}})}}),up=function(e){return ui(this,void 0,void 0,function(){var t,n,r;return hi(this,function(a){switch(a.label){case 0:return[4,(t=Xs(e,"condition","whereAsync","bool")).data()];case 1:return n=a.sent(),r=mu(t.shape,n),e!==t&&t.dispose(),[2,r]}})})},hp=ol({add_:function(e,t){var n,r=Xs(e,"a","add"),a=Xs(t,"b","add");n=Ro(r,a),r=n[0],a=n[1];var i=Bc(r.shape,a.shape);return Mo.runKernelFunc(function(e){return e.add(r,a)},{a:r,b:a},function(e){return{a:function(){var t=e,n=jc(r.shape,i);return n.length>0&&(t=t.sum(n)),t.reshape(r.shape)},b:function(){var t=e,n=jc(a.shape,i);return n.length>0&&(t=t.sum(n)),t.reshape(a.shape)}}},"Add")}}),dp=ol({addN_:function(e){Ei(Array.isArray(e),function(){return"The argument passed to tf.addN() must be a list of tensors"}),Ei(e.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+e.length});var t=e.map(function(e,t){return Xs(e,"tensors"+t,"addN")}),n=t[0];t.forEach(function(e){if(e.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(function(e){if(!Ri(e.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var r=t;return Mo.runKernelFunc(function(e){return e.addN(t)},r,function(e){var n={};return t.forEach(function(t,r){n[r]=function(){return e.clone()}}),n},"AddN")}}),fp=ol({addStrict_:function(e,t){var n=Xs(e,"a","addStrict"),r=Xs(t,"b","addStrict");return _i(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),pp=ol({atan2_:function(e,t){var n,r=Xs(e,"a","atan2"),a=Xs(t,"b","atan2");n=Ro(r,a),r=n[0],a=n[1];var i=Bc(r.shape,a.shape);return Mo.runKernelFunc(function(e,t){var n=e.atan2(r,a);return t([r,a]),n},{$a:r,$b:a},function(e,t){var n=t[0],r=t[1];return{$a:function(){var t=hp(n.square(),r.square()),a=e.mul(r.div(t)),o=jc(n.shape,i);return o.length>0&&(a=a.sum(o)),a.reshape(n.shape)},$b:function(){var t=hp(n.square(),r.square()),a=Tf(e.mul(n.div(t))),o=jc(r.shape,i);return o.length>0&&(a=a.sum(o)),a.reshape(r.shape)}}})}}),gp=ol({div_:function(e,t){var n,r=Xs(e,"a","div"),a=Xs(t,"b","div");if(n=Ro(r,a),r=n[0],a=n[1],"int32"===r.dtype&&"int32"===a.dtype)return bp(r,a);var i=Bc(r.shape,a.shape);return Mo.runKernelFunc(function(e,t){var n=e.realDivide(r,a);return t([r,a]),n},{a:r,b:a},function(e,t){var n=t[0],r=t[1];return{a:function(){var t=e.div(r.toFloat()),a=jc(n.shape,i);return a.length>0?t.sum(a).reshape(n.shape):t},b:function(){var t=e.mul(n.toFloat()),a=jc(r.shape,i);a.length>0&&(t=t.sum(a).reshape(r.shape));var o=r.square();return t.div(o.toFloat()).neg()}}},"Div")}}),mp=ol({divNoNan_:function(e,t){var n,r=Xs(e,"a","div"),a=Xs(t,"b","div");r=(n=Ro(r,a))[0],a=n[1];var i=gp(r,a),o=kl(i),s=a.equal(o);return cp(s,o,i)}}),vp=ol({divStrict_:function(e,t){var n=Xs(e,"a","div"),r=Xs(t,"b","div");return _i(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),bp=ol({floorDiv_:function(e,t){var n,r=Xs(e,"a","floorDiv"),a=Xs(t,"b","floorDiv");n=Ro(r,a),r=n[0],a=n[1];var i=Bc(r.shape,a.shape);return Mo.runKernelFunc(function(e,t){var n=e.floorDiv(r,a);return t([r,a]),n},{a:r,b:a},function(e,t){var n=t[0],r=t[1];return{a:function(){var t=e.div(r.toFloat()),a=jc(n.shape,i);return a.length>0?t.sum(a).reshape(n.shape):t},b:function(){var t=e.mul(n.toFloat()),a=jc(r.shape,i);a.length>0&&(t=t.sum(a).reshape(r.shape));var o=r.square();return t.div(o.toFloat()).neg()}}},"FloorDiv")}}),xp=ol({maximum_:function(e,t){var n,r=Xs(e,"a","maximum"),a=Xs(t,"b","maximum");return n=Ro(r,a),r=n[0],a=n[1],"bool"===r.dtype&&(r=r.toInt(),a=a.toInt()),Bc(r.shape,a.shape),Mo.runKernelFunc(function(e,t){var n=e.maximum(r,a);return t([r,a]),n},{a:r,b:a},function(e,t){var n=t[0],r=t[1];return{a:function(){return e.mul(n.greaterEqual(r).toFloat())},b:function(){return e.mul(n.less(r).toFloat())}}},"Maximum")}}),yp=ol({maximumStrict_:function(e,t){var n=Xs(e,"a","maximumStrict"),r=Xs(t,"b","maximumStrict");return _i(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),wp=ol({minimum_:function(e,t){var n,r=Xs(e,"a","minimum"),a=Xs(t,"b","minimum");return n=Ro(r,a),r=n[0],a=n[1],"bool"===r.dtype&&(r=r.toInt(),a=a.toInt()),Bc(r.shape,a.shape),Mo.runKernelFunc(function(e,t){var n=e.minimum(r,a);return t([r,a]),n},{a:r,b:a},function(e,t){var n=t[0],r=t[1];return{a:function(){return e.mul(n.lessEqual(r).toFloat())},b:function(){return e.mul(n.greater(r).toFloat())}}},"Minimum")}}),kp=ol({minimumStrict_:function(e,t){var n=Xs(e,"a","minimumStrict"),r=Xs(t,"b","minimumStrict");return _i(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),Np=ol({mod_:function(e,t){var n,r=Xs(e,"a","mod"),a=Xs(t,"b","mod");n=Ro(r,a),r=n[0],a=n[1];var i=Bc(r.shape,a.shape);return Mo.runKernelFunc(function(e,t){var n=e.mod(r,a);return t([r,a]),n},{$a:r,$b:a},function(e,t){var n=t[0],r=t[1];return{$a:function(){var t=jc(n.shape,i);return t.length>0?e.sum(t).reshape(n.shape):e},$b:function(){var t=e.mul(n.div(r).floor().neg()),a=jc(r.shape,i);return a.length>0?t.sum(a).reshape(r.shape):t}}})}}),Sp=ol({modStrict_:function(e,t){var n=Xs(e,"a","modStrict"),r=Xs(t,"b","modStrict");return _i(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),Cp=ol({mul_:function(e,t){var n,r=Xs(e,"a","mul"),a=Xs(t,"b","mul");n=Ro(r,a),r=n[0],a=n[1];var i=Bc(r.shape,a.shape);return Mo.runKernelFunc(function(e,t){var n=e.multiply(r,a);return t([r,a]),n},{a:r,b:a},function(e,t){var n=t[0],r=t[1];return{a:function(){var t=e.mul(r.toFloat()),a=jc(n.shape,i);return a.length>0?t.sum(a).reshape(n.shape):t},b:function(){var t=e.mul(n.toFloat()),a=jc(r.shape,i);return a.length>0?t.sum(a).reshape(r.shape):t}}},"Mul")}}),Ep=ol({mulStrict_:function(e,t){var n=Xs(e,"a","mul"),r=Xs(t,"b","mul");return _i(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),_p=ol({pow_:function(e,t){var n,r=Xs(e,"base","pow"),a=Xs(t,"exp","pow");n=Ro(r,a),r=n[0],a=n[1];var i=Bc(r.shape,a.shape),o=[r,a];return Mo.runKernelFunc(function(e,t){var n=e.pow(r,a);return t([r,a,n]),n},{a:r,b:a},function(e,t){var n=t[0],r=t[1],a=t[2];return{a:function(){var t=r.toFloat(),a=e.mul(t.mul(n.pow(t.sub(dl(1))))),o=jc(n.shape,i);return o.length>0&&(a=a.sum(o)),a.reshape(n.shape)},b:function(){var t=n.greater(0),o=n.log().where(t,kl(n)),s=e.mul(a.mul(o)),l=jc(r.shape,i);return l.length>0&&(s=s.sum(l)),s.reshape(r.shape)}}},"Pow",{},o,[!0])}}),Ip=ol({powStrict_:function(e,t){return _i(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}}),Tp=ol({squaredDifferenceStrict_:function(e,t){var n=Xs(e,"a","squaredDifferenceStrict"),r=Xs(t,"b","squaredDifferenceStrict");return _i(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),Ap=ol({sub_:function(e,t){var n,r=Xs(e,"a","sub"),a=Xs(t,"b","sub");n=Ro(r,a),r=n[0],a=n[1];var i=Bc(r.shape,a.shape);return Mo.runKernelFunc(function(e){return e.subtract(r,a)},{a:r,b:a},function(e){return{a:function(){var t=e,n=jc(r.shape,i);return n.length>0&&(t=t.sum(n)),t.reshape(r.shape)},b:function(){var t=e,n=jc(a.shape,i);return n.length>0&&(t=t.sum(n)),t.neg().reshape(a.shape)}}},"Sub")}}),Rp=ol({subStrict_:function(e,t){var n=Xs(e,"a","subStrict"),r=Xs(t,"b","subStrict");return _i(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),Dp=ol({equal_:function(e,t){var n,r=Xs(e,"a","equal"),a=Xs(t,"b","equal");return n=Ro(r,a),r=n[0],a=n[1],Bc(r.shape,a.shape),Mo.runKernelFunc(function(e){return e.equal(r,a)},{$a:r,$b:a})}}),Fp=ol({equalStrict_:function(e,t){var n=Xs(e,"a","equalStrict"),r=Xs(t,"b","equalStrict");return _i(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),Op=ol({greater_:function(e,t){var n,r=Xs(e,"a","greater"),a=Xs(t,"b","greater");return n=Ro(r,a),r=n[0],a=n[1],Bc(r.shape,a.shape),Mo.runKernelFunc(function(e){return e.greater(r,a)},{a:r,b:a},null,"Greater")}}),Lp=ol({greaterEqual_:function(e,t){var n,r=Xs(e,"a","greaterEqual"),a=Xs(t,"b","greaterEqual");return n=Ro(r,a),r=n[0],a=n[1],Bc(r.shape,a.shape),Mo.runKernelFunc(function(e,t){var n=e.greaterEqual(r,a);return t([r,a]),n},{a:r,b:a},function(e,t){var n=t[0],r=t[1];return{a:function(){return kl(n)},b:function(){return kl(r)}}},"GreaterEqual")}}),Pp=ol({greaterEqualStrict_:function(e,t){var n=Xs(e,"a","greaterEqualStrict"),r=Xs(t,"b","greaterEqualStrict");return _i(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),Mp=ol({greaterStrict_:function(e,t){var n=Xs(e,"a","greaterStrict"),r=Xs(t,"b","greaterStrict");return _i(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),jp=ol({less_:function(e,t){var n,r=Xs(e,"a","less"),a=Xs(t,"b","less");return n=Ro(r,a),r=n[0],a=n[1],Bc(r.shape,a.shape),Mo.runKernelFunc(function(e){return e.less(r,a)},{a:r,b:a},null,"Less")}}),Bp=ol({lessEqual_:function(e,t){var n,r=Xs(e,"a","lessEqual"),a=Xs(t,"b","lessEqual");return n=Ro(r,a),r=n[0],a=n[1],Bc(r.shape,a.shape),Mo.runKernelFunc(function(e,t){var n=e.lessEqual(r,a);return t([r,a]),n},{a:r,b:a},null,"LessEqual")}}),zp=ol({lessEqualStrict_:function(e,t){var n=Xs(e,"a","lessEqualStrict"),r=Xs(t,"b","lessEqualStrict");return _i(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),Wp=ol({lessStrict_:function(e,t){var n=Xs(e,"a","lessStrict"),r=Xs(t,"b","lessStrict");return _i(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),Up=ol({notEqual_:function(e,t){var n,r=Xs(e,"a","notEqual"),a=Xs(t,"b","notEqual");return n=Ro(r,a),r=n[0],a=n[1],Bc(r.shape,a.shape),Mo.runKernelFunc(function(e){return e.notEqual(r,a)},{a:r,b:a},null,"NotEqual")}}),Vp=ol({notEqualStrict_:function(e,t){var n=Xs(e,"a","notEqualStrict"),r=Xs(t,"b","notEqualStrict");return _i(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function Hp(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function Gp(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var qp=ol({gather_:function(e,t,n){void 0===n&&(n=0);var r=Xs(e,"x","gather"),a=Xs(t,"indices","gather","int32");n=ji(n,r.shape)[0];var i=function(e,t,n){for(var r=e.shape[n],a=[],i=1,o=1,s=0;s<n;s++)a.push(e.shape[s]),i*=e.shape[s];for(s=0;s<t.rank;s++)a.push(t.shape[s]);for(s=n+1;s<e.rank;s++)a.push(e.shape[s]),o*=e.shape[s];return{batchSize:i,sliceSize:o,dimSize:r,outputShape:a}}(r,a,n);return Mo.runKernelFunc(function(e,t){var i=e.gather(r,a.flatten(),n);return t([a]),i},{x:r,indices:a},function(e,t){var a=t[0];return{x:function(){var t=r.shape,i=a.size,o=t.slice(0,n),s=o.length,l=t.slice(n,t.length).slice(1),c=l.length,u=Hp(0,s),h=Hp(s+1,s+1+c),d=Gp([o,[i],l]),f=e.reshape(d),p=a.reshape([i]),g=Gp([[s],u,h]),m=f.transpose(g),v=Kp(m,p,r.shape[n]),b=nl(g);return v.transpose(b)},indices:function(){return a}}},"Gather",{axis:n}).reshape(i.outputShape)}}),Kp=ol({unsortedSegmentSum_:function(e,t,n){var r=Xs(e,"x","unsortedSegmentSum"),a=Xs(t,"segmentIds","unsortedSegmentSum","int32");return Ei(Di(n),function(){return"numSegments must be of dtype int"}),Mo.runKernelFunc(function(e,t){var i=e.unsortedSegmentSum(r,a,n);return t([a]),i},{$x:r},function(e,t){var n=t[0];return{$x:function(){return function(e,t){for(var n=xp(t,kl(t)),r=qp(e,n),a=Lp(t,dl(0,"int32")),i=r.rank-a.rank,o=0;o<i;++o)a=Xl(a,o+1);a=ip(a,vl(r.shape,"bool"));var s=kl(r);return cp(a,r,s)}(e,n)}}})}});function Xp(e,t,n,r,a,i,o){void 0===i&&(i="NHWC"),Ei(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var s=e,l=t,c=!1;3===t.rank&&(c=!0,l=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),s=[1,e[0],e[1],e[2]]),Ei(4===s.length,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."}),Ei(4===l.rank,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+l.rank}),Ei(4===n.rank,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank});var u="NHWC"===i?s[3]:s[1],h="NHWC"===i?l.shape[3]:l.shape[1];Ei(u===n.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[2]+"."}),Ei(h===n.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+h+") must match output depth for filter "+n.shape[3]+"."}),null!=o&&Ei(Di(a),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+a+"."});var d=Jc(i),f=Uc(s,n.shape,r,1,a,o,!1,d),p=Mo.runKernelFunc(function(e,t){var r=e.conv2dDerInput(l,n,f);return t([n,l]),r},{dy4D:l,filter:n},function(e,t){var n=t[0],s=t[1];return{dy4D:function(){return Qp(e,n,r,a,i,1,o)},filter:function(){return eg(e,s,n.shape,r,a,i,o)}}});return c?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}function Yp(e){var t=function(e){return"number"==typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}(e),n=t[0],r=t[1],a=t[2];return 1===n&&1===r&&1===a}function $p(e,t,n,r,a){Ei(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var i=e,o=t,s=!1;4===t.rank&&(s=!0,o=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),i=[1,e[0],e[1],e[2],e[3]]);var l=i[4],c=o.shape[4];Ei(5===i.length,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."}),Ei(5===o.rank,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+o.rank}),Ei(5===n.rank,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank}),Ei(l===n.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+l+") must match input depth for filter "+n.shape[3]+"."}),Ei(c===n.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+c+") must match output depth for filter "+n.shape[4]+"."});var u=Vc(i,n.shape,r,1,a),h=Mo.runKernelFunc(function(e){return e.conv3dDerInput(o,n,u)},{dy5D:o});return s?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}var Jp=ol({conv1d_:function(e,t,n,r,a,i,o){void 0===a&&(a="NWC"),void 0===i&&(i=1);var s=Xs(e,"x","conv1d"),l=Xs(t,"filter","conv1d"),c=s,u=!1;2===s.rank&&(u=!0,c=s.as3D(1,s.shape[0],s.shape[1])),Ei(3===c.rank,function(){return"Error in conv1d: input must be rank 3, but got rank "+c.rank+"."}),Ei(3===l.rank,function(){return"Error in conv1d: filter must be rank 3, but got rank "+l.rank+"."}),null!=o&&Ei(Di(r),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."}),Ei(c.shape[2]===l.shape[1],function(){return"Error in conv1d: depth of input ("+c.shape[2]+") must match input depth for filter "+l.shape[1]+"."}),Ei($c(n,i),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+i+"'"}),Ei("NWC"===a,function(){return"Error in conv1d: got dataFormat of "+a+" but only NWC is currently supported."});var h=l.as4D(1,l.shape[0],l.shape[1],l.shape[2]),d=c.as4D(c.shape[0],1,c.shape[1],c.shape[2]),f=Qp(d,h,[1,n],r,"NHWC",[1,i],o);return u?f.as2D(f.shape[2],f.shape[3]):f.as3D(f.shape[0],f.shape[2],f.shape[3])}}),Qp=ol({conv2d_:function(e,t,n,r,a,i,o){void 0===a&&(a="NHWC"),void 0===i&&(i=[1,1]);var s=Xs(e,"x","conv2d"),l=Xs(t,"filter","conv2d"),c=s,u=!1;3===s.rank&&(u=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),Ei(4===c.rank,function(){return"Error in conv2d: input must be rank 4, but got rank "+c.rank+"."}),Ei(4===l.rank,function(){return"Error in conv2d: filter must be rank 4, but got rank "+l.rank+"."}),null!=o&&Ei(Di(r),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var h="NHWC"===a?c.shape[3]:c.shape[1];Ei(h===l.shape[2],function(){return"Error in conv2d: depth of input ("+h+") must match input depth for filter "+l.shape[2]+"."}),Ei($c(n,i),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"});var d=Jc(a),f=Uc(c.shape,l.shape,n,i,r,o,!1,d),p=[l,c],g=Mo.runKernelFunc(function(e,t){var n=e.conv2d(c,l,f);return t([l,c]),n},{x:c,filter:l},function(e,t){var o=t,s=o[0],l=o[1];return Ei(Yc(i),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"}),{x:function(){return tg(l.shape,e,s,n,r,a)},filter:function(){return eg(l,e,s.shape,n,r,a)}}},"Conv2D",f,p);return u?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}}),Zp=ol({conv3d_:function(e,t,n,r,a,i){void 0===a&&(a="NDHWC"),void 0===i&&(i=[1,1,1]);var o=Xs(e,"x","conv3d"),s=Xs(t,"filter","conv3d"),l=o,c=!1;4===o.rank&&(c=!0,l=o.as5D(1,o.shape[0],o.shape[1],o.shape[2],o.shape[3])),Ei(5===l.rank,function(){return"Error in conv3d: input must be rank 5, but got rank "+l.rank+"."}),Ei(5===s.rank,function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."}),Ei(l.shape[4]===s.shape[3],function(){return"Error in conv3d: depth of input ("+l.shape[4]+") must match input depth for filter "+s.shape[3]+"."}),Ei(function(e,t){return Yp(e)||Yp(t)}(n,i),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}),Ei("NDHWC"===a,function(){return"Error in conv3d: got dataFormat of "+a+" but only NDHWC is currently supported."});var u=Vc(l.shape,s.shape,n,i,r),h=Mo.runKernelFunc(function(e,t){var n=e.conv3d(l,s,u);return t([l,s]),n},{x:l,$filter:s},function(e,t){Ei(Yp(i),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"});var a=t[0],o=t[1];return{x:function(){return $p(a.shape,e,o,n,r)},$filter:function(){return function(e,t,n,r,a){var i=e;4===e.rank&&(i=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]));var o=t;4===o.rank&&(o=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3])),Ei(5===i.rank,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+i.shape+"."}),Ei(5===o.rank,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+o.shape+"."}),Ei(5===n.length,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+n+"."}),Ei(i.shape[4]===n[3],function(){return"Error in conv3dDerFilter: depth of input "+i.shape[4]+") must match input depth in filter ("+n[3]+"."}),Ei(o.shape[4]===n[4],function(){return"Error in conv3dDerFilter: depth of dy ("+o.shape[4]+") must match output depth for filter ("+n[4]+")."});var s=Vc(i.shape,n,r,1,a);return Mo.runKernelFunc(function(e){return e.conv3dDerFilter(i,o,s)},{x5D:i,dy5D:o})}(a,e,o.shape,n,r)}}});return c?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),eg=ol({conv2dDerFilter_:function(e,t,n,r,a,i,o){void 0===i&&(i="NHWC");var s=e;3===e.rank&&(s=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var l=t;3===l.rank&&(l=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),Ei(4===s.rank,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."}),Ei(4===l.rank,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+l.shape+"."}),Ei(4===n.length,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."});var c="NHWC"===i?s.shape[3]:s.shape[1],u="NHWC"===i?l.shape[3]:l.shape[1];Ei(c===n[2],function(){return"Error in conv2dDerFilter: depth of input "+c+") must match input depth in filter ("+n[2]+"."}),Ei(u===n[3],function(){return"Error in conv2dDerFilter: depth of dy ("+u+") must match output depth for filter ("+n[3]+")."}),null!=o&&Ei(Di(a),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+a+"."});var h=Jc(i),d=Uc(s.shape,n,r,1,a,o,!1,h);return Mo.runKernelFunc(function(e){return e.conv2dDerFilter(s,l,d)},{x4D:s,dy4D:l})}}),tg=ol({conv2dDerInput_:Xp}),ng=ol({depthwiseConv2d_:function(e,t,n,r,a,i,o){void 0===a&&(a="NHWC"),void 0===i&&(i=[1,1]);var s=Xs(e,"x","depthwiseConv2d"),l=Xs(t,"filter","depthwiseConv2d"),c=s,u=!1;3===s.rank&&(u=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),Ei(4===c.rank,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+c.rank+"."}),Ei(4===l.rank,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+l.rank+"."}),Ei(c.shape[3]===l.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+c.shape[3]+") must match the inChannels dimension in filter "+l.shape[2]+"."}),null==i&&(i=[1,1]),Ei($c(n,i),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}),null!=o&&Ei(Di(r),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var h=Uc(c.shape,l.shape,n,i,r,o,!0),d=[c,l],f=Mo.runKernelFunc(function(e,t){var n=e.depthwiseConv2D(c,l,h);return t([c,l]),n},{x:c,filter:l},function(e,t){Ei(Yc(i),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"});var n=t[0],r=t[1];return{x:function(){return rg(n.shape,e,r,h)},filter:function(){return ag(n,e,r.shape,h)}}},"DepthwiseConv2dNative",h,d);return u?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}}),rg=ol({depthwiseConv2dDerInput_:function(e,t,n,r){var a=t,i=!1;3===t.rank&&(i=!0,a=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var o=Mo.runKernelFunc(function(e){return e.depthwiseConv2DDerInput(a,n,r)},{dy4D:a});return i?o.as3D(o.shape[1],o.shape[2],o.shape[3]):o}}),ag=ol({depthwiseConv2dDerFilter_:function(e,t,n,r){var a=e;3===e.rank&&(a=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var i=t;return 3===i.rank&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),Mo.runKernelFunc(function(e){return e.depthwiseConv2DDerFilter(a,i,r)},{x4D:a,dy4D:i})}}),ig=ol({separableConv2d_:function(e,t,n,r,a,i,o){void 0===i&&(i=[1,1]),void 0===o&&(o="NHWC");var s=Xs(e,"x","separableConv2d"),l=Xs(t,"depthwiseFilter","separableConv2d"),c=Xs(n,"pointwiseFilter","separableConv2d"),u=s,h=!1;if(3===s.rank&&(h=!0,u=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),"NCHW"===o)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");Ei(4===u.rank,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+u.rank+"."}),Ei(4===l.rank,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+l.rank+"."}),Ei(4===c.rank,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+l.rank+"."}),Ei(1===c.shape[0],function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+c.shape[0]+"."}),Ei(1===c.shape[1],function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+c.shape[1]+"."});var d=l.shape[2],f=l.shape[3];Ei(c.shape[2]===d*f,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+d*f+", but got "+c.shape[2]+"."});var p=ng(u,l,r,a,o,i),g=Qp(p,c,1,"valid",o);return h?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}}),og=ol({conv2dTranspose_:function(e,t,n,r,a,i){return Xp(n,Xs(e,"x","conv2dTranspose"),Xs(t,"filter","conv2dTranspose"),r,a,"NHWC",i)}}),sg=ol({conv3dTranspose_:function(e,t,n,r,a){return $p(n,Xs(e,"x","conv3dTranspose"),Xs(t,"filter","conv3dTranspose"),r,a)}}),lg=ol({matMul_:function(e,t,n,r){var a;void 0===n&&(n=!1),void 0===r&&(r=!1);var i=Xs(e,"a","matMul"),o=Xs(t,"b","matMul");a=Ro(i,o),i=a[0],o=a[1];var s=n?i.shape[i.rank-2]:i.shape[i.rank-1],l=r?o.shape[o.rank-1]:o.shape[o.rank-2],c=n?i.shape[i.rank-1]:i.shape[i.rank-2],u=r?o.shape[o.rank-2]:o.shape[o.rank-1],h=i.shape.slice(0,-2),d=o.shape.slice(0,-2),f=Ai(h),p=Ai(d);Ei(i.rank>=2&&o.rank>=2&&i.rank===o.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+i.rank+" and "+o.rank+"."}),Ei(Ri(h,d),function(){return"Error in matMul: outer dimensions ("+h+") and ("+d+") of Tensors with shapes "+i.shape+" and "+o.shape+" must match."}),Ei(s===l,function(){return"Error in matMul: inner shapes ("+s+") and ("+l+") of Tensors with shapes "+i.shape+" and "+o.shape+" and transposeA="+n+" and transposeB="+r+" must match."});var g=i.shape.slice(0,-2).concat([c,u]),m=n?i.as3D(f,s,c):i.as3D(f,c,s),v=r?o.as3D(p,u,l):o.as3D(p,l,u),b={transposeA:n,transposeB:r};return Mo.runKernelFunc(function(e,t){var a=e.batchMatMul(m,v,n,r);return t([m,v]),a},{a:m,b:v},function(e,t){var a=t,i=a[0],o=a[1];return n||r?!n&&r?{a:function(){return e.matMul(o,!1,!1)},b:function(){return e.matMul(i,!0,!1)}}:n&&!r?{a:function(){return o.matMul(e,!1,!0)},b:function(){return i.matMul(e,!1,!1)}}:{a:function(){return o.matMul(e,!0,!0)},b:function(){return e.matMul(i,!0,!0)}}:{a:function(){return e.matMul(o,!1,!0)},b:function(){return i.matMul(e,!0,!1)}}},"BatchMatMul",b).reshape(g)}}),cg=ol({dot_:function(e,t){var n=Xs(e,"t1","dot"),r=Xs(t,"t2","dot");Ei(!(1!==n.rank&&2!==n.rank||1!==r.rank&&2!==r.rank),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."});var a=1===n.rank?n.size:n.shape[1],i=1===r.rank?r.size:r.shape[0];return Ei(a===i,function(){return"Error in dot: inner dimensions of inputs must match, but got "+a+" and "+i+"."}),1===n.rank&&1===r.rank?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():1===n.rank&&2===r.rank?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():2===n.rank&&1===r.rank?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),ug=ol({outerProduct_:function(e,t){var n=Xs(e,"v1","outerProduct"),r=Xs(t,"v2","outerProduct");return Ei(1===n.rank&&1===r.rank,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."}),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),hg=ol({reverse_:function(e,t){var n=Xs(e,"x","reverse");if(0===n.rank)return n.clone();var r=ji(t,n.shape);return Mo.runKernelFunc(function(e){return e.reverse(n,r)},{$x:n},function(e){return{$x:function(){return e.reverse(r)}}}).reshapeAs(n)}}),dg=ol({reverse1d_:function(e){var t=Xs(e,"x","reverse");return Ei(1===t.rank,function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."}),hg(t,0)}}),fg=ol({reverse2d_:function(e,t){var n=Xs(e,"x","reverse");return Ei(2===n.rank,function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."}),hg(n,t)}}),pg=ol({reverse3d_:function(e,t){var n=Xs(e,"x","reverse");return Ei(3===n.rank,function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."}),hg(n,t)}}),gg=ol({reverse4d_:function(e,t){var n=Xs(e,"x","reverse");return Ei(4===n.rank,function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."}),hg(n,t)}});function mg(e,t,n,r,a,i){var o=Xs(e,"x","maxPool"),s=o,l=!1;3===o.rank&&(l=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),null==r&&(r=[1,1]),Ei(4===s.rank,function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."}),Ei($c(n,r),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}),null!=i&&Ei(Di(a),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+a+"."});var c=zc(s.shape,t,n,r,a,i);if(1===c.filterWidth&&1===c.filterHeight&&Ri(c.inShape,c.outShape))return o.clone();var u=[s],h=Mo.runKernelFunc(function(e,t){var n=e.maxPool(s,c);return t([s,n]),n},{x:s},function(e,i){var o=i[0],s=i[1];return{x:function(){return function(e,t,n,r,a,i,o,s){var l=Xs(e,"dy","maxPoolBackprop"),c=Xs(t,"input","maxPoolBackprop"),u=Xs(n,"output","maxPoolBackprop");Ei(c.rank===l.rank,function(){return"Rank of input ("+c.rank+") does not match rank of dy ("+l.rank+")"}),null==i&&(i=[1,1]),Ei($c(a,i),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+a+" and dilations '"+i+"'"}),Ei(4===l.rank,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+l.rank+"."}),Ei(4===c.rank,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+c.rank+"."});var h=zc(c.shape,r,a,i,o,s);return Mo.runKernelFunc(function(e){return e.maxPoolBackprop(l,c,u,h)},{$dy:l,$input:c})}(e,o,s,t,n,r,a)}}},"MaxPool",c,u);return l?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}function vg(e,t,n,r,a,i){var o=Xs(e,"x","avgPool","float32");null==r&&(r=[1,1]),Ei($c(n,r),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"});var s=o,l=!1;3===o.rank&&(l=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),Ei(4===s.rank,function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."}),null!=i&&Ei(Di(a),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+a+"."});var c=zc(s.shape,t,n,r,a,i);if(1===c.filterWidth&&1===c.filterHeight&&Ri(c.inShape,c.outShape))return o.clone();var u=Mo.runKernelFunc(function(e){return e.avgPool(s,c)},{x:s},function(e){return{x:function(){return function(e,t,n,r,a,i){var o=Xs(e,"dy","avgPoolBackprop"),s=Xs(t,"input","avgPoolBackprop");Ei(s.rank===o.rank,function(){return"Rank of input ("+s.rank+") does not match rank of dy ("+o.rank+")"}),null==a&&(a=[1,1]),Ei($c(r,a),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+a+"'"});var l=s,c=o,u=!1;3===s.rank&&(u=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2]),c=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),Ei(4===c.rank,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+c.rank+"."}),Ei(4===l.rank,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+l.rank+"."});var h=zc(l.shape,n,r,a,i),d=Mo.runKernelFunc(function(e){return e.avgPoolBackprop(c,l,h)},{dy4D:c,input4D:l});return u?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}(e,s,t,n,r,a)}}},"AvgPool",c);return u=u.cast(o.dtype),l?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}var bg=ol({maxPool_:function(e,t,n,r,a){return mg(e,t,n,1,r,a)}}),xg=ol({avgPool_:function(e,t,n,r,a){return vg(e,t,n,1,r,a)}}),yg=ol({pool_:function(e,t,n,r,a,i){null==a&&(a=[1,1]),null==i&&(i=1),0===r&&(r="valid");var o=Xs(e,"x","maxPool"),s=o,l=!1;3===o.rank&&(l=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),Ei($c(i,a),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+a+"'"});var c,u=zc(s.shape,t,i,a,r),h=[u.dilationHeight,u.dilationWidth];c="same"===r?function(e,t){var n=e.map(function(e,n){return e+(e-1)*(t[n]-1)}).map(function(e){return e-1}),r=n.map(function(e){return Math.floor(e/2)}),a=n.map(function(e,t){return e-r[t]});return n.map(function(e,t){return[r[t],a[t]]})}([u.filterHeight,u.filterWidth],h):[[0,0],[0,0]];var d=1===h[0]&&1===h[1],f=function(e,t,n){var r=n.map(function(e){return e[0]}),a=n.map(function(e){return e[1]}),i=e.concat(r,a),o=t.map(function(e,t){return(e-i[t]%e)%e}),s=a.map(function(e,t){return e+o[t]});return[t.map(function(e,t){return[r[t],s[t]]}),t.map(function(e,t){return[0,o[t]]})]}([u.inHeight,u.inWidth],h,c),p=f[0],g=f[1],m=d?r:"valid",v=d?s:lc(s,h,p),b=("avg"===n?function(){return vg(v,t,i,1,m)}:function(){return mg(v,t,i,1,m)})(),x=d?b:Ul(b,h,g);return l?x.as3D(x.shape[1],x.shape[2],x.shape[3]):x}}),wg=ol({maxPool3d_:function(e,t,n,r,a,i,o){void 0===i&&(i="NDHWC");var s=Xs(e,"x","maxPool3d"),l=s,c=!1;4===s.rank&&(c=!0,l=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==o&&(o=[1,1,1]),Ei(5===l.rank,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+l.rank+"."}),Ei("NDHWC"===i,function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),Ei($c(n,o),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"}),null!=a&&Ei(Di(r),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var u=Wc(l.shape,t,n,o,r,a,i),h=Mo.runKernelFunc(function(e,t){var n=e.maxPool3d(l,u);return t([l,n]),n},{x:l},function(e,i){var s=i[0],l=i[1];return{x:function(){return function(e,t,n,r,a,i,o,s){var l=Xs(e,"dy","maxPool3dBackprop"),c=Xs(t,"input","maxPool3dBackprop"),u=Xs(n,"output","maxPool3dBackprop"),h=l,d=c,f=u,p=!1;4===c.rank&&(p=!0,h=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]),d=c.as5D(1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]),f=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3])),Ei(5===h.rank,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+h.rank+"."}),Ei(5===d.rank,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+d.rank+"."}),Ei(5===f.rank,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+f.rank+"."}),null==i&&(i=[1,1,1]),Ei($c(a,i),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+a+" and dilations '"+i+"'"}),null!=s&&Ei(Di(o),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+o+"."});var g=Wc(d.shape,r,a,i,o,s),m=Mo.runKernelFunc(function(e){return e.maxPool3dBackprop(h,d,f,g)},{dy5D:h,input5D:d});return p?m.as4D(m.shape[1],m.shape[2],m.shape[3],m.shape[4]):m}(e,s,l,t,n,o,r,a)}}});return c?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),kg=ol({avgPool3d_:function(e,t,n,r,a,i,o){void 0===i&&(i="NDHWC");var s=Xs(e,"x","avgPool3d","float32"),l=s,c=!1;4===s.rank&&(c=!0,l=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==o&&(o=[1,1,1]),Ei(5===l.rank,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+l.rank+"."}),Ei("NDHWC"===i,function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),Ei($c(n,o),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"}),null!=a&&Ei(Di(r),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var u=Wc(l.shape,t,n,o,r,a,i),h=Mo.runKernelFunc(function(e){return e.avgPool3d(l,u)},{x:l},function(e){return{x:function(){return function(e,t,n,r,a,i,o){var s=Xs(e,"dy","avgPool3dBackprop"),l=Xs(t,"input","avgPool3dBackprop"),c=s,u=l,h=!1;4===l.rank&&(h=!0,c=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]),u=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3])),Ei(5===c.rank,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+c.rank+"."}),Ei(5===u.rank,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+u.rank+"."}),null==a&&(a=[1,1,1]),Ei($c(r,a),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+a+"'"}),null!=o&&Ei(Di(i),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."});var d=Wc(u.shape,n,r,a,i,o),f=Mo.runKernelFunc(function(e){return e.avgPool3dBackprop(c,u,d)},{dy5D:c,input5D:u});return h?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}(e,l,t,n,o,r,a)}}});return h=h.cast(l.dtype),c?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),Ng=ol({slice_:function(e,t,n){var r,a,i=Xs(e,"x","slice");if(0===i.rank)throw new Error("Slicing scalar is not possible");(r="number"==typeof t?[t].concat(new Array(i.rank-1).fill(0)):t.length<i.rank?t.concat(new Array(i.rank-t.length).fill(0)):t.slice()).forEach(function(e){Ei(-1!==e,function(){return"slice() does not support negative begin indexing."})}),a=(a=null==n?new Array(i.rank).fill(-1):"number"==typeof n?[n].concat(new Array(i.rank-1).fill(-1)):n.length<i.rank?n.concat(new Array(i.rank-n.length).fill(-1)):n).map(function(e,t){return e>=0?e:(Ei(-1===e,function(){return"Negative size values should be exactly -1 but got "+e+" for the slice() size at index "+t+"."}),i.shape[t]-r[t])}),Sc(i,r,a);var o=i.shape,s={begin:r,size:a};return Mo.runKernelFunc(function(e){return e.slice(i,r,a)},{x:i},function(e){for(var t=[],n=0;n<e.rank;n++)t.push([r[n],o[n]-r[n]-a[n]]);return{x:function(){return e.pad(t)}}},"Slice",s)}}),Sg=ol({slice1d_:function(e,t,n){var r=Xs(e,"x","slice1d");return Ei(1===r.rank,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"}),Ng(r,[t],[n])}}),Cg=ol({slice2d_:function(e,t,n){var r=Xs(e,"x","slice2d");return Ei(2===r.rank,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"}),Ng(r,t,n)}}),Eg=ol({slice3d_:function(e,t,n){var r=Xs(e,"x","slice3d");return Ei(3===r.rank,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"}),Ng(r,t,n)}}),_g=ol({slice4d_:function(e,t,n){var r=Xs(e,"x","slice4d");return Ei(4===r.rank,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"}),Ng(r,t,n)}});function Ig(e,t,n,r,a){return t.rank<n.rank&&(t=t.reshape(Zs(t.shape,r))),e.rank<n.rank&&(e=e.reshape(Zs(e.shape,r))),{x:function(){var r=e.mul(n.equal(t).cast(e.dtype));return null==a?r:r.transpose(a)}}}var Tg=ol({all_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Xs(e,"x","all","bool"),a=ji(t,r.shape),i=a,o=tl(i,r.rank);null!=o&&(r=r.transpose(o),i=rl(i.length,r.rank));var s=Mo.runKernelFunc(function(e){return e.all(r,i)},{$x:r});if(n){var l=Zs(s.shape,a);return s.reshape(l)}return s}}),Ag=ol({any_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Xs(e,"x","any","bool"),a=ji(t,r.shape),i=a,o=tl(i,r.rank);null!=o&&(r=r.transpose(o),i=rl(i.length,r.rank));var s=Mo.runKernelFunc(function(e){return e.any(r,i)},{$x:r});if(n){var l=Zs(s.shape,a);return s.reshape(l)}return s}}),Rg=ol({argMax_:function(e,t){void 0===t&&(t=0);var n=Xs(e,"x","argMax");null==t&&(t=0);var r=ji(t,n.shape),a=tl(r,n.rank);null!=a&&(n=n.transpose(a),r=rl(r.length,n.rank));var i={axis:r[0]},o=[n];return Mo.runKernelFunc(function(e,t){var a=e.argMax(n,r[0]);return t([n]),a},{x:n},function(e,t){var n=t[0];return{x:function(){return kl(n)}}},"ArgMax",i,o)}}),Dg=ol({argMin_:function(e,t){void 0===t&&(t=0);var n=Xs(e,"x","argMin");null==t&&(t=0);var r=ji(t,n.shape),a=tl(r,n.rank);return null!=a&&(n=n.transpose(a),r=rl(r.length,n.rank)),Mo.runKernelFunc(function(e,t){var a=e.argMin(n,r[0]);return t([n]),a},{$x:n},function(e,t){var n=t[0];return{$x:function(){return kl(n)}}})}}),Fg=ol({logSumExp_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Xs(e,"x","logSumExp"),a=ji(t,r.shape),i=r.max(a,!0),o=r.sub(i).exp().sum(a).log(),s=i.reshape(o.shape).add(o);if(n){var l=Zs(s.shape,a);return s.reshape(l)}return s}}),Og=ol({max_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Xs(e,"x","max"),a=r,i=ji(t,r.shape),o=i,s=tl(o,r.rank);null!=s&&(r=r.transpose(s),o=rl(o.length,r.rank));var l=[r],c=Mo.runKernelFunc(function(e,t){var n=e.max(r,o);return t([a,n]),n},{x:r},function(e,t){return Ig(e,t[1],t[0],i,s)},"Max",{axes:o},l,[!0]);if(n){var u=Zs(c.shape,i);c=c.reshape(u)}return c}}),Lg=ol({mean_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Xs(e,"x","mean"),a=ji(t,r.shape),i=Ai(Qs(r.shape,a)[1]);return Rc(function(e){var r=dl(i);return{value:(r.dtype===e.dtype?e:e.cast(r.dtype)).div(r).sum(t,n),gradFunc:function(t){var n=e.shape.slice();return a.forEach(function(e){n[e]=1}),t.reshape(n).mul(vl(e.shape,"float32")).div(i)}}})(r)}}),Pg=ol({min_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Xs(e,"x","min"),a=r,i=ji(t,r.shape),o=i,s=tl(o,r.rank);null!=s&&(r=r.transpose(s),o=rl(o.length,r.rank));var l=[r],c=Mo.runKernelFunc(function(e,t){var n=e.min(r,o);return t([a,n]),n},{x:r},function(e,t){return Ig(e,t[1],t[0],i,s)},"Min",{axes:o},l,[!0]);if(n){var u=Zs(c.shape,i);c=c.reshape(u)}return c}}),Mg=ol({moments_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=ji(t,(e=Xs(e,"x","moments")).shape),a=e.mean(r,n),i=a.shape;n||(i=Zs(a.shape,r));var o=e.toFloat().sub(a.reshape(i)).square();return{mean:a,variance:o.mean(r,n)}}}),jg=ol({sum_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Xs(e,"x","sum");"bool"===r.dtype&&(r=r.toInt());var a=ji(t,r.shape);return Rc(function(e){var t=tl(a,e.rank),r=a,i=e;null!=t&&(i=e.transpose(t),r=rl(r.length,e.rank));var o=function(t){var n=e.shape.slice();return a.forEach(function(e){n[e]=1}),t.reshape(n).mul(vl(e.shape,"float32"))},s={axes:r},l=Mo.runKernelFunc(function(e){return e.sum(i,r)},{x:i},function(e){return{x:function(){return o(e)}}},"Sum",s);if(n){var c=Zs(l.shape,a);l=l.reshape(c)}return{value:l,gradFunc:o}})(r)}}),Bg=ol({prod_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=Xs(e,"x","prod");"bool"===r.dtype&&(r=r.toInt());var a=ji(t,r.shape),i=tl(a,r.rank),o=a,s=r;null!=i&&(s=r.transpose(i),o=rl(o.length,r.rank));var l=Mo.runKernelFunc(function(e){return e.prod(s,o)},{permutedX:s});if(n){var c=Zs(l.shape,a);l=l.reshape(c)}return l}}),zg=ol({elu_:function(e){var t=Xs(e,"x","elu");return Mo.runKernelFunc(function(e,n){var r=e.elu(t);return n([r]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){return Mo.runKernelFunc(function(t){return t.eluDer(e,n)},{dy:e,y:n})}}})}}),Wg=ol({leakyRelu_:function(e,t){void 0===t&&(t=.2);var n=Xs(e,"x","leakyRelu");return xp(dl(t).mul(n),n)}}),Ug=ol({prelu_:function(e,t){var n=Xs(e,"x","prelu"),r=Xs(t,"alpha","prelu");return Mo.runKernelFunc(function(e,t){var a=e.prelu(n,r);return t([n,r]),a},{x:n,alpha:r},function(e,t){var n=t[0],r=t[1],a=n.greater(0);return{x:function(){return cp(a,e,e.mul(r))},alpha:function(){var t=cp(a,kl(e),e.mul(n)),i=jc(r.shape,e.shape);return i.length>0&&(t=t.sum(i)),t.reshape(r.shape)}}},"Prelu")}}),Vg=ol({relu_:function(e){var t=Xs(e,"x","relu");return"bool"===t.dtype?t.toInt():Mo.runKernelFunc(function(e,n){var r=e.relu(t);return n([t]),r},{x:t},function(e,t){var n=t[0];return{x:function(){return e.mulStrict(n.step().toFloat())}}},"Relu")}}),Hg=ol({relu6_:function(e){var t=Xs(e,"x","relu6");return"bool"===t.dtype?t.toInt():Mo.runKernelFunc(function(e,n){var r=e.relu6(t);return n([t]),r},{x:t},function(e,t){var n=t[0],r=n.lessEqual(6).mul(n.step());return{x:function(){return e.mulStrict(r.toFloat())}}},"Relu6")}}),Gg=ol({selu_:function(e){var t=Xs(e,"x","selu");return Mo.runKernelFunc(function(e,n){var r=e.selu(t);return n([t]),r},{$x:t},function(e,t){var n=t[0];return{$x:function(){var t=n.greater(dl(0)),r=dl(Ad),a=dl(Rd),i=e.mul(a),o=e.mul(r).mul(n.toFloat().exp());return cp(t,i,o)}}})}}),qg=ol({transpose_:function(e,t){var n=Xs(e,"x","transpose");if(null==t&&(t=n.shape.map(function(e,t){return t}).reverse()),Ei(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+t+"."}),t.forEach(function(e){Ei(e>=0&&e<n.rank,function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+t})}),n.rank<=1)return n.clone();var r={perm:t};return Mo.runKernelFunc(function(e){return e.transpose(n,t)},{x:n},function(e){var n=nl(t);return{x:function(){return e.transpose(n)}}},"Transpose",r)}}),Kg=ol({localResponseNormalization_:function(e,t,n,r,a){void 0===t&&(t=5),void 0===n&&(n=1),void 0===r&&(r=1),void 0===a&&(a=.5);var i=Xs(e,"x","localResponseNormalization");Ei(4===i.rank||3===i.rank,function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank "+i.rank+"."}),Ei(Di(t),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."});var o=i,s=!1;3===i.rank&&(s=!0,o=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var l=Mo.runKernelFunc(function(e,i){var s=e.localResponseNormalization4D(o,t,n,r,a);return i([o,s]),s},{x4D:o},function(e,i){var o=i[0],s=i[1];return{x4D:function(){return Mo.runKernelFunc(function(i){return i.LRNGrad(e,o,s,t,n,r,a)},{})}}});return s?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}}),Xg=ol({norm_:function(e,t,n,r){void 0===t&&(t="euclidean"),void 0===n&&(n=null),void 0===r&&(r=!1);var a=function e(t,n,r){if(void 0===r&&(r=null),0===t.rank)return t.abs();if(1!==t.rank&&null===r)return e(t.reshape([-1]),n,r);if(1===t.rank||"number"==typeof r||Array.isArray(r)&&1===r.length){if(1===n)return t.abs().sum(r);if(n===1/0)return t.abs().max(r);if(n===-1/0)return t.abs().min(r);if("euclidean"===n||2===n)return t.abs().pow(dl(2,"int32")).sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}if(Array.isArray(r)&&2===r.length){if(1===n)return t.abs().sum(r[0]).max(r[1]-1);if(n===1/0)return t.abs().sum(r[1]).max(r[0]);if(n===-1/0)return t.abs().sum(r[1]).min(r[0]);if("fro"===n||"euclidean"===n)return t.square().sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}throw new Error("Error in norm: invalid axis: "+r)}(e=Xs(e,"x","norm"),t,n),i=a.shape;if(r){var o=ji(n,e.shape);i=Zs(a.shape,o)}return a.reshape(i)}}),Yg=ol({basicLSTMCell_:function(e,t,n,r,a,i){var o=Xs(e,"forgetBias","basicLSTMCell"),s=Xs(t,"lstmKernel","basicLSTMCell"),l=Xs(n,"lstmBias","basicLSTMCell"),c=Xs(r,"data","basicLSTMCell"),u=Xs(a,"c","basicLSTMCell"),h=Xs(i,"h","basicLSTMCell"),d=c.concat(h,1).matMul(s).add(l),f=d.shape[0],p=d.shape[1]/4,g=[f,p],m=d.slice([0,0],g),v=d.slice([0,p],g),b=d.slice([0,2*p],g),x=d.slice([0,3*p],g),y=m.sigmoid().mulStrict(v.tanh()).addStrict(u.mulStrict(o.add(b).sigmoid())),w=y.tanh().mulStrict(x.sigmoid());return[y,w]}}),$g=ol({multiRNNCell_:function(e,t,n,r){for(var a=Xs(t,"data","multiRNNCell"),i=Ys(n,"c","multiRNNCell"),o=Ys(r,"h","multiRNNCell"),s=a,l=[],c=0;c<e.length;c++){var u=e[c](s,i[c],o[c]);l.push(u[0]),l.push(u[1]),s=u[1]}var h=[],d=[];for(c=0;c<l.length;c+=2)h.push(l[c]),d.push(l[c+1]);return[h,d]}}),Jg=ol({movingAverage_:function(e,t,n,r,a){void 0===a&&(a=!0);var i=Xs(e,"v","movingAverage"),o=Xs(t,"x","movingAverage"),s=Xs(n,"decay","movingAverage");Do(i,o),Ei(Ri(i.shape,o.shape),function(){return"Shape mismatch in v and x"});var l=dl(1),c=l.sub(s),u=o.sub(i).mul(c);if(a){Ei(null!=r,function(){return"When using zeroDebias: true, step is required."});var h=Xs(r,"step","movingAverage");u=u.div(l.sub(_p(s,h)))}return i.add(u)}}),Qg=ol({stridedSlice_:function(e,t,n,r,a,i,o,s,l){if(void 0===a&&(a=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===l&&(l=0),null==r&&(r=new Array(t.length)),0!==o)throw new Error("ellipsis mask is not yet supported");var c=Xs(e,"x","stridedSlice"),u=Cc(s),h=c.shape.slice();u.forEach(function(e){t[e]=0,n[e]=1,h.splice(e,0,1)}),c=c.reshape(h);for(var d=0;d<c.rank;d++)t[d]=_c(a,t,r,c.shape,d),n[d]=Ic(i,n,r,c.shape,d),r[d]=r[d]||1;var f=Cc(l);f.forEach(function(e){n[e]=t[e]+1,r[e]=1});var p=Ec(t,n,r),g=p.filter(function(e,t){return-1===f.indexOf(t)});return r.every(function(e){return 1===e})?Ng(c,t,p).reshape(g):Mo.runKernelFunc(function(e){return e.stridedSlice(c,t,n,r)},{$x:c}).reshape(g)}}),Zg=ol({topk_:function(e,t,n){void 0===t&&(t=1),void 0===n&&(n=!0);var r=Xs(e,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var a=r.shape[r.shape.length-1];if(t>a)throw new Error("'k' passed to topk() must be <= the last dimension ("+a+") but got "+t);var i=Mo.runKernelFunc(function(e){return e.topk(r,t,n)},{$x:r});return{values:i[0],indices:i[1]}}}),em=ol({scatterND_:function(e,t,n){var r=Xs(e,"indices","scatterND","int32"),a=Xs(t,"updates","scatterND");return kc(a,r,n),Mo.runKernelFunc(function(e){return e.scatterND(r,a,n)},{indices:r,updates:a},null,"ScatterNd",{shape:n})}}),tm=ol({fft_:function(e){Ei("complex64"===e.dtype,function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return Mo.runKernelFunc(function(e){return e.fft(r)},{input:e}).reshape(e.shape)}}),nm=ol({ifft_:function(e){Ei("complex64"===e.dtype,function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return Mo.runKernelFunc(function(e){return e.ifft(r)},{input:e}).reshape(e.shape)}}),rm=ol({rfft_:function(e,t){Ei("float32"===e.dtype,function(){return"The dtype for rfft() must be real value but got "+e.dtype});var n,r=e.shape[e.shape.length-1],a=e.size/r;if(null!=t&&t<r){var i=e.shape.map(function(e){return 0}),o=e.shape.map(function(e){return e});o[e.shape.length-1]=t,n=e.slice(i,o),r=t}else if(null!=t&&t>r){var s=e.shape.map(function(e){return e});s[e.shape.length-1]=t-r,n=e.concat(bl(s),e.shape.length-1),r=t}else n=e;var l=n.zerosLike(),c=sl(n,l).as2D(a,r),u=tm(c),h=Math.floor(r/2)+1,d=ll(u),f=cl(u),p=d.split([h,r-h],d.shape.length-1),g=f.split([h,r-h],f.shape.length-1),m=n.shape.slice();return m[n.shape.length-1]=h,sl(p[0],g[0]).reshape(m)}}),am=ol({irfft_:function(e){var t=e.shape[e.shape.length-1],n=e.size/t;if(t<=2){var r=e.as2D(n,t),a=nm(r);return ll(a)}var i=[n,2*(t-1)],o=ll(e).as2D(n,t),s=cl(e).as2D(n,t),l=o.slice([0,1],[n,t-2]).reverse(1),c=s.slice([0,1],[n,t-2]).reverse(1).mul(dl(-1)),u=o.concat(l,1),h=s.concat(c,1);return r=sl(u,h).as2D(i[0],i[1]),a=nm(r),ll(a)}}),im=Object.freeze({fft:tm,ifft:nm,rfft:rm,irfft:am}),om=ol({sparseToDense_:function(e,t,n,r){void 0===r&&(r=0);var a=Xs(e,"sparseIndices","sparseToDense","int32"),i=Xs(t,"sparseValues","sparseToDense"),o=Xs(r,"defaultValue","sparseToDense",i.dtype);return function(e,t,n,r){if("int32"!==e.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+e.dtype+".");if(e.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+e.shape+".");var a=e.rank>0?e.shape[0]:1,i=e.rank>1?e.shape[1]:1;if(n.length!==i)throw new Error("outputShape has incorrect number of elements:, "+n.length+", should be: "+i+".");var o=t.size;if(0!==t.rank&&(1!==t.rank||o!==a))throw new Error("sparseValues has incorrect shape "+t.shape+", should be [] or ["+a+"]");if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(a,i,n,o),Mo.runKernelFunc(function(e){return e.sparseToDense(a,i,n,o)},{$sparseIndices:a,$sparseValues:i,$defaultValue:o})}}),sm=ol({gatherND_:function(e,t){var n=Xs(t,"indices","gatherND","int32"),r=Xs(e,"x","gatherND");return Mo.runKernelFunc(function(e){return e.gatherND(r,n)},{x:r,indices:n},null,"GatherNd")}}),lm=ol({diag_:function(e){var t=Xs(e,"x","diag").flatten(),n=e.shape.concat(e.shape);return Mo.runKernelFunc(function(e){return e.diag(t)},{$x:t}).reshape(n)}}),cm=ol({dropout_:function(e,t,n,r){var a=Xs(e,"x","dropout");if(Ei("float32"===a.dtype,function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+a.dtype+" tensor instead."}),Ei(t>=0&&t<1,function(){return"rate must be a float in the range [0, 1), but got "+t+"."}),0===t)return e instanceof wo?a.clone():a;var i=function(e,t){if(null==t)return e.shape.slice();if(Ri(e.shape,t))return t;if(e.shape.length===t.length){for(var n=[],r=0;r<e.shape.length;r++)null==t[r]&&null!=e.shape[r]?n.push(e.shape[r]):n.push(t[r]);return n}return t}(a,n),o=1-t,s=oc(i,0,1,"float32",r).add(o).floor().div(o);return a.mul(s)}});function um(e,t,n){for(var r=1-e%2,a=new Float32Array(e),i=0;i<e;++i){var o=2*Math.PI*i/(e+r-1);a[i]=t-n*Math.cos(o)}return fl(a,"float32")}var hm,dm=ol({hannWindow_:function(e){return um(e,.5,.5)}}),fm=ol({hammingWindow_:function(e){return um(e,.54,.46)}}),pm=ol({frame_:function(e,t,n,r,a){void 0===r&&(r=!1),void 0===a&&(a=0);for(var i=0,o=[];i+t<=e.size;)o.push(Ng(e,i,t)),i+=n;if(r)for(;i<e.size;){var s=i+t-e.size,l=Nl([Ng(e,i,t-s),xl([s],a)]);o.push(l),i+=n}return 0===o.length?pl([],[0,t]):Nl(o).as2D(o.length,t)}}),gm=ol({stft_:function(e,t,n,r,a){var i;void 0===a&&(a=dm),null==r&&(i=t,r=Math.floor(Math.pow(2,Math.ceil(Math.log(i)/Math.log(2)))));for(var o=pm(e,t,n),s=Cp(o,a(t)),l=[],c=0;c<o.shape[0];c++)l.push(rm(s.slice([c,0],[1,t]),r));return Nl(l)}}),mm=Object.freeze({hannWindow:dm,hammingWindow:fm,frame:pm,stft:gm});!function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(hm||(hm={}));var vm=ol({absoluteDifference_:function(e,t,n,r){void 0===r&&(r=hm.SUM_BY_NONZERO_WEIGHTS);var a=Xs(e,"labels","absoluteDifference"),i=Xs(t,"predictions","absoluteDifference"),o=null;null!=n&&(o=Xs(n,"weights","absoluteDifference")),_i(a.shape,i.shape,"Error in absoluteDifference: ");var s=a.sub(i).abs();return bm(s,o,r)}}),bm=ol({computeWeightedLoss_:function(e,t,n){void 0===n&&(n=hm.SUM_BY_NONZERO_WEIGHTS);var r=Xs(e,"losses","computeWeightedLoss"),a=null;null!=t&&(a=Xs(t,"weights","computeWeightedLoss"));var i=null==a?r:r.mul(a);if(n===hm.NONE)return i;if(n===hm.SUM)return i.sum();if(n===hm.MEAN){if(null==a)return i.mean();var o=r.size/a.size,s=i.sum().div(a.sum());return o>1?s.div(dl(o)):s}if(n===hm.SUM_BY_NONZERO_WEIGHTS){if(null==a)return i.sum().div(dl(r.size));var l=a.mul(vl(r.shape)).notEqual(dl(0)).sum().toFloat();return i.sum().div(l)}throw Error("Unknown reduction: "+n)}}),xm=ol({cosineDistance_:function(e,t,n,r,a){void 0===a&&(a=hm.SUM_BY_NONZERO_WEIGHTS);var i=Xs(e,"labels","cosineDistance"),o=Xs(t,"predictions","cosineDistance"),s=null;null!=r&&(s=Xs(r,"weights","cosineDistance")),_i(i.shape,o.shape,"Error in cosineDistance: ");var l=dl(1).sub(i.mul(o).sum(n,!0));return bm(l,s,a)}}),ym=ol({hingeLoss_:function(e,t,n,r){void 0===r&&(r=hm.SUM_BY_NONZERO_WEIGHTS);var a=Xs(e,"labels","hingeLoss"),i=Xs(t,"predictions","hingeLoss"),o=null;null!=n&&(o=Xs(n,"weights","hingeLoss")),_i(a.shape,i.shape,"Error in hingeLoss: ");var s=dl(1);a=dl(2).mul(a).sub(s);var l=s.sub(a.mul(i)).relu();return bm(l,o,r)}}),wm=ol({huberLoss_:function(e,t,n,r,a){void 0===r&&(r=1),void 0===a&&(a=hm.SUM_BY_NONZERO_WEIGHTS);var i=Xs(e,"labels","huberLoss"),o=Xs(t,"predictions","huberLoss"),s=null;null!=n&&(s=Xs(n,"weights","huberLoss")),_i(i.shape,o.shape,"Error in huberLoss: ");var l=dl(r),c=o.sub(i).abs(),u=wp(c,l),h=c.sub(u),d=dl(.5).mul(u.square()).add(l.mul(h));return bm(d,s,a)}}),km=ol({logLoss_:function(e,t,n,r,a){void 0===r&&(r=1e-7),void 0===a&&(a=hm.SUM_BY_NONZERO_WEIGHTS);var i=Xs(e,"labels","logLoss"),o=Xs(t,"predictions","logLoss"),s=null;null!=n&&(s=Xs(n,"weights","logLoss")),_i(i.shape,o.shape,"Error in logLoss: ");var l=dl(1),c=dl(r),u=i.mul(o.add(c).log()).neg().sub(l.sub(i).mul(l.sub(o).add(c).log()));return bm(u,s,a)}}),Nm=ol({meanSquaredError_:function(e,t,n,r){void 0===r&&(r=hm.SUM_BY_NONZERO_WEIGHTS);var a=Xs(e,"labels","meanSquaredError"),i=Xs(t,"predictions","meanSquaredError"),o=null;null!=n&&(o=Xs(n,"weights","meanSquaredError")),_i(a.shape,i.shape,"Error in meanSquaredError: ");var s=a.squaredDifference(i);return bm(s,o,r)}}),Sm=ol({sigmoidCrossEntropy_:function(e,t,n,r,a){void 0===r&&(r=0),void 0===a&&(a=hm.SUM_BY_NONZERO_WEIGHTS);var i=Xs(e,"multiClassLabels","sigmoidCrossEntropy"),o=Xs(t,"logits","sigmoidCrossEntropy"),s=null;if(null!=n&&(s=Xs(n,"weights","sigmoidCrossEntropy")),_i(i.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){var l=dl(r),c=dl(1),u=dl(.5);i=i.mul(c.sub(l)).add(u.mul(l))}var h=function(e,t){var n=Xs(e,"labels","sigmoidCrossEntropyWithLogits"),r=Xs(t,"logits","sigmoidCrossEntropyWithLogits");_i(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var a=r.relu(),i=r.mul(n),o=r.abs().neg().exp().log1p();return a.sub(i).add(o)}(i,o);return bm(h,s,a)}}),Cm=ol({softmaxCrossEntropy_:function(e,t,n,r,a){void 0===r&&(r=0),void 0===a&&(a=hm.SUM_BY_NONZERO_WEIGHTS);var i=Xs(e,"onehotLabels","softmaxCrossEntropy"),o=Xs(t,"logits","softmaxCrossEntropy"),s=null;if(null!=n&&(s=Xs(n,"weights","softmaxCrossEntropy")),_i(i.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){var l=dl(r),c=dl(1),u=dl(i.shape[1]);i=i.mul(c.sub(l)).add(l.div(u))}var h=function(e,t,n){if(void 0===n&&(n=-1),-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+t.rank+" and dim was "+n);return Rc(function(e,t,r){var a=t.logSumExp([n],!0),i=t.toFloat().sub(a);return r([e,i]),{value:i.mul(e).neg().sum([n]),gradFunc:function(e,t){var r=t[0],a=t[1],i=Zs(e.shape,[n]);return[e.reshape(i).mul(r.toFloat().sub(a.exp())),e.reshape(i).mul(a.exp().sub(r.toFloat()))]}}})(e,t)}(i,o);return bm(h,s,a)}}),Em=Object.freeze({get Reduction(){return hm},absoluteDifference:vm,computeWeightedLoss:bm,cosineDistance:xm,hingeLoss:ym,huberLoss:wm,logLoss:km,meanSquaredError:Nm,sigmoidCrossEntropy:Sm,softmaxCrossEntropy:Cm});function _m(e,t){return void 0===t&&(t=!1),Mo.tidy(function(){if(2!==e.shape.length)throw new Error("qr2d() requires a 2D Tensor, but got a "+e.shape.length+"D Tensor.");for(var n=e.shape[0],r=e.shape[1],a=Yl(n),i=e.clone(),o=pl([[1]],[1,1]),s=o.clone(),l=n>=r?r:n,c=function(e){var t,l=i,c=s,u=a;t=Mo.tidy(function(){var t=i.slice([e,e],[n-e,1]),l=t.norm(),c=i.slice([e,e],[1,1]),u=pl([[-1]]).where(c.greater(0),pl([[1]])),h=c.sub(u.mul(l)),d=t.div(h);s=1===d.shape[0]?o.clone():o.concat(d.slice([1,0],[d.shape[0]-1,d.shape[1]]),0);var f=u.matMul(h).div(l).neg(),p=i.slice([e,0],[n-e,r]),g=f.mul(s);if(0===e)i=p.sub(g.matMul(s.transpose().matMul(p)));else{var m=p.sub(g.matMul(s.transpose().matMul(p)));i=i.slice([0,0],[e,r]).concat(m,0)}var v=a.slice([0,e],[n,a.shape[1]-e]);if(0===e)a=v.sub(v.matMul(s).matMul(g.transpose()));else{var b=v.sub(v.matMul(s).matMul(g.transpose()));a=a.slice([0,0],[n,e]).concat(b,1)}return[s,i,a]}),s=t[0],i=t[1],a=t[2],Hs([l,c,u])},u=0;u<l;++u)c(u);return!t&&n>r&&(a=a.slice([0,0],[n,r]),i=i.slice([0,0],[r,r])),[a,i]})}var Im=ol({bandPart_:function(e,t,n){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+n+".");var r=Xs(e,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var a=r.shape,i=r.shape.slice(-2),o=i[0],s=i[1];if(!(t<=o))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+o+").");if(!(n<=s))throw new Error("bandPart(): numUpper ("+n+") must not be greater than the number of columns ("+s+").");t<0&&(t=o),n<0&&(n=s);var l=yl(0,o,1,"int32").reshape([-1,1]),c=yl(0,s,1,"int32"),u=Ap(l,c),h=ip(u.lessEqual(dl(+t,"int32")),u.greaterEqual(dl(-n,"int32"))),d=bl([o,s],r.dtype);return uc(fc(r.reshape([-1,o,s])).map(function(e){return cp(h,e,d)})).reshape(a)}}),Tm=ol({gramSchmidt_:function(e){var t;if(Array.isArray(e)){t=!1,Ei(null!=e&&e.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var n=e[0].shape[0],r=function(t){Ei(e[t].shape[0]===n,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+e[t].shape[0]+" vs. "+n+")"})},a=1;a<e.length;++a)r(a)}else t=!0,e=Il(e,e.shape[0],0).map(function(e){return cc(e,[0])});Ei(e.length<=e[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+e.length+") exceeds number of dimensions ("+e[0].shape[0]+")."});var i=[],o=e,s=function(e){i.push(Mo.tidy(function(){var t=o[e];if(e>0)for(var n=0;n<e;++n){var r=jg(i[n].mulStrict(t)).mul(i[n]);t=t.sub(r)}return t.div(Xg(t,"euclidean"))}))};for(a=0;a<e.length;++a)s(a);return t?uc(i,0):i}}),Am=ol({qr_:function(e,t){if(void 0===t&&(t=!1),e.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+e.rank);if(2===e.rank)return _m(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce(function(e,t){return e*t}),r=fc(e.reshape([n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),a=[],i=[];return r.forEach(function(e){var n=_m(e,t),r=n[0],o=n[1];a.push(r),i.push(o)}),[uc(a,0).reshape(e.shape),uc(i,0).reshape(e.shape)]}}),Rm=Object.freeze({bandPart:Im,gramSchmidt:Tm,qr:Am});function Dm(e,t,n,r,a,i){null==r&&(r=.5),null==a&&(a=Number.NEGATIVE_INFINITY),null==i&&(i=0);var o=e.shape[0];return n=Math.min(n,o),Ei(0<=r&&r<=1,function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"}),Ei(2===e.rank,function(){return"boxes must be a 2D tensor, but was of rank '"+e.rank+"'"}),Ei(4===e.shape[1],function(){return"boxes must have 4 columns, but 2nd dimension was "+e.shape[1]}),Ei(1===t.rank,function(){return"scores must be a 1D tensor"}),Ei(t.shape[0]===o,function(){return"scores has incompatible shape with boxes. Expected "+o+", but was "+t.shape[0]}),Ei(0<=i&&i<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+i+"'"}),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i}}var Fm=ol({resizeBilinear_:function(e,t,n){void 0===n&&(n=!1);var r=Xs(e,"images","resizeBilinear");Ei(3===r.rank||4===r.rank,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."}),Ei(2===t.length,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."});var a=r,i=!1;3===r.rank&&(i=!0,a=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=t[0],s=t[1],l=Mo.runKernelFunc(function(e,t){return t([a]),e.resizeBilinear(a,o,s,n)},{x:a},function(e,t){return{x:function(){return Mo.runKernelFunc(function(r){return r.resizeBilinearBackprop(e,t[0],n)},{})}}},"ResizeBilinear",{alignCorners:n,newHeight:o,newWidth:s});return i?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}}),Om=ol({resizeNearestNeighbor_:function(e,t,n){void 0===n&&(n=!1);var r=Xs(e,"images","resizeNearestNeighbor");Ei(3===r.rank||4===r.rank,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."}),Ei(2===t.length,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."}),Ei("float32"===r.dtype||"int32"===r.dtype,function(){return"`images` must have `int32` or `float32` as dtype"});var a=r,i=!1;3===r.rank&&(i=!0,a=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=t[0],s=t[1],l=Mo.runKernelFunc(function(e,t){return t([a]),e.resizeNearestNeighbor(a,o,s,n)},{batchImages:a},function(e,t){return{batchImages:function(){return Mo.runKernelFunc(function(r){return r.resizeNearestNeighborBackprop(e,t[0],n)},{})}}});return i?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}}),Lm=ol({nonMaxSuppression_:function(e,t,n,r,a){void 0===r&&(r=.5),void 0===a&&(a=Number.NEGATIVE_INFINITY);var i=Xs(e,"boxes","nonMaxSuppression"),o=Xs(t,"scores","nonMaxSuppression"),s=Dm(i,o,n,r,a);n=s.maxOutputSize,r=s.iouThreshold,a=s.scoreThreshold;var l={maxOutputSize:n,iouThreshold:r,scoreThreshold:a};return Mo.runKernelFunc(function(e){return e.nonMaxSuppression(i,o,n,r,a)},{boxes:i,scores:o},null,"NonMaxSuppressionV3",l)}}),Pm=ol({nonMaxSuppressionWithScore_:function(e,t,n,r,a,i){void 0===r&&(r=.5),void 0===a&&(a=Number.NEGATIVE_INFINITY),void 0===i&&(i=0);var o=Xs(e,"boxes","nonMaxSuppression"),s=Xs(t,"scores","nonMaxSuppression"),l=Dm(o,s,n,r,a,i),c={maxOutputSize:n=l.maxOutputSize,iouThreshold:r=l.iouThreshold,scoreThreshold:a=l.scoreThreshold,softNmsSigma:i=l.softNmsSigma},u=Mo.runKernel("NonMaxSuppressionV5",{boxes:o,scores:s},c);return{selectedIndices:u[0],selectedScores:u[1]}}}),Mm=ol({cropAndResize_:function(e,t,n,r,a,i){var o=Xs(e,"image","cropAndResize"),s=Xs(t,"boxes","cropAndResize","float32"),l=Xs(n,"boxInd","cropAndResize","int32");a=a||"bilinear",i=i||0;var c=s.shape[0];return Ei(4===o.rank,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+o.rank+"."}),Ei(2===s.rank&&4===s.shape[1],function(){return"Error in cropAndResize: boxes must be have size ["+c+",4] but had shape "+s.shape+"."}),Ei(1===l.rank&&l.shape[0]===c,function(){return"Error in cropAndResize: boxInd must be have size ["+c+"] but had shape "+s.shape+"."}),Ei(2===r.length,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."}),Ei(r[0]>=1&&r[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+r}),Ei("bilinear"===a||"nearest"===a,function(){return"method must be bilinear or nearest, but was "+a}),Mo.runKernelFunc(function(e,t){return e.cropAndResize(o,s,l,r,a,i)},{images:o,boxes:s,boxInd:l},null,"CropAndResize",{method:a,extrapolationValue:i,cropSize:r})}}),jm=Object.freeze({resizeBilinear:Fm,resizeNearestNeighbor:Om,nonMaxSuppression:Lm,nonMaxSuppressionAsync:function(e,t,n,r,a){return void 0===r&&(r=.5),void 0===a&&(a=Number.NEGATIVE_INFINITY),ui(this,void 0,void 0,function(){var i,o,s,l,c,u,h;return hi(this,function(d){switch(d.label){case 0:return i=Xs(e,"boxes","nonMaxSuppressionAsync"),o=Xs(t,"scores","nonMaxSuppressionAsync"),s=Dm(i,o,n,r,a),n=s.maxOutputSize,r=s.iouThreshold,a=s.scoreThreshold,[4,Promise.all([i.data(),o.data()])];case 1:return l=d.sent(),c=l[0],u=l[1],h=su(c,u,n,r,a),i!==e&&i.dispose(),o!==t&&o.dispose(),[2,h]}})})},nonMaxSuppressionWithScore:Pm,nonMaxSuppressionWithScoreAsync:function(e,t,n,r,a,i){return void 0===r&&(r=.5),void 0===a&&(a=Number.NEGATIVE_INFINITY),void 0===i&&(i=0),ui(this,void 0,void 0,function(){var o,s,l,c,u,h,d;return hi(this,function(f){switch(f.label){case 0:return o=Xs(e,"boxes","nonMaxSuppressionAsync"),s=Xs(t,"scores","nonMaxSuppressionAsync"),l=Dm(o,s,n,r,a,i),n=l.maxOutputSize,r=l.iouThreshold,a=l.scoreThreshold,i=l.softNmsSigma,[4,Promise.all([o.data(),s.data()])];case 1:return c=f.sent(),u=c[0],h=c[1],d=lu(u,h,n,r,a,i),o!==e&&o.dispose(),s!==t&&s.dispose(),[2,d]}})})},cropAndResize:Mm}),Bm=function(e,t){return!(e>0)||"linear"===t},zm=function(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return e.mul(t.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")},Wm=function(e,t){var n=t,r=jc(e.shape,t.shape);return r.length>0&&(n=n.sum(r)),n.reshape(e.shape)},Um=function(e,t,n){if("linear"===t)return e;if("relu"===t)return Vg(e);if("elu"===t)return zg(e);if("relu6"===t)return Hg(e);if("prelu"===t)return Ug(e,n);throw new Error("Unknown fused activation "+t+".")},Vm=ol({fusedMatMul_:function(e){var t,n=e.a,r=e.b,a=e.transposeA,i=void 0!==a&&a,o=e.transposeB,s=void 0!==o&&o,l=e.bias,c=e.activation,u=void 0===c?"linear":c,h=e.preluActivationWeights;if(!1===Bm(Mo.state.gradientDepth,u)){var d=lg(n,r,i,s);return null!=l&&(d=hp(d,l)),Um(d,u,h)}var f=Xs(n,"a","fused matMul"),p=Xs(r,"b","fused matMul");t=Ro(f,p),f=t[0],p=t[1];var g=i?f.shape[f.rank-2]:f.shape[f.rank-1],m=s?p.shape[p.rank-1]:p.shape[p.rank-2],v=i?f.shape[f.rank-1]:f.shape[f.rank-2],b=s?p.shape[p.rank-2]:p.shape[p.rank-1],x=f.shape.slice(0,-2),y=p.shape.slice(0,-2),w=Ai(x),k=Ai(y);Ei(f.rank>=2&&p.rank>=2&&f.rank===p.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+f.rank+" and "+p.rank+"."}),Ei(Ri(x,y),function(){return"Error in fused matMul: outer dimensions ("+x+") and ("+y+") of Tensors with shapes "+f.shape+" and "+p.shape+" must match."}),Ei(g===m,function(){return"Error in fused matMul: inner shapes ("+g+") and ("+m+") of Tensors with shapes "+f.shape+" and "+p.shape+" and transposeA="+i+" and transposeB="+s+" must match."});var N,S,C=f.shape.slice(0,-2).concat([v,b]),E=i?f.as3D(w,g,v):f.as3D(w,v,g),_=s?p.as3D(k,b,m):p.as3D(k,m,b);null!=l&&Bc(C,(N=Ro(N=Xs(l,"bias","fused matMul"),f)[0]).shape),null!=h&&(S=Xs(h,"prelu weights","fused matMul"));var I={a:E,b:_};null!=l&&(I.bias=N),null!=h&&(I.preluActivationWeights=S);var T=[E,_];return Mo.runKernelFunc(function(e,t){var n=e.fusedBatchMatMul({a:E,b:_,transposeA:i,transposeB:s,bias:N,activation:u,preluActivationWeights:S});return t([E,_,n]),n},I,function(e,t){var n=t[0],r=t[1],a=t[2],o=zm(e,a,u),c={};return null!=l&&(c={bias:function(){return Wm(N,o)}}),i||s?!i&&s?Object.assign({a:function(){return o.matMul(r,!1,!1)},b:function(){return o.matMul(n,!0,!1)}},c):i&&!s?Object.assign({a:function(){return r.matMul(o,!1,!0)},b:function(){return n.matMul(o,!1,!1)}},c):Object.assign({a:function(){return r.matMul(o,!0,!0)},b:function(){return o.matMul(n,!0,!0)}},c):Object.assign({a:function(){return o.matMul(r,!1,!0)},b:function(){return n.matMul(o,!0,!1)}},c)},"_FusedMatMul",{transposeA:i,transposeB:s,activation:u},T,[!0]).reshape(C)}}),Hm=ol({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,a=e.pad,i=e.dataFormat,o=void 0===i?"NHWC":i,s=e.dilations,l=void 0===s?[1,1]:s,c=e.dimRoundingMode,u=e.bias,h=e.activation,d=void 0===h?"linear":h,f=e.preluActivationWeights;if(d=d||"linear",!1===Bm(Mo.state.gradientDepth,d)){var p=Qp(t,n,r,a,o,l,c);return null!=u&&(p=hp(p,u)),Um(p,d,f)}var g=Xs(t,"x","conv2d"),m=Xs(n,"filter","conv2d"),v=g,b=!1;3===g.rank&&(b=!0,v=g.as4D(1,g.shape[0],g.shape[1],g.shape[2])),Ei(4===v.rank,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+v.rank+"."}),Ei(4===m.rank,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+m.rank+"."}),null!=c&&Ei(Di(a),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+c+" but got pad "+a+"."}),Ei(v.shape[3]===m.shape[2],function(){return"Error in conv2d: depth of input ("+v.shape[3]+") must match input depth for filter "+m.shape[2]+"."}),Ei($c(r,l),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+l+"'"}),Ei("NHWC"===o,function(){return"Error in conv2d: got dataFormat of "+o+" but only NHWC is currently supported."});var x,y,w=Uc(v.shape,m.shape,r,l,a,c);null!=u&&(x=Ro(x=Xs(u,"bias","fused conv2d"),g)[0],Bc(w.outShape,x.shape)),null!=f&&(y=Xs(f,"prelu weights","fused conv2d"));var k={x:v,filter:m};null!=u&&(k.bias=x),null!=f&&(k.preluActivationWeights=y);var N=[m,v],S=Mo.runKernelFunc(function(e,t){var n=e.fusedConv2d({input:v,filter:m,convInfo:w,bias:x,activation:d,preluActivationWeights:y});return t([m,v,n]),n},k,function(e,t){var n=t,i=n[0],o=n[1],s=n[2],c=zm(e,s,d);Ei(Yc(l),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+l+"'"});var h={};return null!=u&&(h={bias:function(){return Wm(x,c)}}),Object.assign({x:function(){return tg(o.shape,c,i,r,a)},filter:function(){return eg(o,c,i.shape,r,a)}},h)},"FusedConv2D",{convInfo:w,activation:d},N,[!0]);return b?S.as3D(S.shape[1],S.shape[2],S.shape[3]):S}}),Gm=ol({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,a=e.pad,i=e.dataFormat,o=void 0===i?"NHWC":i,s=e.dilations,l=void 0===s?[1,1]:s,c=e.dimRoundingMode,u=e.bias,h=e.activation,d=void 0===h?"linear":h,f=e.preluActivationWeights;if(!1===Bm(Mo.state.gradientDepth,d)){var p=ng(t,n,r,a,o,l,c);return null!=u&&(p=hp(p,u)),Um(p,d,f)}var g=Xs(t,"x","depthwiseConv2d"),m=Xs(n,"filter","depthwiseConv2d"),v=g,b=!1;3===g.rank&&(b=!0,v=g.as4D(1,g.shape[0],g.shape[1],g.shape[2])),Ei(4===v.rank,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+v.rank+"."}),Ei(4===m.rank,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+m.rank+"."}),Ei(v.shape[3]===m.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+v.shape[3]+") must match the inChannels dimension in filter "+m.shape[2]+"."}),null==l&&(l=[1,1]),Ei($c(r,l),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+l+"'"}),null!=c&&Ei(Di(a),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+c+" but got pad "+a+"."});var x,y,w=Uc(v.shape,m.shape,r,l,a,c,!0);null!=u&&(x=Ro(x=Xs(u,"bias","fused conv2d"),g)[0],Bc(w.outShape,x.shape)),null!=f&&(y=Xs(f,"prelu weights","fused depthwiseConv2d"));var k={x:v,filter:m};null!=u&&(k.bias=x),null!=f&&(k.preluActivationWeights=y);var N=[m,v],S=Mo.runKernelFunc(function(e,t){var n=e.fusedDepthwiseConv2D({input:v,filter:m,convInfo:w,bias:x,activation:d,preluActivationWeights:y});return t([m,v,n]),n},k,function(e,t){Ei(Yc(l),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+l+"'"});var n=t[0],r=t[1],a=t[2],i=zm(e,a,d),o={};return null!=u&&(o={bias:function(){return Wm(x,i)}}),Object.assign({x:function(){return rg(r.shape,i,n,w)},filter:function(){return ag(r,i,n.shape,w)}},o)},"FusedDepthwiseConv2D",{convInfo:w,activation:d},N,[!0]);return b?S.as3D(S.shape[1],S.shape[2],S.shape[3]):S}}),qm=Object.freeze({matMul:Vm,conv2d:Hm,depthwiseConv2d:Gm}),Km=Object.freeze({image:jm,linalg:Rm,losses:Em,spectral:im,fused:qm,signal:mm,square:lf,squaredDifference:uf,conv1d:Jp,conv2d:Qp,conv3d:Zp,depthwiseConv2d:ng,separableConv2d:ig,conv2dTranspose:og,conv3dTranspose:sg,op:ol,batchNormalization2d:Jf,batchNormalization3d:Qf,batchNormalization4d:Zf,batchNormalization:ep,batchNorm:tp,batchNorm2d:np,batchNorm3d:rp,batchNorm4d:ap,booleanMaskAsync:function(e,t,n){return ui(this,void 0,void 0,function(){var r,a,i,o,s,l,c,u,h,d,f,p,g;return hi(this,function(m){switch(m.label){case 0:for(r=Xs(e,"tensor","boolMask"),a=Xs(t,"mask","boolMask","bool"),i=null==n?0:n,o=a.rank,s=r.shape,Ei(o>0,function(){return"mask cannot be scalar"}),_i(s.slice(i,i+o),a.shape,"mask's shape must match the first K dimensions of tensor's shape,"),l=1,c=i;c<i+o;c++)l*=s[c];return u=s.slice(0,i).concat([l],s.slice(i+o)),h=r.reshape(u),d=a.reshape([-1]),[4,up(d)];case 1:return f=m.sent(),p=f.squeeze([1]),g=qp(h,p,i),e!==r&&r.dispose(),t!==a&&a.dispose(),p.dispose(),h.dispose(),d.dispose(),f.dispose(),[2,g]}})})},complex:sl,real:ll,imag:cl,concat:Nl,concat1d:Sl,concat2d:Cl,concat3d:El,concat4d:_l,split:Il,matMul:lg,dot:cg,outerProduct:ug,reverse:hg,reverse1d:dg,reverse2d:fg,reverse3d:pg,reverse4d:gg,maxPool:bg,avgPool:xg,pool:yg,maxPool3d:wg,avgPool3d:kg,slice:Ng,slice1d:Sg,slice2d:Cg,slice3d:Eg,slice4d:_g,abs:hf,acos:df,acosh:ff,asin:pf,asinh:gf,atan:mf,atanh:vf,ceil:bf,clipByValue:xf,cos:yf,cosh:wf,erf:kf,exp:Nf,expm1:Sf,floor:Cf,log:Ef,log1p:_f,logSigmoid:If,neg:Tf,reciprocal:Af,round:Rf,rsqrt:Df,sigmoid:Ff,sign:Of,isNaN:Lf,isInf:Pf,isFinite:Mf,sin:jf,sinh:Bf,softplus:zf,sqrt:Wf,step:Uf,tan:Vf,tanh:Hf,all:Tg,any:Ag,argMax:Rg,argMin:Dg,logSumExp:Fg,max:Og,mean:Lg,min:Pg,moments:Mg,sum:jg,prod:Bg,equal:Dp,equalStrict:Fp,greater:Op,greaterEqual:Lp,greaterEqualStrict:Pp,greaterStrict:Mp,less:jp,lessEqual:Bp,lessEqualStrict:zp,lessStrict:Wp,notEqual:Up,notEqualStrict:Vp,add:hp,addN:dp,addStrict:fp,atan2:pp,div:gp,divNoNan:mp,divStrict:vp,floorDiv:bp,maximum:xp,maximumStrict:yp,minimum:wp,minimumStrict:kp,mod:Np,modStrict:Sp,mul:Cp,mulStrict:Ep,pow:_p,powStrict:Ip,squaredDifferenceStrict:Tp,sub:Ap,subStrict:Rp,elu:zg,leakyRelu:Wg,prelu:Ug,relu:Vg,relu6:Hg,selu:Gg,logicalAnd:ip,logicalNot:op,logicalOr:sp,logicalXor:lp,where:cp,whereAsync:up,buffer:Wl,print:function(e,t){void 0===t&&(t=!1),console.log(e.toString(t))},batchToSpaceND:Ul,broadcastTo:Vl,cast:Hl,clone:Gl,cumsum:ql,depthToSpace:Kl,expandDims:Xl,eye:Yl,multinomial:$l,oneHot:Jl,pad:Ql,pad1d:Zl,pad2d:ec,pad3d:tc,pad4d:nc,rand:rc,randomNormal:ac,randomGamma:ic,randomUniform:oc,reshape:sc,spaceToBatchND:lc,squeeze:cc,stack:uc,tile:hc,truncatedNormal:dc,unstack:fc,setdiff1dAsync:function(e,t){return ui(this,void 0,void 0,function(){var n,r,a,i,o,s,l,c,u,h;return hi(this,function(d){switch(d.label){case 0:return n=Xs(e,"x","setdiff1d"),r=Xs(t,"y","setdiff1d"),Ei(n.dtype===r.dtype,function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."}),Ei(1===n.rank,function(){return"x should be 1D tensor, but got x ("+n.shape+")."}),Ei(1===r.rank,function(){return"y should be 1D tensor, but got y ("+r.shape+")."}),[4,n.data()];case 1:return a=d.sent(),[4,r.data()];case 2:for(i=d.sent(),o=new Set(i),s=0,u=0;u<a.length;u++)o.has(a[u])||s++;for(l=new vo([s],n.dtype),c=new vo([s],"int32"),u=0,h=0;u<a.length;u++)o.has(a[u])||(l.values[h]=a[u],c.values[h]=u,h++);return[2,[l.toTensor(),c.toTensor()]]}})})},fill:xl,linspace:function(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");return Mo.runKernelFunc(function(r){return r.linspace(e,t,n)},{})},ones:vl,range:yl,scalar:dl,tensor:ul,tensor1d:fl,tensor2d:pl,tensor3d:gl,tensor4d:ml,tensor5d:function(e,t,n){if(Ii(e),null!=t&&5!==t.length)throw new Error("tensor5d() requires shape to have five numbers");var r=qs(e,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return hl(e,t,r,n)},tensor6d:function(e,t,n){if(Ii(e),null!=t&&6!==t.length)throw new Error("tensor6d() requires shape to have six numbers");var r=qs(e,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return hl(e,t=t||r,r,n)},variable:function(e,t,n,r){return void 0===t&&(t=!0),Mo.makeVariable(e,t,n,r)},zeros:bl,onesLike:wl,zerosLike:kl,transpose:qg,softmax:Dc,logSoftmax:Fc,localResponseNormalization:Kg,norm:Xg,gather:qp,unsortedSegmentSum:Kp,basicLSTMCell:Yg,multiRNNCell:$g,movingAverage:Jg,stridedSlice:Qg,topk:Zg,scatterND:em,fft:tm,ifft:nm,rfft:rm,irfft:am,sparseToDense:om,gatherND:sm,diag:lm,dropout:cm,hannWindow:dm,hammingWindow:fm,frame:pm,stft:gm,inTopKAsync:function(e,t,n){return void 0===n&&(n=1),ui(this,void 0,void 0,function(){var r,a,i,o,s,l,c,u,h,d,f,p,g,m;return hi(this,function(v){switch(v.label){case 0:return r=Xs(e,"predictions","inTopK"),a=Xs(t,"targets","inTopK"),Ei(r.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank}),Ei(r.rank-1===a.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+a.rank}),_i(r.shape.slice(0,r.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=r.shape[r.shape.length-1],Ei(n>0&&n<=i,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+i+"), but got "+n}),[4,r.data()];case 1:return o=v.sent(),[4,a.data()];case 2:for(s=v.sent(),l=[o.length/i,i],u=l[1],h=zi("bool",c=l[0]),d=0;d<c;d++){for(f=d*u,p=o.subarray(f,f+u),g=[],m=0;m<p.length;m++)g.push({value:p[m],index:m});for(g.sort(function(e,t){return t.value-e.value}),h[d]=0,m=0;m<n;m++)if(g[m].index===s[d]){h[d]=1;break}}return e!==r&&r.dispose(),t!==a&&a.dispose(),[2,ul(h,a.shape,"bool")]}})})}});function Xm(e,t){Array.isArray(e)||(e=[e]),e.forEach(function(e){null!=e&&Ei("complex64"!==e.dtype,function(){return t+" does not support complex64 tensors."})})}function Ym(e,t,n,r){if("linear"===n)return e.linear(t);if("relu"===n)return e.relu(t);if("elu"===n)return e.elu(t);if("relu6"===n)return e.relu6(t);if("prelu"===n)return e.prelu(t,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var $m=function(e){function t(){var t=e.call(this)||this;return t.blockSize=48,t.firstUse=!0,t.data=new Oc(t,Mo),t}return ci(t,e),t.prototype.write=function(e,t,n){this.firstUse&&(this.firstUse=!1,fi().get("IS_NODE")&&Gs("\n============================\nHi there \ud83d\udc4b. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================"));var r={};return this.data.set(r,{values:e,dtype:n}),r},t.prototype.move=function(e,t,n,r){this.data.set(e,{values:t,dtype:r})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.read=function(e){return ui(this,void 0,void 0,function(){return hi(this,function(t){return[2,this.readSync(e)]})})},t.prototype.readSync=function(e){var t=this.data.get(e),n=t.dtype,r=t.complexTensors;return"complex64"===n?tu(this.readSync(r.real.dataId),this.readSync(r.imag.dataId)):this.data.get(e).values},t.prototype.bufferSync=function(e){var t=this.readSync(e.dataId),n=t;if("string"===e.dtype)try{n=t.map(function(e){return lo(e)})}catch(e){throw new Error("Failed to decode encoded string bytes into utf-8")}return Wl(e.shape,e.dtype,n)},t.prototype.makeOutput=function(e,t,n){var r=this.write(e,t,n);return Mo.makeTensorFromDataId(r,t,n,this)},t.prototype.disposeData=function(e){if(this.data.has(e)){var t=this.data.get(e).complexTensors;null!=t&&(t.real.dispose(),t.imag.dispose()),this.data.delete(e)}},t.prototype.time=function(e){return ui(this,void 0,void 0,function(){var t;return hi(this,function(n){return t=io(),e(),[2,{kernelMs:io()-t}]})})},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(e,t){var n=this.makeOutput(null,e.shape,"complex64");return this.data.get(n.dataId).complexTensors={real:Mo.keep(e.clone()),imag:Mo.keep(t.clone())},n},t.prototype.real=function(e){return this.data.get(e.dataId).complexTensors.real.clone()},t.prototype.imag=function(e){return this.data.get(e.dataId).complexTensors.imag.clone()},t.prototype.slice=function(e,t,n){if(Xm(e,"slice"),Tc(e.shape,t,n)){var r=Ac(t,e.strides),a=Ai(n);return ul(this.readSync(e.dataId).subarray(r,r+a),n,e.dtype)}for(var i=Wl(n,e.dtype),o=this.bufferSync(e),s=0;s<i.size;++s){var l=i.indexToLoc(s).map(function(e,n){return e+t[n]});i.values[s]=o.get.apply(o,l)}return i.toTensor()},t.prototype.stridedSlice=function(e,t,n,r){Xm(e,"stridedSlice");var a=Ec(t,n,r);if(a.some(function(e){return 0===e}))return ul([],a);for(var i=Wl(a,e.dtype),o=this.bufferSync(e),s=0;s<i.size;s++){for(var l=i.indexToLoc(s),c=new Array(l.length),u=0;u<c.length;u++)c[u]=l[u]*r[u]+t[u];i.set.apply(i,[o.get.apply(o,c)].concat(l))}return i.toTensor()},t.prototype.diag=function(e){for(var t=this.readSync(e.dataId),n=Wl([e.size,e.size],e.dtype),r=n.values,a=0;a<t.length;a++)r[a*e.size+a]=t[a];return n.toTensor()},t.prototype.unstack=function(e,t){for(var n=e.shape[t],r=new Array(e.rank-1),a=0,i=0;i<e.rank;i++)i!==t&&(r[a++]=e.shape[i]);var o=new Array(e.rank).fill(0),s=e.shape.slice();s[t]=1;var l=new Array(n);for(i=0;i<l.length;i++)o[t]=i,l[i]=this.slice(e,o,s).reshape(r);return l},t.prototype.reverse=function(e,t){Xm(e,"reverse");for(var n=Wl(e.shape,e.dtype),r=this.bufferSync(e),a=function(a){var i=n.indexToLoc(a),o=i.slice();t.forEach(function(t){return o[t]=e.shape[t]-1-o[t]}),n.set.apply(n,[r.get.apply(r,o)].concat(i))},i=0;i<n.size;i++)a(i);return n.toTensor()},t.prototype.concat=function(e,t){var n=this;if("complex64"===e[0].dtype){var r=e.map(function(e){return ll(e)}),a=e.map(function(e){return cl(e)});return sl(this.concat(r,t),this.concat(a,t))}var i=e.map(function(e){var n=Ai(e.shape.slice(t));return e.as2D(-1,n)}),o=il(i.map(function(e){return e.shape}),1),s=Wl(o,e[0].dtype).values;if(1===i[0].shape[0]){var l=0;i.forEach(function(e){s.set(n.readSync(e.dataId),l),l+=e.size})}else{var c=0;i.forEach(function(e){for(var t=n.readSync(e.dataId),r=0,a=0;a<e.shape[0];++a)for(var i=a*o[1]+c,l=0;l<e.shape[1];++l)s[i+l]=t[r++];c+=e.shape[1]})}var u=il(e.map(function(e){return e.shape}),t);return ul(s,u,e[0].dtype)},t.prototype.neg=function(e){return Xm(e,"neg"),this.multiply(dl(-1),e)},t.prototype.add=function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),function(e,t,n,r){return{real:e+n,imag:t+r}}):this.broadcastedBinaryOp(e,t,To(e.dtype,t.dtype),function(e,t){return e+t})},t.prototype.addN=function(e){var t=this;Xm(e,"addN");for(var n=e.map(function(e){return t.readSync(e.dataId)}),r=Wl(e[0].shape,e[0].dtype),a=r.values,i=0;i<e.length;i++)for(var o=n[i],s=0;s<a.length;s++)a[s]+=o[s];return r.toTensor()},t.prototype.softmax=function(e,t){var n=ji([t],e.shape),r=this.max(e,n),a=Zs(r.shape,n),i=this.subtract(e,r.reshape(a)),o=this.exp(i),s=this.sum(o,n).reshape(a);return this.realDivide(o,s)},t.prototype.subtract=function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),function(e,t,n,r){return{real:e-n,imag:t-r}}):this.broadcastedBinaryOp(e,t,To(e.dtype,t.dtype),function(e,t){return e-t})},t.prototype.pow=function(e,t){return Xm([e,t],"pow"),this.broadcastedBinaryOp(e,t,e.dtype,function(e,t){return Math.pow(e,t)})},t.prototype.batchMatMul=function(e,t,n,r){Xm([e,t],"matMul");for(var a=n?e.shape[1]:e.shape[2],i=n?e.shape[2]:e.shape[1],o=r?t.shape[1]:t.shape[2],s=e.shape[0],l=this.readSync(e.dataId),c=this.readSync(t.dataId),u=n?[e.strides[0],1,e.strides[1]]:[e.strides[0],e.strides[1],1],h=u[0],d=u[1],f=u[2],p=r?[1,t.strides[1],t.strides[0]]:[t.strides[1],1,t.strides[0]],g=p[0],m=p[1],v=p[2],b=i*o,x=Wl([s,i,o],e.dtype),y=x.values,w=this.blockSize,k=0;k<s;k++)for(var N=0;N<i;N+=w)for(var S=0;S<o;S+=w)for(var C=0;C<a;C+=w)for(var E=Math.min(N+w,i),_=Math.min(S+w,o),I=Math.min(C+w,a),T=N;T<E;T++)for(var A=S;A<_;A++){for(var R=0,D=C;D<I;D++)R+=l[k*h+T*d+D*f]*c[D*g+A*m+k*v];y[k*b+(T*o+A)]+=R}return x.toTensor()},t.prototype.fusedBatchMatMul=function(e){var t=e.a,n=e.b,r=e.transposeA,a=e.transposeB,i=e.bias,o=e.activation,s=e.preluActivationWeights,l=this.batchMatMul(t,n,r,a);return i&&(l=this.add(l,i)),o&&(l=Ym(this,l,o,s)),l},t.prototype.multiply=function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),function(e,t,n,r){return{real:e*n-t*r,imag:e*r+t*n}}):this.broadcastedBinaryOp(e,t,To(e.dtype,t.dtype),function(e,t){return e*t})},t.prototype.realDivide=function(e,t){return Xm([e,t],"realDivide"),this.broadcastedBinaryOp(e,t,"float32",function(e,t){return e/t})},t.prototype.floorDiv=function(e,t){return Xm([e,t],"floorDiv"),this.broadcastedBinaryOp(e,t,"int32",function(e,t){return Math.floor(e/t)})},t.prototype.sum=function(e,t){Xm(e,"sum"),el("sum",t,e.rank);for(var n=Qs(e.shape,t),r=n[0],a=n[1],i=bl(r,To(e.dtype,"int32")),o=Ai(a),s=this.readSync(i.dataId),l=this.readSync(e.dataId),c=0;c<s.length;++c){for(var u=c*o,h=0,d=0;d<o;++d)h+=l[u+d];s[c]=h}return i},t.prototype.prod=function(e,t){Xm(e,"sum");for(var n=Qs(e.shape,t),r=n[0],a=n[1],i=bl(r,To(e.dtype,"int32")),o=Ai(a),s=this.readSync(i.dataId),l=this.readSync(e.dataId),c=0;c<s.length;++c){for(var u=c*o,h=1,d=0;d<o;++d)h*=l[u+d];s[c]=h}return i},t.prototype.unsortedSegmentSum=function(e,t,n){Xm(e,"unsortedSegmentSum");for(var r=[],a=e.rank-t.rank,i=0;i<a;++i)t=t.expandDims(i+1);for(i=0;i<n;++i){var o=dl(i,"int32"),s=Dp(o,t).asType("float32").mul(e).sum(0);r.push(s)}return uc(r)},t.prototype.argMin=function(e,t){Xm(e,"argMin");var n=[t];el("argMin",n,e.rank);for(var r=Qs(e.shape,n),a=r[0],i=r[1],o=bl(a,"int32"),s=Ai(i),l=this.readSync(o.dataId),c=this.readSync(e.dataId),u=0;u<l.length;++u){for(var h=u*s,d=c[h],f=0,p=0;p<s;++p){var g=c[h+p];g<d&&(d=g,f=p)}l[u]=f}return o},t.prototype.argMax=function(e,t){Xm(e,"argMax");var n=[t];el("argMax",n,e.rank);for(var r=Qs(e.shape,n),a=r[0],i=r[1],o=bl(a,"int32"),s=Ai(i),l=this.readSync(o.dataId),c=this.readSync(e.dataId),u=0;u<l.length;++u){for(var h=u*s,d=c[h],f=0,p=0;p<s;++p){var g=c[h+p];g>d&&(d=g,f=p)}l[u]=f}return o},t.prototype.cumsum=function(e,t,n,r){if(Xm(e,"cumsum"),t!==e.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(e.rank-1)+" but got axis="+t);for(var a=To(e.dtype,"int32"),i=bl(e.shape,a),o=this.readSync(i.dataId),s=this.readSync(e.dataId),l=e.shape[e.rank-1],c=r?function(e,t){return e+l-t-1}:function(e,t){return e+t},u=0;u<s.length;u+=l)for(var h=0;h<l;h++){var d=c(u,h);if(0===h)o[d]=n?0:s[d];else{var f=c(u,h-1);o[d]=n?s[f]+o[f]:s[d]+o[f]}}return i},t.prototype.equal=function(e,t){return Xm([e,t],"equal"),this.broadcastedBinaryOp(e,t,"bool",function(e,t){return e===t?1:0})},t.prototype.notEqual=function(e,t){return Xm([e,t],"notEqual"),this.broadcastedBinaryOp(e,t,"bool",function(e,t){return e!==t?1:0})},t.prototype.less=function(e,t){return Xm([e,t],"less"),this.broadcastedBinaryOp(e,t,"bool",function(e,t){return e<t?1:0})},t.prototype.lessEqual=function(e,t){return Xm([e,t],"lessEqual"),this.broadcastedBinaryOp(e,t,"bool",function(e,t){return e<=t?1:0})},t.prototype.greater=function(e,t){return Xm([e,t],"greater"),this.broadcastedBinaryOp(e,t,"bool",function(e,t){return e>t?1:0})},t.prototype.greaterEqual=function(e,t){return Xm([e,t],"greaterEqual"),this.broadcastedBinaryOp(e,t,"bool",function(e,t){return e>=t?1:0})},t.prototype.logicalNot=function(e){Xm(e,"logicalNot");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)n[r]=t[r]?0:1;return this.makeOutput(n,e.shape,"bool")},t.prototype.logicalAnd=function(e,t){return Xm([e,t],"logicalAnd"),this.broadcastedBinaryOp(e,t,"bool",function(e,t){return e&&t})},t.prototype.logicalOr=function(e,t){return Xm([e,t],"logicalOr"),this.broadcastedBinaryOp(e,t,"bool",function(e,t){return e||t})},t.prototype.select=function(e,t,n){Xm([e,t,n],"select");for(var r=this.readSync(e.dataId),a=this.readSync(t.dataId),i=this.readSync(n.dataId),o=bl(t.shape,To(t.dtype,n.dtype)),s=this.readSync(o.dataId),l=0,c=0===e.rank||e.rank>1||1===t.rank?1:Ai(t.shape.slice(1)),u=0;u<r.length;u++)for(var h=0;h<c;h++)1===r[u]?s[l++]=a[u]:s[l++]=i[u];return o},t.prototype.where=function(e){Xm([e],"where");var t=this.readSync(e.dataId);return mu(e.shape,t)},t.prototype.topk=function(e,t,n){return Xm(e,"topk"),gu(this.readSync(e.dataId),e.shape,e.dtype,t)},t.prototype.min=function(e,t){Xm(e,"min"),el("min",t,e.rank);for(var n=Qs(e.shape,t),r=n[0],a=n[1],i=bl(r,e.dtype),o=Ai(a),s=this.readSync(i.dataId),l=this.readSync(e.dataId),c=0;c<s.length;++c){for(var u=c*o,h=l[u],d=0;d<o;++d){var f=l[u+d];f<h&&(h=f)}s[c]=h}return i},t.prototype.minimum=function(e,t){return Xm([e,t],"minimum"),this.broadcastedBinaryOp(e,t,e.dtype,function(e,t){return Math.min(e,t)})},t.prototype.mod=function(e,t){return Xm([e,t],"mod"),this.broadcastedBinaryOp(e,t,e.dtype,function(e,t){var n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t})},t.prototype.max=function(e,t){Xm(e,"max"),el("max",t,e.rank);for(var n=Qs(e.shape,t),r=n[0],a=n[1],i=bl(r,e.dtype),o=Ai(a),s=this.readSync(i.dataId),l=this.readSync(e.dataId),c=0;c<s.length;++c){for(var u=c*o,h=l[u],d=0;d<o;++d){var f=l[u+d];f>h&&(h=f)}s[c]=h}return i},t.prototype.maximum=function(e,t){return Xm([e,t],"maximum"),this.broadcastedBinaryOp(e,t,e.dtype,function(e,t){return Math.max(e,t)})},t.prototype.all=function(e,t){Xm(e,"all"),el("all",t,e.rank);for(var n=Qs(e.shape,t),r=n[0],a=n[1],i=bl(r,e.dtype),o=Ai(a),s=this.readSync(i.dataId),l=this.readSync(e.dataId),c=0;c<s.length;++c){for(var u=c*o,h=l[u],d=0;d<o;++d){var f=l[u+d];h=h&&f}s[c]=h}return i},t.prototype.any=function(e,t){Xm(e,"any"),el("any",t,e.rank);for(var n=Qs(e.shape,t),r=n[0],a=n[1],i=bl(r,e.dtype),o=Ai(a),s=this.readSync(i.dataId),l=this.readSync(e.dataId),c=0;c<s.length;++c){for(var u=c*o,h=l[u],d=0;d<o;++d){var f=l[u+d];h=h||f}s[c]=h}return i},t.prototype.squaredDifference=function(e,t){return Xm([e,t],"squaredDifference"),this.broadcastedBinaryOp(e,t,e.dtype,function(e,t){var n=e-t;return n*n})},t.prototype.ceil=function(e){Xm(e,"ceil");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.ceil(t[r]);return this.makeOutput(n,e.shape,"float32")},t.prototype.floor=function(e){Xm(e,"floor");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.floor(t[r]);return this.makeOutput(n,e.shape,"float32")},t.prototype.sign=function(e){Xm(e,"x");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)t[r]<0?n[r]=-1:t[r]>0?n[r]=1:n[r]=0;return this.makeOutput(n,e.shape,"float32")},t.prototype.isNaN=function(e){Xm(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)Number.isNaN(t[r])&&(n[r]=1);return this.makeOutput(n,e.shape,"bool")},t.prototype.isInf=function(e){Xm(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)Math.abs(t[r])===1/0&&(n[r]=1);return this.makeOutput(n,e.shape,"bool")},t.prototype.isFinite=function(e){Xm(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)Number.isFinite(t[r])&&(n[r]=1);return this.makeOutput(n,e.shape,"bool")},t.prototype.round=function(e){Xm(e,"round");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var a=Math.floor(t[r]);t[r]-a<.5?n[r]=Math.floor(t[r]):t[r]-a>.5?n[r]=Math.ceil(t[r]):n[r]=a%2==0?a:a+1}return this.makeOutput(n,e.shape,"float32")},t.prototype.exp=function(e){Xm(e,"exp");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.exp(t[r]);return this.makeOutput(n,e.shape,"float32")},t.prototype.expm1=function(e){Xm(e,"expm1");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.expm1(t[r]);return this.makeOutput(n,e.shape,"float32")},t.prototype.log=function(e){Xm(e,"log");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var a=t[r];n[r]=Math.log(a)}return this.makeOutput(n,e.shape,"float32")},t.prototype.log1p=function(e){Xm(e,"log1p");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var a=t[r];n[r]=Math.log1p(a)}return this.makeOutput(n,e.shape,"float32")},t.prototype.sqrt=function(e){Xm(e,"sqrt");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var a=t[r];n[r]=Math.sqrt(a)}return this.makeOutput(n,e.shape,"float32")},t.prototype.rsqrt=function(e){Xm(e,"rsqrt");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var a=t[r];n[r]=1/Math.sqrt(a)}return this.makeOutput(n,e.shape,"float32")},t.prototype.reciprocal=function(e){Xm(e,"reciprocal");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=1/t[r];return this.makeOutput(n,e.shape,"float32")},t.prototype.linear=function(e){return e},t.prototype.relu=function(e){Xm(e,"relu");for(var t=bl(e.shape,e.dtype),n=this.readSync(t.dataId),r=this.readSync(e.dataId),a=0;a<r.length;++a)n[a]=Math.max(0,r[a]);return t},t.prototype.relu6=function(e){Xm(e,"relu");for(var t=bl(e.shape,e.dtype),n=this.readSync(t.dataId),r=this.readSync(e.dataId),a=0;a<r.length;++a)n[a]=Math.min(Math.max(0,r[a]),6);return t},t.prototype.prelu=function(e,t){return Xm([e,t],"prelu"),this.broadcastedBinaryOp(e,t,e.dtype,function(e,t){return e<0?t*e:e})},t.prototype.elu=function(e){Xm(e,"elu");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r){var a=n[r];t[r]=a>=0?a:Math.exp(a)-1}return this.makeOutput(t,e.shape,"float32")},t.prototype.eluDer=function(e,t){Xm([e,t],"eluDer");for(var n=new Float32Array(t.size),r=this.readSync(t.dataId),a=this.readSync(e.dataId),i=0;i<r.length;++i){var o=r[i];n[i]=o>=1?a[i]:a[i]*(o+1)}return this.makeOutput(n,t.shape,"float32")},t.prototype.selu=function(e){Xm(e,"selu");for(var t=Ad,n=Rd,r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i){var o=a[i];r[i]=o>=0?n*o:t*(Math.exp(o)-1)}return this.makeOutput(r,e.shape,"float32")},t.prototype.clip=function(e,t,n){Xm(e,"clip");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i){var o=a[i];r[i]=o>n?n:o<t?t:o}return this.makeOutput(r,e.shape,"float32")},t.prototype.abs=function(e){for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.abs(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.complexAbs=function(e){for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<e.size;++r){var a=n[2*r],i=n[2*r+1];t[r]=Math.hypot(a,i)}return this.makeOutput(t,e.shape,"float32")},t.prototype.int=function(e){Xm(e,"int");for(var t=new Int32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=n[r];return this.makeOutput(t,e.shape,"int32")},t.prototype.sigmoid=function(e){Xm(e,"sigmoid");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=1/(1+Math.exp(-n[r]));return this.makeOutput(t,e.shape,"float32")},t.prototype.softplus=function(e){Xm(e,"softplus");for(var t=Math.log(1.1920928955078125e-7)+2,n=new Float32Array(e.size),r=this.readSync(e.dataId),a=0;a<r.length;++a){var i,o=r[a]>-t,s=r[a]<t,l=Math.exp(r[a]);i=s?l:o?r[a]:Math.log(1+l),n[a]=i}return this.makeOutput(n,e.shape,"float32")},t.prototype.sin=function(e){Xm(e,"sin");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.sin(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.cos=function(e){Xm(e,"cos");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.cos(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.tan=function(e){Xm(e,"tan");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.tan(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.asin=function(e){Xm(e,"asin");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.asin(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.acos=function(e){Xm(e,"acos");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.acos(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.atan=function(e){Xm(e,"atan");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.atan(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.atan2=function(e,t){return Xm([e,t],"atan2"),this.broadcastedBinaryOp(e,t,e.dtype,function(e,t){return Math.atan2(e,t)})},t.prototype.sinh=function(e){Xm(e,"sinh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.sinh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.cosh=function(e){Xm(e,"cosh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.cosh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.tanh=function(e){Xm(e,"tanh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Fi(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.asinh=function(e){Xm(e,"asinh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.asinh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.acosh=function(e){Xm(e,"acosh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.acosh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.atanh=function(e){Xm(e,"atanh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.atanh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.erf=function(e){Xm(e,"erf");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r){var a=Math.sign(n[r]),i=Math.abs(n[r]),o=1/(1+.3275911*i);t[r]=a*(1-((((1.061405429*o-1.453152027)*o+1.421413741)*o-.284496736)*o+.254829592)*o*Math.exp(-i*i))}return this.makeOutput(t,e.shape,"float32")},t.prototype.step=function(e,t){void 0===t&&(t=0),Xm(e,"step");for(var n=new Float32Array(e.size),r=this.readSync(e.dataId),a=0;a<r.length;++a){var i=r[a];isNaN(i)?n[a]=NaN:n[a]=i>0?1:t}return this.makeOutput(n,e.shape,"float32")},t.prototype.fusedConv2d=function(e){var t=e.input,n=e.filter,r=e.convInfo,a=e.bias,i=e.activation,o=e.preluActivationWeights,s=this.conv2d(t,n,r);return a&&(s=this.add(s,a)),i&&(s=Ym(this,s,i,o)),s},t.prototype.conv2d=function(e,t,n){Xm([e,t],"conv2d");for(var r=n.filterHeight,a=n.filterWidth,i=n.dilationHeight,o=n.dilationWidth,s=n.padInfo.left,l=n.padInfo.top,c="channelsLast"===n.dataFormat,u=Wl(n.outShape,e.dtype),h=e.strides[0],d=c?e.strides[1]:e.strides[2],f=c?e.strides[2]:1,p=c?1:e.strides[1],g=u.strides[0],m=c?u.strides[1]:u.strides[2],v=c?u.strides[2]:1,b=c?1:u.strides[1],x=this.readSync(e.dataId),y=this.readSync(t.dataId),w=u.values,k=0;k<n.batchSize;++k)for(var N=k*h,S=k*g,C=0;C<n.outHeight;++C)for(var E=S+C*m,_=C*n.strideHeight-l,I=0;I<r;I++){var T=_+I*i;if(!(T<0||T>=n.inHeight))for(var A=I*t.strides[0],R=N+T*d,D=0;D<n.outWidth;++D)for(var F=E+D*v,O=D*n.strideWidth-s,L=0;L<a;L++){var P=O+L*o;if(!(P<0||P>=n.inWidth))for(var M=R+P*f,j=A+L*t.strides[1],B=0;B<n.inChannels;++B){for(var z=x[M+B*p],W=0;W<n.outChannels;++W)w[F+W*b]+=z*y[j+W];j+=n.outChannels}}}return u.toTensor()},t.prototype.conv3d=function(e,t,n){for(var r=n.filterDepth,a=n.filterHeight,i=n.filterWidth,o=n.dilationDepth,s=n.dilationHeight,l=n.dilationWidth,c=n.padInfo.front,u=n.padInfo.left,h=n.padInfo.top,d=Wl(n.outShape,e.dtype),f=this.readSync(e.dataId),p=this.readSync(t.dataId),g=d.values,m=0;m<n.batchSize;++m)for(var v=m*e.strides[0],b=m*d.strides[0],x=0;x<n.outDepth;++x)for(var y=b+x*d.strides[1],w=x*n.strideDepth-c,k=0;k<r;k++){var N=w+k*o;if(!(N<0||N>=n.inDepth))for(var S=k*t.strides[0],C=v+N*e.strides[1],E=0;E<n.outHeight;++E)for(var _=y+E*d.strides[2],I=E*n.strideHeight-h,T=0;T<a;T++){var A=I+T*s;if(!(A<0||A>=n.inHeight))for(var R=S+T*t.strides[1],D=C+A*e.strides[2],F=0;F<n.outWidth;++F)for(var O=_+F*n.outChannels,L=F*n.strideWidth-u,P=0;P<i;P++){var M=L+P*l;if(!(M<0||M>=n.inWidth))for(var j=R+P*t.strides[2],B=D+M*n.inChannels,z=j,W=0;W<n.inChannels;++W){for(var U=f[B+W],V=0;V<n.outChannels;++V)g[O+V]+=U*p[z+V];z+=n.outChannels}}}}return d.toTensor()},t.prototype.conv2dDerInput=function(e,t,n){Xm([e,t],"conv2dDerInput");for(var r=Wl(n.inShape,"float32"),a=r.values,i=this.readSync(e.dataId),o=this.readSync(t.dataId),s=t.strides,l=s[0],c=s[1],u=s[2],h=n.batchSize,d=n.filterHeight,f=n.filterWidth,p=n.inChannels,g=n.inHeight,m=n.inWidth,v=n.outChannels,b=n.outHeight,x=n.outWidth,y=n.strideHeight,w=n.strideWidth,k=n.dataFormat,N=d-1-n.padInfo.top,S=f-1-n.padInfo.left,C="channelsLast"===k,E=r.strides[0],_=C?r.strides[1]:r.strides[2],I=C?r.strides[2]:1,T=C?1:r.strides[1],A=e.strides[0],R=C?e.strides[1]:e.strides[2],D=C?e.strides[2]:1,F=C?1:e.strides[1],O=0;O<h;++O)for(var L=0;L<p;++L)for(var P=0;P<g;++P)for(var M=P-N,j=Math.max(0,Math.ceil(M/y)),B=Math.min(b,(d+M)/y),z=0;z<m;++z){for(var W=z-S,U=Math.max(0,Math.ceil(W/w)),V=Math.min(x,(f+W)/w),H=0,G=j;G<B;++G)for(var q=G*y-M,K=U;K<V;++K)for(var X=A*O+R*G+D*K,Y=l*(d-1-q)+c*(f-1-(K*w-W))+u*L,$=0;$<v;++$)H+=i[X+F*$]*o[Y+$];a[E*O+_*P+I*z+T*L]=H}return r.toTensor()},t.prototype.conv3dDerInput=function(e,t,n){for(var r=Wl(n.inShape,"float32"),a=r.values,i=r.strides,o=i[0],s=i[1],l=i[2],c=i[3],u=this.readSync(e.dataId),h=e.strides,d=h[0],f=h[1],p=h[2],g=h[3],m=this.readSync(t.dataId),v=t.strides,b=v[0],x=v[1],y=v[2],w=v[3],k=n.batchSize,N=n.filterDepth,S=n.filterHeight,C=n.filterWidth,E=n.inChannels,_=n.inDepth,I=n.inHeight,T=n.inWidth,A=n.outChannels,R=n.outDepth,D=n.outHeight,F=n.outWidth,O=n.strideDepth,L=n.strideHeight,P=n.strideWidth,M=N-1-n.padInfo.front,j=S-1-n.padInfo.top,B=C-1-n.padInfo.left,z=0;z<k;++z)for(var W=0;W<E;++W)for(var U=0;U<_;++U)for(var V=U-M,H=Math.max(0,Math.ceil(V/O)),G=Math.min(R,(N+V)/O),q=0;q<I;++q)for(var K=q-j,X=Math.max(0,Math.ceil(K/L)),Y=Math.min(D,(S+K)/L),$=0;$<T;++$){for(var J=$-B,Q=Math.max(0,Math.ceil(J/P)),Z=Math.min(F,(C+J)/P),ee=0,te=H;te<G;++te)for(var ne=te*O-V,re=X;re<Y;++re)for(var ae=re*L-K,ie=Q;ie<Z;++ie)for(var oe=d*z+f*te+p*re+g*ie,se=b*(N-1-ne)+x*(S-1-ae)+y*(C-1-(ie*P-J))+w*W,le=0;le<A;++le)ee+=u[oe+le]*m[se+le];a[o*z+s*U+l*q+c*$+W]=ee}return r.toTensor()},t.prototype.conv2dDerFilter=function(e,t,n){Xm([e,t],"conv2dDerFilter");for(var r=n.strideHeight,a=n.strideWidth,i=n.filterHeight,o=n.filterWidth,s="channelsLast"===n.dataFormat,l=Wl(n.filterShape,"float32"),c=n.padInfo.left,u=n.padInfo.top,h=this.bufferSync(e),d=this.bufferSync(t),f=0;f<i;++f)for(var p=Math.max(0,Math.ceil((u-f)/r)),g=Math.min(n.outHeight,(n.inHeight+u-f)/r),m=0;m<o;++m)for(var v=Math.max(0,Math.ceil((c-m)/a)),b=Math.min(n.outWidth,(n.inWidth+c-m)/a),x=0;x<n.inChannels;++x)for(var y=0;y<n.outChannels;++y){for(var w=0,k=0;k<n.batchSize;++k)for(var N=p;N<g;++N)for(var S=f+N*r-u,C=v;C<b;++C){var E=m+C*a-c;w+=s?h.get(k,S,E,x)*d.get(k,N,C,y):h.get(k,x,S,E)*d.get(k,y,N,C)}l.set(w,f,m,x,y)}return l.toTensor()},t.prototype.conv3dDerFilter=function(e,t,n){for(var r=n.strideDepth,a=n.strideHeight,i=n.strideWidth,o=n.filterDepth,s=n.filterHeight,l=n.filterWidth,c=Wl(n.filterShape,"float32"),u=c.values,h=c.strides,d=h[0],f=h[1],p=h[2],g=h[3],m=this.readSync(t.dataId),v=t.strides,b=v[0],x=v[1],y=v[2],w=v[3],k=this.readSync(e.dataId),N=e.strides,S=N[0],C=N[1],E=N[2],_=N[3],I=n.padInfo.front,T=n.padInfo.left,A=n.padInfo.top,R=0;R<o;++R)for(var D=Math.max(0,Math.ceil((I-R)/r)),F=Math.min(n.outDepth,(n.inDepth+I-R)/r),O=R*d,L=0;L<s;++L)for(var P=Math.max(0,Math.ceil((A-L)/a)),M=Math.min(n.outHeight,(n.inHeight+A-L)/a),j=L*f+O,B=0;B<l;++B)for(var z=Math.max(0,Math.ceil((T-B)/i)),W=Math.min(n.outWidth,(n.inWidth+T-B)/i),U=B*p+j,V=0;V<n.inChannels;++V)for(var H=V*g+U,G=0;G<n.outChannels;++G){for(var q=0,K=0;K<n.batchSize;++K)for(var X=K*S,Y=K*b,$=D;$<F;++$)for(var J=(R+$*r-I)*C+X,Q=$*x+Y,Z=P;Z<M;++Z)for(var ee=(L+Z*a-A)*E+J,te=Z*y+Q,ne=z;ne<W;++ne){var re=ne*w+te;q+=k[(B+ne*i-T)*_+ee+V]*m[re+G]}u[H+G]=q}return c.toTensor()},t.prototype.fusedDepthwiseConv2D=function(e){var t=e.input,n=e.filter,r=e.convInfo,a=e.bias,i=e.activation,o=e.preluActivationWeights,s=this.depthwiseConv2D(t,n,r);return a&&(s=this.add(s,a)),i&&(s=Ym(this,s,i,o)),s},t.prototype.depthwiseConv2D=function(e,t,n){Xm([e,t],"depthwiseConv2D");for(var r=n.filterHeight,a=n.filterWidth,i=n.dilationHeight,o=n.dilationWidth,s=n.padInfo.left,l=n.padInfo.top,c=n.outChannels/n.inChannels,u=Wl(n.outShape,e.dtype),h=this.readSync(e.dataId),d=this.readSync(t.dataId),f=u.values,p=0;p<n.batchSize;++p)for(var g=p*e.strides[0],m=p*u.strides[0],v=0;v<n.outHeight;++v)for(var b=m+v*u.strides[1],x=v*n.strideHeight-s,y=0;y<r;++y){var w=x+y*i;if(!(w<0||w>=n.inHeight))for(var k=y*t.strides[0],N=g+w*e.strides[1],S=0;S<n.outWidth;++S)for(var C=b+S*u.strides[2],E=S*n.strideWidth-l,_=0;_<a;++_){var I=E+_*o;if(!(I<0||I>=n.inWidth))for(var T=k+_*t.strides[1],A=N+I*n.inChannels,R=C,D=T,F=0;F<n.inChannels;++F){for(var O=h[A+F],L=0;L<c;++L)f[R+L]+=O*d[D+L];R+=c,D+=c}}}return u.toTensor()},t.prototype.depthwiseConv2DDerInput=function(e,t,n){Xm([e,t],"depthwiseConv2DDerInput");for(var r=Wl(n.inShape,"float32"),a=r.values,i=r.strides,o=i[0],s=i[1],l=i[2],c=this.readSync(e.dataId),u=e.strides,h=u[0],d=u[1],f=u[2],p=this.readSync(t.dataId),g=t.strides,m=g[0],v=g[1],b=g[2],x=n.batchSize,y=n.filterHeight,w=n.filterWidth,k=n.inChannels,N=n.inHeight,S=n.inWidth,C=n.outChannels,E=n.outHeight,_=n.outWidth,I=n.strideHeight,T=n.strideWidth,A=y-1-n.padInfo.top,R=w-1-n.padInfo.left,D=C/k,F=0;F<x;++F)for(var O=0;O<k;++O)for(var L=0;L<N;++L)for(var P=L-A,M=Math.max(0,Math.ceil(P/I)),j=Math.min(E,(y+P)/I),B=0;B<S;++B){for(var z=B-R,W=Math.max(0,Math.ceil(z/T)),U=Math.min(_,(w+z)/T),V=0,H=M;H<j;++H)for(var G=H*I-P,q=W;q<U;++q)for(var K=h*F+d*H+f*q,X=m*(y-1-G)+v*(w-1-(q*T-z))+b*O,Y=0;Y<D;++Y)V+=c[K+(O*D+Y)]*p[X+Y];a[o*F+s*L+l*B+O]=V}return r.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(e,t,n){Xm([e,t],"depthwiseConv2DDerFilter");for(var r=n.strideHeight,a=n.strideWidth,i=n.filterHeight,o=n.filterWidth,s=Wl(n.filterShape,"float32"),l=n.padInfo.left,c=n.padInfo.top,u=n.outChannels/n.inChannels,h=this.bufferSync(e),d=this.bufferSync(t),f=0;f<i;++f)for(var p=Math.max(0,Math.ceil((c-f)/r)),g=Math.min(n.outHeight,(n.inHeight+c-f)/r),m=0;m<o;++m)for(var v=Math.max(0,Math.ceil((l-m)/a)),b=Math.min(n.outWidth,(n.inWidth+l-m)/a),x=0;x<n.outChannels;++x){for(var y=Math.trunc(x/u),w=x%u,k=0,N=0;N<n.batchSize;++N)for(var S=p;S<g;++S)for(var C=f+S*r-c,E=v;E<b;++E){var _=m+E*a-l;k+=h.get(N,C,_,y)*d.get(N,S,E,x)}s.set(k,f,m,y,w)}return s.toTensor()},t.prototype.tile=function(e,t){return Xm(e,"tile"),pu(this.bufferSync(e),t)},t.prototype.pad=function(e,t,n){Xm(e,"pad");var r=t.map(function(t,n){return t[0]+e.shape[n]+t[1]}),a=t.map(function(e){return e[0]}),i=this.bufferSync(e),o=Wl(r,e.dtype);0!==n&&o.values.fill(n);for(var s=0;s<e.size;s++){var l=i.indexToLoc(s),c=l.map(function(e,t){return e+a[t]});o.set.apply(o,[i.get.apply(i,l)].concat(c))}return o.toTensor()},t.prototype.transpose=function(e,t){Xm(e,"transpose");for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[t[r]];var a=this.readSync(e.dataId),i=Wl(n,e.dtype),o=this.bufferSync(e);for(r=0;r<e.size;++r){for(var s=o.indexToLoc(r),l=new Array(s.length),c=0;c<l.length;c++)l[c]=s[t[c]];var u=i.locToIndex(l);i.values[u]=a[r]}return i.toTensor()},t.prototype.gather=function(e,t,n){Xm([e,t],"gather");var r=e.shape.slice(),a=this.readSync(t.dataId);r[n]=a.length;for(var i=Wl(r,e.dtype),o=this.bufferSync(e),s=0;s<i.size;++s){var l=i.indexToLoc(s),c=l.slice();c[n]=a[l[n]];var u=o.locToIndex(c);i.values[s]=o.values[u]}return i.toTensor()},t.prototype.batchToSpaceND=function(e,t,n){Xm([e],"batchToSpaceND");var r=t.reduce(function(e,t){return e*t}),a=pc(e.shape,t,r),i=gc(a.length,t.length),o=mc(e.shape,t,r),s=vc(n,t.length),l=bc(o,n,t.length);return e.reshape(a).transpose(i).reshape(o).slice(s,l)},t.prototype.spaceToBatchND=function(e,t,n){Xm([e],"spaceToBatchND");var r=t.reduce(function(e,t){return e*t}),a=[[0,0]];a.push.apply(a,n);for(var i=1+t.length;i<e.shape.length;++i)a.push([0,0]);var o=e.pad(a),s=pc(o.shape,t,r,!1),l=gc(s.length,t.length,!1),c=mc(o.shape,t,r,!1);return o.reshape(s).transpose(l).reshape(c)},t.prototype.pool=function(e,t,n){Xm(e,"pool");for(var r=t.strideHeight,a=t.strideWidth,i=t.dilationHeight,o=t.dilationWidth,s=t.effectiveFilterHeight,l=t.effectiveFilterWidth,c=t.padInfo.top,u=t.padInfo.left,h="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,d=this.readSync(e.dataId),f=Wl(t.outShape,e.dtype),p=f.values,g=t.outShape[1]*t.outShape[2]*t.outShape[3],m=t.outShape[2]*t.outShape[3],v=t.outShape[3],b=0;b<t.batchSize;++b)for(var x=b*g,y=b*e.strides[0],w=0;w<t.inChannels;++w)for(var k=0;k<t.outHeight;++k)for(var N=k*r-c,S=Math.max(0,N),C=Math.min(t.inHeight,s+N),E=x+k*m,_=0;_<t.outWidth;++_){for(var I=_*a-u,T=Math.max(0,I),A=Math.min(t.inWidth,l+I),R=h,D=0,F=0,O=S;O<C;O+=i){for(var L=y+O*e.strides[1],P=T;P<A;P+=o){var M=d[L+P*e.strides[2]+w];"max"===n&&M>R?R=M:"avg"===n&&(D+=M,F++)}if(isNaN(R))break}p[E+_*v+w]="avg"===n?D/F:R}return f.toTensor()},t.prototype.maxPool=function(e,t){return this.pool(e,t,"max")},t.prototype.maxPoolPositions=function(e,t){for(var n=Wl(t.outShape,"int32"),r=t.strideHeight,a=t.strideWidth,i=t.dilationHeight,o=t.dilationWidth,s=t.effectiveFilterHeight,l=t.effectiveFilterWidth,c=t.padInfo.top,u=t.padInfo.left,h=this.bufferSync(e),d=0;d<t.batchSize;++d)for(var f=0;f<t.inChannels;++f)for(var p=0;p<t.outHeight;++p){for(var g=p*r-c,m=g;m<0;)m+=i;for(var v=Math.min(t.inHeight,s+g),b=0;b<t.outWidth;++b){for(var x=b*a-u,y=x;y<0;)y+=o;for(var w=Math.min(t.inWidth,l+x),k=Number.NEGATIVE_INFINITY,N=-1,S=m;S<v;S+=i)for(var C=S-g,E=y;E<w;E+=o){var _=E-x,I=h.get(d,S,E,f);I>k&&(k=I,N=C*l+_)}n.set(N,d,p,b,f)}}return n.toTensor()},t.prototype.maxPoolBackprop=function(e,t,n,r){Xm([t,n],"maxPoolBackprop");for(var a=this.maxPoolPositions(t,r),i=r.strideHeight,o=r.strideWidth,s=r.dilationHeight,l=r.dilationWidth,c=r.effectiveFilterHeight,u=r.effectiveFilterWidth,h=u-1-r.padInfo.left,d=c-1-r.padInfo.top,f=Wl(t.shape,"float32"),p=this.bufferSync(a),g=this.bufferSync(e),m=0;m<r.batchSize;++m)for(var v=0;v<r.inChannels;++v)for(var b=0;b<r.inHeight;++b)for(var x=0;x<r.inWidth;++x){for(var y=b-d,w=x-h,k=0,N=0;N<c;N+=s){var S=(y+N)/i;if(!(S<0||S>=r.outHeight||Math.floor(S)!==S))for(var C=0;C<u;C+=l){var E=(w+C)/o;if(!(E<0||E>=r.outWidth||Math.floor(E)!==E)){var _=c*u-1-p.get(m,S,E,v)===N*u+C?1:0;0!==_&&(k+=g.get(m,S,E,v)*_)}}}f.set(k,m,b,x,v)}return f.toTensor()},t.prototype.avgPoolBackprop=function(e,t,n){Xm([e,t],"avgPoolBackprop");for(var r=n.strideHeight,a=n.strideWidth,i=n.filterHeight,o=n.filterWidth,s=n.dilationHeight,l=n.dilationWidth,c=n.effectiveFilterHeight,u=n.effectiveFilterWidth,h=u-1-n.padInfo.left,d=c-1-n.padInfo.top,f=Wl(t.shape,"float32"),p=1/(i*o),g=this.bufferSync(e),m=0;m<n.batchSize;++m)for(var v=0;v<n.inChannels;++v)for(var b=0;b<n.inHeight;++b)for(var x=0;x<n.inWidth;++x){for(var y=b-d,w=x-h,k=0,N=0;N<c;N+=s){var S=(y+N)/r;if(!(S<0||S>=n.outHeight||Math.floor(S)!==S))for(var C=0;C<u;C+=l){var E=(w+C)/a;E<0||E>=n.outWidth||Math.floor(E)!==E||(k+=g.get(m,S,E,v))}}f.set(k*p,m,b,x,v)}return f.toTensor()},t.prototype.pool3d=function(e,t,n){Xm(e,"pool3d");for(var r=t.strideDepth,a=t.strideHeight,i=t.strideWidth,o=t.dilationDepth,s=t.dilationHeight,l=t.dilationWidth,c=t.effectiveFilterDepth,u=t.effectiveFilterHeight,h=t.effectiveFilterWidth,d=t.padInfo.front,f=t.padInfo.top,p=t.padInfo.left,g="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=this.readSync(e.dataId),v=Wl(t.outShape,e.dtype),b=v.values,x=t.outShape[1]*t.outShape[2]*t.outShape[3]*t.outShape[4],y=t.outShape[2]*t.outShape[3]*t.outShape[4],w=t.outShape[3]*t.outShape[4],k=t.outShape[4],N=0;N<t.batchSize;++N)for(var S=N*x,C=N*e.strides[0],E=0;E<t.inChannels;++E)for(var _=0;_<t.outDepth;++_){for(var I=_*r-d,T=I;T<0;)T+=o;for(var A=Math.min(t.inDepth,c+I),R=S+_*y,D=0;D<t.outHeight;++D){for(var F=D*a-f,O=F;O<0;)O+=s;for(var L=Math.min(t.inHeight,u+F),P=R+D*w,M=0;M<t.outWidth;++M){for(var j=M*i-p,B=j;B<0;)B+=l;for(var z=Math.min(t.inWidth,h+j),W=P+M*k,U=g,V=0,H=0,G=T;G<A;G+=o){for(var q=C+G*e.strides[1],K=O;K<L;K+=s){for(var X=q+K*e.strides[2],Y=B;Y<z;Y+=l){var $=m[X+Y*e.strides[3]+E];if("max"===n&&$>U?U=$:"avg"===n&&(V+=$,H++),isNaN(U))break}if(isNaN(U))break}if(isNaN(U))break}b[W+E]="avg"===n?V/H:U}}}return v.toTensor()},t.prototype.avgPool3d=function(e,t){return Xm(e,"avgPool3d"),this.pool3d(e,t,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(e,t,n){Xm([e,t],"avgPool3dBackprop");for(var r=n.strideDepth,a=n.strideHeight,i=n.strideWidth,o=n.filterDepth,s=n.filterHeight,l=n.filterWidth,c=n.dilationDepth,u=n.dilationHeight,h=n.dilationWidth,d=n.effectiveFilterDepth,f=n.effectiveFilterHeight,p=n.effectiveFilterWidth,g=d-1-n.padInfo.front,m=p-1-n.padInfo.left,v=f-1-n.padInfo.top,b=Wl(t.shape,"float32"),x=1/(o*s*l),y=this.bufferSync(e),w=0;w<n.batchSize;++w)for(var k=0;k<n.inChannels;++k)for(var N=0;N<n.inDepth;++N)for(var S=0;S<n.inHeight;++S)for(var C=0;C<n.inWidth;++C){for(var E=N-g,_=S-v,I=C-m,T=0,A=0;A<d;A+=c){var R=(E+A)/r;if(!(R<0||R>=n.outDepth||Math.floor(R)!==R))for(var D=0;D<f;D+=u){var F=(_+D)/a;if(!(F<0||F>=n.outHeight||Math.floor(F)!==F))for(var O=0;O<p;O+=h){var L=(I+O)/i;L<0||L>=n.outWidth||Math.floor(L)!==L||(T+=y.get(w,R,F,L,k))}}}b.set(T*x,w,N,S,C,k)}return b.toTensor()},t.prototype.maxPool3d=function(e,t){return Xm(e,"maxPool3d"),this.pool3d(e,t,"max").toFloat()},t.prototype.maxPool3dPositions=function(e,t){for(var n=Wl(t.outShape,"int32"),r=t.strideDepth,a=t.strideHeight,i=t.strideWidth,o=t.dilationDepth,s=t.dilationHeight,l=t.dilationWidth,c=t.effectiveFilterDepth,u=t.effectiveFilterHeight,h=t.effectiveFilterWidth,d=t.padInfo.front,f=t.padInfo.top,p=t.padInfo.left,g=this.bufferSync(e),m=0;m<t.batchSize;++m)for(var v=0;v<t.inChannels;++v)for(var b=0;b<t.outDepth;++b){for(var x=b*r-d,y=x;y<0;)y+=o;for(var w=Math.min(t.inDepth,c+x),k=0;k<t.outHeight;++k){for(var N=k*a-f,S=N;S<0;)S+=s;for(var C=Math.min(t.inHeight,u+N),E=0;E<t.outWidth;++E){for(var _=E*i-p,I=_;I<0;)I+=l;for(var T=Math.min(t.inWidth,h+_),A=Number.NEGATIVE_INFINITY,R=-1,D=y;D<w;D+=o)for(var F=D-x,O=S;O<C;O+=s)for(var L=O-N,P=I;P<T;P+=l){var M=P-_,j=g.get(m,D,O,P,v);j>=A&&(A=j,R=F*u*h+L*u+M)}n.set(R,m,b,k,E,v)}}}return n.toTensor()},t.prototype.maxPool3dBackprop=function(e,t,n,r){Xm([t,n],"maxPool3dBackprop");for(var a=this.maxPool3dPositions(t,r),i=r.strideDepth,o=r.strideHeight,s=r.strideWidth,l=r.dilationDepth,c=r.dilationHeight,u=r.dilationWidth,h=r.effectiveFilterDepth,d=r.effectiveFilterHeight,f=r.effectiveFilterWidth,p=h-1-r.padInfo.front,g=f-1-r.padInfo.left,m=d-1-r.padInfo.top,v=Wl(t.shape,"float32"),b=this.bufferSync(a),x=this.bufferSync(e),y=0;y<r.batchSize;++y)for(var w=0;w<r.inChannels;++w)for(var k=0;k<r.inDepth;++k)for(var N=0;N<r.inHeight;++N)for(var S=0;S<r.inWidth;++S){for(var C=k-p,E=N-m,_=S-g,I=0,T=0;T<h;T+=l){var A=(C+T)/i;if(!(A<0||A>=r.outDepth||Math.floor(A)!==A))for(var R=0;R<d;R+=c){var D=(E+R)/o;if(!(D<0||D>=r.outHeight||Math.floor(D)!==D))for(var F=0;F<f;F+=u){var O=(_+F)/s;if(!(O<0||O>=r.outWidth||Math.floor(O)!==O)){var L=h*d*f-1-b.get(y,A,D,O,w)===T*d*f+R*f+F?1:0;0!==L&&(I+=x.get(y,A,D,O,w)*L)}}}}v.set(I,y,k,N,S,w)}return v.toTensor()},t.prototype.cast=function(e,t){return Qc(e,t,this)},t.prototype.reshape=function(e,t){return Zc(e,t)},t.prototype.avgPool=function(e,t){return Xm(e,"avgPool"),this.pool(e,t,"avg").toFloat()},t.prototype.resizeBilinear=function(e,t,n,r){Xm(e,"resizeBilinear");for(var a=e.shape,i=a[0],o=a[1],s=a[2],l=a[3],c=this.readSync(e.dataId),u=new Float32Array(Ai([i,t,n,l])),h=[r&&t>1?o-1:o,r&&n>1?s-1:s],d=[r&&t>1?t-1:t,r&&n>1?n-1:n],f=0,p=h[0]/d[0],g=h[1]/d[1],m=0;m<i;m++)for(var v=0;v<t;v++)for(var b=p*v,x=Math.floor(b),y=b-x,w=Math.min(o-1,Math.ceil(b)),k=m*e.strides[0]+x*e.strides[1],N=m*e.strides[0]+w*e.strides[1],S=0;S<n;S++)for(var C=g*S,E=Math.floor(C),_=C-E,I=Math.min(s-1,Math.ceil(C)),T=k+E*e.strides[2],A=N+E*e.strides[2],R=k+I*e.strides[2],D=N+I*e.strides[2],F=0;F<l;F++){var O=c[T+F],L=c[A+F],P=O+(c[R+F]-O)*_,M=P+(L+(c[D+F]-L)*_-P)*y;u[f++]=M}return ul(u,[i,t,n,l])},t.prototype.resizeBilinearBackprop=function(e,t,n){Xm([e,t],"resizeBilinearBackprop");for(var r=t.shape,a=r[0],i=r[1],o=r[2],s=r[3],l=e.shape,c=l[1],u=l[2],h=new Float32Array(a*i*o*s),d=[n&&c>1?i-1:i,n&&u>1?o-1:o],f=[n&&c>1?c-1:c,n&&u>1?u-1:u],p=d[0]/f[0],g=d[1]/f[1],m=this.readSync(e.dataId),v=0,b=0;b<a;b++)for(var x=b*t.strides[0],y=0;y<c;y++)for(var w=y*p,k=Math.floor(w),N=Math.min(Math.ceil(w),i-1),S=x+k*t.strides[1],C=x+N*t.strides[1],E=w-k,_=1-E,I=0;I<u;I++)for(var T=I*g,A=Math.floor(T),R=Math.min(Math.ceil(T),o-1),D=T-A,F=1-D,O=S+A*t.strides[2],L=S+R*t.strides[2],P=C+A*t.strides[2],M=C+R*t.strides[2],j=_*F,B=_*D,z=E*F,W=E*D,U=0;U<s;U++){var V=m[v++];h[O+U]+=V*j,h[L+U]+=V*B,h[P+U]+=V*z,h[M+U]+=V*W}return ml(h,[a,o,i,s],t.dtype)},t.prototype.resizeNearestNeighbor=function(e,t,n,r){Xm(e,"resizeNearestNeighbor");for(var a=e.shape,i=a[0],o=a[1],s=a[2],l=a[3],c=this.readSync(e.dataId),u=new Float32Array(i*t*n*l),h=[r&&t>1?o-1:o,r&&n>1?s-1:s],d=[r&&t>1?t-1:t,r&&n>1?n-1:n],f=h[0]/d[0],p=h[1]/d[1],g=0,m=0;m<i;m++)for(var v=m*e.strides[0],b=0;b<t;b++)for(var x=f*b,y=v+Math.min(o-1,r?Math.round(x):Math.floor(x))*e.strides[1],w=0;w<n;w++)for(var k=p*w,N=y+Math.min(s-1,r?Math.round(k):Math.floor(k))*e.strides[2],S=0;S<l;S++){var C=c[N+S];u[g++]=C}return ul(u,[i,t,n,l],e.dtype)},t.prototype.resizeNearestNeighborBackprop=function(e,t,n){Xm([e,t],"resizeNearestNeighborBackprop");for(var r=t.shape,a=r[0],i=r[1],o=r[2],s=r[3],l=e.shape,c=l[1],u=l[2],h=new Float32Array(a*i*o*s),d=this.readSync(e.dataId),f=[n&&c>1?i-1:i,n&&u>1?o-1:o],p=[n&&c>1?c-1:c,n&&u>1?u-1:u],g=f[0]/p[0],m=f[1]/p[1],v=1/g,b=1/m,x=2*Math.ceil(v)+2,y=2*Math.ceil(b)+2,w=0;w<a;w++)for(var k=w*t.strides[0],N=0;N<i;N++)for(var S=k+N*t.strides[1],C=Math.floor(N*v),E=Math.floor(C-x/2),_=0;_<o;_++)for(var I=S+_*t.strides[2],T=Math.floor(_*b),A=Math.floor(T-y/2),R=0;R<s;R++){for(var D=0,F=0;F<x;F++){var O=F+E;if(!(O<0||O>=c)){var L=k+O*e.strides[1],P=O*g;if(N===Math.min(i-1,n?Math.round(P):Math.floor(P)))for(var M=0;M<y;M++){var j=M+A;if(!(j<0||j>=u)){var B=L+j*e.strides[2],z=j*m;_===Math.min(o-1,n?Math.round(z):Math.floor(z))&&(D+=d[B+R])}}}}h[I+R]=D}return ml(h,t.shape,t.dtype)},t.prototype.batchNormalization=function(e,t,n,r,a,i){Xm([e,t,n,a,i],"batchNorm");for(var o=this.readSync(e.dataId),s=this.readSync(t.dataId),l=this.readSync(n.dataId),c=a?this.readSync(a.dataId):new Float32Array([1]),u=i?this.readSync(i.dataId):new Float32Array([0]),h=new Float32Array(o.length),d=u.length,f=c.length,p=l.length,g=s.length,m=0,v=0,b=0,x=0,y=0;y<o.length;++y)h[y]=u[m++]+(o[y]-s[v++])*c[b++]/Math.sqrt(l[x++]+r),m>=d&&(m=0),v>=g&&(v=0),b>=f&&(b=0),x>=p&&(x=0);return ml(h,e.shape)},t.prototype.localResponseNormalization4D=function(e,t,n,r,a){Xm(e,"localResponseNormalization4D");var i=e.shape[3],o=i-1,s=this.readSync(e.dataId),l=e.size,c=new Float32Array(l);function u(e){for(var n=e%i,r=e-n+Math.max(0,n-t),a=e-n+Math.min(n+t,o),l=0;r<=a;r++){var c=s[r];l+=c*c}return l}for(var h=0;h<l;h++){var d=u(h),f=s[h]*Math.pow(n+r*d,-a);c[h]=f}return ml(c,e.shape)},t.prototype.LRNGrad=function(e,t,n,r,a,i,o){Xm(e,"LRNGrad");for(var s=e.shape[3],l=this.readSync(e.dataId),c=this.readSync(t.dataId),u=this.readSync(n.dataId),h=new Float32Array(e.size),d=e.size,f=0;f<d;f++){for(var p=f%s,g=f-p+Math.max(0,p-r),m=f-p+Math.min(s,p+r+1),v=0,b=g;b<m;b++)v+=Math.pow(c[b],2);for(v=i*v+a,b=g;b<m;b++){var x=-2*i*o*c[b]*u[f]/v;f===b&&(x+=Math.pow(v,-o)),x*=l[f],h[b]+=x}}return ml(h,e.shape)},t.prototype.multinomial=function(e,t,n,r){Xm(e,"multinomial");for(var a=t?e:Dc(e),i=a.shape[0],o=a.shape[1],s=bl([i,n],"int32"),l=this.readSync(s.dataId),c=this.readSync(a.dataId),u=0;u<i;++u){var h=u*o,d=new Float32Array(o-1);d[0]=c[h];for(var f=1;f<d.length;++f)d[f]=d[f-1]+c[h+f];for(var p=Ml(r.toString()),g=u*n,m=0;m<n;++m){var v=p();l[g+m]=d.length;for(var b=0;b<d.length;b++)if(v<d[b]){l[g+m]=b;break}}}return s},t.prototype.oneHot=function(e,t,n,r){Xm(e,"oneHot");var a=new Float32Array(e.size*t);a.fill(r);for(var i=this.readSync(e.dataId),o=0;o<e.size;++o)i[o]>=0&&i[o]<t&&(a[o*t+i[o]]=n);return pl(a,[e.size,t],"int32")},t.prototype.nonMaxSuppression=function(e,t,n,r,a){return Xm(e,"nonMaxSuppression"),su(this.readSync(e.dataId),this.readSync(t.dataId),n,r,a)},t.prototype.fft=function(e){return this.fftBatch(e,!1)},t.prototype.ifft=function(e){return this.fftBatch(e,!0)},t.prototype.fftBatch=function(e,t){for(var n=e.shape[0],r=e.shape[1],a=Wl(e.shape,"float32"),i=Wl(e.shape,"float32"),o=ll(e).as2D(n,r),s=cl(e).as2D(n,r),l=0;l<n;l++)for(var c=o.slice([l,0],[1,r]),u=s.slice([l,0],[1,r]),h=sl(c,u),d=this.readSync(this.fftImpl(h,t).dataId),f=0;f<r;f++){var p=nu(d,f);a.values[l*r+f]=p.real,i.values[l*r+f]=p.imag}return sl(a.toTensor(),i.toTensor()).as2D(n,r)},t.prototype.fftImpl=function(e,t){var n=e.as1D(),r=n.size;if(this.isExponentOf2(r)){var a=this.fftRadix2(n,r,t).as2D(e.shape[0],e.shape[1]);return t&&(a=sl(ll(a).div(dl(r)),cl(a).div(dl(r)))),a}var i=this.readSync(e.dataId),o=function(e){for(var t=new Float32Array(e.length/2),n=new Float32Array(e.length/2),r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}(this.fourierTransformByMatmul(i,r,t));return sl(o.real,o.imag).as2D(e.shape[0],e.shape[1])},t.prototype.isExponentOf2=function(e){return 0==(e&e-1)},t.prototype.fftRadix2=function(e,t,n){if(1===t)return e;var r=this.readSync(e.dataId),a=t/2,i=function(e){for(var t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t),a=0;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}(r),o=sl(i.real,i.imag).as1D(),s=function(e){for(var t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t),a=2;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}(r),l=sl(s.real,s.imag).as1D();o=this.fftRadix2(o,a,n),l=this.fftRadix2(l,a,n);var c=function(e,t){for(var n=new Float32Array(e/2),r=new Float32Array(e/2),a=0;a<Math.ceil(e/2);a++){var i=(t?2:-2)*Math.PI*(a/e);n[a]=Math.cos(i),r[a]=Math.sin(i)}return{real:n,imag:r}}(t,n),u=sl(c.real,c.imag).mul(l),h=o.add(u),d=o.sub(u),f=ll(h).concat(ll(d)),p=cl(h).concat(cl(d));return sl(f,p).as1D()},t.prototype.fourierTransformByMatmul=function(e,t,n){for(var r=new Float32Array(2*t),a=0;a<t;a++){for(var i=0,o=0,s=0;s<t;s++){var l=au(a*s,t,n),c=nu(e,s);i+=c.real*l.real-c.imag*l.imag,o+=c.real*l.imag+c.imag*l.real}n&&(i/=t,o/=t),ru(r,i,o,a)}return r},t.prototype.depthToSpace=function(e,t,n){Ei("NHWC"===n,function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+n}),Ei(t>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+t});for(var r=e.shape[0],a=e.shape[1],i=e.shape[2],o=e.shape[3],s=a*t,l=i*t,c=o/(t*t),u=this.readSync(e.dataId),h=new Float32Array(r*s*l*c),d=0,f=0;f<r;++f)for(var p=0;p<s;++p)for(var g=Math.floor(p/t),m=p%t,v=0;v<l;++v)for(var b=Math.floor(v/t),x=(m*t+v%t)*c,y=0;y<c;++y){var w=y+x+o*(b+i*(g+a*f));h[d++]=u[w]}return ml(h,[r,s,l,c])},t.prototype.broadcastedBinaryOp=function(e,t,n,r){var a=Bc(e.shape,t.shape),i=Wl(a,n),o=this.readSync(e.dataId),s=this.readSync(t.dataId),l=Mc(e.shape,a),c=Mc(t.shape,a),u=i.values;if(l.length+c.length===0)for(var h=0;h<u.length;++h)u[h]=r(o[h%o.length],s[h%s.length]);else{var d=this.bufferSync(e),f=this.bufferSync(t),p=function(n){var a=i.indexToLoc(n),h=a.slice(-e.rank);l.forEach(function(e){return h[e]=0});var p=d.locToIndex(h),g=a.slice(-t.rank);c.forEach(function(e){return g[e]=0});var m=f.locToIndex(g);u[n]=r(o[p],s[m])};for(h=0;h<u.length;++h)p(h)}return i.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(e,t,n){var r=Bc(e.shape,t.shape),a=Wl(r,"float32"),i=Wl(r,"float32"),o=this.readSync(e.dataId),s=this.readSync(t.dataId),l=Mc(e.shape,r),c=Mc(t.shape,r),u=a.values,h=i.values;if(l.length+c.length===0)for(var d=0;d<u.length;d++){var f=d%o.length,p=d%s.length,g=n(o[2*f],o[2*f+1],s[2*p],s[2*p+1]);u[d]=g.real,h[d]=g.imag}else{var m=this.bufferSync(this.data.get(e.dataId).complexTensors.real),v=this.bufferSync(this.data.get(t.dataId).complexTensors.real),b=function(r){var i=a.indexToLoc(r),d=i.slice(-e.rank);l.forEach(function(e){return d[e]=0});var f=m.locToIndex(d),p=i.slice(-t.rank);c.forEach(function(e){return p[e]=0});var g=v.locToIndex(p),b=n(o[2*f],o[2*f+1],s[2*g],s[2*g+1]);u[r]=b.real,h[r]=b.imag};for(d=0;d<u.length;d++)b(d)}return this.complex(a.toTensor(),i.toTensor())},t.prototype.split=function(e,t,n){return fu(e,t,n)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(e,t,n,r,a,i){for(var o=e.shape,s=o[0],l=o[1],c=o[2],u=o[3],h=t.shape[0],d=r[0],f=r[1],p=Wl([h,d,f,u],"float32"),g=this.readSync(t.dataId),m=this.readSync(n.dataId),v=this.readSync(e.dataId),b=e.strides,x=p.strides,y=0;y<h;y++){var w=4*y,k=g[w],N=g[w+1],S=g[w+2],C=g[w+3],E=m[y];if(!(E>=s))for(var _=d>1?(S-k)*(l-1)/(d-1):0,I=f>1?(C-N)*(c-1)/(f-1):0,T=0;T<d;T++){var A=d>1?k*(l-1)+T*_:.5*(k+S)*(l-1);if(A<0||A>l-1)for(var R=0;R<f;R++)for(var D=0;D<u;D++){var F=D+R*x[2]+T*x[1]+y*x[0];p.values[F]=i}else if("bilinear"===a){var O=Math.floor(A),L=Math.ceil(A),P=A-O;for(R=0;R<f;R++)if((G=f>1?N*(c-1)+R*I:.5*(N+C)*(c-1))<0||G>c-1)for(D=0;D<u;D++)F=D+R*x[2]+T*x[1]+y*x[0],p.values[F]=i;else{var M=Math.floor(G),j=Math.ceil(G),B=G-M;for(D=0;D<u;D++){var z=v[F=D+M*b[2]+O*b[1]+E*b[0]],W=v[F=D+j*b[2]+O*b[1]+E*b[0]],U=v[F=D+M*b[2]+L*b[1]+E*b[0]],V=z+(W-z)*B,H=U+(v[F=D+j*b[2]+L*b[1]+E*b[0]]-U)*B;F=D+R*x[2]+T*x[1]+y*x[0],p.values[F]=V+(H-V)*P}}}else for(R=0;R<f;++R){var G;if((G=f>1?N*(c-1)+R*I:.5*(N+C)*(c-1))<0||G>c-1)for(D=0;D<u;D++)F=D+R*x[2]+T*x[1]+y*x[0],p.values[F]=i;else{var q=Math.round(G),K=Math.round(A);for(D=0;D<u;D++){var X=D+q*b[2]+K*b[1]+E*b[0],Y=D+R*x[2]+T*x[1]+y*x[0];p.values[Y]=v[X]}}}}}return p.toTensor()},t.prototype.sparseToDense=function(e,t,n,r){var a=Nc(0,e,n),i=a.sliceRank,o=a.numUpdates,s=a.sliceSize,l=a.strides,c=a.outputSize;return this.scatter(e,t,n,c,s,o,i,l,r,!1)},t.prototype.gatherND=function(e,t){var n=t.shape,r=n[n.length-1],a=xc(e,t),i=a[0],o=a[1],s=a[2],l=a[3];if(0===o)return ul([],i,e.dtype);for(var c=new vo([o,s],e.dtype),u=this.readSync(t.dataId),h=this.readSync(e.dataId),d=0;d<o;d++){for(var f=[],p=0,g=0;g<r;g++){var m=u[d*r+g];p+=m*l[g],f.push(m)}if(p<0||p>=e.size/s)throw new Error("Invalid indices: "+f+" does not index into "+e.shape);for(var v=0;v<s;v++)c.values[d*s+v]=h[p*s+v]}return c.toTensor().reshape(i)},t.prototype.scatterND=function(e,t,n){var r=Nc(0,e,n),a=r.sliceRank,i=r.numUpdates,o=r.sliceSize,s=r.strides,l=r.outputSize,c=dl(0);return this.scatter(e,t,n,l,o,i,a,s,c,!0)},t.prototype.fill=function(e,t,n){var r=Wi(n=n||Ji(t),Ai(e));return r.fill(t),Mo.makeTensor(r,e,n,this)},t.prototype.onesLike=function(e){if("string"===e.dtype)throw new Error("onesLike is not supported for string tensors");return this.fill(e.shape,1,e.dtype)},t.prototype.zerosLike=function(e){var t=Wi(e.dtype,Ai(e.shape));return this.makeOutput(t,e.shape,e.dtype)},t.prototype.linspace=function(e,t,n){return eu(e,t,n)},t.prototype.scatter=function(e,t,n,r,a,i,o,s,l,c){var u=[r/a,a],h=this.readSync(e.dataId),d=this.readSync(t.dataId);if(0===r)return ul([],n,t.dtype);var f=new vo(u,t.dtype);f.values.fill(this.readSync(l.dataId)[0]);for(var p=0;p<i;p++){for(var g=[],m=0,v=0;v<o;v++){var b=h[p*o+v];g.push(b),m+=b*s[v]}if(m<0||m>=r/a)throw new Error("Invalid indices: "+g+" does not index into "+n);for(var x=0;x<a;x++)c?f.values[m*a+x]+=d[p*a+x]:f.values[m*a+x]=0===t.rank?d[0]:d[p*a+x]}return f.toTensor().reshape(n)},t}(Lc);Mo.registerBackend("cpu",function(){return new $m},1);for(var Jm=0,Qm=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t,i=a.boxes,o=a.scores,s=r,l=s.maxOutputSize,c=s.iouThreshold,u=s.scoreThreshold,h=s.softNmsSigma,d=n;Xm(i,"NonMaxSuppressionWithScore");var f=lu(d.data.get(i.dataId).values,d.data.get(o.dataId).values,l,c,u,h);return[f.selectedIndices,f.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n;Xm(r,"square");for(var i=a.data.get(r.dataId).values,o=new Float32Array(i.length),s=0;s<i.length;++s){var l=i[s];o[s]=l*l}return{dataId:a.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:cf,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,a=r.a,i=r.b,o=n;Xm([a,i],cf);var s=o.data.get(a.dataId).values,l=o.data.get(i.dataId).values,c=function(e,t,n,r,a,i){var o=Bc(e,t),s=o.length,l=eo(o),c=zi(a,Ai(o)),u=e.length,h=t.length,d=eo(e),f=eo(t),p=Mc(e,o),g=Mc(t,o);if(p.length+g.length===0)for(var m=0;m<c.length;++m)c[m]=i(n[m%n.length],r[m%r.length]);else{var v=function(e){var t=uo(e,s,l),a=t.slice(-u);p.forEach(function(e){return a[e]=0});var o=co(a,u,d),m=t.slice(-h);g.forEach(function(e){return m[e]=0});var v=co(m,h,f);c[e]=i(n[o],r[v])};for(m=0;m<c.length;++m)v(m)}return[c,o]}(a.shape,i.shape,s,l,a.dtype,function(e,t){var n=e-t;return n*n}),u=c[0],h=c[1];return{dataId:o.write(u,h,a.dtype),shape:h,dtype:a.dtype}}}];Jm<Qm.length;Jm++)xi(Qm[Jm]);for(var Zm,ev=function(e){this.variableNames=["A"];var t=ku(),n=e[0],r=e[1];this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+r+".0, "+n+".0);\n\n        vec4 values = "+t.texture2D+"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    "},tv=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=ku(),n=e[0],r=e[1];this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2("+r+".0, "+n+".0);\n            vec4 values = "+t.texture2D+"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        "+t.output+" = result;\n      }\n    "},nv=0,rv=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.pixels,i=r.numChannels,o="undefined"!=typeof HTMLVideoElement&&a instanceof HTMLVideoElement,s="undefined"!=typeof HTMLImageElement&&a instanceof HTMLImageElement,l=o?[a.videoWidth,a.videoHeight]:[a.width,a.height],c=l[0],u=l[1],h=[u,c],d=[u,c,i];(s||o)&&(null==Zm&&(Zm=document.createElement("canvas").getContext("2d")),Zm.canvas.width=c,Zm.canvas.height=u,Zm.drawImage(a,0,0,c,u),a=Zm.canvas);var f=n.makeTensorInfo(h,"int32");n.texData.get(f.dataId).usage=Wo.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(f.dataId),a);var p=fi().getBool("WEBGL_PACK")?new tv(d):new ev(d),g=n.runWebGLProgram(p,[f],"int32");return n.disposeData(f.dataId),g}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;Gs("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var a=t,i=a.boxes,o=a.scores,s=r,l=s.maxOutputSize,c=s.iouThreshold,u=s.scoreThreshold,h=s.softNmsSigma,d=n,f=lu(d.readSync(i.dataId),d.readSync(o.dataId),l,c,u,h);return[f.selectedIndices,f.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n,i=new Dd(r.shape,"return x * x;");return a.runWebGLProgram(i,[r],r.dtype)}},{kernelName:cf,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,a=r.a,i=r.b,o=n,s=fi().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new $u("return (a - b) * (a - b);",a.shape,i.shape):new Xu("return (a - b) * (a - b);",a.shape,i.shape);return o.compileAndRun(s,[a,i])}}];nv<rv.length;nv++)xi(rv[nv]);for(var av=0,iv=[{kernelName:"Square",gradFunc:function(e,t){var n=t[0];return{x:function(){return e.mul(n.toFloat().mul(2))}}}},{kernelName:cf,gradFunc:function(e,t){var n=t[0],r=t[1],a=dl(2);return{a:function(){return Cp(e,Cp(a,Ap(n,r)))},b:function(){return Cp(e,Cp(a,Ap(r,n)))}}}}];av<iv.length;av++)yi(iv[av]);var ov=function(){function e(){}return e.prototype.fetch=function(e,t){return fetch(e,t)},e.prototype.now=function(){return performance.now()},e.prototype.encode=function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Browser's encoder only supports utf-8, but got "+t);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)},e.prototype.decode=function(e,t){return new TextDecoder(t).decode(e)},e}();fi().get("IS_BROWSER")&&fi().setPlatform("browser",new ov);var sv,lv=function(){function e(){this.util=n(3886),this.textEncoder=new this.util.TextEncoder}return e.prototype.fetch=function(e,t){return null!=fi().global.fetch?fi().global.fetch(e,t):(null==sv&&(sv=n(1065)),sv(e,t))},e.prototype.now=function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6},e.prototype.encode=function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Node built-in encoder only supports utf-8, but got "+t);return this.textEncoder.encode(e)},e.prototype.decode=function(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)},e}();fi().get("IS_NODE")&&fi().setPlatform("node",new lv);var cv={float32:4,int32:4,uint16:2,uint8:1,bool:1};function uv(e,t){for(var n={},r=0,a=function(t){var a=t.name,i=t.dtype,o=t.shape,s=Ai(o),l=void 0;if("quantization"in t){var c=t.quantization;if("uint8"!==c.dtype&&"uint16"!==c.dtype)throw new Error("Weight "+t.name+" has unknown quantization dtype "+c.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var u=cv[c.dtype],h=e.slice(r,r+s*u),d="uint8"===c.dtype?new Uint8Array(h):new Uint16Array(h);if("float32"===i)l=Float32Array.from(d,function(e){return e*c.scale+c.min});else{if("int32"!==i)throw new Error("Unsupported dtype in weight '"+a+"': "+i);l=Int32Array.from(d,function(e){return Math.round(e*c.scale+c.min)})}r+=s*u}else if("string"===i){var f=Ai(t.shape);l=[];for(var p=0;p<f;p++){var g=new Uint32Array(e.slice(r,r+4))[0];r+=4;var m=new Uint8Array(e.slice(r,r+g));l.push(m),r+=g}}else{var v=cv[i];if(h=e.slice(r,r+s*v),"float32"===i)l=new Float32Array(h);else if("int32"===i)l=new Int32Array(h);else{if("bool"!==i)throw new Error("Unsupported dtype in weight '"+a+"': "+i);l=new Uint8Array(h)}r+=s*v}n[a]=ul(l,o,i)},i=0,o=t;i<o.length;i++)a(o[i]);return n}function hv(e){if(null===e)throw new Error("Invalid input value: "+JSON.stringify(e));var t=0,n=[];e.forEach(function(e){if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+e.constructor.name)});var r=new Uint8Array(t),a=0;return n.forEach(function(e){r.set(new Uint8Array(e.buffer),a),a+=e.byteLength}),r.buffer}var dv="undefined"!=typeof Buffer&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function fv(e){return dv?Buffer.byteLength(e):new Blob([e]).size}function pv(e){var t=0;e.forEach(function(e){t+=e.byteLength});var n=new Uint8Array(t),r=0;return e.forEach(function(e){n.set(new Uint8Array(e),r),r+=e.byteLength}),n.buffer}function gv(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function mv(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:fv(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:fv(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:e.weightData.byteLength}}var vv=function(){function e(){this.saveRouters=[],this.loadRouters=[]}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.registerSaveRouter=function(t){e.getInstance().saveRouters.push(t)},e.registerLoadRouter=function(t){e.getInstance().loadRouters.push(t)},e.getSaveHandlers=function(t){return e.getHandlers(t,"save")},e.getLoadHandlers=function(t,n){return e.getHandlers(t,"load",n)},e.getHandlers=function(t,n,r){var a=[];return("load"===n?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach(function(e){var n=e(t,r);null!==n&&a.push(n)}),a},e}(),bv="://",xv=function(){function e(){this.managers={}}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.registerManager=function(t,n){Ei(null!=t,function(){return"scheme must not be undefined or null."}),t.endsWith(bv)&&(t=t.slice(0,t.indexOf(bv))),Ei(t.length>0,function(){return"scheme must not be an empty string."});var r=e.getInstance();Ei(null==r.managers[t],function(){return"A model store manager is already registered for scheme '"+t+"'."}),r.managers[t]=n},e.getManager=function(e){var t=this.getInstance().managers[e];if(null==t)throw new Error("Cannot find model manager for scheme '"+e+"'");return t},e.getSchemes=function(){return Object.keys(this.getInstance().managers)},e}();function yv(e){if(-1===e.indexOf(bv))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+xv.getSchemes().join(","));return{scheme:e.split(bv)[0],path:e.split(bv)[1]}}function wv(e,t,n){return void 0===n&&(n=!1),ui(this,void 0,void 0,function(){var r,a,i,o,s,l,c,u,h;return hi(this,function(d){switch(d.label){case 0:return Ei(e!==t,function(){return"Old path and new path are the same: '"+e+"'"}),Ei((r=vv.getLoadHandlers(e)).length>0,function(){return"Copying failed because no load handler is found for source URL "+e+"."}),Ei(r.length<2,function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+e+"."}),a=r[0],Ei((i=vv.getSaveHandlers(t)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+t+"."}),Ei(i.length<2,function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+t+"."}),o=i[0],s=yv(e).scheme,l=yv(e).path,c=s===yv(e).scheme,[4,a.load()];case 1:return u=d.sent(),n&&c?[4,xv.getManager(s).removeModel(l)]:[3,3];case 2:d.sent(),d.label=3;case 3:return[4,o.save(u)];case 4:return h=d.sent(),!n||c?[3,6]:[4,xv.getManager(s).removeModel(l)];case 5:d.sent(),d.label=6;case 6:return[2,h.modelArtifactsInfo]}})})}var kv="models_store",Nv="model_info_store";function Sv(){if(!fi().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e=window||self,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function Cv(e){var t=e.result;t.createObjectStore(kv,{keyPath:"modelPath"}),t.createObjectStore(Nv,{keyPath:"modelPath"})}var Ev=function(){function e(e){if(this.indexedDB=Sv(),null==e||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}return e.prototype.save=function(e){return ui(this,void 0,void 0,function(){return hi(this,function(t){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,e)]})})},e.prototype.load=function(){return ui(this,void 0,void 0,function(){return hi(this,function(e){return[2,this.databaseAction(this.modelPath)]})})},e.prototype.databaseAction=function(e,t){var n=this;return new Promise(function(e,r){var a=n.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return Cv(a)},a.onsuccess=function(){var i=a.result;if(null==t){var o=i.transaction(kv,"readonly"),s=o.objectStore(kv).get(n.modelPath);s.onsuccess=function(){if(null==s.result)return i.close(),r(new Error("Cannot find model with path '"+n.modelPath+"' in IndexedDB."));e(s.result.modelArtifacts)},s.onerror=function(e){return i.close(),r(s.error)},o.oncomplete=function(){return i.close()}}else{var l,c=mv(t),u=i.transaction(Nv,"readwrite"),h=u.objectStore(Nv),d=h.put({modelPath:n.modelPath,modelArtifactsInfo:c});d.onsuccess=function(){var a=(l=i.transaction(kv,"readwrite")).objectStore(kv).put({modelPath:n.modelPath,modelArtifacts:t,modelArtifactsInfo:c});a.onsuccess=function(){return e({modelArtifactsInfo:c})},a.onerror=function(e){var t=(h=u.objectStore(Nv)).delete(n.modelPath);t.onsuccess=function(){return i.close(),r(a.error)},t.onerror=function(e){return i.close(),r(a.error)}}},d.onerror=function(e){return i.close(),r(d.error)},u.oncomplete=function(){null==l?i.close():l.oncomplete=function(){return i.close()}}}},a.onerror=function(e){return r(a.error)}})},e.URL_SCHEME="indexeddb://",e}(),_v=function(e){return fi().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Ev.URL_SCHEME)?(t=e.slice(Ev.URL_SCHEME.length),new Ev(t)):null;var t};vv.registerSaveRouter(_v),vv.registerLoadRouter(_v);var Iv=function(){function e(){this.indexedDB=Sv()}return e.prototype.listModels=function(){return ui(this,void 0,void 0,function(){var e=this;return hi(this,function(t){return[2,new Promise(function(t,n){var r=e.indexedDB.open("tensorflowjs",1);r.onupgradeneeded=function(){return Cv(r)},r.onsuccess=function(){var e=r.result,a=e.transaction(Nv,"readonly"),i=a.objectStore(Nv).getAll();i.onsuccess=function(){for(var e={},n=0,r=i.result;n<r.length;n++){var a=r[n];e[a.modelPath]=a.modelArtifactsInfo}t(e)},i.onerror=function(t){return e.close(),n(i.error)},a.oncomplete=function(){return e.close()}},r.onerror=function(e){return n(r.error)}})]})})},e.prototype.removeModel=function(e){return ui(this,void 0,void 0,function(){var t=this;return hi(this,function(n){var r;return e=(r=e).startsWith(Ev.URL_SCHEME)?r.slice(Ev.URL_SCHEME.length):r,[2,new Promise(function(n,r){var a=t.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return Cv(a)},a.onsuccess=function(){var t,i=a.result,o=i.transaction(Nv,"readwrite"),s=o.objectStore(Nv),l=s.get(e);l.onsuccess=function(){if(null==l.result)return i.close(),r(new Error("Cannot find model with path '"+e+"' in IndexedDB."));var a=s.delete(e),o=function(){var a=(t=i.transaction(kv,"readwrite")).objectStore(kv).delete(e);a.onsuccess=function(){return n(l.result.modelArtifactsInfo)},a.onerror=function(e){return r(l.error)}};a.onsuccess=o,a.onerror=function(e){return o(),i.close(),r(l.error)}},l.onerror=function(e){return i.close(),r(l.error)},o.oncomplete=function(){null==t?i.close():t.oncomplete=function(){return i.close()}}},a.onerror=function(e){return r(a.error)}})]})})},e}();if(fi().getBool("IS_BROWSER"))try{xv.registerManager(Ev.URL_SCHEME,new Iv)}catch(li){}var Tv="/",Av="tensorflowjs_models",Rv="info",Dv="model_topology",Fv="weight_specs",Ov="weight_data",Lv="model_metadata";function Pv(e){return{info:[Av,e,Rv].join(Tv),topology:[Av,e,Dv].join(Tv),weightSpecs:[Av,e,Fv].join(Tv),weightData:[Av,e,Ov].join(Tv),modelMetadata:[Av,e,Lv].join(Tv)}}function Mv(e){var t=e.split(Tv);if(t.length<3)throw new Error("Invalid key format: "+e);return t.slice(1,t.length-1).join(Tv)}var jv=function(){function e(e){if(!fi().getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=Pv(this.modelPath)}return e.prototype.save=function(e){return ui(this,void 0,void 0,function(){var t,n,r;return hi(this,function(a){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");t=JSON.stringify(e.modelTopology),n=JSON.stringify(e.weightSpecs),r=mv(e);try{return this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,function(e){if(dv)return Buffer.from(e).toString("base64");for(var t=new Uint8Array(e),n="",r=0,a=t.length;r<a;r++)n+=String.fromCharCode(t[r]);return btoa(n)}(e.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata})),[2,{modelArtifactsInfo:r}]}catch(e){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+r.modelTopologyBytes+", weightSpecsBytes="+r.weightSpecsBytes+", weightDataBytes="+r.weightDataBytes+".")}})})},e.prototype.load=function(){return ui(this,void 0,void 0,function(){var e,t,n,r,a,i,o;return hi(this,function(s){if(null==(e=JSON.parse(this.LS.getItem(this.keys.info))))throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if("JSON"!==e.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(t={},null==(n=JSON.parse(this.LS.getItem(this.keys.topology))))throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(t.modelTopology=n,null==(r=JSON.parse(this.LS.getItem(this.keys.weightSpecs))))throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(t.weightSpecs=r,null!=(a=this.LS.getItem(this.keys.modelMetadata))&&(i=JSON.parse(a),t.format=i.format,t.generatedBy=i.generatedBy,t.convertedBy=i.convertedBy,t.userDefinedMetadata=i.userDefinedMetadata),null==(o=this.LS.getItem(this.keys.weightData)))throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return t.weightData=function(e){if(dv){var t=Buffer.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}for(var n=atob(e),r=new Uint8Array(n.length),a=0;a<n.length;++a)r.set([n.charCodeAt(a)],a);return r.buffer}(o),[2,t]})})},e.URL_SCHEME="localstorage://",e}(),Bv=function(e){return fi().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(jv.URL_SCHEME)?(t=e.slice(jv.URL_SCHEME.length),new jv(t)):null;var t};vv.registerSaveRouter(Bv),vv.registerLoadRouter(Bv);var zv=function(){function e(){Ei(fi().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),Ei("undefined"==typeof window||void 0!==window.localStorage,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return e.prototype.listModels=function(){return ui(this,void 0,void 0,function(){var e,t,n,r,a,i;return hi(this,function(o){for(e={},t=Av+Tv,n=Tv+Rv,r=0;r<this.LS.length;++r)(a=this.LS.key(r)).startsWith(t)&&a.endsWith(n)&&(i=Mv(a),e[i]=JSON.parse(this.LS.getItem(a)));return[2,e]})})},e.prototype.removeModel=function(e){return ui(this,void 0,void 0,function(){var t,n;return hi(this,function(r){var a;if(e=(a=e).startsWith(jv.URL_SCHEME)?a.slice(jv.URL_SCHEME.length):a,t=Pv(e),null==this.LS.getItem(t.info))throw new Error("Cannot find model at path '"+e+"'");return n=JSON.parse(this.LS.getItem(t.info)),this.LS.removeItem(t.info),this.LS.removeItem(t.topology),this.LS.removeItem(t.weightSpecs),this.LS.removeItem(t.weightData),[2,n]})})},e}();if(fi().getBool("IS_BROWSER"))try{xv.registerManager(jv.URL_SCHEME,new zv)}catch(li){}function Wv(e){return new Promise(function(e){return setTimeout(e)}).then(e)}var Uv=function(){function e(t){if(!fi().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),null!=t&&0!==t.length||(t="model"),this.modelTopologyFileName=t+".json",this.weightDataFileName=t+".weights.bin"}return e.prototype.save=function(e){return ui(this,void 0,void 0,function(){var t,n,r,a,i,o;return hi(this,function(s){switch(s.label){case 0:if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(t=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"})),!(e.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return n=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:n},a=window.URL.createObjectURL(new Blob([JSON.stringify(r)],{type:"application/json"})),(i=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,i.href=a,[4,Wv(function(){return i.dispatchEvent(new MouseEvent("click"))})];case 2:return s.sent(),null==e.weightData?[3,4]:((o=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,o.href=t,[4,Wv(function(){return o.dispatchEvent(new MouseEvent("click"))})]);case 3:s.sent(),s.label=4;case 4:return[2,{modelArtifactsInfo:mv(e)}]}})})},e.URL_SCHEME="downloads://",e}(),Vv=function(){function e(e){if(null==e||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+e);this.files=e}return e.prototype.load=function(){return ui(this,void 0,void 0,function(){var e,t,n=this;return hi(this,function(r){return e=this.files[0],t=this.files.slice(1),[2,new Promise(function(r,a){var i=new FileReader;i.onload=function(i){var o=JSON.parse(i.target.result),s=o.modelTopology;if(null!=s){0===t.length&&r({modelTopology:s});var l=o.weightsManifest;if(null!=l){var c;try{c=n.checkManifestAndWeightFiles(l,t)}catch(e){return void a(e)}var u=[],h=[],d=[];l.forEach(function(e){e.paths.forEach(function(e){h.push(e),d.push(null)}),u.push.apply(u,e.weights)}),l.forEach(function(e){e.paths.forEach(function(e){var t=new FileReader;t.onload=function(t){var n=t.target.result,a=h.indexOf(e);d[a]=n,-1===d.indexOf(null)&&r({modelTopology:s,weightSpecs:u,weightData:pv(d),format:o.format,generatedBy:o.generatedBy,convertedBy:o.convertedBy,userDefinedMetadata:o.userDefinedMetadata})},t.onerror=function(t){return a("Failed to weights data from file of path '"+e+"'.")},t.readAsArrayBuffer(c[e])})})}else a(new Error("weightManifest field is missing from file "+e.name))}else a(new Error("modelTopology field is missing from file "+e.name))},i.onerror=function(t){return a("Failed to read model topology and weights manifest JSON from file '"+e.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},i.readAsText(e)})]})})},e.prototype.checkManifestAndWeightFiles=function(e,t){for(var n=[],r=t.map(function(e){return gv(e.name)}),a={},i=0,o=e;i<o.length;i++)o[i].paths.forEach(function(e){var i=gv(e);if(-1!==n.indexOf(i))throw new Error("Duplicate file basename found in weights manifest: '"+i+"'");if(n.push(i),-1===r.indexOf(i))throw new Error("Weight file with basename '"+i+"' is not provided.");a[e]=t[r.indexOf(i)]});if(n.length!==t.length)throw new Error("Mismatch in the number of files in weights manifest ("+n.length+") and the number of weight files provided ("+t.length+").");return a},e}();function Hv(e,t,n,r){!function(e){Ei(null!=e&&Array.isArray(e)&&e.length>0,function(){return"promises must be a none empty array"})}(e),function(e,t){Ei(e>=0&&e<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+e}),Ei(t>=0&&t<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+t}),Ei(t>=e,function(){return"startFraction must be no more than endFraction, but got startFraction "+e+" and endFraction "+t})}(n=null==n?0:n,r=null==r?1:r);var a=0;return Promise.all(e.map(function(i){return i.then(function(i){var o=n+ ++a/e.length*(r-n);return t(o),i}),i}))}function Gv(e,t){return ui(this,void 0,void 0,function(){var n,r,a,i,o,s,l,c,u;return hi(this,function(h){switch(h.label){case 0:return null==t&&(t={}),n=null==t.fetchFunc?fi().platform.fetch:t.fetchFunc,r=e.map(function(e){return n(e,t.requestInit,{isBinary:!0})}),a=0,i=.5,null!=t.onProgress?[3,2]:[4,Promise.all(r)];case 1:return o=h.sent(),[3,4];case 2:return[4,Hv(r,t.onProgress,a,i)];case 3:o=h.sent(),h.label=4;case 4:return s=o.map(function(e){return e.arrayBuffer()}),l=.5,c=1,null!=t.onProgress?[3,6]:[4,Promise.all(s)];case 5:return u=h.sent(),[3,8];case 6:return[4,Hv(s,t.onProgress,l,c)];case 7:u=h.sent(),h.label=8;case 8:return[2,u]}})})}function qv(e){var t=this;return function(n,r,a){return void 0===r&&(r=""),ui(t,void 0,void 0,function(){var t,i,o,s,l,c,u,h,d,f;return hi(this,function(p){switch(p.label){case 0:if(t=n.map(function(){return!1}),i={},o=null!=a?a.map(function(){return!1}):[],s=[],n.forEach(function(e,n){var r=0;e.weights.forEach(function(e){var l="quantization"in e?e.quantization.dtype:e.dtype,c=cv[l]*Ai(e.shape),u=function(){t[n]=!0,null==i[n]&&(i[n]=[]),i[n].push({manifestEntry:e,groupOffset:r,sizeBytes:c})};null!=a?a.forEach(function(t,n){t===e.name&&(u(),o[n]=!0)}):u(),s.push(e.name),r+=c})}),!o.every(function(e){return e}))throw l=a.filter(function(e,t){return!o[t]}),new Error("Could not find weights in manifest with names: "+l.join(", ")+". \nManifest JSON has weights with names: "+s.join(", ")+".");return c=t.reduce(function(e,t,n){return t&&e.push(n),e},[]),u=[],c.forEach(function(e){n[e].paths.forEach(function(e){var t=r+(r.endsWith("/")?"":"/")+e;u.push(t)})}),[4,e(u)];case 1:return h=p.sent(),d={},f=0,c.forEach(function(e){for(var t=n[e].paths.length,r=0,a=0;a<t;a++)r+=h[f+a].byteLength;for(var o=new ArrayBuffer(r),s=new Uint8Array(o),l=0,c=0;c<t;c++){var u=new Uint8Array(h[f+c]);s.set(u,l),l+=u.byteLength}i[e].forEach(function(e){var t=uv(o.slice(e.groupOffset,e.groupOffset+e.sizeBytes),[e.manifestEntry]);for(var n in t)d[n]=t[n]}),f+=t}),[2,d]}})})}}vv.registerSaveRouter(function(e){return fi().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Uv.URL_SCHEME)?function(e){return void 0===e&&(e="model"),new Uv(e)}(e.slice(Uv.URL_SCHEME.length)):null});var Kv=function(){function e(e,t){if(this.DEFAULT_METHOD="POST",null==t&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,null!=t.fetchFunc?(Ei("function"==typeof t.fetchFunc,function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=t.fetchFunc):this.fetch=fi().platform.fetch,Ei(null!=e&&e.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(e)&&Ei(2===e.length,function(){return"URL paths for http must have a length of 2, (actual length is "+e.length+")."}),this.path=e,null!=t.requestInit&&null!=t.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}return e.prototype.save=function(e){return ui(this,void 0,void 0,function(){var t,n,r,a;return hi(this,function(i){switch(i.label){case 0:if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,n=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata,weightsManifest:n},t.body.append("model.json",new Blob([JSON.stringify(r)],{type:"application/json"}),"model.json"),null!=e.weightData&&t.body.append("model.weights.bin",new Blob([e.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,t)];case 1:if((a=i.sent()).ok)return[2,{modelArtifactsInfo:mv(e),responses:[a]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+a.status+".")}})})},e.prototype.load=function(){return ui(this,void 0,void 0,function(){var e,t,n,r,a,i,o,s,l,c,u,h;return hi(this,function(d){switch(d.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(e=d.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+e.status+". Please verify this URL points to the model JSON of the model to load.");d.label=2;case 2:return d.trys.push([2,4,,5]),[4,e.json()];case 3:return t=d.sent(),[3,5];case 4:throw d.sent(),n="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?n+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":n+=" Please make sure the server is serving valid JSON for this request.",new Error(n);case 5:if(r=t.modelTopology,a=t.weightsManifest,i=t.generatedBy,o=t.convertedBy,s=t.format,l=t.userDefinedMetadata,null==r&&null==a)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return null==a?[3,7]:[4,this.loadWeights(a)];case 6:h=d.sent(),c=h[0],u=h[1],d.label=7;case 7:return[2,{modelTopology:r,weightSpecs:c,weightData:u,userDefinedMetadata:l,generatedBy:i,convertedBy:o,format:s}]}})})},e.prototype.loadWeights=function(e){return ui(this,void 0,void 0,function(){var t,n,r,a,i,o,s,l,c,u,h;return hi(this,function(d){switch(d.label){case 0:for(t=Array.isArray(this.path)?this.path[1]:this.path,n=function(e){var t=e.lastIndexOf("/"),n=e.lastIndexOf("?");return[e.substring(0,t)+"/",n>t?e.substring(n):""]}(t),r=n[0],a=n[1],i=this.weightPathPrefix||r,o=[],s=0,l=e;s<l.length;s++)c=l[s],o.push.apply(o,c.weights);return u=[],e.forEach(function(e){e.paths.forEach(function(e){u.push(i+e+a)})}),[4,Gv(u,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return h=d.sent(),[2,[o,pv(h)]]}})})},e.URL_SCHEME_REGEX=/^https?:\/\//,e}();function Xv(e){return null!=e.match(Kv.URL_SCHEME_REGEX)}var Yv=function(e,t){return"undefined"==typeof fetch?null:(Array.isArray(e)?e.every(function(e){return Xv(e)}):Xv(e))?$v(e,{onProgress:t}):null};function $v(e,t){return new Kv(e,t)}vv.registerSaveRouter(Yv),vv.registerLoadRouter(Yv);var Jv,Qv=function(){function e(e){this.modelArtifacts=e}return e.prototype.load=function(){return ui(this,void 0,void 0,function(){return hi(this,function(e){return[2,this.modelArtifacts]})})},e}(),Zv=function(){function e(e){this.saveHandler=e}return e.prototype.save=function(e){return ui(this,void 0,void 0,function(){return hi(this,function(t){return[2,this.saveHandler(e)]})})},e}(),eb=Object.freeze({browserFiles:function(e){return new Vv(e)},browserHTTPRequest:function(e,t){return $v(e,t)},concatenateArrayBuffers:pv,decodeWeights:uv,encodeWeights:function(e,t){return ui(this,void 0,void 0,function(){var n,r,a,i,o,s=this;return hi(this,function(l){switch(l.label){case 0:for(n=[],r=[],a=Array.isArray(e)?e.map(function(e){return e.name}):Object.keys(e),i=function(i){var o=a[i],l=Array.isArray(e)?e[i].tensor:e[o];if("float32"!==l.dtype&&"int32"!==l.dtype&&"bool"!==l.dtype&&"string"!==l.dtype)throw new Error("Unsupported dtype in weight '"+o+"': "+l.dtype);var c={name:o,shape:l.shape,dtype:l.dtype};if("string"===l.dtype){var u=new Promise(function(e){return ui(s,void 0,void 0,function(){var t,n,r,a,i,o,s;return hi(this,function(c){switch(c.label){case 0:return[4,l.bytes()];case 1:for(t=c.sent(),n=t.reduce(function(e,t){return e+t.length},0)+4*t.length,r=new Uint8Array(n),a=0,i=0;i<t.length;i++)o=t[i],s=new Uint8Array(new Uint32Array([o.length]).buffer),r.set(s,a),a+=4,r.set(o,a),a+=o.length;return e(r),[2]}})})});r.push(u)}else r.push(l.data());null!=t&&(c.group=t),n.push(c)},o=0;o<a.length;++o)i(o);return[4,Promise.all(r)];case 1:return[2,{data:hv(l.sent()),specs:n}]}})})},fromMemory:function(e,t,n,r){return 1===arguments.length?null!=e.modelTopology||null!=e.weightSpecs?new Qv(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Qv({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Qv({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))},getLoadHandlers:function(e,t){return vv.getLoadHandlers(e,t)},getModelArtifactsInfoForJSON:mv,getSaveHandlers:function(e){return vv.getSaveHandlers(e)},http:$v,isHTTPScheme:Xv,loadWeights:function(e,t,n,r){return void 0===t&&(t=""),ui(this,void 0,void 0,function(){return hi(this,function(a){return[2,qv(function(e){return Gv(e,{requestInit:r})})(e,t,n)]})})},registerLoadRouter:function(e){return vv.registerLoadRouter(e)},registerSaveRouter:function(e){return vv.registerSaveRouter(e)},weightsLoaderFactory:qv,withSaveHandler:function(e){return new Zv(e)},copyModel:function(e,t){return ui(this,void 0,void 0,function(){return hi(this,function(n){return[2,wv(e,t,!1)]})})},listModels:function(){return ui(this,void 0,void 0,function(){var e,t,n,r,a,i,o;return hi(this,function(s){switch(s.label){case 0:e=xv.getSchemes(),t={},n=0,r=e,s.label=1;case 1:return n<r.length?(a=r[n],[4,xv.getManager(a).listModels()]):[3,4];case 2:for(o in i=s.sent())t[a+bv+o]=i[o];s.label=3;case 3:return n++,[3,1];case 4:return[2,t]}})})},moveModel:function(e,t){return ui(this,void 0,void 0,function(){return hi(this,function(n){return[2,wv(e,t,!0)]})})},removeModel:function(e){return ui(this,void 0,void 0,function(){var t;return hi(this,function(n){return t=yv(e),[2,xv.getManager(t.scheme).removeModel(t.path)]})})}}),tb=ol({confusionMatrix_:function(e,t,n){var r=Xs(e,"labels","confusionMatrix"),a=Xs(t,"predictions","confusionMatrix");Ei(null==n||n>0&&Number.isInteger(n),function(){return"If provided, numClasses must be a positive integer, but got "+n}),Ei(1===r.rank,function(){return"Expected the rank of labels to be 1, but got "+r.rank}),Ei(1===a.rank,function(){return"Expected the rank of predictions to be 1, but got "+a.rank}),Ei(r.shape[0]===a.shape[0],function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+a.shape[0]+". Labels and predictions should have the same number of elements."}),Ei(n>0&&Number.isInteger(n),function(){return"numClasses is required to be a positive integer, but got "+n});var i=Jl(r.asType("int32"),n),o=Jl(a.asType("int32"),n);return i.transpose().matMul(o).asType("int32")}}),nb=(Object.freeze({confusionMatrix:tb}),ol({fromPixels_:function(e,t){if(void 0===t&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,a=!1,i=!1,o=!1;if(e.data instanceof Uint8Array)n=!0;else if("undefined"!=typeof ImageData&&e instanceof ImageData)r=!0;else if("undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement)a=!0;else if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement)i=!0;else{if(null==e.getContext)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);o=!0}if(a&&a&&e.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(null!=vi("FromPixels",Mo.backendName))return Mo.runKernel("FromPixels",{pixels:e},{numChannels:t});var s,l,c=a?[e.videoWidth,e.videoHeight]:[e.width,e.height],u=c[0],h=c[1];if(o?s=e.getContext("2d").getImageData(0,0,u,h).data:r||n?s=e.data:(i||a)&&(null==Jv&&(Jv=document.createElement("canvas").getContext("2d")),Jv.canvas.width=u,Jv.canvas.height=h,Jv.drawImage(e,0,0,u,h),s=Jv.getImageData(0,0,u,h).data),4===t)l=new Int32Array(s);else{var d=u*h;l=new Int32Array(d*t);for(var f=0;f<d;f++)for(var p=0;p<t;++p)l[f*t+p]=s[4*f+p]}return gl(l,[h,u,t],"int32")}})),rb=Object.freeze({toPixels:function(e,t){return ui(this,void 0,void 0,function(){var n,r,a,i,o,s,l,c,u,h,d,f,p,g,m,v,b,x,y,w,k,N,S;return hi(this,function(C){switch(C.label){case 0:if(n=Xs(e,"img","toPixels"),e instanceof wo||(n=n.toInt()),2!==n.rank&&3!==n.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),a=r[0],i=r[1],(o=2===n.rank?1:n.shape[2])>4||2===o)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+o);return[4,n.data()];case 1:return s=C.sent(),l=n.min(),c=n.max(),[4,Promise.all([l.data(),c.data()])];case 2:if(u=C.sent(),h=u[0],d=u[1],f=h[0],p=d[0],l.dispose(),c.dispose(),"float32"===n.dtype){if(f<0||p>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+f+" - "+p+"].")}else{if("int32"!==n.dtype)throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(f<0||p>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+f+" - "+p+"].")}for(g="float32"===n.dtype?255:1,m=new Uint8ClampedArray(i*a*4),v=0;v<a*i;++v)b=void 0,x=void 0,y=void 0,w=void 0,1===o?(b=s[v]*g,x=s[v]*g,y=s[v]*g,w=255):3===o?(b=s[3*v]*g,x=s[3*v+1]*g,y=s[3*v+2]*g,w=255):4===o&&(b=s[4*v]*g,x=s[4*v+1]*g,y=s[4*v+2]*g,w=s[4*v+3]*g),m[0+(k=4*v)]=Math.round(b),m[k+1]=Math.round(x),m[k+2]=Math.round(y),m[k+3]=Math.round(w);return null!=t&&(t.width=i,t.height=a,N=t.getContext("2d"),S=new ImageData(m,i,a),N.putImageData(S,0,0)),n!==e&&n.dispose(),[2,m]}})})},fromPixels:nb}),ab=function(){function e(){}return e.prototype.getClassName=function(){return this.constructor.className},e.fromConfig=function(e,t){return new e(t)},e}(),ib=function(){function e(){this.classNameMap={}}return e.getMap=function(){return null==e.instance&&(e.instance=new e),e.instance},e.register=function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]},e}();function ob(e){Ei(null!=e.className,function(){return"Class being registered does not have the static className property defined."}),Ei("string"==typeof e.className,function(){return"className is required to be a string, but got type "+typeof e.className}),Ei(e.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),ib.register(e)}Object.freeze({Serializable:ab,SerializationMap:ib,registerClass:ob});function sb(){return 32===Mo.backend.floatPrecision()?.001:.1}function lb(e,t,n){var r=!0;if((Gi(e)||Gi(t))&&(r=!1),Gi(e)&&Gi(t)&&(r=!0),r){var a=e.constructor.name,i=t.constructor.name;if(a!==i)throw new Error("Arrays are of different type. Actual: "+a+". Expected: "+i)}if(Array.isArray(e)&&Array.isArray(t)){var o=qs(e),s=qs(t);if(!Ri(o,s))throw new Error("Arrays have different shapes. Actual: ["+o+"]. Expected: ["+s+"]")}var l=Gi(e)?e:Ti(e),c=Gi(t)?t:Ti(t);if(l.length!==c.length)throw new Error("Arrays have different lengths actual: "+l.length+" vs expected: "+c.length+".\nActual:   "+l+".\nExpected: "+c+".");for(var u=0;u<c.length;++u){var h=l[u],d=c[u];if(!n(h,d))throw new Error("Arrays differ: actual["+u+"] = "+h+", expected["+u+"] = "+d+".\nActual:   "+l+".\nExpected: "+c+".")}}function cb(e,t,n){return!isFinite(e)&&!isFinite(t)||!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}Object.freeze({TEST_EPSILON_FLOAT16:.1,expectArraysClose:function(e,t,n){return null==n&&(n=sb()),lb(e,t,function(e,t){return cb(e,t,n)})},testEpsilon:sb,expectPromiseToFail:function(e,t){e().then(function(){return t.fail()},function(){return t()})},expectArraysEqual:function(e,t){var n="string"==typeof t||"number"==typeof t||"boolean"==typeof t?[t]:t;return Xi(e)||Xi(e[0])||Xi(t)||Xi(t[0])?lb(e,n,function(e,t){return e==t}):lb(e,t,function(e,t){return cb(e,t,0)})},expectNumbersClose:function(e,t,n){if(null==n&&(n=sb()),!cb(e,t,n))throw new Error("Numbers differ: actual === "+e+", expected === "+t)},expectValuesInRange:function(e,t,n){for(var r=0;r<e.length;r++)if(e[r]<t||e[r]>n)throw new Error("Value out of range:"+e[r]+" low: "+t+", high: "+n)},expectArrayBuffersEqual:function(e,t){expect(new Float32Array(e)).toEqual(new Float32Array(t))}}),Object.freeze({gpgpu_util:Gh,webgl_util:zs,forceHalfFloat:function(){fi().set("WEBGL_FORCE_F16_TEXTURES",!0)},MathBackendWebGL:sf,setWebGLContext:Go,GPGPUContext:qh});var ub=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ci(t,e),t.prototype.minimize=function(e,t,n){void 0===t&&(t=!1);var r=this.computeGradients(e,n),a=r.value,i=r.grads;if(null!=n){var o=n.map(function(e){return{name:e.name,tensor:i[e.name]}});this.applyGradients(o)}else this.applyGradients(i);return Hs(i),t?a:(a.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(e,t){return function(e,t){Ei(Qi(e),function(){return"The f passed in variableGrads(f) must be a function"}),Ei(null==t||Array.isArray(t)&&t.every(function(e){return e instanceof _o}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var n=null!=t;if(!n)for(var r in t=[],Mo.registeredVariables)t.push(Mo.registeredVariables[r]);var a=n?t.filter(function(e){return!e.trainable}):null,i=t.length;Ei((t=t.filter(function(e){return e.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable."});var o=Mo.gradients(e,t,null,!0),s=o.value,l=o.grads;Ei(l.some(function(e){return null!=e}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),Ei(0===s.rank,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"});var c={};return t.forEach(function(e,t){null!=l[t]&&(c[e.name]=l[t])}),null!=a&&a.forEach(function(e){return c[e.name]=null}),{value:s,grads:c}}(e,t)},t.prototype.dispose=function(){null!=this.iterations_&&Hs(this.iterations_)},t.prototype.saveIterations=function(){return ui(this,void 0,void 0,function(){return hi(this,function(e){return null==this.iterations_&&(this.iterations_=0),[2,{name:"iter",tensor:dl(this.iterations_,"int32")}]})})},t.prototype.getWeights=function(){return ui(this,void 0,void 0,function(){return hi(this,function(e){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},t.prototype.setWeights=function(e){return ui(this,void 0,void 0,function(){return hi(this,function(e){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},t.prototype.extractIterations=function(e){return ui(this,void 0,void 0,function(){var t;return hi(this,function(n){switch(n.label){case 0:return t=this,[4,e[0].tensor.data()];case 1:return t.iterations_=n.sent()[0],[2,e.slice(1)]}})})},t}(ab);Object.defineProperty(ub,Symbol.hasInstance,{value:function(e){return null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients}});var hb=function(e){function t(t,n,r){void 0===r&&(r=null);var a=e.call(this)||this;return a.learningRate=t,a.rho=n,a.epsilon=r,a.accumulatedGrads=[],a.accumulatedUpdates=[],null==r&&(a.epsilon=Mo.backend.epsilon()),a}return ci(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map(function(e){return e.name}):Object.keys(e)).forEach(function(n,r){var a=Mo.registeredVariables[n];null==t.accumulatedGrads[r]&&(t.accumulatedGrads[r]={originalName:n+"/accum_grad",variable:Vs(function(){return kl(a).variable(!1)})}),null==t.accumulatedUpdates[r]&&(t.accumulatedUpdates[r]={originalName:n+"/accum_var",variable:Vs(function(){return kl(a).variable(!1)})});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedGrads[r].variable,s=t.accumulatedUpdates[r].variable;Vs(function(){var e=o.mul(t.rho).add(i.square().mul(1-t.rho)),n=s.add(t.epsilon).sqrt().div(o.add(t.epsilon).sqrt()).mul(i),r=s.mul(t.rho).add(n.square().mul(1-t.rho));o.assign(e),s.assign(r);var l=n.mul(-t.learningRate).add(a);a.assign(l)})}}),this.incrementIterations()},t.prototype.dispose=function(){null!=this.accumulatedUpdates&&(Hs(this.accumulatedGrads.map(function(e){return e.variable})),Hs(this.accumulatedUpdates.map(function(e){return e.variable})))},t.prototype.getWeights=function(){return ui(this,void 0,void 0,function(){var e;return hi(this,function(t){switch(t.label){case 0:return e=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(e.map(function(e){return{name:e.originalName,tensor:e.variable}}))]}})})},t.prototype.setWeights=function(e){return ui(this,void 0,void 0,function(){var t;return hi(this,function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:return e=n.sent(),t=e.length/2,this.accumulatedGrads=e.slice(0,t).map(function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}),this.accumulatedUpdates=e.slice(t,2*t).map(function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(e,t){return new e(t.learningRate,t.rho,t.epsilon)},t.className="Adadelta",t}(ub);ob(hb);var db=function(e){function t(t,n){void 0===n&&(n=.1);var r=e.call(this)||this;return r.learningRate=t,r.initialAccumulatorValue=n,r.accumulatedGrads=[],r}return ci(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map(function(e){return e.name}):Object.keys(e)).forEach(function(n,r){var a=Mo.registeredVariables[n];null==t.accumulatedGrads[r]&&(t.accumulatedGrads[r]={originalName:n+"/accumulator",variable:Vs(function(){return xl(a.shape,t.initialAccumulatorValue).variable(!1)})});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedGrads[r].variable;Vs(function(){var e=o.add(i.square());o.assign(e);var n=i.div(e.add(Mo.backend.epsilon()).sqrt()).mul(-t.learningRate).add(a);a.assign(n)})}}),this.incrementIterations()},t.prototype.dispose=function(){null!=this.accumulatedGrads&&Hs(this.accumulatedGrads.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return ui(this,void 0,void 0,function(){return hi(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulatedGrads.map(function(e){return{name:e.originalName,tensor:e.variable}}))]}})})},t.prototype.setWeights=function(e){return ui(this,void 0,void 0,function(){return hi(this,function(t){switch(t.label){case 0:return[4,this.extractIterations(e)];case 1:return e=t.sent(),this.accumulatedGrads=e.map(function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(e,t){return new e(t.learningRate,t.initialAccumulatorValue)},t.className="Adagrad",t}(ub);ob(db);var fb=function(e){function t(t,n,r,a){void 0===a&&(a=null);var i=e.call(this)||this;return i.learningRate=t,i.beta1=n,i.beta2=r,i.epsilon=a,i.accumulatedFirstMoment=[],i.accumulatedSecondMoment=[],Vs(function(){i.accBeta1=dl(n).variable(),i.accBeta2=dl(r).variable()}),null==a&&(i.epsilon=Mo.backend.epsilon()),i}return ci(t,e),t.prototype.applyGradients=function(e){var t=this,n=Array.isArray(e)?e.map(function(e){return e.name}):Object.keys(e);Vs(function(){var r=Ap(1,t.accBeta1),a=Ap(1,t.accBeta2);n.forEach(function(n,i){var o=Mo.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:n+"/m",variable:Vs(function(){return kl(o).variable(!1)})}),null==t.accumulatedSecondMoment[i]&&(t.accumulatedSecondMoment[i]={originalName:n+"/v",variable:Vs(function(){return kl(o).variable(!1)})});var s=Array.isArray(e)?e[i].tensor:e[n];if(null!=s){var l=t.accumulatedFirstMoment[i].variable,c=t.accumulatedSecondMoment[i].variable,u=l.mul(t.beta1).add(s.mul(1-t.beta1)),h=c.mul(t.beta2).add(s.square().mul(1-t.beta2)),d=u.div(r),f=h.div(a);l.assign(u),c.assign(h);var p=d.div(f.sqrt().add(t.epsilon)).mul(-t.learningRate).add(o);o.assign(p)}}),t.accBeta1.assign(t.accBeta1.mul(t.beta1)),t.accBeta2.assign(t.accBeta2.mul(t.beta2))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&Hs(this.accumulatedFirstMoment.map(function(e){return e.variable})),null!=this.accumulatedSecondMoment&&Hs(this.accumulatedSecondMoment.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return ui(this,void 0,void 0,function(){var e;return hi(this,function(t){switch(t.label){case 0:return e=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(e.map(function(e){return{name:e.originalName,tensor:e.variable}}))]}})})},t.prototype.setWeights=function(e){return ui(this,void 0,void 0,function(){var t,n=this;return hi(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(e)];case 1:return e=r.sent(),Vs(function(){n.accBeta1.assign(_p(n.beta1,n.iterations_+1)),n.accBeta2.assign(_p(n.beta2,n.iterations_+1))}),t=e.length/2,this.accumulatedFirstMoment=e.slice(0,t).map(function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}),this.accumulatedSecondMoment=e.slice(t,2*t).map(function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)},t.className="Adam",t}(ub);ob(fb);var pb=function(e){function t(t,n,r,a,i){void 0===a&&(a=null),void 0===i&&(i=0);var o=e.call(this)||this;return o.learningRate=t,o.beta1=n,o.beta2=r,o.epsilon=a,o.decay=i,o.accumulatedFirstMoment=[],o.accumulatedWeightedInfNorm=[],Vs(function(){o.iteration=dl(0).variable(),o.accBeta1=dl(n).variable()}),null==a&&(o.epsilon=Mo.backend.epsilon()),o}return ci(t,e),t.prototype.applyGradients=function(e){var t=this,n=Array.isArray(e)?e.map(function(e){return e.name}):Object.keys(e);Vs(function(){var r=Ap(1,t.accBeta1),a=gp(-t.learningRate,t.iteration.mul(t.decay).add(1));n.forEach(function(n,i){var o=Mo.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:n+"/m",variable:kl(o).variable(!1)}),null==t.accumulatedWeightedInfNorm[i]&&(t.accumulatedWeightedInfNorm[i]={originalName:n+"/v",variable:kl(o).variable(!1)});var s=Array.isArray(e)?e[i].tensor:e[n];if(null!=s){var l=t.accumulatedFirstMoment[i].variable,c=t.accumulatedWeightedInfNorm[i].variable,u=l.mul(t.beta1).add(s.mul(1-t.beta1)),h=c.mul(t.beta2),d=s.abs(),f=h.maximum(d);l.assign(u),c.assign(f);var p=a.div(r).mul(u.div(f.add(t.epsilon))).add(o);o.assign(p)}}),t.iteration.assign(t.iteration.add(1)),t.accBeta1.assign(t.accBeta1.mul(t.beta1))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&Hs(this.accumulatedFirstMoment.map(function(e){return e.variable})),null!=this.accumulatedWeightedInfNorm&&Hs(this.accumulatedWeightedInfNorm.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return ui(this,void 0,void 0,function(){return hi(this,function(e){throw new Error("getWeights() is not implemented for Adamax yet.")})})},t.prototype.setWeights=function(e){return ui(this,void 0,void 0,function(){return hi(this,function(e){throw new Error("setWeights() is not implemented for Adamax yet.")})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)},t.className="Adamax",t}(ub);ob(pb);var gb=function(e){function t(t){var n=e.call(this)||this;return n.learningRate=t,n.setLearningRate(t),n}return ci(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map(function(e){return e.name}):Object.keys(e)).forEach(function(n,r){var a=Array.isArray(e)?e[r].tensor:e[n];if(null!=a){var i=Mo.registeredVariables[n];Vs(function(){var e=t.c.mul(a).add(i);i.assign(e)})}}),this.incrementIterations()},t.prototype.setLearningRate=function(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=function(e){return Mo.keep(e)}(dl(-e))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return ui(this,void 0,void 0,function(){return hi(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()]]}})})},t.prototype.setWeights=function(e){return ui(this,void 0,void 0,function(){return hi(this,function(t){switch(t.label){case 0:return[4,this.extractIterations(e)];case 1:if(0!==(e=t.sent()).length)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(e,t){return new e(t.learningRate)},t.className="SGD",t}(ub);ob(gb);var mb=function(e){function t(t,n,r){void 0===r&&(r=!1);var a=e.call(this,t)||this;return a.learningRate=t,a.momentum=n,a.useNesterov=r,a.accumulations=[],a.m=dl(a.momentum),a}return ci(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map(function(e){return e.name}):Object.keys(e)).forEach(function(n,r){var a=Mo.registeredVariables[n];null==t.accumulations[r]&&(t.accumulations[r]={originalName:n+"/momentum",variable:Vs(function(){return kl(a).variable(!1)})});var i=t.accumulations[r].variable,o=Array.isArray(e)?e[r].tensor:e[n];null!=o&&Vs(function(){var e,n=t.m.mul(i).add(o);e=t.useNesterov?t.c.mul(o.add(n.mul(t.m))).add(a):t.c.mul(n).add(a),i.assign(n),a.assign(e)})}),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),null!=this.accumulations&&Hs(this.accumulations.map(function(e){return e.variable}))},t.prototype.setMomentum=function(e){this.momentum=e},t.prototype.getWeights=function(){return ui(this,void 0,void 0,function(){return hi(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulations.map(function(e){return{name:e.originalName,tensor:e.variable}}))]}})})},t.prototype.setWeights=function(e){return ui(this,void 0,void 0,function(){return hi(this,function(t){switch(t.label){case 0:return[4,this.extractIterations(e)];case 1:return e=t.sent(),this.accumulations=e.map(function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)},t.className="Momentum",t}(gb);ob(mb);var vb=function(e){function t(t,n,r,a,i){void 0===n&&(n=.9),void 0===r&&(r=0),void 0===a&&(a=null),void 0===i&&(i=!1);var o=e.call(this)||this;if(o.learningRate=t,o.decay=n,o.momentum=r,o.epsilon=a,o.accumulatedMeanSquares=[],o.accumulatedMoments=[],o.accumulatedMeanGrads=[],o.centered=i,null==a&&(o.epsilon=Mo.backend.epsilon()),null==t)throw new Error("learningRate for RMSPropOptimizer must be defined.");return o}return ci(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map(function(e){return e.name}):Object.keys(e)).forEach(function(n,r){var a=Mo.registeredVariables[n];null==t.accumulatedMeanSquares[r]&&(t.accumulatedMeanSquares[r]={originalName:n+"/rms",variable:Vs(function(){return kl(a).variable(!1)})}),null==t.accumulatedMoments[r]&&(t.accumulatedMoments[r]={originalName:n+"/momentum",variable:Vs(function(){return kl(a).variable(!1)})}),null==t.accumulatedMeanGrads[r]&&t.centered&&(t.accumulatedMeanGrads[r]={originalName:n+"/mg",variable:Vs(function(){return kl(a).variable(!1)})});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedMeanSquares[r].variable,s=t.accumulatedMoments[r].variable;Vs(function(){var e=o.mul(t.decay).add(i.square().mul(1-t.decay));if(t.centered){var n=t.accumulatedMeanGrads[r].variable,l=n.mul(t.decay).add(i.mul(1-t.decay)),c=s.mul(t.momentum).add(i.mul(t.learningRate).div(e.sub(l.square().add(t.epsilon)).sqrt()));o.assign(e),n.assign(l),s.assign(c);var u=a.sub(c);a.assign(u)}else{var h=o.mul(t.decay).add(i.square().mul(1-t.decay));c=s.mul(t.momentum).add(i.mul(t.learningRate).div(h.add(t.epsilon).sqrt())),o.assign(h),s.assign(c),u=a.sub(c),a.assign(u)}})}}),this.incrementIterations()},t.prototype.dispose=function(){null!=this.accumulatedMeanSquares&&Hs(this.accumulatedMeanSquares.map(function(e){return e.variable})),null!=this.accumulatedMeanGrads&&this.centered&&Hs(this.accumulatedMeanGrads.map(function(e){return e.variable})),null!=this.accumulatedMoments&&Hs(this.accumulatedMoments.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return ui(this,void 0,void 0,function(){var e;return hi(this,function(t){switch(t.label){case 0:return e=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&e.push.apply(e,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(e.map(function(e){return{name:e.originalName,tensor:e.variable}}))]}})})},t.prototype.setWeights=function(e){return ui(this,void 0,void 0,function(){var t;return hi(this,function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:return e=n.sent(),t=this.centered?e.length/3:e.length/2,this.accumulatedMeanSquares=e.slice(0,t).map(function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}),this.accumulatedMoments=e.slice(t,2*t).map(function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=e.slice(2*t,3*t).map(function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)},t.className="RMSProp",t}(ub);ob(vb);var bb=function(){function e(){}return e.sgd=function(e){return new gb(e)},e.momentum=function(e,t,n){return void 0===n&&(n=!1),new mb(e,t,n)},e.rmsprop=function(e,t,n,r,a){return void 0===t&&(t=.9),void 0===n&&(n=0),void 0===r&&(r=null),void 0===a&&(a=!1),new vb(e,t,n,r,a)},e.adam=function(e,t,n,r){return void 0===e&&(e=.001),void 0===t&&(t=.9),void 0===n&&(n=.999),void 0===r&&(r=null),new fb(e,t,n,r)},e.adadelta=function(e,t,n){return void 0===e&&(e=.001),void 0===t&&(t=.95),void 0===n&&(n=null),new hb(e,t,n)},e.adamax=function(e,t,n,r,a){return void 0===e&&(e=.002),void 0===t&&(t=.9),void 0===n&&(n=.999),void 0===r&&(r=null),void 0===a&&(a=0),new pb(e,t,n,r,a)},e.adagrad=function(e,t){return void 0===t&&(t=.1),new db(e,t)},e}();bb.sgd,bb.momentum,bb.adadelta,bb.adagrad,bb.rmsprop,bb.adamax,bb.adam,"undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate&&setImmediate;wo.prototype.squaredDifference=function(e){return uf(this,e)},xo=Km;var xb=function(e,t){return xb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},xb(e,t)};function yb(e,t){function n(){this.constructor=e}xb(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var wb=function(){return wb=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},wb.apply(this,arguments)};function kb(e,t,n,r){return new(n||(n=Promise))(function(a,i){function o(e){try{l(r.next(e))}catch(ci){i(ci)}}function s(e){try{l(r.throw(e))}catch(ci){i(ci)}}function l(e){e.done?a(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())})}function Nb(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(ci){i=[6,ci],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function Sb(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),a=0;for(t=0;t<n;t++)for(var i=arguments[t],o=0,s=i.length;o<s;o++,a++)r[a]=i[o];return r}var Cb=function(){function e(e,t){if(!Fb(e)||!Fb(t))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:e,height:t}));this._width=e,this._height=t}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),e.prototype.reverse=function(){return new e(1/this.width,1/this.height)},e}();function Eb(e,t){return e instanceof wo&&e.shape.length===t}function _b(e){return Eb(e,3)}function Ib(e){return Eb(e,4)}function Tb(e){return e%2===0}function Ab(e){return e&&e.width&&e.height}function Rb(e){return e.reduce(function(e,t){return e.add(t)},new Lb(0,0)).div(new Lb(e.length,e.length))}function Db(e,t,n){return Array(e).fill(0).map(function(e,r){return t+r*n})}function Fb(e){return!!e&&e!==1/0&&e!==-1/0&&!isNaN(e)||0===e}function Ob(e){return Fb(e)&&0<=e&&e<=1}var Lb=function(){function e(e,t){this._x=e,this._y=t}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.sub=function(t){return new e(this.x-t.x,this.y-t.y)},e.prototype.mul=function(t){return new e(this.x*t.x,this.y*t.y)},e.prototype.div=function(t){return new e(this.x/t.x,this.y/t.y)},e.prototype.abs=function(){return new e(Math.abs(this.x),Math.abs(this.y))},e.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},e.prototype.floor=function(){return new e(Math.floor(this.x),Math.floor(this.y))},e}(),Pb=function(){function e(t,n){void 0===n&&(n=!0);var r=t||{},a=[r.left,r.top,r.right,r.bottom].every(Fb),i=[r.x,r.y,r.width,r.height].every(Fb);if(!i&&!a)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var o=i?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],s=o[0],l=o[1],c=o[2],u=o[3];e.assertIsValidBox({x:s,y:l,width:c,height:u},"Box.constructor",n),this._x=s,this._y=l,this._width=c,this._height=u}return e.isRect=function(e){return!!e&&[e.x,e.y,e.width,e.height].every(Fb)},e.assertIsValidBox=function(t,n,r){if(void 0===r&&(r=!1),!e.isRect(t))throw new Error(n+" - invalid box: "+JSON.stringify(t)+", expected object with properties x, y, width, height");if(!r&&(t.width<0||t.height<0))throw new Error(n+" - width ("+t.width+") and height ("+t.height+") must be positive numbers")},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topLeft",{get:function(){return new Lb(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topRight",{get:function(){return new Lb(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomLeft",{get:function(){return new Lb(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomRight",{get:function(){return new Lb(this.right,this.bottom)},enumerable:!0,configurable:!0}),e.prototype.round=function(){var t=[this.x,this.y,this.width,this.height].map(function(e){return Math.round(e)});return new e({x:t[0],y:t[1],width:t[2],height:t[3]})},e.prototype.floor=function(){var t=[this.x,this.y,this.width,this.height].map(function(e){return Math.floor(e)});return new e({x:t[0],y:t[1],width:t[2],height:t[3]})},e.prototype.toSquare=function(){var t=this,n=t.x,r=t.y,a=t.width,i=t.height,o=Math.abs(a-i);return a<i&&(n-=o/2,a+=o),i<a&&(r-=o/2,i+=o),new e({x:n,y:r,width:a,height:i})},e.prototype.rescale=function(t){var n=Ab(t)?t.width:t,r=Ab(t)?t.height:t;return new e({x:this.x*n,y:this.y*r,width:this.width*n,height:this.height*r})},e.prototype.pad=function(t,n){var r=[this.x-t/2,this.y-n/2,this.width+t,this.height+n];return new e({x:r[0],y:r[1],width:r[2],height:r[3]})},e.prototype.clipAtImageBorders=function(t,n){var r=this,a=r.x,i=r.y,o=r.right,s=r.bottom,l=Math.max(a,0),c=Math.max(i,0),u=o-l,h=s-c;return new e({x:l,y:c,width:Math.min(u,t-l),height:Math.min(h,n-c)}).floor()},e.prototype.shift=function(t,n){var r=this.width,a=this.height;return new e({x:this.x+t,y:this.y+n,width:r,height:a})},e.prototype.padAtBorders=function(e,t){var n=this.width+1,r=this.height+1,a=n,i=r,o=this.left,s=this.top,l=this.right,c=this.bottom;return l>t&&(a=-l+t+n,l=t),c>e&&(i=-c+e+r,c=e),o<1&&(i=2-o,o=1),s<1&&(i=2-s,s=1),{dy:1,edy:i,dx:1,edx:a,y:s,ey:c,x:o,ex:l,w:n,h:r}},e.prototype.calibrate=function(t){return new e({left:this.left+t.left*this.width,top:this.top+t.top*this.height,right:this.right+t.right*this.width,bottom:this.bottom+t.bottom*this.height}).toSquare().round()},e}(),Mb=function(e){function t(t,n,r,a,i){return void 0===i&&(i=!1),e.call(this,{left:t,top:n,right:r,bottom:a},i)||this}return yb(t,e),t}(Pb),jb=function(){function e(e,t,n,r,a){this._imageDims=new Cb(a.width,a.height),this._score=e,this._classScore=t,this._className=n,this._box=new Pb(r).rescale(this._imageDims)}return Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativeBox",{get:function(){return new Pb(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),e.prototype.forSize=function(t,n){return new e(this.score,this.classScore,this.className,this.relativeBox,{width:t,height:n})},e}(),Bb=function(e){function t(t,n,r){return e.call(this,t,t,"",n,r)||this}return yb(t,e),t.prototype.forSize=function(n,r){var a=e.prototype.forSize.call(this,n,r);return new t(a.score,a.relativeBox,a.imageDims)},t}(jb);function zb(e,t,n){void 0===n&&(n=!0);var r=Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left))*Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top));return n?r/(e.area+t.area-r):r/Math.min(e.area,t.area)}function Wb(e,t,n,r){void 0===r&&(r=!0);for(var a=t.map(function(e,t){return{score:e,boxIndex:t}}).sort(function(e,t){return e.score-t.score}).map(function(e){return e.boxIndex}),i=[],o=function(){var t=a.pop();i.push(t);for(var o=a,s=[],l=0;l<o.length;l++){var c=o[l],u=e[t],h=e[c];s.push(zb(u,h,r))}a=a.filter(function(e,t){return s[t]<=n})};a.length>0;)o();return i}function Ub(e,t){return Vs(function(){var n=t[0],r=t[1],a=t[2],i=xl(Sb(e.shape.slice(0,3),[1]),n),o=xl(Sb(e.shape.slice(0,3),[1]),r),s=xl(Sb(e.shape.slice(0,3),[1]),a),l=Nl([i,o,s],3);return Ap(e,l)})}function Vb(e){return 1/(1+Math.exp(-e))}var Hb,Gb=function(e){function t(t,n,r,a,i){return void 0===i&&(i=!1),e.call(this,{x:t,y:n,width:r,height:a},i)||this}return yb(t,e),t}(Pb),qb=function(){function e(e,t,n){void 0===n&&(n=new Lb(0,0));var r=t.width,a=t.height;this._imgDims=new Cb(r,a),this._shift=n,this._positions=e.map(function(e){return e.mul(new Lb(r,a)).add(n)})}return Object.defineProperty(e.prototype,"shift",{get:function(){return new Lb(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativePositions",{get:function(){var e=this;return this._positions.map(function(t){return t.sub(e._shift).div(new Lb(e.imageWidth,e.imageHeight))})},enumerable:!0,configurable:!0}),e.prototype.forSize=function(e,t){return new this.constructor(this.relativePositions,{width:e,height:t})},e.prototype.shiftBy=function(e,t){return new this.constructor(this.relativePositions,this._imgDims,new Lb(e,t))},e.prototype.shiftByPoint=function(e){return this.shiftBy(e.x,e.y)},e.prototype.align=function(e,t){if(void 0===t&&(t={}),e){var n=e instanceof Bb?e.box.floor():new Pb(e);return this.shiftBy(n.x,n.y).align(null,t)}var r=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},t),a=r.useDlibAlignment,i=r.minBoxPadding;return a?this.alignDlib():this.alignMinBbox(i)},e.prototype.alignDlib=function(){var e=this.getRefPointsForAlignment(),t=e[0],n=e[1],r=e[2],a=function(e){return r.sub(e).magnitude()},i=(a(t)+a(n))/2,o=Math.floor(i/.45),s=Rb(e),l=Math.floor(Math.max(0,s.x-.5*o)),c=Math.floor(Math.max(0,s.y-.43*o));return new Gb(l,c,Math.min(o,this.imageWidth+l),Math.min(o,this.imageHeight+c))},e.prototype.alignMinBbox=function(e){var t=function(e){var t=e.map(function(e){return e.x}),n=e.map(function(e){return e.y}),r=t.reduce(function(e,t){return t<e?t:e},1/0),a=n.reduce(function(e,t){return t<e?t:e},1/0),i=t.reduce(function(e,t){return e<t?t:e},0),o=n.reduce(function(e,t){return e<t?t:e},0);return new Mb(r,a,i,o)}(this.positions);return t.pad(t.width*e,t.height*e)},e.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},e}(),Kb=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return yb(t,e),t.prototype.getRefPointsForAlignment=function(){var e=this.positions;return[e[0],e[1],Rb([e[3],e[4]])]},t}(qb),Xb=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return yb(t,e),t.prototype.getJawOutline=function(){return this.positions.slice(0,17)},t.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},t.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},t.prototype.getNose=function(){return this.positions.slice(27,36)},t.prototype.getLeftEye=function(){return this.positions.slice(36,42)},t.prototype.getRightEye=function(){return this.positions.slice(42,48)},t.prototype.getMouth=function(){return this.positions.slice(48,68)},t.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(Rb)},t}(qb),Yb=function(){function e(e,t){this._label=e,this._distance=t}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),e.prototype.toString=function(e){return void 0===e&&(e=!0),this.label+(e?" ("+function(e,t){void 0===t&&(t=2);var n=Math.pow(10,t);return Math.floor(e*n)/n}(this.distance)+")":"")},e}(),$b=function(e){function t(t,n){var r=e.call(this,t)||this;return r._label=n,r}return yb(t,e),t.assertIsValidLabeledBox=function(e,t){if(Pb.assertIsValidBox(e,t),!Fb(e.label))throw new Error(t+" - expected property label ("+e.label+") to be a number")},Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),t}(Pb),Jb=function(){function e(e,t){if("string"!==typeof e)throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(t)||t.some(function(e){return!(e instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=e,this._descriptors=t}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(e){return Array.from(e)})}},e.fromJSON=function(t){var n=t.descriptors.map(function(e){return new Float32Array(e)});return new e(t.label,n)},e}();!function(e){function t(t,n,r,a){var i=e.call(this,t,n)||this;return i._score=r,i._classScore=a,i}yb(t,e),t.assertIsValidPredictedBox=function(e,t){if($b.assertIsValidLabeledBox(e,t),!Ob(e.score)||!Ob(e.classScore))throw new Error(t+" - expected properties score ("+e.score+") and ("+e.classScore+") to be a number between [0, 1]")},Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0})}($b);function Qb(e,t){var n={detection:t};return Object.assign({},e,n)}function Zb(){var e=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D:CanvasRenderingContext2D,Image:HTMLImageElement,ImageData:ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:e,readFile:function(){throw new Error("readFile - filesystem not available for browser environment")}}}function ex(e){var t="";if(!e)try{e=n(Object(function(){var e=new Error("Cannot find module 'fs'");throw e.code="MODULE_NOT_FOUND",e}()))}catch(a){t=a.toString()}var r=e?function(t){return new Promise(function(n,r){e.readFile(t,function(e,t){return e?r(e):n(t)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+t)};return{readFile:r}}function tx(){var e=n.g.Canvas||n.g.HTMLCanvasElement,t=n.g.Image||n.g.HTMLImageElement,r=n.g.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},a=ex();return wb({Canvas:e||function(){},CanvasRenderingContext2D:n.g.CanvasRenderingContext2D||function(){},Image:t||function(){},ImageData:n.g.ImageData||function(){},Video:n.g.HTMLVideoElement||function(){},createCanvasElement:function(){if(e)return new e;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},createImageElement:function(){if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},fetch:r},a)}function nx(){return"object"===typeof window&&"undefined"!==typeof document&&"undefined"!==typeof HTMLImageElement&&"undefined"!==typeof HTMLCanvasElement&&"undefined"!==typeof HTMLVideoElement&&"undefined"!==typeof ImageData&&"undefined"!==typeof CanvasRenderingContext2D}function rx(){return"object"===typeof n.g&&"undefined"!==typeof process&&!!process.version}function ax(e){Hb=e}function ix(){nx()&&ax(Zb()),rx()&&ax(tx())}var ox,sx={getEnv:function(){if(!Hb)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return Hb},setEnv:ax,initialize:ix,createBrowserEnv:Zb,createFileSystem:ex,createNodejsEnv:tx,monkeyPatch:function(e){if(Hb||ix(),!Hb)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var t=e.Canvas,n=void 0===t?Hb.Canvas:t,r=e.Image,a=void 0===r?Hb.Image:r;Hb.Canvas=n,Hb.Image=a,Hb.createCanvasElement=e.createCanvasElement||function(){return new n},Hb.createImageElement=e.createImageElement||function(){return new a},Hb.ImageData=e.ImageData||Hb.ImageData,Hb.Video=e.Video||Hb.Video,Hb.fetch=e.fetch||Hb.fetch,Hb.readFile=e.readFile||Hb.readFile},isBrowser:nx,isNodejs:rx};function lx(e){return sx.isNodejs()||"string"!==typeof e?e:document.getElementById(e)}function cx(e){var t=sx.getEnv(),n=t.Canvas;if(e instanceof t.CanvasRenderingContext2D)return e;var r=lx(e);if(!(r instanceof n))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var a=r.getContext("2d");if(!a)throw new Error("resolveContext2d - canvas 2d context is null");return a}ix(),function(e){e.TOP_LEFT="TOP_LEFT",e.TOP_RIGHT="TOP_RIGHT",e.BOTTOM_LEFT="BOTTOM_LEFT",e.BOTTOM_RIGHT="BOTTOM_RIGHT"}(ox||(ox={}));var ux=function(e){void 0===e&&(e={});var t=e.anchorPosition,n=e.backgroundColor,r=e.fontColor,a=e.fontSize,i=e.fontStyle,o=e.padding;this.anchorPosition=t||ox.TOP_LEFT,this.backgroundColor=n||"rgba(0, 0, 0, 0.5)",this.fontColor=r||"rgba(255, 255, 255, 1)",this.fontSize=a||14,this.fontStyle=i||"Georgia",this.padding=o||4},hx=function(){function e(t,n,r){void 0===r&&(r={}),this.text="string"===typeof t?[t]:t instanceof e?t.text:t,this.anchor=n,this.options=new ux(r)}return e.prototype.measureWidth=function(e){var t=this.options.padding;return this.text.map(function(t){return e.measureText(t).width}).reduce(function(e,t){return e<t?t:e},0)+2*t},e.prototype.measureHeight=function(){var e=this.options,t=e.fontSize,n=e.padding;return this.text.length*t+2*n},e.prototype.getUpperLeft=function(e,t){var n=this.options.anchorPosition,r=n===ox.BOTTOM_RIGHT||n===ox.TOP_RIGHT,a=n===ox.BOTTOM_LEFT||n===ox.BOTTOM_RIGHT,i=this.measureWidth(e),o=this.measureHeight(),s=r?this.anchor.x-i:this.anchor.x,l=a?this.anchor.y-o:this.anchor.y;if(t){var c=t.width,u=t.height;return{x:Math.max(Math.min(s,c-i),0),y:Math.max(Math.min(l,u-o),0)}}return{x:s,y:l}},e.prototype.draw=function(e){var t=lx(e),n=cx(t),r=this.options,a=r.backgroundColor,i=r.fontColor,o=r.fontSize,s=r.fontStyle,l=r.padding;n.font=o+"px "+s;var c=this.measureWidth(n),u=this.measureHeight();n.fillStyle=a;var h=this.getUpperLeft(n,t);n.fillRect(h.x,h.y,c,u),n.fillStyle=i,this.text.forEach(function(e,t){var r=l+h.x,a=l+h.y+(t+1)*o;n.fillText(e,r,a)})},e}(),dx=function(e){void 0===e&&(e={});var t=e.boxColor,n=e.lineWidth,r=e.label,a=e.drawLabelOptions;this.boxColor=t||"rgba(0, 0, 255, 1)",this.lineWidth=n||2,this.label=r;var i={anchorPosition:ox.BOTTOM_LEFT,backgroundColor:this.boxColor};this.drawLabelOptions=new ux(Object.assign({},i,a))};!function(){function e(e,t){void 0===t&&(t={}),this.box=new Pb(e),this.options=new dx(t)}e.prototype.draw=function(e){var t=cx(e),n=this.options,r=n.boxColor,a=n.lineWidth,i=this.box,o=i.x,s=i.y,l=i.width,c=i.height;t.strokeStyle=r,t.lineWidth=a,t.strokeRect(o,s,l,c);var u=this.options.label;u&&new hx([u],{x:o-a/2,y:s},this.options.drawLabelOptions).draw(e)}}();function fx(e){var t=sx.getEnv(),n=t.Image,r=t.Video;return e instanceof n&&e.complete||e instanceof r&&e.readyState>=3}function px(e){var t=sx.getEnv(),n=t.Image,r=t.Video;return e instanceof n?new Cb(e.naturalWidth,e.naturalHeight):e instanceof r?new Cb(e.videoWidth,e.videoHeight):new Cb(e.width,e.height)}function gx(e){var t=e.width,n=e.height,r=(0,sx.getEnv().createCanvasElement)();return r.width=t,r.height=n,r}function mx(e,t){var n=sx.getEnv().ImageData;if(!(e instanceof n)&&!fx(e))throw new Error("createCanvasFromMedia - media has not finished loading yet");var r=t||px(e),a=r.width,i=r.height,o=gx({width:a,height:i});return e instanceof n?cx(o).putImageData(e,0,0):cx(o).drawImage(e,0,0,a,i),o}function vx(e,t){return kb(this,void 0,void 0,function(){var n,r,a,i,o,s;return Nb(this,function(l){switch(l.label){case 0:return n=t||sx.getEnv().createCanvasElement(),r=e.shape.slice(Ib(e)?1:0),a=r[0],i=r[1],o=r[2],s=Vs(function(){return e.as3D(a,i,o).toInt()}),[4,rb.toPixels(s,n)];case 1:return l.sent(),s.dispose(),[2,n]}})})}function bx(e){var t=sx.getEnv(),n=t.Image,r=t.Canvas,a=t.Video;return e instanceof n||e instanceof r||e instanceof a}var xx=function(){function e(e,t){var n=this;if(void 0===t&&(t=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(e))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+e);this._treatAsBatchInput=t,this._batchSize=e.length,e.forEach(function(e,t){if(_b(e))return n._imageTensors[t]=e,void(n._inputDimensions[t]=e.shape);if(Ib(e)){var r=e.shape[0];if(1!==r)throw new Error("NetInput - tf.Tensor4D with batchSize "+r+" passed, but not supported in input array");return n._imageTensors[t]=e,void(n._inputDimensions[t]=e.shape.slice(1))}var a=e instanceof sx.getEnv().Canvas?e:mx(e);n._canvases[t]=a,n._inputDimensions[t]=[a.height,a.width,3]})}return Object.defineProperty(e.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reshapedInputDimensions",{get:function(){var e=this;return Db(this.batchSize,0,1).map(function(t,n){return e.getReshapedInputDimensions(n)})},enumerable:!0,configurable:!0}),e.prototype.getInput=function(e){return this.canvases[e]||this.imageTensors[e]},e.prototype.getInputDimensions=function(e){return this._inputDimensions[e]},e.prototype.getInputHeight=function(e){return this._inputDimensions[e][0]},e.prototype.getInputWidth=function(e){return this._inputDimensions[e][1]},e.prototype.getReshapedInputDimensions=function(e){if("number"!==typeof this.inputSize)throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");return function(e,t){var n=e.width,r=e.height,a=t/Math.max(r,n);return new Cb(Math.round(n*a),Math.round(r*a))}({width:this.getInputWidth(e),height:this.getInputHeight(e)},this.inputSize)},e.prototype.toBatchTensor=function(e,t){var n=this;return void 0===t&&(t=!0),this._inputSize=e,Vs(function(){var r=Db(n.batchSize,0,1).map(function(r){var a=n.getInput(r);if(a instanceof wo){var i=Ib(a)?a:a.expandDims();return i=function(e,t){return void 0===t&&(t=!1),Vs(function(){var n=e.shape.slice(1),r=n[0],a=n[1];if(r===a)return e;var i=Math.abs(r-a),o=Math.round(i*(t?.5:1)),s=r>a?2:1,l=function(t){var n=e.shape.slice();return n[s]=t,xl(n,0)},c=l(o),u=i-c.shape[s],h=[t&&u?l(u):null,e,c].filter(function(e){return!!e}).map(function(e){return e.toFloat()});return Nl(h,s)})}(i,t),i.shape[1]===e&&i.shape[2]===e||(i=jm.resizeBilinear(i,[e,e])),i.as3D(e,e,3)}if(a instanceof sx.getEnv().Canvas)return rb.fromPixels(function(e,t,n){void 0===n&&(n=!1);var r=sx.getEnv(),a=r.Image,i=r.Canvas;if(!(e instanceof a||e instanceof i))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var o=px(e),s=t/Math.max(o.height,o.width),l=s*o.width,c=s*o.height,u=gx({width:t,height:t}),h=e instanceof i?e:mx(e),d=Math.abs(l-c)/2,f=n&&l<c?d:0,p=n&&c<l?d:0;return cx(u).drawImage(h,f,p,l,c),u}(a,e,t));throw new Error("toBatchTensor - at batchIdx "+r+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+a)}),a=uc(r.map(function(e){return e.toFloat()})).as4D(n.batchSize,e,e,3);return a})},e}();function yx(e){return kb(this,void 0,void 0,function(){var t,n,r;return Nb(this,function(a){switch(a.label){case 0:if(e instanceof xx)return[2,e];if(!(t=Array.isArray(e)?e:[e]).length)throw new Error("toNetInput - empty array passed as input");return n=function(t){return Array.isArray(e)?" at input index "+t+":":""},(r=t.map(lx)).forEach(function(e,r){if(!bx(e)&&!_b(e)&&!Ib(e)){if("string"===typeof t[r])throw new Error("toNetInput -"+n(r)+" string passed, but could not resolve HTMLElement for element id "+t[r]);throw new Error("toNetInput -"+n(r)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id")}if(Ib(e)){var a=e.shape[0];if(1!==a)throw new Error("toNetInput -"+n(r)+" tf.Tensor4D with batchSize "+a+" passed, but not supported in input array")}}),[4,Promise.all(r.map(function(e){return bx(e)&&(t=e,new Promise(function(e,n){if(t instanceof sx.getEnv().Canvas||fx(t))return e();function r(t){t.currentTarget&&(t.currentTarget.removeEventListener("load",r),t.currentTarget.removeEventListener("error",a),e(t))}function a(e){e.currentTarget&&(e.currentTarget.removeEventListener("load",r),e.currentTarget.removeEventListener("error",a),n(e))}t.addEventListener("load",r),t.addEventListener("error",a)}));var t}))];case 1:return a.sent(),[2,new xx(r,Array.isArray(e))]}})})}function wx(e,t){return kb(this,void 0,void 0,function(){var n,r,a,i,o,s;return Nb(this,function(l){switch(l.label){case 0:return n=sx.getEnv().Canvas,r=e,e instanceof n?[3,5]:[4,yx(e)];case 1:if((a=l.sent()).batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return(i=a.getInput(0))instanceof n?(o=i,[3,4]):[3,2];case 2:return[4,vx(i)];case 3:o=l.sent(),l.label=4;case 4:r=o,l.label=5;case 5:return s=cx(r),[2,t.map(function(e){return e instanceof Bb?e.forSize(r.width,r.height).box.floor():e}).map(function(e){return e.clipAtImageBorders(r.width,r.height)}).map(function(e){var t=e.x,n=e.y,r=e.width,a=e.height,i=gx({width:r,height:a});return cx(i).putImageData(s.getImageData(t,n,r,a),0,0),i})]}})})}function kx(e,t){return kb(this,void 0,void 0,function(){return Nb(this,function(n){if(!_b(e)&&!Ib(e))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(Ib(e)&&e.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,Vs(function(){var n=e.shape.slice(Ib(e)?1:0),r=n[0],a=n[1],i=n[2],o=t.map(function(e){return e instanceof Bb?e.forSize(a,r).box:e}).map(function(e){return e.clipAtImageBorders(a,r)}).map(function(t){var n=t.x,o=t.y,s=t.width,l=t.height;return Eg(e.as3D(r,a,i),[o,n,0],[l,s,i])});return o})]})})}function Nx(e,t){return kb(this,void 0,void 0,function(){var n;return Nb(this,function(r){switch(r.label){case 0:return[4,(0,sx.getEnv().fetch)(e,t)];case 1:if(!((n=r.sent()).status<400))throw new Error("failed to fetch: ("+n.status+") "+n.statusText+", from url: "+n.url);return[2,n]}})})}function Sx(e){return kb(this,void 0,void 0,function(){var t,n;return Nb(this,function(r){switch(r.label){case 0:return[4,Nx(e)];case 1:return[4,(t=r.sent()).blob()];case 2:if(!(n=r.sent()).type.startsWith("image/"))throw new Error("fetchImage - expected blob type to be of type image/*, instead have: "+n.type+", for url: "+t.url);return[2,(a=n,new Promise(function(e,t){if(!(a instanceof Blob))return t("bufferToImage - expected buf to be of type: Blob");var n=new FileReader;n.onload=function(){if("string"!==typeof n.result)return t("bufferToImage - expected reader.result to be a string, in onload");var r=sx.getEnv().createImageElement();r.onload=function(){return e(r)},r.onerror=t,r.src=n.result},n.onerror=t,n.readAsDataURL(a)}))]}var a})})}function Cx(e){return kb(this,void 0,void 0,function(){return Nb(this,function(t){switch(t.label){case 0:return[4,Nx(e)];case 1:return[2,t.sent().json()]}})})}function Ex(e,t){var n=t+"-weights_manifest.json";if(!e)return{modelBaseUri:"",manifestUri:n};if("/"===e)return{modelBaseUri:"/",manifestUri:"/"+n};var r=e.startsWith("http://")?"http://":e.startsWith("https://")?"https://":"",a=(e=e.replace(r,"")).split("/").filter(function(e){return e}),i=e.endsWith(".json")?a[a.length-1]:n,o=r+(e.endsWith(".json")?a.slice(0,a.length-1):a).join("/");return{modelBaseUri:o=e.startsWith("/")?"/"+o:o,manifestUri:"/"===o?"/"+i:o+"/"+i}}function _x(e,t){return kb(this,void 0,void 0,function(){var n,r,a,i;return Nb(this,function(o){switch(o.label){case 0:return n=Ex(e,t),r=n.manifestUri,a=n.modelBaseUri,[4,Cx(r)];case 1:return i=o.sent(),[2,eb.loadWeights(i,a)]}})})}var Ix=function(){function e(e){this._name=e,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(e.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),e.prototype.getParamFromPath=function(e){var t=this.traversePropertyPath(e);return t.obj[t.objProp]},e.prototype.reassignParamFromPath=function(e,t){var n=this.traversePropertyPath(e),r=n.obj,a=n.objProp;r[a].dispose(),r[a]=t},e.prototype.getParamList=function(){var e=this;return this._paramMappings.map(function(t){var n=t.paramPath;return{path:n,tensor:e.getParamFromPath(n)}})},e.prototype.getTrainableParams=function(){return this.getParamList().filter(function(e){return e.tensor instanceof _o})},e.prototype.getFrozenParams=function(){return this.getParamList().filter(function(e){return!(e.tensor instanceof _o)})},e.prototype.variable=function(){var e=this;this.getFrozenParams().forEach(function(t){var n=t.path,r=t.tensor;e.reassignParamFromPath(n,r.variable())})},e.prototype.freeze=function(){var e=this;this.getTrainableParams().forEach(function(t){var n=t.path,r=t.tensor,a=ul(r.dataSync());r.dispose(),e.reassignParamFromPath(n,a)})},e.prototype.dispose=function(e){void 0===e&&(e=!0),this.getParamList().forEach(function(t){if(e&&t.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+t.path);t.tensor.dispose()}),this._params=void 0},e.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(e){var t=e.tensor;return Array.from(t.dataSync())}).reduce(function(e,t){return e.concat(t)}))},e.prototype.load=function(e){return kb(this,void 0,void 0,function(){return Nb(this,function(t){switch(t.label){case 0:return e instanceof Float32Array?(this.extractWeights(e),[2]):[4,this.loadFromUri(e)];case 1:return t.sent(),[2]}})})},e.prototype.loadFromUri=function(e){return kb(this,void 0,void 0,function(){var t;return Nb(this,function(n){switch(n.label){case 0:if(e&&"string"!==typeof e)throw new Error(this._name+".loadFromUri - expected model uri");return[4,_x(e,this.getDefaultModelName())];case 1:return t=n.sent(),this.loadFromWeightMap(t),[2]}})})},e.prototype.loadFromDisk=function(e){return kb(this,void 0,void 0,function(){var t,n,r,a,i,o,s,l,c,u;return Nb(this,function(h){switch(h.label){case 0:if(e&&"string"!==typeof e)throw new Error(this._name+".loadFromDisk - expected model file path");return t=sx.getEnv().readFile,n=Ex(e,this.getDefaultModelName()),r=n.manifestUri,a=n.modelBaseUri,i=function(e){return Promise.all(e.map(function(e){return t(e).then(function(e){return e.buffer})}))},o=eb.weightsLoaderFactory(i),c=(l=JSON).parse,[4,t(r)];case 1:return s=c.apply(l,[h.sent().toString()]),[4,o(s,a)];case 2:return u=h.sent(),this.loadFromWeightMap(u),[2]}})})},e.prototype.loadFromWeightMap=function(e){var t=this.extractParamsFromWeigthMap(e),n=t.paramMappings,r=t.params;this._paramMappings=n,this._params=r},e.prototype.extractWeights=function(e){var t=this.extractParams(e),n=t.paramMappings,r=t.params;this._paramMappings=n,this._params=r},e.prototype.traversePropertyPath=function(e){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var t=e.split("/").reduce(function(t,n){if(!t.nextObj.hasOwnProperty(n))throw new Error("traversePropertyPath - object does not have property "+n+", for path "+e);return{obj:t.nextObj,objProp:n,nextObj:t.nextObj[n]}},{nextObj:this.params}),n=t.obj,r=t.objProp;if(!n||!r||!(n[r]instanceof wo))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+e);return{obj:n,objProp:r}},e}();function Tx(e,t,n){return Vs(function(){var r=ig(e,t.depthwise_filter,t.pointwise_filter,n,"same");return r=hp(r,t.bias)})}function Ax(e,t,n){return void 0===n&&(n=!1),Vs(function(){var r=Vg(n?hp(Qp(e,t.conv0.filters,[2,2],"same"),t.conv0.bias):Tx(e,t.conv0,[2,2])),a=Tx(r,t.conv1,[1,1]),i=Tx(Vg(hp(r,a)),t.conv2,[1,1]);return Vg(hp(r,hp(a,i)))})}function Rx(e,t,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!0),Vs(function(){var a=Vg(n?hp(Qp(e,t.conv0.filters,r?[2,2]:[1,1],"same"),t.conv0.bias):Tx(e,t.conv0,r?[2,2]:[1,1])),i=Tx(a,t.conv1,[1,1]),o=Tx(Vg(hp(a,i)),t.conv2,[1,1]),s=Tx(Vg(hp(a,hp(i,o))),t.conv3,[1,1]);return Vg(hp(a,hp(i,hp(o,s))))})}function Dx(e,t,n,r){return void 0===n&&(n="same"),void 0===r&&(r=!1),Vs(function(){var a=hp(Qp(e,t.filters,[1,1],n),t.bias);return r?Vg(a):a})}function Fx(e,t){Object.keys(e).forEach(function(n){t.some(function(e){return e.originalPath===n})||e[n].dispose()})}function Ox(e,t){return function(n,r,a,i){var o=ml(e(n*r*a*a),[a,a,n,r]),s=fl(e(r));return t.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:o,bias:s}}}function Lx(e,t){return function(n,r,a){var i=pl(e(n*r),[n,r]),o=fl(e(r));return t.push({paramPath:a+"/weights"},{paramPath:a+"/bias"}),{weights:i,bias:o}}}var Px=function(e,t,n){this.depthwise_filter=e,this.pointwise_filter=t,this.bias=n};function Mx(e,t){return function(n,r,a){var i=ml(e(9*n),[3,3,n,1]),o=ml(e(n*r),[1,1,n,r]),s=fl(e(r));return t.push({paramPath:a+"/depthwise_filter"},{paramPath:a+"/pointwise_filter"},{paramPath:a+"/bias"}),new Px(i,o,s)}}function jx(e){return function(t){var n=e(t+"/depthwise_filter",4),r=e(t+"/pointwise_filter",4),a=e(t+"/bias",1);return new Px(n,r,a)}}function Bx(e,t){return function(n,r,a){var i=e[n];if(!Eb(i,r))throw new Error("expected weightMap["+n+"] to be a Tensor"+r+"D, instead have "+i);return t.push({originalPath:n,paramPath:a||n}),i}}function zx(e){var t=e;return{extractWeights:function(e){var n=t.slice(0,e);return t=t.slice(e),n},getRemainingWeights:function(){return t}}}function Wx(e,t){var n=Ox(e,t),r=Mx(e,t);function a(e,t,a,i){return void 0===i&&(i=!1),{conv0:i?n(e,t,3,a+"/conv0"):r(e,t,a+"/conv0"),conv1:r(t,t,a+"/conv1"),conv2:r(t,t,a+"/conv2")}}return{extractDenseBlock3Params:a,extractDenseBlock4Params:function(e,t,n,i){void 0===i&&(i=!1);var o=a(e,t,n,i);return{conv0:o.conv0,conv1:o.conv1,conv2:o.conv2,conv3:r(t,t,n+"/conv3")}}}}function Ux(e){return function(t){return{filters:e(t+"/filters",4),bias:e(t+"/bias",1)}}}function Vx(e,t){var n=Bx(e,t),r=Ux(n),a=jx(n);return{extractDenseBlock3Params:function(e,t){return void 0===t&&(t=!1),{conv0:t?r(e+"/conv0"):a(e+"/conv0"),conv1:a(e+"/conv1"),conv2:a(e+"/conv2")}},extractDenseBlock4Params:function(e,t){return void 0===t&&(t=!1),{conv0:t?r(e+"/conv0"):a(e+"/conv0"),conv1:a(e+"/conv1"),conv2:a(e+"/conv2"),conv3:a(e+"/conv3")}}}}var Hx=function(e){function t(){return e.call(this,"FaceFeatureExtractor")||this}return yb(t,e),t.prototype.forwardInput=function(e){var t=this.params;if(!t)throw new Error("FaceFeatureExtractor - load model before inference");return Vs(function(){var n=Rx(Ub(e.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(dl(255)),t.dense0,!0);return n=Rx(n,t.dense1),n=Rx(n,t.dense2),n=Rx(n,t.dense3),n=xg(n,[7,7],[2,2],"valid")})},t.prototype.forward=function(e){return kb(this,void 0,void 0,function(){var t;return Nb(this,function(n){switch(n.label){case 0:return t=this.forwardInput,[4,yx(e)];case 1:return[2,t.apply(this,[n.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},t.prototype.extractParamsFromWeigthMap=function(e){return function(e){var t=[],n=Vx(e,t).extractDenseBlock4Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")};return Fx(e,t),{params:r,paramMappings:t}}(e)},t.prototype.extractParams=function(e){return function(e){var t=[],n=zx(e),r=n.extractWeights,a=n.getRemainingWeights,i=Wx(r,t).extractDenseBlock4Params,o=i(3,32,"dense0",!0),s=i(32,64,"dense1"),l=i(64,128,"dense2"),c=i(128,256,"dense3");if(0!==a().length)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:t,params:{dense0:o,dense1:s,dense2:l,dense3:c}}}(e)},t}(Ix);function Gx(e,t){return Vs(function(){return hp(lg(e,t.weights),t.bias)})}function qx(e){var t={},n={};return Object.keys(e).forEach(function(r){(r.startsWith("fc")?n:t)[r]=e[r]}),{featureExtractorMap:t,classifierMap:n}}var Kx=function(e){function t(t,n){var r=e.call(this,t)||this;return r._faceFeatureExtractor=n,r}return yb(t,e),Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(e){var t=this,n=this.params;if(!n)throw new Error(this._name+" - load model before inference");return Vs(function(){var r=e instanceof xx?t.faceFeatureExtractor.forwardInput(e):e;return Gx(r.as2D(r.shape[0],-1),n.fc)})},t.prototype.dispose=function(t){void 0===t&&(t=!0),this.faceFeatureExtractor.dispose(t),e.prototype.dispose.call(this,t)},t.prototype.loadClassifierParams=function(e){var t=this.extractClassifierParams(e),n=t.params,r=t.paramMappings;this._params=n,this._paramMappings=r},t.prototype.extractClassifierParams=function(e){return function(e,t,n){var r=[],a=zx(e),i=a.extractWeights,o=a.getRemainingWeights,s=Lx(i,r)(t,n,"fc");if(0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:r,params:{fc:s}}}(e,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},t.prototype.extractParamsFromWeigthMap=function(e){var t=qx(e),n=t.featureExtractorMap,r=t.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(n),function(e){var t,n=[],r=Bx(e,n),a={fc:(t="fc",{weights:r(t+"/weights",2),bias:r(t+"/bias",1)})};return Fx(e,n),{params:a,paramMappings:n}}(r)},t.prototype.extractParams=function(e){var t=this.getClassifierChannelsIn(),n=this.getClassifierChannelsOut(),r=n*t+n,a=e.slice(0,e.length-r),i=e.slice(e.length-r);return this.faceFeatureExtractor.extractWeights(a),this.extractClassifierParams(i)},t}(Ix),Xx=["neutral","happy","sad","angry","fearful","disgusted","surprised"],Yx=function(){function e(e){var t=this;if(7!==e.length)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+e.length);Xx.forEach(function(n,r){t[n]=e[r]})}return e.prototype.asSortedArray=function(){var e=this;return Xx.map(function(t){return{expression:t,probability:e[t]}}).sort(function(e,t){return t.probability-e.probability})},e}(),$x=function(e){function t(t){return void 0===t&&(t=new Hx),e.call(this,"FaceExpressionNet",t)||this}return yb(t,e),t.prototype.forwardInput=function(e){var t=this;return Vs(function(){return Dc(t.runNet(e))})},t.prototype.forward=function(e){return kb(this,void 0,void 0,function(){var t;return Nb(this,function(n){switch(n.label){case 0:return t=this.forwardInput,[4,yx(e)];case 1:return[2,t.apply(this,[n.sent()])]}})})},t.prototype.predictExpressions=function(e){return kb(this,void 0,void 0,function(){var t,n,r,a,i=this;return Nb(this,function(o){switch(o.label){case 0:return[4,yx(e)];case 1:return t=o.sent(),[4,this.forwardInput(t)];case 2:return n=o.sent(),[4,Promise.all(fc(n).map(function(e){return kb(i,void 0,void 0,function(){var t;return Nb(this,function(n){switch(n.label){case 0:return[4,e.data()];case 1:return t=n.sent(),e.dispose(),[2,t]}})})}))];case 3:return r=o.sent(),n.dispose(),a=r.map(function(e){return new Yx(e)}),[2,t.isBatchInput?a:a[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_expression_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t.prototype.getClassifierChannelsOut=function(){return 7},t}(Kx);function Jx(e,t){var n={expressions:t};return Object.assign({},e,n)}function Qx(e){return function(e){return e.detection instanceof Bb}(e)&&e.landmarks instanceof qb&&e.unshiftedLandmarks instanceof qb&&e.alignedRect instanceof Bb}function Zx(e,t){var n=e.detection.box,r=t.shiftBy(n.x,n.y),a=r.align(),i=e.detection.imageDims,o={landmarks:r,unshiftedLandmarks:t,alignedRect:new Bb(e.detection.score,a.rescale(i.reverse()),i)};return Object.assign({},e,o)}function ey(e,t,n){if(void 0===n&&(n=!1),e.beginPath(),t.slice(1).forEach(function(n,r){var a=n.x,i=n.y,o=t[r];e.moveTo(o.x,o.y),e.lineTo(a,i)}),n){var r=t[t.length-1],a=t[0];if(!r||!a)return;e.moveTo(r.x,r.y),e.lineTo(a.x,a.y)}e.stroke()}var ty=function(e){void 0===e&&(e={});var t=e.drawLines,n=void 0===t||t,r=e.drawPoints,a=void 0===r||r,i=e.lineWidth,o=e.lineColor,s=e.pointSize,l=e.pointColor;this.drawLines=n,this.drawPoints=a,this.lineWidth=i||1,this.pointSize=s||2,this.lineColor=o||"rgba(0, 255, 255, 1)",this.pointColor=l||"rgba(255, 0, 255, 1)"};!function(){function e(e,t){void 0===t&&(t={}),this.faceLandmarks=e,this.options=new ty(t)}e.prototype.draw=function(e){var t=cx(e),n=this.options,r=n.drawLines,a=n.drawPoints,i=n.lineWidth,o=n.lineColor,s=n.pointSize,l=n.pointColor;if(r&&this.faceLandmarks instanceof Xb&&(t.strokeStyle=o,t.lineWidth=i,ey(t,this.faceLandmarks.getJawOutline()),ey(t,this.faceLandmarks.getLeftEyeBrow()),ey(t,this.faceLandmarks.getRightEyeBrow()),ey(t,this.faceLandmarks.getNose()),ey(t,this.faceLandmarks.getLeftEye(),!0),ey(t,this.faceLandmarks.getRightEye(),!0),ey(t,this.faceLandmarks.getMouth(),!0)),a){t.strokeStyle=l,t.fillStyle=l;this.faceLandmarks.positions.forEach(function(e){t.beginPath(),t.arc(e.x,e.y,s,0,2*Math.PI),t.fill()})}}}();function ny(e,t){var n=[],r=zx(e),a=r.extractWeights,i=r.getRemainingWeights,o=function(e,t){var n=Ox(e,t),r=Mx(e,t);return{extractConvParams:n,extractSeparableConvParams:r,extractReductionBlockParams:function(e,t,a){return{separable_conv0:r(e,t,a+"/separable_conv0"),separable_conv1:r(t,t,a+"/separable_conv1"),expansion_conv:n(e,t,1,a+"/expansion_conv")}},extractMainBlockParams:function(e,t){return{separable_conv0:r(e,e,t+"/separable_conv0"),separable_conv1:r(e,e,t+"/separable_conv1"),separable_conv2:r(e,e,t+"/separable_conv2")}}}}(a,n),s=o.extractConvParams,l=o.extractSeparableConvParams,c=o.extractReductionBlockParams,u=o.extractMainBlockParams,h={conv_in:s(3,32,3,"entry_flow/conv_in"),reduction_block_0:c(32,64,"entry_flow/reduction_block_0"),reduction_block_1:c(64,128,"entry_flow/reduction_block_1")},d={};Db(t,0,1).forEach(function(e){d["main_block_"+e]=u(128,"middle_flow/main_block_"+e)});var f={reduction_block:c(128,256,"exit_flow/reduction_block"),separable_conv:l(256,512,"exit_flow/separable_conv")};if(0!==i().length)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:n,params:{entry_flow:h,middle_flow:d,exit_flow:f}}}function ry(e,t){var n=[],r=function(e,t){var n=Bx(e,t),r=Ux(n),a=jx(n);return{extractConvParams:r,extractSeparableConvParams:a,extractReductionBlockParams:function(e){return{separable_conv0:a(e+"/separable_conv0"),separable_conv1:a(e+"/separable_conv1"),expansion_conv:r(e+"/expansion_conv")}},extractMainBlockParams:function(e){return{separable_conv0:a(e+"/separable_conv0"),separable_conv1:a(e+"/separable_conv1"),separable_conv2:a(e+"/separable_conv2")}}}}(e,n),a=r.extractConvParams,i=r.extractSeparableConvParams,o=r.extractReductionBlockParams,s=r.extractMainBlockParams,l={conv_in:a("entry_flow/conv_in"),reduction_block_0:o("entry_flow/reduction_block_0"),reduction_block_1:o("entry_flow/reduction_block_1")},c={};Db(t,0,1).forEach(function(e){c["main_block_"+e]=s("middle_flow/main_block_"+e)});var u={reduction_block:o("exit_flow/reduction_block"),separable_conv:i("exit_flow/separable_conv")};return Fx(e,n),{params:{entry_flow:l,middle_flow:c,exit_flow:u},paramMappings:n}}function ay(e,t,n){return hp(Qp(e,t.filters,n,"same"),t.bias)}function iy(e,t,n){void 0===n&&(n=!0);var r=n?Vg(e):e;return r=Tx(r,t.separable_conv0,[1,1]),r=Tx(Vg(r),t.separable_conv1,[1,1]),r=bg(r,[3,3],[2,2],"same"),r=hp(r,ay(e,t.expansion_conv,[2,2]))}var oy,sy=function(e){function t(t){var n=e.call(this,"TinyXception")||this;return n._numMainBlocks=t,n}return yb(t,e),t.prototype.forwardInput=function(e){var t=this,n=this.params;if(!n)throw new Error("TinyXception - load model before inference");return Vs(function(){var r=Ub(e.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(dl(256)),a=Vg(ay(r,n.entry_flow.conv_in,[2,2]));return a=iy(a,n.entry_flow.reduction_block_0,!1),a=iy(a,n.entry_flow.reduction_block_1),Db(t._numMainBlocks,0,1).forEach(function(e){a=function(e,t){var n=Tx(Vg(e),t.separable_conv0,[1,1]);return n=Tx(Vg(n),t.separable_conv1,[1,1]),n=Tx(Vg(n),t.separable_conv2,[1,1]),hp(n,e)}(a,n.middle_flow["main_block_"+e])}),a=iy(a,n.exit_flow.reduction_block),a=Vg(Tx(a,n.exit_flow.separable_conv,[1,1]))})},t.prototype.forward=function(e){return kb(this,void 0,void 0,function(){var t;return Nb(this,function(n){switch(n.label){case 0:return t=this.forwardInput,[4,yx(e)];case 1:return[2,t.apply(this,[n.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"tiny_xception_model"},t.prototype.extractParamsFromWeigthMap=function(e){return ry(e,this._numMainBlocks)},t.prototype.extractParams=function(e){return ny(e,this._numMainBlocks)},t}(Ix);!function(e){e.FEMALE="female",e.MALE="male"}(oy||(oy={}));var ly=function(e){function t(t){void 0===t&&(t=new sy(2));var n=e.call(this,"AgeGenderNet")||this;return n._faceFeatureExtractor=t,n}return yb(t,e),Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(e){var t=this,n=this.params;if(!n)throw new Error(this._name+" - load model before inference");return Vs(function(){var r=e instanceof xx?t.faceFeatureExtractor.forwardInput(e):e,a=xg(r,[7,7],[2,2],"valid").as2D(r.shape[0],-1);return{age:Gx(a,n.fc.age).as1D(),gender:Gx(a,n.fc.gender)}})},t.prototype.forwardInput=function(e){var t=this;return Vs(function(){var n=t.runNet(e),r=n.age,a=n.gender;return{age:r,gender:Dc(a)}})},t.prototype.forward=function(e){return kb(this,void 0,void 0,function(){var t;return Nb(this,function(n){switch(n.label){case 0:return t=this.forwardInput,[4,yx(e)];case 1:return[2,t.apply(this,[n.sent()])]}})})},t.prototype.predictAgeAndGender=function(e){return kb(this,void 0,void 0,function(){var t,n,r,a,i,o,s=this;return Nb(this,function(l){switch(l.label){case 0:return[4,yx(e)];case 1:return t=l.sent(),[4,this.forwardInput(t)];case 2:return n=l.sent(),r=fc(n.age),a=fc(n.gender),i=r.map(function(e,t){return{ageTensor:e,genderTensor:a[t]}}),[4,Promise.all(i.map(function(e){var t=e.ageTensor,n=e.genderTensor;return kb(s,void 0,void 0,function(){var e,r,a,i,o;return Nb(this,function(s){switch(s.label){case 0:return[4,t.data()];case 1:return e=s.sent()[0],[4,n.data()];case 2:return r=s.sent()[0],i=(a=r>.5)?oy.MALE:oy.FEMALE,o=a?r:1-r,t.dispose(),n.dispose(),[2,{age:e,gender:i,genderProbability:o}]}})})}))];case 3:return o=l.sent(),n.age.dispose(),n.gender.dispose(),[2,t.isBatchInput?o:o[0]]}})})},t.prototype.getDefaultModelName=function(){return"age_gender_model"},t.prototype.dispose=function(t){void 0===t&&(t=!0),this.faceFeatureExtractor.dispose(t),e.prototype.dispose.call(this,t)},t.prototype.loadClassifierParams=function(e){var t=this.extractClassifierParams(e),n=t.params,r=t.paramMappings;this._params=n,this._paramMappings=r},t.prototype.extractClassifierParams=function(e){return function(e){var t=[],n=zx(e),r=n.extractWeights,a=n.getRemainingWeights,i=Lx(r,t),o=i(512,1,"fc/age"),s=i(512,2,"fc/gender");if(0!==a().length)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:t,params:{fc:{age:o,gender:s}}}}(e)},t.prototype.extractParamsFromWeigthMap=function(e){var t=qx(e),n=t.featureExtractorMap,r=t.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(n),function(e){var t=[],n=Bx(e,t);function r(e){return{weights:n(e+"/weights",2),bias:n(e+"/bias",1)}}var a={fc:{age:r("fc/age"),gender:r("fc/gender")}};return Fx(e,t),{params:a,paramMappings:t}}(r)},t.prototype.extractParams=function(e){var t=e.slice(0,e.length-1539),n=e.slice(e.length-1539);return this.faceFeatureExtractor.extractWeights(t),this.extractClassifierParams(n)},t}(Ix),cy=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return yb(t,e),t.prototype.postProcess=function(e,t,n){var r=n.map(function(e){var n=e.width,r=e.height,a=t/Math.max(r,n);return{width:n*a,height:r*a}}),a=r.length;return Vs(function(){var n=function(e,t){return uc([xl([68],e),xl([68],t)],1).as2D(1,136).as1D()},i=function(e,t){var n=r[e],a=n.width,i=n.height;return t(a,i)?Math.abs(a-i)/2:0},o=e.mul(xl([a,136],t)).sub(uc(Array.from(Array(a),function(e,t){return n(function(e){return i(e,function(e,t){return e<t})}(t),function(e){return i(e,function(e,t){return t<e})}(t))}))).div(uc(Array.from(Array(a),function(e,t){return n(r[t].width,r[t].height)})));return o})},t.prototype.forwardInput=function(e){var t=this;return Vs(function(){var n=t.runNet(e);return t.postProcess(n,e.inputSize,e.inputDimensions.map(function(e){return{height:e[0],width:e[1]}}))})},t.prototype.forward=function(e){return kb(this,void 0,void 0,function(){var t;return Nb(this,function(n){switch(n.label){case 0:return t=this.forwardInput,[4,yx(e)];case 1:return[2,t.apply(this,[n.sent()])]}})})},t.prototype.detectLandmarks=function(e){return kb(this,void 0,void 0,function(){var t,n,r,a=this;return Nb(this,function(i){switch(i.label){case 0:return[4,yx(e)];case 1:return t=i.sent(),n=Vs(function(){return fc(a.forwardInput(t))}),[4,Promise.all(n.map(function(e,n){return kb(a,void 0,void 0,function(){var r,a,i,o,s;return Nb(this,function(l){switch(l.label){case 0:return i=(a=Array).from,[4,e.data()];case 1:return r=i.apply(a,[l.sent()]),o=r.filter(function(e,t){return Tb(t)}),s=r.filter(function(e,t){return!Tb(t)}),[2,new Xb(Array(68).fill(0).map(function(e,t){return new Lb(o[t],s[t])}),{height:t.getInputHeight(n),width:t.getInputWidth(n)})]}})})}))];case 2:return r=i.sent(),n.forEach(function(e){return e.dispose()}),[2,t.isBatchInput?r:r[0]]}})})},t.prototype.getClassifierChannelsOut=function(){return 136},t}(Kx),uy=function(e){function t(t){return void 0===t&&(t=new Hx),e.call(this,"FaceLandmark68Net",t)||this}return yb(t,e),t.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t}(cy);var hy=function(e){function t(){return e.call(this,"TinyFaceFeatureExtractor")||this}return yb(t,e),t.prototype.forwardInput=function(e){var t=this.params;if(!t)throw new Error("TinyFaceFeatureExtractor - load model before inference");return Vs(function(){var n=Ax(Ub(e.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(dl(255)),t.dense0,!0);return n=Ax(n,t.dense1),n=Ax(n,t.dense2),n=xg(n,[14,14],[2,2],"valid")})},t.prototype.forward=function(e){return kb(this,void 0,void 0,function(){var t;return Nb(this,function(n){switch(n.label){case 0:return t=this.forwardInput,[4,yx(e)];case 1:return[2,t.apply(this,[n.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},t.prototype.extractParamsFromWeigthMap=function(e){return function(e){var t=[],n=Vx(e,t).extractDenseBlock3Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2")};return Fx(e,t),{params:r,paramMappings:t}}(e)},t.prototype.extractParams=function(e){return function(e){var t=[],n=zx(e),r=n.extractWeights,a=n.getRemainingWeights,i=Wx(r,t).extractDenseBlock3Params,o=i(3,32,"dense0",!0),s=i(32,64,"dense1"),l=i(64,128,"dense2");if(0!==a().length)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:t,params:{dense0:o,dense1:s,dense2:l}}}(e)},t}(Ix),dy=function(e){function t(t){return void 0===t&&(t=new hy),e.call(this,"FaceLandmark68TinyNet",t)||this}return yb(t,e),t.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},t.prototype.getClassifierChannelsIn=function(){return 128},t}(cy);!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}yb(t,e)}(uy);function fy(e,t,n,r,a){void 0===a&&(a="same");var i=t.conv,o=i.filters,s=i.bias,l=Qp(e,o,n,a);return l=function(e,t){return hp(Cp(e,t.weights),t.biases)}(l=hp(l,s),t.scale),r?Vg(l):l}function py(e,t){return fy(e,t,[1,1],!1)}function gy(e,t){return fy(e,t,[2,2],!0,"valid")}function my(e,t){function n(n,r,a,i){var o=function(t,n,r){var a=e(t),i=a.length/(n*r*r);if(i%1!==0)throw new Error("depth has to be an integer: "+i+", weights.length: "+a.length+", numFilters: "+n+", filterSize: "+r);return Vs(function(){return qg(ml(a,[n,i,r,r]),[2,3,1,0])})}(n,r,a),s=fl(e(r));return t.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:o,bias:s}}function r(r,a,i,o){var s=n(r,a,i,o+"/conv"),l=function(n,r){var a=fl(e(n)),i=fl(e(n));return t.push({paramPath:r+"/weights"},{paramPath:r+"/biases"}),{weights:a,biases:i}}(a,o+"/scale");return{conv:s,scale:l}}return{extractConvLayerParams:r,extractResidualLayerParams:function(e,t,n,a,i){return void 0===i&&(i=!1),{conv1:r((i?.5:1)*e,t,n,a+"/conv1"),conv2:r(e,t,n,a+"/conv2")}}}}function vy(e,t){var n=Bx(e,t);function r(e){var t=n(e+"/conv/filters",4),r=n(e+"/conv/bias",1),a=function(e){return{weights:n(e+"/scale/weights",1),biases:n(e+"/scale/biases",1)}}(e);return{conv:{filters:t,bias:r},scale:a}}return{extractConvLayerParams:r,extractResidualLayerParams:function(e){return{conv1:r(e+"/conv1"),conv2:r(e+"/conv2")}}}}function by(e){var t=[],n=vy(e,t),r=n.extractConvLayerParams,a=n.extractResidualLayerParams,i=r("conv32_down"),o=a("conv32_1"),s=a("conv32_2"),l=a("conv32_3"),c=a("conv64_down"),u=a("conv64_1"),h=a("conv64_2"),d=a("conv64_3"),f=a("conv128_down"),p=a("conv128_1"),g=a("conv128_2"),m=a("conv256_down"),v=a("conv256_1"),b=a("conv256_2"),x=a("conv256_down_out"),y=e.fc;if(t.push({originalPath:"fc",paramPath:"fc"}),!function(e){return Eb(e,2)}(y))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+y);var w={conv32_down:i,conv32_1:o,conv32_2:s,conv32_3:l,conv64_down:c,conv64_1:u,conv64_2:h,conv64_3:d,conv128_down:f,conv128_1:p,conv128_2:g,conv256_down:m,conv256_1:v,conv256_2:b,conv256_down_out:x,fc:y};return Fx(e,t),{params:w,paramMappings:t}}function xy(e,t){var n=function(e,t){return fy(e,t,[1,1],!0)}(e,t.conv1);return n=py(n,t.conv2),n=hp(n,e),n=Vg(n)}function yy(e,t){var n=gy(e,t.conv1);n=py(n,t.conv2);var r=xg(e,2,2,"valid"),a=bl(r.shape),i=r.shape[3]!==n.shape[3];if(r.shape[1]!==n.shape[1]||r.shape[2]!==n.shape[2]){var o=Sb(n.shape);o[1]=1;var s=bl(o),l=Sb((n=Nl([n,s],1)).shape);l[2]=1;var c=bl(l);n=Nl([n,c],2)}return r=i?Nl([r,a],3):r,n=hp(r,n),n=Vg(n)}var wy=function(e){function t(){return e.call(this,"FaceRecognitionNet")||this}return yb(t,e),t.prototype.forwardInput=function(e){var t=this.params;if(!t)throw new Error("FaceRecognitionNet - load model before inference");return Vs(function(){var n=gy(Ub(e.toBatchTensor(150,!0).toFloat(),[122.782,117.001,104.298]).div(dl(256)),t.conv32_down);n=xy(n=bg(n,3,2,"valid"),t.conv32_1),n=xy(n,t.conv32_2),n=xy(n,t.conv32_3),n=xy(n=yy(n,t.conv64_down),t.conv64_1),n=xy(n,t.conv64_2),n=xy(n,t.conv64_3),n=xy(n=yy(n,t.conv128_down),t.conv128_1),n=xy(n,t.conv128_2),n=xy(n=yy(n,t.conv256_down),t.conv256_1);var r=(n=yy(n=xy(n,t.conv256_2),t.conv256_down_out)).mean([1,2]);return lg(r,t.fc)})},t.prototype.forward=function(e){return kb(this,void 0,void 0,function(){var t;return Nb(this,function(n){switch(n.label){case 0:return t=this.forwardInput,[4,yx(e)];case 1:return[2,t.apply(this,[n.sent()])]}})})},t.prototype.computeFaceDescriptor=function(e){return kb(this,void 0,void 0,function(){var t,n,r,a=this;return Nb(this,function(i){switch(i.label){case 0:return[4,yx(e)];case 1:return t=i.sent(),n=Vs(function(){return fc(a.forwardInput(t))}),[4,Promise.all(n.map(function(e){return e.data()}))];case 2:return r=i.sent(),n.forEach(function(e){return e.dispose()}),[2,t.isBatchInput?r:r[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_recognition_model"},t.prototype.extractParamsFromWeigthMap=function(e){return by(e)},t.prototype.extractParams=function(e){return function(e){var t=zx(e),n=t.extractWeights,r=t.getRemainingWeights,a=[],i=my(n,a),o=i.extractConvLayerParams,s=i.extractResidualLayerParams,l=o(4704,32,7,"conv32_down"),c=s(9216,32,3,"conv32_1"),u=s(9216,32,3,"conv32_2"),h=s(9216,32,3,"conv32_3"),d=s(36864,64,3,"conv64_down",!0),f=s(36864,64,3,"conv64_1"),p=s(36864,64,3,"conv64_2"),g=s(36864,64,3,"conv64_3"),m=s(147456,128,3,"conv128_down",!0),v=s(147456,128,3,"conv128_1"),b=s(147456,128,3,"conv128_2"),x=s(589824,256,3,"conv256_down",!0),y=s(589824,256,3,"conv256_1"),w=s(589824,256,3,"conv256_2"),k=s(589824,256,3,"conv256_down_out"),N=Vs(function(){return qg(pl(n(32768),[128,256]),[1,0])});if(a.push({paramPath:"fc"}),0!==r().length)throw new Error("weights remaing after extract: "+r().length);return{params:{conv32_down:l,conv32_1:c,conv32_2:u,conv32_3:h,conv64_down:d,conv64_1:f,conv64_2:p,conv64_3:g,conv128_down:m,conv128_1:v,conv128_2:b,conv256_down:x,conv256_1:y,conv256_2:w,conv256_down_out:k,fc:N},paramMappings:a}}(e)},t}(Ix);function ky(e,t,n){var r={gender:t,genderProbability:n};return Object.assign({},e,r)}var Ny=function(){function e(e){var t=void 0===e?{}:e,n=t.minFaceSize,r=t.scaleFactor,a=t.maxNumScales,i=t.scoreThresholds,o=t.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=n||20,this._scaleFactor=r||.709,this._maxNumScales=a||10,this._scoreThresholds=i||[.6,.7,.7],this._scaleSteps=o,"number"!==typeof this._minFaceSize||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if("number"!==typeof this._scaleFactor||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if("number"!==typeof this._maxNumScales||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||3!==this._scoreThresholds.length||this._scoreThresholds.some(function(e){return"number"!==typeof e}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(e){return"number"!==typeof e})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(e.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),e}();function Sy(e,t){function n(n,r,a,i,o){var s=ml(e(n*r*a*a),[a,a,n,r]),l=fl(e(r));return t.push({paramPath:i+"/filters"},{paramPath:i+"/"+(o?"batch_norm_offset":"bias")}),{filters:s,bias:l}}function r(e,t,r,a){var i=n(e,t,r,a,!0);return{filters:i.filters,batch_norm_offset:i.bias}}function a(n,a,i){var o=function(n,r){var a=ml(e(9*n),[3,3,n,1]),i=fl(e(n)),o=fl(e(n)),s=fl(e(n)),l=fl(e(n));return t.push({paramPath:r+"/filters"},{paramPath:r+"/batch_norm_scale"},{paramPath:r+"/batch_norm_offset"},{paramPath:r+"/batch_norm_mean"},{paramPath:r+"/batch_norm_variance"}),{filters:a,batch_norm_scale:i,batch_norm_offset:o,batch_norm_mean:s,batch_norm_variance:l}}(n,i+"/depthwise_conv");return{depthwise_conv:o,pointwise_conv:r(n,a,1,i+"/pointwise_conv")}}return{extractMobilenetV1Params:function(){return{conv_0:r(3,32,3,"mobilenetv1/conv_0"),conv_1:a(32,64,"mobilenetv1/conv_1"),conv_2:a(64,128,"mobilenetv1/conv_2"),conv_3:a(128,128,"mobilenetv1/conv_3"),conv_4:a(128,256,"mobilenetv1/conv_4"),conv_5:a(256,256,"mobilenetv1/conv_5"),conv_6:a(256,512,"mobilenetv1/conv_6"),conv_7:a(512,512,"mobilenetv1/conv_7"),conv_8:a(512,512,"mobilenetv1/conv_8"),conv_9:a(512,512,"mobilenetv1/conv_9"),conv_10:a(512,512,"mobilenetv1/conv_10"),conv_11:a(512,512,"mobilenetv1/conv_11"),conv_12:a(512,1024,"mobilenetv1/conv_12"),conv_13:a(1024,1024,"mobilenetv1/conv_13")}},extractPredictionLayerParams:function(){return{conv_0:r(1024,256,1,"prediction_layer/conv_0"),conv_1:r(256,512,3,"prediction_layer/conv_1"),conv_2:r(512,128,1,"prediction_layer/conv_2"),conv_3:r(128,256,3,"prediction_layer/conv_3"),conv_4:r(256,128,1,"prediction_layer/conv_4"),conv_5:r(128,256,3,"prediction_layer/conv_5"),conv_6:r(256,64,1,"prediction_layer/conv_6"),conv_7:r(64,128,3,"prediction_layer/conv_7"),box_predictor_0:{box_encoding_predictor:n(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),class_predictor:n(512,9,1,"prediction_layer/box_predictor_0/class_predictor")},box_predictor_1:{box_encoding_predictor:n(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),class_predictor:n(1024,18,1,"prediction_layer/box_predictor_1/class_predictor")},box_predictor_2:{box_encoding_predictor:n(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),class_predictor:n(512,18,1,"prediction_layer/box_predictor_2/class_predictor")},box_predictor_3:{box_encoding_predictor:n(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),class_predictor:n(256,18,1,"prediction_layer/box_predictor_3/class_predictor")},box_predictor_4:{box_encoding_predictor:n(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),class_predictor:n(256,18,1,"prediction_layer/box_predictor_4/class_predictor")},box_predictor_5:{box_encoding_predictor:n(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),class_predictor:n(128,18,1,"prediction_layer/box_predictor_5/class_predictor")}}}}}function Cy(e){var t=[],n=function(e,t){var n=Bx(e,t);function r(e,t,r){return{filters:n(e+"/Conv2d_"+t+"_pointwise/weights",4,r+"/filters"),batch_norm_offset:n(e+"/Conv2d_"+t+"_pointwise/convolution_bn_offset",1,r+"/batch_norm_offset")}}function a(e){var t="mobilenetv1/conv_"+e,a="MobilenetV1/Conv2d_"+e+"_depthwise",i=t+"/depthwise_conv",o=t+"/pointwise_conv";return{depthwise_conv:{filters:n(a+"/depthwise_weights",4,i+"/filters"),batch_norm_scale:n(a+"/BatchNorm/gamma",1,i+"/batch_norm_scale"),batch_norm_offset:n(a+"/BatchNorm/beta",1,i+"/batch_norm_offset"),batch_norm_mean:n(a+"/BatchNorm/moving_mean",1,i+"/batch_norm_mean"),batch_norm_variance:n(a+"/BatchNorm/moving_variance",1,i+"/batch_norm_variance")},pointwise_conv:r("MobilenetV1",e,o)}}function i(e,t){return{filters:n(e+"/weights",4,t+"/filters"),bias:n(e+"/biases",1,t+"/bias")}}function o(e){return{box_encoding_predictor:i("Prediction/BoxPredictor_"+e+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+e+"/box_encoding_predictor"),class_predictor:i("Prediction/BoxPredictor_"+e+"/ClassPredictor","prediction_layer/box_predictor_"+e+"/class_predictor")}}return{extractMobilenetV1Params:function(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:a(1),conv_2:a(2),conv_3:a(3),conv_4:a(4),conv_5:a(5),conv_6:a(6),conv_7:a(7),conv_8:a(8),conv_9:a(9),conv_10:a(10),conv_11:a(11),conv_12:a(12),conv_13:a(13)}},extractPredictionLayerParams:function(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:o(0),box_predictor_1:o(1),box_predictor_2:o(2),box_predictor_3:o(3),box_predictor_4:o(4),box_predictor_5:o(5)}}}}(e,t),r=n.extractMobilenetV1Params,a=n.extractPredictionLayerParams,i=e["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!_b(i))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+i);var o={mobilenetv1:r(),prediction_layer:a(),output_layer:{extra_dim:i}};return Fx(e,t),{params:o,paramMappings:t}}function Ey(e,t,n){return Vs(function(){var r=Qp(e,t.filters,n,"same");return r=hp(r,t.batch_norm_offset),xf(r,0,6)})}function _y(e,t){return Vs(function(){var n=null,r=Ey(e,t.conv_0,[2,2]);if([t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13].forEach(function(e,t){var a=t+1,i=function(e){return[2,4,6,12].some(function(t){return t===e})?[2,2]:[1,1]}(a);r=function(e,t,n){return Vs(function(){var r=ng(e,t.filters,n,"same");return r=tp(r,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,.0010000000474974513),xf(r,0,6)})}(r,e.depthwise_conv,i),r=Ey(r,e.pointwise_conv,[1,1]),11===a&&(n=r)}),null===n)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:n}})}function Iy(e,t,n){var r=e.arraySync(),a=Math.min(r[t][0],r[t][2]),i=Math.min(r[t][1],r[t][3]),o=Math.max(r[t][0],r[t][2]),s=Math.max(r[t][1],r[t][3]),l=Math.min(r[n][0],r[n][2]),c=Math.min(r[n][1],r[n][3]),u=Math.max(r[n][0],r[n][2]),h=Math.max(r[n][1],r[n][3]),d=(o-a)*(s-i),f=(u-l)*(h-c);if(d<=0||f<=0)return 0;var p=Math.max(a,l),g=Math.max(i,c),m=Math.min(o,u),v=Math.min(s,h),b=Math.max(m-p,0)*Math.max(v-g,0);return b/(d+f-b)}function Ty(e,t){var n=function(e){var t=fc(qg(e,[1,0])),n=[Ap(t[2],t[0]),Ap(t[3],t[1])];return{sizes:n,centers:[hp(t[0],gp(n[0],dl(2))),hp(t[1],gp(n[1],dl(2)))]}}(e),r=n.sizes,a=n.centers,i=fc(qg(t,[1,0])),o=gp(Cp(Nf(gp(i[2],dl(5))),r[0]),dl(2)),s=hp(Cp(gp(i[0],dl(10)),r[0]),a[0]),l=gp(Cp(Nf(gp(i[3],dl(5))),r[1]),dl(2)),c=hp(Cp(gp(i[1],dl(10)),r[1]),a[1]);return qg(uc([Ap(s,o),Ap(c,l),hp(s,o),hp(c,l)]),[1,0])}function Ay(e,t){return Vs(function(){var n=e.shape[0];return{boxPredictionEncoding:sc(Dx(e,t.box_encoding_predictor),[n,-1,1,4]),classPrediction:sc(Dx(e,t.class_predictor),[n,-1,3])}})}var Ry=function(){function e(e){var t=void 0===e?{}:e,n=t.minConfidence,r=t.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=n||.5,this._maxResults=r||100,"number"!==typeof this._minConfidence||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if("number"!==typeof this._maxResults)throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(e.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),e}(),Dy=function(e){function t(){return e.call(this,"SsdMobilenetv1")||this}return yb(t,e),t.prototype.forwardInput=function(e){var t=this.params;if(!t)throw new Error("SsdMobilenetv1 - load model before inference");return Vs(function(){var n=e.toBatchTensor(512,!1).toFloat(),r=_y(Ap(Cp(n,dl(.007843137718737125)),dl(1)),t.mobilenetv1),a=function(e,t,n){return Vs(function(){var r=Ey(e,n.conv_0,[1,1]),a=Ey(r,n.conv_1,[2,2]),i=Ey(a,n.conv_2,[1,1]),o=Ey(i,n.conv_3,[2,2]),s=Ey(o,n.conv_4,[1,1]),l=Ey(s,n.conv_5,[2,2]),c=Ey(l,n.conv_6,[1,1]),u=Ey(c,n.conv_7,[2,2]),h=Ay(t,n.box_predictor_0),d=Ay(e,n.box_predictor_1),f=Ay(a,n.box_predictor_2),p=Ay(o,n.box_predictor_3),g=Ay(l,n.box_predictor_4),m=Ay(u,n.box_predictor_5);return{boxPredictions:Nl([h.boxPredictionEncoding,d.boxPredictionEncoding,f.boxPredictionEncoding,p.boxPredictionEncoding,g.boxPredictionEncoding,m.boxPredictionEncoding],1),classPredictions:Nl([h.classPrediction,d.classPrediction,f.classPrediction,p.classPrediction,g.classPrediction,m.classPrediction],1)}})}(r.out,r.conv11,t.prediction_layer);return function(e,t,n){return Vs(function(){var r=e.shape[0],a=Ty(sc(hc(n.extra_dim,[r,1,1]),[-1,4]),sc(e,[-1,4]));a=sc(a,[r,a.shape[0]/r,4]);var i=Ff(Ng(t,[0,0,1],[-1,-1,-1])),o=Ng(i,[0,0,0],[-1,-1,1]);return o=sc(o,[r,o.shape[1]]),{boxes:fc(a),scores:fc(o)}})}(a.boxPredictions,a.classPredictions,t.output_layer)})},t.prototype.forward=function(e){return kb(this,void 0,void 0,function(){var t;return Nb(this,function(n){switch(n.label){case 0:return t=this.forwardInput,[4,yx(e)];case 1:return[2,t.apply(this,[n.sent()])]}})})},t.prototype.locateFaces=function(e,t){return void 0===t&&(t={}),kb(this,void 0,void 0,function(){var n,r,a,i,o,s,l,c,u,h,d,f,p,g,m,v,b,x,y,w;return Nb(this,function(k){switch(k.label){case 0:return n=new Ry(t),r=n.maxResults,a=n.minConfidence,[4,yx(e)];case 1:for(i=k.sent(),o=this.forwardInput(i),s=o.boxes,l=o.scores,c=s[0],u=l[0],h=1;h<s.length;h++)s[h].dispose(),l[h].dispose();return p=(f=Array).from,[4,u.data()];case 2:return d=p.apply(f,[k.sent()]),g=function(e,t,n,r,a){var i=e.shape[0],o=Math.min(n,i),s=t.map(function(e,t){return{score:e,boxIndex:t}}).filter(function(e){return e.score>a}).sort(function(e,t){return t.score-e.score}),l=function(e){return e<=r?1:0},c=[];return s.forEach(function(t){if(!(c.length>=o)){for(var n=t.score,r=c.length-1;r>=0;--r){var i=Iy(e,t.boxIndex,c[r]);if(0!==i&&(t.score*=l(i),t.score<=a))break}n===t.score&&c.push(t.boxIndex)}}),c}(c,d,r,.5,a),m=i.getReshapedInputDimensions(0),v=i.inputSize,b=v/m.width,x=v/m.height,y=c.arraySync(),w=g.map(function(e){var t=[Math.max(0,y[e][0]),Math.min(1,y[e][2])].map(function(e){return e*x}),n=t[0],r=t[1],a=[Math.max(0,y[e][1]),Math.min(1,y[e][3])].map(function(e){return e*b}),o=a[0],s=a[1];return new Bb(d[e],new Gb(o,n,s-o,r-n),{height:i.getInputHeight(0),width:i.getInputWidth(0)})}),c.dispose(),u.dispose(),[2,w]}})})},t.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},t.prototype.extractParamsFromWeigthMap=function(e){return Cy(e)},t.prototype.extractParams=function(e){return function(e){var t=[],n=zx(e),r=n.extractWeights,a=n.getRemainingWeights,i=Sy(r,t),o=i.extractMobilenetV1Params,s=i.extractPredictionLayerParams,l=o(),c=s(),u={extra_dim:gl(r(20472),[1,5118,4])};if(t.push({paramPath:"output_layer/extra_dim"}),0!==a().length)throw new Error("weights remaing after extract: "+a().length);return{params:{mobilenetv1:l,prediction_layer:c,output_layer:u},paramMappings:t}}(e)},t}(Ix);!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}yb(t,e)}(Dy);var Fy,Oy=[new Lb(.738768,.874946),new Lb(2.42204,2.65704),new Lb(4.30971,7.04493),new Lb(10.246,4.59428),new Lb(12.6868,11.8741)],Ly=[new Lb(1.603231,2.094468),new Lb(6.041143,7.080126),new Lb(2.882459,3.518061),new Lb(4.266906,5.178857),new Lb(9.041765,10.66308)],Py=[117.001,114.697,97.404],My=function(e){return"number"===typeof e};function jy(e){return Vs(function(){var t=Cp(e,dl(.10000000149011612));return hp(Vg(Ap(e,t)),t)})}function By(e,t){return Vs(function(){var n=Ql(e,[[0,0],[1,1],[1,1],[0,0]]);return n=Qp(n,t.conv.filters,[1,1],"valid"),n=Ap(n,t.bn.sub),n=Cp(n,t.bn.truediv),jy(n=hp(n,t.conv.bias))})}function zy(e,t){return Vs(function(){var n=Ql(e,[[0,0],[1,1],[1,1],[0,0]]);return n=ig(n,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),jy(n=hp(n,t.bias))})}function Wy(e,t){var n=Ox(e,t);var r=Mx(e,t);return{extractConvParams:n,extractConvWithBatchNormParams:function(r,a,i){var o=n(r,a,3,i+"/conv"),s=function(n,r){var a=fl(e(n)),i=fl(e(n));return t.push({paramPath:r+"/sub"},{paramPath:r+"/truediv"}),{sub:a,truediv:i}}(a,i+"/bn");return{conv:o,bn:s}},extractSeparableConvParams:r}}function Uy(e,t){var n=Bx(e,t);function r(e){return{filters:n(e+"/filters",4),bias:n(e+"/bias",1)}}return{extractConvParams:r,extractConvWithBatchNormParams:function(e){var t=r(e+"/conv"),a=function(e){return{sub:n(e+"/sub",1),truediv:n(e+"/truediv",1)}}(e+"/bn");return{conv:t,bn:a}},extractSeparableConvParams:jx(n)}}!function(e){e[e.XS=224]="XS",e[e.SM=320]="SM",e[e.MD=416]="MD",e[e.LG=608]="LG"}(Fy||(Fy={}));var Vy=function(){function e(e){var t=void 0===e?{}:e,n=t.inputSize,r=t.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=n||416,this._scoreThreshold=r||.5,"number"!==typeof this._inputSize||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if("number"!==typeof this._scoreThreshold||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),e}(),Hy=function(e){function t(t){var n=e.call(this,"TinyYolov2")||this;return function(e){if(!e)throw new Error("invalid config: "+e);if("boolean"!==typeof e.withSeparableConvs)throw new Error("config.withSeparableConvs has to be a boolean, have: "+e.withSeparableConvs);if(!My(e.iouThreshold)||e.iouThreshold<0||e.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+e.iouThreshold);if(!Array.isArray(e.classes)||!e.classes.length||!e.classes.every(function(e){return"string"===typeof e}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(e.classes));if(!Array.isArray(e.anchors)||!e.anchors.length||!e.anchors.map(function(e){return e||{}}).every(function(e){return My(e.x)&&My(e.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(e.anchors));if(e.meanRgb&&(!Array.isArray(e.meanRgb)||3!==e.meanRgb.length||!e.meanRgb.every(My)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(e.meanRgb))}(t),n._config=t,n}return yb(t,e),Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),t.prototype.runTinyYolov2=function(e,t){var n=By(e,t.conv0);return n=By(n=bg(n,[2,2],[2,2],"same"),t.conv1),n=By(n=bg(n,[2,2],[2,2],"same"),t.conv2),n=By(n=bg(n,[2,2],[2,2],"same"),t.conv3),n=By(n=bg(n,[2,2],[2,2],"same"),t.conv4),n=By(n=bg(n,[2,2],[2,2],"same"),t.conv5),n=By(n=bg(n,[2,2],[1,1],"same"),t.conv6),Dx(n=By(n,t.conv7),t.conv8,"valid",!1)},t.prototype.runMobilenet=function(e,t){var n=this.config.isFirstLayerConv2d?jy(Dx(e,t.conv0,"valid",!1)):zy(e,t.conv0);return n=zy(n=bg(n,[2,2],[2,2],"same"),t.conv1),n=zy(n=bg(n,[2,2],[2,2],"same"),t.conv2),n=zy(n=bg(n,[2,2],[2,2],"same"),t.conv3),n=zy(n=bg(n,[2,2],[2,2],"same"),t.conv4),n=zy(n=bg(n,[2,2],[2,2],"same"),t.conv5),n=bg(n,[2,2],[1,1],"same"),n=t.conv6?zy(n,t.conv6):n,Dx(n=t.conv7?zy(n,t.conv7):n,t.conv8,"valid",!1)},t.prototype.forwardInput=function(e,t){var n=this,r=this.params;if(!r)throw new Error("TinyYolov2 - load model before inference");return Vs(function(){var a=e.toBatchTensor(t,!1).toFloat();return a=(a=n.config.meanRgb?Ub(a,n.config.meanRgb):a).div(dl(256)),n.config.withSeparableConvs?n.runMobilenet(a,r):n.runTinyYolov2(a,r)})},t.prototype.forward=function(e,t){return kb(this,void 0,void 0,function(){var n;return Nb(this,function(r){switch(r.label){case 0:return n=this.forwardInput,[4,yx(e)];case 1:return[4,n.apply(this,[r.sent(),t])];case 2:return[2,r.sent()]}})})},t.prototype.detect=function(e,t){return void 0===t&&(t={}),kb(this,void 0,void 0,function(){var n,r,a,i,o,s,l,c,u,h,d,f,p,g=this;return Nb(this,function(m){switch(m.label){case 0:return n=new Vy(t),r=n.inputSize,a=n.scoreThreshold,[4,yx(e)];case 1:return i=m.sent(),[4,this.forwardInput(i,r)];case 2:return o=m.sent(),s=Vs(function(){return fc(o)[0].expandDims()}),l={width:i.getInputWidth(0),height:i.getInputHeight(0)},[4,this.extractBoxes(s,i.getReshapedInputDimensions(0),a)];case 3:return c=m.sent(),o.dispose(),s.dispose(),u=c.map(function(e){return e.box}),h=c.map(function(e){return e.score}),d=c.map(function(e){return e.classScore}),f=c.map(function(e){return g.config.classes[e.label]}),p=Wb(u.map(function(e){return e.rescale(r)}),h,this.config.iouThreshold,!0),[2,p.map(function(e){return new jb(h[e],d[e],f[e],u[e],l)})]}})})},t.prototype.getDefaultModelName=function(){return""},t.prototype.extractParamsFromWeigthMap=function(e){return function(e,t){var n,r=[],a=Uy(e,r),i=a.extractConvParams,o=a.extractConvWithBatchNormParams,s=a.extractSeparableConvParams;if(t.withSeparableConvs){var l=t.filterSizes&&t.filterSizes.length||9;n={conv0:t.isFirstLayerConv2d?i("conv0"):s("conv0"),conv1:s("conv1"),conv2:s("conv2"),conv3:s("conv3"),conv4:s("conv4"),conv5:s("conv5"),conv6:l>7?s("conv6"):void 0,conv7:l>8?s("conv7"):void 0,conv8:i("conv8")}}else n={conv0:o("conv0"),conv1:o("conv1"),conv2:o("conv2"),conv3:o("conv3"),conv4:o("conv4"),conv5:o("conv5"),conv6:o("conv6"),conv7:o("conv7"),conv8:i("conv8")};return Fx(e,r),{params:n,paramMappings:r}}(e,this.config)},t.prototype.extractParams=function(e){var n=this.config.filterSizes||t.DEFAULT_FILTER_SIZES,r=n?n.length:void 0;if(7!==r&&8!==r&&9!==r)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+r+" filterSizes in config");return function(e,t,n,r){var a,i=zx(e),o=i.extractWeights,s=i.getRemainingWeights,l=[],c=Wy(o,l),u=c.extractConvParams,h=c.extractConvWithBatchNormParams,d=c.extractSeparableConvParams;if(t.withSeparableConvs){var f=r[0],p=r[1],g=r[2],m=r[3],v=r[4],b=r[5],x=r[6],y=r[7],w=r[8];a={conv0:t.isFirstLayerConv2d?u(f,p,3,"conv0"):d(f,p,"conv0"),conv1:d(p,g,"conv1"),conv2:d(g,m,"conv2"),conv3:d(m,v,"conv3"),conv4:d(v,b,"conv4"),conv5:d(b,x,"conv5"),conv6:y?d(x,y,"conv6"):void 0,conv7:w?d(y,w,"conv7"):void 0,conv8:u(w||y||x,5*n,1,"conv8")}}else f=r[0],p=r[1],g=r[2],m=r[3],v=r[4],b=r[5],x=r[6],y=r[7],w=r[8],a={conv0:h(f,p,"conv0"),conv1:h(p,g,"conv1"),conv2:h(g,m,"conv2"),conv3:h(m,v,"conv3"),conv4:h(v,b,"conv4"),conv5:h(b,x,"conv5"),conv6:h(x,y,"conv6"),conv7:h(y,w,"conv7"),conv8:u(w,5*n,1,"conv8")};if(0!==s().length)throw new Error("weights remaing after extract: "+s().length);return{params:a,paramMappings:l}}(e,this.config,this.boxEncodingSize,n)},t.prototype.extractBoxes=function(e,t,n){return kb(this,void 0,void 0,function(){var r,a,i,o,s,l,c,u,h,d,f,p,g,m,v,b,x,y,w,k,N,S,C,E,_,I,T,A,R,D=this;return Nb(this,function(F){switch(F.label){case 0:return r=t.width,a=t.height,i=Math.max(r,a),o=i/r,s=i/a,l=e.shape[1],c=this.config.anchors.length,u=Vs(function(){var t=e.reshape([l,l,c,D.boxEncodingSize]);return[t.slice([0,0,0,0],[l,l,c,4]),t.slice([0,0,0,4],[l,l,c,1]),D.withClassScores?Dc(t.slice([0,0,0,5],[l,l,c,D.config.classes.length]),3):dl(0)]}),h=u[0],d=u[1],f=u[2],p=[],[4,d.array()];case 1:return g=F.sent(),[4,h.array()];case 2:m=F.sent(),v=0,F.label=3;case 3:if(!(v<l))return[3,12];b=0,F.label=4;case 4:if(!(b<l))return[3,11];x=0,F.label=5;case 5:return x<c?(y=Vb(g[v][b][x][0]),!n||y>n?(w=(b+Vb(m[v][b][x][0]))/l*o,k=(v+Vb(m[v][b][x][1]))/l*s,N=Math.exp(m[v][b][x][2])*this.config.anchors[x].x/l*o,S=Math.exp(m[v][b][x][3])*this.config.anchors[x].y/l*s,C=w-N/2,E=k-S/2,_={row:v,col:b,anchor:x},this.withClassScores?[4,this.extractPredictedClass(f,_)]:[3,7]):[3,9]):[3,10];case 6:return R=F.sent(),[3,8];case 7:R={classScore:1,label:0},F.label=8;case 8:T=(I=R).classScore,A=I.label,p.push(wb({box:new Mb(C,E,C+N,E+S),score:y,classScore:y*T,label:A},_)),F.label=9;case 9:return x++,[3,5];case 10:return b++,[3,4];case 11:return v++,[3,3];case 12:return h.dispose(),d.dispose(),f.dispose(),[2,p]}})})},t.prototype.extractPredictedClass=function(e,t){return kb(this,void 0,void 0,function(){var n,r,a,i;return Nb(this,function(o){switch(o.label){case 0:return n=t.row,r=t.col,a=t.anchor,[4,e.array()];case 1:return i=o.sent(),[2,Array(this.config.classes.length).fill(0).map(function(e,t){return i[n][r][a][t]}).map(function(e,t){return{classScore:e,label:t}}).reduce(function(e,t){return e.classScore>t.classScore?e:t})]}})})},t.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],t}(Ix),Gy=function(e){function t(t){void 0===t&&(t=!0);var n=Object.assign({},{withSeparableConvs:t,iouThreshold:.4,classes:["face"]},t?{anchors:Ly,meanRgb:Py}:{anchors:Oy,withClassScores:!0});return e.call(this,n)||this}return yb(t,e),Object.defineProperty(t.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(e,t){return kb(this,void 0,void 0,function(){return Nb(this,function(n){switch(n.label){case 0:return[4,this.detect(e,t)];case 1:return[2,n.sent().map(function(e){return new Bb(e.score,e.relativeBox,{width:e.imageWidth,height:e.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return this.withSeparableConvs?"tiny_yolov2_separable_conv_model":"tiny_yolov2_model"},t.prototype.extractParamsFromWeigthMap=function(t){return e.prototype.extractParamsFromWeigthMap.call(this,t)},t}(Hy);var qy=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._name="TinyFaceDetectorOptions",t}return yb(t,e),t}(Vy),Ky=function(){function e(){}return e.prototype.then=function(e){return kb(this,void 0,void 0,function(){var t;return Nb(this,function(n){switch(n.label){case 0:return t=e,[4,this.run()];case 1:return[2,t.apply(void 0,[n.sent()])]}})})},e.prototype.run=function(){return kb(this,void 0,void 0,function(){return Nb(this,function(e){throw new Error("ComposableTask - run is not implemented")})})},e}();function Xy(e,t){var n={descriptor:t};return Object.assign({},e,n)}function Yy(e,t,n,r,a){return void 0===a&&(a=function(e){return e.alignedRect}),kb(this,void 0,void 0,function(){var i,o,s,l,c;return Nb(this,function(u){switch(u.label){case 0:return i=e.map(function(e){return Qx(e)?a(e):e.detection}),(s=r)?[3,5]:t instanceof wo?[4,kx(t,i)]:[3,2];case 1:return l=u.sent(),[3,4];case 2:return[4,wx(t,i)];case 3:l=u.sent(),u.label=4;case 4:s=l,u.label=5;case 5:return[4,n(o=s)];case 6:return c=u.sent(),o.forEach(function(e){return e instanceof wo&&e.dispose()}),[2,c]}})})}function $y(e,t,n,r,a){return kb(this,void 0,void 0,function(){var i=this;return Nb(this,function(o){return[2,Yy([e],t,function(e){return kb(i,void 0,void 0,function(){return Nb(this,function(t){return[2,n(e[0])]})})},r,a)]})})}function Jy(e){var t=zx(e),n=t.extractWeights,r=t.getRemainingWeights,a=[],i=function(e,t){var n=Ox(e,t),r=Lx(e,t);function a(n,r){var a=fl(e(n));return t.push({paramPath:r}),a}function i(e,t,r){return void 0===r&&(r=!1),{conv1:n(e[0],e[1],3,t+"/conv1"),prelu1_alpha:a(e[1],t+"/prelu1_alpha"),conv2:n(e[1],e[2],3,t+"/conv2"),prelu2_alpha:a(e[2],t+"/prelu2_alpha"),conv3:n(e[2],e[3],r?2:3,t+"/conv3"),prelu3_alpha:a(e[3],t+"/prelu3_alpha")}}return{extractPNetParams:function(){var e=i([3,10,16,32],"pnet"),t=n(32,2,1,"pnet/conv4_1"),r=n(32,4,1,"pnet/conv4_2");return wb(wb({},e),{conv4_1:t,conv4_2:r})},extractRNetParams:function(){var e=i([3,28,48,64],"rnet",!0),t=r(576,128,"rnet/fc1"),n=a(128,"rnet/prelu4_alpha"),o=r(128,2,"rnet/fc2_1"),s=r(128,4,"rnet/fc2_2");return wb(wb({},e),{fc1:t,prelu4_alpha:n,fc2_1:o,fc2_2:s})},extractONetParams:function(){var e=i([3,32,64,64],"onet"),t=n(64,128,2,"onet/conv4"),o=a(128,"onet/prelu4_alpha"),s=r(1152,256,"onet/fc1"),l=a(256,"onet/prelu5_alpha"),c=r(256,2,"onet/fc2_1"),u=r(256,4,"onet/fc2_2"),h=r(256,10,"onet/fc2_3");return wb(wb({},e),{conv4:t,prelu4_alpha:o,fc1:s,prelu5_alpha:l,fc2_1:c,fc2_2:u,fc2_3:h})}}}(n,a),o=i.extractPNetParams,s=i.extractRNetParams,l=i.extractONetParams,c=o(),u=s(),h=l();if(0!==r().length)throw new Error("weights remaing after extract: "+r().length);return{params:{pnet:c,rnet:u,onet:h},paramMappings:a}}function Qy(e){var t=[],n=function(e,t){var n=Bx(e,t);function r(e){return{filters:n(e+"/weights",4,e+"/filters"),bias:n(e+"/bias",1)}}function a(e){return{weights:n(e+"/weights",2),bias:n(e+"/bias",1)}}function i(e){return n(e,1)}function o(e){return{conv1:r(e+"/conv1"),prelu1_alpha:i(e+"/prelu1_alpha"),conv2:r(e+"/conv2"),prelu2_alpha:i(e+"/prelu2_alpha"),conv3:r(e+"/conv3"),prelu3_alpha:i(e+"/prelu3_alpha")}}return{extractPNetParams:function(){var e=o("pnet"),t=r("pnet/conv4_1"),n=r("pnet/conv4_2");return wb(wb({},e),{conv4_1:t,conv4_2:n})},extractRNetParams:function(){var e=o("rnet"),t=a("rnet/fc1"),n=i("rnet/prelu4_alpha"),r=a("rnet/fc2_1"),s=a("rnet/fc2_2");return wb(wb({},e),{fc1:t,prelu4_alpha:n,fc2_1:r,fc2_2:s})},extractONetParams:function(){var e=o("onet"),t=r("onet/conv4"),n=i("onet/prelu4_alpha"),s=a("onet/fc1"),l=i("onet/prelu5_alpha"),c=a("onet/fc2_1"),u=a("onet/fc2_2"),h=a("onet/fc2_3");return wb(wb({},e),{conv4:t,prelu4_alpha:n,fc1:s,prelu5_alpha:l,fc2_1:c,fc2_2:u,fc2_3:h})}}}(e,t),r=n.extractPNetParams,a=n.extractRNetParams,i=n.extractONetParams,o=r(),s=a(),l=i();return Fx(e,t),{params:{pnet:o,rnet:s,onet:l},paramMappings:t}}function Zy(e,t){var n=t[0],r=t[1];return{height:Math.floor(n*e),width:Math.floor(r*e)}}var ew=function(e){function t(t,n,r,a){return e.call(this,{left:t,top:n,right:r,bottom:a},!0)||this}return yb(t,e),t}(Pb);function tw(e){return Vs(function(){return Cp(Ap(e,dl(127.5)),dl(.0078125))})}function nw(e,t){return Vs(function(){return hp(Vg(e),Cp(t,Tf(Vg(Tf(e)))))})}function rw(e,t,n){return void 0===n&&(n=!1),Vs(function(){var r=Dx(e,t.conv1,"valid");return r=nw(r,t.prelu1_alpha),r=nw(r=Dx(r=bg(r,n?[2,2]:[3,3],[2,2],"same"),t.conv2,"valid"),t.prelu2_alpha),r=nw(r=Dx(r=n?r:bg(r,[3,3],[2,2],"valid"),t.conv3,"valid"),t.prelu3_alpha)})}function aw(e,t,n,r,a){a.stage1=[];var i=t.map(function(t){return Vs(function(){var n={scale:t},a=function(e,t){return Vs(function(){var n=Zy(t,e.shape.slice(1)),r=n.height,a=n.width,i=tw(jm.resizeBilinear(e,[r,a]));return qg(i,[0,2,1,3])})}(e,t),i=Date.now(),o=function(e,t){return Vs(function(){var n=rw(e,t,!0),r=Dx(n,t.conv4_1,"valid"),a=Xl(Og(r,3),3);return{prob:Dc(Ap(r,a),3),regions:Dx(n,t.conv4_2,"valid")}})}(a,r),s=o.prob,l=o.regions;return n.pnet=Date.now()-i,{scoresTensor:fc(fc(s,3)[1])[0],regionsTensor:fc(l)[0],scale:t,statsForScale:n}})}),o=i.map(function(e){var t=e.scoresTensor,r=e.regionsTensor,i=e.scale,o=e.statsForScale,s=function(e,t,n,r){for(var a=[],i=e.arraySync(),o=0;o<e.shape[0];o++)for(var s=0;s<e.shape[1];s++)i[o][s]>=r&&a.push(new Lb(s,o));return a.map(function(e){var r=new Mb(Math.round((2*e.y+1)/n),Math.round((2*e.x+1)/n),Math.round((2*e.y+12)/n),Math.round((2*e.x+12)/n)),a=i[e.y][e.x],o=t.arraySync();return{cell:r,score:a,region:new ew(o[e.y][e.x][0],o[e.y][e.x][1],o[e.y][e.x][2],o[e.y][e.x][3])}})}(t,r,i,n);if(t.dispose(),r.dispose(),!s.length)return a.stage1.push(o),[];var l=Date.now(),c=Wb(s.map(function(e){return e.cell}),s.map(function(e){return e.score}),.5);return o.nms=Date.now()-l,o.numBoxes=c.length,a.stage1.push(o),c.map(function(e){return s[e]})}),s=o.reduce(function(e,t){return e.concat(t)},[]),l=[],c=[];if(s.length>0){var u=Date.now(),h=Wb(s.map(function(e){return e.cell}),s.map(function(e){return e.score}),.7);a.stage1_nms=Date.now()-u,c=h.map(function(e){return s[e].score}),l=h.map(function(e){return s[e]}).map(function(e){var t=e.cell,n=e.region;return new Mb(t.left+n.left*t.width,t.top+n.top*t.height,t.right+n.right*t.width,t.bottom+n.bottom*t.height).toSquare().round()})}return{boxes:l,scores:c}}function iw(e,t,n){var r=n.width,a=n.height;return kb(this,void 0,void 0,function(){var n,i,o,s=this;return Nb(this,function(l){switch(l.label){case 0:return n=cx(e),[4,Promise.all(t.map(function(t){return kb(s,void 0,void 0,function(){var r,a,i,o,s,l,c,u;return Nb(this,function(h){return r=t.padAtBorders(e.height,e.width),a=r.y,i=r.ey,o=r.x,s=r.ex,l=o-1,c=a-1,u=n.getImageData(l,c,s-l,i-c),[2,sx.isNodejs()?mx(u):createImageBitmap(u)]})})}))];case 1:return i=l.sent(),o=[],i.forEach(function(e){var t=cx(gx({width:r,height:a}));t.drawImage(e,0,0,r,a);for(var n=t.getImageData(0,0,r,a).data,i=[],s=0;s<n.length;s+=4)i.push(n[s+2]),i.push(n[s+1]),i.push(n[s]);o.push(i)}),[2,o.map(function(e){return Vs(function(){return tw(qg(ml(e,[1,r,a,3]),[0,2,1,3]).toFloat())})})]}})})}function ow(e,t,n,r,a){return kb(this,void 0,void 0,function(){var i,o,s,l,c,u,h,d,f,p,g,m,v,b;return Nb(this,function(x){switch(x.label){case 0:return i=Date.now(),[4,iw(e,t,{width:24,height:24})];case 1:return o=x.sent(),a.stage2_extractImagePatches=Date.now()-i,i=Date.now(),s=o.map(function(e){var t=function(e,t){return Vs(function(){var n=rw(e,t),r=nw(Gx(sc(n,[n.shape[0],t.fc1.weights.shape[0]]),t.fc1),t.prelu4_alpha),a=Gx(r,t.fc2_1),i=Xl(Og(a,1),1),o=Dc(Ap(a,i),1),s=Gx(r,t.fc2_2);return{scores:fc(o,1)[1],regions:s}})}(e,r);return e.dispose(),t}),a.stage2_rnet=Date.now()-i,l=s.length>1?Nl(s.map(function(e){return e.scores})):s[0].scores,h=(u=Array).from,[4,l.data()];case 2:return c=h.apply(u,[x.sent()]),l.dispose(),d=c.map(function(e,t){return{score:e,idx:t}}).filter(function(e){return e.score>n}).map(function(e){return e.idx}),f=d.map(function(e){return t[e]}),p=d.map(function(e){return c[e]}),g=[],m=[],f.length>0&&(i=Date.now(),v=Wb(f,p,.7),a.stage2_nms=Date.now()-i,b=v.map(function(e){var t=s[d[e]].regions.arraySync();return new ew(t[0][0],t[0][1],t[0][2],t[0][3])}),m=v.map(function(e){return p[e]}),g=v.map(function(e,t){return f[e].calibrate(b[t])})),s.forEach(function(e){e.regions.dispose(),e.scores.dispose()}),[2,{boxes:g,scores:m}]}})})}function sw(e,t,n,r,a){return kb(this,void 0,void 0,function(){var i,o,s,l,c,u,h,d,f,p,g,m,v,b,x;return Nb(this,function(y){switch(y.label){case 0:return i=Date.now(),[4,iw(e,t,{width:48,height:48})];case 1:return o=y.sent(),a.stage3_extractImagePatches=Date.now()-i,i=Date.now(),s=o.map(function(e){var t=function(e,t){return Vs(function(){var n=rw(e,t);n=nw(n=Dx(n=bg(n,[2,2],[2,2],"same"),t.conv4,"valid"),t.prelu4_alpha);var r=nw(Gx(sc(n,[n.shape[0],t.fc1.weights.shape[0]]),t.fc1),t.prelu5_alpha),a=Gx(r,t.fc2_1),i=Xl(Og(a,1),1),o=Dc(Ap(a,i),1),s=Gx(r,t.fc2_2),l=Gx(r,t.fc2_3);return{scores:fc(o,1)[1],regions:s,points:l}})}(e,r);return e.dispose(),t}),a.stage3_onet=Date.now()-i,l=s.length>1?Nl(s.map(function(e){return e.scores})):s[0].scores,h=(u=Array).from,[4,l.data()];case 2:return c=h.apply(u,[y.sent()]),l.dispose(),d=c.map(function(e,t){return{score:e,idx:t}}).filter(function(e){return e.score>n}).map(function(e){return e.idx}),f=d.map(function(e){var t=s[e].regions.arraySync();return new ew(t[0][0],t[0][1],t[0][2],t[0][3])}),p=d.map(function(e,n){return t[e].calibrate(f[n])}),g=d.map(function(e){return c[e]}),m=[],v=[],b=[],p.length>0&&(i=Date.now(),x=Wb(p,g,.7,!1),a.stage3_nms=Date.now()-i,m=x.map(function(e){return p[e]}),v=x.map(function(e){return g[e]}),b=x.map(function(e,t){return Array(5).fill(0).map(function(n,r){var a=s[e].points.arraySync();return new Lb(a[0][r]*(m[t].width+1)+m[t].left,a[0][r+5]*(m[t].height+1)+m[t].top)})})),s.forEach(function(e){e.regions.dispose(),e.scores.dispose(),e.points.dispose()}),[2,{boxes:m,scores:v,points:b}]}})})}var lw=function(e){function t(){return e.call(this,"Mtcnn")||this}return yb(t,e),t.prototype.load=function(t){return kb(this,void 0,void 0,function(){return Nb(this,function(n){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.load.call(this,t)]})})},t.prototype.loadFromDisk=function(t){return kb(this,void 0,void 0,function(){return Nb(this,function(n){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.loadFromDisk.call(this,t)]})})},t.prototype.forwardInput=function(e,t){return void 0===t&&(t={}),kb(this,void 0,void 0,function(){var n,r,a,i,o,s,l,c,u,h,d,f,p,g,m,v,b,x,y,w,k;return Nb(this,function(N){switch(N.label){case 0:if(!(n=this.params))throw new Error("Mtcnn - load model before inference");if(!(r=e.canvases[0]))throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return a={},i=Date.now(),o=Vs(function(){return function(e){return Vs(function(){return uc(fc(e,3).reverse(),3)})}(Xl(rb.fromPixels(r)).toFloat())}),s=function(e){return o.dispose(),a.total=Date.now()-i,e},l=o.shape.slice(1),c=l[0],u=l[1],h=new Ny(t),d=h.minFaceSize,f=h.scaleFactor,p=h.maxNumScales,g=h.scoreThresholds,m=h.scaleSteps,v=(m||function(e,t,n){for(var r=n[0],a=n[1],i=12/e,o=[],s=Math.min(r,a)*i,l=0;s>=12;)o.push(i*Math.pow(t,l)),s*=t,l+=1;return o}(d,f,[c,u])).filter(function(e){var t=Zy(e,[c,u]);return Math.min(t.width,t.height)>12}).slice(0,p),a.scales=v,a.pyramid=v.map(function(e){return Zy(e,[c,u])}),b=Date.now(),[4,aw(o,v,g[0],n.pnet,a)];case 1:return x=N.sent(),a.total_stage1=Date.now()-b,x.boxes.length?(a.stage2_numInputBoxes=x.boxes.length,b=Date.now(),[4,ow(r,x.boxes,g[1],n.rnet,a)]):[2,s({results:[],stats:a})];case 2:return y=N.sent(),a.total_stage2=Date.now()-b,y.boxes.length?(a.stage3_numInputBoxes=y.boxes.length,b=Date.now(),[4,sw(r,y.boxes,g[2],n.onet,a)]):[2,s({results:[],stats:a})];case 3:return w=N.sent(),a.total_stage3=Date.now()-b,k=w.boxes.map(function(e,t){return Zx(Qb({},new Bb(w.scores[t],new Gb(e.left/u,e.top/c,e.width/u,e.height/c),{height:c,width:u})),new Kb(w.points[t].map(function(t){return t.sub(new Lb(e.left,e.top)).div(new Lb(e.width,e.height))}),{width:e.width,height:e.height}))}),[2,s({results:k,stats:a})]}})})},t.prototype.forward=function(e,t){return void 0===t&&(t={}),kb(this,void 0,void 0,function(){var n;return Nb(this,function(r){switch(r.label){case 0:return n=this.forwardInput,[4,yx(e)];case 1:return[4,n.apply(this,[r.sent(),t])];case 2:return[2,r.sent().results]}})})},t.prototype.forwardWithStats=function(e,t){return void 0===t&&(t={}),kb(this,void 0,void 0,function(){var n;return Nb(this,function(r){switch(r.label){case 0:return n=this.forwardInput,[4,yx(e)];case 1:return[2,n.apply(this,[r.sent(),t])]}})})},t.prototype.getDefaultModelName=function(){return"mtcnn_model"},t.prototype.extractParamsFromWeigthMap=function(e){return Qy(e)},t.prototype.extractParams=function(e){return Jy(e)},t}(Ix),cw=[new Lb(1.603231,2.094468),new Lb(6.041143,7.080126),new Lb(2.882459,3.518061),new Lb(4.266906,5.178857),new Lb(9.041765,10.66308)],uw=[117.001,114.697,97.404],hw=function(e){function t(){var t={withSeparableConvs:!0,iouThreshold:.4,classes:["face"],anchors:cw,meanRgb:uw,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return e.call(this,t)||this}return yb(t,e),Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(e,t){return kb(this,void 0,void 0,function(){return Nb(this,function(n){switch(n.label){case 0:return[4,this.detect(e,t)];case 1:return[2,n.sent().map(function(e){return new Bb(e.score,e.relativeBox,{width:e.imageWidth,height:e.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},t.prototype.extractParamsFromWeigthMap=function(t){return e.prototype.extractParamsFromWeigthMap.call(this,t)},t}(Hy),dw={ssdMobilenetv1:new Dy,tinyFaceDetector:new hw,tinyYolov2:new Gy,mtcnn:new lw,faceLandmark68Net:new uy,faceLandmark68TinyNet:new dy,faceRecognitionNet:new wy,faceExpressionNet:new $x,ageGenderNet:new ly};function fw(e,t){var n={age:t};return Object.assign({},e,n)}var pw=function(e){function t(t,n,r){var a=e.call(this)||this;return a.parentTask=t,a.input=n,a.extractedFaces=r,a}return yb(t,e),t}(Ky),gw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return yb(t,e),t.prototype.run=function(){return kb(this,void 0,void 0,function(){var e,t,n=this;return Nb(this,function(r){switch(r.label){case 0:return[4,this.parentTask];case 1:return[4,Yy(e=r.sent(),this.input,function(e){return kb(n,void 0,void 0,function(){return Nb(this,function(t){switch(t.label){case 0:return[4,Promise.all(e.map(function(e){return dw.faceExpressionNet.predictExpressions(e)}))];case 1:return[2,t.sent()]}})})},this.extractedFaces)];case 2:return t=r.sent(),[2,e.map(function(e,n){return Jx(e,t[n])})]}})})},t.prototype.withAgeAndGender=function(){return new yw(this,this.input)},t}(pw),mw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return yb(t,e),t.prototype.run=function(){return kb(this,void 0,void 0,function(){var e,t;return Nb(this,function(n){switch(n.label){case 0:return[4,this.parentTask];case 1:return(e=n.sent())?[4,$y(e,this.input,function(e){return dw.faceExpressionNet.predictExpressions(e)},this.extractedFaces)]:[2];case 2:return t=n.sent(),[2,Jx(e,t)]}})})},t.prototype.withAgeAndGender=function(){return new ww(this,this.input)},t}(pw),vw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return yb(t,e),t.prototype.withAgeAndGender=function(){return new kw(this,this.input)},t.prototype.withFaceDescriptors=function(){return new Cw(this,this.input)},t}(gw),bw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return yb(t,e),t.prototype.withAgeAndGender=function(){return new Nw(this,this.input)},t.prototype.withFaceDescriptor=function(){return new Ew(this,this.input)},t}(mw),xw=function(e){function t(t,n,r){var a=e.call(this)||this;return a.parentTask=t,a.input=n,a.extractedFaces=r,a}return yb(t,e),t}(Ky),yw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return yb(t,e),t.prototype.run=function(){return kb(this,void 0,void 0,function(){var e,t,n=this;return Nb(this,function(r){switch(r.label){case 0:return[4,this.parentTask];case 1:return[4,Yy(e=r.sent(),this.input,function(e){return kb(n,void 0,void 0,function(){return Nb(this,function(t){switch(t.label){case 0:return[4,Promise.all(e.map(function(e){return dw.ageGenderNet.predictAgeAndGender(e)}))];case 1:return[2,t.sent()]}})})},this.extractedFaces)];case 2:return t=r.sent(),[2,e.map(function(e,n){var r=t[n],a=r.age;return fw(ky(e,r.gender,r.genderProbability),a)})]}})})},t.prototype.withFaceExpressions=function(){return new gw(this,this.input)},t}(xw),ww=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return yb(t,e),t.prototype.run=function(){return kb(this,void 0,void 0,function(){var e,t,n,r,a;return Nb(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return(e=i.sent())?[4,$y(e,this.input,function(e){return dw.ageGenderNet.predictAgeAndGender(e)},this.extractedFaces)]:[2];case 2:return t=i.sent(),n=t.age,r=t.gender,a=t.genderProbability,[2,fw(ky(e,r,a),n)]}})})},t.prototype.withFaceExpressions=function(){return new mw(this,this.input)},t}(xw),kw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return yb(t,e),t.prototype.withFaceExpressions=function(){return new vw(this,this.input)},t.prototype.withFaceDescriptors=function(){return new Cw(this,this.input)},t}(yw),Nw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return yb(t,e),t.prototype.withFaceExpressions=function(){return new bw(this,this.input)},t.prototype.withFaceDescriptor=function(){return new Ew(this,this.input)},t}(ww),Sw=function(e){function t(t,n){var r=e.call(this)||this;return r.parentTask=t,r.input=n,r}return yb(t,e),t}(Ky),Cw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return yb(t,e),t.prototype.run=function(){return kb(this,void 0,void 0,function(){var e;return Nb(this,function(t){switch(t.label){case 0:return[4,this.parentTask];case 1:return[4,Yy(e=t.sent(),this.input,function(e){return Promise.all(e.map(function(e){return dw.faceRecognitionNet.computeFaceDescriptor(e)}))},null,function(e){return e.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return[2,t.sent().map(function(t,n){return Xy(e[n],t)})]}})})},t.prototype.withFaceExpressions=function(){return new vw(this,this.input)},t.prototype.withAgeAndGender=function(){return new kw(this,this.input)},t}(Sw),Ew=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return yb(t,e),t.prototype.run=function(){return kb(this,void 0,void 0,function(){var e,t;return Nb(this,function(n){switch(n.label){case 0:return[4,this.parentTask];case 1:return(e=n.sent())?[4,$y(e,this.input,function(e){return dw.faceRecognitionNet.computeFaceDescriptor(e)},null,function(e){return e.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return t=n.sent(),[2,Xy(e,t)]}})})},t.prototype.withFaceExpressions=function(){return new bw(this,this.input)},t.prototype.withAgeAndGender=function(){return new Nw(this,this.input)},t}(Sw),_w=function(e){function t(t,n,r){var a=e.call(this)||this;return a.parentTask=t,a.input=n,a.useTinyLandmarkNet=r,a}return yb(t,e),Object.defineProperty(t.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?dw.faceLandmark68TinyNet:dw.faceLandmark68Net},enumerable:!0,configurable:!0}),t}(Ky),Iw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return yb(t,e),t.prototype.run=function(){return kb(this,void 0,void 0,function(){var e,t,n,r,a,i=this;return Nb(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return e=o.sent(),t=e.map(function(e){return e.detection}),this.input instanceof wo?[4,kx(this.input,t)]:[3,3];case 2:return r=o.sent(),[3,5];case 3:return[4,wx(this.input,t)];case 4:r=o.sent(),o.label=5;case 5:return n=r,[4,Promise.all(n.map(function(e){return i.landmarkNet.detectLandmarks(e)}))];case 6:return a=o.sent(),n.forEach(function(e){return e instanceof wo&&e.dispose()}),[2,e.map(function(e,t){return Zx(e,a[t])})]}})})},t.prototype.withFaceExpressions=function(){return new vw(this,this.input)},t.prototype.withAgeAndGender=function(){return new kw(this,this.input)},t.prototype.withFaceDescriptors=function(){return new Cw(this,this.input)},t}(_w),Tw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return yb(t,e),t.prototype.run=function(){return kb(this,void 0,void 0,function(){var e,t,n,r,a;return Nb(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return(e=i.sent())?(t=e.detection,this.input instanceof wo?[4,kx(this.input,[t])]:[3,3]):[2];case 2:return r=i.sent(),[3,5];case 3:return[4,wx(this.input,[t])];case 4:r=i.sent(),i.label=5;case 5:return n=r,[4,this.landmarkNet.detectLandmarks(n[0])];case 6:return a=i.sent(),n.forEach(function(e){return e instanceof wo&&e.dispose()}),[2,Zx(e,a)]}})})},t.prototype.withFaceExpressions=function(){return new bw(this,this.input)},t.prototype.withAgeAndGender=function(){return new Nw(this,this.input)},t.prototype.withFaceDescriptor=function(){return new Ew(this,this.input)},t}(_w),Aw=function(e){function t(t,n){void 0===n&&(n=new Ry);var r=e.call(this)||this;return r.input=t,r.options=n,r}return yb(t,e),t}(Ky),Rw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return yb(t,e),t.prototype.run=function(){return kb(this,void 0,void 0,function(){var e,t,n,r;return Nb(this,function(a){switch(a.label){case 0:return t=(e=this).input,(n=e.options)instanceof Ny?[4,dw.mtcnn.forward(t,n)]:[3,2];case 1:return[2,a.sent().map(function(e){return e.detection})];case 2:if(r=n instanceof qy?function(e){return dw.tinyFaceDetector.locateFaces(e,n)}:n instanceof Ry?function(e){return dw.ssdMobilenetv1.locateFaces(e,n)}:n instanceof Vy?function(e){return dw.tinyYolov2.locateFaces(e,n)}:null,!r)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,r(t)]}})})},t.prototype.runAndExtendWithFaceDetections=function(){var e=this;return new Promise(function(t){return kb(e,void 0,void 0,function(){var e;return Nb(this,function(n){switch(n.label){case 0:return[4,this.run()];case 1:return e=n.sent(),[2,t(e.map(function(e){return Qb({},e)}))]}})})})},t.prototype.withFaceLandmarks=function(e){return void 0===e&&(e=!1),new Iw(this.runAndExtendWithFaceDetections(),this.input,e)},t.prototype.withFaceExpressions=function(){return new gw(this.runAndExtendWithFaceDetections(),this.input)},t.prototype.withAgeAndGender=function(){return new yw(this.runAndExtendWithFaceDetections(),this.input)},t}(Aw),Dw=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return yb(t,e),t.prototype.run=function(){return kb(this,void 0,void 0,function(){var e,t;return Nb(this,function(n){switch(n.label){case 0:return[4,new Rw(this.input,this.options)];case 1:return e=n.sent(),t=e[0],e.forEach(function(e){e.score>t.score&&(t=e)}),[2,t]}})})},t.prototype.runAndExtendWithFaceDetection=function(){var e=this;return new Promise(function(t){return kb(e,void 0,void 0,function(){var e;return Nb(this,function(n){switch(n.label){case 0:return[4,this.run()];case 1:return e=n.sent(),[2,t(e?Qb({},e):void 0)]}})})})},t.prototype.withFaceLandmarks=function(e){return void 0===e&&(e=!1),new Tw(this.runAndExtendWithFaceDetection(),this.input,e)},t.prototype.withFaceExpressions=function(){return new mw(this.runAndExtendWithFaceDetection(),this.input)},t.prototype.withAgeAndGender=function(){return new ww(this.runAndExtendWithFaceDetection(),this.input)},t}(Aw);function Fw(e,t){return void 0===t&&(t=new Ry),new Dw(e,t)}!function(){function e(e,t){void 0===t&&(t=.6),this._distanceThreshold=t;var n=Array.isArray(e)?e:[e];if(!n.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var r=1,a=function(){return"person "+r++};this._labeledDescriptors=n.map(function(e){if(e instanceof Jb)return e;if(e instanceof Float32Array)return new Jb(a(),[e]);if(e.descriptor&&e.descriptor instanceof Float32Array)return new Jb(a(),[e.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}Object.defineProperty(e.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),e.prototype.computeMeanDistance=function(e,t){return t.map(function(t){return function(e,t){if(e.length!==t.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var n=Array.from(e),r=Array.from(t);return Math.sqrt(n.map(function(e,t){return e-r[t]}).reduce(function(e,t){return e+Math.pow(t,2)},0))}(t,e)}).reduce(function(e,t){return e+t},0)/(t.length||1)},e.prototype.matchDescriptor=function(e){var t=this;return this.labeledDescriptors.map(function(n){var r=n.descriptors,a=n.label;return new Yb(a,t.computeMeanDistance(e,r))}).reduce(function(e,t){return e.distance<t.distance?e:t})},e.prototype.findBestMatch=function(e){var t=this.matchDescriptor(e);return t.distance<this.distanceThreshold?t:new Yb("unknown",t.distance)},e.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(e){return e.toJSON()})}},e.fromJSON=function(t){var n=t.labeledDescriptors.map(function(e){return Jb.fromJSON(e)});return new e(n,t.distanceThreshold)}}();const Ow=e=>{let{onAddSuccess:t,onCancel:n}=e;const[r,a]=(0,l.useState)({name:"",email:"",password:"",rfid:""}),[i,o]=(0,l.useState)([]),[s,c]=(0,l.useState)(""),[u,h]=(0,l.useState)(!1),[d,f]=(0,l.useState)(!1),[p,g]=(0,l.useState)(null),m=(0,l.useRef)(null),[v,b]=(0,l.useState)(!1),[x,y]=(0,l.useState)(""),w=()=>{const e="ABCDEFGHIJKLMNOPQRSTUVWXYZ";return e.charAt(Math.floor(26*Math.random()))+e.charAt(Math.floor(26*Math.random()))+Math.floor(1e3+9e3*Math.random()).toString()};(0,l.useEffect)(()=>{k(),a(e=>fn(fn({},e),{},{rfid:w()}))},[]);const k=async()=>{const e="/models";try{await dw.ssdMobilenetv1.loadFromUri(e),await dw.faceLandmark68Net.loadFromUri(e),await dw.faceRecognitionNet.loadFromUri(e),b(!0)}catch(t){console.error("Error loading models:",t),c("Failed to load face recognition models."),h(!0)}},N=e=>{a(fn(fn({},r),{},{[e.target.name]:e.target.value}))};return(0,Ba.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),f(!0),i.length>0&&i.length<3)return c("For high accuracy, please capture at least 3 face photos or remove all to skip face registration."),h(!0),void f(!1);try{const e={name:r.name,email:r.email,password:r.password,rfid:r.rfid,faceEncodings:JSON.stringify(i),profilePhoto:p};await ja.post("/fighters/register",e),c("Fighter added successfully with high accuracy face recognition!"),h(!1),a({name:"",email:"",password:"",rfid:w()}),o([]),g(null),t&&t()}catch(u){var n,s,l;console.error("Registration error:",(null===(n=u.response)||void 0===n?void 0:n.data)||u.message),c((null===(s=u.response)||void 0===s||null===(l=s.data)||void 0===l?void 0:l.msg)||"Error adding fighter. Please try again."),h(!0)}finally{f(!1)}},className:"space-y-8",children:[s&&(0,Ba.jsxs)("div",{className:"p-4 rounded-xl flex items-center ".concat(u?"bg-red-50 border border-red-200 text-red-800":"bg-green-50 border border-green-200 text-green-800"),children:[u?(0,Ba.jsx)(Et,{className:"mr-3 text-red-500"}):(0,Ba.jsx)(gt,{className:"mr-3 text-green-500"}),(0,Ba.jsx)("span",{className:"font-medium",children:s})]}),(0,Ba.jsxs)("div",{className:"bg-gray-50 rounded-xl p-6 border border-gray-200",children:[(0,Ba.jsxs)("div",{className:"flex items-center mb-6",children:[(0,Ba.jsx)("div",{className:"bg-red-100 p-2 rounded-lg mr-3",children:(0,Ba.jsx)(cn,{className:"text-red-600"})}),(0,Ba.jsx)("h3",{className:"text-xl font-bold text-gray-800",children:"Personal Information"})]}),(0,Ba.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Ba.jsxs)("div",{children:[(0,Ba.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",htmlFor:"name",children:["Full Name ",(0,Ba.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,Ba.jsxs)("div",{className:"relative",children:[(0,Ba.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,Ba.jsx)(cn,{className:"text-gray-400"})}),(0,Ba.jsx)("input",{type:"text",id:"name",name:"name",value:r.name,onChange:N,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent transition",required:!0,placeholder:"Enter full name"})]})]}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",htmlFor:"email",children:["Email Address ",(0,Ba.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,Ba.jsxs)("div",{className:"relative",children:[(0,Ba.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,Ba.jsx)(Ct,{className:"text-gray-400"})}),(0,Ba.jsx)("input",{type:"email",id:"email",name:"email",value:r.email,onChange:N,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent transition",required:!0,placeholder:"Enter email address"})]})]}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",htmlFor:"password",children:["Password ",(0,Ba.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,Ba.jsxs)("div",{className:"relative",children:[(0,Ba.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,Ba.jsx)(jt,{className:"text-gray-400"})}),(0,Ba.jsx)("input",{type:"password",id:"password",name:"password",value:r.password,onChange:N,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent transition",required:!0,placeholder:"Create a strong password"})]})]}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",htmlFor:"profilePhoto",children:"Profile Photo"}),(0,Ba.jsxs)("div",{className:"relative",children:[(0,Ba.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,Ba.jsx)(en,{className:"text-gray-400"})}),(0,Ba.jsx)("input",{type:"file",id:"profilePhoto",name:"profilePhoto",accept:".jpg,.jpeg,.png",onChange:e=>{const t=e.target.files[0];if(t){if(!t.type.match("image/jpeg")&&!t.type.match("image/png"))return c("Please upload a JPG, JPEG, or PNG image."),void h(!0);const e=new FileReader;e.onload=e=>{g(e.target.result),c(""),h(!1)},e.readAsDataURL(t)}},className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent transition file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-red-50 file:text-red-700 hover:file:bg-red-100"})]}),p&&(0,Ba.jsx)("div",{className:"mt-2",children:(0,Ba.jsx)("img",{src:p,alt:"Profile Preview",className:"w-16 h-16 rounded-full object-cover"})})]}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",htmlFor:"rfid",children:["RFID ",(0,Ba.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,Ba.jsxs)("div",{className:"relative",children:[(0,Ba.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,Ba.jsx)(Lt,{className:"text-gray-400"})}),(0,Ba.jsx)("input",{type:"text",id:"rfid",name:"rfid",value:r.rfid,readOnly:!0,className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg bg-gray-100 text-gray-600 cursor-not-allowed",placeholder:"RFID will be generated"}),(0,Ba.jsx)("button",{type:"button",onClick:()=>a(e=>fn(fn({},e),{},{rfid:w()})),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700",title:"Regenerate RFID",children:(0,Ba.jsx)($t,{})})]})]})]})]}),(0,Ba.jsxs)("div",{className:"bg-gray-50 rounded-xl p-6 border border-gray-200",children:[(0,Ba.jsxs)("div",{className:"flex items-center mb-6",children:[(0,Ba.jsx)("div",{className:"bg-blue-100 p-2 rounded-lg mr-3",children:(0,Ba.jsx)(nn,{className:"text-blue-600"})}),(0,Ba.jsx)("h3",{className:"text-xl font-bold text-gray-800",children:"Face Recognition Setup"}),(0,Ba.jsx)("span",{className:"ml-3 inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800",children:"Optional"})]}),(0,Ba.jsx)("p",{className:"text-gray-600 mb-6",children:"Capture 5 clear images of the fighter's face from different angles for better attendance recognition. This will enable face recognition for attendance tracking."}),(0,Ba.jsxs)("div",{className:"flex flex-col lg:flex-row items-center gap-8 mb-6",children:[(0,Ba.jsxs)("div",{className:"w-full lg:w-72",children:[(0,Ba.jsx)("div",{className:"rounded-xl overflow-hidden border-2 border-gray-300 shadow-md",children:(0,Ba.jsx)(si(),{audio:!1,ref:m,screenshotFormat:"image/jpeg",width:288,height:216,className:"w-full"})}),(0,Ba.jsx)("div",{className:"mt-3 text-center",children:(0,Ba.jsx)("p",{className:"text-sm text-gray-500",children:"Position face in the center of the frame"})})]}),(0,Ba.jsxs)("div",{className:"flex-grow w-full",children:[(0,Ba.jsxs)("button",{type:"button",onClick:async()=>{if(i.length>=4)y("Maximum of 4 photos reached for high accuracy.");else{if(y("Detecting face with high accuracy..."),f(!0),m.current&&v){const e=m.current.getScreenshot();if(e){const t=await Sx(e),n=await Fw(t,new Ry({minConfidence:.9})).withFaceLandmarks().withFaceDescriptor();if(n){const e={encoding:Array.from(n.descriptor),angle:"capture_".concat(i.length+1),timestamp:(new Date).toISOString()};o(t=>[...t,e]),y("Capture ".concat(i.length+1," successful!")),i.length+1>=4&&y("Maximum captures reached. Face registration complete for high accuracy.")}else y("No face detected. Ensure good lighting and try again.")}}f(!1)}},className:"w-full flex items-center justify-center bg-gradient-to-r from-blue-500 to-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:from-blue-600 hover:to-blue-700 transition duration-300 disabled:opacity-50 shadow-md",disabled:d||!v||i.length>=5,children:[(0,Ba.jsx)(ft,{className:"mr-2"}),d?"Processing...":"Capture Face (".concat(i.length,"/5)")]}),(0,Ba.jsxs)("div",{className:"mt-4",children:[(0,Ba.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,Ba.jsx)("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-300",style:{width:"".concat(i.length/5*100,"%")}})}),(0,Ba.jsxs)("div",{className:"flex justify-between text-sm text-gray-600 mt-1",children:[(0,Ba.jsx)("span",{children:"Progress"}),(0,Ba.jsxs)("span",{children:[i.length,"/5 captures"]})]})]}),(0,Ba.jsxs)("div",{className:"mt-3 text-center",children:[(0,Ba.jsx)("p",{className:"text-sm ".concat(x.includes("successful")?"text-green-600":x.includes("No face")?"text-red-600":"text-gray-600"),children:x||"Position face in the center and capture."}),0===i.length&&(0,Ba.jsx)("p",{className:"text-orange-600 mt-2 font-medium",children:"Face recognition is recommended for attendance."}),i.length>=5&&(0,Ba.jsx)("p",{className:"text-green-600 mt-2 font-medium",children:"Maximum of 5 photos captured."})]})]})]}),i.length>0&&(0,Ba.jsxs)("div",{className:"mt-6",children:[(0,Ba.jsx)("h4",{className:"font-medium text-gray-700 mb-3",children:"Captured Photos:"}),(0,Ba.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-3",children:i.map((e,t)=>(0,Ba.jsxs)("div",{className:"relative group",children:[(0,Ba.jsx)("div",{className:"bg-gradient-to-br from-blue-100 to-blue-200 border-2 border-dashed border-blue-300 rounded-xl w-16 h-16 flex items-center justify-center shadow-sm",children:(0,Ba.jsx)("span",{className:"text-lg font-bold text-blue-700",children:t+1})}),(0,Ba.jsx)("button",{type:"button",onClick:()=>(e=>{o(t=>t.filter((t,n)=>n!==e))})(t),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1.5 opacity-0 group-hover:opacity-100 transition-opacity shadow-md hover:bg-red-600",title:"Remove photo",children:(0,Ba.jsx)(Zt,{size:10})})]},t))})]})]}),(0,Ba.jsxs)("div",{className:"flex flex-col sm:flex-row justify-end gap-4 pt-4",children:[(0,Ba.jsx)("button",{type:"button",onClick:n,className:"w-full sm:w-auto bg-gray-200 text-gray-800 font-bold py-3 px-6 rounded-lg hover:bg-gray-300 transition duration-300",children:"Cancel"}),(0,Ba.jsx)("button",{type:"submit",className:"w-full sm:w-auto bg-gradient-to-r from-red-600 to-red-700 text-white font-bold py-3 px-6 rounded-lg hover:from-red-700 hover:to-red-800 transition duration-300 disabled:opacity-50 shadow-md",disabled:d,children:d?(0,Ba.jsxs)("span",{className:"flex items-center justify-center",children:[(0,Ba.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,Ba.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Ba.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving Fighter..."]}):"Add Fighter"})]})]})},Lw=()=>{const e=le();return(0,Ba.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 py-8 px-4 sm:px-6",children:(0,Ba.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,Ba.jsxs)("div",{className:"text-center mb-8",children:[(0,Ba.jsx)("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-2",children:"Register New Fighter"}),(0,Ba.jsx)("p",{className:"text-gray-600 max-w-2xl mx-auto",children:"Add a new fighter to the system. Fill in the required information and optionally set up face recognition for attendance tracking."})]}),(0,Ba.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden",children:[(0,Ba.jsx)("div",{className:"bg-gradient-to-r from-red-600 to-red-700 px-6 py-4",children:(0,Ba.jsx)("h2",{className:"text-xl font-semibold text-white",children:"Fighter Registration Form"})}),(0,Ba.jsx)("div",{className:"p-6 md:p-8",children:(0,Ba.jsx)(Ow,{onAddSuccess:()=>{e("/admin")},onCancel:()=>{e("/admin")}})})]})]})})},Pw=()=>{const{id:e}=ce(),t=le(),[n,r]=(0,l.useState)({name:"",fighterBatchNo:"",email:""}),[a,i]=(0,l.useState)(null),[o,s]=(0,l.useState)(null),[c,u]=(0,l.useState)(""),[h,d]=(0,l.useState)(!1),[f,p]=(0,l.useState)(!0),[g,m]=(0,l.useState)([]),[v,b]=(0,l.useState)([]),x=(0,l.useRef)(null),[y,w]=(0,l.useState)(!1),[k,N]=(0,l.useState)("");(0,l.useEffect)(()=>{(async()=>{try{const t=await ja.get("/fighters/".concat(e));r({name:t.data.name,fighterBatchNo:t.data.fighterBatchNo,email:t.data.email}),s(t.data.profilePhoto),t.data.faceEncodings&&Array.isArray(t.data.faceEncodings)&&(b(t.data.faceEncodings),m(t.data.faceEncodings))}catch(t){u("Error fetching fighter data."),d(!0),console.error(t)}finally{p(!1)}})()},[e]),(0,l.useEffect)(()=>{(async()=>{const e="/models";try{await dw.ssdMobilenetv1.loadFromUri(e),await dw.faceLandmark68Net.loadFromUri(e),await dw.faceRecognitionNet.loadFromUri(e),w(!0)}catch(t){console.error("Error loading models:",t),u("Failed to load face recognition models."),d(!0)}})()},[]);const S=e=>{r(fn(fn({},n),{},{[e.target.name]:e.target.value}))};return f?(0,Ba.jsx)("div",{className:"p-8 text-center text-gray-500",children:"Loading fighter data for editing..."}):(0,Ba.jsxs)("div",{className:"p-4 md:p-8 max-w-3xl mx-auto",children:[(0,Ba.jsx)("h2",{className:"text-3xl font-bold mb-6 text-center text-red-600",children:"Edit Fighter"}),(0,Ba.jsxs)("form",{onSubmit:async r=>{r.preventDefault();try{const r=fn({},n);null!==a&&(r.profilePhoto=a),g.length>0&&(r.faceEncodings=JSON.stringify(g)),await ja.put("/fighters/".concat(e),r),u("Fighter updated successfully!"),d(!1),setTimeout(()=>t("/admin"),2e3)}catch(i){u("Error updating fighter. Please try again."),d(!0),console.error(i)}},className:"bg-white p-6 rounded-lg shadow-md space-y-6",children:[c&&(0,Ba.jsx)("div",{className:"p-3 rounded-md text-sm ".concat(h?"bg-red-100 text-red-700":"bg-green-100 text-green-700"),children:c}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("label",{className:"block text-gray-700",children:"Fighter Name"}),(0,Ba.jsx)("input",{type:"text",name:"name",value:n.name,onChange:S,className:"w-full px-3 py-2 border rounded-md",required:!0})]}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("label",{className:"block text-gray-700",children:"Batch Number"}),(0,Ba.jsx)("input",{type:"text",name:"fighterBatchNo",value:n.fighterBatchNo,onChange:S,className:"w-full px-3 py-2 border rounded-md",required:!0})]}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("label",{className:"block text-gray-700",children:"Email (for login)"}),(0,Ba.jsx)("input",{type:"email",name:"email",value:n.email,onChange:S,className:"w-full px-3 py-2 border rounded-md",required:!0})]}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("label",{className:"block text-gray-700 mb-2",children:"Profile Photo"}),(o||a)&&(0,Ba.jsx)("div",{className:"mb-2",children:(0,Ba.jsx)("img",{src:a||o,alt:"Profile Preview",className:"w-16 h-16 rounded-full object-cover"})}),(0,Ba.jsxs)("div",{className:"relative",children:[(0,Ba.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,Ba.jsx)(en,{className:"text-gray-400"})}),(0,Ba.jsx)("input",{type:"file",id:"profilePhoto",name:"profilePhoto",accept:".jpg,.jpeg,.png",onChange:e=>{const t=e.target.files[0];if(t){if(!t.type.match("image/jpeg")&&!t.type.match("image/png"))return u("Please upload a JPG, JPEG, or PNG image."),void d(!0);const e=new FileReader;e.onload=e=>{i(e.target.result),u(""),d(!1)},e.readAsDataURL(t)}},className:"w-full pl-10 pr-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent transition file:mr-4 file:py-1 file:px-3 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-red-50 file:text-red-700 hover:file:bg-red-100"})]}),(0,Ba.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"JPG, JPEG, or PNG format"})]}),(0,Ba.jsxs)("div",{className:"bg-gray-50 rounded-xl p-6 border border-gray-200",children:[(0,Ba.jsxs)("div",{className:"flex items-center mb-4",children:[(0,Ba.jsx)("div",{className:"bg-blue-100 p-2 rounded-lg mr-3",children:(0,Ba.jsx)(nn,{className:"text-blue-600"})}),(0,Ba.jsx)("h3",{className:"text-xl font-bold text-gray-800",children:"Face Recognition Setup"}),(0,Ba.jsx)("span",{className:"ml-3 inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800",children:v.length>0?"Enrolled":"Optional"})]}),(0,Ba.jsx)("p",{className:"text-gray-600 mb-4",children:v.length>0?"This fighter currently has ".concat(v.length," face photos enrolled. You can update these by capturing new photos below."):"Capture clear images of the fighter's face for attendance recognition. This will enable face recognition for attendance tracking."}),(0,Ba.jsxs)("div",{className:"flex flex-col lg:flex-row items-center gap-6 mb-4",children:[(0,Ba.jsxs)("div",{className:"w-full lg:w-64",children:[(0,Ba.jsx)("div",{className:"rounded-xl overflow-hidden border-2 border-gray-300 shadow-md",children:(0,Ba.jsx)(si(),{audio:!1,ref:x,screenshotFormat:"image/jpeg",width:256,height:192,className:"w-full"})}),(0,Ba.jsx)("div",{className:"mt-2 text-center",children:(0,Ba.jsx)("p",{className:"text-sm text-gray-500",children:"Position face in the center of the frame"})})]}),(0,Ba.jsxs)("div",{className:"flex-grow w-full",children:[(0,Ba.jsxs)("button",{type:"button",onClick:async()=>{if(g.length>=5)N("Maximum of 5 photos reached for high accuracy.");else{if(N("Detecting face with high accuracy..."),p(!0),x.current&&y){const e=x.current.getScreenshot();if(e){const t=await Sx(e),n=await Fw(t,new Ry({minConfidence:.9})).withFaceLandmarks().withFaceDescriptor();if(n){const e={encoding:Array.from(n.descriptor),angle:"capture_".concat(g.length+1),timestamp:(new Date).toISOString()};m(t=>[...t,e]),N("Capture ".concat(g.length+1," successful!")),g.length+1>=5&&N("Maximum captures reached. Face registration complete for high accuracy.")}else N("No face detected. Ensure good lighting and try again.")}}p(!1)}},className:"w-full flex items-center justify-center bg-gradient-to-r from-blue-500 to-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:from-blue-600 hover:to-blue-700 transition duration-300 disabled:opacity-50 shadow-md",disabled:f||!y||g.length>=5,children:[(0,Ba.jsx)(ft,{className:"mr-2"}),f?"Processing...":"Capture Face (".concat(g.length,"/5)")]}),(0,Ba.jsxs)("div",{className:"mt-3",children:[(0,Ba.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,Ba.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(g.length/5*100,"%")}})}),(0,Ba.jsxs)("div",{className:"flex justify-between text-sm text-gray-600 mt-1",children:[(0,Ba.jsx)("span",{children:"Progress"}),(0,Ba.jsxs)("span",{children:[g.length,"/5 captures"]})]})]}),(0,Ba.jsx)("div",{className:"mt-2 text-center",children:(0,Ba.jsx)("p",{className:"text-sm ".concat(k.includes("successful")?"text-green-600":k.includes("No face")?"text-red-600":"text-gray-600"),children:k||"Position face in the center and capture."})})]})]}),g.length>0&&(0,Ba.jsxs)("div",{className:"mt-4",children:[(0,Ba.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Captured Photos:"}),(0,Ba.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-2",children:g.map((e,t)=>(0,Ba.jsxs)("div",{className:"relative group",children:[(0,Ba.jsx)("div",{className:"bg-gradient-to-br from-blue-100 to-blue-200 border-2 border-dashed border-blue-300 rounded-lg w-14 h-14 flex items-center justify-center shadow-sm",children:(0,Ba.jsx)("span",{className:"text-md font-bold text-blue-700",children:t+1})}),(0,Ba.jsx)("button",{type:"button",onClick:()=>(e=>{m(t=>t.filter((t,n)=>n!==e))})(t),className:"absolute -top-1 -right-1 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity shadow-md hover:bg-red-600",title:"Remove photo",children:(0,Ba.jsx)(Zt,{size:8})})]},t))})]})]}),(0,Ba.jsx)("button",{type:"submit",className:"w-full bg-blue-600 text-white py-2 rounded-md hover:bg-blue-700 transition duration-300",children:"Save Changes"})]})]})},Mw=()=>(0,Ba.jsx)(Pw,{}),jw=()=>{const{id:e}=ce(),t=le(),[n,r]=(0,l.useState)(null),[a,i]=(0,l.useState)(null),[o,s]=(0,l.useState)(!0);if((0,l.useEffect)(()=>{(async()=>{try{const[t,n]=await Promise.all([ja.get("/fighters/".concat(e)),ja.get("/subscriptions/fighter/".concat(e))]);r(t.data),i(n.data)}catch(t){console.error("Error fetching details:",t)}finally{s(!1)}})()},[e]),o)return(0,Ba.jsx)("div",{className:"flex justify-center items-center h-screen text-white",children:"Loading..."});if(!n)return(0,Ba.jsx)("div",{className:"text-center text-white p-10",children:"Fighter not found"});const c=a&&new Date(a.endDate)>new Date;return(0,Ba.jsxs)("div",{className:"min-h-screen bg-gray-900 p-4 sm:p-8",children:[(0,Ba.jsxs)("button",{onClick:()=>t("/admin"),className:"flex items-center text-gray-400 hover:text-white mb-6 transition-colors",children:[(0,Ba.jsx)(it,{className:"mr-2"})," Back to Dashboard"]}),(0,Ba.jsxs)("div",{className:"max-w-4xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,Ba.jsxs)("div",{className:"bg-gray-800 rounded-2xl p-6 border border-gray-700 shadow-xl md:col-span-1 text-center",children:[(0,Ba.jsx)("div",{className:"w-32 h-32 mx-auto bg-gray-700 rounded-full overflow-hidden mb-4 border-4 border-gray-600 shadow-lg",children:(0,Ba.jsx)("img",{src:n.profilePhoto||"/logo.png",alt:n.name,className:"w-full h-full object-cover",onError:e=>e.target.src="/logo.png"})}),(0,Ba.jsx)("h1",{className:"text-2xl font-bold text-white mb-1",children:n.name}),(0,Ba.jsx)("p",{className:"text-gray-400 text-sm mb-4",children:n.email}),(0,Ba.jsx)("div",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wide ".concat(c?"bg-green-900/30 text-green-400 border border-green-500/30":"bg-red-900/30 text-red-400 border border-red-500/30"),children:c?"Active Member":"No Plan / Expired"})]}),(0,Ba.jsxs)("div",{className:"md:col-span-2 space-y-6",children:[(0,Ba.jsxs)("div",{className:"bg-gray-800 rounded-2xl p-6 border border-gray-700 shadow-xl",children:[(0,Ba.jsx)("h3",{className:"text-lg font-semibold text-gray-200 mb-4 border-b border-gray-700 pb-2",children:"Fighter Information"}),(0,Ba.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("p",{className:"text-gray-500 text-xs uppercase tracking-wider mb-1",children:"RFID Tag"}),(0,Ba.jsxs)("div",{className:"flex items-center text-white",children:[(0,Ba.jsx)(Lt,{className:"mr-2 text-blue-500"}),(0,Ba.jsx)("span",{className:"font-mono",children:n.rfid||"Not Assigned"})]})]}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("p",{className:"text-gray-500 text-xs uppercase tracking-wider mb-1",children:"Batch No"}),(0,Ba.jsx)("p",{className:"text-white font-medium",children:n.fighterBatchNo||"N/A"})]}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("p",{className:"text-gray-500 text-xs uppercase tracking-wider mb-1",children:"Joined Date"}),(0,Ba.jsx)("p",{className:"text-white font-medium",children:new Date(n.createdAt).toLocaleDateString()})]})]})]}),(0,Ba.jsxs)("div",{className:"bg-gray-800 rounded-2xl p-6 border border-gray-700 shadow-xl relative overflow-hidden",children:[(0,Ba.jsx)("div",{className:"absolute top-0 right-0 p-4 opacity-10",children:(0,Ba.jsx)(kt,{className:"text-9xl text-yellow-500"})}),(0,Ba.jsx)("h3",{className:"text-lg font-semibold text-gray-200 mb-4 border-b border-gray-700 pb-2 flex items-center",children:"Current Membership Plan"}),a?(0,Ba.jsxs)("div",{className:"relative z-10",children:[(0,Ba.jsxs)("div",{className:"flex justify-between items-start mb-6",children:[(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("h2",{className:"text-2xl font-bold text-white",children:a.planName}),(0,Ba.jsxs)("p",{className:"text-gray-400 text-sm flex items-center mt-1",children:[(0,Ba.jsx)(zt,{className:"mr-2 text-green-500"}),"Paid via ",a.paymentMode]})]}),(0,Ba.jsx)("div",{className:"text-right",children:(0,Ba.jsxs)("span",{className:"text-3xl font-bold text-green-400",children:["\u20b9",a.amount]})})]}),(0,Ba.jsxs)("div",{className:"grid grid-cols-2 gap-4 bg-gray-900/50 rounded-xl p-4 border border-gray-600",children:[(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("p",{className:"text-gray-500 text-xs uppercase mb-1",children:"Start Date"}),(0,Ba.jsxs)("p",{className:"text-white font-mono font-semibold flex items-center",children:[(0,Ba.jsx)(ht,{className:"mr-2 text-blue-400"}),new Date(a.startDate).toLocaleDateString()]})]}),(0,Ba.jsxs)("div",{className:"text-right",children:[(0,Ba.jsx)("p",{className:"text-gray-500 text-xs uppercase mb-1",children:"End Date"}),(0,Ba.jsxs)("p",{className:"font-mono font-semibold flex items-center justify-end ".concat(c?"text-yellow-400":"text-red-400"),children:[new Date(a.endDate).toLocaleDateString(),(0,Ba.jsx)(ht,{className:"ml-2"})]})]})]})]}):(0,Ba.jsxs)("div",{className:"text-center py-6 text-gray-500",children:[(0,Ba.jsx)("p",{children:"No active subscription found."}),(0,Ba.jsx)("button",{onClick:()=>t("/admin/subscriptions"),className:"mt-3 text-blue-400 hover:text-blue-300 text-sm underline",children:"Assign a Plan"})]})]})]})]})]})},Bw=()=>{const[e,t]=(0,l.useState)({latitude:"",longitude:"",radius:100,enabled:!0}),[n,r]=(0,l.useState)(""),[a,i]=(0,l.useState)(!0),[o,s]=(0,l.useState)(!1),[c,u]=(0,l.useState)({currentPassword:"",newPassword:"",confirmNewPassword:""}),[h,d]=(0,l.useState)(""),[f,p]=(0,l.useState)(!1),[g,m]=(0,l.useState)({newEmail:"",confirmNewEmail:"",password:""}),[v,b]=(0,l.useState)(""),[x,y]=(0,l.useState)(!1);(0,l.useEffect)(()=>{(async()=>{try{var e,n,r,a;const i=await ja.get("/settings");t({latitude:void 0!==(null===(e=i.data.location)||void 0===e?void 0:e.latitude)?i.data.location.latitude:"",longitude:void 0!==(null===(n=i.data.location)||void 0===n?void 0:n.longitude)?i.data.location.longitude:"",radius:(null===(r=i.data.location)||void 0===r?void 0:r.radius)||100,enabled:void 0===(null===(a=i.data.location)||void 0===a?void 0:a.enabled)||i.data.location.enabled})}catch(o){console.error("Error fetching settings:",o),t({latitude:"",longitude:"",radius:100,enabled:!0})}finally{i(!1)}})()},[]);const w=n=>{const{name:r,value:a,type:i,checked:o}=n.target;"number"===i?"latitude"===r||"longitude"===r?(""===a||/^-?\d*\.?\d*$/.test(a))&&t(fn(fn({},e),{},{[r]:a})):"radius"===r?(""===a||/^\d*$/.test(a))&&t(fn(fn({},e),{},{[r]:a})):(""===a||/^\d*$/.test(a))&&t(fn(fn({},e),{},{[r]:a})):t(fn(fn({},e),{},"checkbox"===i?{[r]:o}:{[r]:a}))},k=e=>{const{name:t,value:n}=e.target;u(fn(fn({},c),{},{[t]:n}))},N=e=>{const{name:t,value:n}=e.target;m(fn(fn({},g),{},{[t]:n}))};return a?(0,Ba.jsx)("div",{className:"flex justify-center items-center h-screen bg-gray-100",children:(0,Ba.jsxs)("div",{className:"text-center text-gray-500",children:[(0,Ba.jsx)("div",{className:"w-16 h-16 border-4 border-red-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,Ba.jsx)("h2",{className:"text-xl font-semibold",children:"Loading Settings..."})]})}):(0,Ba.jsx)("div",{className:"min-h-screen bg-gray-100 p-4 md:p-8",children:(0,Ba.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,Ba.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-8 border-l-4 border-red-600 pl-4",children:"Administration Settings"}),(0,Ba.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,Ba.jsx)("div",{className:"space-y-8",children:(0,Ba.jsxs)("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[(0,Ba.jsx)("div",{className:"bg-gray-800 py-4 px-6 border-b border-gray-700",children:(0,Ba.jsx)("h2",{className:"text-xl font-bold text-white flex items-center",children:"\ud83d\udccd Location Verification"})}),(0,Ba.jsx)("div",{className:"p-6",children:(0,Ba.jsxs)("form",{onSubmit:async t=>{t.preventDefault(),r(""),s(!0);try{if(e.enabled){if(!e.latitude&&0!==e.latitude||!e.longitude&&0!==e.longitude)return r("Error: Latitude and longitude are required when enabled"),void s(!1);const t=parseFloat(e.latitude),n=parseFloat(e.longitude);if(isNaN(t)||isNaN(n))return r("Error: Coordinates must be valid numbers"),void s(!1);if(t<-90||t>90)return r("Error: Latitude must be between -90 and 90"),void s(!1);if(n<-180||n>180)return r("Error: Longitude must be between -180 and 180"),void s(!1)}const t=parseInt(e.radius);if(isNaN(t)||t<50||t>500)return r("Error: Radius must be between 50 and 500 meters"),void s(!1);let n;n=e.enabled?{latitude:parseFloat(e.latitude),longitude:parseFloat(e.longitude),radius:t,enabled:e.enabled}:{latitude:0,longitude:0,radius:t,enabled:e.enabled};const a=await ja.post("/settings",{location:n});r(a.data.msg)}catch(i){var n,a;console.error("Error updating settings:",i);const e=(null===(n=i.response)||void 0===n||null===(a=n.data)||void 0===a?void 0:a.msg)||i.message||"Error updating location.";r("Error: ".concat(e))}finally{s(!1)}},className:"space-y-6",children:[n&&(0,Ba.jsx)("div",{className:"p-3 rounded-md text-sm font-medium ".concat(n.includes("Error")?"bg-red-100 text-red-700":"bg-green-100 text-green-700"),children:n}),(0,Ba.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-200",children:[(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("h3",{className:"font-semibold text-gray-800",children:"Enable Geofencing"}),(0,Ba.jsx)("p",{className:"text-xs text-gray-500",children:"Restrict attendance to gym premises"})]}),(0,Ba.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,Ba.jsx)("input",{type:"checkbox",name:"enabled",checked:e.enabled,onChange:w,className:"sr-only peer"}),(0,Ba.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"})]})]}),(0,Ba.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Latitude"}),(0,Ba.jsx)("input",{type:"number",name:"latitude",value:e.latitude,onChange:w,step:"any",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all disabled:bg-gray-100 disabled:text-gray-400",required:e.enabled,disabled:!e.enabled,placeholder:"e.g. 12.9716"})]}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Longitude"}),(0,Ba.jsx)("input",{type:"number",name:"longitude",value:e.longitude,onChange:w,step:"any",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all disabled:bg-gray-100 disabled:text-gray-400",required:e.enabled,disabled:!e.enabled,placeholder:"e.g. 77.5946"})]})]}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Allowed Radius (meters)"}),(0,Ba.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Ba.jsx)("input",{type:"range",name:"radius",value:e.radius,onChange:w,min:"50",max:"500",step:"10",className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-600",disabled:!e.enabled}),(0,Ba.jsx)("input",{type:"number",name:"radius",value:e.radius,onChange:w,className:"w-20 px-2 py-1 text-center border border-gray-300 rounded-lg font-mono",disabled:!e.enabled})]})]}),(0,Ba.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-2",children:[(0,Ba.jsx)("button",{type:"button",onClick:async()=>{r(""),navigator.geolocation?navigator.geolocation.getCurrentPosition(n=>{t(fn(fn({},e),{},{latitude:parseFloat(n.coords.latitude.toFixed(6)),longitude:parseFloat(n.coords.longitude.toFixed(6))})),r("Location updated successfully!")},e=>{console.error("Error getting location:",e),r("Unable to retrieve your location. Please try again.")}):r("Geolocation is not supported by your browser.")},className:"flex-1 bg-white border border-gray-300 text-gray-700 font-medium py-2.5 px-4 rounded-lg hover:bg-gray-50 transition-all disabled:opacity-50",disabled:!e.enabled||o,children:"Get Coordinates"}),(0,Ba.jsx)("button",{type:"submit",className:"flex-1 bg-blue-600 text-white font-bold py-2.5 px-4 rounded-lg hover:bg-blue-700 shadow-lg shadow-blue-500/30 transition-all disabled:opacity-50",disabled:o,children:o?"Saving...":"Save Location"})]})]})})]})}),(0,Ba.jsxs)("div",{className:"space-y-8",children:[(0,Ba.jsxs)("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[(0,Ba.jsx)("div",{className:"bg-red-600 py-4 px-6 border-b border-red-700",children:(0,Ba.jsx)("h2",{className:"text-xl font-bold text-white flex items-center",children:"\ud83d\udd12 Change Password"})}),(0,Ba.jsx)("div",{className:"p-6",children:(0,Ba.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),d(""),p(!0);try{if(!c.currentPassword||!c.newPassword||!c.confirmNewPassword)return d("Please fill in all fields"),void p(!1);if(c.newPassword!==c.confirmNewPassword)return d("New passwords do not match"),void p(!1);if(c.newPassword.length<6)return d("New password must be at least 6 characters"),void p(!1);const e=await ja.post("/auth/change-password",{oldPassword:c.currentPassword,newPassword:c.newPassword});d(e.data.msg),u({currentPassword:"",newPassword:"",confirmNewPassword:""})}catch(r){var t,n;console.error("Error changing password:",r);const e=(null===(t=r.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.msg)||r.message||"Error changing password.";d("Error: ".concat(e))}finally{p(!1)}},className:"space-y-4",children:[h&&(0,Ba.jsx)("div",{className:"p-3 rounded-md text-sm font-medium ".concat(h.includes("Error")?"bg-red-100 text-red-700":"bg-green-100 text-green-700"),children:h}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Current Password"}),(0,Ba.jsx)("input",{type:"password",name:"currentPassword",value:c.currentPassword,onChange:k,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 outline-none",required:!0})]}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"New Password"}),(0,Ba.jsx)("input",{type:"password",name:"newPassword",value:c.newPassword,onChange:k,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 outline-none",required:!0,minLength:"6"}),(0,Ba.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Minimum 6 characters"})]}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Confirm New Password"}),(0,Ba.jsx)("input",{type:"password",name:"confirmNewPassword",value:c.confirmNewPassword,onChange:k,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 outline-none",required:!0})]}),(0,Ba.jsx)("button",{type:"submit",className:"w-full bg-gray-800 text-white font-bold py-2.5 px-4 rounded-lg hover:bg-gray-900 transition-all disabled:opacity-50",disabled:f,children:f?"Updating...":"Update Password"})]})})]}),(0,Ba.jsxs)("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[(0,Ba.jsx)("div",{className:"bg-gray-700 py-4 px-6 border-b border-gray-800",children:(0,Ba.jsx)("h2",{className:"text-xl font-bold text-white flex items-center",children:"\u2709\ufe0f Update Email"})}),(0,Ba.jsx)("div",{className:"p-6",children:(0,Ba.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),b(""),y(!0);try{if(!g.newEmail||!g.confirmNewEmail||!g.password)return b("Please fill in all fields"),void y(!1);if(g.newEmail!==g.confirmNewEmail)return b("Email addresses do not match"),void y(!1);if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(g.newEmail))return b("Please enter a valid email address"),void y(!1);const e=await ja.put("/auth/change-email",{newEmail:g.newEmail,password:g.password});b(e.data.msg),m({newEmail:"",confirmNewEmail:"",password:""})}catch(r){var t,n;console.error("Error changing email:",r);const e=(null===(t=r.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.msg)||r.message||"Error changing email.";b("Error: ".concat(e))}finally{y(!1)}},className:"space-y-4",children:[v&&(0,Ba.jsx)("div",{className:"p-3 rounded-md text-sm font-medium ".concat(v.includes("Error")?"bg-red-100 text-red-700":"bg-green-100 text-green-700"),children:v}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"New Email Address"}),(0,Ba.jsx)("input",{type:"email",name:"newEmail",value:g.newEmail,onChange:N,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",required:!0})]}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Confirm New Email"}),(0,Ba.jsx)("input",{type:"email",name:"confirmNewEmail",value:g.confirmNewEmail,onChange:N,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",required:!0})]}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Current Password"}),(0,Ba.jsx)("input",{type:"password",name:"password",value:g.password,onChange:N,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",required:!0,placeholder:"Verify your identity"})]}),(0,Ba.jsx)("button",{type:"submit",className:"w-full bg-blue-600 text-white font-bold py-2.5 px-4 rounded-lg hover:bg-blue-700 transition-all disabled:opacity-50",disabled:x,children:x?"Updating...":"Update Email"})]})})]})]})]})]})})};class zw{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class Ww{refCount(e){return Uw("refCount")}incRef(e){return Uw("incRef")}timerAvailable(){return!0}time(e){return Uw("time")}read(e){return Uw("read")}readSync(e){return Uw("readSync")}readToGPU(e,t){return Uw("readToGPU")}numDataIds(){return Uw("numDataIds")}disposeData(e,t){return Uw("disposeData")}write(e,t,n){return Uw("write")}move(e,t,n,r,a){return Uw("move")}createTensorFromGPUData(e,t,n){return Uw("createTensorFromGPUData")}memory(){return Uw("memory")}floatPrecision(){return Uw("floatPrecision")}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}dispose(){return Uw("dispose")}}function Uw(e){throw new Error("'".concat(e,"' not yet implemented or not found in the registry. ")+"This kernel may not be supported by the tfjs backend you have chosen")}function Vw(e){let t=e.length,n=0;for(;t>0;)n=Math.random()*t|0,t--,qw(e,t,n)}function Hw(e,t,n){return Math.max(e,Math.min(t,n))}function Gw(e){return e%2===0?e:e+1}function qw(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function Kw(e,t){if(!e)throw new Error("string"===typeof t?t:t())}function Xw(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";Kw(Jw(e,t),()=>n+" Shapes ".concat(e," and ").concat(t," must match"))}function Yw(e){Kw(null!=e,()=>"The input to the tensor constructor must be a non-null value.")}function $w(e){if(0===e.length)return 1;let t=e[0];for(let n=1;n<e.length;n++)t*=e[n];return t}function Jw(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Qw(e){return e%1===0}function Zw(e){const t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function ek(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function tk(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return new Promise((a,i)=>{let o=0;const s=()=>{if(e())return void a();o++;const l=t(o);null!=n&&o>=n?i():null!=r?r(s,l):setTimeout(s,l)};s()})}function nk(e,t){let n=1,r=-1;for(let i=0;i<e.length;++i)if(e[i]>=0)n*=e[i];else if(-1===e[i]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. "+"Found -1 at dim ".concat(r," and dim ").concat(i));r=i}else if(e[i]<0)throw Error("Shapes can not be < 0. Found ".concat(e[i]," at dim ").concat(i));if(-1===r){if(t>0&&t!==n)throw Error("Size(".concat(t,") must match the product of shape ").concat(e));return e}if(0===n)throw Error("Cannot infer the missing size in [".concat(e,"] when ")+"there are 0 elements");if(t%n!==0)throw Error("The implicit shape can't be a fractional number. "+"Got ".concat(t," / ").concat(n));const a=e.slice();return a[r]=t/n,a}function rk(e,t){const n=t.length;return e=null==e?t.map((e,t)=>t):[].concat(e),Kw(e.every(e=>e>=-n&&e<n),()=>"All values in axis param must be in range [-".concat(n,", ").concat(n,") but ")+"got axis ".concat(e)),Kw(e.every(e=>Qw(e)),()=>"All values in axis param must be integers but "+"got axis ".concat(e)),e.map(e=>e<0?n+e:e)}function ak(e,t){const n=[],r=[],a=null!=t&&Array.isArray(t)&&0===t.length,i=null==t||a?null:rk(t,e).sort();let o=0;for(let s=0;s<e.length;++s){if(null!=i){if(i[o]===s&&1!==e[s])throw new Error("Can't squeeze axis ".concat(s," since its dim '").concat(e[s],"' is not 1"));(null==i[o]||i[o]>s)&&1===e[s]&&(n.push(e[s]),r.push(s)),i[o]<=s&&o++}1!==e[s]&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function ik(e,t){return ok(e,t)}function ok(e,t){let n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error("Unknown data type ".concat(e));n=new Array(t)}return n}function sk(e,t){return"complex64"!==t&&(("float32"!==t||"complex64"===e)&&(("int32"!==t||"float32"===e||"complex64"===e)&&("bool"!==t||"bool"!==e)))}function lk(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype ".concat(e))}function ck(e){return"string"===typeof e||e instanceof String}function uk(e){return"number"===typeof e}function hk(e){return Array.isArray(e)?hk(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?"int32":uk(e)?"float32":ck(e)?"string":function(e){return"boolean"===typeof e}(e)?"bool":"float32"}function dk(e){return!!(e&&e.constructor&&e.call&&e.apply)}function fk(e,t){for(let n=t;n<e;++n)if(e%n===0)return n;return e}function pk(e){const t=e.length;if(t<2)return[];const n=new Array(t-1);n[t-2]=e[t-1];for(let r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function gk(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=new Array;if(1===t.length){const i=t[0]*(r?2:1);for(let t=0;t<i;t++)a[t]=n[e+t]}else{const i=t[0],o=t.slice(1),s=o.reduce((e,t)=>e*t)*(r?2:1);for(let t=0;t<i;t++)a[t]=gk(e+t*s,o,n,r)}return a}function mk(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===e.length)return t[0];const r=e.reduce((e,t)=>e*t)*(n?2:1);if(0===r)return[];if(r!==t.length)throw new Error("[".concat(e,"] does not match the input size ").concat(t.length).concat(n?" for a complex tensor":"","."));return gk(0,e,t,n)}function vk(e,t){const n=bk(e,t);for(let r=0;r<n.length;r++)n[r]=1;return n}function bk(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type ".concat(t))}function xk(e,t){const n=e.reduce((e,t)=>e*t,1);if(null==t||"float32"===t)return mk(e,new Float32Array(n));if("int32"===t)return mk(e,new Int32Array(n));if("bool"===t)return mk(e,new Uint8Array(n));throw new Error("Unknown data type ".concat(t))}function yk(e){e.forEach(t=>{Kw(Number.isInteger(t)&&t>=0,()=>"Tensor must have a shape comprised of positive integers but got "+"shape [".concat(e,"]."))})}function wk(e,t,n){if(0===t)return 0;if(1===t)return e[0];let r=e[e.length-1];for(let a=0;a<e.length-1;++a)r+=n[a]*e[a];return r}function kk(e,t,n){if(0===t)return[];if(1===t)return[e];const r=new Array(t);for(let a=0;a<r.length-1;++a)r[a]=Math.floor(e/n[a]),e-=r[a]*n[a];return r[r.length-1]=e,r}function Nk(e){return e&&e.then&&"function"===typeof e.then}const Sk="tfjsflags";class Ck{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=Ek,this.populateURLFlags()}setPlatform(e,t){null!=this.platform&&(_k().getBool("IS_TEST")||_k().getBool("PROD")||console.warn("Platform ".concat(this.platformName," has already been set. ")+"Overwriting the platform with ".concat(e,"."))),this.platformName=e,this.platform=t}registerFlag(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){const t=this.urlFlags[e];_k().getBool("IS_TEST")||_k().getBool("PROD")||console.warn("Setting feature override from URL ".concat(e,": ").concat(t,".")),this.set(e,t)}}async getAsync(e){return e in this.flags||(this.flags[e]=await this.evaluateFlag(e)),this.flags[e]}get(e){if(e in this.flags)return this.flags[e];const t=this.evaluateFlag(e);if(Nk(t))throw new Error("Flag ".concat(e," cannot be synchronously evaluated. ")+"Please use getAsync() instead.");return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(null==this.flagRegistry[e])throw new Error("Cannot set flag ".concat(e," as it has not been registered."));this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(null==this.flagRegistry[e])throw new Error("Cannot evaluate flag '".concat(e,"': no evaluation function found."));return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if("undefined"===typeof this.global||"undefined"===typeof this.global.location||"undefined"===typeof this.global.location.search)return;const e=this.getQueryParams(this.global.location.search);if(Sk in e){e[Sk].split(",").forEach(e=>{const[t,n]=e.split(":");this.urlFlags[t]=function(e,t){const n=t.toLowerCase();return"true"===n||"false"===n?"true"===n:"".concat(+n)===n?+n:t}(0,n)})}}}function Ek(e){const t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return function(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}(t,r[0],r[1]),r.join("=")}),t}function _k(){return Tk}let Ik,Tk=null;function Ak(){if(null==Ik){let e;if("undefined"!==typeof window)e=window;else if("undefined"!==typeof n.g)e=n.g;else if("undefined"!==typeof process)e=process;else{if("undefined"===typeof self)throw new Error("Could not find a global object");e=self}Ik=e}return Ik}function Rk(e,t){const n=function(){const e=Ak();return null==e._tfGlobals&&(e._tfGlobals=new Map),e._tfGlobals}();if(n.has(e))return n.get(e);{const r=t();return n.set(e,r),n.get(e)}}const Dk="Abs",Fk="Acos",Ok="Acosh",Lk="Add",Pk="AddN",Mk="All",jk="Any",Bk="ArgMax",zk="ArgMin",Wk="Asin",Uk="Asinh",Vk="Atan",Hk="Atanh",Gk="Atan2",qk="AvgPool",Kk="AvgPoolGrad",Xk="AvgPool3D",Yk="AvgPool3DGrad",$k="BatchMatMul",Jk="BatchToSpaceND",Qk="Bincount",Zk="BitwiseAnd",eN="BroadcastArgs",tN="Cast",nN="Ceil",rN="ClipByValue",aN="Complex",iN="ComplexAbs",oN="Concat",sN="Conv2D",lN="Conv2DBackpropFilter",cN="Conv2DBackpropInput",uN="Conv3D",hN="Conv3DBackpropFilterV2",dN="Conv3DBackpropInputV2",fN="Cos",pN="Cosh",gN="Cumprod",mN="Cumsum",vN="CropAndResize",bN="DenseBincount",xN="DepthToSpace",yN="DepthwiseConv2dNative",wN="DepthwiseConv2dNativeBackpropFilter",kN="DepthwiseConv2dNativeBackpropInput",NN="Diag",SN="Dilation2D",CN="Dilation2DBackpropInput",EN="Dilation2DBackpropFilter",_N="Draw",IN="RealDiv",TN="Einsum",AN="Elu",RN="EluGrad",DN="Erf",FN="Equal",ON="Exp",LN="ExpandDims",PN="Expm1",MN="FFT",jN="Fill",BN="FlipLeftRight",zN="Floor",WN="FloorDiv",UN="FusedBatchNorm",VN="GatherV2",HN="GatherNd",GN="Greater",qN="GreaterEqual",KN="Identity",XN="IFFT",YN="Imag",$N="IsFinite",JN="IsInf",QN="IsNan",ZN="LeakyRelu",eS="Less",tS="LessEqual",nS="LinSpace",rS="Log",aS="Log1p",iS="LogicalAnd",oS="LogicalNot",sS="LogicalOr",lS="LRN",cS="LRNGrad",uS="Max",hS="Maximum",dS="MaxPool",fS="MaxPoolGrad",pS="MaxPool3D",gS="MaxPool3DGrad",mS="MaxPoolWithArgmax",vS="Mean",bS="Min",xS="Minimum",yS="MirrorPad",wS="Mod",kS="Multinomial",NS="Multiply",SS="Neg",CS="NotEqual",ES="NonMaxSuppressionV3",_S="NonMaxSuppressionV4",IS="NonMaxSuppressionV5",TS="OnesLike",AS="OneHot",RS="Pack",DS="PadV2",FS="Pow",OS="Prelu",LS="Prod",PS="RaggedGather",MS="RaggedRange",jS="RaggedTensorToTensor",BS="Range",zS="Real",WS="Reciprocal",US="Relu",VS="Reshape",HS="ResizeNearestNeighbor",GS="ResizeNearestNeighborGrad",qS="ResizeBilinear",KS="ResizeBilinearGrad",XS="Relu6",YS="Reverse",$S="Round",JS="Rsqrt",QS="ScatterNd",ZS="TensorScatterUpdate",eC="SearchSorted",tC="Select",nC="Selu",rC="Slice",aC="Sin",iC="Sinh",oC="Sign",sC="Sigmoid",lC="Softplus",cC="Sqrt",uC="Sum",hC="SpaceToBatchND",dC="SplitV",fC="Softmax",pC="SparseFillEmptyRows",gC="SparseReshape",mC="SparseSegmentMean",vC="SparseSegmentSum",bC="SparseToDense",xC="SquaredDifference",yC="Square",wC="StaticRegexReplace",kC="StridedSlice",NC="StringNGrams",SC="StringSplit",CC="StringToHashBucketFast",EC="Sub",_C="Tan",IC="Tanh",TC="Tile",AC="TopK",RC="Transform",DC="Transpose",FC="Unique",OC="Unpack",LC="UnsortedSegmentSum",PC="ZerosLike",MC="Step",jC="FromPixels",BC="RotateWithOffset",zC="_FusedMatMul",WC="FusedConv2D",UC="FusedDepthwiseConv2D";function VC(){_k().getBool("IS_TEST")||_k().getBool("PROD")||console.warn(...arguments)}function HC(){_k().getBool("IS_TEST")||_k().getBool("PROD")||console.log(...arguments)}const GC=Rk("kernelRegistry",()=>new Map),qC=Rk("gradRegistry",()=>new Map);function KC(e,t){const n=QC(e,t);return GC.get(n)}function XC(e){return qC.get(e)}function YC(e){const t=GC.entries(),n=[];for(;;){const{done:r,value:a}=t.next();if(r)break;const[i,o]=a,[s]=i.split("_");s===e&&n.push(o)}return n}function $C(e){const{kernelName:t,backendName:n}=e,r=QC(t,n);GC.has(r)&&VC("The kernel '".concat(t,"' for backend ")+"'".concat(n,"' is already registered")),GC.set(r,e)}function JC(e){const{kernelName:t}=e;qC.has(t)&&_k().getBool("DEBUG")&&VC("Overriding the gradient for '".concat(t,"'")),qC.set(t,e)}function QC(e,t){return"".concat(t,"_").concat(e)}function ZC(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}var eE=n(7353);const tE=n.n(eE)()||eE;function nE(e){return tE.fromString(e,!0,16)}const rE=nE("c3a5c85c97cb3127"),aE=nE("b492b66fbe98f273"),iE=nE("9ae16a3b2f90404f");function oE(e){return e.xor(e.shru(47))}function sE(e,t,n){const r=e.slice(t,t+n);return tE.fromBytes(Array.from(r),!0,!0)}function lE(e,t){return sE(e,t,8)}function cE(e,t){return sE(e,t,4)}function uE(e,t){return 0===t?e:e.shru(t).or(e.shl(64-t))}function hE(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:nE("9ddfea08eb382d69"),r=e.xor(t).mul(n);r=r.xor(r.shru(47));let a=t.xor(r).mul(n);return a=a.xor(a.shru(47)),a=a.mul(n),a}function dE(e,t,n,r){return function(e,t,n,r,a,i){a=a.add(e),i=uE(i.add(a).add(r),21);const o=a;return a=(a=a.add(t)).add(n),i=i.add(uE(a,44)),[a.add(r),i.add(o)]}(lE(e,t),lE(e,t+8),lE(e,t+16),lE(e,t+24),n,r)}function fE(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;const n=tE.fromNumber(81,!0);if(t<=32)return t<=16?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;if(t>=8){const n=iE.add(2*t),r=lE(e,0).add(iE),a=lE(e,t-8);return hE(uE(a,37).mul(n).add(r),uE(r,25).add(a).mul(n),n)}if(t>=4){const n=iE.add(2*t);return hE(cE(e,0).shl(3).add(t),cE(e,t-4),n)}if(t>0){const n=e[0]+(e[t>>1]<<8),r=t+(e[t-1]<<2);return oE(iE.mul(n).xor(rE.mul(r))).mul(iE)}return iE}(e,t):function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;const n=iE.add(2*t),r=lE(e,0).mul(aE),a=lE(e,8),i=lE(e,t-8).mul(n),o=lE(e,t-16).mul(iE);return hE(uE(r.add(a),43).add(uE(i,30)).add(o),r.add(uE(a.add(iE),18)).add(i),n)}(e,t);if(t<=64)return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;const n=iE.add(2*t),r=lE(e,0).mul(iE),a=lE(e,8),i=lE(e,t-8).mul(n),o=lE(e,t-16).mul(iE),s=uE(r.add(a),43).add(uE(i,30)).add(o),l=hE(s,r.add(uE(a.add(iE),18)).add(i),n),c=lE(e,16).mul(n),u=lE(e,24),h=s.add(lE(e,t-32)).mul(n),d=l.add(lE(e,t-24)).mul(n);return hE(uE(c.add(u),43).add(uE(h,30)).add(d),c.add(uE(u.add(r),18)).add(h),n)}(e,t);let r=n,a=n.mul(aE).add(113),i=oE(a.mul(iE).add(113)).mul(iE),o=[tE.UZERO,tE.UZERO],s=[tE.UZERO,tE.UZERO];r=r.mul(iE).add(lE(e,0));let l=0;const c=64*(t-1>>6),u=c+(t-1&63)-63;do{r=uE(r.add(a).add(o[0]).add(lE(e,l+8)),37).mul(aE),a=uE(a.add(o[1]).add(lE(e,l+48)),42).mul(aE),r=r.xor(s[1]),a=a.add(o[0]).add(lE(e,l+40)),i=uE(i.add(s[0]),33).mul(aE),o=dE(e,l,o[1].mul(aE),r.add(s[0])),s=dE(e,l+32,i.add(s[1]),a.add(lE(e,l+16))),[i,r]=[r,i],l+=64}while(l!==c);const h=aE.add(i.and(255).shl(1));return l=u,s[0]=s[0].add(t-1&63),o[0]=o[0].add(s[0]),s[0]=s[0].add(o[0]),r=uE(r.add(a).add(o[0]).add(lE(e,l+8)),37).mul(h),a=uE(a.add(o[1]).add(lE(e,l+48)),42).mul(h),r=r.xor(s[1].mul(9)),a=a.add(o[0].mul(9).add(lE(e,l+40))),i=uE(i.add(s[0]),33).mul(h),o=dE(e,l,o[1].mul(h),r.add(s[0])),s=dE(e,l+32,i.add(s[1]),a.add(lE(e,l+16))),[i,r]=[r,i],hE(hE(o[0],s[0],h).add(oE(a).mul(rE)).add(i),hE(o[1],s[1],h).add(r),h)}function pE(e,t){return"string"===t?vE(e):gE([e],t)}function gE(e,t){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=yE(e)),_k().getBool("DEBUG")&&function(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type ".concat(t," being uploaded contains ").concat(r,"."))}}(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){const t=new Uint8Array(e.length);for(let n=0;n<t.length;++n)0!==Math.round(e[n])&&(t[n]=1);return t}throw new Error("Unknown data type ".concat(t))}function mE(){return _k().platform.now()}function vE(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",_k().platform.encode(e,t)}function bE(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",_k().platform.decode(e,t)}function xE(e){return null!=_k().platform.isTypedArray?_k().platform.isTypedArray(e):ZC(e)}function yE(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t&&(t=[]),"boolean"===typeof e||"number"===typeof e||"string"===typeof e||Nk(e)||null==e||xE(e)&&n)t.push(e);else if(Array.isArray(e)||xE(e))for(let r=0;r<e.length;++r)yE(e[r],t,n);else{let r=-1;for(const t of Object.keys(e))/^([1-9]+[0-9]*|0)$/.test(t)&&(r=Math.max(r,Number(t)));for(let a=0;a<=r;a++)yE(e[a],t,n)}return t}class wE{constructor(e,t){this.backendTimer=e,this.logger=t,null==t&&(this.logger=new NE)}profileKernel(e,t,n){let r;const a=()=>{r=n()};let i;const o=mE();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(a);else{a();for(const e of r)e.dataSync();i=Promise.resolve({kernelMs:mE()-o})}if(_k().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let s=0;s<r.length;s++){const t=r[s];t.data().then(n=>{kE(n,t.dtype,e)})}return{kernelName:e,outputs:r,inputs:t,timeMs:i.then(e=>e.kernelMs),extraInfo:i.then(e=>null!=e.getExtraProfileInfo?e.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:t,outputs:n,timeMs:r,inputs:a,extraInfo:i}=e;n.forEach(e=>{Promise.all([e.data(),r,i]).then(n=>{this.logger.logKernelProfile(t,e,n[0],n[1],a,n[2])})})}}function kE(e,t,n){if("float32"!==t)return!1;for(let r=0;r<e.length;r++){const t=e[r];if(isNaN(t)||!isFinite(t))return console.warn("Found ".concat(t," in the result of '").concat(n,"'")),!0}return!1}class NE{logKernelProfile(e,t,n,r,a,i){const o="number"===typeof r?ek("".concat(r,"ms"),9):r.error,s=ek(e,25),l=t.rank,c=t.size,u=ek(t.shape.toString(),14);let h="";for(const d in a){const e=a[d];if(null!=e){const n=e.shape||t.shape,r=n.length;h+="".concat(d,": ").concat(r,"D ").concat(r>0?n:""," ")}}console.log("%c".concat(s,"\t%c").concat(o,"\t%c").concat(l,"D ").concat(u,"\t%c").concat(c,"\t%c").concat(h,"\t%c").concat(i),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}function SE(e,t,n,r){const a=pk(t),i=function(e,t,n,r){const a=$w(t),i=r[r.length-1],o=new Array(i).fill(0),s=t.length,l="complex64"===n?IE(e):e;if(s>1)for(let c=0;c<a/i;c++){const e=c*i;for(let t=0;t<i;t++)o[t]=Math.max(o[t],CE(l[e+t],0,n).length)}return o}(e,t,n,a),o=t.length,s=_E(e,t,n,a,i),l=["Tensor"];return r&&(l.push("  dtype: ".concat(n)),l.push("  rank: ".concat(o)),l.push("  shape: [".concat(t,"]")),l.push("  values:")),l.push(s.map(e=>"    "+e).join("\n")),l.join("\n")}function CE(e,t,n){let r;return r=Array.isArray(e)?"".concat(parseFloat(e[0].toFixed(7))," + ")+"".concat(parseFloat(e[1].toFixed(7)),"j"):ck(e)?"'".concat(e,"'"):"bool"===n?EE(e):parseFloat(e.toFixed(7)).toString(),ek(r,t)}function EE(e){return 0===e?"false":"true"}function _E(e,t,n,r,a){let i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];const o="complex64"===n?2:1,s=t[0],l=t.length;if(0===l){if("complex64"===n){return[CE(IE(e)[0],0,n)]}return"bool"===n?[EE(e[0])]:[e[0].toString()]}if(1===l){if(s>20){const t=3*o;let r=Array.from(e.slice(0,t)),i=Array.from(e.slice((s-3)*o,s*o));return"complex64"===n&&(r=IE(r),i=IE(i)),["["+r.map((e,t)=>CE(e,a[t],n)).join(", ")+", ..., "+i.map((e,t)=>CE(e,a[s-3+t],n)).join(", ")+"]"]}return["["+("complex64"===n?IE(e):Array.from(e)).map((e,t)=>CE(e,a[t],n)).join(", ")+"]"]}const c=t.slice(1),u=r.slice(1),h=r[0]*o,d=[];if(s>20){for(let t=0;t<3;t++){const r=t*h,i=r+h;d.push(..._E(e.slice(r,i),c,n,u,a,!1))}d.push("...");for(let t=s-3;t<s;t++){const r=t*h,i=r+h;d.push(..._E(e.slice(r,i),c,n,u,a,t===s-1))}}else for(let g=0;g<s;g++){const t=g*h,r=t+h;d.push(..._E(e.slice(t,r),c,n,u,a,g===s-1))}const f=2===l?",":"";d[0]="["+(s>0?d[0]+f:"");for(let g=1;g<d.length-1;g++)d[g]=" "+d[g]+f;let p=",\n";for(let g=2;g<l;g++)p+="\n";return d[d.length-1]=" "+d[d.length-1]+"]"+(i?"":p),d}function IE(e){const t=[];for(let n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}class TE{constructor(e,t,n){if(this.dtype=t,this.shape=e.slice(),this.size=$w(e),null!=n){const e=n.length;Kw(e===this.size,()=>"Length of values '".concat(e,"' does not match the size ")+"inferred by the shape '".concat(this.size,"'."))}if("complex64"===t)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||ok(t,this.size),this.strides=pk(e)}set(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),Kw(n.length===this.rank,()=>"The number of provided coordinates (".concat(n.length,") must ")+"match the rank (".concat(this.rank,")"));const a=this.locToIndex(n);this.values[a]=e}get(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];0===t.length&&(t=[0]);let r=0;for(const i of t){if(i<0||i>=this.shape[r]){const e="Requested out of range element at ".concat(t,". ")+"  Buffer shape=".concat(this.shape);throw new Error(e)}r++}let a=t[t.length-1];for(let i=0;i<t.length-1;++i)a+=this.strides[i]*t[i];return this.values[a]}locToIndex(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];let t=e[e.length-1];for(let n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}indexToLoc(e){if(0===this.rank)return[];if(1===this.rank)return[e];const t=new Array(this.shape.length);for(let n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return AE().makeTensor(this.values,this.shape,this.dtype)}}let AE=null,RE=null,DE=null;class FE{constructor(e,t,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=$w(e),this.strides=pk(e),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return RE.buffer(this.shape,this.dtype,e)}bufferSync(){return RE.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return mk(this.shape,e,"complex64"===this.dtype)}arraySync(){return mk(this.shape,this.dataSync(),"complex64"===this.dtype)}async data(){this.throwIfDisposed();const e=AE().read(this.dataId);if("string"===this.dtype){const t=await e;try{return t.map(e=>bE(e))}catch(Gu){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),AE().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=AE().readSync(this.dataId);if("string"===this.dtype)try{return e.map(e=>bE(e))}catch(Gu){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await AE().read(this.dataId);return"string"===this.dtype?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),AE().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return RE.print(this,e)}clone(){return this.throwIfDisposed(),RE.clone(this)}toString(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return SE(this.dataSync(),this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),RE.cast(this,e)}variable(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.throwIfDisposed(),AE().makeVariable(this,e,t,n)}}function OE(){return Rk("Tensor",()=>FE)}Object.defineProperty(FE,Symbol.hasInstance,{value:e=>!!e&&null!=e.data&&null!=e.dataSync&&null!=e.throwIfDisposed}),OE();class LE extends FE{constructor(e,t,n,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=t,this.name=n}assign(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(e.dtype,") and ")+"previous value (".concat(this.dtype,") must match"));if(!Jw(e.shape,this.shape))throw new Error("shape of the new value (".concat(e.shape,") and ")+"previous value (".concat(this.shape,") must match"));AE().disposeTensor(this),this.dataId=e.dataId,AE().incRef(this,null)}dispose(){AE().disposeVariable(this),this.isDisposedInternal=!0}}var PE,ME,jE,BE,zE;Object.defineProperty(LE,Symbol.hasInstance,{value:e=>e instanceof FE&&null!=e.assign&&e.assign instanceof Function}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(PE||(PE={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(ME||(ME={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(jE||(jE={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(BE||(BE={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(zE||(zE={}));const WE={float32:BE,int32:ME,bool:jE,complex64:zE};function UE(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error("Can not upcast ".concat(e," with ").concat(t))}return WE[e][t]}function VE(e){return UE(e,"int32")}function HE(e){return null!=e&&"object"===typeof e&&"texture"in e&&e.texture instanceof WebGLTexture}function GE(e){return"undefined"!==typeof GPUBuffer&&null!=e&&"object"===typeof e&&"buffer"in e&&e.buffer instanceof GPUBuffer}function qE(e,t){if(e.dtype===t.dtype)return[e,t];const n=UE(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function KE(e,t){return t.some(t=>t.id===e.id)}function XE(e){const t=[];return YE(e,t,new Set),t}function YE(e,t,n){if(null==e)return;if(e instanceof FE)return void t.push(e);if(r=e,!Array.isArray(r)&&"object"!==typeof r)return;var r;const a=e;for(const i in a){const e=a[i];n.has(e)||(n.add(e),YE(e,t,n))}}function $E(e){return null!=e.kernelName}class JE{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class QE{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new JE}async ready(){if(null!=this.pendingBackendInit)return this.pendingBackendInit.then(()=>{});if(null!=this.backendInstance)return;const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const n=e[t];if(await this.initializeBackend(n).success)return void await this.setBackend(n)}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(null!=this.pendingBackendInit)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make ")+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){const{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error("The highest priority backend '".concat(e,"' has not yet been ")+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;{const{asyncInit:t}=this.initializeBackend(e);if(t)return null}}return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e in this.registryFactory?(VC("".concat(e," backend was already registered. ")+"Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}async setBackend(e){if(null==this.registryFactory[e])throw new Error("Backend name '".concat(e,"' not found in registry"));if(this.backendName=e,null==this.registry[e]){this.backendInstance=null;const{success:t,asyncInit:n}=this.initializeBackend(e);if(!(n?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new wE(this.backendInstance),!0}setupRegisteredKernels(){YC(this.backendName).forEach(e=>{null!=e.setupFunc&&e.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){YC(e).forEach(t=>{null!=t.disposeFunc&&t.disposeFunc(this.registry[e])})}initializeBackend(e){const t=this.registryFactory[e];if(null==t)throw new Error("Cannot initialize backend ".concat(e,", no registration found."));try{const n=t.factory();if(!n||n instanceof Ww||"function"!==typeof n.then)return this.registry[e]=n,{success:!0,asyncInit:!1};{const t=++this.pendingBackendInitId,r=n.then(n=>!(t<this.pendingBackendInitId)&&(this.registry[e]=n,this.pendingBackendInit=null,!0)).catch(n=>(t<this.pendingBackendInitId||(this.pendingBackendInit=null,VC("Initialization of backend ".concat(e," failed")),VC(n.stack||n.message)),!1));return this.pendingBackendInit=r,{success:r,asyncInit:!0}}}catch(n){return VC("Initialization of backend ".concat(e," failed")),VC(n.stack||n.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error("".concat(e," backend not found in registry"));this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const n=e[t],{success:r,asyncInit:a}=this.initializeBackend(n);if(a||r)return{name:n,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){const n=this.state.tensorInfo.get(t),r=n.backend,a=this.readSync(t),i=r.refCount(t);r.disposeData(t,!0),n.backend=e,e.move(t,a,n.shape,n.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let n,r=null;if(null==t){if("function"!==typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!==typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!==typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}return this.scopedRun(()=>this.startScope(r),()=>this.endScope(n),()=>(n=t(),n instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n))}scopedRun(e,t,n){e();try{const e=n();return t(),e}catch(r){throw t(),r}}nextTensorId(){return QE.nextTensorId++}nextVariableId(){return QE.nextVariableId++}clone(e){const t=e_.runKernel(KN,{x:e}),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],e=>({x:()=>{const t={x:e},n={dtype:"float32"};return e_.runKernel(tN,t,n)}}),[],{}),t}runKernel(e,t,n){null==this.backendName&&this.backend;if(!(null!=KC(e,this.backendName)))throw new Error("Kernel '".concat(e,"' not registered for backend '").concat(this.backendName,"'"));return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,n){const r=this.backend.numDataIds();let a=0;n.forEach(e=>{a+="complex64"===e.dtype?3:1});const i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-t-a-i;if(o>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak ")+"(".concat(o," data ids) after running '").concat(e,"'"))}runKernelFunc(e){let t,n=[];const r=this.isTapeOn(),a=this.state.numBytes,i=this.state.numTensors;let o,s;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;const l=$E(e)?e.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if($E(e)){const{kernelName:t,inputs:a,attrs:i}=e;null==this.backendName&&this.backend;const l=KC(t,this.backendName);Kw(null!=l,()=>"Cannot find registered kernel '".concat(t,"' for backend '").concat(this.backendName,"'")),o=()=>{const e=this.backend.numDataIds();s=l.kernelFunc({inputs:a,attrs:i,backend:this.backend});const o=Array.isArray(s)?s:[s];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(t,e,o);const c=o.map(e=>null!=e.rank?e:this.makeTensorFromTensorInfo(e));if(r){const e=this.getTensorsForGradient(t,a,c);n=this.saveTensorsForBackwardMode(e)}return c}}else{const{forwardFunc:t}=e,a=e=>{r&&(n=e.map(e=>this.keep(this.clone(e))))};o=()=>{const e=this.backend.numDataIds();s=this.tidy(()=>t(this.backend,a));const n=Array.isArray(s)?s:[s];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(l,e,n),n}}const{inputs:c,attrs:u}=e,h=$E(e)?null:e.backwardsFunc;let d;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{this.ENV.getBool("DEBUG")||this.state.profiling?(d=this.profiler.profileKernel(l,c,()=>o()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(d),t=d.outputs):t=o()}),r&&this.addTapeNode(l,c,t,h,n,u),this.state.profiling&&this.state.activeProfile.kernels.push({name:l,bytesAdded:this.state.numBytes-a,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map(e=>null!=c[e]?c[e].shape:null),outputShapes:t.map(e=>e.shape),kernelTimeMs:d.timeMs,extraInfo:d.extraInfo}),Array.isArray(s)?t:t[0]}saveTensorsForBackwardMode(e){return e.map(e=>this.keep(this.clone(e)))}getTensorsForGradient(e,t,n){const r=XC(e);if(null!=r){const e=r.inputsToSave||[],a=r.outputsToSave||[];let i;r.saveAllInputs?(Kw(Array.isArray(t),()=>"saveAllInputs is true, expected inputs to be an array."),i=Object.keys(t).map(e=>t[e])):i=e.map(e=>t[e]);const o=n.filter((e,t)=>a[t]);return i.concat(o)}return[]}makeTensor(e,t,n,r){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;let a=e;"string"===n&&ck(e[0])&&(a=e.map(e=>vE(e)));const i=r.write(a,t,n),o=new FE(t,n,i,this.nextTensorId());if(this.trackTensor(o,r),"string"===n){const e=this.state.tensorInfo.get(i),t=function(e){if(null==e)return 0;let t=0;return e.forEach(e=>t+=e.length),t}(a);this.state.numBytes+=t-e.bytes,e.bytes=t}return o}makeTensorFromDataId(e,t,n,r){const a={dataId:e,shape:t,dtype:n=n||"float32"};return this.makeTensorFromTensorInfo(a,r)}makeTensorFromTensorInfo(e,t){const{dataId:n,shape:r,dtype:a}=e,i=new FE(r,a,n,this.nextTensorId());return this.trackTensor(i,t),i}makeVariable(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.cast(r));const a=new LE(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[a.name])throw new Error("Variable with name ".concat(a.name," was already registered"));return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}trackTensor(e,t){this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++;let n=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(n=e.size*lk(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof LE||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,"string"===e.dtype&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),"complex64"!==e.dtype&&"string"!==e.dtype){const t=e.size*lk(e.dtype);this.state.numBytes-=t}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const t=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(e=>e.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(e,t,n,r,a,i){const o={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:a},s=XC(e);null!=s&&(r=s.gradFunc),null!=r&&(o.gradient=e=>(e=e.map((e,t)=>{if(null==e){const e=n[t],r=bk(e.size,e.dtype);return this.makeTensor(r,e.shape,e.dtype)}return e}),r(e.length>1?e:e[0],a,i))),this.state.activeTape.push(o)}keep(e){return e.kept=!0,e}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){const t=XE(e),n=new Set(t.map(e=>e.id));for(let a=0;a<this.state.activeScope.track.length;a++){const e=this.state.activeScope.track[a];e.kept||n.has(e.id)||e.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(e=>{e.kept||e.scopeId!==r.id||this.track(e)})}gradients(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(Kw(t.length>0,()=>"gradients() received an empty list of xs."),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));const a=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));Kw(a instanceof FE,()=>"The result y returned by f() must be a tensor.");const i=function(e,t,n){const r={},a={};for(let l=0;l<t.length;l++)r[t[l].id]=!0;for(let l=0;l<e.length;l++){const n=e[l],i=n.inputs;for(const e in i){const o=i[e];let s=!1;for(let e=0;e<t.length;e++)if(r[o.id]){n.outputs.forEach(e=>r[e.id]=!0),s=!0,a[n.id]=!0;break}if(s)break}}const i={};i[n.id]=!0;const o={};for(let l=e.length-1;l>=0;l--){const t=e[l],n=t.inputs;for(let e=0;e<t.outputs.length;e++)if(i[t.outputs[e].id]){for(const e in n)i[n[e].id]=!0,o[t.id]=!0;break}}const s=[];for(let l=0;l<e.length;l++){const t=e[l];if(a[t.id]&&o[t.id]){const e={};for(const a in t.inputs){const n=t.inputs[a];r[n.id]&&(e[a]=n)}const n=Object.assign({},t);n.inputs=e,n.outputs=t.outputs,s.push(n)}}return s}(this.state.activeTape,t,a);if(!r&&0===i.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const e={};e[a.id]=null==n?function(e){const t=vk($w(e),"float32");return e_.makeTensor(t,e,"float32")}(a.shape):n,function(e,t,n,r){for(let a=t.length-1;a>=0;a--){const i=t[a],o=[];if(i.outputs.forEach(t=>{const n=e[t.id];null!=n?o.push(n):o.push(null)}),null==i.gradient)throw new Error("Cannot compute gradient: gradient function not found "+"for ".concat(i.kernelName,"."));const s=i.gradient(o);for(const t in i.inputs){if(!(t in s))throw new Error("Cannot backprop through input ".concat(t,". ")+"Available gradients found: ".concat(Object.keys(s),"."));const a=n(()=>s[t]());if("float32"!==a.dtype)throw new Error("Error in gradient for op ".concat(i.kernelName,". The gradient of input ")+"".concat(t," must have 'float32' dtype, but has '").concat(a.dtype,"'"));const o=i.inputs[t];if(!Jw(a.shape,o.shape))throw new Error("Error in gradient for op ".concat(i.kernelName,". The gradient of input ")+"'".concat(t,"' has shape '").concat(a.shape,"', which does not match ")+"the shape of the input '".concat(o.shape,"'"));if(null==e[o.id])e[o.id]=a;else{const t=e[o.id];e[o.id]=r(t,a),t.dispose()}}}}(e,i,e=>this.tidy(e),t_);const r=t.map(t=>e[t.id]);return 0===this.state.gradientDepth&&(this.state.activeTape.forEach(e=>{for(const t of e.saved)t.dispose()}),this.state.activeTape=null),{value:a,grads:r}})}customGrad(e){var t=this;return Kw(dk(e),()=>"The f passed in customGrad(f) must be a function."),function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];let i;Kw(r.every(e=>e instanceof FE),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");const o={};r.forEach((e,t)=>{o[t]=e});return t.runKernelFunc({forwardFunc:(t,n)=>(i=e(...r,n),Kw(i.value instanceof FE,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),Kw(dk(i.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),i.value),backwardsFunc:(e,t)=>{const n=i.gradFunc(e,t),a=Array.isArray(n)?n:[n];Kw(a.length===r.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),Kw(a.every(e=>e instanceof FE),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const o={};return a.forEach((e,t)=>{o[t]=()=>e}),o},inputs:o})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){const t=mE(),n=await this.backend.time(e);return n.wallMs=mE()-t,n}track(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new JE;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}function ZE(){const e=Ak();if(null==e._tfengine){const t=new Ck(e);e._tfengine=new QE(t)}return function(e){Tk=e}(e._tfengine.ENV),function(e){AE=e}(()=>e._tfengine),e._tfengine}QE.nextTensorId=0,QE.nextVariableId=0;const e_=ZE();function t_(e,t){const n={a:e,b:t};return e_.runKernel(Lk,n)}let n_;function r_(e){if(void 0!==n_)return n_;if(e||"undefined"!==typeof navigator&&null!=navigator){if(e||(e=navigator),"ReactNative"===e.product)return!0;const t=e.userAgent||e.vendor||("undefined"!==typeof window?window.opera:"");if(!t){const t=e;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function a_(){return"undefined"!==typeof window&&null!=window.document||"undefined"!==typeof WorkerGlobalScope}const i_=_k();function o_(e,t){let n=e;if(xE(e))return"string"===t?[]:[e.length];if(HE(e)){const t=e.channels||"RGBA";return[e.height,e.width*t.length]}if(GE(e))return[e.buffer.size/(null==t?4:lk(t))];if(!Array.isArray(e))return[];const r=[];for(;Array.isArray(n)||xE(n)&&"string"!==t;)r.push(n.length),n=n[0];return Array.isArray(e)&&_k().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&s_(e,r,[]),r}function s_(e,t,n){if(n=n||[],!Array.isArray(e)&&!xE(e))return void Kw(0===t.length,()=>"Element arr[".concat(n.join("]["),"] is a primitive, ")+"but should be an array/TypedArray of ".concat(t[0]," elements"));Kw(t.length>0,()=>"Element arr[".concat(n.join("]["),"] should be a primitive, ")+"but is an array of ".concat(e.length," elements")),Kw(e.length===t[0],()=>"Element arr[".concat(n.join("]["),"] should have ").concat(t[0]," ")+"elements, but has ".concat(e.length," elements"));const r=t.slice(1);for(let a=0;a<e.length;++a)s_(e[a],r,n.concat(a))}function l_(e,t,n,r){if("string_or_numeric"!==e){if(null==e)throw new Error("Expected dtype cannot be null.");if("numeric"!==e&&e!==t||"numeric"===e&&"string"===t)throw new Error("Argument '".concat(n,"' passed to '").concat(r,"' must ")+"be ".concat(e," tensor, but got ").concat(t," tensor"))}}function c_(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(e instanceof OE())return l_(r,e.dtype,t,n),e;let a=hk(e);if("string"!==a&&["bool","int32","float32"].indexOf(r)>=0&&(a=r),l_(r,a,t,n),null==e||!xE(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e){const r=null==e?"null":e.constructor.name;throw new Error("Argument '".concat(t,"' passed to '").concat(n,"' must be a ")+"Tensor or TensorLike, but got '".concat(r,"'"))}const i=o_(e,a);xE(e)||Array.isArray(e)||(e=[e]);const o="string"!==a?gE(e,a):yE(e,[],!0);return e_.makeTensor(o,i,a)}function u_(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(!Array.isArray(e))throw new Error("Argument ".concat(t," passed to ").concat(n," must be a ")+"`Tensor[]` or `TensorLike[]`");return e.map((e,a)=>c_(e,"".concat(t,"[").concat(a,"]"),n,r))}i_.registerFlag("DEBUG",()=>!1,e=>{e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),i_.registerFlag("IS_BROWSER",()=>a_()),i_.registerFlag("IS_NODE",()=>"undefined"!==typeof process&&"undefined"!==typeof process.versions&&"undefined"!==typeof process.versions.node),i_.registerFlag("IS_CHROME",()=>"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)),i_.registerFlag("IS_SAFARI",()=>"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor)),i_.registerFlag("PROD",()=>!1),i_.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>i_.getBool("DEBUG")),i_.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0),i_.registerFlag("IS_TEST",()=>!1),i_.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>i_.getBool("DEBUG")),i_.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1),i_.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1),i_.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);function h_(e){const t=Object.keys(e);if(1!==t.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+"".concat(t.length," keys."));let n=t[0];const r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+="__op";const a=function(){e_.startScope(n);try{const e=r(...arguments);return Nk(e)&&console.error("Cannot return a Promise inside of tidy."),e_.endScope(e),e}catch(e){throw e_.endScope(null),e}};return Object.defineProperty(a,"name",{value:n,configurable:!0}),a}const d_=h_({complex_:function(e,t){const n=c_(e,"real","complex"),r=c_(t,"imag","complex");Xw(n.shape,r.shape,"real and imag shapes, ".concat(n.shape," and ").concat(r.shape,", ")+"must match in call to tf.complex().");const a={real:n,imag:r};return e_.runKernel(aN,a)}});function f_(e,t,n,r){if(null==r)r=hk(e);else if("complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(GE(e)||HE(e)){if("float32"!==r&&"int32"!==r)throw new Error("Creating tensor from GPU data only supports "+"'float32'|'int32' dtype, while the dtype is ".concat(r,"."));return e_.backend.createTensorFromGPUData(e,t||n,r)}if(!xE(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){yk(t);const e=$w(t),r=$w(n);Kw(e===r,()=>"Based on the provided shape, [".concat(t,"], the tensor should have ")+"".concat(e," values but has ").concat(r));for(let a=0;a<n.length;++a){const e=n[a],r=a!==n.length-1||e!==$w(t.slice(a));Kw(n[a]===t[a]||!r,()=>"Error creating a new Tensor. Inferred shape "+"(".concat(n,") does not match the provided ")+"shape (".concat(t,"). "))}}return xE(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==r?gE(e,r):yE(e,[],!0),e_.makeTensor(e,t,r)}function p_(e,t,n){return f_(e,t,o_(e,n),n)}class g_{static join(e){return new g_(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,null==e)return;if(e instanceof Array||(e=[e]),0===(e=e.map(e=>xE(e)?e.buffer:e)).length)return;this.bufferUniformSize=e[0].byteLength;let t=0;for(let n=0;n<e.length;n++){const r=e[n];n!==e.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const a=t+r.byteLength;this.shards.push({buffer:r,start:t,end:a}),t=a}0===this.shards.length&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.byteLength;if(0===this.shards.length)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,t=isNaN(Number(t))?0:t,e=Math.max(0,e),t=Math.min(this.byteLength,t),t<=e)return new ArrayBuffer(0);const n=this.findShardForByte(e);if(-1===n)throw new Error("Could not find start shard for byte ".concat(e));const r=new ArrayBuffer(t-e),a=new Uint8Array(r);let i=0;for(let o=n;o<this.shards.length;o++){const n=this.shards[o],r=e+i-n.start,s=i,l=Math.min(t,n.end)-n.start,c=new Uint8Array(n.buffer,r,l-r);if(a.set(c,s),i+=c.length,t<n.end)break}return r}findShardForByte(e){if(0===this.shards.length||e<0||e>=this.byteLength)return-1;if(null!=this.bufferUniformSize)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function t(t){return e<t.start?-1:e>=t.end?1:0}if(0===t(this.shards[this.previousShardIndex]))return this.previousShardIndex;const n=function(e,t){let n=0,r=e.length;for(;n<=r;){const a=Math.floor((r-n)/2)+n,i=t(e[a]);if(0===i)return a;i<0?r=a:n=a+1}return-1}(this.shards,t);return-1===n?-1:(this.previousShardIndex=n,this.previousShardIndex)}}function m_(){return e_}function v_(){return e_.memory()}function b_(e,t){return e_.tidy(e,t)}function x_(e){XE(e).forEach(e=>e.dispose())}function y_(e){return e_.keep(e)}function w_(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e_.registerBackend(e,t,n)}function k_(){return e_.backend}!function(e){DE=e}(function(e){_k().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")});async function N_(e,t){const n=[],r=[],a=Array.isArray(e)?e.map(e=>e.name):Object.keys(e);for(let i=0;i<a.length;++i){const o=a[i],s=Array.isArray(e)?e[i].tensor:e[o];if("float32"!==s.dtype&&"int32"!==s.dtype&&"bool"!==s.dtype&&"string"!==s.dtype&&"complex64"!==s.dtype)throw new Error("Unsupported dtype in weight '".concat(o,"': ").concat(s.dtype));const l={name:o,shape:s.shape,dtype:s.dtype};if("string"===s.dtype){const e=new Promise(async e=>{const t=await s.bytes(),n=t.reduce((e,t)=>e+t.length,0)+4*t.length,r=new Uint8Array(n);let a=0;for(let i=0;i<t.length;i++){const e=t[i],n=new Uint8Array(new Uint32Array([e.length]).buffer);r.set(n,a),a+=4,r.set(e,a),a+=e.length}e(r)});r.push(e)}else r.push(s.data());null!=t&&(l.group=t),n.push(l)}return{data:S_(await Promise.all(r)),specs:n}}function S_(e){if(null===e)throw new Error("Invalid input value: ".concat(JSON.stringify(e)));let t=0;const n=[];e.forEach(e=>{if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: ".concat(e.constructor.name))});const r=new Uint8Array(t);let a=0;return n.forEach(e=>{r.set(new Uint8Array(e.buffer),a),a+=e.byteLength}),r.buffer}const C_="undefined"!==typeof Buffer&&("undefined"===typeof Blob||"undefined"===typeof atob||"undefined"===typeof btoa);function E_(e){return C_?Buffer.byteLength(e,"utf8"):new Blob([e]).size}function __(e,t){const n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return null!=e.signature&&(n.signature=e.signature),null!=e.userDefinedMetadata&&(n.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(n.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(n.initializerSignature=e.initializerSignature),null!=e.trainingConfig&&(n.trainingConfig=e.trainingConfig),n}async function I_(e,t){let n,r;return null!=e.weightsManifest&&([n,r]=await t(e.weightsManifest)),function(e,t,n){const r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(null!=e.trainingConfig&&(r.trainingConfig=e.trainingConfig),null!=e.weightsManifest){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=t,r.weightData=n}return null!=e.signature&&(r.signature=e.signature),null!=e.userDefinedMetadata&&(r.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(r.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(r.initializerSignature=e.initializerSignature),r}(e,n,r)}function T_(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:E_(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:E_(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:new g_(e.weightData).byteLength}}function A_(e){const t=[];for(const n of e)t.push(...n.weights);return t}class R_{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==R_.instance&&(R_.instance=new R_),R_.instance}static registerSaveRouter(e){R_.getInstance().saveRouters.push(e)}static registerLoadRouter(e){R_.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return R_.getHandlers(e,"save")}static getLoadHandlers(e,t){return R_.getHandlers(e,"load",t)}static getHandlers(e,t,n){const r=[];return("load"===t?R_.getInstance().loadRouters:R_.getInstance().saveRouters).forEach(t=>{const a=t(e,n);null!==a&&r.push(a)}),r}}const D_="tensorflowjs",F_="models_store",O_="model_info_store";function L_(){if(!_k().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const e="undefined"===typeof window?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function P_(e){const t=e.result;t.createObjectStore(F_,{keyPath:"modelPath"}),t.createObjectStore(O_,{keyPath:"modelPath"})}class M_{constructor(e){if(this.indexedDB=L_(),null==e||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((e,n)=>{const r=this.indexedDB.open(D_,1);r.onupgradeneeded=()=>P_(r),r.onsuccess=()=>{const a=r.result;if(null==t){const t=a.transaction(F_,"readonly"),r=t.objectStore(F_).get(this.modelPath);r.onsuccess=()=>{if(null==r.result)return a.close(),n(new Error("Cannot find model with path '".concat(this.modelPath,"' ")+"in IndexedDB."));e(r.result.modelArtifacts)},r.onerror=e=>(a.close(),n(r.error)),t.oncomplete=()=>a.close()}else{t.weightData=g_.join(t.weightData);const r=T_(t),o=a.transaction(O_,"readwrite");let s,l,c=o.objectStore(O_);try{s=c.put({modelPath:this.modelPath,modelArtifactsInfo:r})}catch(i){return n(i)}s.onsuccess=()=>{l=a.transaction(F_,"readwrite");const s=l.objectStore(F_);let u;try{u=s.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:r})}catch(i){return n(i)}u.onsuccess=()=>e({modelArtifactsInfo:r}),u.onerror=e=>{c=o.objectStore(O_);const t=c.delete(this.modelPath);t.onsuccess=()=>(a.close(),n(u.error)),t.onerror=e=>(a.close(),n(u.error))}},s.onerror=e=>(a.close(),n(s.error)),o.oncomplete=()=>{null==l?a.close():l.oncomplete=()=>a.close()}}},r.onerror=e=>n(r.error)})}}M_.URL_SCHEME="indexeddb://";const j_=e=>{return _k().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(M_.URL_SCHEME)?(t=e.slice(M_.URL_SCHEME.length),new M_(t)):null;var t};R_.registerSaveRouter(j_),R_.registerLoadRouter(j_);class B_{constructor(){this.indexedDB=L_()}async listModels(){return new Promise((e,t)=>{const n=this.indexedDB.open(D_,1);n.onupgradeneeded=()=>P_(n),n.onsuccess=()=>{const r=n.result,a=r.transaction(O_,"readonly"),i=a.objectStore(O_).getAll();i.onsuccess=()=>{const t={};for(const e of i.result)t[e.modelPath]=e.modelArtifactsInfo;e(t)},i.onerror=e=>(r.close(),t(i.error)),a.oncomplete=()=>r.close()},n.onerror=e=>t(n.error)})}async removeModel(e){var t;return e=(t=e).startsWith(M_.URL_SCHEME)?t.slice(M_.URL_SCHEME.length):t,new Promise((t,n)=>{const r=this.indexedDB.open(D_,1);r.onupgradeneeded=()=>P_(r),r.onsuccess=()=>{const a=r.result,i=a.transaction(O_,"readwrite"),o=i.objectStore(O_),s=o.get(e);let l;s.onsuccess=()=>{if(null==s.result)return a.close(),n(new Error("Cannot find model with path '".concat(e,"' ")+"in IndexedDB."));{const r=o.delete(e),i=()=>{l=a.transaction(F_,"readwrite");const r=l.objectStore(F_).delete(e);r.onsuccess=()=>t(s.result.modelArtifactsInfo),r.onerror=e=>n(s.error)};r.onsuccess=i,r.onerror=e=>(i(),a.close(),n(s.error))}},s.onerror=e=>(a.close(),n(s.error)),i.oncomplete=()=>{null==l?a.close():l.oncomplete=()=>a.close()}},r.onerror=e=>n(r.error)})}}const z_="/",W_="tensorflowjs_models",U_="info",V_="model_topology",H_="weight_specs",G_="weight_data",q_="model_metadata";function K_(e){return{info:[W_,e,U_].join(z_),topology:[W_,e,V_].join(z_),weightSpecs:[W_,e,H_].join(z_),weightData:[W_,e,G_].join(z_),modelMetadata:[W_,e,q_].join(z_)}}function X_(e){for(const t of Object.values(e))window.localStorage.removeItem(t)}function Y_(e){const t=e.split(z_);if(t.length<3)throw new Error("Invalid key format: ".concat(e));return t.slice(1,t.length-1).join(z_)}class $_{constructor(e){if(!_k().getBool("IS_BROWSER")||"undefined"===typeof window||"undefined"===typeof window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=K_(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),a=T_(e),i=g_.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(e){if(C_)return Buffer.from(e).toString("base64");const t=new Uint8Array(e);let n="";for(let r=0,a=t.length;r<a;r++)n+=String.fromCharCode(t[r]);return btoa(n)}(i));const t={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:null!=e.signature?e.signature:void 0,userDefinedMetadata:null!=e.userDefinedMetadata?e.userDefinedMetadata:void 0,modelInitializer:null!=e.modelInitializer?e.modelInitializer:void 0,initializerSignature:null!=e.initializerSignature?e.initializerSignature:void 0,trainingConfig:null!=e.trainingConfig?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(t)),{modelArtifactsInfo:a}}catch(t){throw X_(this.keys),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: ")+"size quota being exceeded is a possible cause of this failure: "+"modelTopologyBytes=".concat(a.modelTopologyBytes,", ")+"weightSpecsBytes=".concat(a.weightSpecsBytes,", ")+"weightDataBytes=".concat(a.weightDataBytes,"."))}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(null==e)throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));if("JSON"!==e.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const t={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(null==n)throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' ")+"is missing.");t.modelTopology=n;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(null==r)throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' ")+"are missing.");t.weightSpecs=r;const a=this.LS.getItem(this.keys.modelMetadata);if(null!=a){const e=JSON.parse(a);t.format=e.format,t.generatedBy=e.generatedBy,t.convertedBy=e.convertedBy,null!=e.signature&&(t.signature=e.signature),null!=e.userDefinedMetadata&&(t.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(t.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(t.initializerSignature=e.initializerSignature),null!=e.trainingConfig&&(t.trainingConfig=e.trainingConfig)}const i=this.LS.getItem(this.keys.weightData);if(null==i)throw new Error("In local storage, the binary weight values of model "+"'".concat(this.modelPath,"' are missing."));return t.weightData=function(e){if(C_){const t=Buffer.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}const t=atob(e),n=new Uint8Array(t.length);for(let r=0;r<t.length;++r)n.set([t.charCodeAt(r)],r);return n.buffer}(i),t}}$_.URL_SCHEME="localstorage://";const J_=e=>{return _k().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith($_.URL_SCHEME)?(t=e.slice($_.URL_SCHEME.length),new $_(t)):null;var t};R_.registerSaveRouter(J_),R_.registerLoadRouter(J_);class Q_{constructor(){Kw(_k().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),Kw("undefined"===typeof window||"undefined"!==typeof window.localStorage,()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},t=W_+z_,n=z_+U_;for(let r=0;r<this.LS.length;++r){const a=this.LS.key(r);if(a.startsWith(t)&&a.endsWith(n)){e[Y_(a)]=JSON.parse(this.LS.getItem(a))}}return e}async removeModel(e){var t;const n=K_(e=(t=e).startsWith($_.URL_SCHEME)?t.slice($_.URL_SCHEME.length):t);if(null==this.LS.getItem(n.info))throw new Error("Cannot find model at path '".concat(e,"'"));const r=JSON.parse(this.LS.getItem(n.info));return X_(n),r}}const Z_="://";class eI{constructor(){this.managers={}}static getInstance(){return null==eI.instance&&(eI.instance=new eI),eI.instance}static registerManager(e,t){Kw(null!=e,()=>"scheme must not be undefined or null."),e.endsWith(Z_)&&(e=e.slice(0,e.indexOf(Z_))),Kw(e.length>0,()=>"scheme must not be an empty string.");const n=eI.getInstance();Kw(null==n.managers[e],()=>"A model store manager is already registered for scheme '".concat(e,"'.")),n.managers[e]=t}static getManager(e){const t=eI.getInstance().managers[e];if(null==t)throw new Error("Cannot find model manager for scheme '".concat(e,"'"));return t}static getSchemes(){return Object.keys(eI.getInstance().managers)}}class tI{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Browser's encoder only supports utf-8, but got ".concat(t));return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){"undefined"!==typeof window&&_k().getBool("USE_SETTIMEOUTCUSTOM")?(this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",e=>{if(e.source===window&&e.data.name===this.messageName){e.stopPropagation();(0,this.functionRefs[e.data.index])(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))):setTimeout(e,t)}isTypedArray(e){return ZC(e)}}if(_k().get("IS_BROWSER")){_k().setPlatform("browser",new tI);try{eI.registerManager($_.URL_SCHEME,new Q_)}catch(gfe){}try{eI.registerManager(M_.URL_SCHEME,new B_)}catch(gfe){}}const nI=()=>n(5817);let rI;class aI{constructor(){this.util=n(8590),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return null!=_k().global.fetch?_k().global.fetch(e,t):(null==rI&&(rI=nI()),rI(e,t))}now(){const e=process.hrtime();return 1e3*e[0]+e[1]/1e6}encode(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Node built-in encoder only supports utf-8, but got ".concat(t));return this.textEncoder.encode(e)}decode(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}function iI(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2?arguments[2]:void 0;return t=t||"float32",yk(e),new TE(e,t,n)}_k().get("IS_NODE")&&!_k().get("IS_BROWSER")&&_k().setPlatform("node",new aI);const oI=h_({cast_:function(e,t){const n=c_(e,"x","cast");if(!function(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}(t))throw new Error("Failed to cast to unknown dtype ".concat(t));if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");const r={x:n},a={dtype:t};return e_.runKernel(tN,r,a)}});const sI=h_({clone_:function(e){const t={x:c_(e,"x","clone","string_or_numeric")};return e_.runKernel(KN,t)}});ZE();const lI={buffer:iI,cast:oI,clone:sI,print:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(e.toString(t))}};RE=lI;const cI=h_({add_:function(e,t){let n=c_(e,"a","add"),r=c_(t,"b","add");[n,r]=qE(n,r);const a={a:n,b:r};return e_.runKernel(Lk,a)}});const uI=h_({floorDiv_:function(e,t){let n=c_(e,"a","floorDiv"),r=c_(t,"b","floorDiv");[n,r]=qE(n,r);const a={a:n,b:r};return e_.runKernel(WN,a)}});const hI=h_({div_:function(e,t){let n=c_(e,"a","div"),r=c_(t,"b","div");if([n,r]=qE(n,r),"int32"===n.dtype&&"int32"===r.dtype)return uI(n,r);const a={a:n,b:r};return e_.runKernel(IN,a,{})}});const dI=h_({mul_:function(e,t){let n=c_(e,"a","mul"),r=c_(t,"b","mul");[n,r]=qE(n,r);const a={a:n,b:r};return e_.runKernel(NS,a)}});const fI=h_({sqrt_:function(e){const t={x:c_(e,"x","sqrt","float32")};return e_.runKernel(cC,t)}});const pI=h_({square_:function(e){const t=c_(e,"x","square");return e_.runKernel("Square",{x:t},{})}});const gI=h_({zerosLike_:function(e){const t={x:c_(e,"x","zerosLike")};return e_.runKernel(PC,t)}});function mI(e){return e_.customGrad(e)}function vI(e,t){if((xE(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&xE(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return f_(e,[],[],t)}const bI=new Map,xI=new Map;class yI{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}}class wI{constructor(){this.classNameMap={}}static getMap(){return null==wI.instance&&(wI.instance=new wI),wI.instance}static register(e){wI.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function kI(e,t,n){Kw(null!=e.className,()=>"Class being registered does not have the static className property defined."),Kw("string"===typeof e.className,()=>"className is required to be a string, but got type "+typeof e.className),Kw(e.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),"undefined"===typeof t&&(t="Custom"),"undefined"===typeof n&&(n=e.className);const r=t+">"+n;return wI.register(e),bI.set(r,e),xI.set(e,r),e}class NI extends yI{minimize(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;const{value:r,grads:a}=this.computeGradients(e,n);if(null!=n){const e=n.map(e=>({name:e.name,tensor:a[e.name]}));this.applyGradients(e)}else this.applyGradients(a);return x_(a),t?r:(r.dispose(),null)}get iterations(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return function(e,t){Kw(dk(e),()=>"The f passed in variableGrads(f) must be a function"),Kw(null==t||Array.isArray(t)&&t.every(e=>e instanceof LE),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=null!=t;if(!n){t=[];for(const e in e_.registeredVariables)t.push(e_.registeredVariables[e])}const r=n?t.filter(e=>!e.trainable):null,a=t.length;t=t.filter(e=>e.trainable),Kw(t.length>0,()=>"variableGrads() expects at least one of the input variables to "+"be trainable, but none of the ".concat(a," variables is ")+"trainable.");const{value:i,grads:o}=e_.gradients(e,t,null,!0);Kw(o.some(e=>null!=e),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),Kw(0===i.rank,()=>"The f passed in variableGrads(f) must return a scalar, but it "+"returned a rank-".concat(i.rank," tensor"));const s={};return t.forEach((e,t)=>{null!=o[t]&&(s[e.name]=o[t])}),null!=r&&r.forEach(e=>s[e.name]=null),{value:i,grads:s}}(e,t)}dispose(){null!=this.iterations_&&x_(this.iterations_)}async saveIterations(){return null==this.iterations_&&(this.iterations_=0),{name:"iter",tensor:vI(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for this optimizer class "+"".concat(this.getClassName()))}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(NI,Symbol.hasInstance,{value:e=>null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients});class SI extends NI{static get className(){return"Adadelta"}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(),this.learningRate=e,this.rho=t,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],null==n&&(this.epsilon=e_.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{const r=e_.registeredVariables[t],a=!1;null==this.accumulatedGrads[n]&&(this.accumulatedGrads[n]={originalName:"".concat(t,"/accum_grad"),variable:b_(()=>gI(r).variable(a))}),null==this.accumulatedUpdates[n]&&(this.accumulatedUpdates[n]={originalName:"".concat(t,"/accum_var"),variable:b_(()=>gI(r).variable(a))});const i=Array.isArray(e)?e[n].tensor:e[t];if(null==i)return;const o=this.accumulatedGrads[n].variable,s=this.accumulatedUpdates[n].variable;b_(()=>{const e=cI(dI(o,this.rho),dI(pI(i),1-this.rho)),t=dI(hI(fI(cI(s,this.epsilon)),fI(cI(o,this.epsilon))),i),n=cI(dI(s,this.rho),dI(pI(t),1-this.rho));o.assign(e),s.assign(n);const a=cI(dI(t,-this.learningRate),r);r.assign(a)})}),this.incrementIterations()}dispose(){null!=this.accumulatedUpdates&&(x_(this.accumulatedGrads.map(e=>e.variable)),x_(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){const t=(e=await this.extractIterations(e)).length/2,n=!1;this.accumulatedGrads=e.slice(0,t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)})),this.accumulatedUpdates=e.slice(t,2*t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}function CI(e,t,n){yk(e);const r={shape:e,value:t,dtype:n=n||hk(t)};return e_.runKernel(jN,{},r)}class EI extends NI{static get className(){return"Adagrad"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{const r=e_.registeredVariables[t];if(null==this.accumulatedGrads[n]){const e=!1;this.accumulatedGrads[n]={originalName:"".concat(t,"/accumulator"),variable:b_(()=>CI(r.shape,this.initialAccumulatorValue).variable(e))}}const a=Array.isArray(e)?e[n].tensor:e[t];if(null==a)return;const i=this.accumulatedGrads[n].variable;b_(()=>{const e=cI(i,pI(a));i.assign(e);const t=cI(dI(hI(a,fI(cI(e,e_.backend.epsilon()))),-this.learningRate),r);r.assign(t)})}),this.incrementIterations()}dispose(){null!=this.accumulatedGrads&&x_(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);this.accumulatedGrads=e.map(e=>({originalName:e.name,variable:e.tensor.variable(false)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}const _I=h_({pow_:function(e,t){let n=c_(e,"base","pow"),r=c_(t,"exp","pow");[n,r]=qE(n,r);const a={a:n,b:r};return e_.runKernel(FS,a)}});const II=h_({sub_:function(e,t){let n=c_(e,"a","sub"),r=c_(t,"b","sub");[n,r]=qE(n,r);const a={a:n,b:r};return e_.runKernel(EC,a)}});class TI extends NI{static get className(){return"Adam"}constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],b_(()=>{this.accBeta1=vI(t).variable(),this.accBeta2=vI(n).variable()}),null==r&&(this.epsilon=e_.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(e=>e.name):Object.keys(e);b_(()=>{const n=II(1,this.accBeta1),r=II(1,this.accBeta2);t.forEach((t,a)=>{const i=e_.registeredVariables[t],o=!1;null==this.accumulatedFirstMoment[a]&&(this.accumulatedFirstMoment[a]={originalName:"".concat(t,"/m"),variable:b_(()=>gI(i).variable(o))}),null==this.accumulatedSecondMoment[a]&&(this.accumulatedSecondMoment[a]={originalName:"".concat(t,"/v"),variable:b_(()=>gI(i).variable(o))});const s=Array.isArray(e)?e[a].tensor:e[t];if(null==s)return;const l=this.accumulatedFirstMoment[a].variable,c=this.accumulatedSecondMoment[a].variable,u=cI(dI(l,this.beta1),dI(s,1-this.beta1)),h=cI(dI(c,this.beta2),dI(pI(s),1-this.beta2)),d=hI(u,n),f=hI(h,r);l.assign(u),c.assign(h);const p=cI(dI(hI(d,cI(fI(f),this.epsilon)),-this.learningRate),i);i.assign(p)}),this.accBeta1.assign(dI(this.accBeta1,this.beta1)),this.accBeta2.assign(dI(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&x_(this.accumulatedFirstMoment.map(e=>e.variable)),null!=this.accumulatedSecondMoment&&x_(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e),b_(()=>{this.accBeta1.assign(_I(this.beta1,this.iterations_+1)),this.accBeta2.assign(_I(this.beta2,this.iterations_+1))});const t=e.length/2,n=!1;this.accumulatedFirstMoment=e.slice(0,t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)})),this.accumulatedSecondMoment=e.slice(t,2*t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}const AI=h_({abs_:function(e){const t=c_(e,"x","abs");if("complex64"===t.dtype){const e={x:t};return e_.runKernel(iN,e)}{const e={x:t};return e_.runKernel(Dk,e)}}});function RI(e,t){const n=e.length,r=[];for(let a=0;a<n;a++){const i=n-1-a,o=e[i]||1;(t[t.length-1-a]||1)>1&&1===o&&r.unshift(i)}return r}function DI(e,t){const n=[];for(let r=0;r<t.length;r++){const a=e[e.length-r-1],i=t.length-r-1,o=t[i];(null==a||1===a&&o>1)&&n.unshift(i)}return n}function FI(e,t){const n=Math.max(e.length,t.length),r=new Array(n);for(let a=0;a<n;a++){let i=e[e.length-a-1];null==i&&(i=1);let o=t[t.length-a-1];if(null==o&&(o=1),1===i)r[n-a-1]=o;else if(1===o)r[n-a-1]=i;else{if(i!==o){const n="Operands could not be broadcast together with shapes "+"".concat(e," and ").concat(t,".");throw Error(n)}r[n-a-1]=i}}return r}const OI=h_({maximum_:function(e,t){let n=c_(e,"a","maximum"),r=c_(t,"b","maximum");[n,r]=qE(n,r),"bool"===n.dtype&&(n=oI(n,"int32"),r=oI(r,"int32")),FI(n.shape,r.shape);const a={a:n,b:r};return e_.runKernel(hS,a)}});class LI extends NI{static get className(){return"Adamax"}constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=r,this.decay=a,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],b_(()=>{this.iteration=vI(0).variable(),this.accBeta1=vI(t).variable()}),null==r&&(this.epsilon=e_.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(e=>e.name):Object.keys(e);b_(()=>{const n=II(1,this.accBeta1),r=hI(-this.learningRate,cI(dI(this.iteration,this.decay),1));t.forEach((t,a)=>{const i=e_.registeredVariables[t],o=!1;null==this.accumulatedFirstMoment[a]&&(this.accumulatedFirstMoment[a]={originalName:"".concat(t,"/m"),variable:gI(i).variable(o)}),null==this.accumulatedWeightedInfNorm[a]&&(this.accumulatedWeightedInfNorm[a]={originalName:"".concat(t,"/v"),variable:gI(i).variable(o)});const s=Array.isArray(e)?e[a].tensor:e[t];if(null==s)return;const l=this.accumulatedFirstMoment[a].variable,c=this.accumulatedWeightedInfNorm[a].variable,u=cI(dI(l,this.beta1),dI(s,1-this.beta1)),h=dI(c,this.beta2),d=AI(s),f=OI(h,d);l.assign(u),c.assign(f);const p=cI(dI(hI(r,n),hI(u,cI(f,this.epsilon))),i);i.assign(p)}),this.iteration.assign(cI(this.iteration,1)),this.accBeta1.assign(dI(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&x_(this.accumulatedFirstMoment.map(e=>e.variable)),null!=this.accumulatedWeightedInfNorm&&x_(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}class PI extends NI{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){const t=Array.isArray(e)?e.map(e=>e.name):Object.keys(e);t.forEach((t,n)=>{const r=Array.isArray(e)?e[n].tensor:e[t];if(null==r)return;const a=e_.registeredVariables[t];b_(()=>{const e=cI(dI(this.c,r),a);a.assign(e)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=y_(vI(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(0!==(e=await this.extractIterations(e)).length)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}}class MI extends PI{static get className(){return"Momentum"}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(e),this.learningRate=e,this.momentum=t,this.useNesterov=n,this.accumulations=[],this.m=vI(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{const r=e_.registeredVariables[t];if(null==this.accumulations[n]){const e=!1;this.accumulations[n]={originalName:"".concat(t,"/momentum"),variable:b_(()=>gI(r).variable(e))}}const a=this.accumulations[n].variable,i=Array.isArray(e)?e[n].tensor:e[t];null!=i&&b_(()=>{let e;const t=cI(dI(this.m,a),i);e=this.useNesterov?cI(dI(this.c,cI(i,dI(t,this.m))),r):cI(dI(this.c,t),r),a.assign(t),r.assign(e)})}),this.incrementIterations()}dispose(){this.m.dispose(),null!=this.accumulations&&x_(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);this.accumulations=e.map(e=>({originalName:e.name,variable:e.tensor.variable(false)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}class jI extends NI{static get className(){return"RMSProp"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(super(),this.learningRate=e,this.decay=t,this.momentum=n,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=a,null==r&&(this.epsilon=e_.backend.epsilon()),null==e)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{const r=e_.registeredVariables[t],a=!1;null==this.accumulatedMeanSquares[n]&&(this.accumulatedMeanSquares[n]={originalName:"".concat(t,"/rms"),variable:b_(()=>gI(r).variable(a))}),null==this.accumulatedMoments[n]&&(this.accumulatedMoments[n]={originalName:"".concat(t,"/momentum"),variable:b_(()=>gI(r).variable(a))}),null==this.accumulatedMeanGrads[n]&&this.centered&&(this.accumulatedMeanGrads[n]={originalName:"".concat(t,"/mg"),variable:b_(()=>gI(r).variable(a))});const i=Array.isArray(e)?e[n].tensor:e[t];if(null==i)return;const o=this.accumulatedMeanSquares[n].variable,s=this.accumulatedMoments[n].variable;b_(()=>{const e=cI(dI(o,this.decay),dI(pI(i),1-this.decay));if(this.centered){const t=this.accumulatedMeanGrads[n].variable,a=cI(dI(t,this.decay),dI(i,1-this.decay)),l=hI(dI(i,this.learningRate),fI(II(e,cI(pI(a),this.epsilon)))),c=cI(dI(s,this.momentum),l);o.assign(e),t.assign(a),s.assign(c);const u=II(r,c);r.assign(u)}else{const e=cI(dI(o,this.decay),dI(pI(i),1-this.decay)),t=cI(dI(s,this.momentum),hI(dI(i,this.learningRate),fI(cI(e,this.epsilon))));o.assign(e),s.assign(t);const n=II(r,t);r.assign(n)}})}),this.incrementIterations()}dispose(){null!=this.accumulatedMeanSquares&&x_(this.accumulatedMeanSquares.map(e=>e.variable)),null!=this.accumulatedMeanGrads&&this.centered&&x_(this.accumulatedMeanGrads.map(e=>e.variable)),null!=this.accumulatedMoments&&x_(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=this.centered?e.length/3:e.length/2,n=!1;this.accumulatedMeanSquares=e.slice(0,t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)})),this.accumulatedMoments=e.slice(t,2*t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)})),this.centered&&(this.accumulatedMeanGrads=e.slice(2*t,3*t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}const BI=[SI,EI,TI,LI,MI,jI,PI];function zI(e){return new Promise(e=>setTimeout(e)).then(e)}class WI{constructor(e){if(!_k().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(WI.URL_SCHEME)&&(e=e.slice(WI.URL_SCHEME.length)),null!=e&&0!==e.length||(e="model"),this.modelJsonFileName=e+".json",this.weightDataFileName=e+".weights.bin"}async save(e){if("undefined"===typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");const t=g_.join(e.weightData),n=window.URL.createObjectURL(new Blob([t],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const t=__(e,[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}]),r=window.URL.createObjectURL(new Blob([JSON.stringify(t)],{type:"application/json"})),a=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor;if(a.download=this.modelJsonFileName,a.href=r,await zI(()=>a.dispatchEvent(new MouseEvent("click"))),null!=e.weightData){const e=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor;e.download=this.weightDataFileName,e.href=n,await zI(()=>e.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:T_(e)}}}}WI.URL_SCHEME="downloads://";function UI(e,t,n,r){!function(e){Kw(null!=e&&Array.isArray(e)&&e.length>0,()=>"promises must be a none empty array")}(e),function(e,t){Kw(e>=0&&e<=1,()=>"Progress fraction must be in range [0, 1], but "+"got startFraction ".concat(e)),Kw(t>=0&&t<=1,()=>"Progress fraction must be in range [0, 1], but "+"got endFraction ".concat(t)),Kw(t>=e,()=>"startFraction must be no more than endFraction, but "+"got startFraction ".concat(e," and endFraction ")+"".concat(t))}(n=null==n?0:n,r=null==r?1:r);let a=0;return Promise.all(e.map(i=>(i.then(i=>{const o=n+ ++a/e.length*(r-n);return t(o),i}),i)))}async function VI(e,t){null==t&&(t={});const n=null==t.fetchFunc?_k().platform.fetch:t.fetchFunc,r=e.map(e=>n(e,t.requestInit,{isBinary:!0})),a=(null==t.onProgress?await Promise.all(r):await UI(r,t.onProgress,0,.5)).map(e=>e.arrayBuffer());return null==t.onProgress?await Promise.all(a):await UI(a,t.onProgress,.5,1)}R_.registerSaveRouter(e=>_k().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(WI.URL_SCHEME)?function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model";return new WI(e)}(e.slice(WI.URL_SCHEME.length)):null);class HI{constructor(e,t){if(this.DEFAULT_METHOD="POST",null==t&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.weightUrlConverter=t.weightUrlConverter,null!=t.fetchFunc?(Kw("function"===typeof t.fetchFunc,()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=t.fetchFunc):this.fetch=_k().platform.fetch,Kw(null!=e&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&Kw(2===e.length,()=>"URL paths for http must have a length of 2, "+"(actual length is ".concat(e.length,").")),this.path=e,null!=t.requestInit&&null!=t.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{},this.loadOptions=t}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;const n=__(e,[{paths:["./model.weights.bin"],weights:e.weightSpecs}]);if(t.body.append("model.json",new Blob([JSON.stringify(n)],{type:"application/json"}),"model.json"),null!=e.weightData){const n=g_.join(e.weightData);t.body.append("model.weights.bin",new Blob([n],{type:"application/octet-stream"}),"model.weights.bin")}const r=await this.fetch(this.path,t);if(r.ok)return{modelArtifactsInfo:T_(e),responses:[r]};throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+"".concat(r.status,"."))}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error("Request to ".concat(this.path," failed with status code ")+"".concat(e.status,". Please verify this URL points to ")+"the model JSON of the model to load.");let t;try{t=await e.json()}catch(ci){let t="Failed to parse model JSON of response from ".concat(this.path,".");throw this.path.endsWith(".pb")?t+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":t+=" Please make sure the server is serving valid JSON for this request.",new Error(t)}const n=t.modelTopology,r=t.weightsManifest;if(null==n&&null==r)throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model ")+"topology or manifest for weights.");return t}async load(){if(this.loadOptions.streamWeights)return this.loadStream();return I_(await this.loadModelJSON(),e=>this.loadWeights(e))}async loadStream(){const e=await this.loadModelJSON(),t=await this.getWeightUrls(e.weightsManifest),n=A_(e.weightsManifest);return Object.assign(Object.assign({},e),{weightSpecs:n,getWeightStream:()=>function(e,t){var n;const r=null==t.fetchFunc?_k().platform.fetch:t.fetchFunc;let a,i=0;return null===(n=t.onProgress)||void 0===n||n.call(t,0),new ReadableStream({pull:async n=>{for(var o;i<e.length;){if(!a){const n=(await r(e[i],t.requestInit,{isBinary:!0})).body;a=n.getReader()}const{done:s,value:l}=await a.read();if(!s)return void n.enqueue(l);i++,a=void 0,null===(o=t.onProgress)||void 0===o||o.call(t,i/e.length)}n.close()}})}(t,this.loadOptions)})}async getWeightUrls(e){const t=Array.isArray(this.path)?this.path[1]:this.path,[n,r]=function(e){const t=e.lastIndexOf("/"),n=e.lastIndexOf("?"),r=e.substring(0,t),a=n>t?e.substring(n):"";return[r+"/",a]}(t),a=this.weightPathPrefix||n,i=[],o=[];for(const s of e)for(const e of s.paths)null!=this.weightUrlConverter?o.push(this.weightUrlConverter(e)):i.push(a+e+r);return this.weightUrlConverter&&i.push(...await Promise.all(o)),i}async loadWeights(e){const t=await this.getWeightUrls(e);return[A_(e),await VI(t,this.loadOptions)]}}function GI(e){return null!=e.match(HI.URL_SCHEME_REGEX)}HI.URL_SCHEME_REGEX=/^https?:\/\//;const qI=(e,t)=>{if("undefined"===typeof fetch&&(null==t||null==t.fetchFunc))return null;{let n=!0;if(n=Array.isArray(e)?e.every(e=>GI(e)):GI(e),n)return KI(e,t)}return null};function KI(e,t){return new HI(e,t)}R_.registerSaveRouter(qI),R_.registerLoadRouter(qI);const XI=-2,YI=-1;function $I(e,t,n){const r=e.shape.length;Kw(r===t.length,()=>"Error in slice".concat(r,"D: Length of begin ").concat(t," must ")+"match the rank of the array (".concat(r,").")),Kw(r===n.length,()=>"Error in slice".concat(r,"D: Length of size ").concat(n," must ")+"match the rank of the array (".concat(r,")."));for(let a=0;a<r;++a)Kw(t[a]+n[a]<=e.shape[a],()=>"Error in slice".concat(r,"D: begin[").concat(a,"] + size[").concat(a,"] ")+"(".concat(t[a]+n[a],") would overflow input.shape[").concat(a,"] (").concat(e.shape[a],")"))}function JI(e){const t=[];let n=0;for(;e>0;)1&e&&t.push(n),e/=2,n++;return t}function QI(e,t,n){const r=[];for(let a=0;a<e.length;a++)r[a]=Math.ceil((t[a]-e[a])/n[a]);return r}function ZI(e,t,n,r){const a=[...e];for(let i=a.length;i<r.length;i++)a.push(1);for(let i=0;i<n;i++)0===i?a[t]=1:(a.splice(t,0,1),a.pop());return a}function eT(e,t,n){return n<=e?n:n-(t-1)}function tT(e,t){const n=[];for(let r=0;r<e;r++)n.push(t+r);return n}function nT(e,t,n,r,a,i,o,s,l){const c=e.length;let u=new Array(c),h=new Array(c),d=new Array(c);if(t.length&&n>0){const l=t[0],c=n+1;u=rT(o,l,c,r,e),h=aT(s,l,c,a,e),d=ZI(i,l,c,e)}else for(let f=0;f<c;f++)u[f]=oT(o,r,i,e,f,l),h[f]=sT(s,a,i,e,f,l),d[f]=iT(i,f,l);return{begin:u,end:h,strides:d}}function rT(e,t,n,r,a){const i=[...a],o=tT(n,t);for(let s=0;s<i.length;s++)if(o.indexOf(s)>-1)i[s]=0;else{const a=eT(t,n,s);let o=r[a];e&1<<a&&(o=0),i[s]=o}return i}function aT(e,t,n,r,a){const i=[...a],o=tT(n,t);for(let s=0;s<i.length;s++)if(o.indexOf(s)>-1)i[s]=Number.MAX_SAFE_INTEGER;else{const a=eT(t,n,s);let o=r[a];e&1<<a&&(o=Number.MAX_SAFE_INTEGER),i[s]=o}for(let s=0;s<i.length;s++){const e=a[s];i[s]<0&&(i[s]+=e),i[s]=Hw(0,i[s],a[s])}return i}function iT(e,t,n){let r=e[t];return(n&1<<t||null==r)&&(r=1),r}function oT(e,t,n,r,a,i){let o=t[a];const s=n[a]||1;(e&1<<a||i&1<<a||null==o)&&(o=s>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);const l=r[a];return o<0&&(o+=l),o=Hw(0,o,l-1),o}function sT(e,t,n,r,a,i){let o=t[a];const s=n[a]||1;(e&1<<a||i&1<<a||null==o)&&(o=s>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);const l=r[a];return o<0&&(o+=l),o=s>0?Hw(0,o,l):Hw(-1,o,l-1),o}function lT(e,t,n){let r=n.length;for(let a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(let a=r+1;a<n.length;a++)if(t[a]>0||n[a]!==e[a])return!1;return!0}function cT(e,t){let n=e.length>0?e[e.length-1]:1;for(let r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function uT(e,t,n){let r;const a=e.shape.length;let i;return r="number"===typeof t?[t,...new Array(a-1).fill(0)]:t.length<a?t.concat(new Array(a-t.length).fill(0)):t.slice(),r.forEach(e=>{Kw(-1!==e,()=>"slice() does not support negative begin indexing.")}),i=null==n?new Array(a).fill(-1):"number"===typeof n?[n,...new Array(a-1).fill(-1)]:n.length<a?n.concat(new Array(a-n.length).fill(-1)):n,i=i.map((t,n)=>t>=0?t:(Kw(-1===t,()=>"Negative size values should be exactly -1 but got "+"".concat(t," for the slice() size at index ").concat(n,".")),e.shape[n]-r[n])),[r,i]}function hT(e,t,n,r,a,i,o,s,l){let c;if(null==r?(c=new Array(t.length),c.fill(1)):c=r,null!=o&&0!==(o&o-1))throw new Error("Multiple ellipses in slice is not allowed.");let u=!1;const h={dims:c.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:c.slice(),beginMask:a,endMask:i,ellipsisMask:o,newAxisMask:s,shrinkAxisMask:l};for(let x=0;x<h.dims;x++)u&&0!==(1<<x&s)&&h.numAddAxisAfterEllipsis++,1<<x&o&&(u=!0);u||(h.ellipsisMask|=1<<h.dims,h.dims++);const d={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};!function(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let n=0;t.beginValid=null!=e.begin,t.endValid=null!=e.end,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let r=0;r<e.dims;r++)if(1<<r&e.ellipsisMask){const a=Math.min(t.dims-(e.dims-r)+1+e.numAddAxisAfterEllipsis,t.dims);for(;n<a;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&e.newAxisMask)t.finalShapeGatherIndices.push(XI),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error("Index out of range using input dim ".concat(n,"; input ")+"has only ".concat(t.dims," dims, ").concat(t.begin.length,"."));null!=e.begin&&(t.begin[n]=e.begin[r]),null!=e.end&&(t.end[n]=e.end[r]),t.strides[n]=e.strides[r],e.beginMask&1<<r&&(t.beginMask|=1<<n),e.endMask&1<<r&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<r?(t.finalShapeGatherIndices.push(YI),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(r)),t.inputShapeGatherIndicesSparse[n]=r,n++}}(h,d);let f=!0,p=!0,g=!0;const m=[],v=[];for(let x=0;x<e.length;++x){if(0===d.strides[x])throw Error("strides[".concat(x,"] must be non-zero"));const t=!!(d.shrinkAxisMask&1<<x),n=e[x];if(-1===n){m.push(t?1:-1);continue}const r=[d.beginMask&1<<x,d.endMask&1<<x],a=[d.strides[x]>0?0:-1,d.strides[x]>0?n:n-1];if(t&&d.strides[x]<=0)throw Error("only stride 1 allowed on non-range indexing.");g=g&&1===d.strides[x];const i=!!(d.beginMask&1<<x&&d.endMask&1<<x);if(d.beginValid&&d.endValid){if(t){const e=d.begin[x]<0?n+d.begin[x]:d.begin[x];if(d.begin[x]=e,d.end[x]=d.begin[x]+1,e<0||e>=n)throw Error("slice index ".concat(d.begin[x]," of dimension ").concat(x," out of bounds."))}else d.begin[x]=dT(d.begin[x],0,d.strides[x],n,r,a),d.end[x]=dT(d.end[x],1,d.strides[x],n,r,a);const e=1===d.strides[x]&&0===d.begin[x]&&d.end[x]===n;f=f&&e,p=p&&(0===x&&1===d.strides[x]||e)}else f=f&&1===d.strides[x]&&i,p=p&&(0===x&&1===d.strides[x]||i);let o,s=!1;if(d.beginValid&&d.endValid?(o=d.end[x]-d.begin[x],s=!0):t?(o=1,s=!0):i&&n>=0&&(o=d.strides[x]<0?-n:n,s=!0),s){let e;e=0===o||o<0!==d.strides[x]<0?0:Math.trunc(o/d.strides[x])+(o%d.strides[x]!==0?1:0),m.push(e)}else m.push(-1)}for(let x=0;x<d.finalShapeGatherIndices.length;++x){const e=d.finalShapeGatherIndices[x];e>=0?v.push(m[e]):e===XI&&v.push(1)}const b=v.filter((e,t)=>d.finalShapeGatherIndices[t]!==XI);return{finalShapeSparse:b,finalShape:v,isIdentity:f,sliceDim0:p,isSimpleSlice:g,begin:d.begin,end:d.end,strides:d.strides}}function dT(e,t,n,r,a,i){if(a[t])return n>0?i[t]:i[t+1&1];{const t=e<0?r+e:e;return t<i[0]?i[0]:t>i[1]?i[1]:t}}const fT=h_({all_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:c_(e,"x","all","bool")},a={axis:t,keepDims:n};return e_.runKernel(Mk,r,a)}});const pT=h_({any_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:c_(e,"x","any","bool")},a={axis:t,keepDims:n};return e_.runKernel(jk,r,a)}});const gT=h_({argMax_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:c_(e,"x","argMax")},r={axis:t};return e_.runKernel(Bk,n,r)}});function mT(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5?arguments[5]:void 0;return xT(e,[...t,e[3]],n,i,r,null,null,TT(a))}function vT(e,t,n,r,a,i){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast";const[s,l]=kT(t);let c;if("channelsLast"===o)c=[s,l,e[3],e[3]];else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat ".concat(o));c=[s,l,e[1],e[1]]}return xT(e,c,n,r,a,i,!1,o)}function bT(e,t,n,r,a,i){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NDHWC";const[s,l,c]=NT(t);let u,h;if("NDHWC"===o)h="channelsLast",u=[s,l,c,e[4],e[4]];else{if("NCDHW"!==o)throw new Error("Unknown dataFormat ".concat(o));h="channelsFirst",u=[s,l,c,e[1],e[1]]}return yT(e,u,n,r,a,!1,h,i)}function xT(e,t,n,r,a,i){let o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"channelsLast",[l,c,u,h]=[-1,-1,-1,-1];if("channelsLast"===s)[l,c,u,h]=e;else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));[l,h,c,u]=e}const[d,f,,p]=t,[g,m]=kT(n),[v,b]=kT(r),x=ST(d,v),y=ST(f,b),{padInfo:w,outHeight:k,outWidth:N}=function(e,t,n,r,a,i,o,s,l){let c,u,h;if("number"===typeof e){c={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};const a=function(e,t,n,r,a){null==r&&(r=wT(e,t,n));const i=e[0],o=e[1],s=CT((i-t+2*r)/n+1,a),l=CT((o-t+2*r)/n+1,a);return[s,l]}([t,n],i,r,e,s);u=a[0],h=a[1]}else if("same"===e){u=Math.ceil(t/r),h=Math.ceil(n/a);const e=Math.max(0,(u-1)*r+i-t),s=Math.max(0,(h-1)*a+o-n),l=Math.floor(e/2),d=e-l,f=Math.floor(s/2);c={top:l,bottom:d,left:f,right:s-f,type:"SAME"}}else if("valid"===e)c={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((t-i+1)/r),h=Math.ceil((n-o+1)/a);else{if("object"!==typeof e)throw Error("Unknown padding parameter: ".concat(e));{const d="channelsLast"===l?e[1][0]:e[2][0],f="channelsLast"===l?e[1][1]:e[2][1],p="channelsLast"===l?e[2][0]:e[3][0],g="channelsLast"===l?e[2][1]:e[3][1];c={top:d,bottom:f,left:p,right:g,type:0===d&&0===f&&0===p&&0===g?"VALID":"EXPLICIT"},u=CT((t-i+d+f)/r+1,s),h=CT((n-o+p+g)/a+1,s)}}return{padInfo:c,outHeight:u,outWidth:h}}(a,c,u,g,m,x,y,i,s),S=o?p*h:p;let C;return"channelsFirst"===s?C=[l,S,k,N]:"channelsLast"===s&&(C=[l,k,N,S]),{batchSize:l,dataFormat:s,inHeight:c,inWidth:u,inChannels:h,outHeight:k,outWidth:N,outChannels:S,padInfo:w,strideHeight:g,strideWidth:m,filterHeight:d,filterWidth:f,effectiveFilterHeight:x,effectiveFilterWidth:y,dilationHeight:v,dilationWidth:b,inShape:e,outShape:C,filterShape:t}}function yT(e,t,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",s=arguments.length>7?arguments[7]:void 0,[l,c,u,h,d]=[-1,-1,-1,-1,-1];if("channelsLast"===o)[l,c,u,h,d]=e;else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat ".concat(o));[l,d,c,u,h]=e}const[f,p,g,,m]=t,[v,b,x]=NT(n),[y,w,k]=NT(r),N=ST(f,y),S=ST(p,w),C=ST(g,k),{padInfo:E,outDepth:_,outHeight:I,outWidth:T}=function(e,t,n,r,a,i,o,s,l,c,u){let h,d,f,p;"valid"===e&&(e=0);if("number"===typeof e){h={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};const g=function(e,t,n,r,a,i){null==a&&(a=wT(e,t[0],r[0]));const o=[0,0,0,n];for(let s=0;s<3;s++)e[s]+2*a>=t[s]&&(o[s]=CT((e[s]-t[s]+2*a)/r[s]+1,i));return o}([t,n,r,1],[s,l,c],1,[a,i,o],e,u);d=g[0],f=g[1],p=g[2]}else{if("same"!==e)throw Error("Unknown padding parameter: ".concat(e));{d=Math.ceil(t/a),f=Math.ceil(n/i),p=Math.ceil(r/o);const e=(d-1)*a+s-t,u=(f-1)*i+l-n,g=(p-1)*o+c-r,m=Math.floor(e/2),v=e-m,b=Math.floor(u/2),x=u-b,y=Math.floor(g/2);h={top:b,bottom:x,left:y,right:g-y,front:m,back:v,type:"SAME"}}}return{padInfo:h,outDepth:d,outHeight:f,outWidth:p}}(a,c,u,h,v,b,x,N,S,C,s),A=i?m*d:m;let R;return"channelsFirst"===o?R=[l,A,_,I,T]:"channelsLast"===o&&(R=[l,_,I,T,A]),{batchSize:l,dataFormat:o,inDepth:c,inHeight:u,inWidth:h,inChannels:d,outDepth:_,outHeight:I,outWidth:T,outChannels:A,padInfo:E,strideDepth:v,strideHeight:b,strideWidth:x,filterDepth:f,filterHeight:p,filterWidth:g,effectiveFilterDepth:N,effectiveFilterHeight:S,effectiveFilterWidth:C,dilationDepth:y,dilationHeight:w,dilationWidth:k,inShape:e,outShape:R,filterShape:t}}function wT(e,t,n){const r=ST(t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:1);return Math.floor((e[0]*(n-1)-n+r)/2)}function kT(e){return"number"===typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function NT(e){return"number"===typeof e?[e,e,e]:e}function ST(e,t){return t<=1?e:e+(e-1)*(t-1)}function CT(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode ".concat(t))}}function ET(e){const[t,n,r]=kT(e);return 1===t&&1===n&&1===r}function _T(e,t){return ET(e)||ET(t)}function IT(e){return kT(e).every(e=>e>0)}function TT(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error("Unknown dataFormat ".concat(e))}function AT(e,t,n){if(null!=n){if("string"===typeof t)throw Error("Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,"."));if("number"===typeof t)Kw(Qw(t),()=>"Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,"."));else{if("object"!==typeof t)throw Error("Error in ".concat(e,": Unknown padding parameter: ").concat(t));t.forEach(t=>{t.forEach(t=>{Kw(Qw(t),()=>"Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,"."))})})}}}const RT=h_({reshape_:function(e,t){const n={x:c_(e,"x","reshape","string_or_numeric")},r={shape:t};return e_.runKernel(VS,n,r)}});const DT=h_({avgPool_:function(e,t,n,r,a){const i=c_(e,"x","avgPool","float32");Kw(_T(n,1),()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'"));let o=i,s=!1;3===i.rank&&(s=!0,o=RT(i,[1,i.shape[0],i.shape[1],i.shape[2]])),Kw(4===o.rank,()=>"Error in avgPool: x must be rank 4 but got rank ".concat(o.rank,".")),AT("avgPool",r,a);const l={x:o},c={filterSize:t,strides:n,pad:r,dimRoundingMode:a};let u=e_.runKernel(qk,l,c);return u=oI(u,i.dtype),s?RT(u,[u.shape[1],u.shape[2],u.shape[3]]):u}});const FT=h_({avgPool3d_:function(e,t,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC";const o=c_(e,"x","avgPool3d","float32");let s=o,l=!1;4===o.rank&&(l=!0,s=RT(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),Kw(5===s.rank,()=>"Error in avgPool3d: x must be rank 5 but got rank ".concat(s.rank,".")),Kw("NDHWC"===i,()=>"Error in avgPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(i)),Kw("number"===typeof n&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>"Error in avgPool3d: Stride must be > 0, but got '".concat(n,"'")),AT("avgPool3d",r,a);const c={x:s},u={filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:i};let h=e_.runKernel(Xk,c,u);return h=oI(h,s.dtype),l?RT(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});const OT=h_({batchNorm_:function(e,t,n,r,a,i){null==i&&(i=.001);const o=c_(e,"x","batchNorm"),s=c_(t,"mean","batchNorm"),l=c_(n,"variance","batchNorm");let c,u;null!=a&&(c=c_(a,"scale","batchNorm")),null!=r&&(u=c_(r,"offset","batchNorm")),Kw(s.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),Kw(null==u||s.rank===u.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),Kw(null==c||s.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const h=function(e){let t;return t=0===e.rank||1===e.rank?RT(e,[1,1,1,e.size]):2===e.rank?RT(e,[1,1,e.shape[0],e.shape[1]]):3===e.rank?RT(e,[1,e.shape[0],e.shape[1],e.shape[2]]):e,t}(o),d={x:h,scale:c,offset:u,mean:s,variance:l},f={varianceEpsilon:i},p=e_.runKernel(UN,d,f);return RT(p,o.shape)}});const LT=h_({batchNorm2d_:function(e,t,n,r,a,i){const o=c_(e,"x","batchNorm"),s=c_(t,"mean","batchNorm"),l=c_(n,"variance","batchNorm");let c,u;return null!=a&&(c=c_(a,"scale","batchNorm")),null!=r&&(u=c_(r,"offset","batchNorm")),Kw(2===o.rank,()=>"Error in batchNorm2D: x must be rank 2 but got rank "+"".concat(o.rank,".")),Kw(2===s.rank||1===s.rank,()=>"Error in batchNorm2D: mean must be rank 2 or rank 1 but "+"got rank ".concat(s.rank,".")),Kw(2===l.rank||1===l.rank,()=>"Error in batchNorm2D: variance must be rank 2 or rank 1 "+"but got rank ".concat(l.rank,".")),null!=c&&Kw(2===c.rank||1===c.rank,()=>"Error in batchNorm2D: scale must be rank 2 or rank 1 "+"but got rank ".concat(c.rank,".")),null!=u&&Kw(2===u.rank||1===u.rank,()=>"Error in batchNorm2D: offset must be rank 2 or rank 1 "+"but got rank ".concat(u.rank,".")),OT(o,s,l,u,c,i)}});const PT=h_({batchNorm3d_:function(e,t,n,r,a,i){const o=c_(e,"x","batchNorm"),s=c_(t,"mean","batchNorm"),l=c_(n,"variance","batchNorm");let c,u;return null!=a&&(c=c_(a,"scale","batchNorm")),null!=r&&(u=c_(r,"offset","batchNorm")),Kw(3===o.rank,()=>"Error in batchNorm3D: x must be rank 3 but got rank "+"".concat(o.rank,".")),Kw(3===s.rank||1===s.rank,()=>"Error in batchNorm3D: mean must be rank 3 or rank 1 but "+"got rank ".concat(s.rank,".")),Kw(3===l.rank||1===l.rank,()=>"Error in batchNorm3D: variance must be rank 3 or rank 1 "+"but got rank ".concat(l.rank,".")),null!=c&&Kw(3===c.rank||1===c.rank,()=>"Error in batchNorm3D: scale must be rank 3 or rank 1 "+"but got rank ".concat(c.rank,".")),null!=u&&Kw(3===u.rank||1===u.rank,()=>"Error in batchNorm3D: offset must be rank 3 or rank 1 "+"but got rank ".concat(u.rank,".")),OT(o,s,l,u,c,i)}});const MT=h_({batchNorm4d_:function(e,t,n,r,a,i){const o=c_(e,"x","batchNorm"),s=c_(t,"mean","batchNorm"),l=c_(n,"variance","batchNorm");let c,u;return null!=a&&(c=c_(a,"scale","batchNorm")),null!=r&&(u=c_(r,"offset","batchNorm")),Kw(4===o.rank,()=>"Error in batchNorm4D: x must be rank 4 but got rank "+"".concat(o.rank,".")),Kw(4===s.rank||1===s.rank,()=>"Error in batchNorm4D: mean must be rank 4 or rank 1 but "+"got rank ".concat(s.rank,".")),Kw(4===l.rank||1===l.rank,()=>"Error in batchNorm4D: variance must be rank 4 or rank 1 "+"but got rank ".concat(l.rank,".")),null!=c&&Kw(4===c.rank||1===c.rank,()=>"Error in batchNorm4D: scale must be rank 4 or rank 1 "+"but got rank ".concat(c.rank,".")),null!=u&&Kw(4===u.rank||1===u.rank,()=>"Error in batchNorm4D: offset must be rank 4 or rank 1 "+"but got rank ".concat(u.rank,".")),OT(o,s,l,u,c,i)}});const jT=h_({broadcastTo_:function(e,t){let n=c_(e,"broadcastTo","x");const r=n.shape;if(yk(t),t.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(t.length," < input.rank=").concat(n.rank,"."));if(t.length>n.rank){const e=n.shape.slice();for(;e.length<t.length;)e.unshift(1);n=RT(n,e)}const a=n.shape,i=Array.from(t);for(let c=t.length-1;c>=0;c--)if(a[c]===t[c])i[c]=1;else if(1!==n.shape[c])throw new Error("broadcastTo(): [".concat(r,"] cannot be broadcast to [").concat(t,"]."));const o=i.map((e,t)=>e>1?t:-1).filter(e=>e>=0);if(0===o.length)return sI(n);const s={x:n},l={reps:i};return e_.runKernel(TC,s,l)}});const BT=h_({clipByValue_:function(e,t,n){const r=c_(e,"x","clipByValue");if(Kw(t<=n,()=>"Error in clip: min (".concat(t,") must be ")+"less than or equal to max (".concat(n,").")),t===n)return CI(r.shape,t,r.dtype);const a={x:r},i={clipValueMin:t,clipValueMax:n};return e_.runKernel(rN,a,i)}});const zT=h_({concat_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Kw(e.length>=1,()=>"Pass at least one tensor to concat");const n=u_(e,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach(e=>{if("complex64"!==e.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(e.dtype,". "))}),1===n.length)return sI(n[0]);const r=n,a={axis:t};return e_.runKernel(oN,r,a)}});const WT=h_({concat1d_:function(e){return zT(e,0)}});const UT=h_({concat2d_:function(e,t){return zT(e,t)}});const VT=h_({concat3d_:function(e,t){return zT(e,t)}});const HT=h_({concat4d_:function(e,t){return zT(e,t)}});const GT=h_({conv2d_:function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0;const s=c_(e,"x","conv2d","float32"),l=c_(t,"filter","conv2d","float32");let c=s,u=!1;3===s.rank&&(u=!0,c=RT(s,[1,s.shape[0],s.shape[1],s.shape[2]])),Kw(4===c.rank,()=>"Error in conv2d: input must be rank 4, but got rank ".concat(c.rank,".")),Kw(4===l.rank,()=>"Error in conv2d: filter must be rank 4, but got rank "+"".concat(l.rank,".")),AT("conv2d",r,o);const h="NHWC"===a?c.shape[3]:c.shape[1];Kw(h===l.shape[2],()=>"Error in conv2d: depth of input (".concat(h,") must match ")+"input depth for filter ".concat(l.shape[2],".")),Kw(_T(n,i),()=>"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(i,"'")),Kw(IT(i),()=>"Error in conv2D: Dilated rates should be larger than 0."),Kw(IT(n),()=>"Error in conv2D: Strides should be larger than 0.");const d={x:c,filter:l},f={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:o},p=e_.runKernel(sN,d,f);return u?RT(p,[p.shape[1],p.shape[2],p.shape[3]]):p}});const qT=h_({conv1d_:function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6?arguments[6]:void 0;const s=c_(e,"x","conv1d"),l=c_(t,"filter","conv1d");let c=s,u=!1;2===s.rank&&(u=!0,c=RT(s,[1,s.shape[0],s.shape[1]])),Kw(3===c.rank,()=>"Error in conv1d: input must be rank 3, but got rank ".concat(c.rank,".")),Kw(3===l.rank,()=>"Error in conv1d: filter must be rank 3, but got rank "+"".concat(l.rank,".")),AT("conv1d",r,o),Kw(c.shape[2]===l.shape[1],()=>"Error in conv1d: depth of input (".concat(c.shape[2],") must match ")+"input depth for filter ".concat(l.shape[1],".")),Kw(_T(n,i),()=>"Error in conv1D: Either stride or dilation must be 1. "+"Got stride ".concat(n," and dilation '").concat(i,"'")),Kw(IT(i),()=>"Error in conv1D: Dilated rates should be larger than 0."),Kw(IT(n),()=>"Error in conv1D: Stride should be larger than 0."),Kw("NWC"===a,()=>"Error in conv1d: got dataFormat of ".concat(a," but only NWC is currently supported."));const h=RT(l,[1,l.shape[0],l.shape[1],l.shape[2]]),d=RT(c,[c.shape[0],1,c.shape[1],c.shape[2]]),f=GT(d,h,[1,n],r,"NHWC",[1,i],o);return RT(f,u?[f.shape[2],f.shape[3]]:[f.shape[0],f.shape[2],f.shape[3]])}});const KT=h_({conv2DBackpropInput_:function(e,t,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=arguments.length>6?arguments[6]:void 0;Kw(e.length===t.rank,()=>"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match"));let s=e,l=t,c=!1;3===t.rank&&(c=!0,l=RT(t,[1,t.shape[0],t.shape[1],t.shape[2]]),s=[1,e[0],e[1],e[2]]),Kw(4===s.length,()=>"Error in conv2dDerInput: inShape must be length 4, but got length "+"".concat(s.length,".")),Kw(4===l.rank,()=>"Error in conv2dDerInput: dy must be rank 4, but got "+"rank ".concat(l.rank)),Kw(4===n.rank,()=>"Error in conv2dDerInput: filter must be rank 4, but got "+"rank ".concat(n.rank));const u="NHWC"===i?s[3]:s[1],h="NHWC"===i?l.shape[3]:l.shape[1];Kw(u===n.shape[2],()=>"Error in conv2dDerInput: depth of input (".concat(u,") must ")+"match input depth for filter ".concat(n.shape[2],".")),Kw(h===n.shape[3],()=>"Error in conv2dDerInput: depth of output (".concat(h,") must ")+"match output depth for filter ".concat(n.shape[3],".")),AT("conv2dDerInput",a,o);const d={dy:l,filter:n},f={strides:r,pad:a,dataFormat:i,dimRoundingMode:o,inputShape:s},p=e_.runKernel(cN,d,f);return c?RT(p,[p.shape[1],p.shape[2],p.shape[3]]):p}});const XT=h_({conv2dTranspose_:function(e,t,n,r,a,i){const o=c_(e,"x","conv2dTranspose"),s=c_(t,"filter","conv2dTranspose");return KT(n,o,s,r,a,"NHWC",i)}});const YT=h_({conv3d_:function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NDHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1];const o=c_(e,"x","conv3d"),s=c_(t,"filter","conv3d");let l=o,c=!1;4===o.rank&&(c=!0,l=RT(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),Kw(5===l.rank,()=>"Error in conv3d: input must be rank 5, but got rank ".concat(l.rank,".")),Kw(5===s.rank,()=>"Error in conv3d: filter must be rank 5, but got rank "+"".concat(s.rank,".")),Kw(l.shape[4]===s.shape[3],()=>"Error in conv3d: depth of input (".concat(l.shape[4],") must match ")+"input depth for filter ".concat(s.shape[3],".")),Kw(_T(n,i),()=>"Error in conv3D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(i,"'")),Kw("NDHWC"===a,()=>"Error in conv3d: got dataFormat of ".concat(a," but only NDHWC is currently supported.")),Kw(IT(i),()=>"Error in conv3D: Dilated rates should be larger than 0."),Kw(IT(n),()=>"Error in conv3D: Strides should be larger than 0.");const u={x:l,filter:s},h={strides:n,pad:r,dataFormat:a,dilations:i},d=e_.runKernel(uN,u,h);return c?RT(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});const $T=h_({conv3DBackpropInput_:function(e,t,n,r,a){Kw(e.length===t.rank,()=>"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match"));let i=e,o=t,s=!1;4===t.rank&&(s=!0,o=RT(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),i=[1,e[0],e[1],e[2],e[3]]);const l=i[4],c=o.shape[4];Kw(5===i.length,()=>"Error in conv3dDerInput: inShape must be length 5, but got length "+"".concat(i.length,".")),Kw(5===o.rank,()=>"Error in conv3dDerInput: dy must be rank 5, but got "+"rank ".concat(o.rank)),Kw(5===n.rank,()=>"Error in conv3dDerInput: filter must be rank 5, but got "+"rank ".concat(n.rank)),Kw(l===n.shape[3],()=>"Error in conv3dDerInput: depth of input (".concat(l,") must ")+"match input depth for filter ".concat(n.shape[3],".")),Kw(c===n.shape[4],()=>"Error in conv3dDerInput: depth of output (".concat(c,") must ")+"match output depth for filter ".concat(n.shape[4],"."));const u={dy:o,filter:n},h={pad:a,strides:r,inputShape:i},d=e_.runKernel(dN,u,h);return s?RT(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});const JT=h_({conv3dTranspose_:function(e,t,n,r,a){const i=c_(e,"x","conv3dTranspose"),o=c_(t,"filter","conv3dTranspose");return $T(n,i,o,r,a)}});const QT=h_({denseBincount_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=c_(e,"x","denseBincount"),i=c_(t,"weights","denseBincount");Kw("int32"===a.dtype,()=>"Error in denseBincount: input "+"dtype must be int32, but got ".concat(a.dtype)),Kw(a.rank<=2,()=>"Error in denseBincount: input must be at most rank 2, but got "+"rank ".concat(a.rank,".")),Kw(n>=0,()=>"size must be non-negative, but got ".concat(n,".")),Kw(i.size===a.size||0===i.size,()=>"Error in denseBincount: weights must have the same shape as x or "+"0-length, but got x shape: ".concat(a.shape,", weights shape: ")+"".concat(i.shape,"."));const o={x:a,weights:i},s={size:n,binaryOutput:r};return e_.runKernel(bN,o,s)}});const ZT=h_({depthwiseConv2d_:function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0;const s=c_(e,"x","depthwiseConv2d","float32"),l=c_(t,"filter","depthwiseConv2d","float32");let c=s,u=!1;3===s.rank&&(u=!0,c=RT(s,[1,s.shape[0],s.shape[1],s.shape[2]])),Kw(4===c.rank,()=>"Error in depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(c.rank,".")),Kw(4===l.rank,()=>"Error in depthwiseConv2d: filter must be rank 4, but got rank "+"".concat(l.rank,"."));const h="NHWC"===a?c.shape[3]:c.shape[1];Kw(h===l.shape[2],()=>"Error in depthwiseConv2d: number of input channels "+"(".concat(h,") must match the inChannels dimension in ")+"filter ".concat(l.shape[2],".")),AT("depthwiseConv2d",r,o);const d={x:c,filter:l},f={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:o},p=e_.runKernel(yN,d,f);return u?RT(p,[p.shape[1],p.shape[2],p.shape[3]]):p}});const eA=h_({elu_:function(e){const t={x:c_(e,"x","elu","float32")};return e_.runKernel(AN,t)}});const tA=h_({equal_:function(e,t){let n=c_(e,"a","equal","string_or_numeric"),r=c_(t,"b","equal","string_or_numeric");[n,r]=qE(n,r),FI(n.shape,r.shape);const a={a:n,b:r};return e_.runKernel(FN,a)}});const nA=h_({erf_:function(e){let t=c_(e,"x","erf");Kw("int32"===t.dtype||"float32"===t.dtype,()=>"Input dtype must be `int32` or `float32`."),"int32"===t.dtype&&(t=oI(t,"float32"));const n={x:t};return e_.runKernel(DN,n)}});const rA=h_({exp_:function(e){const t={x:c_(e,"x","exp")};return e_.runKernel(ON,t)}});const aA=h_({expandDims_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=c_(e,"x","expandDims","string_or_numeric");Kw(t<=n.rank,()=>"Axis must be <= rank of the tensor");const r={input:n},a={dim:t};return e_.runKernel(LN,r,a)}});const iA=h_({tile_:function(e,t){const n=c_(e,"x","tile","string_or_numeric");Kw(n.rank===t.length,()=>"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of reps ".concat(t,"."));const r={x:n},a={reps:t};return e_.runKernel(TC,r,a)}});const oA=h_({eye_:function(e,t,n){null==t&&(t=e);const r=iI([e,t],arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32"),a=e<=t?e:t;for(let o=0;o<a;++o)r.set(1,o,o);const i=RT(r.toTensor(),[e,t]);if(null==n)return i;if(1===n.length)return iA(aA(i,0),[n[0],1,1]);if(2===n.length)return iA(aA(aA(i,0),0),[n[0],n[1],1,1]);if(3===n.length)return iA(aA(aA(aA(i,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+"batchShapes, but received ".concat(n.length,"D."))}});const sA=h_({floor_:function(e){const t={x:c_(e,"x","floor","float32")};return e_.runKernel(zN,t)}});const lA=h_({gather_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const a={x:c_(e,"x","gather"),indices:c_(t,"indices","gather","int32")},i={axis:n,batchDims:r};return e_.runKernel(VN,a,i)}});const cA=h_({greater_:function(e,t){let n=c_(e,"a","greater","string_or_numeric"),r=c_(t,"b","greater","string_or_numeric");[n,r]=qE(n,r),FI(n.shape,r.shape);const a={a:n,b:r};return e_.runKernel(GN,a)}});const uA=h_({greaterEqual_:function(e,t){let n=c_(e,"a","greaterEqual","string_or_numeric"),r=c_(t,"b","greaterEqual","string_or_numeric");[n,r]=qE(n,r),FI(n.shape,r.shape);const a={a:n,b:r};return e_.runKernel(qN,a)}});const hA=h_({leakyRelu_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2;const n={x:c_(e,"x","leakyRelu")},r={alpha:t};return e_.runKernel(ZN,n,r)}});const dA=h_({log_:function(e){const t={x:c_(e,"x","log","float32")};return e_.runKernel(rS,t)}});const fA=h_({log1p_:function(e){const t={x:c_(e,"x","log1p")};return e_.runKernel(aS,t)}});const pA=h_({max_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:c_(e,"x","max")},a={reductionIndices:t,keepDims:n};return e_.runKernel(uS,r,a)}});const gA=h_({sum_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=c_(e,"x","sum");"bool"===r.dtype&&(r=oI(r,"int32"));const a={x:r},i={axis:t,keepDims:n};return e_.runKernel(uC,a,i)}});const mA=h_({logSoftmax_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=c_(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and axis was ").concat(t));const r=mI((e,n)=>{const r=pA(e,t,!0),a=II(e,r),i=II(oI(a,"float32"),dA(gA(rA(a),t,!0)));n([i]);return{value:i,gradFunc:(e,n)=>{const[r]=n,a=rA(r);return II(e,dI(gA(e,t,!0),a))}}});return r(n)}});function vA(e,t){for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function bA(e,t,n){const r=e.length+t.length,a=[];let i=0,o=0;for(let s=0;s<r;s++)-1===n.indexOf(s)?a.push(e[i++]):a.push(t[o++]);return a}function xA(e,t){const n=[],r=e.length;for(let a=0;a<r;a++)-1===t.indexOf(a)&&n.push(e[a]);return[n,t.map(t=>e[t])]}function yA(e,t){return bA(e,t.map(e=>1),t)}function wA(e,t,n){Kw(vA(t,n),()=>"".concat(e," supports only inner-most axes for now. ")+"Got axes ".concat(t," and rank-").concat(n," input."))}function kA(e,t){if(vA(e,t))return null;const n=[];for(let r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach(e=>n.push(e)),n}function NA(e){return e.map((e,t)=>[t,e]).sort((e,t)=>e[1]-t[1]).map(e=>e[0])}function SA(e,t){const n=[];for(let r=t-e;r<t;++r)n.push(r);return n}const CA=h_({logSumExp_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=c_(e,"x","logSumExp"),a=rk(t,r.shape),i=pA(r,a,!0),o=II(r,i),s=rA(o),l=gA(s,a),c=dA(l),u=cI(RT(i,c.shape),c);if(n){const e=yA(u.shape,a);return RT(u,e)}return u}});const EA=h_({logicalAnd_:function(e,t){const n=c_(e,"a","logicalAnd","bool"),r=c_(t,"b","logicalAnd","bool");FI(n.shape,r.shape);const a={a:n,b:r};return e_.runKernel(iS,a)}});const _A=h_({matMul_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=c_(e,"a","matMul"),i=c_(t,"b","matMul");[a,i]=qE(a,i);const o={a:a,b:i},s={transposeA:n,transposeB:r};return e_.runKernel($k,o,s)}});const IA=h_({maxPool_:function(e,t,n,r,a){const i=c_(e,"x","maxPool");let o=i,s=!1;3===i.rank&&(s=!0,o=RT(i,[1,i.shape[0],i.shape[1],i.shape[2]])),Kw(4===o.rank,()=>"Error in maxPool: input must be rank 4 but got rank ".concat(o.rank,".")),Kw(_T(n,1),()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")),AT("maxPool",r,a);const l={x:o},c={filterSize:t,strides:n,pad:r,dimRoundingMode:a},u=e_.runKernel(dS,l,c);return s?RT(u,[u.shape[1],u.shape[2],u.shape[3]]):u}});const TA=h_({maxPool3d_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC";const o=c_(e,"x","maxPool3d");let s=o,l=!1;4===o.rank&&(l=!0,s=RT(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),Kw(5===s.rank,()=>"Error in maxPool3d: x must be rank 5 but got rank ".concat(s.rank,".")),Kw("NDHWC"===i,()=>"Error in maxPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(i)),AT("maxPool3d",r,a);const c={x:s},u={filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:i},h=e_.runKernel(pS,c,u);return l?RT(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});const AA=h_({mean_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:c_(e,"x","mean")},a={axis:t,keepDims:n};return e_.runKernel(vS,r,a)}});const RA=h_({min_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:c_(e,"x","min")},a={axis:t,keepDims:n};return e_.runKernel(bS,r,a)}});const DA=h_({minimum_:function(e,t){let n=c_(e,"a","minimum"),r=c_(t,"b","minimum");[n,r]=qE(n,r),"bool"===n.dtype&&(n=oI(n,"int32"),r=oI(r,"int32")),FI(n.shape,r.shape);const a={a:n,b:r};return e_.runKernel(xS,a)}});const FA=h_({moments_:function(e){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=rk(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,(e=c_(e,"x","moments")).shape),r=AA(e,n,t);let a=r.shape;t||(a=yA(r.shape,n));const i=pI(II(oI(e,"float32"),RT(r,a)));return{mean:r,variance:AA(i,n,t)}}});const OA=h_({neg_:function(e){const t={x:c_(e,"x","neg")};return e_.runKernel(SS,t)}});const LA=h_({notEqual_:function(e,t){let n=c_(e,"a","notEqual","string_or_numeric"),r=c_(t,"b","notEqual","string_or_numeric");[n,r]=qE(n,r),FI(n.shape,r.shape);const a={a:n,b:r};return e_.runKernel(CS,a)}});const PA=h_({oneHot_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"int32";if(t<2)throw new Error("Error in oneHot: depth must be >=2, but it is ".concat(t));const i={indices:c_(e,"indices","oneHot","int32")},o={dtype:a,depth:t,onValue:n,offValue:r};return e_.runKernel(AS,i,o)}});function MA(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if(yk(e),"complex64"===t){const t=MA(e,"float32"),n=MA(e,"float32");return d_(t,n)}const n=bk($w(e),t);return e_.makeTensor(n,e,t)}function jA(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if(yk(e),"complex64"===t){const t=jA(e,"float32"),n=MA(e,"float32");return d_(t,n)}const n=vk($w(e),t);return e_.makeTensor(n,e,t)}const BA=h_({onesLike_:function(e){const t={x:c_(e,"x","onesLike")};return e_.runKernel(TS,t)}});const zA=h_({pad_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=c_(e,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const a={paddings:t,constantValue:n},i={x:r};return e_.runKernel(DS,i,a)}});const WA=h_({prelu_:function(e,t){const n={x:c_(e,"x","prelu"),alpha:c_(t,"alpha","prelu")};return e_.runKernel(OS,n)}});var UA=n(4334);class VA{constructor(e,t,n,r,a){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);const i=a||Math.random();this.random=UA.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){const e=this.nextVal;return this.nextVal=NaN,e}let e,t,n=!1;for(;!n;){let r,a,i;do{r=2*this.random()-1,a=2*this.random()-1,i=r*r+a*a}while(i>=1||0===i);const o=Math.sqrt(-2*Math.log(i)/i);e=this.mean+this.stdDev*r*o,t=this.mean+this.stdDev*a*o,this.truncated&&!this.isValidTruncated(e)||(n=!0)}return this.truncated&&!this.isValidTruncated(t)||(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class HA{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=e,this.range=t-e,this.dtype=n,null==r&&(r=Math.random()),"number"===typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(e," - ").concat(t," <= 1 and dtype is not float"));this.random=UA.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}const GA=h_({randomNormal_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if(yk(e),null!=r&&"bool"===r)throw new Error("Unsupported data type ".concat(r));const i=new VA(t,n,r,!1,a),o=iI(e,r);for(let s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}});const qA=h_({randomUniform_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",a=arguments.length>4?arguments[4]:void 0;yk(e);const i=iI(e,r),o=new HA(t,n,null,a);for(let s=0;s<i.values.length;s++)i.values[s]=o.nextValue();return i.toTensor()}});function KA(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";if(0===n)throw new Error("Cannot have a step of zero");const a={start:e,stop:t,step:n,dtype:r};return e_.runKernel(BS,{},a)}const XA=h_({relu_:function(e){const t={x:c_(e,"x","relu")};return e_.runKernel(US,t)}});const YA=h_({reverse_:function(e,t){const n={x:c_(e,"x","reverse")},r={dims:t};return e_.runKernel(YS,n,r)}});const $A=h_({selu_:function(e){const t={x:c_(e,"x","selu")};return e_.runKernel(nC,t)}});const JA=h_({separableConv2d_:function(e,t,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NHWC";const s=c_(e,"x","separableConv2d"),l=c_(t,"depthwiseFilter","separableConv2d"),c=c_(n,"pointwiseFilter","separableConv2d");let u=s,h=!1;if(3===s.rank&&(h=!0,u=RT(s,[1,s.shape[0],s.shape[1],s.shape[2]])),"NCHW"===o)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");Kw(4===u.rank,()=>"Error in separableConv2d: input must be rank 4, but got "+"rank ".concat(u.rank,".")),Kw(4===l.rank,()=>"Error in separableConv2d: depthwise filter must be rank 4, but "+"got rank ".concat(l.rank,".")),Kw(4===c.rank,()=>"Error in separableConv2d: pointwise filter must be rank 4, but "+"got rank ".concat(l.rank,".")),Kw(1===c.shape[0],()=>"Error in separableConv2d: the first dimension of pointwise filter "+" must be 1, but got ".concat(c.shape[0],".")),Kw(1===c.shape[1],()=>"Error in separableConv2d: the second dimension of pointwise "+"filter must be 1, but got ".concat(c.shape[1],"."));const d=l.shape[2],f=l.shape[3];Kw(c.shape[2]===d*f,()=>"Error in separableConv2d: the third dimension of pointwise filter "+"must be ".concat(d*f,", ")+"but got ".concat(c.shape[2],"."));const p=ZT(u,l,r,a,o,i),g=GT(p,c,1,"valid",o);return h?RT(g,[g.shape[1],g.shape[2],g.shape[3]]):g}});const QA=h_({sigmoid_:function(e){const t={x:c_(e,"x","sigmoid","float32")};return e_.runKernel(sC,t)}});const ZA=h_({slice_:function(e,t,n){const r=c_(e,"x","slice","string_or_numeric");if(0===r.rank)throw new Error("Slicing scalar is not possible");const a={x:r},i={begin:t,size:n};return e_.runKernel(rC,a,i)}});const eR=h_({slice1d_:function(e,t,n){const r=c_(e,"x","slice1d");return Kw(1===r.rank,()=>"slice1d expects a rank-1 tensor, but got a rank-".concat(r.rank," tensor")),ZA(r,[t],[n])}});const tR=h_({slice2d_:function(e,t,n){const r=c_(e,"x","slice2d");return Kw(2===r.rank,()=>"slice2d expects a rank-2 tensor, but got a rank-".concat(r.rank," tensor")),ZA(r,t,n)}});const nR=h_({slice3d_:function(e,t,n){const r=c_(e,"x","slice3d");return Kw(3===r.rank,()=>"slice3d expects a rank-3 tensor, but got a rank-".concat(r.rank," tensor")),ZA(r,t,n)}});const rR=h_({slice4d_:function(e,t,n){const r=c_(e,"x","slice4d");return Kw(4===r.rank,()=>"slice4d expects a rank-4 tensor, but got a rank-".concat(r.rank," tensor")),ZA(r,t,n)}});const aR=h_({softmax_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=c_(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and dim was ").concat(t));const r={logits:n},a={dim:t};return e_.runKernel(fC,r,a)}});const iR=h_({softplus_:function(e){const t={x:c_(e,"x","softplus")};return e_.runKernel(lC,t)}});const oR=h_({split_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r={x:c_(e,"x","split")},a={numOrSizeSplits:t,axis:n};return e_.runKernel(dC,r,a)}});const sR=h_({squeeze_:function(e,t){const n=c_(e,"x","squeeze","string_or_numeric");return RT(n,ak(n.shape,t).newShape)}});const lR=h_({stack_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=u_(e,"tensors","stack","string_or_numeric");Kw(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&Kw(t<=n[0].rank,()=>"Axis must be <= rank of the tensor");const r=n,a={axis:t};return e_.runKernel(RS,r,a)}});const cR=h_({tanh_:function(e){const t={x:c_(e,"x","tanh","float32")};return e_.runKernel(IC,t)}});function uR(e,t){Yw(e);const n=o_(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return f_(e,null,n,t)}function hR(e,t,n){if(Yw(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");const r=o_(e,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return f_(e,t,r,n)}const dR=h_({truncatedNormal_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if(yk(e),null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");const i=new VA(t,n,r,!0,a),o=iI(e,r);for(let s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}});const fR=h_({unstack_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=c_(e,"x","unstack","string_or_numeric");Kw(t>=-n.shape.length&&t<n.shape.length,()=>"Axis = ".concat(t," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")"));const r={value:n},a={axis:t};return e_.runKernel(OC,r,a)}});const pR=h_({where_:function(e,t,n){const r=c_(t,"a","where"),a=c_(n,"b","where"),i=c_(e,"condition","where","bool"),o=FI(FI(i.shape,r.shape),a.shape),s={condition:jT(i,o),t:jT(r,o),e:jT(a,o)};return e_.runKernel(tC,s)}});const gR=h_({imag_:function(e){const t={input:c_(e,"input","imag")};return e_.runKernel(YN,t)}});const mR=h_({real_:function(e){const t={input:c_(e,"input","real")};return e_.runKernel(zS,t)}});const vR=h_({transpose_:function(e,t,n){const r=c_(e,"x","transpose");if(null==t&&(t=r.shape.map((e,t)=>t).reverse()),Kw(r.rank===t.length,()=>"Error in transpose: rank of input ".concat(r.rank," ")+"must match length of perm ".concat(t,".")),t.forEach(e=>{Kw(e>=0&&e<r.rank,()=>"All entries in 'perm' must be between 0 and ".concat(r.rank-1)+" but got ".concat(t))}),r.rank<=1)return r.clone();const a={x:r},i={perm:t};return"complex64"===r.dtype?b_(()=>{let e=mR(r),t=gR(r);return e=e_.runKernel(DC,{x:e},i),t=e_.runKernel(DC,{x:t},i),n&&(t=OA(t)),d_(e,t)}):e_.runKernel(DC,a,i)}});const bR=h_({dropout_:function(e,t,n,r){const a=c_(e,"x","dropout");if(Kw("float32"===a.dtype,()=>"x has to be a floating point tensor since it's going to be "+"scaled, but got a ".concat(a.dtype," tensor instead.")),Kw(t>=0&&t<1,()=>"rate must be a float in the range [0, 1), but got ".concat(t,".")),0===t)return e instanceof FE?a.clone():a;const i=function(e,t){if(null==t)return e.shape.slice();if(Jw(e.shape,t))return t;if(e.shape.length===t.length){const n=[];for(let r=0;r<e.shape.length;r++)null==t[r]&&null!=e.shape[r]?n.push(e.shape[r]):n.push(t[r]);return n}return t}(a,n),o=1-t,s=hI(sA(cI(qA(i,0,1,"float32",r),o)),o);return dI(a,s)}});const xR=h_({fft_:function(e){Kw("complex64"===e.dtype,()=>"The dtype for tf.spectral.fft() must be complex64 "+"but got ".concat(e.dtype,"."));const t={input:e};return e_.runKernel(MN,t)}});const yR=h_({rfft_:function(e,t){Kw("float32"===e.dtype,()=>"The dtype for rfft() must be real value but got ".concat(e.dtype));let n=e.shape[e.shape.length-1];const r=e.size/n;let a;if(null!=t&&t<n){const r=e.shape.map(e=>0),i=e.shape.map(e=>e);i[e.shape.length-1]=t,a=ZA(e,r,i),n=t}else if(null!=t&&t>n){const r=e.shape.map(e=>e);r[e.shape.length-1]=t-n,a=zT([e,MA(r)],e.shape.length-1),n=t}else a=e;const i=gI(a),o=RT(d_(a,i),[r,n]),s=xR(o),l=Math.floor(n/2)+1,c=mR(s),u=gR(s),h=oR(c,[l,n-l],c.shape.length-1),d=oR(u,[l,n-l],u.shape.length-1),f=a.shape.slice();return f[a.shape.length-1]=l,RT(d_(h[0],d[0]),f)}});const wR=h_({ifft_:function(e){Kw("complex64"===e.dtype,()=>"The dtype for tf.spectral.ifft() must be complex64 "+"but got ".concat(e.dtype,"."));const t={input:e};return e_.runKernel(XN,t)}});const kR=h_({irfft_:function(e){const t=e.shape[e.shape.length-1],n=e.size/t;let r;if(t<=2){const a=RT(e,[n,t]);r=wR(a)}else{const a=[n,2*(t-1)],i=RT(mR(e),[n,t]),o=RT(gR(e),[n,t]),s=YA(ZA(i,[0,1],[n,t-2]),1),l=dI(YA(ZA(o,[0,1],[n,t-2]),1),vI(-1)),c=zT([i,s],1),u=zT([o,l],1),h=RT(d_(c,u),[a[0],a[1]]);r=wR(h)}if(r=mR(r),3===e.rank&&0!==e.shape[0]){const t=r,n=e.shape[0];r=RT(r,[n,r.shape[0]/n,r.shape[1]]),t.dispose()}return r}});const NR=h_({conv2DBackpropFilter_:function(e,t,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=arguments.length>6?arguments[6]:void 0,s=e;3===e.rank&&(s=RT(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;3===l.rank&&(l=RT(t,[1,t.shape[0],t.shape[1],t.shape[2]])),Kw(4===s.rank,()=>"Error in conv2dDerFilter: input must be rank 4, but got shape "+"".concat(s.shape,".")),Kw(4===l.rank,()=>"Error in conv2dDerFilter: dy must be rank 4, but got shape "+"".concat(l.shape,".")),Kw(4===n.length,()=>"Error in conv2dDerFilter: filterShape must be length 4, but got "+"".concat(n,"."));const c="NHWC"===i?s.shape[3]:s.shape[1],u="NHWC"===i?l.shape[3]:l.shape[1];Kw(c===n[2],()=>"Error in conv2dDerFilter: depth of input ".concat(c,") must ")+"match input depth in filter (".concat(n[2],".")),Kw(u===n[3],()=>"Error in conv2dDerFilter: depth of dy (".concat(u,") must ")+"match output depth for filter (".concat(n[3],").")),AT("conv2dDerFilter",a,o);const h={x:s,dy:l},d={strides:r,pad:a,dataFormat:i,dimRoundingMode:o,filterShape:n};return e_.runKernel(lN,h,d)}});const SR=h_({relu6_:function(e){const t={x:c_(e,"x","relu6")};return e_.runKernel(XS,t)}});const CR=h_({step_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:c_(e,"x","step")},r={alpha:t};return e_.runKernel(MC,n,r)}});function ER(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return dI(e,CR(t));throw new Error("Cannot compute gradient for fused activation ".concat(n,"."))}function _R(e,t){let n=t;const r=DI(e.shape,t.shape);return r.length>0&&(n=gA(n,r)),RT(n,e.shape)}function IR(e,t,n,r){if("linear"===t)return e;if("relu"===t)return XA(e);if("elu"===t)return eA(e);if("relu6"===t)return SR(e);if("prelu"===t)return WA(e,n);if("leakyrelu"===t)return hA(e,r);if("sigmoid"===t)return QA(e);throw new Error("Unknown fused activation ".concat(t,"."))}const TR=(e,t)=>!(e>0)||"linear"===t;const AR=h_({fusedConv2d_:function(e){let{x:t,filter:n,strides:r,pad:a,dataFormat:i="NHWC",dilations:o=[1,1],dimRoundingMode:s,bias:l,activation:c="linear",preluActivationWeights:u,leakyreluAlpha:h}=e;if(c=c||"linear",!1===TR(e_.state.gradientDepth,c)){Kw("NHWC"===i,()=>"Error in fused conv2d: got dataFormat of ".concat(i," but ")+"only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.");let e=GT(t,n,r,a,i,o,s);return null!=l&&(e=cI(e,l)),IR(e,c,u,h)}const d=c_(t,"x","conv2d","float32"),f=c_(n,"filter","conv2d","float32");let p=d,g=!1;3===d.rank&&(g=!0,p=RT(d,[1,d.shape[0],d.shape[1],d.shape[2]])),Kw(4===p.rank,()=>"Error in fused conv2d: input must be rank 4, but got rank "+"".concat(p.rank,".")),Kw(4===f.rank,()=>"Error in fused conv2d: filter must be rank 4, but got rank "+"".concat(f.rank,".")),AT("fused conv2d",a,s);const m="NHWC"===i?p.shape[3]:p.shape[1];Kw(f.shape[2]===m,()=>"Error in conv2d: depth of input (".concat(m,") must match ")+"input depth for filter ".concat(f.shape[2],".")),Kw(_T(r,o),()=>"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(r," and dilations '").concat(o,"'"));const v=xT(p.shape,f.shape,r,o,a,s);let b,x;if(null!=l&&(b=c_(l,"bias","fused conv2d"),[b]=qE(b,d),"NHWC"===i?FI(v.outShape,b.shape):(Kw(b.shape.length<=1,()=>"Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of "+"rank-".concat(b.shape.length,".")),Kw(0===b.shape.length||b.shape[0]===v.outChannels||1===b.shape[0],()=>"Error in fused conv2d: bias shape (".concat(b.shape,") is not ")+"compatible with the number of output channels "+"(".concat(v.outChannels,")")))),null!=u){const e=u.shape;if(Kw(e.length<=1||3===e.length,()=>"Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of "+"rank-".concat(e.length,".")),1===e.length)Kw(1===e[0]||e[0]===v.outChannels,()=>"Error in fused conv2d: PReLU activation weights "+"(".concat(e,") is not compatible with the number of output ")+"channels (".concat(v.outChannels,")."));else if(3===e.length)try{FI(e,v.outShape)}catch(ci){const n="Error in fused conv2d: PReLU activation weights (".concat(e,") ")+"is not compatible with the output shape of the conv2d "+"(".concat(v.outShape,").");throw Error(n)}x=c_(u,"prelu weights","fused conv2d")}const y=(e,t)=>{Kw("NHWC"===i,()=>"Error in gradient of fused conv2D: got dataFormat of ".concat(i," but only NHWC is currently supported."));const[n,s,l,u]=t,h=ER(e,l,c);Kw(ET(o),()=>"Error in gradient of fused conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(o,"'"));const d=[KT(s.shape,h,n,r,a),NR(s,h,n.shape,r,a)];if(null!=u){const e=_R(u,h);d.push(e)}return d},w={x:p,filter:f,bias:b,preluActivationWeights:x},k={strides:r,pad:a,dataFormat:i,dilations:o,dimRoundingMode:s,activation:c,leakyreluAlpha:h};if(null==l){const e=mI((e,t,n)=>{let r=e_.runKernel(WC,w,k);return n([t,e,r]),g&&(r=RT(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:y}});return e(p,f)}{const e=mI((e,t,n,r)=>{let a=e_.runKernel(WC,w,k);return r([t,e,a,n]),g&&(a=RT(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:y}});return e(p,f,b)}}});const RR=h_({depthwiseConv2dNativeBackpropFilter_:function(e,t,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=e;3===e.rank&&(s=RT(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;3===l.rank&&(l=RT(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const c={x:s,dy:l},u={strides:r,pad:a,dimRoundingMode:o,dilations:i,filterShape:n};return e_.runKernel(wN,c,u)}});const DR=h_({depthwiseConv2dNativeBackpropInput_:function(e,t,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=t,l=!1;3===t.rank&&(l=!0,s=RT(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const c={dy:s,filter:n},u={strides:r,pad:a,dimRoundingMode:o,dilations:i,inputShape:e},h=e_.runKernel(kN,c,u);return l?RT(h,[h.shape[1],h.shape[2],h.shape[3]]):h}});const FR=h_({fusedMatMul_:function(e){let{a:t,b:n,transposeA:r=!1,transposeB:a=!1,bias:i,activation:o="linear",preluActivationWeights:s,leakyreluAlpha:l=.2}=e;if(!1===TR(e_.state.gradientDepth,o)){let e=_A(t,n,r,a);return null!=i&&(e=cI(e,i)),IR(e,o,s,l)}let c=c_(t,"a","fused matMul"),u=c_(n,"b","fused matMul");[c,u]=qE(c,u);const h=r?c.shape[c.rank-2]:c.shape[c.rank-1],d=a?u.shape[u.rank-1]:u.shape[u.rank-2],f=r?c.shape[c.rank-1]:c.shape[c.rank-2],p=a?u.shape[u.rank-2]:u.shape[u.rank-1],g=c.shape.slice(0,-2),m=u.shape.slice(0,-2),v=$w(g),b=$w(m);Kw(h===d,()=>"Error in fused matMul: inner shapes (".concat(h,") and (")+"".concat(d,") of Tensors with shapes ").concat(c.shape," and ")+"".concat(u.shape," and transposeA=").concat(r)+" and transposeB=".concat(a," must match."));const x=FI(c.shape.slice(0,-2),u.shape.slice(0,-2)).concat([f,p]),y=RT(c,r?[v,h,f]:[v,f,h]),w=RT(u,a?[b,p,d]:[b,d,p]);let k,N;null!=i&&(k=c_(i,"bias","fused matMul"),[k]=qE(k,c),FI(x,k.shape)),null!=s&&(N=c_(s,"prelu weights","fused matMul"));const S=(e,t)=>{const[n,s,l,c]=t,u=ER(RT(e,l.shape),l,o);let h,d;if(r||a?!r&&a?(h=_A(u,s,!1,!1),d=_A(u,n,!0,!1)):r&&!a?(h=_A(s,u,!1,!0),d=_A(n,u,!1,!1)):(h=_A(s,u,!0,!0),d=_A(u,n,!0,!0)):(h=_A(u,s,!1,!0),d=_A(n,u,!0,!1)),null!=i){return[h,d,_R(c,u)]}return[h,d]},C={a:y,b:w,bias:k,preluActivationWeights:N},E={transposeA:r,transposeB:a,activation:o,leakyreluAlpha:l};if(null==i){const e=mI((e,t,n)=>{const r=e_.runKernel(zC,C,E);return n([e,t,r]),{value:RT(r,x),gradFunc:S}});return e(y,w)}{const e=mI((e,t,n,r)=>{const a=e_.runKernel(zC,C,E);return r([e,t,a,n]),{value:RT(a,x),gradFunc:S}});return e(y,w,k)}}});const OR=h_({cropAndResize_:function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bilinear",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const o=c_(e,"image","cropAndResize"),s=c_(t,"boxes","cropAndResize","float32"),l=c_(n,"boxInd","cropAndResize","int32"),c=s.shape[0];Kw(4===o.rank,()=>"Error in cropAndResize: image must be rank 4,"+"but got rank ".concat(o.rank,".")),Kw(2===s.rank&&4===s.shape[1],()=>"Error in cropAndResize: boxes must be have size [".concat(c,",4] ")+"but had shape ".concat(s.shape,".")),Kw(1===l.rank&&l.shape[0]===c,()=>"Error in cropAndResize: boxInd must be have size [".concat(c,"] ")+"but had shape ".concat(s.shape,".")),Kw(2===r.length,()=>"Error in cropAndResize: cropSize must be of length 2, but got "+"length ".concat(r.length,".")),Kw(r[0]>=1&&r[1]>=1,()=>"cropSize must be atleast [1,1], but was ".concat(r)),Kw("bilinear"===a||"nearest"===a,()=>"method must be bilinear or nearest, but was ".concat(a));const u={image:o,boxes:s,boxInd:l},h={method:a,extrapolationValue:i,cropSize:r};return e_.runKernel(vN,u,h)}});const LR=h_({flipLeftRight_:function(e){const t=c_(e,"image","flipLeftRight","float32");Kw(4===t.rank,()=>"Error in flipLeftRight: image must be rank 4,"+"but got rank ".concat(t.rank,"."));const n={image:t};return e_.runKernel(BN,n,{})}});const PR=h_({grayscaleToRGB_:function(e){const t=c_(e,"image","grayscaleToRGB"),n=t.rank-1,r=t.shape[n];Kw(t.rank>=2,()=>"Error in grayscaleToRGB: images must be at least rank 2, "+"but got rank ".concat(t.rank,".")),Kw(1===r,()=>"Error in grayscaleToRGB: last dimension of a grayscale image "+"should be size 1, but got size ".concat(r,"."));const a=new Array(t.rank);return a.fill(1,0,n),a[n]=3,iA(t,a)}});const MR=h_({einsum_:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const a=n.map((e,t)=>c_(e,"tensors".concat(t),"einsum")),i={equation:e};return e_.runKernel(TN,a,i)}});const jR=h_({rgbToGrayscale_:function(e){const t=c_(e,"image","RGBToGrayscale"),n=t.rank-1,r=t.shape[n];Kw(t.rank>=2,()=>"Error in RGBToGrayscale: images must be at least rank 2, "+"but got rank ".concat(t.rank,".")),Kw(3===r,()=>"Error in RGBToGrayscale: last dimension of an RGB image "+"should be size 3, but got size ".concat(r,"."));const a=t.dtype,i=oI(t,"float32"),o=uR([.2989,.587,.114]);let s;switch(t.rank){case 2:s=MR("ij,j->i",i,o);break;case 3:s=MR("ijk,k->ij",i,o);break;case 4:s=MR("ijkl,l->ijk",i,o);break;case 5:s=MR("ijklm,m->ijkl",i,o);break;case 6:s=MR("ijklmn,n->ijklm",i,o);break;default:throw new Error("Not a valid tensor rank.")}return s=aA(s,-1),oI(s,a)}});const BR=h_({rotateWithOffset_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;const a=c_(e,"image","rotateWithOffset","float32");Kw(4===a.rank,()=>"Error in rotateWithOffset: image must be rank 4,"+"but got rank ".concat(a.rank,"."));const i={image:a},o={radians:t,fillValue:n,center:r};return e_.runKernel(BC,i,o)}});function zR(e,t,n,r,a,i){null==r&&(r=.5),null==a&&(a=Number.NEGATIVE_INFINITY),null==i&&(i=0);const o=e.shape[0];return n=Math.min(n,o),Kw(0<=r&&r<=1,()=>"iouThreshold must be in [0, 1], but was '".concat(r,"'")),Kw(2===e.rank,()=>"boxes must be a 2D tensor, but was of rank '".concat(e.rank,"'")),Kw(4===e.shape[1],()=>"boxes must have 4 columns, but 2nd dimension was ".concat(e.shape[1])),Kw(1===t.rank,()=>"scores must be a 1D tensor"),Kw(t.shape[0]===o,()=>"scores has incompatible shape with boxes. Expected ".concat(o,", ")+"but was ".concat(t.shape[0])),Kw(0<=i&&i<=1,()=>"softNmsSigma must be in [0, 1], but was '".concat(i,"'")),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i}}const WR=h_({nonMaxSuppression_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY;const i=c_(e,"boxes","nonMaxSuppression","float32"),o=c_(t,"scores","nonMaxSuppression","float32"),s=zR(i,o,n,r,a);n=s.maxOutputSize,r=s.iouThreshold,a=s.scoreThreshold;const l={maxOutputSize:n,iouThreshold:r,scoreThreshold:a};return e_.runKernel(ES,{boxes:i,scores:o},l)}});function UR(e,t,n){const r=function(e,t,n){return function(e,t,n){let r=0,a=e.length,i=0,o=!1;for(;r<a;){i=r+(a-r>>>1);const s=n(t,e[i]);s>0?r=i+1:(a=i,o=!s)}return o?r:-r-1}(e,t,n||VR)}(e,t,n),a=r<0?-(r+1):r;e.splice(a,0,t)}function VR(e,t){return e>t?1:e<t?-1:0}function HR(e,t,n,r,a){return KR(e,t,n,r,a,0)}function GR(e,t,n,r,a,i){return KR(e,t,n,r,a,0,!1,i,!0)}function qR(e,t,n,r,a,i){return KR(e,t,n,r,a,i,!0)}function KR(e,t,n,r,a,i){let o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8&&void 0!==arguments[8]&&arguments[8];const c=[];for(let m=0;m<t.length;m++)t[m]>a&&c.push({score:t[m],boxIndex:m,suppressBeginIndex:0});c.sort($R);const u=i>0?-.5/i:0,h=[],d=[];for(;h.length<n&&c.length>0;){const t=c.pop(),{score:n,boxIndex:i,suppressBeginIndex:o}=t;if(n<a)break;let s=!1;for(let l=h.length-1;l>=o;--l){const n=XR(e,i,h[l]);if(n>=r){s=!0;break}if(t.score=t.score*YR(r,u,n),t.score<=a)break}t.suppressBeginIndex=h.length,s||(t.score===n?(h.push(i),d.push(t.score)):t.score>a&&UR(c,t,$R))}const f=h.length,p=n-f;s&&p>0&&(h.push(...new Array(p).fill(0)),d.push(...new Array(p).fill(0)));const g={selectedIndices:h};return o&&(g.selectedScores=d),l&&(g.validOutputs=f),g}function XR(e,t,n){const r=e.subarray(4*t,4*t+4),a=e.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),c=Math.min(a[0],a[2]),u=Math.min(a[1],a[3]),h=Math.max(a[0],a[2]),d=Math.max(a[1],a[3]),f=(s-i)*(l-o),p=(h-c)*(d-u);if(f<=0||p<=0)return 0;const g=Math.max(i,c),m=Math.max(o,u),v=Math.min(s,h),b=Math.min(l,d),x=Math.max(v-g,0)*Math.max(b-m,0);return x/(f+p-x)}function YR(e,t,n){const r=Math.exp(t*n*n);return n<=e?r:0}function $R(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}const JR=async function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY;const i=c_(e,"boxes","nonMaxSuppressionAsync"),o=c_(t,"scores","nonMaxSuppressionAsync"),s=zR(i,o,n,r,a);n=s.maxOutputSize,r=s.iouThreshold,a=s.scoreThreshold;const l=await Promise.all([i.data(),o.data()]),c=l[0],u=l[1],{selectedIndices:h}=HR(c,u,n,r,a);return i!==e&&i.dispose(),o!==t&&o.dispose(),uR(h,"int32")};const QR=h_({nonMaxSuppressionWithScore_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const o=c_(e,"boxes","nonMaxSuppression"),s=c_(t,"scores","nonMaxSuppression"),l=zR(o,s,n,r,a,i);n=l.maxOutputSize,r=l.iouThreshold,a=l.scoreThreshold,i=l.softNmsSigma;const c={boxes:o,scores:s},u={maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i},h=e_.runKernel(IS,c,u);return{selectedIndices:h[0],selectedScores:h[1]}}});const ZR=async function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const o=c_(e,"boxes","nonMaxSuppressionAsync"),s=c_(t,"scores","nonMaxSuppressionAsync"),l=zR(o,s,n,r,a,i);n=l.maxOutputSize,r=l.iouThreshold,a=l.scoreThreshold,i=l.softNmsSigma;const c=await Promise.all([o.data(),s.data()]),u=c[0],h=c[1],{selectedIndices:d,selectedScores:f}=qR(u,h,n,r,a,i);return o!==e&&o.dispose(),s!==t&&s.dispose(),{selectedIndices:uR(d,"int32"),selectedScores:uR(f)}};const eD=h_({nonMaxSuppressionPadded_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const o=c_(e,"boxes","nonMaxSuppression"),s=c_(t,"scores","nonMaxSuppression"),l=zR(o,s,n,r,a,null),c={boxes:o,scores:s},u={maxOutputSize:l.maxOutputSize,iouThreshold:l.iouThreshold,scoreThreshold:l.scoreThreshold,padToMaxOutputSize:i},h=e_.runKernel(_S,c,u);return{selectedIndices:h[0],validOutputs:h[1]}}});const tD=async function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const o=c_(e,"boxes","nonMaxSuppressionAsync"),s=c_(t,"scores","nonMaxSuppressionAsync"),l=zR(o,s,n,r,a,null),c=l.maxOutputSize,u=l.iouThreshold,h=l.scoreThreshold,[d,f]=await Promise.all([o.data(),s.data()]),{selectedIndices:p,validOutputs:g}=GR(d,f,c,u,h,i);return o!==e&&o.dispose(),s!==t&&s.dispose(),{selectedIndices:uR(p,"int32"),validOutputs:vI(g,"int32")}};const nD=h_({resizeBilinear_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=c_(e,"images","resizeBilinear");Kw(3===a.rank||4===a.rank,()=>"Error in resizeBilinear: x must be rank 3 or 4, but got "+"rank ".concat(a.rank,".")),Kw(2===t.length,()=>"Error in resizeBilinear: new shape must 2D, but got shape "+"".concat(t,".")),Kw(!1===r||!1===n,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=a,o=!1;3===a.rank&&(o=!0,i=RT(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const[]=t,s={images:i},l={alignCorners:n,halfPixelCenters:r,size:t},c=e_.runKernel(qS,s,l);return o?RT(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});const rD=h_({resizeNearestNeighbor_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=c_(e,"images","resizeNearestNeighbor");Kw(3===a.rank||4===a.rank,()=>"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+"rank ".concat(a.rank,".")),Kw(2===t.length,()=>"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+"".concat(t,".")),Kw("float32"===a.dtype||"int32"===a.dtype,()=>"`images` must have `int32` or `float32` as dtype"),Kw(!1===r||!1===n,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=a,o=!1;3===a.rank&&(o=!0,i=RT(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const[]=t,s={images:i},l={alignCorners:n,halfPixelCenters:r,size:t},c=e_.runKernel(HS,s,l);return o?RT(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});const aD=h_({bincount_:function(e,t,n){const r=c_(e,"x","bincount"),a=c_(t,"weights","bincount");Kw("int32"===r.dtype,()=>"Error in bincount: input "+"dtype must be int32, but got ".concat(r.dtype)),Kw(n>=0,()=>"size must be non-negative, but got ".concat(n,".")),Kw(a.size===r.size||0===a.size,()=>"Error in bincount: weights must have the same size as input or"+"0-length, but got input shape: ".concat(r.shape,", weights shape: ")+"".concat(a.shape,"."));const i={x:r,weights:a},o={size:n};return e_.runKernel(Qk,i,o)}});const iD=h_({lessEqual_:function(e,t){let n=c_(e,"a","lessEqual","string_or_numeric"),r=c_(t,"b","lessEqual","string_or_numeric");[n,r]=qE(n,r),FI(n.shape,r.shape);const a={a:n,b:r};return e_.runKernel(tS,a)}});const oD=h_({round_:function(e){const t={x:c_(e,"x","round")};return e_.runKernel($S,t)}});const sD=h_({threshold_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"binary",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;const a=c_(e,"image","threshold"),i=a.shape[0]*a.shape[1];let o,s,l,c,u=dI(uR([r]),255);if(Kw(3===a.rank,()=>"Error in threshold: image must be rank 3,"+"but got rank ".concat(a.rank,".")),Kw(3===a.shape[2]||1===a.shape[2],()=>"Error in threshold: image color channel must be equal to 3 or 1"+"but got ".concat(a.shape[2],".")),Kw("int32"===a.dtype||"float32"===a.dtype,()=>"Error in dtype: image dtype must be int32 or float32,"+"but got dtype ".concat(a.dtype,".")),Kw("otsu"===t||"binary"===t,()=>"Method must be binary or otsu, but was ".concat(t)),3===a.shape[2]){[o,s,l]=oR(a,[1,1,1],-1);const e=dI(o,.2989),t=dI(s,.587),n=dI(l,.114);c=cI(cI(e,t),n)}else c=e;if("otsu"===t){u=function(e,t){let n,r,a,i,o,s,l=uR([-1]),c=uR([0]),u=uR([0]);for(let h=0;h<e.size-1;h++){n=ZA(e,0,h+1),r=ZA(e,h+1),o=hI(gA(n),t),s=hI(gA(r),t);const d=gA(dI(n,KA(0,n.size)));a=hI(d,gA(n));const f=CI(r.shape,n.size),p=cI(KA(0,r.size),f),g=dI(r,p);i=hI(gA(g),gA(r));const m=II(a,i),v=II(a,i),b=dI(o,s);u=dI(dI(b,m),v);const x=cA(u,c);c=pR(x,u,c),l=pR(x,uR([h]),l)}return l}(aD(oI(oD(c),"int32"),p_([]),256),i)}const h=n?iD(c,u):cA(c,u);return oI(dI(h,255),"int32")}});const lD=h_({transform_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"nearest",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"constant",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5?arguments[5]:void 0;const o=c_(e,"image","transform","float32"),s=c_(t,"transforms","transform","float32");Kw(4===o.rank,()=>"Error in transform: image must be rank 4,"+"but got rank ".concat(o.rank,".")),Kw(2===s.rank&&(s.shape[0]===o.shape[0]||1===s.shape[0])&&8===s.shape[1],()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),Kw(null==i||2===i.length,()=>"Error in transform: outputShape must be [height, width] or null, "+"but got ".concat(i,"."));const l={image:o,transforms:s},c={interpolation:n,fillMode:r,fillValue:a,outputShape:i};return e_.runKernel(RC,l,c)}});const cD=h_({less_:function(e,t){let n=c_(e,"a","less","string_or_numeric"),r=c_(t,"b","less","string_or_numeric");[n,r]=qE(n,r),FI(n.shape,r.shape);const a={a:n,b:r};return e_.runKernel(eS,a)}});const uD=h_({bandPart_:function(e,t,n){const r=c_(e,"a","bandPart");Kw(r.rank>=2,()=>"bandPart(): Rank must be at least 2, got ".concat(r.rank,"."));const a=r.shape,[i,o]=r.shape.slice(-2);let s,l;"number"===typeof t?(Kw(t%1===0,()=>"bandPart(): numLower must be an integer, got ".concat(t,".")),Kw(t<=i,()=>"bandPart(): numLower (".concat(t,")")+" must not be greater than the number of rows (".concat(i,").")),s=c_(t<0?i:t,"numLower","bandPart")):(Kw("int32"===t.dtype,()=>"bandPart(): numLower's dtype must be an int32."),s=pR(cD(t,0),i,DA(t,i))),"number"===typeof n?(Kw(n%1===0,()=>"bandPart(): numUpper must be an integer, got ".concat(n,".")),Kw(n<=o,()=>"bandPart(): numUpper (".concat(n,")")+" must not be greater than the number of columns (".concat(o,").")),l=c_(n<0?o:n,"numUpper","bandPart")):(Kw("int32"===n.dtype,()=>"bandPart(): numUpper's dtype must be an int32."),l=pR(cD(n,0),o,DA(n,o)));const c=RT(KA(0,i,1,"int32"),[-1,1]),u=KA(0,o,1,"int32"),h=II(c,u),d=EA(iD(h,s),uA(h,OA(l))),f=MA([i,o],r.dtype);return RT(lR(fR(RT(r,[-1,i,o])).map(e=>pR(d,e,f))),a)}});function hD(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===e.rank)return AI(e);if(1!==e.rank&&null===n)return hD(RT(e,[-1]),t,n);if(1===e.rank||"number"===typeof n||Array.isArray(n)&&1===n.length){if(1===t)return gA(AI(e),n);if(t===1/0)return pA(AI(e),n);if(t===-1/0)return RA(AI(e),n);if("euclidean"===t||2===t)return fI(gA(_I(AI(e),vI(2,"int32")),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}if(Array.isArray(n)&&2===n.length){if(1===t)return pA(gA(AI(e),n[0]),n[1]-1);if(t===1/0)return pA(gA(AI(e),n[1]),n[0]);if(t===-1/0)return RA(gA(AI(e),n[1]),n[0]);if("fro"===t||"euclidean"===t)return fI(gA(pI(e),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}throw new Error("Error in norm: invalid axis: ".concat(n))}const dD=h_({norm_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"euclidean",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=hD(e=c_(e,"x","norm"),t,n);let i=a.shape;if(r){const t=rk(n,e.shape);i=yA(a.shape,t)}return RT(a,i)}});const fD=h_({gramSchmidt_:function(e){let t;if(Array.isArray(e)){t=!1,Kw(null!=e&&e.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const n=e[0].shape[0];for(let t=1;t<e.length;++t)Kw(e[t].shape[0]===n,()=>"Gram-Schmidt: Non-unique lengths found in the input vectors: "+"(".concat(e[t].shape[0]," vs. ").concat(n,")"))}else t=!0,e=oR(e,e.shape[0],0).map(e=>sR(e,[0]));Kw(e.length<=e[0].shape[0],()=>"Gram-Schmidt: Number of vectors (".concat(e.length,") exceeds ")+"number of dimensions (".concat(e[0].shape[0],")."));const n=[],r=e;for(let a=0;a<e.length;++a)n.push(e_.tidy(()=>{let e=r[a];if(a>0)for(let t=0;t<a;++t){const r=dI(gA(dI(n[t],e)),n[t]);e=II(e,r)}return hI(e,dD(e,"euclidean"))}));return t?lR(n,0):n}});function pD(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e_.tidy(()=>{Kw(2===e.shape.length,()=>"qr2d() requires a 2D Tensor, but got a ".concat(e.shape.length,"D Tensor."));const n=e.shape[0],r=e.shape[1];let a=oA(n),i=sI(e);const o=hR([[1]],[1,1]);let s=sI(o);const l=n>=r?r:n;for(let e=0;e<l;++e){const t=i,l=s,c=a;[s,i,a]=e_.tidy(()=>{const t=ZA(i,[e,e],[n-e,1]),l=dD(t),c=ZA(i,[e,e],[1,1]),u=pR(cA(c,0),hR([[-1]]),hR([[1]])),h=II(c,dI(u,l)),d=hI(t,h);s=1===d.shape[0]?sI(o):zT([o,ZA(d,[1,0],[d.shape[0]-1,d.shape[1]])],0);const f=OA(hI(_A(u,h),l)),p=ZA(i,[e,0],[n-e,r]),g=dI(f,s),m=vR(s);if(0===e)i=II(p,_A(g,_A(m,p)));else{const t=II(p,_A(g,_A(m,p)));i=zT([ZA(i,[0,0],[e,r]),t],0)}const v=vR(g),b=ZA(a,[0,e],[n,a.shape[1]-e]);if(0===e)a=II(b,_A(_A(b,s),v));else{const t=II(b,_A(_A(b,s),v));a=zT([ZA(a,[0,0],[n,e]),t],1)}return[s,i,a]}),x_([t,l,c])}return!t&&n>r&&(a=ZA(a,[0,0],[n,r]),i=ZA(i,[0,0],[r,r])),[a,i]})}const gD=h_({qr_:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Kw(e.rank>=2,()=>"qr() requires input tensor to have a rank >= 2, but got rank ".concat(e.rank)),2===e.rank)return pD(e,t);{const n=e.shape.slice(0,e.shape.length-2).reduce((e,t)=>e*t),r=fR(RT(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),a=[],i=[];r.forEach(e=>{const[n,r]=pD(e,t);a.push(n),i.push(r)});return[RT(lR(a,0),e.shape),RT(lR(i,0),e.shape)]}}});var mD;!function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(mD||(mD={}));const vD=h_({squaredDifference_:function(e,t){let n=c_(e,"a","squaredDifference"),r=c_(t,"b","squaredDifference");[n,r]=qE(n,r),FI(n.shape,r.shape);const a={a:n,b:r};return e_.runKernel(xC,a,{})}});const bD={flipLeftRight:LR,grayscaleToRGB:PR,resizeNearestNeighbor:rD,resizeBilinear:nD,rgbToGrayscale:jR,rotateWithOffset:BR,cropAndResize:OR,nonMaxSuppression:WR,nonMaxSuppressionAsync:JR,nonMaxSuppressionWithScore:QR,nonMaxSuppressionWithScoreAsync:ZR,nonMaxSuppressionPadded:eD,nonMaxSuppressionPaddedAsync:tD,threshold:sD,transform:lD},xD={bandPart:uD,gramSchmidt:fD,qr:gD};const yD=class{static sgd(e){return new PI(e)}static momentum(e,t){return new MI(e,t,arguments.length>2&&void 0!==arguments[2]&&arguments[2])}static rmsprop(e){return new jI(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,arguments.length>4&&void 0!==arguments[4]&&arguments[4])}static adam(){return new TI(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null)}static adadelta(){return new SI(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}static adamax(){return new LI(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.002,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,arguments.length>4&&void 0!==arguments[4]?arguments[4]:0)}static adagrad(e){return new EI(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1)}},wD="undefined"!==typeof requestAnimationFrame?requestAnimationFrame:"undefined"!==typeof setImmediate?setImmediate:e=>e();function kD(){return new Promise(e=>wD(()=>e()))}function ND(e,t){const n=e[0].length;e.forEach((e,t)=>{Kw(e.length===n,()=>"Error in concat".concat(n,"D: rank of tensors[").concat(t,"] must be the same ")+"as the rank of the rest (".concat(n,")"))}),Kw(t>=0&&t<n,()=>"Error in concat".concat(n,"D: axis must be between 0 and ").concat(n-1,"."));const r=e[0];e.forEach((e,a)=>{for(let i=0;i<n;i++)Kw(i===t||e[i]===r[i],()=>"Error in concat".concat(n,"D: Shape of tensors[").concat(a,"] (").concat(e,") ")+"does not match the shape of the rest (".concat(r,") ")+"along the non-concatenated axis ".concat(a,"."))})}function SD(e,t){const n=e[0].slice();for(let r=1;r<e.length;r++)n[t]+=e[r][t];return n}var CD;function ED(e,t,n){let r=new Array;if(null==n&&null==t)return r;if(null==t)for(;r.length<e+n.length;)r.push(-1);else r=t.slice();if(null==n)return r;if(e+n.length!==r.length)throw new Error("rt input.shape and shape=".concat(t," are incompatible: rt input.rank = ").concat(e+n.length,", but shape.rank = ").concat(r.length));for(let a=1;a<n.length;++a){const i=n[a],o=r[r.length-n.length+a],s=r[o];if(i>=0)if(s>=0){if(s!==i)throw new Error("rt input.shape and shape=".concat(t," are incompatible: rt input.shape[").concat(a+e,"] = ").concat(i," but shape[").concat(a+e,"] = ").concat(s))}else r[o]=i}return r}function _D(e){const t={FIRST_DIM_SIZE:CD.FIRST_DIM_SIZE,VALUE_ROWIDS:CD.VALUE_ROWIDS,ROW_LENGTHS:CD.ROW_LENGTHS,ROW_SPLITS:CD.ROW_SPLITS,ROW_LIMITS:CD.ROW_LIMITS,ROW_STARTS:CD.ROW_STARTS},n=[];for(const r of e){if(!(r in t))break;n.push(t[r])}return n}function ID(e){return 0===e.length?0:e[0]===CD.FIRST_DIM_SIZE?e.length-1:e.length}function TD(e,t){if(null==e||null==t)return;const n=e.length,r=t.length;if(n>=r)throw new Error("defaultValue.shape=".concat(e," and ragged tensor flatValues.shape=").concat(t,", are incompatible: defaultValue.rank = ").concat(n," must be less than ragged tensor input flatValues.rank = ").concat(r,")"));for(let a=0;a<Math.min(n,r-1);++a){const n=e[a],r=t[a+1];if(n>=0&&r>=0&&1!==n&&n!==r)throw new Error("defaultValue.shape=".concat(e,", and ragged tensor input flatValues.shape=").concat(t," are incompatible: defaultValue.shape[").concat(a-e.length,"] = ").concat(n," but ragged tensor input.flatValues.shape[").concat(a-e.length,"] = ").concat(r))}}!function(e){e[e.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",e[e.VALUE_ROWIDS=1]="VALUE_ROWIDS",e[e.ROW_LENGTHS=2]="ROW_LENGTHS",e[e.ROW_SPLITS=3]="ROW_SPLITS",e[e.ROW_LIMITS=4]="ROW_LIMITS",e[e.ROW_STARTS=5]="ROW_STARTS"}(CD||(CD={}));const AD=30;function RD(e){return e<=AD?e:fk(e,Math.floor(Math.sqrt(e)))}function DD(e,t,n){return[n*("number"===typeof e?e:e[0]),t*("number"===typeof e?e:e[1])]}function FD(e,t,n){let r=[];if(!(arguments.length>3&&void 0!==arguments[3])||arguments[3])r=r.concat(t.slice(0)),r.push(e[0]/n),r=r.concat(e.slice(1));else{r=r.concat(e[0]);const n=t.length;for(let a=0;a<n;++a)r=r.concat([e[a+1]/t[a],t[a]]);r=r.concat(e.slice(n+1))}return r}function OD(e,t){const n=[];if(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]){n.push(t);for(let r=t+1;r<e;++r)r<=2*t?(n.push(r),n.push(r-(t+1))):n.push(r)}else{const r=[],a=[];for(let n=1;n<e;++n)n>=2*t+1||n%2===1?a.push(n):r.push(n);n.push(...r),n.push(0),n.push(...a)}return n}function LD(e,t,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const a=[];r?a.push(e[0]/n):a.push(e[0]*n);for(let i=1;i<e.length;++i)i<=t.length?r?a.push(t[i-1]*e[i]):a.push(e[i]/t[i-1]):a.push(e[i]);return a}function PD(e,t){const n=[0];for(let r=0;r<t;++r)n.push(e[r][0]);return n}function MD(e,t,n){const r=e.slice(0,1);for(let a=0;a<n;++a)r.push(e[a+1]-t[a][0]-t[a][1]);return r}function jD(e,t){const n=e.shape.length,r=t.shape.length;if(n<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher,"+" but the rank was ".concat(n,"."));if(r<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(r,"."));if("int32"!==t.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type,"+" but the dtype was ".concat(t.dtype,"."));if(t.shape[r-1]>n)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+"".concat(t.shape[r-1]," vs. ").concat(n));if(0===$w(e.shape))throw new Error("Requested more than 0 entries, but input is empty."+" Input shape: ".concat(e.shape,"."));const a=t.shape,i=a[a.length-1];let o=1;for(let h=0;h<a.length-1;++h)o*=a[h];const s=e.shape,l=a.slice();l.pop();let c=1;for(let h=i;h<n;++h)c*=s[h],l.push(s[h]);const u=[...pk(e.shape).map(e=>e/c),1].slice(0,i);return[l,o,c,u]}function BD(e,t,n){const r=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + "+"shape[sliceDim:], got updates.shape: ".concat(n.shape)+", indices.shape: ".concat(t.shape,", shape: ").concat(e)+", sliceDim: ".concat(r,", and batchDim: ").concat(a,".");if(n.rank<a)throw new Error(i+" update.rank < ".concat(a,". "));if(e.length<r+(n.rank-a))throw new Error(i+" Output shape length < ".concat(r+(n.rank-a)));if(n.rank!==a+e.length-r)throw new Error(i+" update.rank != ".concat(a+e.length-r));for(let o=0;o<a;++o)if(n.shape[o]!==t.shape[o])throw new Error(i+" updates.shape[".concat(o,"] (").concat(n.shape[o],") != indices.shape[").concat(o,"] (").concat(t.shape[o],")."));for(let o=0;o<n.rank-a;++o)if(n.shape[o+a]!==e[o+r])throw new Error(i+" updates.shape[".concat(o+a,"] (").concat(n.shape[o+a],") != shape[").concat(o+a,"] (").concat(e[o+a],")"))}function zD(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(t.rank,"."));if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher,"+" but the rank was ".concat(e.rank,"."));if("int32"!==t.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: ".concat(t.dtype));if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: ".concat(n));if(0===n.length){if(0===t.size)throw new Error("Indices specified for empty output. indices shape: ".concat(t.shape));if(0===e.size)throw new Error("Updates specified for empty output. updates shape: ".concat(e.shape))}BD(n,t,e)}function WD(e,t,n){const r=t.shape.length,a=r>1?t.shape[r-1]:1,i=n.length;let o=1;for(let l=a;l<i;++l)o*=n[l];const s=a<1?1:a;return{sliceRank:a,numUpdates:$w(t.shape)/s,sliceSize:o,strides:[...pk(n.slice(0,a)),1],outputSize:$w(n)}}const UD=1.7580993408473768,VD=1.0507009873554805,HD=.3275911,GD=.254829592,qD=-.284496736,KD=1.421413741,XD=-1.453152027,YD=1.061405429;function $D(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+"".concat(e.length,", imag: ").concat(t.length,"."));const n=new Float32Array(2*e.length);for(let r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function JD(e){const t=new Float32Array(e.length/2),n=new Float32Array(e.length/2);for(let r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}function QD(e){const t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let a=0;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}function ZD(e){const t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let a=2;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}function eF(e,t){return{real:e[2*t],imag:e[2*t+1]}}function tF(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function nF(e,t){const n=new Float32Array(e/2),r=new Float32Array(e/2);for(let a=0;a<Math.ceil(e/2);a++){const i=(t?2:-2)*Math.PI*(a/e);n[a]=Math.cos(i),r[a]=Math.sin(i)}return{real:n,imag:r}}function rF(e,t,n){const r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}const aF="->",iF=/->/g,oF=",",sF="...";function lF(e,t){const n=((e=e.replace(/\s/g,"")).length-e.replace(iF,"").length)/aF.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error('Equation must contain exactly one arrow ("'.concat(aF,'").'));const[r,a]=e.split(aF);Kw(-1===r.indexOf(sF),()=>'The ellipsis notation ("'.concat(sF,'") is not supported yet.'));const i=r.split(oF),o=i.length;if(t!==o)throw new Error("Expected ".concat(o," input tensors, received ").concat(t));if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const s=[];for(let h=0;h<a.length;++h){const e=a[h];if(!i.some(t=>-1!==t.indexOf(e)))throw new Error("Output subscripts contain the label ".concat(e," ")+"not present in the input subscripts.");-1===s.indexOf(e)&&s.push(e)}for(let h=0;h<r.length;++h){const e=r[h];-1===s.indexOf(e)&&e!==oF&&s.push(e)}const l=new Array(i.length);for(let h=0;h<o;++h){if(new Set(i[h].split("")).size!==i[h].length)throw new Error("Found duplicate axes in input component ".concat(i[h],". ")+"Support for duplicate axes in input is not implemented yet.");l[h]=[];for(let e=0;e<i[h].length;++e)l[h].push(s.indexOf(i[h][e]))}const c=s.length,u=[];for(let h=a.length;h<c;++h)u.push(h);return{allDims:s,summedDims:u,idDims:l}}function cF(e,t){let n=new Array(e);n.fill(-1);for(let a=0;a<t.length;++a)n[t[a]]=a;const r=[];for(let a=0;a<e;++a)-1===n[a]&&r.push(a);return n=n.filter(e=>-1!==e),{permutationIndices:n,expandDims:r}}function uF(e,t,n){const r=new Array(e);for(let a=0;a<n.length;++a){const e=n[a].shape;for(let n=0;n<t[a].length;++n)void 0===r[t[a][n]]?r[t[a][n]]=e[n]:Kw(r[t[a][n]]===e[n],()=>"Expected dimension ".concat(r[t[a][n]]," at axis ").concat(n," ")+"of input shaped ".concat(JSON.stringify(e),", ")+"but got dimension ".concat(e[n]))}}function hF(e,t){const n=e,r=[];let a=0;0===e.length&&n.push(-1),a=e.length+1;for(let o=0;o<a;++o)r.push([]);const i=[];for(let o=0;o<n.length;++o){const e=fF(t,n[o]);for(const t of e)-1===i.indexOf(t)&&(r[o].push(t),i.push(t))}return{path:n,steps:r}}function dF(e){return e.every((e,t)=>e===t)}function fF(e,t){const n=[];for(let r=0;r<e.length;++r)0!==e[r].length&&-1===e[r].indexOf(t)&&-1!==t||n.push(r);return n}function pF(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[];if("number"===typeof t)Kw(e.shape[n]%t===0,()=>"Number of splits must evenly divide the axis."),r=new Array(t).fill(e.shape[n]/t);else{const a=t.reduce((e,t)=>(-1===t&&(e+=1),e),0);Kw(a<=1,()=>"There should be only one negative value in split array.");const i=t.indexOf(-1);if(-1!==i){const r=t.reduce((e,t)=>t>0?e+t:e);t[i]=e.shape[n]-r}Kw(e.shape[n]===t.reduce((e,t)=>e+t),()=>"The sum of sizes must match the size of the axis dimension."),r=t}return r}function gF(e){return"Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = ".concat(e)}function mF(e,t){return"indices(".concat(e,", 0) is invalid: ").concat(t," < 0")}function vF(e,t,n){return"indices(".concat(e,", 0) is invalid: ").concat(t," >= ").concat(n)}function bF(e,t){return"only one output dimension may be -1, not both ".concat(e," and ").concat(t)}function xF(e,t){return"size ".concat(e," must be non-negative, not ").concat(t)}function yF(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function wF(e,t){const n=$w(e),r=$w(t);return"Input to reshape is a SparseTensor with ".concat(n,"\n  dense values, but the requested shape requires a multiple of ").concat(r,". inputShape=").concat(e," outputShape= ").concat(t)}function kF(e,t){const n=$w(e),r=$w(t);return"Input to reshape is a tensor with ".concat(n," dense values, but the requested shape has ").concat(r,". inputShape=").concat(e," outputShape=").concat(t)}function NF(){return"segment ids must be >= 0"}function SF(){return"segment ids are not increasing"}function CF(e,t){return"Segment id ".concat(e," out of range [0, ").concat(t,"), possibly because segmentIds input is not sorted.")}function EF(e,t,n){return"Bad: indices[".concat(e,"] == ").concat(t," out of range [0, ").concat(n,")")}function _F(e,t){let n,r=!1;for(e<=AD?(n=e,r=!0):n=fk(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=fk(e,n+1);return n}function IF(e,t,n){const r=[],a=e.length;for(let i=0;i<a;i++)i!==t?r.push(e[i]):r.push(n);return r}function TF(e,t,n,r){const a=t.shape.length,i=e.shape.length;if(0!==r&&(r<-a||r>a))throw new Error("Expect batchDims in the range of [-".concat(a,", ").concat(a,"], but got ").concat(r));if(r<0&&(r+=a),r>i)throw new Error("batchDims (".concat(r,") must be less than rank(x) (\n    ").concat(i,")."));if(n<r)throw new Error("batchDims (".concat(r,") must be less than or equal to axis (").concat(n,")."));for(let h=0;h<r;++h)if(e.shape[h]!==t.shape[h])throw new Error("x.shape[".concat(h,"]: ").concat(e.shape[h]," should be equal to indices.shape[").concat(h,"]: ").concat(t.shape[h],"."));const o=e.shape[n],s=[];let l=1,c=1,u=1;for(let h=0;h<r;++h)s.push(e.shape[h]),l*=e.shape[h];for(let h=r;h<n;h++)s.push(e.shape[h]),c*=e.shape[h];for(let h=r;h<a;h++)s.push(t.shape[h]);for(let h=n+1;h<i;h++)s.push(e.shape[h]),u*=e.shape[h];return{batchSize:l,sliceSize:u,outerSize:c,dimSize:o,outputShape:s}}function AF(e){try{return e.map(e=>bE(e))}catch(gfe){throw new Error("Failed to decode encoded string bytes into utf-8, error: ".concat(gfe))}}function RF(e){return e.map(e=>vE(e))}function DF(e,t){const n=[];for(let i=0;i<t.length;i++)t[i]&&n.push(i);const r=iI(e,"int32"),a=iI([n.length,e.length],"int32");for(let i=0;i<n.length;i++){const t=r.indexToLoc(n[i]),o=i*e.length;a.values.set(t,o)}return a.toTensor()}!function(){for(const e of BI)kI(e)}();const FF={kernelName:Dk,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>dI(e,CR(oI(n,"float32"),-1))}}},OF={kernelName:Fk,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const t=pI(oI(n,"float32")),r=fI(II(vI(1),t));return OA(hI(e,r))}}}},LF={kernelName:Ok,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const t=fI(II(pI(oI(n,"float32")),1));return hI(e,t)}}}},PF={kernelName:Lk,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,a=FI(n.shape,r.shape);return{a:()=>{let t=e;const r=DI(n.shape,a);return r.length>0&&(t=gA(t,r)),RT(t,n.shape)},b:()=>{let t=e;const n=DI(r.shape,a);return n.length>0&&(t=gA(t,n)),RT(t,r.shape)}}}},MF={kernelName:Pk,saveAllInputs:!0,gradFunc:(e,t)=>{const n={};return t.forEach((t,r)=>{n[r]=()=>e.clone()}),n}},jF={kernelName:Bk,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>gI(n)}}},BF={kernelName:zk,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>gI(n)}}},zF={kernelName:Wk,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>hI(e,fI(II(vI(1),pI(oI(n,"float32")))))}}},WF={kernelName:Uk,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const t=fI(cI(vI(1),pI(oI(n,"float32"))));return hI(e,t)}}}},UF={kernelName:Gk,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,a=FI(n.shape,r.shape);return{a:()=>{const t=cI(pI(n),pI(r));let i=dI(e,hI(r,t));const o=DI(n.shape,a);return o.length>0&&(i=gA(i,o)),RT(i,n.shape)},b:()=>{const t=cI(pI(n),pI(r));let i=OA(dI(e,hI(n,t)));const o=DI(r.shape,a);return o.length>0&&(i=gA(i,o)),RT(i,r.shape)}}}},VF={kernelName:Vk,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>hI(e,cI(pI(oI(n,"float32")),1))}}},HF={kernelName:Hk,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>hI(e,II(vI(1),pI(oI(n,"float32"))))}}};const GF=h_({avgPool3dGrad_:function(e,t,n,r,a,i){const o=c_(e,"dy","avgPool3dGrad"),s=c_(t,"input","avgPool3dGrad");let l=o,c=s,u=!1;4===s.rank&&(u=!0,l=RT(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),c=RT(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),Kw(5===l.rank,()=>"Error in avgPool3dGrad: dy must be rank 5 but got rank "+"".concat(l.rank,".")),Kw(5===c.rank,()=>"Error in avgPool3dGrad: input must be rank 5 but got rank "+"".concat(c.rank,".")),AT("avgPool3dGrad",a,i);const h={dy:l,input:c},d={filterSize:n,strides:r,pad:a,dimRoundingMode:i},f=e_.runKernel(Yk,h,d);return u?RT(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}}),qF={kernelName:Xk,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{filterSize:a,strides:i,pad:o,dimRoundingMode:s}=n;return{x:()=>GF(e,r,a,i,o,s)}}};const KF=h_({avgPoolGrad_:function(e,t,n,r,a){const i=c_(e,"dy","avgPoolGrad"),o=c_(t,"input","avgPoolGrad");Kw(o.rank===i.rank,()=>"Rank of input (".concat(o.rank,") does not match rank of dy (").concat(i.rank,")"));let s=o,l=i,c=!1;3===o.rank&&(c=!0,s=RT(o,[1,o.shape[0],o.shape[1],o.shape[2]]),l=RT(i,[1,i.shape[0],i.shape[1],i.shape[2]])),Kw(4===l.rank,()=>"Error in avgPoolGrad: dy must be rank 4 but got rank "+"".concat(l.rank,".")),Kw(4===s.rank,()=>"Error in avgPoolGrad: input must be rank 4 but got rank "+"".concat(s.rank,"."));const u={dy:l,input:s},h={filterSize:n,strides:r,pad:a},d=e_.runKernel(Kk,u,h);return c?RT(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),XF={kernelName:qk,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{filterSize:a,strides:i,pad:o}=n;return{x:()=>KF(e,r,a,i,o)}}},YF={kernelName:$k,inputsToSave:["a","b"],gradFunc:(e,t,n)=>{const[r,a]=t,{transposeA:i,transposeB:o}=n;return i||o?!i&&o?{a:()=>_A(e,a,!1,!1),b:()=>_A(e,r,!0,!1)}:i&&!o?{a:()=>_A(a,e,!1,!0),b:()=>_A(r,e,!1,!1)}:{a:()=>_A(a,e,!0,!0),b:()=>_A(e,r,!0,!0)}:{a:()=>_A(e,a,!1,!0),b:()=>_A(r,e,!0,!1)}}};const $F=h_({spaceToBatchND_:function(e,t,n){const r=c_(e,"x","spaceToBatchND");Kw(r.rank>=1+t.length,()=>"input rank ".concat(r.rank," should be > than [blockShape] ").concat(t.length)),Kw(n.length===t.length,()=>"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(t.length)),Kw(r.shape.reduce((e,r,a)=>a>0&&a<=t.length?e&&(r+n[a-1][0]+n[a-1][1])%t[a-1]===0:e,!0),()=>"input spatial dimensions ".concat(r.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(t.toString()));const a={x:r},i={blockShape:t,paddings:n};return e_.runKernel(hC,a,i)}}),JF={kernelName:Jk,gradFunc:(e,t,n)=>{const{blockShape:r,crops:a}=n;return{x:()=>$F(e,r,a)}}},QF={kernelName:"BroadcastTo",gradFunc:(e,t,n)=>{const r=n,a=r.inputShape,i=r.shape,o=Array.from(i);for(let l=a.length-1;l>=0;l--)if(a[l]===i[l])o[l]=1;else if(1!==a[l])throw new Error("broadcastTo(): [".concat(a,"] cannot be broadcast to [").concat(i,"]."));const s=[];for(let l=0;l<o.length;l++)o[l]>1&&s.push(l);return{x:()=>gA(e,s,!0)}}},ZF={kernelName:tN,gradFunc:e=>({x:()=>e.clone()})},eO={kernelName:nN,gradFunc:e=>({x:()=>gI(e)})},tO={kernelName:rN,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{clipValueMin:a,clipValueMax:i}=n;return{x:()=>pR(EA(uA(r,a),iD(r,i)),e,gI(e))}}},nO={kernelName:iN,inputsToSave:["x"],gradFunc:FF.gradFunc},rO={kernelName:oN,saveAllInputs:!0,gradFunc:(e,t,n)=>{const r=t.map(e=>e.shape),{axis:a}=n,i=rk(a,t[0].shape)[0],o=r.map(e=>e[i]);return oR(e,o,i).map(e=>()=>e)}},aO={kernelName:sN,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const[r,a]=t,{dilations:i,strides:o,pad:s,dataFormat:l}=n;return Kw(ET(i),()=>"Error in gradient of conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(i,"'")),{x:()=>KT(r.shape,e,a,o,s,l),filter:()=>NR(r,e,a.shape,o,s,l)}}},iO={kernelName:cN,inputsToSave:["dy","filter"],gradFunc:(e,t,n)=>{const[r,a]=t,{strides:i,pad:o,dataFormat:s,dimRoundingMode:l}=n;return{dy:()=>GT(e,a,i,o,s,1,l),filter:()=>NR(e,r,a.shape,i,o,s,l)}}};const oO=h_({conv3DBackpropFilter_:function(e,t,n,r,a){let i=e;4===e.rank&&(i=RT(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));let o=t;4===o.rank&&(o=RT(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),Kw(5===i.rank,()=>"Error in conv3dDerFilter: input must be rank 5, but got shape "+"".concat(i.shape,".")),Kw(5===o.rank,()=>"Error in conv3dDerFilter: dy must be rank 5, but got shape "+"".concat(o.shape,".")),Kw(5===n.length,()=>"Error in conv3dDerFilter: filterShape must be length 5, but got "+"".concat(n,".")),Kw(i.shape[4]===n[3],()=>"Error in conv3dDerFilter: depth of input ".concat(i.shape[4],") must ")+"match input depth in filter (".concat(n[3],".")),Kw(o.shape[4]===n[4],()=>"Error in conv3dDerFilter: depth of dy (".concat(o.shape[4],") must ")+"match output depth for filter (".concat(n[4],")."));const s={x:i,dy:o},l={strides:r,pad:a,filterShape:n};return e_.runKernel(hN,s,l)}}),sO={kernelName:uN,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const{dilations:r,strides:a,pad:i}=n;Kw(ET(r),()=>"Error in gradient of conv3D: dilation rates greater than 1 are "+"not yet supported in gradients. Got dilations '".concat(r,"'"));const[o,s]=t;return{x:()=>$T(o.shape,e,s,a,i),filter:()=>oO(o,e,s.shape,a,i)}}};const lO=h_({sin_:function(e){const t={x:c_(e,"x","sin","float32")};return e_.runKernel(aC,t)}}),cO={kernelName:fN,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>dI(OA(lO(oI(n,"float32"))),e)}}};const uO=h_({sinh_:function(e){const t={x:c_(e,"x","sinh")};return e_.runKernel(iC,t)}}),hO={kernelName:pN,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>dI(uO(oI(n,"float32")),e)}}};const dO=h_({cumsum_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a={x:c_(e,"x","cumsum")},i={axis:t,exclusive:n,reverse:r};return e_.runKernel(mN,a,i)}}),fO={kernelName:mN,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{axis:a,exclusive:i,reverse:o}=n;return{x:()=>{const t=kA([a],r.rank);let n=dO(e,a,i,!o);return null!=t&&(n=vR(n,t)),n}}}},pO={kernelName:yN,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const{dilations:r,strides:a,pad:i,dimRoundingMode:o}=n,s=null==r?[1,1]:r;Kw(ET(s),()=>"Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(s,"'"));const[l,c]=t;return Kw(4===l.rank,()=>"Error in gradient of depthwiseConv2dNative: input must be "+"rank 4, but got rank ".concat(l.rank,".")),Kw(4===c.rank,()=>"Error in gradient of depthwiseConv2dNative: filter must be "+"rank 4, but got rank ".concat(c.rank,".")),Kw(l.shape[3]===c.shape[2],()=>"Error in gradient of depthwiseConv2d: number of input "+"channels (".concat(l.shape[3],") must match the inChannels dimension ")+"in filter ".concat(c.shape[2],".")),Kw(_T(a,s),()=>"Error in gradient of depthwiseConv2d: Either strides or "+"dilations must be  1. Got strides ".concat(a," and dilations ")+"'".concat(s,"'.")),AT("depthwiseConv2d",i,o),{x:()=>DR(l.shape,e,c,a,i,s,o),filter:()=>RR(l,e,c.shape,a,i,s,o)}}},gO={kernelName:SN,inputsToSave:["x","filter"],gradFunc:(e,t,n)=>{const[r,a]=t,i={x:r,filter:a,dy:e},o={x:r,filter:a,dy:e};return{x:()=>e_.runKernel(CN,i,n),filter:()=>e_.runKernel(EN,o,n)}}},mO={kernelName:AN,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t,r={dy:e,y:n};return{x:()=>e_.runKernel(RN,r)}}},vO={kernelName:DN,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t,r=dI(rA(OA(pI(n))),2/Math.sqrt(Math.PI));return{x:()=>dI(e,r)}}},bO={kernelName:ON,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>dI(e,n)}}},xO={kernelName:LN,inputsToSave:["input"],gradFunc:(e,t)=>{const[n]=t;return{input:()=>RT(e,n.shape)}}},yO={kernelName:PN,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>dI(e,rA(n))}}},wO={kernelName:zN,gradFunc:e=>({x:()=>gI(e)})},kO={kernelName:WN,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,a=FI(n.shape,r.shape);return{a:()=>{const t=hI(e,oI(r,"float32")),i=DI(n.shape,a);return i.length>0?RT(gA(t,i),n.shape):t},b:()=>{let t=dI(e,oI(n,"float32"));const i=DI(r.shape,a);i.length>0&&(t=RT(gA(t,i),r.shape));const o=pI(r);return OA(hI(t,oI(o,"float32")))}}}};const NO=h_({rsqrt_:function(e){const t={x:c_(e,"x","rsqrt","float32")};return e_.runKernel(JS,t)}}),SO={kernelName:UN,inputsToSave:["x","mean","variance","scale"],gradFunc:(e,t,n)=>{const{varianceEpsilon:r}=n,[a,i,o,s]=t,l=null==s?vI(1):s,c=DI(i.shape,a.shape),u=[];if(1===i.rank){for(let e=0;e<a.shape.length-1;++e)u.push(a.shape[e]);u.push(1)}const h=II(a,i),d=dI(e,l),f=NO(cI(o,vI(r))),p=dI(dI(dI(f,f),f),vI(-.5));return{x:()=>1===i.rank?RT(dI(dI(e,iA(RT(f,[1,1,1,i.shape[0]]),u)),l),a.shape):RT(dI(dI(e,f),l),a.shape),mean:()=>{let e=dI(dI(f,vI(-1)),d);return 1===i.rank&&(e=gA(e,c)),RT(e,i.shape)},variance:()=>{let e=dI(dI(p,h),d);return 1===i.rank&&(e=gA(e,c)),RT(e,i.shape)},scale:()=>{const t=dI(h,f);let n=dI(e,t);return 1===i.rank&&(n=gA(n,c)),RT(n,i.shape)},offset:()=>{let t=e;return 1===i.rank&&(t=gA(t,c)),RT(t,i.shape)}}}};const CO=h_({unsortedSegmentSum_:function(e,t,n){const r=c_(e,"x","unsortedSegmentSum"),a=c_(t,"segmentIds","unsortedSegmentSum","int32");Kw(Qw(n),()=>"numSegments must be of dtype int");const i={x:r,segmentIds:a},o={numSegments:n};return e_.runKernel(LC,i,o)}}),EO={kernelName:VN,inputsToSave:["x","indices"],gradFunc:(e,t,n)=>{const[r,a]=t,{axis:i,batchDims:o}=n,s=rk(i,r.shape)[0],l=(e,t,n)=>()=>{const r=e.shape,a=t.size,o=r.slice(0,s),l=o.length,c=r.slice(i,r.length).slice(1),u=c.length,h=_O(0,l),d=_O(l+1,l+1+u),f=IO([o,[a],c]),p=RT(n,f),g=RT(t,[a]),m=IO([[l],h,d]),v=vR(p,m);let b=CO(v,g,e.shape[s]);const x=NA(m);return b=vR(b,x),b};if(1===o){const t=r.shape[0],n=r.split(t,0),i=()=>{const t=lR(n.map((t,n)=>l(t,a.slice(n,1),e.slice(n,1))()));return t.reshape(r.shape)};return{x:i,indices:()=>a}}return{x:l(r,a,e),indices:()=>a}}};function _O(e,t){const n=[];for(let r=e;r<t;++r)n.push(r);return n}function IO(e){const t=[];for(let n=0;n<e.length;++n)for(let r=0;r<e[n].length;++r)t.push(e[n][r]);return t}const TO={kernelName:qN,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t;return{a:()=>gI(n),b:()=>gI(r)}}},AO={kernelName:KN,gradFunc:e=>({x:()=>oI(e,"float32")})},RO={kernelName:$N,gradFunc:e=>({x:()=>gI(e)})},DO={kernelName:JN,gradFunc:e=>({x:()=>gI(e)})},FO={kernelName:QN,gradFunc:e=>({x:()=>gI(e)})},OO={kernelName:ZN,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{alpha:a}=n,i=cA(r,0);return{x:()=>pR(i,e,dI(e,a))}}},LO={kernelName:aS,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>hI(e,cI(n,1))}}},PO={kernelName:rS,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>hI(e,oI(n,"float32"))}}},MO={kernelName:"LogSoftmax",inputsToSave:[],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r]=t,{axis:a}=n;return{logits:()=>{const t=rA(r);return II(e,dI(gA(e,a,!0),t))}}}};const jO=h_({localResponseNormalizationBackprop_:function(e,t,n){const r={x:e,y:t,dy:n},a={depthRadius:arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,bias:arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,alpha:arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,beta:arguments.length>6&&void 0!==arguments[6]?arguments[6]:.5};return e_.runKernel(cS,r,a)}}),BO={kernelName:lS,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r,a]=t,{depthRadius:i,bias:o,alpha:s,beta:l}=n;return{x:()=>jO(r,a,e,i,o,s,l)}}};function zO(e,t,n,r){return t.rank<n.rank&&(t=RT(t,yA(t.shape,r))),e.rank<n.rank&&(e=RT(e,yA(e.shape,r))),{x:()=>dI(e,oI(tA(n,t),e.dtype))}}const WO={kernelName:uS,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const r=n,{reductionIndices:a}=r,i=t[0],o=zO(e,t[1],i,rk(a,i.shape));return{x:()=>o.x()}}},UO={kernelName:hS,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t;return{a:()=>dI(e,oI(uA(n,r),"float32")),b:()=>dI(e,oI(cD(n,r),"float32"))}}};const VO=h_({maxPool3dGrad_:function(e,t,n,r,a,i,o){const s=c_(e,"dy","maxPool3dGrad"),l=c_(t,"input","maxPool3dGrad"),c=c_(n,"output","maxPool3dGrad");let u=s,h=l,d=c,f=!1;4===l.rank&&(f=!0,u=RT(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]),h=RT(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),d=RT(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),Kw(5===u.rank,()=>"Error in maxPool3dGrad: dy must be rank 5 but got rank "+"".concat(u.rank,".")),Kw(5===h.rank,()=>"Error in maxPool3dGrad: input must be rank 5 but got rank "+"".concat(h.rank,".")),Kw(5===d.rank,()=>"Error in maxPool3dGrad: output must be rank 5 but got rank "+"".concat(d.rank,".")),AT("maxPool3dGrad",i,o);const p={dy:u,input:h,output:d},g={filterSize:r,strides:a,pad:i,dimRoundingMode:o},m=e_.runKernel(gS,p,g);return f?RT(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}}),HO={kernelName:pS,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r,a]=t,{filterSize:i,strides:o,pad:s,dimRoundingMode:l}=n;return{x:()=>VO(e,r,a,i,o,s,l)}}};const GO=h_({maxPoolGrad_:function(e,t,n,r,a,i,o){const s=c_(e,"dy","maxPoolGrad"),l=c_(t,"input","maxPoolGrad"),c=c_(n,"output","maxPoolGrad");Kw(l.rank===s.rank,()=>"Rank of input (".concat(l.rank,") does not match rank of dy ")+"(".concat(s.rank,")")),Kw(4===s.rank,()=>"Error in maxPoolGrad: dy must be rank 4 but got rank "+"".concat(s.rank,".")),Kw(4===l.rank,()=>"Error in maxPoolGrad: input must be rank 4 but got rank "+"".concat(l.rank,".")),AT("maxPoolGrad",i,o);const u={dy:s,input:l,output:c},h={filterSize:r,strides:a,pad:i,dimRoundingMode:o};return e_.runKernel(fS,u,h)}}),qO={kernelName:dS,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r,a]=t,{filterSize:i,strides:o,pad:s}=n;return{x:()=>GO(e,r,a,i,o,s)}}},KO={kernelName:vS,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{axis:a}=n,i=rk(a,r.shape),o=$w(xA(r.shape,i)[1]);return{x:()=>{const t=r.shape.slice();i.forEach(e=>{t[e]=1});const n=RT(e,t);return hI(dI(n,jA(r.shape,"float32")),o)}}}},XO={kernelName:bS,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(e,t,n)=>{const r=n,{axis:a}=r,[i,o]=t,s=zO(e,o,i,rk(a,i.shape));return{x:()=>s.x()}}},YO={kernelName:xS,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t;return{a:()=>dI(e,oI(iD(n,r),"float32")),b:()=>dI(e,oI(cA(n,r),"float32"))}}},$O={kernelName:yS,inputsToSave:["x"],gradFunc:(e,t,n)=>{const r=t[0],{paddings:a}=n,i=a.map(e=>e[0]);return{x:()=>ZA(e,i,r.shape)}}},JO={kernelName:wS,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,a=FI(n.shape,r.shape);return{a:()=>{const t=DI(n.shape,a);return t.length>0?RT(gA(e,t),n.shape):e},b:()=>{const t=dI(e,OA(sA(hI(n,r)))),i=DI(r.shape,a);return i.length>0?RT(gA(t,i),r.shape):t}}}},QO={kernelName:NS,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,a=FI(n.shape,r.shape);return{a:()=>{const t=dI(e,oI(r,"float32")),i=DI(n.shape,a);return i.length>0?RT(gA(t,i),n.shape):t},b:()=>{const t=dI(e,oI(n,"float32")),i=DI(r.shape,a);return i.length>0?RT(gA(t,i),r.shape):t}}}},ZO={kernelName:SS,gradFunc:e=>({x:()=>OA(e)})},eL={kernelName:AS,inputsToSave:["indices"],gradFunc:(e,t)=>{const n=t[0];return{indices:()=>MA(n.shape,"float32")}}},tL={kernelName:TS,gradFunc:e=>({x:()=>gI(e)})},nL={kernelName:RS,saveAllInputs:!0,gradFunc:(e,t,n)=>{const{axis:r}=n;return fR(e,r).map(e=>()=>e)}},rL={kernelName:DS,inputsToSave:["x"],gradFunc:(e,t,n)=>{const r=t[0],{paddings:a}=n,i=a.map(e=>e[0]);return{x:()=>ZA(e,i,r.shape)}}},aL={kernelName:FS,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(e,t)=>{const[n,r,a]=t,i=n,o=r,s=FI(i.shape,o.shape);return{a:()=>{const t=oI(o,"float32");let n=dI(e,dI(t,_I(i,II(t,vI(1)))));const r=DI(i.shape,s);return r.length>0&&(n=gA(n,r)),RT(n,i.shape)},b:()=>{const t=cA(i,0),n=pR(t,dA(i),gI(i));let r=dI(e,dI(a,n));const l=DI(o.shape,s);return l.length>0&&(r=gA(r,l)),RT(r,o.shape)}}}},iL={kernelName:OS,inputsToSave:["x","alpha"],gradFunc:(e,t)=>{const[n,r]=t,a=cA(n,0);return{x:()=>pR(a,e,dI(e,r)),alpha:()=>{let t=pR(a,gI(e),dI(e,n));const i=DI(r.shape,e.shape);return i.length>0&&(t=gA(t,i)),RT(t,r.shape)}}}};const oL=h_({cumprod_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a={x:c_(e,"x","cumprod")},i={axis:t,exclusive:n,reverse:r};return e_.runKernel(gN,a,i)}});function sL(e,t,n){const r=e.shape.length,a=r-n.length,i=kA(n,r);let o=e;null!=i&&(o=vR(e,i));const s=o.shape.slice(),l=s.splice(r-n.length,n.length).reduce((e,t)=>e*t,1);s.push(l);let c=function(e,t,n){const r=e.shape.slice();r[n]=1;const a=RT(t,r),i=oL(e,n,!0,!1),o=oL(e,n,!0,!0),s=dI(i,o);return dI(a,s)}(o.reshape(s),t,a);if(c=c.reshape(o.shape),null!=i){const e=NA(i);c=vR(c,e)}return c}const lL={kernelName:LS,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{axis:a}=n;let i=[];return i=void 0===a||null===a?r.shape.map((e,t)=>t):"number"===typeof a?[a]:a,{x:()=>sL(r,e,i)}}},cL={kernelName:IN,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,a=FI(n.shape,r.shape);return{a:()=>{const t=hI(e,oI(r,"float32")),i=DI(n.shape,a);return i.length>0?RT(gA(t,i),n.shape):t},b:()=>{let t=dI(e,oI(n,"float32"));const i=DI(r.shape,a);i.length>0&&(t=RT(gA(t,i),r.shape));const o=pI(r);return OA(hI(t,oI(o,"float32")))}}}},uL={kernelName:WS,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>hI(e,OA(pI(n)))}}},hL={kernelName:XS,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t,r=dI(iD(n,6),CR(n));return{x:()=>dI(e,oI(r,"float32"))}}},dL={kernelName:US,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>dI(e,oI(CR(n),"float32"))}}},fL={kernelName:VS,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>RT(e,n.shape)}}},pL={kernelName:qS,inputsToSave:["images"],gradFunc:(e,t,n)=>{const[r]=t,a={dy:e,images:r};return{images:()=>e_.runKernel(KS,a,n)}}},gL={kernelName:HS,inputsToSave:["images"],gradFunc:(e,t,n)=>{const[r]=t,a={dy:e,images:r};return{images:()=>e_.runKernel(GS,a,n)}}},mL={kernelName:YS,gradFunc:(e,t,n)=>{const{dims:r}=n,a=rk(r,e.shape);return{x:()=>YA(e,a)}}},vL={kernelName:$S,gradFunc:e=>({x:()=>gI(e)})},bL={kernelName:JS,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>OA(hI(e,dI(_I(n,1.5),2)))}}};const xL=h_({logicalNot_:function(e){const t={x:c_(e,"x","logicalNot","bool")};return e_.runKernel(oS,t)}}),yL={kernelName:tC,inputsToSave:["condition"],gradFunc:(e,t)=>{const[n]=t;return{condition:()=>oI(gI(n),"float32"),t:()=>dI(e,oI(n,e.dtype)),e:()=>dI(e,oI(xL(n),e.dtype))}}},wL={kernelName:nC,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>{const t=cA(n,vI(0)),r=vI(UD),a=vI(VD),i=dI(e,a),o=dI(dI(e,r),rA(oI(n,"float32")));return pR(t,i,o)}}}},kL={kernelName:sC,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>dI(e,dI(n,II(vI(1),n)))}}},NL={kernelName:oC,gradFunc:e=>({x:()=>gI(e)})};const SL=h_({cos_:function(e){const t={x:c_(e,"x","cos","float32")};return e_.runKernel(fN,t)}}),CL={kernelName:aC,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>dI(SL(oI(n,"float32")),e)}}};const EL=h_({cosh_:function(e){const t={x:c_(e,"x","cosh","float32")};return e_.runKernel(pN,t)}}),_L={kernelName:iC,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>dI(EL(oI(n,"float32")),e)}}},IL={kernelName:rC,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{begin:a,size:i}=n,o=r.shape,[s,l]=uT(r,a,i),c=[];for(let u=0;u<e.rank;u++)c.push([s[u],o[u]-s[u]-l[u]]);return{x:()=>zA(e,c)}}},TL={kernelName:fC,outputsToSave:[!0],gradFunc:(e,t,n)=>{const[r]=t,{dim:a}=n,i=dI(e,r);return{logits:()=>II(i,dI(gA(i,[a],true),r))}}},AL={kernelName:lC,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>dI(e,QA(n))}}};const RL=h_({batchToSpaceND_:function(e,t,n){const r=c_(e,"x","batchToSpaceND"),a=t.reduce((e,t)=>e*t);Kw(r.rank>=1+t.length,()=>"input rank is ".concat(r.rank," but should be > than blockShape.length ").concat(t.length)),Kw(n.length===t.length,()=>"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(t.length)),Kw(r.shape[0]%a===0,()=>"input tensor batch is ".concat(r.shape[0]," but is not divisible by the product of ")+"the elements of blockShape ".concat(t.join(" * ")," === ").concat(a));const i={x:r},o={blockShape:t,crops:n};return e_.runKernel(Jk,i,o)}}),DL={kernelName:hC,gradFunc:(e,t,n)=>{const{blockShape:r,paddings:a}=n;return{x:()=>RL(e,r,a)}}},FL={kernelName:dC,gradFunc:(e,t,n)=>{const{axis:r}=n;return{x:()=>zT(e,r)}}},OL={kernelName:cC,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>hI(e,dI(fI(oI(n,"float32")),2))}}},LL={kernelName:yC,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>dI(e,dI(oI(n,"float32"),2))}}},PL={kernelName:xC,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,a=vI(2);return{a:()=>dI(e,dI(a,II(n,r))),b:()=>dI(e,dI(a,II(r,n)))}}},ML={kernelName:EC,inputsToSave:["a","b"],gradFunc:(e,t)=>{const[n,r]=t,a=FI(n.shape,r.shape);return{a:()=>{let t=e;const r=DI(n.shape,a);return r.length>0&&(t=gA(t,r)),RT(t,n.shape)},b:()=>{let t=e;const n=DI(r.shape,a);return n.length>0&&(t=gA(t,n)),RT(OA(t),r.shape)}}}},jL={kernelName:uC,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,a=r.shape.slice(),{axis:i}=n;rk(i,r.shape).forEach(e=>{a[e]=1});const o=RT(e,a),s=dI(o,jA(r.shape,"float32"));return{x:()=>s}}},BL={kernelName:_C,inputsToSave:["x"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>hI(e,pI(SL(n)))}}},zL={kernelName:IC,outputsToSave:[!0],gradFunc:(e,t)=>{const[n]=t;return{x:()=>dI(II(vI(1),pI(n)),e)}}},WL={kernelName:TC,inputsToSave:["x"],gradFunc:(e,t,n)=>{const[r]=t,{reps:a}=n;return{x:()=>{let t=gI(r);if(1===r.rank)for(let n=0;n<a[0];++n)t=cI(t,ZA(e,[n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(let n=0;n<a[0];++n)for(let i=0;i<a[1];++i)t=cI(t,ZA(e,[n*r.shape[0],i*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(let n=0;n<a[0];++n)for(let i=0;i<a[1];++i)for(let o=0;o<a[2];++o)t=cI(t,ZA(e,[n*r.shape[0],i*r.shape[1],o*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+"".concat(r.rank," tensors yet."));for(let n=0;n<a[0];++n)for(let i=0;i<a[1];++i)for(let o=0;o<a[2];++o)for(let s=0;s<a[3];++s)t=cI(t,ZA(e,[n*r.shape[0],i*r.shape[1],o*r.shape[2],s*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return t}}}},UL={kernelName:LC,inputsToSave:["segmentIds"],gradFunc:(e,t)=>{const[n]=t;return{x:()=>function(e,t){const n=OI(t,gI(t)),r=lA(e,n);let a=uA(t,vI(0,"int32"));const i=r.rank-a.rank;for(let s=0;s<i;++s)a=aA(a,s+1);a=EA(a,jA(r.shape,"bool"));const o=gI(r);return pR(a,r,o)}(e,n)}}};const VL=[FF,OF,LF,PF,MF,jF,BF,zF,WF,UF,VF,HF,qF,XF,YF,JF,QF,ZF,eO,tO,nO,rO,iO,aO,sO,cO,hO,fO,pO,gO,cL,mO,vO,bO,xO,yO,kO,wO,SO,EO,TO,AO,RO,DO,FO,OO,LO,PO,MO,BO,WO,WO,UO,HO,qO,KO,XO,YO,$O,JO,QO,ZO,eL,tL,nL,rL,rL,aL,iL,lL,uL,hL,dL,fL,pL,gL,mL,vL,bL,yL,wL,kL,NL,CL,_L,IL,TL,AL,DL,DL,FL,FL,OL,PL,LL,{kernelName:MC,gradFunc:e=>({x:()=>gI(e)})},ML,jL,BL,zL,WL,{kernelName:DC,gradFunc:(e,t,n)=>{const r=n,{perm:a}=r,i=NA(a);return{x:()=>vR(e,i)}}},{kernelName:OC,gradFunc:(e,t,n)=>{const r=n,{axis:a}=r;return{value:()=>lR(e,a)}}},UL,{kernelName:PC,gradFunc:e=>({x:()=>gI(e)})}];for(const n of VL)JC(n);OE().prototype.abs=function(){return this.throwIfDisposed(),AI(this)};const HL=h_({acos_:function(e){const t={x:c_(e,"x","acos")};return e_.runKernel(Fk,t)}});OE().prototype.acos=function(){return this.throwIfDisposed(),HL(this)};const GL=h_({acosh_:function(e){const t={x:c_(e,"x","acosh")};return e_.runKernel(Ok,t)}});OE().prototype.acosh=function(){return this.throwIfDisposed(),GL(this)},OE().prototype.add=function(e){return this.throwIfDisposed(),cI(this,e)},OE().prototype.all=function(e,t){return this.throwIfDisposed(),fT(this,e,t)},OE().prototype.any=function(e,t){return this.throwIfDisposed(),pT(this,e,t)},OE().prototype.argMax=function(e){return this.throwIfDisposed(),gT(this,e)};const qL=h_({argMin_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:c_(e,"x","argMin")},r={axis:t};return e_.runKernel(zk,n,r)}});OE().prototype.argMin=function(e){return this.throwIfDisposed(),qL(this,e)},OE().prototype.asScalar=function(){return this.throwIfDisposed(),Kw(1===this.size,()=>"The array must have only 1 element."),RT(this,[])},OE().prototype.asType=function(e){return this.throwIfDisposed(),oI(this,e)},OE().prototype.as1D=function(){return this.throwIfDisposed(),RT(this,[this.size])},OE().prototype.as2D=function(e,t){return this.throwIfDisposed(),RT(this,[e,t])},OE().prototype.as3D=function(e,t,n){return this.throwIfDisposed(),RT(this,[e,t,n])},OE().prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),RT(this,[e,t,n,r])},OE().prototype.as5D=function(e,t,n,r,a){return this.throwIfDisposed(),RT(this,[e,t,n,r,a])};const KL=h_({asin_:function(e){const t={x:c_(e,"x","asin")};return e_.runKernel(Wk,t)}});OE().prototype.asin=function(){return this.throwIfDisposed(),KL(this)};const XL=h_({asinh_:function(e){const t={x:c_(e,"x","asinh")};return e_.runKernel(Uk,t)}});OE().prototype.asinh=function(){return this.throwIfDisposed(),XL(this)};const YL=h_({atan_:function(e){const t={x:c_(e,"x","atan")};return e_.runKernel(Vk,t)}});OE().prototype.atan=function(){return this.throwIfDisposed(),YL(this)};const $L=h_({atan2_:function(e,t){let n=c_(e,"a","atan2"),r=c_(t,"b","atan2");[n,r]=qE(n,r);const a={a:n,b:r};return e_.runKernel(Gk,a)}});OE().prototype.atan2=function(e){return this.throwIfDisposed(),$L(this,e)};const JL=h_({atanh_:function(e){const t={x:c_(e,"x","atanh")};return e_.runKernel(Hk,t)}});OE().prototype.atanh=function(){return this.throwIfDisposed(),JL(this)},OE().prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),DT(this,e,t,n,r)},OE().prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),RL(this,e,t)},OE().prototype.batchNorm=function(e,t,n,r,a){return this.throwIfDisposed(),OT(this,e,t,n,r,a)},OE().prototype.broadcastTo=function(e){return this.throwIfDisposed(),jT(this,e)},OE().prototype.cast=function(e){return this.throwIfDisposed(),oI(this,e)};const QL=h_({ceil_:function(e){const t={x:c_(e,"x","ceil","float32")};return e_.runKernel(nN,t)}});OE().prototype.ceil=function(){return this.throwIfDisposed(),QL(this)},OE().prototype.clipByValue=function(e,t){return this.throwIfDisposed(),BT(this,e,t)},OE().prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof FE&&(e=[e]),zT([this,...e],t)},OE().prototype.conv1d=function(e,t,n,r,a,i){return this.throwIfDisposed(),qT(this,e,t,n,r,a,i)},OE().prototype.conv2dTranspose=function(e,t,n,r,a){return this.throwIfDisposed(),XT(this,e,t,n,r,a)},OE().prototype.conv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),GT(this,e,t,n,r,a,i)},OE().prototype.cos=function(){return this.throwIfDisposed(),SL(this)},OE().prototype.cosh=function(){return this.throwIfDisposed(),EL(this)},OE().prototype.cumprod=function(e,t,n){return this.throwIfDisposed(),oL(this,e,t,n)},OE().prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),dO(this,e,t,n)};const ZL=h_({depthToSpace_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NHWC";const r=c_(e,"x","depthToSpace","float32"),a="NHWC"===n?r.shape[1]:r.shape[2],i="NHWC"===n?r.shape[2]:r.shape[3],o="NHWC"===n?r.shape[3]:r.shape[1];Kw(t>1,()=>"blockSize should be > 1 for depthToSpace, but was: ".concat(t)),Kw(a*t>=0,()=>"Negative dimension size caused by overflow when multiplying\n    ".concat(a," and ").concat(t,"  for depthToSpace with input shape\n    ").concat(r.shape)),Kw(i*t>=0,()=>"Negative dimension size caused by overflow when multiplying\n    ".concat(i," and ").concat(t," for depthToSpace with input shape\n        ").concat(r.shape)),Kw(o%(t*t)===0,()=>"Dimension size must be evenly divisible by ".concat(t*t," but is ").concat(o," for depthToSpace with input shape ").concat(r.shape));const s={x:r},l={blockSize:t,dataFormat:n};return e_.runKernel(xN,s,l)}});OE().prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),ZL(this,e,t)},OE().prototype.depthwiseConv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),ZT(this,e,t,n,r,a,i)};const eP=h_({dilation2d_:function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC";const o=c_(e,"x","dilation2d"),s=c_(t,"filter","dilation2d");Kw(3===o.rank||4===o.rank,()=>"Error in dilation2d: input must be rank 3 or 4, but got rank "+"".concat(o.rank,".")),Kw(3===s.rank,()=>"Error in dilation2d: filter must be rank 3, but got rank "+"".concat(s.rank,".")),Kw("NHWC"===i,()=>"Error in dilation2d: Only NHWC is currently supported, "+"but got dataFormat of ".concat(i));let l=o,c=!1;3===o.rank&&(l=RT(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=!0),Kw(l.shape[3]===s.shape[2],()=>"Error in dilation2d:  input and filter must have the same depth: ".concat(l.shape[3]," vs ").concat(s.shape[2]));const u={x:l,filter:s},h={strides:n,pad:r,dilations:a},d=e_.runKernel(SN,u,h);return c?RT(d,[d.shape[1],d.shape[2],d.shape[3]]):d}});OE().prototype.dilation2d=function(e,t,n,r,a){return this.throwIfDisposed(),eP(this,e,t,n,r,a)};const tP=h_({divNoNan_:function(e,t){let n=c_(e,"a","div"),r=c_(t,"b","div");[n,r]=qE(n,r);const a=hI(n,r),i=gI(a),o=tA(r,i);return pR(o,i,a)}});OE().prototype.divNoNan=function(e){return this.throwIfDisposed(),tP(this,e)},OE().prototype.div=function(e){return this.throwIfDisposed(),hI(this,e)};const nP=h_({dot_:function(e,t){const n=c_(e,"t1","dot"),r=c_(t,"t2","dot");Kw((1===n.rank||2===n.rank)&&(1===r.rank||2===r.rank),()=>"Error in dot: inputs must all be rank 1 or 2, but got ranks "+"".concat(n.rank," and ").concat(r.rank,"."));const a=1===n.rank?n.size:n.shape[1],i=1===r.rank?r.size:r.shape[0];if(Kw(a===i,()=>"Error in dot: inner dimensions of inputs must match, but got "+"".concat(a," and ").concat(i,".")),1===n.rank&&1===r.rank){const e=RT(n,[1,-1]),t=RT(r,[-1,1]),a=_A(e,t);return RT(a,[])}if(1===n.rank&&2===r.rank){const e=RT(n,[1,-1]),t=RT(r,[r.shape[0],r.shape[1]]),a=_A(e,t);return RT(a,[a.size])}if(2===n.rank&&1===r.rank){const e=RT(r,[-1,1]),t=_A(n,e);return RT(t,[t.size])}{const e=RT(r,[r.shape[0],r.shape[1]]);return _A(n,e)}}});OE().prototype.dot=function(e){return this.throwIfDisposed(),nP(this,e)},OE().prototype.elu=function(){return this.throwIfDisposed(),eA(this)},OE().prototype.equal=function(e){return this.throwIfDisposed(),tA(this,e)},OE().prototype.erf=function(){return this.throwIfDisposed(),nA(this)};const rP=h_({euclideanNorm_:function(e){return dD(e,"euclidean",arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]&&arguments[2])}});OE().prototype.euclideanNorm=function(e,t){return this.throwIfDisposed(),rP(this,e,t)},OE().prototype.exp=function(){return this.throwIfDisposed(),rA(this)},OE().prototype.expandDims=function(e){return this.throwIfDisposed(),aA(this,e)};const aP=h_({expm1_:function(e){const t={x:c_(e,"x","expm1")};return e_.runKernel(PN,t)}});OE().prototype.expm1=function(){return this.throwIfDisposed(),aP(this)},OE().prototype.fft=function(){return this.throwIfDisposed(),xR(this)},OE().prototype.flatten=function(){return this.throwIfDisposed(),RT(this,[this.size])},OE().prototype.floor=function(){return this.throwIfDisposed(),sA(this)},OE().prototype.floorDiv=function(e){return this.throwIfDisposed(),uI(this,e)},OE().prototype.gather=function(e,t,n){return this.throwIfDisposed(),lA(this,e,t,n)},OE().prototype.greaterEqual=function(e){return this.throwIfDisposed(),uA(this,e)},OE().prototype.greater=function(e){return this.throwIfDisposed(),cA(this,e)},OE().prototype.ifft=function(){return this.throwIfDisposed(),wR(this)},OE().prototype.irfft=function(){return this.throwIfDisposed(),kR(this)};const iP=h_({isFinite_:function(e){const t={x:c_(e,"x","isFinite")};return e_.runKernel($N,t)}});OE().prototype.isFinite=function(){return this.throwIfDisposed(),iP(this)};const oP=h_({isInf_:function(e){const t={x:c_(e,"x","isInf")};return e_.runKernel(JN,t)}});OE().prototype.isInf=function(){return this.throwIfDisposed(),oP(this)};const sP=h_({isNaN_:function(e){const t={x:c_(e,"x","isNaN")};return e_.runKernel(QN,t)}});OE().prototype.isNaN=function(){return this.throwIfDisposed(),sP(this)},OE().prototype.leakyRelu=function(e){return this.throwIfDisposed(),hA(this,e)},OE().prototype.lessEqual=function(e){return this.throwIfDisposed(),iD(this,e)},OE().prototype.less=function(e){return this.throwIfDisposed(),cD(this,e)};const lP=h_({localResponseNormalization_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5;const i=c_(e,"x","localResponseNormalization");Kw(4===i.rank||3===i.rank,()=>"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(i.rank,".")),Kw(Qw(t),()=>"Error in localResponseNormalization: depthRadius must be an "+"integer but got depthRadius ".concat(t,"."));let o=i,s=!1;3===i.rank&&(s=!0,o=RT(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const l={x:o},c={depthRadius:t,bias:n,alpha:r,beta:a},u=e_.runKernel(lS,l,c);return s?RT(u,[u.shape[1],u.shape[2],u.shape[3]]):u}});OE().prototype.localResponseNormalization=function(e,t,n,r){return this.throwIfDisposed(),lP(this,e,t,n,r)};const cP=h_({logSigmoid_:function(e){const t=c_(e,"x","logSigmoid"),n=mI(e=>({value:OA(iR(OA(e))),gradFunc:t=>dI(t,QA(OA(e)))}));return n(t)}});OE().prototype.logSigmoid=function(){return this.throwIfDisposed(),cP(this)},OE().prototype.logSoftmax=function(e){return this.throwIfDisposed(),mA(this,e)},OE().prototype.logSumExp=function(e,t){return this.throwIfDisposed(),CA(this,e,t)},OE().prototype.log=function(){return this.throwIfDisposed(),dA(this)},OE().prototype.log1p=function(){return this.throwIfDisposed(),fA(this)},OE().prototype.logicalAnd=function(e){return this.throwIfDisposed(),EA(this,e)},OE().prototype.logicalNot=function(){return this.throwIfDisposed(),xL(this)};const uP=h_({logicalOr_:function(e,t){const n=c_(e,"a","logicalOr","bool"),r=c_(t,"b","logicalOr","bool");FI(n.shape,r.shape);const a={a:n,b:r};return e_.runKernel(sS,a)}});OE().prototype.logicalOr=function(e){return this.throwIfDisposed(),uP(this,e)};const hP=h_({logicalXor_:function(e,t){const n=c_(e,"a","logicalXor","bool"),r=c_(t,"b","logicalXor","bool");return FI(n.shape,r.shape),EA(uP(e,t),xL(EA(e,t)))}});OE().prototype.logicalXor=function(e){return this.throwIfDisposed(),hP(this,e)},OE().prototype.matMul=function(e,t,n){return this.throwIfDisposed(),_A(this,e,t,n)},OE().prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),IA(this,e,t,n,r)},OE().prototype.max=function(e,t){return this.throwIfDisposed(),pA(this,e,t)},OE().prototype.maximum=function(e){return this.throwIfDisposed(),OI(this,e)},OE().prototype.mean=function(e,t){return this.throwIfDisposed(),AA(this,e,t)},OE().prototype.min=function(e,t){return this.throwIfDisposed(),RA(this,e,t)},OE().prototype.minimum=function(e){return this.throwIfDisposed(),DA(this,e)};const dP=h_({mirrorPad_:function(e,t,n){Kw("reflect"===n||"symmetric"===n,()=>"Invalid mode. Mode must be either reflect or symmetric. "+"Got ".concat(n,"."));const r=c_(e,"x","mirrorPad");if(0===r.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");Kw(t.length===r.rank,()=>"Padding doesn't match input. Must be ".concat(r.rank,". ")+"Got ".concat(t.length,"."));const a="reflect"===n?1:0;for(let s=0;s<r.rank;s++)Kw(2===t[s].length,()=>"Invalid number of paddings. Must be length of 2 each."),Kw(t[s][0]>=0&&t[s][0]<=r.shape[s]-a&&t[s][1]>=0&&t[s][1]<=r.shape[s]-a,()=>"Padding in dimension ".concat(s," cannot be greater than or equal ")+"to ".concat(r.shape[s]-a," or less than 0 for input of ")+"shape ".concat(r.shape));const i={paddings:t,mode:n},o={x:r};return e_.runKernel(yS,o,i)}});OE().prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),dP(this,e,t)};const fP=h_({mod_:function(e,t){let n=c_(e,"a","mod"),r=c_(t,"b","mod");[n,r]=qE(n,r);const a={a:n,b:r};return e_.runKernel(wS,a)}});OE().prototype.mod=function(e){return this.throwIfDisposed(),fP(this,e)},OE().prototype.mul=function(e){return this.throwIfDisposed(),dI(this,e)},OE().prototype.neg=function(){return this.throwIfDisposed(),OA(this)},OE().prototype.norm=function(e,t,n){return this.throwIfDisposed(),dD(this,e,t,n)},OE().prototype.notEqual=function(e){return this.throwIfDisposed(),LA(this,e)},OE().prototype.oneHot=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.throwIfDisposed(),PA(this,e,t,n)},OE().prototype.onesLike=function(){return this.throwIfDisposed(),BA(this)},OE().prototype.pad=function(e,t){return this.throwIfDisposed(),zA(this,e,t)};const pP=h_({pool_:function(e,t,n,r,a,i,o){null==a&&(a=[1,1]),null==i&&(i=1),0===r&&(r="valid");const s=c_(e,"x","maxPool");let l=s,c=!1;3===s.rank&&(c=!0,l=RT(s,[1,s.shape[0],s.shape[1],s.shape[2]])),Kw(_T(i,a),()=>"Error in pool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(a,"'"));const u=vT(l.shape,t,i,a,r),h=[u.dilationHeight,u.dilationWidth];let d;d="same"===r?function(e,t){const n=e.map((e,n)=>e+(e-1)*(t[n]-1)),r=n.map(e=>e-1),a=r.map(e=>Math.floor(e/2)),i=r.map((e,t)=>e-a[t]);return r.map((e,t)=>[a[t],i[t]])}([u.filterHeight,u.filterWidth],h):[[0,0],[0,0]];const f=1===h[0]&&1===h[1],[p,g]=function(e,t,n){const r=n.map(e=>e[0]),a=n.map(e=>e[1]),i=e.concat(r,a),o=t.map((e,t)=>(e-i[t]%e)%e),s=a.map((e,t)=>e+o[t]),l=t.map((e,t)=>[r[t],s[t]]),c=t.map((e,t)=>[0,o[t]]);return[l,c]}([u.inHeight,u.inWidth],h,d),m=f?r:"valid",v=f?l:$F(l,h,p),b=("avg"===n?()=>DT(v,t,i,m,o):()=>IA(v,t,i,m,o))(),x=f?b:RL(b,h,g);return c?RT(x,[x.shape[1],x.shape[2],x.shape[3]]):x}});OE().prototype.pool=function(e,t,n,r,a,i){return this.throwIfDisposed(),pP(this,e,t,n,r,a,i)},OE().prototype.pow=function(e){return this.throwIfDisposed(),_I(this,e)},OE().prototype.prelu=function(e){return this.throwIfDisposed(),WA(this,e)};const gP=h_({prod_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=c_(e,"x","prod");"bool"===r.dtype&&(r=oI(r,"int32"));const a={x:r},i={axis:t,keepDims:n};return e_.runKernel(LS,a,i)}});OE().prototype.prod=function(e,t){return this.throwIfDisposed(),gP(this,e,t)};const mP=h_({reciprocal_:function(e){const t={x:c_(e,"x","reciprocal")};return e_.runKernel(WS,t)}});OE().prototype.reciprocal=function(){return this.throwIfDisposed(),mP(this)},OE().prototype.relu=function(){return this.throwIfDisposed(),XA(this)},OE().prototype.relu6=function(){return this.throwIfDisposed(),SR(this)},OE().prototype.reshapeAs=function(e){return this.throwIfDisposed(),RT(this,e.shape)},OE().prototype.reshape=function(e){return this.throwIfDisposed(),RT(this,e)},OE().prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),nD(this,e,t,n)},OE().prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),rD(this,e,t,n)},OE().prototype.reverse=function(e){return this.throwIfDisposed(),YA(this,e)},OE().prototype.rfft=function(){return this.throwIfDisposed(),yR(this)},OE().prototype.round=function(){return this.throwIfDisposed(),oD(this)},OE().prototype.rsqrt=function(){return this.throwIfDisposed(),NO(this)},OE().prototype.selu=function(){return this.throwIfDisposed(),$A(this)},OE().prototype.separableConv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),JA(this,e,t,n,r,a,i)},OE().prototype.sigmoid=function(){return this.throwIfDisposed(),QA(this)};const vP=h_({sign_:function(e){const t={x:c_(e,"x","sign")};return e_.runKernel(oC,t)}});OE().prototype.sign=function(){return this.throwIfDisposed(),vP(this)},OE().prototype.sin=function(){return this.throwIfDisposed(),lO(this)},OE().prototype.sinh=function(){return this.throwIfDisposed(),uO(this)},OE().prototype.slice=function(e,t){return this.throwIfDisposed(),ZA(this,e,t)},OE().prototype.softmax=function(e){return this.throwIfDisposed(),aR(this,e)},OE().prototype.softplus=function(){return this.throwIfDisposed(),iR(this)},OE().prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),$F(this,e,t)},OE().prototype.split=function(e,t){return this.throwIfDisposed(),oR(this,e,t)},OE().prototype.sqrt=function(){return this.throwIfDisposed(),fI(this)},OE().prototype.square=function(){return this.throwIfDisposed(),pI(this)},OE().prototype.squaredDifference=function(e){return this.throwIfDisposed(),vD(this,e)},OE().prototype.squeeze=function(e){return this.throwIfDisposed(),sR(this,e)},OE().prototype.stack=function(e,t){this.throwIfDisposed();const n=e instanceof FE?[this,e]:[this,...e];return lR(n,t)},OE().prototype.step=function(e){return this.throwIfDisposed(),CR(this,e)};const bP=h_({stridedSlice_:function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;const c={x:c_(e,"x","stridedSlice","string_or_numeric")},u={begin:t,end:n,strides:r,beginMask:a,endMask:i,ellipsisMask:o,newAxisMask:s,shrinkAxisMask:l};return e_.runKernel(kC,c,u)}});OE().prototype.stridedSlice=function(e,t,n,r,a,i,o,s){return this.throwIfDisposed(),bP(this,e,t,n,r,a,i,o,s)},OE().prototype.sub=function(e){return this.throwIfDisposed(),II(this,e)},OE().prototype.sum=function(e,t){return this.throwIfDisposed(),gA(this,e,t)};const xP=h_({tan_:function(e){const t={x:c_(e,"x","tan","float32")};return e_.runKernel(_C,t)}});OE().prototype.tan=function(){return this.throwIfDisposed(),xP(this)},OE().prototype.tanh=function(){return this.throwIfDisposed(),cR(this)},OE().prototype.tile=function(e){return this.throwIfDisposed(),iA(this,e)},OE().prototype.toBool=function(){return this.throwIfDisposed(),oI(this,"bool")},OE().prototype.toFloat=function(){return this.throwIfDisposed(),oI(this,"float32")},OE().prototype.toInt=function(){return this.throwIfDisposed(),oI(this,"int32")};const yP=h_({topk_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=c_(e,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");const a=r.shape[r.shape.length-1];if(t<0)throw new Error("'k' passed to topk() must be >= 0 but got ".concat(t));if(t>a)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(a,") ")+"but got ".concat(t));const i={x:r},o={k:t,sorted:n},[s,l]=e_.runKernel(AC,i,o);return{values:s,indices:l}}});OE().prototype.topk=function(e,t){return this.throwIfDisposed(),yP(this,e,t)},OE().prototype.transpose=function(e){return this.throwIfDisposed(),vR(this,e)};const wP=h_({unique_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=c_(e,"x","unique","string_or_numeric");Kw(n.rank>0,()=>"The input tensor must be at least 1D");const r={x:n},a={axis:t},[i,o]=e_.runKernel(FC,r,a);return{values:i,indices:o}}});OE().prototype.unique=function(e){return this.throwIfDisposed(),wP(this,e)},OE().prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),CO(this,e,t)},OE().prototype.unstack=function(e){return this.throwIfDisposed(),fR(this,e)},OE().prototype.where=function(e,t){return this.throwIfDisposed(),pR(e,this,t)},OE().prototype.zerosLike=function(){return this.throwIfDisposed(),gI(this)};class kP extends Error{constructor(e){super(e),Object.setPrototypeOf(this,kP.prototype)}}class NP extends Error{constructor(e){super(e),Object.setPrototypeOf(this,NP.prototype)}}class SP extends Error{constructor(e){super(e),Object.setPrototypeOf(this,SP.prototype)}}class CP extends Error{constructor(e){super(e),Object.setPrototypeOf(this,CP.prototype)}}class EP extends Error{constructor(e){super(e),Object.setPrototypeOf(this,EP.prototype)}}Error;class _P{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}put(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error("The maxEntries of LRU caches must be at least 0, but got ".concat(e,"."));if(this.maxEntries>e)for(let t=0;t<this.maxEntries-e;t++){const e=this.cache.keys().next().value;this.cache.delete(e)}this.maxEntries=e}}function IP(e,t){if(Array.isArray(e)){let n=[];for(let r=0;r<t;r++)n=n.concat(e);return n}{const n=new Array(t);return n.fill(e),n}}function TP(e,t){if(!e)throw new EP(t)}function AP(e,t){let n=0;for(const r of e)r===t&&n++;return n}function RP(e){return 1===e.length?e[0]:e}function DP(e){return Array.isArray(e)?e:[e]}function FP(e){const t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==t[0]?t:"private"+t}function OP(e){return e.length<=1||-1===e.indexOf("_")?e:e.replace(/[_]+(\w|$)/g,(e,t)=>t.toUpperCase())}let LP={};function PP(e){if(null===e||void 0===e)return null;const t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function MP(e){if(null!=e&&"object"===typeof e)if(Array.isArray(e))e.forEach(e=>MP(e));else{const t=Object.keys(e);for(const n of t){const t=e[n];null!=t&&"object"===typeof t&&(Array.isArray(t)||"ndarray"!==t.type||"number"!==typeof t.value?MP(t):e[n]=t.value)}}}function jP(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"object",a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("string"===typeof e){const a=e;let i;if(a in n)i=n[a];else if(a in LP)i=LP[a];else if(i=t[a],null==i)throw new SP("Unknown ".concat(r,": ").concat(e,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");return i}{const i=e;if(null==i.className||null==i.config)throw new SP("".concat(r,": Improper config format: ")+"".concat(JSON.stringify(i),".\n")+"'className' and 'config' must set.");const o=i.className;let s,l;if(o in n?[s,l]=n[o]:o in LP?[s,l]=LP.className:o in t&&([s,l]=t[o]),null==s)throw new SP("Unknown ".concat(r,": ").concat(o,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");if(null!=l){const e={};for(const n of Object.keys(LP))e[n]=LP[n];for(const a of Object.keys(n))e[a]=n[a];i.config.customObjects=e;const t=Object.assign({},LP);for(const a of Object.keys(n))LP[a]=n[a];MP(i.config);const r=l(s,i.config,n,a);return LP=Object.assign({},t),r}{const e=Object.assign({},LP);for(const r of Object.keys(n))LP[r]=n[r];const t=new s(i.config);return LP=Object.assign({},e),t}}}function BP(e,t){return-1*function(e,t){return e<t?-1:e>t?1:0}(e,t)}function zP(e){if(null==e)return e;const t=[];for(const n of e)-1===t.indexOf(n)&&t.push(n);return t}function WP(e){if(null==e)throw new SP("Invalid value in obj: ".concat(JSON.stringify(e)));for(const t in e)if(e.hasOwnProperty(t))return!1;return!0}function UP(e,t,n){if(null!=n&&e.indexOf(n)<0)throw new SP("".concat(n," is not a valid ").concat(t,".  Valid values are ").concat(e," or null/undefined."))}function VP(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;return TP(n>=0),TP(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every(e=>typeof e===t)}function HP(e,t){Array.isArray(e)?(Kw(e.length>0,()=>"".concat(t," is unexpectedly an empty array.")),e.forEach((e,n)=>HP(e,"element ".concat(n+1," of ").concat(t)))):Kw(Number.isInteger(e)&&e>0,()=>"Expected ".concat(t," to be a positive integer, but got ")+"".concat(GP(e),"."))}function GP(e){return null===e?"null":Array.isArray(e)?"["+e.map(e=>GP(e)).join(",")+"]":"string"===typeof e?'"'.concat(e,'"'):"".concat(e)}function qP(e){return"relu"===e?"relu":"linear"===e?"linear":"elu"===e?"elu":null}let KP=0;function XP(){return KP++}const YP={};function $P(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e in YP||(YP[e]=0),YP[e]+=1,e+YP[e].toString()}const JP=["channelsFirst","channelsLast"],QP=["nearest","bilinear"],ZP=["valid","same","causal"],eM=["max","avg"],tM=["sum","mul","concat","ave"],nM=new Map;function rM(e){UP(JP,"DataFormat",e)}function aM(e){UP(ZP,"PaddingMode",e)}function iM(e){UP(eM,"PoolMode",e)}const oM=[];function sM(e,t){oM.push(e);try{const e=t();return oM.pop(),e}catch(ci){throw oM.pop(),ci}}function lM(e){if(!hM(e))throw new Error("Not a valid tensor name: '"+e+"'");return(0===oM.length?"":oM.join("/")+"/")+e}function cM(e){if(!hM(e))throw new Error("Not a valid tensor name: '"+e+"'");nM.has(e)||nM.set(e,0);const t=nM.get(e);if(nM.set(e,nM.get(e)+1),t>0){const n="".concat(e,"_").concat(t);return nM.set(n,1),n}return e}const uM=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function hM(e){return!!e.match(uM)}function dM(e){return e===parseInt(e.toString(),10)}function fM(e,t,n){null==t&&(t=0),null==n&&(n=e.length);let r=1;for(let a=t;a<n;++a)r*=e[a];return r}function pM(e){if(0===e.length)return Number.NaN;let t=Number.POSITIVE_INFINITY;for(let n=0;n<e.length;n++){const r=e[n];r<t&&(t=r)}return t}function gM(e){if(0===e.length)return Number.NaN;let t=Number.NEGATIVE_INFINITY;for(let n=0;n<e.length;n++){const r=e[n];r>t&&(t=r)}return t}function mM(e,t){if(t<e)throw new SP("end (".concat(t,") < begin (").concat(e,") is forbidden."));const n=[];for(let r=e;r<t;++r)n.push(r);return n}let vM;function bM(){return null==vM&&(vM=k_().epsilon()),vM}function xM(e,t){return oI(e,t)}function yM(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),RT(e,n)}function wM(e,t,n){return b_(()=>{switch(e.rank){case 1:return eR(e,t,n);case 2:return tR(e,[t,0],[n,e.shape[1]]);case 3:return nR(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return rR(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return ZA(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return ZA(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new SP("sliceAlongFirstAxis() received an unsupported tensor rank: "+"".concat(e.rank))}})}function kM(e,t,n){return b_(()=>{switch(e.rank){case 1:return eR(e,t,n);case 2:return tR(e,[0,t],[e.shape[0],n]);case 3:return nR(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return rR(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new SP("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(e.rank))}})}function NM(e,t,n,r){return b_(()=>{switch(e.rank){case 1:return eR(e,t,n);case 2:switch(r){case 1:return wM(e,t,n);case 2:return kM(e,t,n);default:throw new SP("The axis is not within the rank of the tensor "+"".concat(r))}case 3:switch(r){case 1:return wM(e,t,n);case 2:return nR(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return kM(e,t,n);default:throw new SP("The axis is not within the rank of the tensor "+"".concat(r))}case 4:switch(r){case 1:return wM(e,t,n);case 2:return rR(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return rR(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return kM(e,t,n);default:throw new SP("The axis is not within the rank of the tensor "+"".concat(r))}default:throw new SP("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(e.rank))}})}function SM(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return n<0&&(t=e[0].rank,n=0!==t?t:0),n===e[0].rank&&(n=-1),zT(e,n)}function CM(e,t){switch(e.rank){case 1:return WT([e,t]);case 2:return UT([e,t],0);case 3:return VT([e,t],0);case 4:return HT([e,t],0);default:throw new SP("concatAlongFirstAxis() received an unsupported "+"tensor rank: ".concat(e.rank))}}function EM(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new SP("The length of input n (".concat(t.length,") does not match ")+"the number of dimensions in input x (".concat(e.rank,")"));return iA(e,t)}function _M(e){return GA(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0)}function IM(e,t,n,r){if(e.rank<2||t.rank<2)throw new CP("dot requires both inputs to be rank >= 2"+" but got x shape = ".concat(e.shape," and y shape = ").concat(t.shape));if(t.rank>=3){if(e.shape.slice(-1)[0]!==t.shape.slice(-2)[0])throw new CP("If rank y >= 3, then the second last dim"+" of y must equal the last dim of x but got x shape = ".concat(e.shape," and ")+" y shape = ".concat(t.shape))}if(2===e.rank&&2===t.rank){return FR({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?RM(e.rank,r,"channelsLast"):null,activation:n})}{const a=e.shape.slice(),i=a.pop();e=RT(e,[-1,i]);const o=t.shape.slice(),s=o.pop(),l=o.pop(),c=[...o,s],u=Array.from({length:t.rank},(e,n)=>0===n?t.rank-2:n<=t.rank-2?n-1:n);t=RT(vR(t,u),[l,-1]);const h=[...a,...c];return RT(FR({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?RM(e.rank,r,"channelsLast"):null,activation:n}),h)}}function TM(e,t,n){return b_(()=>(t=Array.isArray(t)?uR(t,"int32"):oI(t,"int32"),lA(e,t,n)))}function AM(e){return dI(e,e)}function RM(e,t,n){const r=t.shape;if(1!==t.rank&&t.rank!==e)throw new SP("Unexpected bias dimensions: ".concat(t.rank)+"; expected it to be 1 or ".concat(e));if(5===e){if("channelsFirst"===n)return 1===r.length?RT(t,[1,r[0],1,1,1]):RT(t,[1,r[3],r[0],r[1],r[2]]);if("channelsLast"===n)return 1===r.length?RT(t,[1,1,1,1,r[0]]):RT(t,[1].concat(r))}else if(4===e){if("channelsFirst"===n)return 1===r.length?RT(t,[1,r[0],1,1]):RT(t,[1,r[2],r[0],r[1]]);if("channelsLast"===n)return 1===r.length?RT(t,[1,1,1,r[0]]):RT(t,[1].concat(r))}else if(3===e){if("channelsFirst"===n)return 1===r.length?RT(t,[1,r[0],1]):RT(t,[1,r[1],r[0]]);if("channelsLast"===n)return 1===r.length?RT(t,[1,1,r[0]]):RT(t,[1].concat(r))}else if(e<3)return t;throw new SP("Unsupported input rank by biasAdd: ".concat(t.rank))}function DM(e,t,n){return b_(()=>(null==n&&(n="channelsLast"),rM(n),cI(e,RM(e.rank,t,n))))}function FM(e,t,n,r){return b_(()=>bR(e,t,n,r))}function OM(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?e():t()}const LM=["fanIn","fanOut","fanAvg"],PM=["normal","uniform","truncatedNormal"];class MM extends yI{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class jM extends MM{apply(e,t){return MA(e,t)}}jM.className="Zeros",kI(jM);class BM extends MM{apply(e,t){return jA(e,t)}}BM.className="Ones",kI(BM);class zM extends MM{constructor(e){if(super(),"object"!==typeof e)throw new SP("Expected argument of type ConstantConfig but got ".concat(e));if(void 0===e.value)throw new SP("config must have value set but got ".concat(e));this.value=e.value}apply(e,t){return b_(()=>dI(vI(this.value),jA(e,t)))}getConfig(){return{value:this.value}}}zM.className="Constant",kI(zM);class WM extends MM{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,t){return qA(e,this.minval,this.maxval,t,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}WM.className="RandomUniform",kI(WM);class UM extends MM{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new CP("randomNormal does not support dType ".concat(t,"."));return _M(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}UM.className="RandomNormal",kI(UM);class VM extends MM{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new CP("truncatedNormal does not support dType ".concat(t,"."));return dR(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}VM.className="TruncatedNormal",kI(VM);class HM extends MM{constructor(e){super(),this.gain=null!=e.gain?e.gain:1}apply(e,t){return b_(()=>{if(2!==e.length||e[0]!==e[1])throw new SP("Identity matrix initializer can only be used for 2D square matrices.");return dI(this.gain,oA(e[0]))})}getConfig(){return{gain:this.gain}}}HM.className="Identity",kI(HM);class GM extends MM{constructor(e){if(super(),e.scale<0)throw new SP("scale must be a positive float. Got: ".concat(e.scale));this.scale=null==e.scale?1:e.scale,this.mode=null==e.mode?"fanIn":e.mode,function(e){UP(LM,"FanMode",e)}(this.mode),this.distribution=null==e.distribution?"normal":e.distribution,function(e){UP(PM,"Distribution",e)}(this.distribution),this.seed=e.seed}apply(e,t){const n=function(e){let t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"channelsLast";if(rM(r),2===e.length)t=e[0],n=e[1];else if(-1!==[3,4,5].indexOf(e.length)){if("channelsFirst"===r){const r=fM(e,2);t=e[1]*r,n=e[0]*r}else if("channelsLast"===r){const r=fM(e,0,e.length-2);t=e[e.length-2]*r,n=e[e.length-1]*r}}else{const r=fM(e);t=Math.sqrt(r),n=Math.sqrt(r)}return[t,n]}(e),r=n[0],a=n[1];let i=this.scale;if("fanIn"===this.mode?i/=Math.max(1,r):"fanOut"===this.mode?i/=Math.max(1,a):i/=Math.max(1,(r+a)/2),"normal"===this.distribution){const n=Math.sqrt(i);if("float32"!==(t=t||"float32")&&"int32"!==t)throw new CP("".concat(this.getClassName()," does not support dType ").concat(t,"."));return dR(e,0,n,t,this.seed)}{const n=Math.sqrt(3*i);return qA(e,-n,n,t,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}GM.className="VarianceScaling",kI(GM);class qM extends GM{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return GM.className}}qM.className="GlorotUniform",kI(qM);class KM extends GM{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return GM.className}}KM.className="GlorotNormal",kI(KM);class XM extends GM{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return GM.className}}XM.className="HeNormal",kI(XM);class YM extends GM{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return GM.className}}YM.className="HeUniform",kI(YM);class $M extends GM{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return GM.className}}$M.className="LeCunNormal",kI($M);class JM extends GM{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return GM.className}}JM.className="LeCunUniform",kI(JM);class QM extends MM{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=null==e.gain?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,t){return b_(()=>{if(e.length<2)throw new CP("Shape must be at least 2D.");if("int32"!==t&&"float32"!==t&&void 0!==t)throw new TypeError("Unsupported data type ".concat(t,"."));const n=$w(e.slice(0,-1)),r=e[e.length-1],a=n*r;a>this.ELEMENTS_WARN_SLOW&&console.warn("Orthogonal initializer is being called on a matrix with more "+"than ".concat(this.ELEMENTS_WARN_SLOW," (").concat(a,") elements: ")+"Slowness may result.");const i=_M([Math.max(r,n),Math.min(r,n)],0,1,t,this.seed),o=xD.qr(i,!1);let s=o[0];const l=o[1].flatten().stridedSlice([0],[Math.min(r,n)*Math.min(r,n)],[Math.min(r,n)+1]);return s=dI(s,l.sign()),n<r&&(s=s.transpose()),dI(vI(this.gain),s.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}QM.className="Orthogonal",kI(QM);const ZM={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function ej(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jP(e,wI.getMap().classNameMap,t,"initializer")}function tj(e){return PP(e)}function nj(e){if("string"===typeof e){const t=e in ZM?ZM[e]:e;if("GlorotNormal"===t)return new KM;if("GlorotUniform"===t)return new qM;if("HeNormal"===t)return new XM;if("HeUniform"===t)return new YM;if("LeCunNormal"===t)return new $M;if("LeCunUniform"===t)return new JM;{const e={};return e.className=t,e.config={},ej(e)}}return e instanceof MM?e:ej(e)}function rj(e){return Array.isArray(e)&&Array.isArray(e[0])}function aj(e){return 0===e.length?[]:Array.isArray(e[0])?e:[e]}function ij(e){let t;if(Array.isArray(e)){if(1!==e.length)throw new SP("Expected Tensor length to be 1; got ".concat(e.length));t=e[0]}else t=e;return t}function oj(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(1===e.length)return e[0];throw new SP("Expected exactly 1 Shape; got ".concat(e.length))}return e}function sj(e){let t=0;for(const n of e)0===n.shape.length?t+=1:t+=n.shape.reduce((e,t)=>e*t);return t}const lj="Variable";class cj{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:lj,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.dtype=null==t?"float32":t,this.shape=e.shape,this.id=XP(),n=null==n?lj:n,this.originalName=lM(n),this.name=cM(this.originalName),this.trainable_=r,this.constraint=a,this.val=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return e_.makeVariable(e,t,n,r)}(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),function(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}(this.val,e),this.val.id!==e.id&&(this.val.assign(e),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error("LayersVariable ".concat(this.name," is already disposed."))}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function uj(e){return e.map(e=>e.read())}function hj(e){e.forEach(e=>{e[0].write(e[1])})}class dj{constructor(e){this.dtype=e.dtype,this.shape=e.shape,null!=e.shape?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class fj{constructor(e,t,n,r,a,i,o){this.dtype=e,this.shape=t,this.sourceLayer=n,this.inputs=r,this.callArgs=a,this.outputTensorIndex=o,this.id=XP(),null!=i&&(this.originalName=lM(i),this.name=cM(this.originalName)),this.rank=t.length}}let pj=0;class gj{constructor(e,t){this.callArgs=t,this.id=pj++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const n of e.inboundLayers)null!=n&&n.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const t of this.inboundLayers)null!=t?e.push(t.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let mj=0;class vj extends yI{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=mj++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let t=e.name;if(!t){const e=this.getClassName();t=FP(e)+"_"+$P(e)}if(this.name=t,this.trainable_=null==e.trainable||e.trainable,null!=e.inputShape||null!=e.batchInputShape){let t;if(null!=e.batchInputShape)t=e.batchInputShape;else if(null!=e.inputShape){let n=null;null!=e.batchSize&&(n=e.batchSize),t=[n].concat(e.inputShape)}this.batchInputShape=t;let n=e.dtype;null==n&&(n=e.inputDType),null==n&&(n="float32"),this.dtype=n}null!=e.weights?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,t){return e.name+"_ib-"+t.toString()}getNodeAtIndex(e,t){if(0===this.inboundNodes.length)throw new NP("The layer has never been called "+"and thus has no defined ".concat(t,"."));if(this.inboundNodes.length<=e)throw new SP("Asked to get ".concat(t," at node ").concat(e,", ")+"but the layer has only ".concat(this.inboundNodes.length," inbound nodes."));return this.inboundNodes[e]}getInputAt(e){return RP(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return RP(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new kP("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new kP("Layer ".concat(this.name)+" is not connected, no input to return.");return RP(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(0===this.inboundNodes.length)throw new kP("Layer ".concat(this.name)+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new kP("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return RP(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(t=>t.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const t=DP(e);if(null==this.inputSpec||0===this.inputSpec.length)return;const n=DP(this.inputSpec);if(t.length!==n.length)throw new SP("Layer ".concat(this.name," expects ").concat(n.length," inputs, ")+"but it received ".concat(t.length," input tensors. ")+"Input received: ".concat(e));for(let r=0;r<t.length;r++){const e=t[r],a=n[r];if(null==a)continue;const i=e.rank;if(null!=a.ndim&&i!==a.ndim)throw new SP("Input ".concat(r," is incompatible with layer ").concat(this.name,": ")+"expected ndim=".concat(a.ndim,", found ndim=").concat(i));if(null!=a.maxNDim&&i>a.maxNDim)throw new SP("Input ".concat(r," is incompatible with layer ").concat(this.name)+": expected max_ndim=".concat(a.maxNDim,", found ndim=").concat(i));if(null!=a.minNDim&&i<a.minNDim)throw new SP("Input ".concat(r," is incompatible with layer ").concat(this.name)+": expected min_ndim=".concat(a.minNDim,", found ndim=").concat(i,"."));if(null!=a.dtype&&e.dtype!==a.dtype)throw new SP("Input ".concat(r," is incompatible with layer ").concat(this.name," ")+": expected dtype=".concat(a.dtype,", found dtype=").concat(e.dtype,"."));if(a.axes){const t=e.shape;for(const e in a.axes){const n=Number(e),i=a.axes[e],o=n>=0?t[n]:t[t.length+n];if(null!=i&&-1===[i,null].indexOf(o))throw new SP("Input ".concat(r," is incompatible with layer ")+"".concat(this.name,": expected axis ").concat(n," of input shape to ")+"have value ".concat(i," but got shape ").concat(t,"."))}}if(null!=a.shape)for(let t=0;t<a.shape.length;++t){const n=a.shape[t],i=e.shape[t];if(null!=n&&null!=i&&n!==i)throw new SP("Input ".concat(r," is incompatible with layer ")+"".concat(this.name,": expected shape=").concat(a.shape,", ")+"found shape=".concat(e.shape,"."))}}}call(e,t){return e}invokeCallHook(e,t){null!=this._callHook&&this._callHook(e,t)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,t){t=t||{},this.assertNotDisposed();const n=DP(e),r=function(e){let t=!0;for(const n of DP(e))if(!(n instanceof fj)){t=!1;break}return t}(e),a=function(e){let t=!0;for(const n of DP(e))if(n instanceof fj){t=!1;break}return t}(e);if(r===a)throw new SP("Arguments to apply() must be all SymbolicTensors or all Tensors");return sM(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const t=[];for(const n of DP(e))t.push(n.shape);this.build(RP(t)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),null===this._refCount&&a&&(this._refCount=1)}if(this.assertInputCompatibility(e),a){let r=this.call(e,t);this.supportsMasking&&this.setMaskMetadata(e,r);const a=DP(r),i=[];for(let e of a)-1!==n.indexOf(e)&&(e=e.clone()),i.push(e);if(r=RP(i),null!=this.activityRegularizer)throw new CP("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return r}{const n=function(e){e=DP(e);const t=[];for(const n of e)t.push(n.shape);return RP(t)}(e),r=this.computeOutputShape(n);let a;const i="float32";if(this.warnOnIncompatibleInputShape(Array.isArray(e)?n[0]:n),a=null!=r&&r.length>0&&Array.isArray(r[0])?r.map((n,r)=>new fj(i,n,this,DP(e),t,this.name,r)):new fj(i,r,this,DP(e),t,this.name),this.addInboundNode(e,a,null,null,n,r,t),this._refCount++,null!=this.activityRegularizer)throw new CP("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return a}})}warnOnIncompatibleInputShape(e){if(null!=this.batchInputShape)if(e.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+"".concat(JSON.stringify(e),") does not match that of the ")+"batchInputShape (".concat(JSON.stringify(this.batchInputShape),") ")+"of the layer ".concat(this.name));else{let t=!1;this.batchInputShape.forEach((n,r)=>{null!=n&&null!=e[r]&&e[r]!==n&&(t=!0)}),t&&console.warn("The shape of the input tensor "+"(".concat(JSON.stringify(e),") does not ")+"match the expectation of layer ".concat(this.name,": ")+"".concat(JSON.stringify(this.batchInputShape)))}}get outputShape(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new kP("The layer ".concat(this.name," has never been called and thus has no ")+"defined output shape.");const e=[];for(const t of this.inboundNodes){const n=JSON.stringify(t.outputShapes);-1===e.indexOf(n)&&e.push(n)}if(1===e.length){const e=this.inboundNodes[0].outputShapes;return Array.isArray(e)&&Array.isArray(e[0])&&1===e.length?e[0]:e}throw new kP("The layer ".concat(this.name," has multiple inbound nodes with different ")+'output shapes. Hence the notion of "output shape" is ill-defined for the layer.')}countParams(){if(!this.built)throw new NP("You tried to call countParams() on ".concat(this.name,", ")+"but the layer is not built yet. Build it first by calling build(batchInputShape).");return sj(this.weights)}build(e){this.built=!0}getWeights(){return uj(arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.trainableWeights:this.weights)}setWeights(e){b_(()=>{const t=this.weights;if(t.length!==e.length)throw new SP('You called setWeights(weights) on layer "'.concat(this.name,'" ')+"with a weight list of length ".concat(e.length,", ")+"but the layer was expecting ".concat(t.length," weights. ")+"Provided weights: ".concat(e,"..."));if(0===t.length)return;const n=[],r=uj(t);for(let a=0;a<r.length;++a){const i=r[a],o=t[a],s=e[a];if(!Jw(i.shape,s.shape))throw new SP("Layer weight shape ".concat(i.shape," ")+"not compatible with provided weight shape ".concat(s.shape));n.push([o,s])}hj(n)})}addWeight(e,t,n,r,a,i,o,s){if(-1!==this._addedWeightNames.indexOf(e))throw new SP("Duplicate weight name ".concat(e," for layer ").concat(this.name));this._addedWeightNames.push(e),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=null!=s?s():nj("zeros"));const l=r.apply(t,n),c=new cj(l,n,e,i,o);return l.dispose(),null!=a&&this.addLoss(()=>a.apply(c.read())),null==i&&(i=!0),i?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){null==e||Array.isArray(e)&&0===e.length||(e=DP(e),void 0!==this._losses&&null!==this._losses&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,t){if(!this.supportsMasking){if(null!=t){if(!Array.isArray(t))throw new TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.");t.forEach(e=>{if(null!=e)throw new TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.")})}return null}return t}setMaskMetadata(e,t,n){if(!this.supportsMasking)return;const r=this.computeMask(e,n),a=DP(t),i=DP(r);if(a.length!==i.length)throw new Error("".concat(this.name," outputs ").concat(a.length," tensors ")+"but ".concat(a.length," masks for those tensors"));for(let o=0;o<a.length;o++)a[o].kerasMask=i[o]}addInboundNode(e,t,n,r,a,i){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;const s=DP(e);t=DP(t),n=DP(n),r=DP(r),a=aj(a),i=aj(i);const l=[],c=[],u=[];for(const h of s)l.push(h.sourceLayer),c.push(h.nodeIndex),u.push(h.tensorIndex);new gj({outboundLayer:this,inboundLayers:l,nodeIndices:c,tensorIndices:u,inputTensors:s,outputTensors:t,inputMasks:n,outputMasks:r,inputShapes:a,outputShapes:i},o);for(let h=0;h<t.length;h++)t[h].sourceLayer=this,t[h].nodeIndex=this.inboundNodes.length-1,t[h].tensorIndex=h}getConfig(){const e={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(e.batchInputShape=this.batchInputShape),null!=this.dtype&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(0===this._refCount)throw new Error("Layer '".concat(this.name,"' is already disposed."))}dispose(){if(!this.built)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been ")+"built yet.");if(null===this._refCount)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been used ")+"yet.");this.assertNotDisposed();let e=0;return 0===--this._refCount&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function bj(e,t,n){if((null==t||null!=n&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),0===t.inboundNodes.length)return[e];{const e=t.inboundNodes[n];if(0===e.inboundLayers.length)return e.inputTensors;{const t=[];for(let n=0;n<e.inboundLayers.length;n++){const r=bj(e.inputTensors[n],e.inboundLayers[n],e.nodeIndices[n]);for(const e of r)-1===t.indexOf(e)&&t.push(e)}return t}}}class xj extends vj{constructor(e){if(super({dtype:e.dtype,name:null!=e.name?e.name:$P("input").toString()}),null==e.batchSize&&(e.batchSize=null),null==e.sparse&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,null!=e.inputShape&&null!=e.batchInputShape)throw new SP("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let t=e.batchInputShape;if(null==t){if(null==e.inputShape)throw new SP("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");t=[e.batchSize].concat(e.inputShape)}else if(null!=e.batchSize)throw new SP("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const n=e.dtype||"float32";this.batchInputShape=t,this.dtype=n,this.inputSpec=[{shape:t}];const r=new fj(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new gj({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[t],outputShapes:[t]})}apply(e,t){throw new SP("Cannot pass any input to an "+"InputLayer's apply() method. InputLayer name: ".concat(this.name))}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}xj.className="InputLayer",kI(xj);class yj{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof yj)for(const t in e.id2Value)this.id2Value[t]=e.id2Value[t],t in e.id2Mask&&(this.id2Mask[t]=e.id2Mask[t]);else{if(null==e)return;for(const t of e)this.add(t.key,t.value)}}add(e,t,n){if(null!=this.id2Value[e.id])throw new SP("Duplicate key: name=".concat(e.name,", id=").concat(e.id));return this.id2Value[e.id]=function(e,t){if(null==e.dtype||e.dtype===t.dtype)return t;try{return oI(t,e.dtype)}catch(gfe){throw new SP("The dtype of the feed (".concat(t.dtype,") can not be cast to the dtype ")+"of the key '".concat(e.name,"' (").concat(e.dtype,")."))}}(e,t),this.name2Id[e.name]=e.id,null!=n&&(this.id2Mask[e.id]=n),this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return null!=this.id2Value[e.id]}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof fj){if(null==this.id2Value[e.id])throw new SP("Nonexistent key: ".concat(e.name));return this.id2Value[e.id]}{const t=this.name2Id[e];if(null==t)throw new SP("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Value[t]}}getMask(e){if(e instanceof fj){if(null==this.id2Value[e.id])throw new SP("Nonexistent key: ".concat(e.name));return this.id2Mask[e.id]}{const t=this.name2Id[e];if(null==t)throw new SP("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Mask[t]}}disposeMasks(){null!=this.id2Mask&&x_(this.id2Mask)}}const wj=new _P,kj=new _P;function Nj(e,t,n,r){const a=null!=n&&n.training,i=Array.isArray(e),o=i?e:[e],s=o.map(e=>e.name),l=[],c=t.names();for(const p of s)-1!==c.indexOf(p)?l.push(t.getValue(p)):l.push(null);null!=r&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);const u=s.join(",")+"|"+t.names().sort().join(",");let h,d=wj.get(u);if(null==d){const e=function(e,t){Kw(null!=e&&e.length>0,()=>"Expected at least one fetch, got none");let n=[],r={};if(1===e.length){const a=Cj(e[0],t);n=a.sorted,r=a.recipientMap}else{const a=new Set;for(const i of e){const{sorted:e,recipientMap:o}=Cj(i,t);for(const t of e)a.has(t.name)||(n.push(t),a.add(t.name));for(const t in o)null==r[t]&&(r[t]=new Set),o[t].forEach(e=>r[t].add(e))}}return{sorted:n,recipientCounts:Sj(r)}}(o,t);d=e.sorted,h=e.recipientCounts,wj.put(u,d),kj.put(u,h)}h={},a||Object.assign(h,kj.get(u));const f=new yj(t);for(let p=0;p<d.length;++p){if(null!=r){const e=v_().numTensors;e>r.maxNumTensors&&(r.maxNumTensors=e),e<r.minNumTensors&&(r.minNumTensors=e)}const e=d[p],i=e.sourceLayer;if(i instanceof xj)continue;const o=[],c=[],u=[];let g=!1;for(const n of e.inputs){const e=f.getValue(n),r=f.getMask(n);o.push(e),c.push(r),null!=r&&(g=!0),a||(h[n.name]--,0!==h[n.name]||t.hasKey(n)||-1!==s.indexOf(n.name)||e.isDisposed||!0===n.sourceLayer.stateful||u.push(e))}g&&((n=n||{}).mask=c[0]);const m=DP(i.apply(o,n));let v=null;i.supportsMasking&&(v=i.computeMask(o,c));const b=Ej(e),x=Array.isArray(b)?b:[b];for(let t=0;t<x.length;++t){f.hasKey(x[t])||f.add(x[t],m[t],Array.isArray(v)?v[0]:v);const e=s.indexOf(x[t].name);-1!==e&&(l[e]=m[t])}a||x_(u)}return f.disposeMasks(),i?l:l[0]}function Sj(e){const t={};for(const n in e)t[n]=e[n].size;return t}function Cj(e,t){const n=new Set,r=[],a={};for(const s of t.names())n.add(s);const i=[],o=[];for(i.push(e);i.length>0;){const e=i[i.length-1];if(n.has(e.name)){i.pop();continue}const t=o[o.length-1]===i.length-1;if(0===e.inputs.length||t)i.pop(),r.push(e),n.add(e.name),t&&o.pop();else{o.push(i.length-1);for(const t of e.inputs)null==a[t.name]&&(a[t.name]=new Set),a[t.name].add(e.name),n.has(t.name)||i.push(t)}}return{sorted:r,recipientMap:a}}function Ej(e){let t;if(1===e.sourceLayer.inboundNodes.length)t=e.sourceLayer.output;else{let n=null;for(let t=0;t<e.sourceLayer.inboundNodes.length;++t)for(const r of e.sourceLayer.inboundNodes[t].outputTensors)if(r.id===e.id){n=t;break}t=e.sourceLayer.getOutputAt(n)}return t}function _j(e,t){return b_(()=>fI(gA(dI(e,e),t,!0)))}_k().registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,function(e){null!=wj&&wj.setMaxEntries(e),null!=kj&&kj.setMaxEntries(e)});class Ij extends yI{getConfig(){return{}}}class Tj extends Ij{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=null!=e.maxValue?e.maxValue:this.defaultMaxValue,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return b_(()=>{const t=_j(e,this.axis),n=BT(t,0,this.maxValue);return dI(e,hI(n,cI(bM(),t)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}Tj.className="MaxNorm",kI(Tj);class Aj extends Ij{constructor(e){super(),this.defaultAxis=0,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return b_(()=>hI(e,cI(bM(),_j(e,this.axis))))}getConfig(){return{axis:this.axis}}}Aj.className="UnitNorm",kI(Aj);class Rj extends Ij{apply(e){return XA(e)}}Rj.className="NonNeg",kI(Rj);class Dj extends Ij{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=null!=e.minValue?e.minValue:this.defaultMinValue,this.maxValue=null!=e.maxValue?e.maxValue:this.defaultMaxValue,this.rate=null!=e.rate?e.rate:this.defaultRate,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return b_(()=>{const t=_j(e,this.axis),n=cI(dI(this.rate,BT(t,this.minValue,this.maxValue)),dI(1-this.rate,t));return dI(e,hI(n,cI(bM(),t)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}Dj.className="MinMaxNorm",kI(Dj);const Fj={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Oj(e){return PP(e)}function Lj(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jP(e,wI.getMap().classNameMap,t,"constraint")}function Pj(e){if(null==e)return null;if("string"===typeof e){return Lj({className:e in Fj?Fj[e]:e,config:{}})}return e instanceof Ij?e:Lj(e)}async function Mj(e){if(null==e)return;const t=[],n=[],r=[];for(const a in e){const i=e[a];if("number"!==typeof i){const e=i;t.push(e.data()),n.push(a),r.push(e)}}if(t.length>0){const a=await Promise.all(t);for(let t=0;t<a.length;++t)e[n[t]]=a[t][0];x_(r)}}function jj(e){if(null!=e)for(const t in e){const n=e[t];"number"!==typeof n&&n.dispose()}}var Bj;!function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"}(Bj||(Bj={}));class zj{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,t){}async onEpochEnd(e,t){}async onBatchBegin(e,t){}async onBatchEnd(e,t){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class Wj{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;null==e&&(e=[]),this.callbacks=e,this.queueLength=t}append(e){this.callbacks.push(e)}setParams(e){for(const t of this.callbacks)t.setParams(e)}setModel(e){for(const t of this.callbacks)t.setModel(e)}async onEpochBegin(e,t){null==t&&(t={});for(const n of this.callbacks)await n.onEpochBegin(e,t)}async onEpochEnd(e,t){null==t&&(t={});for(const n of this.callbacks)await n.onEpochEnd(e,t)}async onBatchBegin(e,t){null==t&&(t={});for(const n of this.callbacks)await n.onBatchBegin(e,t)}async onBatchEnd(e,t){null==t&&(t={});for(const n of this.callbacks)await n.onBatchEnd(e,t)}async onTrainBegin(e){null==e&&(e={});for(const t of this.callbacks)await t.onTrainBegin(e)}async onTrainEnd(e){null==e&&(e={});for(const t of this.callbacks)await t.onTrainEnd(e)}}class Uj extends zj{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,t){null==t&&(t={});const n=null==t.size?0:t.size;this.seen+=n;for(const r in t){const e=t[r];if("number"===typeof e)this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+e*n;else{let t;r in this.totals?t=this.totals[r]:this.totals[r]=0;const a=b_(()=>cI(this.totals[r],dI(e,n)));this.totals[r]=a,null!=t&&t.dispose()}}}async onEpochEnd(e,t){if(null!=t)for(const n of this.params.metrics)null!=this.totals[n]&&("number"===typeof this.totals[n]?t[n]=this.totals[n]/this.seen:b_(()=>{const e=dI(hI(1,this.seen),this.totals[n]);t[n]=e,this.totals[n].dispose(),y_(t[n])}))}}class Vj extends zj{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,t){null==t&&(t={}),this.epoch.push(e);for(const n in t)null==this.history[n]&&(this.history[n]=[]),this.history[n].push(t[n])}async syncData(){const e=[],t=[],n=[];for(const a in this.history){const r=this.history[a];for(let i=0;i<r.length;++i)if("number"!==typeof r[i]){const o=r[i];e.push(o.data()),t.push(a),n.push(i)}}const r=await Promise.all(e);for(let a=0;a<r.length;++a){this.history[t[a]][n[a]].dispose(),this.history[t[a]][n[a]]=r[a][0]}}}class Hj extends zj{constructor(e,t){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||kD,this.yieldEvery=t||"auto","auto"===this.yieldEvery&&(this.yieldEvery=125),"never"===this.yieldEvery&&null!=e.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");uk(this.yieldEvery)&&(this.maybeWait=function(e,t,n){let r,a=null!=n?n():mE();return function(){const i=null!=n?n():mE();return i-a<t||(a=i,r=e(...arguments)),r}}(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,t,n){const r=[];null!=this.yield&&(await Mj(n),r.push(this.yield(e,t,n))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(e,t){this.currentEpoch=e,null!=this.epochBegin&&(await Mj(t),await this.epochBegin(e,t))}async onEpochEnd(e,t){const n=[];null!=this.epochEnd&&(await Mj(t),n.push(this.epochEnd(e,t))),"epoch"===this.yieldEvery&&n.push(this.nextFrameFunc()),await Promise.all(n)}async onBatchBegin(e,t){null!=this.batchBegin&&(await Mj(t),await this.batchBegin(e,t))}async onBatchEnd(e,t){const n=[];null!=this.batchEnd&&(await Mj(t),n.push(this.batchEnd(e,t))),"batch"===this.yieldEvery?n.push(this.nextFrameFunc()):uk(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,e,t)),await Promise.all(n)}async onTrainBegin(e){null!=this.trainBegin&&(await Mj(e),await this.trainBegin(e))}async onTrainEnd(e){null!=this.trainEnd&&(await Mj(e),await this.trainEnd(e))}}function Gj(e,t){if(null==e&&(e={}),e instanceof zj)return[e];if(Array.isArray(e)&&e[0]instanceof zj)return e;return DP(e).map(e=>new Hj(e,t))}class qj{constructor(){}static registerCallbackConstructor(e,t){Kw(e>=0&&Number.isInteger(e),()=>"Verbosity level is expected to be an integer >= 0, "+"but got ".concat(e)),qj.checkForDuplicate(t),null==qj.constructors[e]&&(qj.constructors[e]=[]),qj.constructors[e].push(t)}static checkForDuplicate(e){for(const t in qj.constructors){qj.constructors[+t].forEach(t=>{if(t===e)throw new SP("Duplicate callback constructor.")})}}static clear(){qj.constructors={}}static createCallbacks(e){const t=[];for(const n in qj.constructors){const r=+n;e>=r&&t.push(...qj.constructors[r])}return t.map(e=>new e)}}function Kj(e,t,n,r,a,i,o,s,l){const c=new Vj,u=[new Uj,...qj.createCallbacks(t)];null!=e&&u.push(...e),u.push(c);const h=new Wj(u);return h.setParams({epochs:n,initialEpoch:r,samples:a,steps:i,batchSize:o,verbose:t,doValidation:s,metrics:l}),{callbackList:h,history:c}}function Xj(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return jP(e,wI.getMap().classNameMap,t,"layer",n)}function Yj(e,t){return b_(()=>{"float32"!==e.dtype&&(e=oI(e,"float32"));const n=gA(AM(e),t,!0),r=CI(n.shape,bM()),a=fI(OI(n,r));return hI(e,a)})}function $j(e,t){return b_(()=>AA(AM(II(t,e)),-1))}function Jj(e,t){return b_(()=>AA(AI(II(t,e)),-1))}function Qj(e,t){return b_(()=>{const n=II(e,t),r=BT(AI(e),bM(),Number.MAX_VALUE),a=AI(hI(n,r));return dI(100,AA(a,-1))})}function Zj(e,t){return b_(()=>{const n=BT(t,bM(),Number.MAX_VALUE),r=dA(cI(1,n)),a=BT(e,bM(),Number.MAX_VALUE),i=dA(cI(1,a));return AA(AM(II(r,i)),-1)})}function eB(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return b_(()=>{if(n)t=aR(t);else{const e=gA(t,t.shape.length-1,!0);t=hI(t,e)}return t=BT(t,bM(),1-bM()),OA(gA(dI(oI(e,"float32"),dA(t)),t.shape.length-1))})}function tB(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return b_(()=>{const r=oI(sA(function(e){const t=[fM(e.shape)];return RT(e,t)}(e)),"int32"),a=(t=BT(t,bM(),1-bM())).shape;return eB(RT(PA(r,a[a.length-1]),a),t,n)})}function nB(e,t){return b_(()=>{let n;return n=BT(t,bM(),1-bM()),n=dA(hI(n,II(1,n))),AA(function(e,t){if(!Jw(e.shape,t.shape))throw new SP("logits and labels must have the same shape, but got shapes "+"".concat(JSON.stringify(e.shape)," and ").concat(JSON.stringify(t.shape)));return b_(()=>{const n=XA(t),r=OA(AI(t));return cI(II(n,dI(t,e)),fA(rA(r)))})}(e,n),-1)})}function rB(e,t){return b_(()=>{const n=BT(e,bM(),1),r=BT(t,bM(),1);return gA(dI(e,dA(hI(n,r))),-1)})}function aB(e,t){return b_(()=>{const n=Yj(e,-1),r=Yj(t,-1),a=dI(n,r);return OA(gA(a,-1))})}qj.constructors={};const iB={meanSquaredError:$j,meanAbsoluteError:Jj,meanAbsolutePercentageError:Qj,meanSquaredLogarithmicError:Zj,squaredHinge:function(e,t){return b_(()=>{const n=OI(0,II(1,dI(e,t)));return AA(AM(n),-1)})},hinge:function(e,t){return b_(()=>{const n=OI(0,II(1,dI(e,t)));return AA(n,-1)})},categoricalHinge:function(e,t){return b_(()=>{const n=gA(dI(e,t),-1),r=pA(dI(II(1,e),t),-1);return OI(0,cI(1,II(r,n)))})},logcosh:function(e,t){return b_(()=>{const n=Math.log(2),r=II(t,e),a=II(cI(r,iR(dI(-2,r))),n);return AA(a,-1)})},categoricalCrossentropy:eB,sparseCategoricalCrossentropy:tB,binaryCrossentropy:nB,kullbackLeiblerDivergence:rB,poisson:function(e,t){return b_(()=>{const n=dA(cI(bM(),t));return AA(II(t,dI(e,n)),-1)})},cosineProximity:aB};function oB(e){if("string"===typeof e){if(e in iB)return iB[e];let t="Unknown loss ".concat(e);throw e.toLowerCase().includes("softmaxcrossentropy")&&(t="Unknown loss ".concat(e,". ")+'Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new SP(t)}return e}function sB(e,t){return b_(()=>{const n=dI(.5,BA(t)),r=xM(cA(t,n),e.dtype);return AA(tA(e,r),-1)})}function lB(e,t){return b_(()=>xM(tA(gT(e,-1),gT(t,-1)),"float32"))}function cB(e,t){return b_(()=>oI(gA(EA(tA(e,1),tA(t,1))),"float32"))}function uB(e,t){return nB(e,t)}function hB(e,t){return e.rank===t.rank&&(e=sR(e,[e.rank-1])),(t=gT(t,-1)).dtype!==e.dtype&&(t=oI(t,e.dtype)),oI(tA(e,t),"float32")}const dB=eB,fB=tB,pB={binaryAccuracy:sB,categoricalAccuracy:lB,precision:function(e,t){return b_(()=>{const n=cB(e,t),r=function(e,t){return b_(()=>oI(gA(EA(tA(e,0),tA(t,1))),"float32"))}(e,t),a=cI(n,r);return oI(pR(cA(a,0),hI(n,a),0),"float32")})},categoricalCrossentropy:dB,sparseCategoricalCrossentropy:fB,mse:$j,MSE:$j,mae:Jj,MAE:Jj,mape:Qj,MAPE:Qj,cosine:aB};function gB(e){if("string"===typeof e&&e in pB)return pB[e];if("string"!==typeof e&&null!=e)return e;throw new SP("Unknown metric ".concat(e))}function mB(e){if(TP(null!==e,"Unknown LossOrMetricFn ".concat(e)),"string"===typeof e)return e;{let t;for(const n of Object.keys(iB))if(iB[n]===e){t=n;break}if(void 0!==t)return t;for(const n of Object.keys(pB))if(pB[n]===e){t=n;break}return void 0!==t?t:e.name}}const vB=1048576;function bB(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e||"object"!==typeof e||Object.getPrototypeOf(e)!==Object.prototype||!xB(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const n=JSON.stringify(e);n.length>vB&&console.warn('User-defined metadata of model "'.concat(t,'" is too large in ')+"size (length=".concat(n.length," when serialized). It is not ")+"recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= "+"".concat(vB,"."))}}function xB(e){if(null===e)return!0;if("object"===typeof e){if(Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);for(const n of t){if("string"!==typeof n)return!1;if(!xB(e[n]))return!1}return!0}if(Array.isArray(e)){for(const t of e)if(!xB(t))return!1;return!0}return!1}{const t=typeof e;return"string"===t||"number"===t||"boolean"===t}}function yB(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:console.log;const a=function(e){let t=!0;const n=[],r=[];for(const a in e.nodesByDepth)n.push(e.nodesByDepth[a]);for(const a of n){if(a.length>1||1===a.length&&a[0].inboundLayers.length>1){t=!1;break}r.push(...a)}if(t)for(const a of e.layers){let e=!1;for(const n of a.inboundNodes)if(-1!==r.indexOf(n)){if(e){t=!1;break}e=!0}if(!t)break}return t}(e),i=["Layer (type)","Input Shape","Output shape","Param #"];let o;if(a?(t=t||90,n=n||[.32,.61,.89,1]):(t=t||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(e=>Math.floor(t*e))),!a){i.push("Receives inputs"),o=[];for(const t in e.nodesByDepth)o.push(...e.nodesByDepth[t])}r("_".repeat(t)),wB(i,n,r),r("=".repeat(t));const s=e.layers;for(let u=0;u<s.length;++u)a?kB(s[u],n,r):NB(s[u],n,o,r),r((u===s.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();const l=function(e){let t;t=null!=e.collectedTrainableWeights?sj(e.collectedTrainableWeights):sj(e.trainableWeights);return t}(e),c=sj(e.nonTrainableWeights);r("Total params: ".concat(l+c)),r("Trainable params: ".concat(l)),r("Non-trainable params: ".concat(c)),r("_".repeat(t))}function wB(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log,r="";for(let a=0;a<e.length;++a)a>0&&(r=r.slice(0,r.length-1)+" "),r+=e[a],r=r.slice(0,t[a]),r+=" ".repeat(t[a]-r.length);n(r)}function kB(e,t,n){let r,a;try{a=e.inboundNodes.map(e=>JSON.stringify(e.inputShapes)).join(",")}catch(gfe){a="multiple"}try{r=JSON.stringify(e.outputShape)}catch(gfe){r="multiple"}const i=e.name,o=e.getClassName();wB(["".concat(i," (").concat(o,")"),a,r,e.countParams().toString()],t,n)}function NB(e,t,n,r){let a,i;try{i=e.inboundNodes.map(e=>JSON.stringify(e.inputShapes)).join(",")}catch(gfe){i="multiple"}try{a=JSON.stringify(e.outputShape)}catch(gfe){a="multiple"}const o=[];for(const u of e.inboundNodes)if(!(null!=n&&n.length>0&&-1===n.indexOf(u)))for(let e=0;e<u.inboundLayers.length;++e){const t=u.inboundLayers[e].name,n=u.nodeIndices[e],r=u.tensorIndices[e];o.push("".concat(t,"[").concat(n,"][").concat(r,"]"))}const s=e.name,l=e.getClassName(),c=0===o.length?"":o[0];wB(["".concat(s," (").concat(l,")"),i,a,e.countParams().toString(),c],t,r);for(let u=1;u<o.length;++u)wB(["","","","",o[u]],t,r)}function SB(e,t,n){return("inboundNodes"===e||"outputLayers"===e||"inputLayers"===e)&&0===t&&"string"===typeof n}function CB(e,t){if(null===e)return null;if("string"===typeof e)return OP(e);if("number"===typeof e||"boolean"===typeof e)return e;if(e instanceof Array){const n=[],r=e.length;for(let a=0;a<r;++a){const r=e[a];SB(t,a,r)?n.push(r):n.push(CB(r,t))}return n}{const t={};for(const n of Object.keys(e)){const r=e[n];if("name"===n&&"string"===typeof r)t[n]=r;else{const e=OP(n);t[e]=CB(r,e)}}return t}}function EB(e,t){if(null===e||void 0===e)return null;if("string"===typeof e)return FP(e);if("number"===typeof e||"boolean"===typeof e)return e;if(e instanceof Array){const n=[],r=e.length;for(let a=0;a<r;++a){const r=e[a];SB(t,a,r)?n.push(r):n.push(EB(r,t))}return n}{const t={};for(const n of Object.keys(e)){const r=e[n],a=FP(n);t[a]="name"!==n&&"className"!==n||"string"!==typeof r?EB(r,n):r}return t}}const _B="4.22.0";class IB extends vj{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,null==this.name){const e=this.getClassName().toLowerCase();this.name=$P(e)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],zP(this.inputs).length!==this.inputs.length)throw new SP("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+"".concat(this.inputs.map(e=>e.name)));zP(this.outputs).length!==this.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+"".concat(this.outputs.map(e=>e.name))),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const v of this.outputs){const e=v.sourceLayer,t=v.nodeIndex,n=v.tensorIndex;this.outputLayers.push(e),this.outputLayersNodeIndices.push(t),this.outputLayersTensorIndices.push(n)}for(const v of this.inputs){const e=v.sourceLayer,t=v.nodeIndex,n=v.tensorIndex;TP(0===t,"input layer has >1 nodes"),TP(0===n,"input layer has >1 tensors"),this.inputLayers.push(e),this.inputLayersNodeIndices.push(t),this.inputLayersTensorIndices.push(n)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let v=0;v<this.inputLayers.length;v++){const t=this.inputLayers[v];if(!(t instanceof xj))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. "+"Received inputs: ".concat(e.inputs,". ")+"Input ".concat(v," (0-based) originates ")+"from layer type ".concat(t.getClassName(),"."));this.inputNames.push(t.name),this.feedInputShapes.push(t.batchInputShape),this.feedInputNames.push(t.name)}for(const v of this.outputLayers)this.outputNames.push(v.name);this.internalInputShapes=this.inputs.map(e=>e.shape),this.internalOutputShapes=this.outputs.map(e=>e.shape);const t={},n={},r={},a={},i={},o=[],s=(e,t,n,r,a,l)=>{null!=r&&null!=a&&null!=l||(r=e.sourceLayer,a=e.nodeIndex,l=e.tensorIndex);const c=r.inboundNodes[a];if(-1!==n.indexOf(c))throw new NP("The tensor ".concat(e.name,' at layer "').concat(r.name,'" ')+"is part of a cycle.");if(-1!==t.indexOf(c))return;this.containerNodes.add(IB.nodeKey(r,a)),r.id in i||(i[r.id]=Object.keys(i).length),-1===n.indexOf(c)&&n.push(c);const u=c.inboundLayers.length;for(let i=0;i<u;i++){const e=c.inputTensors[i],r=c.inboundLayers[i],a=c.nodeIndices[i],o=c.tensorIndices[i];s(e,t,n,r,a,o)}for(t.push(c);n.indexOf(c)>=0;)n.splice(n.indexOf(c),1);o.push(c)},l=[],c=[];for(const v of this.outputs)s(v,l,c);const u=o.slice().reverse();for(const v of u){n[v.id]=v,v.id in t||(t[v.id]=0);let e=t[v.id];const i=null==r[v.outboundLayer.id]?0:r[v.outboundLayer.id];e=Math.max(e,i),r[v.outboundLayer.id]=e,a[v.outboundLayer.id]=v.outboundLayer,t[v.id]=e;for(let r=0;r<v.inboundLayers.length;r++){const a=v.inboundLayers[r],i=v.nodeIndices[r],o=a.inboundNodes[i],s=null==t[o.id]?0:t[o.id];t[o.id]=Math.max(e+1,s),n[o.id]=o}}const h={};for(const v in t){const e=t[v];e in h||(h[e]=[]),h[e].push(n[v])}const d={};for(const v in r){const e=r[v];e in d||(d[e]=[]),d[e].push(a[v])}let f=Object.keys(d).map(e=>parseInt(e,10)).sort(BP);this.layers=[];for(const v of f){const e=d[v];e.sort((e,t)=>{const n=i[e.id],r=i[t.id];return n<r?-1:n>r?1:0});for(const t of e)t instanceof IB&&this.internalContainerRefs.push(t),this.layers.push(t)}this.layersByDepth=d,f=Object.keys(h).map(e=>parseInt(e,10)).sort(BP);const p=this.inputs.slice(),g=[];for(const v of f)for(const e of h[v]){const t=e.outboundLayer;if(null!=t){for(const n of e.inputTensors)if(-1===p.indexOf(n))throw new NP("Graph disconnected: cannot obtain value for tensor ".concat(n)+' at layer "'.concat(t.name,'". ')+"The following previous layers were accessed without "+"issue: ".concat(g));for(const t of e.outputTensors)p.push(t);g.push(t.name)}}this.nodesByDepth=h;const m=this.layers.map(e=>e.name);for(const v of m){const e=m.filter(e=>e===v).length;if(1!==e)throw new NP('The name "'.concat(v,'" is used ').concat(e," times ")+"in the model. All layer names should be unique. Layer names: "+JSON.stringify(m))}this.outboundNodes=[],this.inboundNodes=[],new gj({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(e=>null),outputMasks:this.outputs.map(e=>null),inputShapes:this.inputs.map(e=>e.shape),outputShapes:this.outputs.map(e=>e.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(0===this._refCount)throw new Error("Container '".concat(this.name,"' is already disposed."))}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(0===--this._refCount){for(const t of this.layers)e.numDisposedVariables+=t.dispose().numDisposedVariables;for(const t of this.internalContainerRefs)e.numDisposedVariables+=t.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(t=>{t._trainableWeights.forEach(t=>t.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new SP("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const t of this.layers)e=e.concat(t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.layers)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const e of this.layers)t.push(...e.trainableWeights);return t.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n={};let r=0;const a=(e=>{const t=Object.keys(e);if(0===t.length)return!1;const n=t[0].split("/");return!isNaN(parseInt(n[n.length-1],10))})(e);a&&this.parseWeights(e);for(const o of this.layers)for(const[e,t]of o.weights.entries()){const i=a?"".concat(t.name.split("/").slice(0,-1).join("/")+"/").concat(e):t.originalName;if(null!=n[i])throw new SP("Duplicate weight name: ".concat(i));n[i]=t,r++}const i=[];for(const o in e){let r=o;if(null==n[o]){const e=o.split("/");r=e.slice(0,-2).concat([e[e.length-1]]).join("/")}if(null!=n[r])i.push([n[r],e[o]]);else if(t)throw new SP("Provided weight data has no target variable: ".concat(o));delete n[r]}if(t){const e=[];for(const t in n)e.push(t);if(e.length>0)throw new SP("".concat(e.length," of ").concat(r," weights are not set: ")+"".concat(e))}hj(i)}parseWeights(e){for(const t in Object.keys(e)){const n=t.split("/"),r=["vars","layer_checkpoint_dependencies"],a=n.map(e=>e.startsWith("_")?e.slice(1):e).filter(e=>!r.includes(e)).join("/");a!==t&&(e[a]=e[t],delete e[t])}}updatedConfig(){const e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion="tfjs-layers ".concat(_B),t.backend="TensorFlow.js",t}toJSON(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=EB(this.updatedConfig());return t?JSON.stringify(n):n}call(e,t){return b_(()=>{e=DP(e);const n=new yj;for(let t=0;t<this.inputs.length;++t)n.add(this.inputs[t],e[t]);return Nj(this.outputs,n,t)})}computeMask(e,t){return b_(()=>{let n;return e=DP(e),n=null==t?IP(null,e.length):DP(t),this.runInternalGraph(e,n)[1]})}computeOutputShape(e){const t=aj(e);if(t.length!==this.inputLayers.length)throw new SP("Invalid inputShape argument ".concat(e,": ")+"model has ".concat(this.inputLayers.length," tensor inputs."));const n={};for(let o=0;o<t.length;o++){const e=this.inputLayers[o],r=t[o];n[e.name+"_0_0"]=r}const r=Object.keys(this.nodesByDepth).map(e=>parseInt(e,10)).sort(BP);if(r.length>1)for(const o of r){const e=this.nodesByDepth[o];for(const t of e){const e=t.outboundLayer;if(-1!==this.inputLayers.map(e=>e.id).indexOf(e.id))continue;const r=[];for(let o=0;o<t.inboundLayers.length;o++){const e=t.inboundLayers[o],a=t.nodeIndices[o],i=t.tensorIndices[o],s=n["".concat(e.name,"_").concat(a,"_").concat(i)];r.push(s)}const a=aj(e.computeOutputShape(RP(r))),i=e.inboundNodes.indexOf(t);for(let t=0;t<a.length;t++){n["".concat(e.name,"_").concat(i,"_").concat(t)]=a[t]}}}const a=[],i=[];for(let o=0;o<this.outputLayers.length;o++){const e=this.outputLayers[o],t=this.outputLayersNodeIndices[o],n=this.outputLayersTensorIndices[o],r="".concat(e.name,"_").concat(t,"_").concat(n);i.push(r)}for(let o=0;o<i.length;o++){const e=i[o];TP(e in n),a.push(n[e])}return RP(a)}runInternalGraph(e,t){null==t&&(t=IP(null,e.length));const n={};for(let s=0;s<this.inputs.length;++s){const r=this.inputs[s],a=e[s],i=t[s];n[r.id]=[a,i]}const r=Object.keys(this.nodesByDepth).map(e=>parseInt(e,10)).sort(BP);for(const s of r){const e=this.nodesByDepth[s];for(const t of e){const e=t.outboundLayer,r=t.inputTensors,a=t.outputTensors,i=new Array;for(const t of r)t.id in n&&i.push(n[t.id]);if(i.length===r.length){let r,o,s,l,c={};if(null!=t.callArgs&&(c=t.callArgs),1===i.length){const[t,n]=i[0];null==c.mask&&(c.mask=n),s=DP(e.call(t,c)),l=DP(e.computeMask(t,n)),r=[t],o=[n]}else r=i.map(e=>e[0]),o=i.map(e=>e[1]),null==c.mask&&(c.mask=o),s=DP(e.call(r,c)),l=DP(e.computeMask(r,o));if(e.activityRegularizer)throw new CP("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let e=0;e<a.length;++e){const t=a[e],r=s[e],i=l[e];n[t.id]=[r,i]}}}}const a=[],i=[],o=[];for(const s of this.outputs){TP(s.id in n,"Could not compute output ".concat(s.name," : ").concat(s.id));const[e,t]=n[s.id];o.push(e.shape),a.push(e),i.push(t)}return[a,i,o]}buildNodeConversionMap(e){const t={};let n;for(const r of this.layers){n=r instanceof IB?1:0;for(let e=0;e<r.inboundNodes.length;e++){const a=IB.nodeKey(r,e);this.containerNodes.has(a)&&(t[a]=n,n+=1)}}return t}getLayer(e,t){if(null!=t)return this.findLayer(t);if(null==e)throw new SP("Provide either a layer name or layer index");if("number"===typeof e)return this.findLayer(e);for(const n of this.layers)if(n.name===e)return n;throw new SP("No such layer: ".concat(e))}findLayer(e){if(this.layers.length<=e)throw new SP("Was asked to retrieve layer at index ".concat(e,", but model only ")+"has ".concat(this.layers.length," layer(s)."));return this.layers[e]}calculateLosses(){return b_(()=>{const e=[];for(const t of this.layers)for(let n=0;n<t.inboundNodes.length;++n){const r=IB.nodeKey(t,n);this.containerNodes.has(r)&&e.push(...t.calculateLosses())}return e})}getConfig(){const e={name:this.name},t=this.buildNodeConversionMap(this.layers),n=[];for(const i of this.layers){const e=i.getClassName(),r=i.getConfig(),a=[];for(let n=0;n<i.inboundNodes.length;n++){const e=i.inboundNodes[n],r=IB.nodeKey(i,n);let o={};if(this.containerNodes.has(r)){if(e.callArgs)try{JSON.stringify(e.callArgs),o=e.callArgs}catch(gfe){console.warn("Layer ".concat(i.name," was passed ")+"non-serializable keyword arguments: "+"".concat(e.callArgs,". They will not be included ")+"in the serialized model (and thus will be missing at deserialization time)."),o={}}if(e.inboundLayers.length>0){const n=[];for(let r=0;r<e.inboundLayers.length;r++){const a=e.inboundLayers[r],i=e.nodeIndices[r],s=e.tensorIndices[r];let l=t[IB.nodeKey(a,i)];null==l&&(l=0),n.push([a.name,l,s,o])}a.push(n)}}}const o={};o.name=i.name,o.className=e,o.config=r,o.inboundNodes=a,n.push(o)}e.layers=n;const r=[];for(let i=0;i<this.inputLayers.length;i++){const e=this.inputLayers[i],n=this.inputLayersNodeIndices[i],a=IB.nodeKey(e,n);if(!this.containerNodes.has(a))continue;let o=t[a];null!==o&&void 0!==o||(o=0);const s=this.inputLayersTensorIndices[i];r.push([e.name,o,s])}e.inputLayers=r;const a=[];for(let i=0;i<this.outputLayers.length;i++){const e=this.outputLayers[i],n=this.outputLayersNodeIndices[i],r=IB.nodeKey(e,n);if(!this.containerNodes.has(r))continue;let o=t[r];null!==o&&void 0!==o||(o=0);const s=this.outputLayersTensorIndices[i];a.push([e.name,o,s])}return e.outputLayers=a,e}static fromConfig(e,t){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r={},a={};function i(e,t){e.name in a?a[e.name].push(t):a[e.name]=[t]}function o(e,t){const n=[];let a;for(const o of t){const s=o[0],l=o[1],c=o[2];if(a=null==o[3]?{}:o[3],!(s in r))return void i(e,t);const u=r[s];if(u.inboundNodes.length<=l)return void i(e,t);const h=u.inboundNodes[l];n.push(h.outputTensors[c])}n.length>0&&e.apply(RP(n),a)}function s(e){const a=e.name,o=Xj(e,null!=t.customObjects?t.customObjects:{});o.setFastWeightInitDuringBuild(n),r[a]=o;e.inboundNodes.forEach(e=>{if(!(e instanceof Array))throw new SP("Corrupted configuration, expected array for nodeData: ".concat(e));i(o,e)})}const l=t.name,c=t.layers;for(const p of c)s(p);for(;!WP(a);)for(const e of c){const t=r[e.name];if(t.name in a){const e=a[t.name];delete a[t.name];for(const n of e)o(t,n)}}const u=[],h=[],d=t.inputLayers;for(const p of d){const e=p[0],t=p[1],n=p[2];TP(e in r);const a=r[e].inboundNodes[t].outputTensors;u.push(a[n])}const f=t.outputLayers;for(const p of f){const e=p[0],t=p[1],n=p[2];TP(e in r);const a=r[e].inboundNodes[t].outputTensors;h.push(a[n])}return new e({inputs:u,outputs:h,name:l})}get stateful(){if(this._stateful)throw new SP("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){b_(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}function TB(e,t,n){const r=t.length;if(null==e||Array.isArray(e)&&0===e.length)return t.map(e=>null);if(1===r)return Array.isArray(e)&&1===e.length?e:"object"===typeof e&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw new Error("Provided ".concat(n," is an array of ").concat(e.length," ")+"element(s), but the model has ".concat(r," outputs. ")+"Make sure a set of weights is provided for each model output.");return e}if("object"===typeof e&&Object.keys(e).length>0&&"object"===typeof e[Object.keys(e)[0]]){const n=[];return t.forEach(t=>{t in e?n.push(e[t]):n.push(null)}),n}throw new Error("The model has multiple (".concat(r,") outputs, ")+"so ".concat(n," must be either an array with ")+"".concat(r," elements or an object with ").concat(t," keys. ")+"Provided ".concat(n," not understood: ").concat(JSON.stringify(e)))}function AB(e,t){return TB(e,t,"classWeight")}async function RB(e,t,n,r){if(null!=t||null!=r)throw new Error("Support sampleWeight is not implemented yet");if(null!=n){const t=b_(()=>{if(1===e.shape.length)return sI(e);if(2===e.shape.length){if(e.shape[1]>1){return gT(e,1)}if(1===e.shape[1])return RT(e,[e.shape[0]]);throw new Error("Encountered unexpected last-dimension size (".concat(e.shape[1],") ")+"during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor (".concat(e.rank,") during ")+"handling of class weights. The rank is expected to be 1 or 2.")}),r=Array.from(await t.data());x_(t);const a=[];return r.forEach(e=>{if(null==n[e])throw new Error("classWeight must contain all classes in the training data. "+"The class ".concat(e," exists in the data but not in ")+"classWeight");a.push(n[e])}),uR(a,"float32")}return null}function DB(e,t){return dI(e,t)}function FB(e,t){let n,r;const a=t;n=a.xs,r=a.ys,Kw(null!=n&&null!=r,()=>"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+"".concat(t));const i=OB("input",e.inputNames,n),o=OB("output",e.outputNames,r),s=i[0].shape[0];Kw(i.length===e.inputs.length,()=>"LayersModel has ".concat(e.inputs.length," inputs, but the dataset ")+"provides ".concat(i.length," inputs.  (Expected input keys: ")+"".concat(JSON.stringify(e.inputNames),")")),Kw(o.length===e.outputs.length,()=>"LayersModel has ".concat(e.outputs.length," outputs, but the dataset ")+"provides ".concat(o.length," outputs.  (Expected output keys: ")+"".concat(JSON.stringify(e.outputNames),")"));for(let l=0;l<i.length;l++)Kw(i[l].shape[0]===s,()=>"Batch size mismatch: input "+"".concat(e.inputNames[l]," has ").concat(i[l].shape[0],"; ")+"expected  ".concat(s," based on input ").concat(e.inputNames[0],"."));for(let l=0;l<o.length;l++)Kw(o[l].shape[0]===s,()=>"Batch size mismatch: output "+"".concat(e.outputNames[l]," has ").concat(o[l].shape[0],"; ")+"expected  ".concat(s," based on input ").concat(e.inputNames[0],"."));return{xs:i,ys:o}}function OB(e,t,n){if(n instanceof FE)return[n];if(Array.isArray(n))return Kw(n.length===t.length,()=>"Received an array of ".concat(n.length," Tensors, but expected ").concat(t.length," to match the ").concat(e," keys ").concat(t,".")),n;{const r=[];for(const a of t){if(null==n[a])throw new SP("The feature data generated by the dataset lacks the required "+"".concat(e," key '").concat(a,"'."));r.push(n[a])}return r}}async function LB(e,t,n){const r=null!=n.batchesPerEpoch;if(Kw(null!=e.optimizer,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),Kw(null!=n,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),Kw(null!=n.epochs&&n.epochs>0&&Number.isInteger(n.epochs),()=>"For fitDataset(), config.epochs is expected to be a positive "+"integer, but got ".concat(n.epochs)),Kw(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>"For fitDataset(), config.batchesPerEpoch is expected to be a "+"positive integer if specified, but got ".concat(n.batchesPerEpoch)),Kw(null==n.validationSplit,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0;try{const a=null!=n.validationData;let i,o;if(a)if(PB(n.validationData))Kw(null==n.validationBatches||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, "+"but got ".concat(n.validationBatches));else{const e=function(e){if(3===e.length)throw new CP("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}(n.validationData);i=e.xs,o=e.ys}const s=e.makeTrainFunction(),l=e.getDedupedMetricsNames();let c;c=a?l.slice().concat(l.map(e=>"val_"+e)):l.slice();const u=Gj(n.callbacks,n.yieldEvery),h=null==n.verbose?1:n.verbose,{callbackList:d,history:f}=Kj(u,h,n.epochs,null,null,function(e,t){let n=null;null!=t.batchesPerEpoch?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size);return n}(t,n),null,a,c);d.setModel(e),e.history=f,await d.onTrainBegin(),e.stopTraining_=!1;let p=null==n.initialEpoch?0:n.initialEpoch,g=await t.iterator();for(;p<n.epochs;){const c={};await d.onEpochBegin(p);let u=0,h=0;for(r||(g=await t.iterator());!r||u<n.batchesPerEpoch;){const t=await g.next();if(r&&t.done){console.warn("You provided `batchesPerEpoch` as "+"".concat(n.batchesPerEpoch,", ")+"but your dataset iterator ran out of data after "+"".concat(u," batches; ")+"interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+"".concat(n.batchesPerEpoch*n.epochs," batches). ")+"You may need to use the repeat() function when building your dataset.");break}if(null!=t.value){const{xs:r,ys:a}=FB(e,t.value),i={};i.batch=h,i.size=r[0].shape[0],await d.onBatchBegin(h,i);const o=[];if(null!=n.classWeight){const t=AB(n.classWeight,e.outputNames);for(let e=0;e<t.length;++e)o.push(await RB(a[e],null,t[e]))}const c=r.concat(a).concat(o),f=s(c);x_(c);for(let e=0;e<l.length;++e){const t=l[e],n=f[e];i[t]=n,y_(n)}await d.onBatchEnd(h,i),jj(i),h++,u++}if(r?u>=n.batchesPerEpoch:t.done){if(a){let t;t=PB(n.validationData)?DP(await e.evaluateDataset(n.validationData,{batches:n.validationBatches})):DP(e.evaluate(i,o,{batchSize:null==n.validationBatchSize?32:n.validationBatchSize,verbose:0}));for(let n=0;n<e.metricsNames.length;++n)c["val_".concat(e.metricsNames[n])]=t[n]}break}if(e.stopTraining_)break}if(await d.onEpochEnd(p,c),p++,e.stopTraining_)break}return await d.onTrainEnd(),await e.history.syncData(),e.history}finally{e.isTraining=!1}}function PB(e){return"function"===typeof e.iterator}function MB(e){Kw(e>0&&Number.isInteger(e),()=>"batchSize is required to be a positive integer, but got ".concat(e))}function jB(e,t,n){return null==e?[null]:Array.isArray(e)?e.map(e=>wM(e,t,n-t)):wM(e,t,n-t)}function BB(e,t){return b_(()=>null==e?null:Array.isArray(e)?e.map(e=>BB(e,t)):TM(e,"int32"===t.dtype?t:oI(t,"int32")))}function zB(e,t){const n=[];let r=0,a=null;for(;r<e;)a=r+t,a>=e&&(a=e),n.push([r,a]),r=a;return n}function WB(e){const t=[];e instanceof FE&&(e=[e]);for(let n=0;n<e.length;++n){const r=e[n];if(1===r.rank)t.push(yM(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function UB(e,t){if(null==e)return;const n=[];if(t instanceof FE)n.push(t.id);else if(Array.isArray(t))t.forEach(e=>n.push(e.id));else if(null!=t)for(const a in t){const e=t[a];n.push(e.id)}const r=[];if(e instanceof FE)-1===n.indexOf(e.id)&&r.push(e);else if(Array.isArray(e))e.forEach(e=>{-1===n.indexOf(e.id)&&r.push(e)});else if(null!=e)for(const a in e){const t=e[a];-1===n.indexOf(t.id)&&r.push(t)}r.forEach(e=>{e.isDisposed||e.dispose()})}function VB(e){return Array.isArray(e)}function HB(e){return!function(e){return e instanceof FE}(e)&&!VB(e)}function GB(e,t,n){let r,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(null==t||0===t.length){if(null!=e){let t=!1;if(VB(e)&&e.length>0)t=!0;else if(HB(e)){for(const n in e)if(e.hasOwnProperty(n)){t=!0;break}}else t=!0;if(t)throw new SP("Error when checking model ".concat(i," expected no data, ")+"but got ".concat(e))}return[]}if(null==e)return t.map(e=>null);if(HB(e)){r=[];for(const n of t){if(null==e[n])throw new SP('No data provided for "'.concat(n,'". Need data for each key in: ')+"".concat(t));r.push(e[n])}}else if(VB(e)){if(e.length!==t.length)throw new SP("Error when checking model ".concat(i,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"model expected. Expected to see ".concat(t.length," Tensor(s), but ")+"instead got the following list of Tensor(s): ".concat(e));r=e}else{if(t.length>1)throw new SP("The model ".concat(i," expects ").concat(t.length," Tensor(s), ")+"but only received one Tensor. Found: Tensor with shape ".concat(e.shape));r=[e]}if(r=WB(r),null!=n)for(let o=0;o<t.length;++o){if(null==n[o])continue;const e=r[o];if(e.shape.length!==n[o].length)throw new SP("Error when checking ".concat(i,": expected ").concat(t[o]," ")+"to have ".concat(n[o].length," dimension(s). but got array with ")+"shape ".concat(e.shape));for(let t=0;t<n[o].length;++t){if(0===t&&!a)continue;const r=e.shape[t],s=n[o][t];if(null!=s&&s>=0&&r!==s)throw new SP("".concat(i," expected a batch of elements where each ")+"example has shape [".concat(n[o].slice(1,n[o].length),"] ")+"(i.e.,tensor shape [*,".concat(n[o].slice(1,n[o].length),"])")+" but the ".concat(i," received an input with ").concat(e.shape[0])+" examples, each with shape [".concat(e.shape.slice(1,e.shape.length),"]")+" (tensor shape [".concat(e.shape,"])"))}}return r}function qB(e,t,n){let r,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(Array.isArray(e)){if(e.length!==t.length)throw new SP("Error when checking model ".concat(i,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"the model expected. Expected to see ".concat(t.length," Tensor(s),")+" but instead got ".concat(e.length," Tensors(s)."));r=e}else{if(t.length>1)throw new SP("The model expects ".concat(t.length," ").concat(i," Tensors, ")+"but only received one Tensor. Found: array with shape "+"".concat(JSON.stringify(e.shape),"."));r=[e]}if(null!=n)for(let o=0;o<t.length;++o){if(null==n[o])continue;const e=r[o];if(e.shape.length!==n[o].length)throw new SP("Error when checking ".concat(i,": expected ").concat(t[o]," ")+"to have ".concat(n[o].length," dimension(s), but got array with ")+"shape ".concat(JSON.stringify(e.shape)));for(let r=0;r<n[o].length;++r){if(0===r&&!a)continue;const s=e.shape[r],l=n[o][r];if(null!=l&&l!==s)throw new SP("Error when checking ".concat(i,": expected ")+"".concat(t[o]," to have shape ").concat(JSON.stringify(n[o])," but ")+"got array with shape ".concat(JSON.stringify(e.shape),"."))}}}class KB extends IB{constructor(e){super(e),this.isTraining=!1}summary(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;if(!this.built)throw new SP("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");yB(this,e,t,n)}compile(e){if(null==e.loss&&(e.loss=[]),this.loss=e.loss,"string"===typeof e.optimizer)this.optimizer_=function(e){const t={Adagrad:()=>yD.adagrad(.01),Adadelta:()=>yD.adadelta(1,.95,bM()),Adam:()=>yD.adam(.001,.9,.999,bM()),Adamax:()=>yD.adamax(.002,.9,.999,bM(),0),RMSProp:()=>yD.rmsprop(.001,.9,0,bM()),SGD:()=>yD.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new SP("Unknown Optimizer ".concat(e))}(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof NI))throw new SP("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let t=[];if(Array.isArray(e.loss)||"string"===typeof e.loss||"function"===typeof e.loss)if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new SP("When passing an Array as loss, it should have one entry per "+"model output. The model has ".concat(this.outputs.length," output(s), ")+"but you passed loss=".concat(e.loss,"."));const n=e.loss;t=n.map(e=>oB(e))}else{const n=oB(e.loss);this.outputs.forEach(e=>{t.push(n)})}else{e.loss=e.loss;for(const t in e.loss)if(-1===this.outputNames.indexOf(t))throw new SP('Unknown entry in loss dictionary: "'.concat(t,'". ')+"Only expected the following keys: ".concat(this.outputNames));for(const n of this.outputNames)null==e.loss[n]&&console.warn('Output "'.concat(n,'" is missing from loss dictionary. We assume ')+"this was done on purpose, and we will not be expecting data "+"to be passed to ".concat(n," during training")),t.push(oB(e.loss[n]))}this.lossFunctions=t,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let i=0;i<this.outputs.length;++i){const e=this.internalOutputShapes[i],t=this.outputNames[i];this.feedOutputNames.push(t),this.feedOutputShapes.push(e),this.feedLossFns.push(this.lossFunctions[i])}const n=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],sM("loss",()=>{for(let e=0;e<this.outputs.length;++e){if(-1!==n.indexOf(e))continue;const t=this.lossFunctions[e];this.outputs.length>1&&(this.metricsTensors.push([t,e]),this.metricsNames.push(this.outputNames[e]+"_loss"))}});const r=function(e,t){if(null==e||Array.isArray(e)&&0===e.length)return t.map(e=>[]);let n;if("string"===typeof e||"function"===typeof e)n=[e];else{if(!Array.isArray(e)&&"object"!==typeof e)throw new TypeError("Type of metrics argument not understood. Expected an string,"+"function, Array, or Object, found: ".concat(e));n=e}if(Array.isArray(n))return t.map(e=>n);{const e=[];for(const r of t){let t=n.hasOwnProperty(r)?n[r]:[];Array.isArray(t)||(t=[t]),e.push(t)}return e}}(e.metrics,this.outputNames),a=(e,t,n)=>{this.outputNames.length>1&&(t=this.outputNames[e]+"_"+t),this.metricsNames.push(t),this.metricsTensors.push([n,e])};sM("metric",()=>{for(let e=0;e<this.outputs.length;++e){if(-1!==n.indexOf(e))continue;(t=>{let n,r,i;for(const o of t){if("string"===typeof o&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(o)){const t=this.internalOutputShapes[e];let a;1===t[t.length-1]||this.lossFunctions[e]===nB?-1!==["accuracy","acc"].indexOf(o)?r=sB:-1!==["crossentropy","ce"].indexOf(o)&&(r=uB):this.lossFunctions[e]===tB?-1!==["accuracy","acc"].indexOf(o)?r=hB:-1!==["crossentropy","ce"].indexOf(o)&&(r=fB):-1!==["accuracy","acc"].indexOf(o)?r=lB:-1!==["crossentropy","ce"].indexOf(o)&&(r=dB),-1!==["accuracy","acc"].indexOf(o)?a="acc":-1!==["crossentropy","ce"].indexOf(o)&&(a="ce"),i=r,n=""+a}else{const e=gB(o);i=e,n=""+mB(o)}let t;sM(n,()=>{t=i}),a(e,n,t)}})(r[e])}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=null==n.batchSize?32:n.batchSize;MB(r);const a=this.standardizeUserDataXY(e,t,!0,r);try{const e=a[0].concat(a[1]);this.makeTestFunction();const t=this.testFunction;return RP(this.testLoop(t,e,r,n.verbose,n.steps))}finally{UB(a[0],e),UB(a[1],t)}}async evaluateDataset(e,t){return this.makeTestFunction(),async function(e,t,n){const r=null!=(n=n||{}).batches,a=e.testFunction;let i=[];if(n.verbose>0)throw new CP("Verbose mode is not implemented yet.");Kw(!r||n.batches>0&&Number.isInteger(n.batches),()=>"Test loop expects `batches` to be a positive integer, but "+"received ".concat(JSON.stringify(n.batches)));const o=function(e){return"function"===typeof e.next}(t)?t:await t.iterator();let s=0,l=0;for(;!r||l<n.batches;){const t=await o.next();if(i=b_(()=>{if(t.value){const{xs:n,ys:r}=FB(e,t.value),o=n.concat(r),c=b_(()=>a(o));if(x_(o),0===l)for(let e=0;e<c.length;++e)i.push(vI(0));const u=o[0].shape[0];for(let e=0;e<c.length;++e){const t=c[e],n=i[e];i[e]=b_(()=>cI(i[e],dI(u,t))),l>0&&x_(n)}x_(c),s+=u,++l}return i}),t.done){r&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` "+"batches (in this case, ".concat(n.batches," batches). ")+"You may need to use the repeat() function when building your dataset.");break}}for(let c=0;c<i.length;++c){const e=i[c];i[c]=hI(i[c],s),x_(e)}return RP(i)}(this,e,t)}checkNumSamples(e,t,n){let r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"steps";if(null!=n){if(r=null,null!=t)throw new SP("If ".concat(a," is set, batchSize must be null or undefined.")+"Got batchSize = ".concat(t))}else{if(null==e)throw new SP("Either the input data should have a defined shape, or "+"".concat(a," shoud be specified."));r=Array.isArray(e)?e[0].shape[0]:e.shape[0]}return r}execute(e,t){if(Array.isArray(t)&&0===t.length)throw new SP("`outputs` is an empty Array, which is not allowed.");const n=Array.isArray(t),r=n?t:[t],a=this.retrieveSymbolicTensors(r),i=new yj;if(e instanceof FE&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new SP("The number of inputs provided (".concat(e.length,") ")+"does not match the number of inputs of this model "+"(".concat(this.inputs.length,")."));for(let t=0;t<this.inputs.length;++t)i.add(this.inputs[t],e[t])}else for(const s of this.inputs){const t=e[s.name];if(null==t)throw new SP("No value is provided for the model's input ".concat(s.name));i.add(s,t)}const o=Nj(a,i);return n?o:o[0]}retrieveSymbolicTensors(e){const t=IP(null,e.length);let n=e.length;for(const r of this.layers){const a=Array.isArray(r.output)?r.output:[r.output],i=a.map(e=>e.name);for(let r=0;r<e.length;++r){const o=i.indexOf(e[r]);if(-1!==o&&(t[r]=a[o],n--),0===n)break}if(0===n)break}if(n>0){const n=[];throw t.forEach((t,r)=>{null==t&&n.push(e[r])}),new SP("Cannot find SymbolicTensors for output name(s): "+"".concat(JSON.stringify(n)))}return t}predictLoop(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return b_(()=>{const r=this.checkNumSamples(e);if(n)throw new CP("Verbose predictLoop() is not implemented yet.");const a=zB(r,t),i=this.outputs.map(e=>[]);for(let t=0;t<a.length;++t){const n=b_(()=>{const n=a[t][0],r=a[t][1],i=jB(e,n,r),o=[];if(Array.isArray(i))for(let e=0;e<i.length;++e)o.push({key:this.inputs[e],value:i[e]});else o.push({key:this.inputs[0],value:i});const s=new yj(o);return Nj(this.outputs,s)});n.forEach((e,t)=>i[t].push(e))}return RP(i.map(e=>zT(e,0)))})}predict(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=WB(e);qB(n,this.inputNames,this.feedInputShapes,!1);try{const e=null==t.batchSize?32:t.batchSize;return MB(e),this.predictLoop(n,e)}finally{UB(n,e)}}predictOnBatch(e){qB(e,this.inputNames,this.feedInputShapes,!0);const t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}standardizeUserDataXY(e,t){let n=arguments.length>3?arguments[3]:void 0;if(null==this.optimizer_)throw new NP("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const r=[];for(let a=0;a<this.feedOutputShapes.length;++a){const e=this.feedOutputShapes[a];this.feedLossFns[a]===tB?r.push(e.slice(0,e.length-1).concat([1])):r.push(e)}if(function(e,t){const n=zP(e.map(e=>e.shape[0]));n.sort();const r=zP(t.map(e=>e.shape[0]));if(r.sort(),n.length>1)throw new SP("All input Tensors (x) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(e.map(e=>e.shape))));if(r.length>1)throw new SP("All target Tensors (y) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(t.map(e=>e.shape))));if(n.length>0&&r.length>0&&!Jw(n,r))throw new SP("Input Tensors should have the same number of samples as target "+"Tensors. Found ".concat(n[0]," input sample(s) and ").concat(r[0]," target ")+"sample(s).")}(e=GB(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=GB(t,this.feedOutputNames,r,!1,"target")),function(e,t,n){const r=[$j,nB,eB];for(let a=0;a<e.length;++a){const i=e[a],o=t[a],s=n[a];if(null!=o){if(o===eB&&1===i.shape[i.shape.length-1])throw new SP("You are passing a target array of shape ".concat(i.shape," while using ")+"a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(-1!==r.indexOf(o)){const e=i.shape.slice(1),t=s.slice(1);for(let n=0;n<e.length;++n){const r=e[n],a=t[n];if(null!=a&&r!==a)throw new SP("A target Tensor with shape ".concat(i.shape," was passed for an ")+"output of shape ".concat(s,", while using a loss function that ")+"expects targets to have the same shape as the output.")}}}}}(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=n&&n>0&&e[0].shape[0]%n!==0)throw new SP("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+"".concat(n,". Found: ").concat(e[0].shape[0]," sample(s)."));return[e,t]}async standardizeUserData(e,t,n,r){let a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=arguments.length>5?arguments[5]:void 0;const[o,s]=this.standardizeUserDataXY(e,t,a,i);if(null!=n)throw new Error("sample weight is not supported yet.");let l=null;if(null!=r){const e=AB(r,this.outputNames);l=[];for(let t=0;t<e.length;++t)l.push(await RB(s[t],null,e[t]))}return[o,s,l]}testLoop(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4?arguments[4]:void 0;return b_(()=>{const i=this.checkNumSamples(t,n,a,"steps"),o=[];if(r>0)throw new CP("Verbose mode is not implemented yet.");if(null!=a)throw new CP("steps mode in testLoop() is not implemented yet");{const r=zB(i,n),a=uR(mM(0,i));for(let n=0;n<r.length;++n){const i=r[n][0],s=r[n][1],l=wM(a,i,s-i),c=BB(t,l),u=e(c);if(0===n)for(let e=0;e<u.length;++e)o.push(vI(0));for(let e=0;e<u.length;++e){const t=u[e];o[e]=cI(o[e],dI(s-i,t))}}for(let e=0;e<o.length;++e)o[e]=hI(o[e],i)}return o})}getDedupedMetricsNames(){const e=this.metricsNames,t=[];for(let n=0;n<e.length;++n){const r=e[n];let a=r;if(AP(e,r)>1){const t=AP(e.slice(0,n),r);a+="_".concat(t)}t.push(a)}return t}makeTrainFunction(){return e=>{const t=[],n=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+2*this.outputs.length),i=[],o=this.collectedTrainableWeights.map(e=>e.read()),s=this.optimizer_.minimize(()=>{const e=[];for(let t=0;t<this.inputs.length;++t)e.push({key:this.inputs[t],value:n[t]});const o=new yj(e),s=Nj(this.outputs,o,{training:!0});let l;for(let n=0;n<this.lossFunctions.length;++n){let e=(0,this.lossFunctions[n])(r[n],s[n]);null!=a[n]&&(e=DB(e,a[n]));const i=AA(e);t.push(i),l=0===n?e:cI(l,e)}for(let n=0;n<this.metricsTensors.length;++n){let e;if(this.outputs.length>1&&n<this.outputs.length)e=t[n];else{const t=this.metricsTensors[n][0],a=this.metricsTensors[n][1];e=AA(t(r[a],s[a]))}y_(e),i.push(e)}return l=AA(l),this.calculateLosses().forEach(e=>{l=cI(l,e)}),l},!0,o);return[s].concat(i)}}makeTestFunction(){this.testFunction=e=>b_(()=>{const t=[];let n;const r=e.slice(0,this.inputs.length),a=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=[];for(let e=0;e<this.inputs.length;++e)i.push({key:this.inputs[e],value:r[e]});const o=new yj(i),s=Nj(this.outputs,o);for(let e=0;e<this.lossFunctions.length;++e){const r=this.lossFunctions[e],i=AA(r(a[e],s[e]));n=0===e?i:cI(n,i),t.push(n)}for(let e=0;e<this.metricsTensors.length;++e){const n=this.metricsTensors[e][0],r=this.metricsTensors[e][1],i=AA(n(a[r],s[r]));t.push(i)}return t})}async fit(e,t){let n,r,a,i,o,s,l,c,u,h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;try{const d=null==h.batchSize?32:h.batchSize;MB(d);const f=!1,p=await this.standardizeUserData(e,t,h.sampleWeight,h.classWeight,f,d);n=p[0],r=p[1],u=p[2];let g,m=!1;if(null!=h.validationData&&h.validationData.length>0){if(m=!0,2!==h.validationData.length)throw 3===h.validationData.length?new CP("validationData including sample weights is not supported yet."):new SP("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+"".concat(h.validationData," is invalid."));o=h.validationData[0],s=h.validationData[1];const e=!0,t=await this.standardizeUserData(o,s,null,null,e,d);l=t[0],c=t[1],g=l.concat(c)}else if(null!=h.validationSplit&&h.validationSplit>0&&h.validationSplit<1){m=!0;const e=Math.floor(n[0].shape[0]*(1-h.validationSplit)),t=n[0].shape[0];l=jB(n,e,t),a=n,n=jB(n,0,e),c=jB(r,e,t),i=r,r=jB(r,0,e),g=l.concat(c)}else null!=h.validationSteps&&(m=!0);const v=n.concat(r).concat(u);this.checkTrainableWeightsConsistency();const b=this.makeTrainFunction(),x=this.getDedupedMetricsNames();let y,w;m?(this.makeTestFunction(),y=this.testFunction,w=x.slice().concat(x.map(e=>"val_"+e))):(y=null,g=[],w=x.slice());const k=Gj(h.callbacks,h.yieldEvery);return await this.fitLoop(b,v,x,d,h.epochs,h.verbose,k,y,g,h.shuffle,w,h.initialEpoch,null,null)}finally{this.isTraining=!1,UB(n,e),UB(r,t),UB(a,e),UB(i,t),UB(l,o),UB(c,s),null!=u&&x_(u)}}async fitLoop(e,t,n,r,a,i,o,s,l,c,u,h,d,f){null==r&&(r=32),null==a&&(a=1),null==c&&(c=!0),null==h&&(h=0);let p=!1;if(null!=s&&null!=l&&(p=!0),null!=f&&(p=!0,null==d))throw new SP("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const g=this.checkNumSamples(t,r,d,"steps_per_epoch");let m;null!=g&&(m=mM(0,g)),null==i&&(i=1);const{callbackList:v,history:b}=Kj(o,i,a,h,g,d,r,p,u);v.setModel(this),this.history=b,await v.onTrainBegin(),this.stopTraining_=!1;for(let x=h;x<a;++x){await v.onEpochBegin(x);const a={};if(null!=d)throw new CP("stepsPerEpoch mode is not implemented yet.");{if("batch"===c)throw new CP("batch shuffling is not implemneted yet");c&&Vw(m);const i=uR(m),o=zB(g,r);for(let c=0;c<o.length;++c){const u={};if(await v.onBatchBegin(c,u),b_(()=>{const h=o[c][0],d=o[c][1],f=wM(i,h,d-h);u.batch=c,u.size=d-h;const g=BB(t,f),m=e(g);for(let e=0;e<n.length;++e){const t=n[e],r=m[e];u[t]=r,y_(r)}if(c===o.length-1&&p){const e=this.testLoop(s,l,r);for(let t=0;t<n.length;++t){const r=n[t],i=e[t];y_(i),a["val_"+r]=i}}}),await v.onBatchEnd(c,u),jj(u),this.stopTraining_)break}i.dispose()}if(await v.onEpochEnd(x,a),this.stopTraining_)break}return await v.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,t){return LB(this,e,t)}async trainOnBatch(e,t){const n=await this.standardizeUserData(e,t),r=n[0],a=n[1],i=this.makeTrainFunction()(r.concat(a)),o=[];for(const s of i){const e=await s.data();o.push(e[0])}return x_(i),UB(n[0],e),UB(n[1],t),RP(o)}getNamedWeights(e){const t=[],n=null!=e&&e.trainableOnly,r=n?this.trainableWeights:this.weights,a=this.getWeights(n);for(let i=0;i<r.length;++i)n&&!r[i].trainable||t.push({name:r[i].originalName,tensor:a[i]});return t}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(0===e.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){const t=v_().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-v_().numTensors}return e}getLossIdentifiers(){let e;if("string"===typeof this.loss)e=FP(this.loss);else if(Array.isArray(this.loss)){for(const e of this.loss)if("string"!==typeof e)throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(e=>FP(e))}else{const t=Object.keys(this.loss);e={};const n=this.loss;for(const r of t){if("string"!==typeof n[r])throw new Error("Serialization of non-string loss is not supported.");e[r]=FP(n[r])}}return e}getMetricIdentifiers(){if("string"===typeof this.metrics||"function"===typeof this.metrics)return[FP(mB(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>FP(mB(e)));{const e={};for(const t in this.metrics)e[t]=FP(mB(this.metrics[t]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(null!=e.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=e.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=e.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");const t=Xj(CB(e.optimizer_config));let n,r;if("string"===typeof e.loss)n=OP(e.loss);else if(Array.isArray(e.loss))n=e.loss.map(e=>OP(e));else if(null!=e.loss){n={};for(const t in e.loss)n[t]=OP(e.loss[t])}if(Array.isArray(e.metrics))r=e.metrics.map(e=>OP(e));else if(null!=e.metrics){r={};for(const t in e.metrics)r[t]=OP(e.metrics[t])}this.compile({loss:n,metrics:r,optimizer:t})}async save(e,t){if("string"===typeof e){const t=(e=>R_.getSaveHandlers(e))(e);if(0===t.length)throw new SP("Cannot find any save handlers for URL '".concat(e,"'"));if(t.length>1)throw new SP("Found more than one (".concat(t.length,") save handlers for ")+"URL '".concat(e,"'"));e=t[0]}if(null==e.save)throw new SP("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const n=await N_(this.getNamedWeights(t)),r={modelTopology:this.toJSON(null,!1),format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v".concat(_B),convertedBy:null};if(null!=t&&t.includeOptimizer&&null!=this.optimizer){r.trainingConfig=this.getTrainingConfig();const e="optimizer",{data:t,specs:i}=await N_(await this.optimizer.getWeights(),e);n.specs.push(...i),n.data=(a=[n.data,t],g_.join(a))}var a;if(null!=this.userDefinedMetadata){const e=!0;bB(this.userDefinedMetadata,this.name,e),r.userDefinedMetadata=this.userDefinedMetadata}return r.weightData=n.data,r.weightSpecs=n.specs,e.save(r)}setUserDefinedMetadata(e){bB(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}KB.className="Model",kI(KB);class XB extends KB{}XB.className="Functional",kI(XB);class YB extends KB{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=null!=e.name?e.name:$P("sequential_"),null!=e.layers)for(const t of e.layers)this.add(t)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(e=>e<0))throw new SP("Negative dimension size caused by adding layer "+"".concat(e.name," with input shape [")+"".concat(e.inboundNodes[0].inputTensors[0].shape,"]"))}add(e){const t=e instanceof YB||e instanceof KB;let n;if(t){if(n=e,1!==n.outputs.length)throw new SP("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==n.inputs.length)throw new SP("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===e.inboundNodes.length){if(null==e.batchInputShape)throw new SP("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const t=function(e){if(null==e.batchShape&&null==e.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=e.batchShape&&null!=e.shape)throw new SP("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=e.batchShape;null!=e.shape&&null==t&&(t=[null].concat(e.shape));let n=e.dtype;return null==n&&(n="float32"),new xj({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(t)}if(t)this.outputs=n.outputs,this.inputs=n.inputs;else{if(1!==e.inboundNodes.length)throw new SP("A layer added to a Sequential model must not already be "+"connected somewhere else. LayersModel received layer ".concat(e.name," ")+"which has ".concat(e.inboundNodes.length," pre-existing inbound ")+"connections.");if(1!==e.inboundNodes[0].outputTensors.length)throw new SP("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=bj(this.outputs[0])}this.inboundNodes=[],new gj({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:IP(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(e=>e.shape),outputShapes:this.outputs[0].shape})}else{const t=e.apply(this.outputs[0]);if(Array.isArray(t))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[t],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,t){return null==this.model&&this.build(),this.model.call(e,t)}build(e){if(oj(e),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new KB({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;this.built||this.build(),super.summary(e,t,n)}setWeights(e){null==this.model&&this.build(),this.model.setWeights(e)}evaluate(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new NP("The model needs to be compiled before being used.");return this.model.evaluate(e,t,n)}async evaluateDataset(e,t){if(!this.built)throw new NP("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,t)}predict(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==this.model&&this.build(),this.model.predict(e,t)}predictOnBatch(e){return null==this.model&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return null==this.model?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new NP("The model needs to be compiled before being used.");return this.model.fit(e,t,n)}async fitDataset(e,t){if(!this.built)throw new NP("The model needs to be compiled before being used.");return this.model.fitDataset(e,t)}async trainOnBatch(e,t){return this.model.trainOnBatch(e,t)}static fromConfig(e,t){let n,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a={};if(t instanceof Array){if(null==t[0].className||"Merge"===t[0].className)throw new SP("Legacy serialization format not supported yet.");n=t}else Kw(null!=t.layers,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),n=t.layers,delete t.layers,a=t;const i=new e(a);if(!(i instanceof YB))throw new CP("Sequential.fromConfig called on non-Sequential input: ".concat(i));for(const o of n){const e=Xj(o,void 0,r);r&&e.setFastWeightInitDuringBuild(!0),i.add(e)}return i}set stopTraining(e){if(null==this.model)throw new SP("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(null==this.model)throw new SP("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const t of this.layers){const n={};n.className=t.getClassName(),n.config=t.getConfig(),e.push(n)}return{name:this.name,layers:e}}}YB.className="Sequential",kI(YB);class $B extends yI{getConfig(){return{}}}class JB extends $B{apply(e){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(1!==t)throw new CP("Support for alpha values other than 1 (".concat(t,") is not implemented ")+"yet.");return eA(e)}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)}}JB.className="elu",kI(JB);class QB extends $B{apply(e){return $A(e)}}QB.className="selu",kI(QB);class ZB extends $B{apply(e){return XA(e)}}ZB.className="relu",kI(ZB);class ez extends $B{apply(e){return b_(()=>DA(6,XA(e)))}}ez.className="relu6",kI(ez);class tz extends $B{apply(e){return e}}tz.className="linear",kI(tz);class nz extends $B{apply(e){return QA(e)}}nz.className="sigmoid",kI(nz);class rz extends $B{apply(e){return function(e){return b_(()=>{const t=cI(.5,dI(.2,e));return BT(t,0,1)})}(e)}}rz.className="hardSigmoid",kI(rz);class az extends $B{apply(e){return iR(e)}}az.className="softplus",kI(az);class iz extends $B{apply(e){return function(e){return b_(()=>hI(e,cI(AI(e),1)))}(e)}}iz.className="softsign",kI(iz);class oz extends $B{apply(e){return cR(e)}}oz.className="tanh",kI(oz);class sz extends $B{apply(e){return aR(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1)}}sz.className="softmax",kI(sz);class lz extends $B{apply(e){return mA(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1)}}lz.className="logSoftmax",kI(lz);class cz extends $B{apply(e){return b_(()=>b_(()=>{const t=Math.sqrt(2),n=dI(.5,cI(1,nA(hI(e,t))));return dI(e,n)}))}}cz.className="gelu",kI(cz);class uz extends $B{apply(e){return b_(()=>dI(.5,dI(e,cI(1,cR(dI(fI(hI(2,Math.PI)),cI(e,dI(.044715,_I(e,3)))))))))}}uz.className="gelu_new",kI(uz);class hz extends $B{apply(e){return b_(()=>dI(e,cR(iR(e))))}}hz.className="mish",kI(hz);class dz extends $B{apply(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return b_(()=>dI(QA(dI(e,t)),e))}}function fz(e){return e.getClassName()}function pz(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jP(e,wI.getMap().classNameMap,t,"activation")}function gz(e){if(null==e){const e={className:"linear",config:{}};return pz(e)}if("string"===typeof e){const t={};return t.className=e,t.config={},pz(t)}return e instanceof $B?e:pz(e)}function mz(e){if(null!=e&&"object"!==typeof e)throw new Error("Argument to L1L2 regularizer's constructor is expected to be an "+"object, but received: ".concat(e))}dz.className="swish",kI(dz);class vz extends yI{}class bz extends vz{constructor(e){super(),mz(e),this.l1=null==e||null==e.l1?.01:e.l1,this.l2=null==e||null==e.l2?.01:e.l2,this.hasL1=0!==this.l1,this.hasL2=0!==this.l2}apply(e){return b_(()=>{let t=MA([1]);return this.hasL1&&(t=cI(t,gA(dI(this.l1,AI(e))))),this.hasL2&&(t=cI(t,gA(dI(this.l2,AM(e))))),RT(t,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,t){return new e({l1:t.l1,l2:t.l2})}}bz.className="L1L2",kI(bz);const xz={l1l2:"L1L2"};function yz(e){return PP(e)}function wz(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return jP(e,wI.getMap().classNameMap,t,"regularizer")}function kz(e){if(null==e)return null;if("string"===typeof e){return wz({className:e in xz?xz[e]:e,config:{}})}return e instanceof vz?e:wz(e)}class Nz extends vj{constructor(e){super(null==e?{}:e),this.supportsMasking=!0,null!=e&&(this.maxValue=e.maxValue)}call(e,t){e=ij(e);let n=XA(e);return null!=this.maxValue&&(n=BT(n,0,this.maxValue)),n}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},t=super.getConfig();return Object.assign(e,t),e}}Nz.className="ReLU",kI(Nz);class Sz extends vj{constructor(e){super(null==e?{}:e),this.DEFAULT_ALPHA=.3,null==e&&(e={}),this.alpha=null==e.alpha?this.DEFAULT_ALPHA:e.alpha}call(e,t){const n=ij(e);return hA(n,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}}Sz.className="LeakyReLU",kI(Sz);class Cz extends vj{constructor(e){if(super(null==e?{}:e),this.DEFAULT_ALPHA_INITIALIZER="zeros",null==e&&(e={}),this.supportsMasking=!0,this.alphaInitializer=nj(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=kz(e.alphaRegularizer),this.alphaConstraint=Pj(e.alphaConstraint),null==e.sharedAxes)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else{if("number"!==typeof e.sharedAxes)throw new SP("Expected sharedAxes to be a number or an array of numbers, "+"but got ".concat(e.sharedAxes));this.sharedAxes=[e.sharedAxes]}}build(e){const t=(e=oj(e)).slice(1);if(null!=this.sharedAxes)for(const r of this.sharedAxes)t[r-1]=1;this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const n={};if(null!=this.sharedAxes)for(let r=1;r<e.length;++r)n[r]=e[r];this.inputSpec=[new dj({ndim:e.length,axes:n})],this.built=!0}call(e,t){return e=ij(e),WA(e,this.alpha.read())}getConfig(){const e={alphaInitializer:tj(this.alphaInitializer),alphaRegularizer:yz(this.alphaRegularizer),alphaConstraint:Oj(this.alphaConstraint),sharedAxes:this.sharedAxes},t=super.getConfig();return Object.assign(e,t),e}}Cz.className="PReLU",kI(Cz);class Ez extends vj{constructor(e){if(super(null==e?{}:e),this.DEFAULT_ALPHA=1,null==e&&(e={}),null!=e.alpha&&e.alpha!==this.DEFAULT_ALPHA)throw new CP("Non-default alpha value (".concat(e.alpha,") is not supported by the ")+"ELU layer yet.");this.alpha=null==e.alpha?this.DEFAULT_ALPHA:e.alpha}call(e,t){const n=ij(e);return eA(n)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}}Ez.className="ELU",kI(Ez);class _z extends vj{constructor(e){super(null==e?{}:e),this.DEFAULT_THETA=1,null==e&&(e={}),this.theta=null==e.theta?this.DEFAULT_THETA:e.theta}call(e,t){const n=ij(e);return dI(n,oI(cA(n,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},t=super.getConfig();return Object.assign(e,t),e}}_z.className="ThresholdedReLU",kI(_z);class Iz extends vj{constructor(e){super(null==e?{}:e),this.DEFAULT_AXIS=1,null==e&&(e={}),this.softmax=(new sz).apply,this.axis=null==e.axis?this.DEFAULT_AXIS:e.axis}call(e,t){return b_(()=>{let n=ij(e);const r=t.mask;if(null!=r){const e=dI(II(jA(n.shape),oI(r,n.dtype)),vI(-1e9));n=cI(n,e)}return this.axis instanceof Array?this.axis.length>1?rA(II(n,CA(n,this.axis,!0))):this.softmax(n,this.axis[0]):this.softmax(n,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}function Tz(e,t,n){if("number"===typeof e)return IP(e,t);if(e.length!==t)throw new SP("The ".concat(n," argument must be an integer or tuple of ").concat(t," integers.")+" Received: ".concat(e.length," elements."));for(let r=0;r<t;++r){const a=e[r];if(!dM(a))throw new SP("The ".concat(n," argument must be an integer or tuple of ").concat(t)+" integers. Received: ".concat(JSON.stringify(e)," including a")+" non-integer number ".concat(a))}return e}function Az(e,t,n,r){if(null==e)return e;let a;return a="same"===n?e:e-(t+(t-1)*((arguments.length>4&&void 0!==arguments[4]?arguments[4]:1)-1))+1,Math.floor((a+r-1)/r)}function Rz(e,t,n,r){if(null==e)return null;if("valid"===r)e=e*t+gM([n-t,0]);else{if("same"!==r)throw new SP("Unsupport padding mode: ".concat(r,"."));e*=t}return e}function Dz(e,t){return b_(()=>(rM(t),"channelsFirst"===t?vR(e,[0,2,3,1]):e))}function Fz(e,t){return b_(()=>(rM(t),"channelsFirst"===t?vR(e,[0,2,3,4,1]):e))}function Oz(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return b_(()=>{if(null==i&&(i="channelsLast"),rM(i),3!==e.shape.length)throw new SP("The input of a conv1dWithBias operation should be 3, but is "+"".concat(e.shape.length," instead."));if(3!==t.shape.length)throw new SP("The kernel for a conv1dWithBias operation should be 3, but is "+"".concat(t.shape.length," instead"));if(null!=n&&1!==n.shape.length)throw new SP("The bias for a conv1dWithBias operation should be 1, but is "+"".concat(n.shape.length," instead"));if("channelsFirst"===i&&(e=vR(e,[0,2,1])),"causal"===a)throw new CP("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let s=qT(e,t,r,"same"===a?"same":"valid","NWC",o);return null!=n&&(s=DM(s,n)),s})}function Lz(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;return b_(()=>{if(null==i&&(i="channelsLast"),rM(i),3!==e.rank&&4!==e.rank)throw new SP("conv2dWithBiasActivation expects input to be of rank 3 or 4, "+"but received ".concat(e.rank,"."));if(3!==t.rank&&4!==t.rank)throw new SP("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, "+"but received ".concat(e.rank,"."));let l=Dz(e,i);if("causal"===a)throw new CP("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=AR({x:l,filter:t,strides:r,pad:"same"===a?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:s}),"channelsFirst"===i&&(l=vR(l,[0,3,1,2])),l})}function Pz(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0;return b_(()=>{if(null==i&&(i="channelsLast"),rM(i),4!==e.rank&&5!==e.rank)throw new SP("conv3dWithBias expects input to be of rank 4 or 5, but received "+"".concat(e.rank,"."));if(4!==t.rank&&5!==t.rank)throw new SP("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+"".concat(e.rank,"."));let s=Fz(e,i);if("causal"===a)throw new CP("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return s=YT(s,t,r,"same"===a?"same":"valid","NDHWC",o),null!=n&&(s=DM(s,n)),"channelsFirst"===i&&(s=vR(s,[0,4,1,2,3])),s})}Iz.className="Softmax",kI(Iz);class Mz extends vj{constructor(e,t){if(super(t),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",Mz.verifyArgs(t),this.rank=e,HP(this.rank,"rank"),1!==this.rank&&2!==this.rank&&3!==this.rank)throw new CP("Convolution layer for rank other than 1, 2, or 3 (".concat(this.rank,") is ")+"not implemented yet.");if(this.kernelSize=Tz(t.kernelSize,e,"kernelSize"),this.strides=Tz(null==t.strides?1:t.strides,e,"strides"),this.padding=null==t.padding?"valid":t.padding,aM(this.padding),this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,rM(this.dataFormat),this.activation=gz(t.activation),this.useBias=null==t.useBias||t.useBias,this.biasInitializer=nj(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=Pj(t.biasConstraint),this.biasRegularizer=kz(t.biasRegularizer),this.activityRegularizer=kz(t.activityRegularizer),this.dilationRate=Tz(null==t.dilationRate?1:t.dilationRate,e,"dilationRate"),1===this.rank&&Array.isArray(this.dilationRate)&&1!==this.dilationRate.length)throw new SP("dilationRate must be a number or an array of a single number for 1D convolution, but received "+"".concat(JSON.stringify(this.dilationRate)));if(2===this.rank){if("number"===typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate];else if(2!==this.dilationRate.length)throw new SP("dilationRate must be a number or array of two numbers for 2D "+"convolution, but received ".concat(JSON.stringify(this.dilationRate)))}else if(3===this.rank)if("number"===typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(3!==this.dilationRate.length)throw new SP("dilationRate must be a number or array of three numbers for 3D "+"convolution, but received ".concat(JSON.stringify(this.dilationRate)))}static verifyArgs(e){if(TP("kernelSize"in e,"required key 'kernelSize' not in config"),"number"!==typeof e.kernelSize&&!VP(e.kernelSize,"number",1,3))throw new SP("BaseConv expects config.kernelSize to be number or number[] with "+"length 1, 2, or 3, but received ".concat(JSON.stringify(e.kernelSize),"."))}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:fz(this.activation),useBias:this.useBias,biasInitializer:tj(this.biasInitializer),biasRegularizer:yz(this.biasRegularizer),activityRegularizer:yz(this.activityRegularizer),biasConstraint:Oj(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}class jz extends Mz{constructor(e,t){super(e,t),this.kernel=null,jz.verifyArgs(t),this.filters=t.filters,HP(this.filters,"filters"),this.kernelInitializer=nj(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=Pj(t.kernelConstraint),this.kernelRegularizer=kz(t.kernelRegularizer)}build(e){e=oj(e);const t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new SP("The channel dimension of the input should be defined. "+"Found ".concat(e[t]));const n=e[t],r=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[t]:n}}],this.built=!0}call(e,t){return b_(()=>{let t;e=ij(e);const n=null==this.bias?null:this.bias.read(),r=qP(this.activation.getClassName());if(null!=r&&2===this.rank)t=Lz(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate,r);else{if(1===this.rank)t=Oz(e,this.kernel.read(),n,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(2===this.rank)t=Lz(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate);else{if(3!==this.rank)throw new CP("convolutions greater than 3D are not implemented yet.");t=Pz(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate)}null!=this.activation&&(t=this.activation.apply(t))}return t})}computeOutputShape(e){e=oj(e);const t=[],n="channelsLast"===this.dataFormat?e.slice(1,e.length-1):e.slice(2);for(let a=0;a<n.length;++a){const e=Az(n[a],this.kernelSize[a],this.padding,this.strides[a],"number"===typeof this.dilationRate?this.dilationRate:this.dilationRate[a]);t.push(e)}let r=[e[0]];return"channelsLast"===this.dataFormat?(r=r.concat(t),r.push(this.filters)):(r.push(this.filters),r=r.concat(t)),r}getConfig(){const e={filters:this.filters,kernelInitializer:tj(this.kernelInitializer),kernelRegularizer:yz(this.kernelRegularizer),kernelConstraint:Oj(this.kernelConstraint)},t=super.getConfig();return Object.assign(e,t),e}static verifyArgs(e){if(!("filters"in e)||"number"!==typeof e.filters||e.filters<1)throw new SP("Convolution layer expected config.filters to be a 'number' > 0 "+"but got ".concat(JSON.stringify(e.filters)))}}class Bz extends jz{constructor(e){super(2,e),Bz.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if("number"!==typeof e.kernelSize&&!VP(e.kernelSize,"number",1,2))throw new SP("Conv2D expects config.kernelSize to be number or number[] with "+"length 1 or 2, but received ".concat(JSON.stringify(e.kernelSize),"."))}}Bz.className="Conv2D",kI(Bz);class zz extends jz{constructor(e){super(3,e),zz.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if("number"!==typeof e.kernelSize&&(!Array.isArray(e.kernelSize)||1!==e.kernelSize.length&&3!==e.kernelSize.length))throw new SP("Conv3D expects config.kernelSize to be number or"+" [number, number, number], but received ".concat(JSON.stringify(e.kernelSize),"."))}}zz.className="Conv3D",kI(zz);class Wz extends Bz{constructor(e){if(super(e),this.inputSpec=[new dj({ndim:4})],"same"!==this.padding&&"valid"!==this.padding)throw new SP("Conv2DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(this.padding))}build(e){if(4!==(e=oj(e)).length)throw new SP("Input should have rank 4; Received input shape: "+JSON.stringify(e));const t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new SP("The channel dimension of the inputs should be defined. Found `None`.");const n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new dj({ndim:4,axes:{[t]:n}})],this.built=!0}call(e,t){return b_(()=>{let t=ij(e);if(4!==t.shape.length)throw new SP("Conv2DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(t.shape.length));const n=t.shape,r=n[0];let a,i;"channelsFirst"===this.dataFormat?(a=2,i=3):(a=1,i=2);const o=n[a],s=n[i],l=this.kernelSize[0],c=this.kernelSize[1],u=this.strides[0],h=this.strides[1],d=[r,Rz(o,u,l,this.padding),Rz(s,h,c,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(t=vR(t,[0,2,3,1]));let f=XT(t,this.kernel.read(),d,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(f=vR(f,[0,3,1,2])),null!=this.bias&&(f=DM(f,this.bias.read(),this.dataFormat)),null!=this.activation&&(f=this.activation.apply(f)),f})}computeOutputShape(e){const t=(e=oj(e)).slice();let n,r,a;"channelsFirst"===this.dataFormat?(n=1,r=2,a=3):(n=3,r=1,a=2);const i=this.kernelSize[0],o=this.kernelSize[1],s=this.strides[0],l=this.strides[1];return t[n]=this.filters,t[r]=Rz(t[r],s,i,this.padding),t[a]=Rz(t[a],l,o,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}Wz.className="Conv2DTranspose",kI(Wz);class Uz extends zz{constructor(e){if(super(e),this.inputSpec=[new dj({ndim:5})],"same"!==this.padding&&"valid"!==this.padding)throw new SP("Conv3DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(this.padding))}build(e){if(5!==(e=oj(e)).length)throw new SP("Input should have rank 5; Received input shape: "+JSON.stringify(e));const t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new SP("The channel dimension of the inputs should be defined. Found `None`.");const n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new dj({ndim:5,axes:{[t]:n}})],this.built=!0}call(e,t){return b_(()=>{let t=ij(e);if(5!==t.shape.length)throw new SP("Conv3DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(t.shape.length));const n=t.shape,r=n[0];let a,i,o;"channelsFirst"===this.dataFormat?(o=2,a=3,i=4):(o=1,a=2,i=3);const s=n[o],l=n[a],c=n[i],u=this.kernelSize[0],h=this.kernelSize[1],d=this.kernelSize[2],f=this.strides[0],p=this.strides[1],g=this.strides[2],m=[r,Rz(s,f,u,this.padding),Rz(l,p,h,this.padding),Rz(c,g,d,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(t=vR(t,[0,2,3,4,1]));let v=JT(t,this.kernel.read(),m,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(v=vR(v,[0,4,1,2,3])),null!==this.bias&&(v=DM(v,this.bias.read(),this.dataFormat)),null!==this.activation&&(v=this.activation.apply(v)),v})}computeOutputShape(e){const t=(e=oj(e)).slice();let n,r,a,i;"channelsFirst"===this.dataFormat?(n=1,r=2,a=3,i=4):(n=4,r=1,a=2,i=3);const o=this.kernelSize[0],s=this.kernelSize[1],l=this.kernelSize[2],c=this.strides[0],u=this.strides[1],h=this.strides[2];return t[n]=this.filters,t[r]=Rz(t[r],c,o,this.padding),t[a]=Rz(t[a],u,s,this.padding),t[i]=Rz(t[i],h,l,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}Uz.className="Conv3DTranspose",kI(Uz);class Vz extends jz{constructor(e,t){if(super(e,t),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,null==t.filters)throw new SP("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=t.kernelInitializer||null!=t.kernelRegularizer||null!=t.kernelConstraint)throw new SP("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=t.padding&&"same"!==t.padding&&"valid"!==t.padding)throw new SP("SeparableConv".concat(this.rank,"D supports only padding modes: ")+"'same' and 'valid', but received ".concat(JSON.stringify(t.padding)));this.depthMultiplier=null==t.depthMultiplier?1:t.depthMultiplier,this.depthwiseInitializer=nj(t.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=kz(t.depthwiseRegularizer),this.depthwiseConstraint=Pj(t.depthwiseConstraint),this.pointwiseInitializer=nj(t.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=kz(t.pointwiseRegularizer),this.pointwiseConstraint=Pj(t.pointwiseConstraint)}build(e){if((e=oj(e)).length<this.rank+2)throw new SP("Inputs to SeparableConv".concat(this.rank,"D should have rank ")+"".concat(this.rank+2,", but received input shape: ")+"".concat(JSON.stringify(e)));const t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t]||e[t]<0)throw new SP("The channel dimension of the inputs should be defined, "+"but found ".concat(JSON.stringify(e[t])));const n=e[t],r=this.kernelSize.concat([n,this.depthMultiplier]),a=[];for(let o=0;o<this.rank;++o)a.push(1);a.push(n*this.depthMultiplier,this.filters);const i=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,i,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",a,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,i,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,i,this.biasConstraint):this.bias=null,this.inputSpec=[new dj({ndim:this.rank+2,axes:{[t]:n}})],this.built=!0}call(e,t){return b_(()=>{let t;if(e=ij(e),1===this.rank)throw new CP("1D separable convolution is not implemented yet.");return 2===this.rank&&("channelsFirst"===this.dataFormat&&(e=vR(e,[0,2,3,1])),t=JA(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(t=DM(t,this.bias.read(),this.dataFormat)),null!=this.activation&&(t=this.activation.apply(t)),"channelsFirst"===this.dataFormat&&(t=vR(t,[0,3,1,2])),t})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=tj(this.depthwiseInitializer),e.pointwiseInitializer=tj(this.pointwiseInitializer),e.depthwiseRegularizer=yz(this.depthwiseRegularizer),e.pointwiseRegularizer=yz(this.pointwiseRegularizer),e.depthwiseConstraint=Oj(this.depthwiseConstraint),e.pointwiseConstraint=Oj(this.pointwiseConstraint),e}}Vz.className="SeparableConv";class Hz extends Vz{constructor(e){super(2,e)}}Hz.className="SeparableConv2D",kI(Hz);class Gz extends jz{constructor(e){super(1,e),Gz.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if("number"!==typeof e.kernelSize&&!VP(e.kernelSize,"number",1,1))throw new SP("Conv1D expects config.kernelSize to be number or number[] with "+"length 1, but received ".concat(JSON.stringify(e.kernelSize),"."))}}Gz.className="Conv1D",kI(Gz);class qz extends vj{constructor(e){super(e),"number"===typeof e.cropping?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:"number"===typeof e.cropping[0]?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=void 0===e.dataFormat?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return"channelsFirst"===this.dataFormat?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,t){return b_(()=>{if(e=ij(e),"channelsLast"===this.dataFormat){const t=NM(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return NM(t,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}{const t=NM(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return NM(t,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}qz.className="Cropping2D",kI(qz);class Kz extends vj{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=null==e.size?this.DEFAULT_SIZE:e.size,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,rM(this.dataFormat),this.interpolation=null==e.interpolation?"nearest":e.interpolation,function(e){UP(QP,"InterpolationFormat",e)}(this.interpolation)}computeOutputShape(e){if("channelsFirst"===this.dataFormat){const t=null==e[2]?null:this.size[0]*e[2],n=null==e[3]?null:this.size[1]*e[3];return[e[0],e[1],t,n]}{const t=null==e[1]?null:this.size[0]*e[1],n=null==e[2]?null:this.size[1]*e[2];return[e[0],t,n,e[3]]}}call(e,t){return b_(()=>{let t=ij(e);const n=t.shape;if("channelsFirst"===this.dataFormat){t=vR(t,[0,2,3,1]);const e=this.size[0]*n[2],r=this.size[1]*n[3],a="nearest"===this.interpolation?bD.resizeNearestNeighbor(t,[e,r]):bD.resizeBilinear(t,[e,r]);return vR(a,[0,3,1,2])}{const e=this.size[0]*n[1],r=this.size[1]*n[2];return"nearest"===this.interpolation?bD.resizeNearestNeighbor(t,[e,r]):bD.resizeBilinear(t,[e,r])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}}Kz.className="UpSampling2D",kI(Kz);class Xz extends Mz{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,this.depthwiseInitializer=nj(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=Pj(e.depthwiseConstraint),this.depthwiseRegularizer=kz(e.depthwiseRegularizer)}build(e){if((e=oj(e)).length<4)throw new SP("Inputs to DepthwiseConv2D should have rank 4. "+"Received input shape: ".concat(JSON.stringify(e),"."));const t="channelsFirst"===this.dataFormat?1:3;if(null==e[t]||e[t]<0)throw new SP("The channel dimension of the inputs to DepthwiseConv2D should "+"be defined, but is not (".concat(e[t],")."));const n=e[t],r=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return b_(()=>{let t=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"valid",a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0;return b_(()=>{null==a&&(a="channelsLast"),rM(a);let o=Dz(e,a);if(4!==e.rank)throw new SP("Input for depthwiseConv2d is required to be 4-D, but is instead "+"".concat(e.rank,"-D"));if(4!==t.rank)throw new SP("depthwiseKernel is required to be 4-D, but is instead "+"".concat(t.rank,"-D"));return o=ZT(o,t,n,"same"===r?"same":"valid","NHWC",i),"channelsFirst"===a&&(o=vR(o,[0,3,1,2])),o})}(e=ij(e),this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(t=DM(t,this.bias.read(),this.dataFormat)),null!=this.activation&&(t=this.activation.apply(t)),t})}computeOutputShape(e){e=oj(e);const t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,a=Az(t,this.kernelSize[0],this.padding,this.strides[0]),i=Az(n,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[e[0],r,a,i]:[e[0],a,i,r]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=tj(this.depthwiseInitializer),e.depthwiseRegularizer=yz(this.depthwiseRegularizer),e.depthwiseConstraint=Oj(this.depthwiseRegularizer),e}}function Yz(e,t,n,r){if(Array.isArray(e)){if(null!=t||null!=n)throw new SP("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function a(e){return null==e||Array.isArray(e)?e:[e]}return{inputs:e,initialState:t=a(t),constants:n=a(n)}}function $z(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return b_(()=>{const l=t.shape.length;if(l<3)throw new SP("Input should be at least 3D, but is ".concat(l,"D."));const c=[1,0].concat(mM(2,l));if(t=vR(t,c),null!=i)throw new CP("The rnn() functoin of the deeplearn.js backend does not support constants yet.");o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=a&&(a=oI(oI(a,"bool"),"float32"),a.rank===l-1&&(a=aA(a,-1)),a=vR(a,c)),r&&(t=YA(t,0),null!=a&&(a=YA(a,0)));const u=[];let h,d=n;const f=t.shape[0],p=fR(t);let g,m;null!=a&&(g=fR(a));for(let t=0;t<f;++t){const n=p[t],r=b_(()=>e(n,d));if(null==a)h=r[0],d=r[1];else{const e=b_(()=>{const e=g[t],n=II(BA(e),e),a=cI(dI(r[0],e),dI(d[0],n)),i=d.map((t,a)=>cI(dI(r[1][a],e),dI(t,n)));return{output:a,newStates:i}});h=e.output,d=e.newStates}s&&u.push(h)}if(s){m=lR(u,1)}return[h,m,d]})}Xz.className="DepthwiseConv2D",kI(Xz);class Jz extends vj{constructor(e){let t;if(super(e),null==e.cell)throw new SP("cell property is missing for the constructor of RNN.");if(t=Array.isArray(e.cell)?new iW({cells:e.cell}):e.cell,null==t.stateSize)throw new SP("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=t,this.returnSequences=null!=e.returnSequences&&e.returnSequences,this.returnState=null!=e.returnState&&e.returnState,this.goBackwards=null!=e.goBackwards&&e.goBackwards,this._stateful=null!=e.stateful&&e.stateful,this.unroll=null!=e.unroll&&e.unroll,this.supportsMasking=!0,this.inputSpec=[new dj({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(null==this.states_){return mM(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map(e=>null)}return this.states_}setStates(e){this.states_=e}computeOutputShape(e){rj(e)&&(e=e[0]);let t=this.cell.stateSize;Array.isArray(t)||(t=[t]);const n=t[0];let r;if(r=this.returnSequences?[e[0],e[1],n]:[e[0],n],this.returnState){const n=[];for(const r of t)n.push([e[0],r]);return[r].concat(n)}return r}computeMask(e,t){return b_(()=>{Array.isArray(t)&&(t=t[0]);const e=this.returnSequences?t:null;if(this.returnState){const t=this.states.map(e=>null);return[e].concat(t)}return e})}get states(){if(null==this.states_){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[];for(let n=0;n<e;++n)t.push(null);return t}return this.states_}set states(e){this.states_=e}build(e){if(null!=this.numConstants)throw new CP("Constants support is not implemented in RNN yet.");rj(e)&&(e=e[0]);const t=this.stateful?e[0]:null,n=e.slice(2);this.inputSpec[0]=new dj({shape:[t,null,...n]});const r=[e[0]].concat(e.slice(2));let a;if(this.cell.build(r),a=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!Jw(this.stateSpec.map(e=>e.shape[e.shape.length-1]),a))throw new SP("An initialState was passed that is not compatible with "+"cell.stateSize. Received stateSpec=".concat(this.stateSpec,"; ")+"However cell.stateSize is ".concat(this.cell.stateSize))}else this.stateSpec=a.map(e=>new dj({shape:[null,e]}));this.stateful&&this.resetStates()}resetStates(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];b_(()=>{if(!this.stateful)throw new kP("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape[0];if(null==n)throw new SP("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.states_)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(e=>MA([n,e])):this.states_=[MA([n,this.cell.stateSize])];else if(null==e)x_(this.states_),null!=this.keptStates&&(x_(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(e=>MA([n,e])):this.states_[0]=MA([n,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new SP("Layer ".concat(this.name," expects ").concat(this.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));!0===t?this.keptStates.push(this.states_.slice()):x_(this.states_);for(let t=0;t<this.states_.length;++t){const r=e[t],a=Array.isArray(this.cell.stateSize)?this.cell.stateSize[t]:this.cell.stateSize,i=[n,a];if(!Jw(r.shape,i))throw new SP("State ".concat(t," is incompatible with layer ").concat(this.name,": ")+"expected shape=".concat(i,", received shape=").concat(r.shape));this.states_[t]=r}}this.states_=this.states_.map(e=>y_(e.clone()))})}apply(e,t){let n=null==t?null:t.initialState,r=null==t?null:t.constants;null==t&&(t={});const a=Yz(e,n,r,this.numConstants);e=a.inputs,n=a.initialState,r=a.constants;let i=[],o=[];if(null!=n){t.initialState=n,i=i.concat(n),this.stateSpec=[];for(const e of n)this.stateSpec.push(new dj({shape:e.shape}));o=o.concat(this.stateSpec)}null!=r&&(t.constants=r,i=i.concat(r),this.numConstants=r.length);if(i[0]instanceof fj){const n=[e].concat(i),r=this.inputSpec.concat(o),a=this.inputSpec;this.inputSpec=r;const s=super.apply(n,t);return this.inputSpec=a,s}return super.apply(e,t)}call(e,t){return b_(()=>{const n=null==t?null:t.mask,r=null==t?null:t.training;let a=null==t?null:t.initialState;e=ij(e),null==a&&(a=this.stateful?this.states_:this.getInitialState(e));const i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(a.length!==i)throw new SP("RNN Layer has ".concat(i," state(s) but was passed ")+"".concat(a.length," initial state(s)."));this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const o={training:r},s=$z((e,t)=>{const n=this.cell.call([e].concat(t),o);return[n[0],n.slice(1)]},e,a,this.goBackwards,n,null,this.unroll,this.returnSequences),l=s[0],c=s[1],u=s[2];this.stateful&&this.resetStates(u,r);const h=this.returnSequences?c:l;return this.returnState?[h].concat(u):h})}getInitialState(e){return b_(()=>{let t=MA(e.shape);return t=gA(t,[1,2]),t=yM(t),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(e=>e>1?EM(t,[1,e]):t):this.cell.stateSize>1?[EM(t,[1,this.cell.stateSize])]:[t]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(t.numConstants=this.numConstants);const n=this.cell.getConfig();return this.getClassName()===Jz.className&&(t.cell={className:this.cell.getClassName(),config:n}),Object.assign(Object.assign(Object.assign({},n),e),t)}static fromConfig(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=Xj(t.cell,n);return new e(Object.assign(t,{cell:r}))}}Jz.className="RNN",kI(Jz);class Qz extends vj{}class Zz extends Qz{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,HP(this.units,"units"),this.activation=gz(null==e.activation?this.DEFAULT_ACTIVATION:e.activation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=nj(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=nj(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=nj(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=kz(e.kernelRegularizer),this.recurrentRegularizer=kz(e.recurrentRegularizer),this.biasRegularizer=kz(e.biasRegularizer),this.kernelConstraint=Pj(e.kernelConstraint),this.recurrentConstraint=Pj(e.recurrentConstraint),this.biasConstraint=Pj(e.biasConstraint),this.dropout=pM([1,gM([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=pM([1,gM([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=oj(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return b_(()=>{if(2!==e.length)throw new SP("SimpleRNNCell expects 2 input Tensors, got ".concat(e.length,"."));let n=e[1];e=e[0];const r=null!=t.training&&t.training;let a;0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=oW({ones:()=>BA(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=oW({ones:()=>BA(n),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,o=this.recurrentDropoutMask;a=IM(null!=i?dI(e,i):e,this.kernel.read()),null!=this.bias&&(a=DM(a,this.bias.read())),null!=o&&(n=dI(n,o));let s=cI(a,IM(n,this.recurrentKernel.read()));return null!=this.activation&&(s=this.activation.apply(s)),[s,s]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:fz(this.activation),useBias:this.useBias,kernelInitializer:tj(this.kernelInitializer),recurrentInitializer:tj(this.recurrentInitializer),biasInitializer:tj(this.biasInitializer),kernelRegularizer:yz(this.kernelRegularizer),recurrentRegularizer:yz(this.recurrentRegularizer),biasRegularizer:yz(this.biasRegularizer),activityRegularizer:yz(this.activityRegularizer),kernelConstraint:Oj(this.kernelConstraint),recurrentConstraint:Oj(this.recurrentConstraint),biasConstraint:Oj(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}}Zz.className="SimpleRNNCell",kI(Zz);class eW extends Jz{constructor(e){e.cell=new Zz(e),super(e)}call(e,t){return b_(()=>{null!=this.cell.dropoutMask&&(x_(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(x_(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==t?null:t.mask,r=null==t?null:t.training,a=null==t?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:a})})}static fromConfig(e,t){return new e(t)}}eW.className="SimpleRNN",kI(eW);class tW extends Qz{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new SP("GRUCell does not support reset_after parameter set to true.");this.units=e.units,HP(this.units,"units"),this.activation=gz(void 0===e.activation?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=gz(void 0===e.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=nj(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=nj(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=nj(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=kz(e.kernelRegularizer),this.recurrentRegularizer=kz(e.recurrentRegularizer),this.biasRegularizer=kz(e.biasRegularizer),this.kernelConstraint=Pj(e.kernelConstraint),this.recurrentConstraint=Pj(e.recurrentConstraint),this.biasConstraint=Pj(e.biasConstraint),this.dropout=pM([1,gM([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=pM([1,gM([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){const t=(e=oj(e))[e.length-1];this.kernel=this.addWeight("kernel",[t,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return b_(()=>{if(2!==e.length)throw new SP("GRUCell expects 2 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));const n=null!=t.training&&t.training;let r=e[1];e=e[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=oW({ones:()=>BA(e),rate:this.dropout,training:n,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=oW({ones:()=>BA(r),rate:this.recurrentDropout,training:n,count:3,dropoutFunc:this.dropoutFunc}));const a=this.dropoutMask,i=this.recurrentDropoutMask;let o,s,l;0<this.dropout&&this.dropout<1&&(e=dI(e,a[0]));let c=IM(e,this.kernel.read());this.useBias&&(c=DM(c,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=dI(r,i[0]));const u=this.recurrentKernel.read(),[h,d]=oR(u,[2*this.units,this.units],u.rank-1),f=IM(r,h),[p,g,m]=oR(c,3,c.rank-1),[v,b]=oR(f,2,f.rank-1);o=this.recurrentActivation.apply(cI(p,v)),s=this.recurrentActivation.apply(cI(g,b));const x=IM(dI(s,r),d);l=this.activation.apply(cI(m,x));const y=cI(dI(o,r),dI(cI(1,OA(o)),l));return[y,y]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:fz(this.activation),recurrentActivation:fz(this.recurrentActivation),useBias:this.useBias,kernelInitializer:tj(this.kernelInitializer),recurrentInitializer:tj(this.recurrentInitializer),biasInitializer:tj(this.biasInitializer),kernelRegularizer:yz(this.kernelRegularizer),recurrentRegularizer:yz(this.recurrentRegularizer),biasRegularizer:yz(this.biasRegularizer),activityRegularizer:yz(this.activityRegularizer),kernelConstraint:Oj(this.kernelConstraint),recurrentConstraint:Oj(this.recurrentConstraint),biasConstraint:Oj(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}}tW.className="GRUCell",kI(tW);class nW extends Jz{constructor(e){0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new tW(e),super(e)}call(e,t){return b_(()=>{null!=this.cell.dropoutMask&&(x_(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(x_(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==t?null:t.mask,r=null==t?null:t.training,a=null==t?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:a})})}static fromConfig(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}nW.className="GRU",kI(nW);class rW extends Qz{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,HP(this.units,"units"),this.activation=gz(void 0===e.activation?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=gz(void 0===e.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=nj(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=nj(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=nj(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=kz(e.kernelRegularizer),this.recurrentRegularizer=kz(e.recurrentRegularizer),this.biasRegularizer=kz(e.biasRegularizer),this.kernelConstraint=Pj(e.kernelConstraint),this.recurrentConstraint=Pj(e.recurrentConstraint),this.biasConstraint=Pj(e.biasConstraint),this.dropout=pM([1,gM([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=pM([1,gM([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var t;const n=(e=oj(e))[e.length-1];let r;if(this.kernel=this.addWeight("kernel",[n,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){const e=this.biasInitializer,n=this.units;r=new((t=class extends MM{apply(t,r){const a=e.apply([n]),i=(new BM).apply([n]),o=e.apply([2*n]);return CM(CM(a,i),o)}}).className="CustomInit",t)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,t){return b_(()=>{const n=null!=t.training&&t.training;if(3!==e.length)throw new SP("LSTMCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));let r=e[1];const a=e[2];e=e[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=oW({ones:()=>BA(e),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=oW({ones:()=>BA(r),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,o=this.recurrentDropoutMask;let s,l,c,u;0<this.dropout&&this.dropout<1&&(e=dI(e,i[0]));let h=IM(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=dI(r,o[0])),h=cI(h,IM(r,this.recurrentKernel.read())),this.useBias&&(h=DM(h,this.bias.read()));const[d,f,p,g]=oR(h,4,h.rank-1);s=this.recurrentActivation.apply(d),l=this.recurrentActivation.apply(f),c=cI(dI(l,a),dI(s,this.activation.apply(p))),u=this.recurrentActivation.apply(g);const m=dI(u,this.activation.apply(c));return[m,m,c]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:fz(this.activation),recurrentActivation:fz(this.recurrentActivation),useBias:this.useBias,kernelInitializer:tj(this.kernelInitializer),recurrentInitializer:tj(this.recurrentInitializer),biasInitializer:tj(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:yz(this.kernelRegularizer),recurrentRegularizer:yz(this.recurrentRegularizer),biasRegularizer:yz(this.biasRegularizer),activityRegularizer:yz(this.activityRegularizer),kernelConstraint:Oj(this.kernelConstraint),recurrentConstraint:Oj(this.recurrentConstraint),biasConstraint:Oj(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}}rW.className="LSTMCell",kI(rW);class aW extends Jz{constructor(e){0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new rW(e),super(e)}call(e,t){return b_(()=>{null!=this.cell.dropoutMask&&(x_(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(x_(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==t?null:t.mask,r=null==t?null:t.training,a=null==t?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:a})})}static fromConfig(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}aW.className="LSTM",kI(aW);class iW extends Qz{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const t of this.cells.slice().reverse())Array.isArray(t.stateSize)?e.push(...t.stateSize):e.push(t.stateSize);return e}call(e,t){return b_(()=>{let n=e.slice(1);const r=[];for(const e of this.cells.slice().reverse())Array.isArray(e.stateSize)?r.push(n.splice(0,e.stateSize.length)):r.push(n.splice(0,1));r.reverse();const a=[];let i;for(let o=0;o<this.cells.length;++o){const s=this.cells[o];n=r[o],i=0===o?[e[0]].concat(n):[i[0]].concat(n),i=s.call(i,t),a.push(i.slice(1))}n=[];for(const e of a.slice().reverse())n.push(...e);return[i[0]].concat(n)})}build(e){let t;rj(e)&&(e=e[0]),this.cells.forEach((n,r)=>{sM("RNNCell_".concat(r),()=>{n.build(e),t=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,e=[e[0],t]})}),this.built=!0}getConfig(){const e=super.getConfig(),t={cells:this.cells.map(e=>({className:e.getClassName(),config:e.getConfig()}))};return Object.assign(Object.assign({},e),t)}static fromConfig(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=[];for(const a of t.cells)r.push(Xj(a,n));return new e({cells:r})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const t of this.cells)e.push(...t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.cells)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const e of this.cells)t.push(...e.trainableWeights);return t.concat(e)}return e}getWeights(){const e=[];for(const t of this.cells)e.push(...t.weights);return uj(e)}setWeights(e){const t=[];for(const n of this.cells){const r=n.weights.length,a=e.splice(r);for(let e=0;e<n.weights.length;++e)t.push([n.weights[e],a[e]])}hj(t)}}function oW(e){const{ones:t,rate:n,training:r=!1,count:a=1,dropoutFunc:i}=e,o=()=>null!=i?i(t(),n):FM(t(),n),s=()=>OM(o,t,r);if(!a||a<=1)return y_(s().clone());return Array(a).fill(void 0).map(s).map(e=>y_(e.clone()))}iW.className="StackedRNNCells",kI(iW);var sW=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};class lW extends Jz{constructor(e){if(e.unroll)throw new CP("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new CP("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new dj({ndim:5})]}call(e,t){return b_(()=>{if(null!=this.cell.dropoutMask&&(x_(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(x_(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),t&&t.constants)throw new SP("ConvRNN2D cell does not support constants");const n=null==t?null:t.mask,r=null==t?null:t.training,a=null==t?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:a})})}computeOutputShape(e){let t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0],...t.slice(2)]),this.returnState&&(t=[t,...Array(2).fill([e[0],...t.slice(-3)])]),t}getInitialState(e){return b_(()=>{const{stateSize:t}=this.cell,n=e.shape,r=this.computeSingleOutputShape(n),a=MA([r[0],...r.slice(2)]);return Array.isArray(t)?Array(t.length).fill(a):[a]})}resetStates(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];b_(()=>{if(!this.stateful)throw new kP("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape,r=this.computeSingleOutputShape(n),a=[r[0],...r.slice(2)];if(null==n[0])throw new SP("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.getStates())Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>MA(a)):this.states_=[MA(a)];else if(null==e)x_(this.states_),null!=this.keptStates&&(x_(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>MA(a)):this.states_[0]=MA(a);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new SP("Layer ".concat(this.name," expects ").concat(this.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));t?this.keptStates.push(this.states_.slice()):x_(this.states_);for(let t=0;t<this.states_.length;++t){const n=e[t],r=a;if(!Jw(n.shape,r))throw new SP("State ".concat(t," is incompatible with layer ").concat(this.name,": ")+"expected shape=".concat(r,", received shape=").concat(n.shape));this.states_[t]=n}}this.states_=this.states_.map(e=>y_(e.clone()))})}computeSingleOutputShape(e){const{dataFormat:t,filters:n,kernelSize:r,padding:a,strides:i,dilationRate:o}=this.cell,s="channelsFirst"===t,l=e[s?3:2],c=e[s?4:3],u=Az(l,r[0],a,i[0],o[0]),h=Az(c,r[1],a,i[1],o[1]);return[...e.slice(0,2),...s?[n,u,h]:[u,h,n]]}}lW.className="ConvRNN2D";class cW extends rW{constructor(e){const{filters:t,kernelSize:n,strides:r,padding:a,dataFormat:i,dilationRate:o}=e;super(Object.assign(Object.assign({},e),{units:t})),this.filters=t,HP(this.filters,"filters"),this.kernelSize=Tz(n,2,"kernelSize"),this.kernelSize.forEach(e=>HP(e,"kernelSize")),this.strides=Tz(r||1,2,"strides"),this.strides.forEach(e=>HP(e,"strides")),this.padding=a||"valid",aM(this.padding),this.dataFormat=i||"channelsLast",rM(this.dataFormat),this.dilationRate=Tz(o||1,2,"dilationRate"),this.dilationRate.forEach(e=>HP(e,"dilationRate"))}build(e){var t;e=oj(e);const n="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[n])throw new SP("The channel dimension of the input should be defined. "+"Found ".concat(e[n]));const r=e[n],a=this.kernelSize.concat([r,4*this.filters]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const i=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",i,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let e;if(this.unitForgetBias){const n=this.biasInitializer,r=this.filters;e=new((t=class extends MM{apply(e,t){return SM([n.apply([r]),jA([r]),n.apply([2*r])])}}).className="CustomInit",t)}else e=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,e,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,t){return b_(()=>{if(3!==e.length)throw new SP("ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));const n=t.training||!1,r=e[0],a=e[1],i=e[2];0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=oW({ones:()=>BA(r),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,s=(e,t,n)=>t&&t[n]?dI(t[n],e):e;let l=s(r,o,0),c=s(r,o,1),u=s(r,o,2),h=s(r,o,3);0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=oW({ones:()=>BA(a),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const d=this.recurrentDropoutMask;let f=s(a,d,0),p=s(a,d,1),g=s(a,d,2),m=s(a,d,3);const[v,b,x,y]=oR(this.kernel.read(),4,3),[w,k,N,S]=this.useBias?oR(this.bias.read(),4):[null,null,null,null];l=this.inputConv(l,v,w,this.padding),c=this.inputConv(c,b,k,this.padding),u=this.inputConv(u,x,N,this.padding),h=this.inputConv(h,y,S,this.padding);const[C,E,_,I]=oR(this.recurrentKernel.read(),4,3);f=this.recurrentConv(f,C),p=this.recurrentConv(p,E),g=this.recurrentConv(g,_),m=this.recurrentConv(m,I);const T=this.recurrentActivation.apply(cI(l,f)),A=this.recurrentActivation.apply(cI(c,p)),R=cI(dI(A,i),dI(T,this.activation.apply(cI(u,g)))),D=dI(this.recurrentActivation.apply(cI(h,m)),this.activation.apply(R));return[D,D,R]})}getConfig(){const e=super.getConfig(),{units:t}=e,n=sW(e,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),r)}inputConv(e,t,n,r){const a=GT(e,t,this.strides,r||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return n?DM(a,n,this.dataFormat):a}recurrentConv(e,t){return GT(e,t,1,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}}cW.className="ConvLSTM2DCell",kI(cW);class uW extends lW{constructor(e){const t=new cW(e);super(Object.assign(Object.assign({},e),{cell:t}))}static fromConfig(e,t){return new e(t)}}uW.className="ConvLSTM2D",kI(uW);class hW extends vj{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(null==this.noiseShape)return this.noiseShape;const t=e.shape,n=[];for(let r=0;r<this.noiseShape.length;++r)n.push(null==this.noiseShape[r]?t[r]:this.noiseShape[r]);return n}call(e,t){return b_(()=>{this.invokeCallHook(e,t);const n=ij(e);if(0<this.rate&&this.rate<1){const e=null!=t.training&&t.training,r=this.getNoiseShape(n);return OM(()=>FM(n,this.rate,r,this.seed),()=>n,e)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=super.getConfig();return Object.assign(e,t),e}dispose(){return super.dispose()}}hW.className="Dropout",kI(hW);class dW extends hW{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const t=e.shape;return[t[0],1,t[2]]}}dW.className="SpatialDropout1D",kI(dW);class fW extends vj{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",null==e.batchInputShape&&null==e.inputShape&&null!=e.inputDim){let t=null;null!=e.batchSize&&(t=e.batchSize),this.batchInputShape=[t,e.inputDim]}this.units=e.units,HP(this.units,"units"),this.activation=gz(e.activation),null!=e.useBias&&(this.useBias=e.useBias),this.kernelInitializer=nj(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=nj(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=Pj(e.kernelConstraint),this.biasConstraint=Pj(e.biasConstraint),this.kernelRegularizer=kz(e.kernelRegularizer),this.biasRegularizer=kz(e.biasRegularizer),this.activityRegularizer=kz(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){const t=(e=oj(e))[e.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:t}}],this.built=!0}computeOutputShape(e){const t=(e=oj(e)).slice();return t[t.length-1]=this.units,t}call(e,t){return b_(()=>{this.invokeCallHook(e,t);const n=ij(e),r=qP(this.activation.getClassName());let a;return null!=r?a=IM(n,this.kernel.read(),r,this.bias?this.bias.read():null):(a=IM(n,this.kernel.read()),null!=this.bias&&(a=DM(a,this.bias.read())),null!=this.activation&&(a=this.activation.apply(a))),a})}getConfig(){const e={units:this.units,activation:fz(this.activation),useBias:this.useBias,kernelInitializer:tj(this.kernelInitializer),biasInitializer:tj(this.biasInitializer),kernelRegularizer:yz(this.kernelRegularizer),biasRegularizer:yz(this.biasRegularizer),activityRegularizer:yz(this.activityRegularizer),kernelConstraint:Oj(this.kernelConstraint),biasConstraint:Oj(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}fW.className="Dense",kI(fW);class pW extends vj{constructor(e){super(e=e||{}),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=oj(e);for(const t of e.slice(1))if(null==t)throw new SP('The shape of the input to "Flatten" is not fully defined '+"(got ".concat(e.slice(1),"). Make sure to pass a complete ")+'"input_shape" or "batch_input_shape" argument to the first layer in your model.');return[e[0],fM(e,1)]}call(e,t){return b_(()=>{this.invokeCallHook(e,t);let n=ij(e);if("channelsFirst"===this.dataFormat&&n.rank>1){const e=[0];for(let t=2;t<n.rank;++t)e.push(t);e.push(1),n=vR(n,e)}return function(e){if(e.rank<=1)throw new SP("batchFlatten requires a minimum rank of 2. Got rank: ".concat(e.rank,"."));const t=[e.shape[0],fM(e.shape,1)];return RT(e,t)}(n)})}getConfig(){const e={};null!=this.dataFormat&&(e.dataFormat=this.dataFormat);const t=super.getConfig();return Object.assign(e,t),e}}pW.className="Flatten",kI(pW);class gW extends vj{constructor(e){super(e),this.supportsMasking=!0,this.activation=gz(e.activation)}call(e,t){return b_(()=>{this.invokeCallHook(e,t);const n=ij(e);return this.activation.apply(n)})}getConfig(){const e={activation:fz(this.activation)},t=super.getConfig();return Object.assign(e,t),e}}gW.className="Activation",kI(gW);class mW extends vj{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,t){return b_(()=>function(e,t){return b_(()=>{if(2!==e.shape.length)throw new SP("repeat() expects a rank-2 tensor, but received a "+"rank-".concat(e.shape.length," tensor."));return EM(yM(e,1),[1,t,1])})}(e=ij(e),this.n))}getConfig(){const e={n:this.n},t=super.getConfig();return Object.assign(e,t),e}}mW.className="RepeatVector",kI(mW);class vW extends vj{constructor(e){super(e),this.targetShape=e.targetShape;for(let t=0;t<this.targetShape.length;++t)this.isUnknown(this.targetShape[t])&&(this.targetShape[t]=null)}isUnknown(e){return e<0||null==e}fixUnknownDimension(e,t){const n="Total size of new array must be unchanged.",r=t.slice();let a=1,i=null;for(let s=0;s<r.length;++s){const e=r[s];if(this.isUnknown(e)){if(null!==i)throw new SP("Can only specifiy one unknown dimension.");i=s}else a*=e}const o=fM(e);if(null!==i){if(0===a||o%a!==0)throw new SP(n);r[i]=o/a}else if(o!==a)throw new SP(n);return r}computeOutputShape(e){let t=!1;for(let n=0;n<e.length;++n)if(this.isUnknown(e[n])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,t){return b_(()=>{this.invokeCallHook(e,t);const n=ij(e),r=n.shape,a=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return RT(n,a)})}getConfig(){const e={targetShape:this.targetShape},t=super.getConfig();return Object.assign(e,t),e}}vW.className="Reshape",kI(vW);class bW extends vj{constructor(e){if(super(e),null==e.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+"".concat(e.dims," instead."));const t=mM(1,e.dims.length+1);if(!Jw(e.dims.slice().sort(),t))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new dj({ndim:this.dims.length+1})]}computeOutputShape(e){const t=(e=oj(e)).slice();return this.dims.forEach((n,r)=>{t[r+1]=e[n]}),t}call(e,t){return vR(ij(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},t=super.getConfig();return Object.assign(e,t),e}}bW.className="Permute",kI(bW);class xW extends vj{constructor(e){super(null==e?{}:e),this.supportsMasking=!0,this.maskValue=null!=e?null==e.maskValue?0:e.maskValue:0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={maskValue:this.maskValue};return Object.assign(t,e),t}computeMask(e,t){const n=ij(e);return pT(LA(n,this.maskValue),-1)}call(e,t){return b_(()=>{this.invokeCallHook(e,t);const n=ij(e),r=pT(LA(n,this.maskValue),-1,!0);return dI(n,oI(r,n.dtype))})}}xW.className="Masking",kI(xW);class yW extends vj{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==e.batchInputShape&&null==e.inputShape){let t=null;null!=e.batchSize&&(t=e.batchSize),null==e.inputLength?this.batchInputShape=[t,null]:this.batchInputShape=[t].concat(DP(e.inputLength))}this.inputDim=e.inputDim,HP(this.inputDim,"inputDim"),this.outputDim=e.outputDim,HP(this.outputDim,"outputDim"),this.embeddingsInitializer=nj(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=kz(e.embeddingsRegularizer),this.activityRegularizer=kz(e.activityRegularizer),this.embeddingsConstraint=Pj(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,t){return b_(()=>this.maskZero?(e=ij(e),LA(e,gI(e))):null)}computeOutputShape(e){if(e=oj(e),null==this.inputLength)return[...e,this.outputDim];const t=DP(this.inputLength);if(t.length!==e.length-1)throw new SP('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));{let n=0;for(let r=0;r<t.length;++r){const a=t[r],i=e[r+1];if(null!=a&&null!=i&&a!==i)throw new SP('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));null==a&&(t[n]=i),n++}}return[e[0],...t,this.outputDim]}call(e,t){return b_(()=>{this.invokeCallHook(e,t);let n=ij(e);"int32"!==n.dtype&&(n=xM(n,"int32"));const r=TM(this.embeddings.read(),RT(n,[n.size]));return RT(r,oj(this.computeOutputShape(n.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:tj(this.embeddingsInitializer),embeddingsRegularizer:yz(this.embeddingsRegularizer),activityRegularizer:yz(this.activityRegularizer),embeddingsConstraint:Oj(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=super.getConfig();return Object.assign(e,t),e}}yW.className="Embedding",kI(yW);class wW extends vj{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new CP}computeElementwiseOpOutputShape(e,t){if(null==e||null==t)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(0===t.length)return e;const n=e.slice(0,e.length-t.length);for(let r=0;r<t.length;++r){const a=e[e.length-t.length+r],i=t[r];if(null==a||null==i||a<0||i<0)n.push(null);else if(1===a)n.push(i);else if(1===i)n.push(a);else{if(a!==i)throw new SP("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));n.push(a)}}return n}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[oj(e)]),e.length<2)throw new SP("A merge layer should be called on an Array of at least 2 inputs."+" Got ".concat(e.length," input(s)."));let t=[];for(const a of e)null!=a&&null!==a[0]&&t.push(a[0]);if(t=zP(t),t.length>1)throw new SP("Can not merge tensors with different batch sizes. "+"Got tensors with shapes: ".concat(JSON.stringify(e),"."));let n=null==e[0]?null:e[0].slice(1);for(let a=1;a<e.length;++a){const t=null==e[a]?null:e[a].slice(1);n=this.computeElementwiseOpOutputShape(n,t)}const r=e.map(e=>e.length);-1===e.indexOf(null)&&1===zP(r).length?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,t){return b_(()=>{if(this.reshapeRequired){const t=[],n=e.map(e=>e.rank);if(-1===n.indexOf(null)){const r=gM(n);for(let n of e){const e=n.rank;for(let t=0;t<r-e;++t)n=yM(n,1);t.push(n)}return this.mergeFunction(t)}{let n=!1;for(const i of e){const e=i.rank;if(null==e){const e=i.shape,r=e[0],a=e.slice(1).concat([r]);let o=RT(i,[r].concat(fM(e.slice(1))));o=vR(o,[1,0]),o=RT(o,a),t.push(o),n=!0}else if(e>1){const r=mM(1,e).concat([0]);t.push(vR(i,r)),n=!0}else t.push(i)}let r=this.mergeFunction(t);const a=r.rank;if(n)if(null==a){const e=r.shape,t=e[e.length-1],n=[t].concat(e.slice(0,e.length-1));r=RT(vR(RT(r,[-1,t]),[1,0]),n)}else if(a>1){const e=[a-1].concat(mM(0,a-1));r=vR(r,e)}return r}}return this.mergeFunction(e)})}computeOutputShape(e){let t;t=null==e[0]?null:e[0].slice(1);for(let r=1;r<e.length;++r){const n=null==e[r]?null:e[r].slice(1);t=this.computeElementwiseOpOutputShape(t,n)}let n=[];for(const r of e)null!=r&&null!==r[0]&&n.push(r[0]);return n=zP(n),t=1===n.length?n.concat(t):[null].concat(t),t}computeMask(e,t){return b_(()=>{if(null==t)return null;if(!Array.isArray(t))throw new SP("`mask` should be an Array");if(!Array.isArray(e))throw new SP("`inputs` should be an Array");if(t.length!==e.length)throw new SP("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths "+"(".concat(e.length," vs ").concat(t.length,")"));if(t.every(e=>null==e))return null;t=t.map(e=>null==e?e:aA(e,0));let n=t[0];for(let e=1;e<t.length-1;++e)n=EA(n,t[e]);return n})}}class kW extends wW{constructor(e){super(e)}mergeFunction(e){return b_(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=cI(t,e[n]);return t})}}kW.className="Add",kI(kW);class NW extends wW{constructor(e){super(e)}mergeFunction(e){return b_(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=dI(t,e[n]);return t})}}NW.className="Multiply",kI(NW);class SW extends wW{constructor(e){super(e)}mergeFunction(e){return b_(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=cI(t,e[n]);return dI(1/e.length,t)})}}SW.className="Average",kI(SW);class CW extends wW{constructor(e){super(e)}mergeFunction(e){return b_(()=>{let t=e[0];for(let n=1;n<e.length;++n)t=OI(t,e[n]);return t})}}CW.className="Maximum",kI(CW);class EW extends wW{constructor(e){super(e)}mergeFunction(e){return b_(()=>{let t=e[0];for(let n=1;n<e.length;++n)t=DA(t,e[n]);return t})}}EW.className="Minimum",kI(EW);class _W extends wW{constructor(e){super(e),this.DEFAULT_AXIS=-1,null==e&&(e={}),this.axis=null==e.axis?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!Array.isArray(e)||!Array.isArray(e[0])||1===e.length)throw new SP("A `Concatenate` layer should be called on a list of at least 2 inputs");let t=!0;for(const r of e)if(null!=r){t=!1;break}if(t)return;const n=[];for(let r=0;r<e.length;++r){const t=e[r].slice();t.splice(this.axis,1);let a=!1;for(const e of n)if(Jw(e,t)){a=!0;break}a||n.push(t)}if(n.length>1)throw new SP("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return b_(()=>SM(e,this.axis))}computeOutputShape(e){if(!Array.isArray(e)||!Array.isArray(e[0]))throw new SP("A `Concatenate` layer should be called on a list of inputs.");const t=e,n=t[0].slice(),r=this.axis<0?n.length+this.axis:this.axis;for(const a of t.slice(1)){if(null==n[r]||null==a[r]){n[r]=null;break}n[r]+=a[r]}return n}computeMask(e,t){if(null==t)return null;if(!Array.isArray(t))throw new SP("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new SP("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new SP("Mismatch in the length of mask (".concat(t.length,") ")+"and the legnth of inputs (".concat(e.length,")"));return b_(()=>{let n=!0;if(t.forEach(e=>{null==e||(n=!1)}),n)return null;const r=[];for(let i=0;i<e.length;++i)null==t[i]?r.push(oI(BA(e[i]),"bool")):t[i].rank<e[i].rank?r.push(aA(t[i],-1)):r.push(t[i]);const a=zT(r,this.axis);return fT(a,-1,!1)})}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}function IW(e,t){for(;e<0;)e+=t;return e}_W.className="Concatenate",kI(_W);class TW extends wW{constructor(e){super(e),this.axes=e.axes,this.normalize=null!=e.normalize&&e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){Kw(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const t=e[0],n=e[1];if(t.length>3||n.length>3)throw new CP("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(t,n);if(t[r[0]]!==n[r[1]])throw new SP("Dimension incompatibility: "+"".concat(t[r[0]]," !== ").concat(n[r[1]]))}mergeFunction(e){if(2!==e.length)throw new SP("A `Dot` layer must be called on exactly 2 inputs, "+"but received ".concat(e.length," input(s)."));let t,n=e[0],r=e[1];return t=Array.isArray(this.axes)?this.axes.map((t,n)=>IW(t,e[n].shape.length)):[IW(this.axes,n.shape.length),IW(this.axes,r.shape.length)],this.normalize&&(n=Yj(n,t[0]),r=Yj(r,t[1])),function(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new CP("batchDot is not implemented for tensors of 4D or higher rank yet");if(Kw(e.shape.length>=2,()=>"batchDot requires the rank of x to be >= 2, "+"but got ".concat(e.shape.length)),Kw(e.shape.length>=2,()=>"batchDot requires the rank of y to be >= 2, "+"but got ".concat(t.shape.length)),"number"===typeof n&&(n=[n,n]),"complex64"===e.dtype||"complex64"===t.dtype)throw new CP("batchDot is not implemented for complex64-type Tensors yet.");const r=e.shape.length,a=t.shape.length;null==n&&(n=[r-1,a-2]);const i=n;return b_(()=>{let n,o;if(r>a){n=r-a;const e=[];for(let t=0;t<n;++t)e.push(1);t=RT(t,t.shape.concat(e))}else if(a>r){n=a-r;const t=[];for(let e=0;e<n;++e)t.push(1);e=RT(e,e.shape.concat(t))}else n=0;if(2===e.shape.length&&2===t.shape.length)o=i[0]===i[1]?gA(dI(e,t),i[0]):gA(dI(vR(e,[1,0]),t),i[1]);else{const n=i[0]!==e.shape.length-1,r=i[1]===t.shape.length-1;o=_A(e,t,n,r)}if(n>0){let e;e=r>a?r+a-3:r-1;const t=[];for(let r=e;r<e+n;++r)t.push(r);o=sR(o,t)}return 1===o.shape.length&&(o=aA(o,1)),o})}(n,r,t)}interpretAxes(e,t){let n;return n=Array.isArray(this.axes)?this.axes:[IW(this.axes,e.length),IW(this.axes,t.length)],n}computeOutputShape(e){Kw(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const t=e[0].slice(),n=e[1].slice();if(t.length>3||n.length>3)throw new CP("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(t,n);t.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);const a=t.concat(n);return 1===a.length&&a.push(1),a}computeMask(e,t){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},t=super.getConfig();return Object.assign(e,t),e}}TW.className="Dot",kI(TW);class AW extends vj{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={stddev:this.stddev};return Object.assign(t,e),t}call(e,t){return b_(()=>{this.invokeCallHook(e,t);const n=ij(e);return OM(()=>cI(_M(n.shape,0,this.stddev),n),()=>n,t.training||!1)})}}AW.className="GaussianNoise",kI(AW);class RW extends vj{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return b_(()=>{this.invokeCallHook(e,t);const n=ij(e);if(this.rate>0&&this.rate<1){return OM(()=>{const e=Math.sqrt(this.rate/(1-this.rate));return dI(n,_M(n.shape,1,e))},()=>n,t.training||!1)}return n})}}RW.className="GaussianDropout",kI(RW);class DW extends vj{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||ij(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return b_(()=>{if(this.rate<1&&this.rate>0){const n=this._getNoiseShape(e),r=()=>{const t=ij(e),r=-1.7580993408473766;let a=uA(qA(n),this.rate);a=xM(a,"float32");const i=((1-this.rate)*(1+this.rate*r**2))**-.5,o=-i*r*this.rate,s=cI(dI(t,a),dI(cI(a,-1),r));return cI(dI(s,i),o)};return OM(r,()=>ij(e),t.training||!1)}return e})}}function FW(e,t,n,r,a){let i,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.001;if(2===e.rank)i=LT(e,t,n,r,a,o);else if(3===e.rank)i=PT(e,t,n,r,a,o);else{if(4!==e.rank)throw new CP("batchNormalization is not implemented for array of rank ".concat(e.rank," ")+"yet");i=MT(e,t,n,r,a,o)}return i}function OW(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return Jw(r.slice().sort(),mM(0,e.rank-1))?function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return b_(()=>{const i=FA(e,r),o=i.mean,s=i.variance;return[FW(e,o,s,n,t,a),o,s]})}(e,t,n,r,a):function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return b_(()=>{const i=FA(e,r),o=i.mean,s=i.variance,l=[];for(const t of mM(0,e.rank))-1!==r.indexOf(t)?l.push(1):l.push(e.shape[t]);const c=RT(o,l),u=RT(s,l),h=null==t?null:RT(t,l),d=null==n?null:RT(n,l);return[FW(e,c,u,d,h,a),o,s]})}(e,t,n,r,a)}DW.className="AlphaDropout",kI(DW);class LW extends vj{constructor(e){null==e&&(e={}),super(e),this.supportsMasking=!0,this.axis=null==e.axis?-1:e.axis,this.momentum=null==e.momentum?.99:e.momentum,this.epsilon=null==e.epsilon?.001:e.epsilon,this.center=null==e.center||e.center,this.scale=null==e.scale||e.scale,this.betaInitializer=nj(e.betaInitializer||"zeros"),this.gammaInitializer=nj(e.gammaInitializer||"ones"),this.movingMeanInitializer=nj(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=nj(e.movingVarianceInitializer||"ones"),this.betaConstraint=Pj(e.betaConstraint),this.gammaConstraint=Pj(e.gammaConstraint),this.betaRegularizer=kz(e.betaRegularizer),this.gammaRegularizer=kz(e.gammaRegularizer)}build(e){e=oj(e);const t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(null==n)throw new SP("Axis ".concat(t," of input tensor should have a defined dimension but ")+"the layer received an input with shape "+"".concat(JSON.stringify(e),"."));this.inputSpec=[new dj({ndim:e.length,axes:{[t]:n}})];const r=[n];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,t){return b_(()=>{const n=null!=t.training&&t.training,r=ij(e),a=r.shape,i=a.length,o=mM(0,i),s=this.axis>=0?this.axis:this.axis+i;o.splice(s,1);const l=IP(1,i);l[s]=a[s];const c=o.slice();c.sort();const u=!Jw(c,mM(0,i).slice(0,i-1));if(!n)return(()=>{if(u){const e=RT(this.movingMean.read(),l),t=RT(this.movingVariance.read(),l),n=this.center?RT(this.beta.read(),l):null,a=this.scale?RT(this.gamma.read(),l):null;return FW(r,e,t,n,a,this.epsilon)}return FW(r,this.movingMean.read(),this.movingVariance.read(),null==this.beta?null:this.beta.read(),null==this.gamma?null:this.gamma.read(),this.epsilon)})();const[h,d,f]=OW(r,this.gamma.read(),this.beta.read(),o,this.epsilon),p=(e,t,n)=>{b_(()=>{const r=1-n,a=e.read(),i=dI(II(a,t),r);e.write(II(a,i))})};return(()=>{p(this.movingMean,d,this.momentum),p(this.movingVariance,f,this.momentum)})(),h})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:tj(this.betaInitializer),gammaInitializer:tj(this.gammaInitializer),movingMeanInitializer:tj(this.movingMeanInitializer),movingVarianceInitializer:tj(this.movingVarianceInitializer),betaRegularizer:yz(this.betaRegularizer),gammaRegularizer:yz(this.gammaRegularizer),betaConstraint:Oj(this.betaConstraint),gammaConstraint:Oj(this.gammaConstraint)},t=super.getConfig();return Object.assign(e,t),e}}LW.className="BatchNormalization",kI(LW);class PW extends vj{constructor(e){if(null==e&&(e={}),super(e),this.axis=null==e.axis?-1:e.axis,"number"===typeof this.axis){if(!Number.isInteger(this.axis))throw new Error("Expected axis to be an integer, but received ".concat(this.axis))}else{if(!Array.isArray(this.axis))throw new Error("Expected axis to be an integer or an array of integers, "+"but received ".concat(JSON.stringify(this.axis)));for(const e of this.axis)if(!Number.isInteger(e))throw new Error("Expected axis to be an array of integers, "+"but received ".concat(JSON.stringify(this.axis)))}this.epsilon=null==e.epsilon?.001:e.epsilon,this.center=null==e.center||e.center,this.scale=null==e.scale||e.scale,this.betaInitializer=nj(e.betaInitializer||"zeros"),this.gammaInitializer=nj(e.gammaInitializer||"ones"),this.betaRegularizer=kz(e.betaRegularizer),this.gammaRegularizer=kz(e.gammaRegularizer),this.supportsMasking=!0}build(e){const t=(e=oj(e)).length;"number"===typeof this.axis&&(this.axis=[this.axis]);for(let a=0;a<this.axis.length;++a)this.axis[a]<0&&(this.axis[a]+=t);for(const a of this.axis)if(a<0||a>=t)throw new Error("Invalid axis: ".concat(a));if(this.axis.length!==zP(this.axis).length)throw new Error("Found duplicate axes in: ".concat(this.axis));const n=this.axis.map(t=>e[t]),r=!0;this.scale?this.gamma=this.addWeight("gamma",n,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",n,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(e,t){const n=ij(e),r=n.shape,a=r.length;return b_(()=>{let{mean:e,variance:t}=FA(n,this.axis,!0);const i=IP(1,a);for(const n of this.axis)i[n]=r[n];const o=e=>null!=e&&e.shape.length!==a?RT(e,i):e;let s=this.scale?o(this.gamma.read()):null,l=this.center?o(this.beta.read()):null;const c=[],u=[];for(let n=0;n<a;++n)-1!==this.axis.indexOf(n)?(c.push(r[n]),u.push(1)):(c.push(1),u.push(r[n]));return e=iA(e,c),t=iA(t,c),null!=s&&(s=iA(s,u)),null!=l&&(l=iA(l,u)),FW(n,e,t,l,s,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:tj(this.betaInitializer),gammaInitializer:tj(this.gammaInitializer),betaRegularizer:yz(this.betaRegularizer),gammaRegularizer:yz(this.gammaRegularizer)},t=super.getConfig();return Object.assign(e,t),e}}PW.className="LayerNormalization",kI(PW);class MW extends vj{constructor(e){if(null==e&&(e={}),super(e),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,null==e.padding)this.padding=[[1,1],[1,1]];else if("number"===typeof e.padding)this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,2!==e.padding.length)throw new SP("ZeroPadding2D expects padding to be a length-2 array, but "+"received a length-".concat(e.padding.length," array."));let t,n;if("number"===typeof e.padding[0])t=[e.padding[0],e.padding[0]],n=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,2!==e.padding[0].length)throw new SP("ZeroPadding2D expects height padding to be a length-2 array, "+"but received a length-".concat(e.padding[0].length," array."));if(t=e.padding[0],2!==e.padding[1].length)throw new SP("ZeroPadding2D expects width padding to be a length-2 array, "+"but received a length-".concat(e.padding[1].length," array."));n=e.padding[1]}this.padding=[t,n]}this.inputSpec=[new dj({ndim:4})]}computeOutputShape(e){let t,n;return e=oj(e),"channelsFirst"===this.dataFormat?(t=null!=e[2]&&e[2]>=0?e[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[3]&&e[3]>=0?e[3]+this.padding[1][0]+this.padding[1][1]:null,[e[0],e[1],t,n]):(t=null!=e[1]&&e[1]>=0?e[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[2]&&e[2]>=0?e[2]+this.padding[1][0]+this.padding[1][1]:null,[e[0],t,n,e[3]])}call(e,t){return b_(()=>function(e,t,n){return b_(()=>{if(4!==e.rank)throw new SP("temporalPadding expects input tensor to be 4-D, but received a "+"".concat(e.rank,"-D tensor."));if(null==t&&(t=[[1,1],[1,1]]),2!==t.length||2!==t[0].length||2!==t[1].length)throw new SP("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==n&&(n="channelsLast"),"channelsLast"!==n&&"channelsFirst"!==n)throw new SP("Unknown data format: ".concat(n,". ")+"Supported data formats are 'channelsLast' and 'channelsFirst.");let r;return r="channelsFirst"===n?[[0,0],[0,0],t[0],t[1]]:[[0,0],t[0],t[1],[0,0]],zA(e,r)})}(ij(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}function jW(e,t,n,r,a,i){return b_(()=>{let o;rM(a),iM(i),aM(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==a&&(a="channelsLast"),null==i&&(i="max"),e=Dz(e,a);const s="same"===r?"same":"valid";return o="max"===i?IA(e,t,n,s):DT(e,t,n,s),"channelsFirst"===a&&(o=vR(o,[0,3,1,2])),o})}function BW(e,t,n,r,a,i){return b_(()=>{let o;rM(a),iM(i),aM(r),null==n&&(n=[1,1,1]),null==r&&(r="valid"),null==a&&(a="channelsLast"),null==i&&(i="max"),e=Fz(e,a);const s="same"===r?"same":"valid";return o="max"===i?TA(e,t,n,s):FT(e,t,n,s),"channelsFirst"===a&&(o=vR(o,[0,4,1,2,3])),o})}MW.className="ZeroPadding2D",kI(MW);class zW extends vj{constructor(e){if(null==e.poolSize&&(e.poolSize=2),super(e),"number"===typeof e.poolSize)this.poolSize=[e.poolSize];else{if(!Array.isArray(e.poolSize)||1!==e.poolSize.length||"number"!==typeof e.poolSize[0])throw new SP("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.poolSize)));this.poolSize=e.poolSize}if(HP(this.poolSize,"poolSize"),null==e.strides)this.strides=this.poolSize;else if("number"===typeof e.strides)this.strides=[e.strides];else{if(!Array.isArray(e.strides)||1!==e.strides.length||"number"!==typeof e.strides[0])throw new SP("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.strides)));this.strides=e.strides}HP(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,aM(this.padding),this.inputSpec=[new dj({ndim:3})]}computeOutputShape(e){const t=Az((e=oj(e))[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}call(e,t){return b_(()=>{this.invokeCallHook(e,t),e=yM(ij(e),2);const n=this.poolingFunction(ij(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return sR(n,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=super.getConfig();return Object.assign(e,t),e}}class WW extends zW{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return rM(a),aM(r),jW(e,t,n,r,a,"max")}}WW.className="MaxPooling1D",kI(WW);class UW extends zW{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return rM(a),aM(r),jW(e,t,n,r,a,"avg")}}UW.className="AveragePooling1D",kI(UW);class VW extends vj{constructor(e){if(null==e.poolSize&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],null==e.strides)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(2!==e.strides.length)throw new SP("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+"".concat(e.strides.length,"."));this.strides=e.strides}else this.strides=[e.strides,e.strides];HP(this.poolSize,"poolSize"),HP(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,rM(this.dataFormat),aM(this.padding),this.inputSpec=[new dj({ndim:4})]}computeOutputShape(e){e=oj(e);let t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2];return t=Az(t,this.poolSize[0],this.padding,this.strides[0]),n=Az(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n]:[e[0],t,n,e[3]]}call(e,t){return b_(()=>(this.invokeCallHook(e,t),this.poolingFunction(ij(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class HW extends VW{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return rM(a),aM(r),jW(e,t,n,r,a,"max")}}HW.className="MaxPooling2D",kI(HW);class GW extends VW{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return rM(a),aM(r),jW(e,t,n,r,a,"avg")}}GW.className="AveragePooling2D",kI(GW);class qW extends vj{constructor(e){if(null==e.poolSize&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],null==e.strides)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(3!==e.strides.length)throw new SP("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+"".concat(e.strides.length,"."));this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];HP(this.poolSize,"poolSize"),HP(this.strides,"strides"),this.padding=null==e.padding?"valid":e.padding,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,rM(this.dataFormat),aM(this.padding),this.inputSpec=[new dj({ndim:5})]}computeOutputShape(e){e=oj(e);let t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[4]:e[3];return t=Az(t,this.poolSize[0],this.padding,this.strides[0]),n=Az(n,this.poolSize[1],this.padding,this.strides[1]),r=Az(r,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n,r]:[e[0],t,n,r,e[4]]}call(e,t){return b_(()=>(this.invokeCallHook(e,t),this.poolingFunction(ij(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class KW extends qW{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return rM(a),aM(r),BW(e,t,n,r,a,"max")}}KW.className="MaxPooling3D",kI(KW);class XW extends qW{constructor(e){super(e)}poolingFunction(e,t,n,r,a){return rM(a),aM(r),BW(e,t,n,r,a,"avg")}}XW.className="AveragePooling3D",kI(XW);class YW extends vj{constructor(e){super(e),this.inputSpec=[new dj({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,t){throw new CP}}class $W extends YW{constructor(e){super(e||{})}call(e,t){return b_(()=>{const t=ij(e);return AA(t,1)})}}$W.className="GlobalAveragePooling1D",kI($W);class JW extends YW{constructor(e){super(e||{})}call(e,t){return b_(()=>{const t=ij(e);return pA(t,1)})}}JW.className="GlobalMaxPooling1D",kI(JW);class QW extends vj{constructor(e){super(e),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,rM(this.dataFormat),this.inputSpec=[new dj({ndim:4})]}computeOutputShape(e){return"channelsLast"===this.dataFormat?[e[0],e[3]]:[e[0],e[1]]}call(e,t){throw new CP}getConfig(){const e={dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class ZW extends QW{call(e,t){return b_(()=>{const t=ij(e);return"channelsLast"===this.dataFormat?AA(t,[1,2]):AA(t,[2,3])})}}ZW.className="GlobalAveragePooling2D",kI(ZW);class eU extends QW{call(e,t){return b_(()=>{const t=ij(e);return"channelsLast"===this.dataFormat?pA(t,[1,2]):pA(t,[2,3])})}}eU.className="GlobalMaxPooling2D",kI(eU);class tU extends vj{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return null!=this.layer&&this.layer.trainable}set trainable(e){null!=this.layer&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=super.getConfig();return Object.assign(e,t),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=Xj(t.layer,n);delete t.layer;const a={layer:r};return Object.assign(a,t),new e(a)}}class nU extends tU{constructor(e){super(e),this.supportsMasking=!0}build(e){if((e=oj(e)).length<3)throw new SP("TimeDistributed layer expects an input shape >= 3D, but received "+"input shape ".concat(JSON.stringify(e)));this.inputSpec=[{shape:e}];const t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),super.build(e)}computeOutputShape(e){const t=[(e=oj(e))[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t),r=e[1];return[n[0],r].concat(n.slice(1))}call(e,t){return b_(()=>$z((e,n)=>[ij(this.layer.call(e,t)),[]],e=ij(e),[],!1,null,null,!1,!0)[1])}}nU.className="TimeDistributed",kI(nU);class rU extends tU{constructor(e){super(e);const t=e.layer.getConfig(),n={};n.className=e.layer.getClassName(),n.config=t,this.forwardLayer=Xj(n),t.goBackwards=!0!==t.goBackwards;const r={};if(r.className=e.layer.getClassName(),r.config=t,this.backwardLayer=Xj(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=void 0===e.mergeMode?"concat":e.mergeMode,function(e){UP(tM,"BidirectionalMergeMode",e)}(this.mergeMode),e.weights)throw new CP("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,null!=this.forwardLayer&&(this.forwardLayer.trainable=e),null!=this.backwardLayer&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const t=e.length,n=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,n)),this.backwardLayer.setWeights(e.slice(n))}computeOutputShape(e){let t,n,r,a=this.forwardLayer.computeOutputShape(e);return Array.isArray(a)&&Array.isArray(a[0])||(a=[a]),this.returnState?(r=a.slice(1),t=a[0]):t=a[0],"concat"===this.mergeMode?(t[t.length-1]*=2,n=[t]):n=null==this.mergeMode?[t,t.slice()]:[t],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[t].concat(r).concat(r.slice()):RP(n)}apply(e,t){let n=null==t?null:t.initialState,r=null==t?null:t.constants;null==t&&(t={});const a=Yz(e,n,r,this.numConstants);if(e=a.inputs,n=a.initialState,r=a.constants,Array.isArray(e)&&(n=e.slice(1),e=e[0]),(null==n||0===n.length)&&null==r)return super.apply(e,t);const i=[],o=[];if(null!=n){const e=n.length;if(e%2>0)throw new SP("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=n,i.push(...n);const r=n.map(e=>new dj({shape:e.shape}));this.forwardLayer.stateSpec=r.slice(0,e/2),this.backwardLayer.stateSpec=r.slice(e/2),o.push(...r)}if(null!=r)throw new CP("Support for constants in Bidirectional layers is not implemented yet.");const s=i[0]instanceof fj;for(const l of i)if(l instanceof fj!==s)throw new SP("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(s){const n=[e].concat(i),r=this.inputSpec.concat(o),a=this.inputSpec;this.inputSpec=r;const s=super.apply(n,t);return this.inputSpec=a,s}return super.apply(e,t)}call(e,t){return b_(()=>{const n=t.initialState;let r,a,i,o;if(null==n)r=this.forwardLayer.call(e,t),a=this.backwardLayer.call(e,t);else{const i=n.slice(0,n.length/2),o=n.slice(n.length/2);r=this.forwardLayer.call(e,Object.assign(t,{initialState:i})),a=this.backwardLayer.call(e,Object.assign(t,{initialState:o}))}return this.returnState&&(Array.isArray(r)&&(i=r.slice(1).concat(a.slice(1))),r=r[0],a=a[0]),this.returnSequences&&(a=YA(a,1)),"concat"===this.mergeMode?o=SM([r,a]):"sum"===this.mergeMode?o=cI(r,a):"ave"===this.mergeMode?o=dI(.5,cI(r,a)):"mul"===this.mergeMode?o=dI(r,a):null==this.mergeMode&&(o=[r,a]),this.returnState?null==this.mergeMode?o.concat(i):[o].concat(i):o})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){sM(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),sM(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,t){let n;if(Array.isArray(t)&&(t=t[0]),n=this.returnSequences?null==this.mergeMode?[t,t]:t:null==this.mergeMode?[null,null]:null,this.returnState){const e=this.forwardLayer.states.map(e=>null);return Array.isArray(n)?n.concat(e).concat(e):[n].concat(e).concat(e)}return n}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(e),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},t=super.getConfig();return Object.assign(e,t),e}static fromConfig(e,t){const n=Xj(t.layer);if(delete t.layer,null!=t.numConstants)throw new CP("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=t;return r.layer=n,new e(r)}}rU.className="Bidirectional",kI(rU);class aU extends vj{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return b_(()=>("float32"!==(e=ij(e)).dtype&&(e=xM(e,"float32")),cI(dI(e,this.scale),this.offset)))}}aU.className="Rescaling",kI(aU);const{resizeBilinear:iU,cropAndResize:oU}=bD;class sU extends vj{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,t,n,r,a,i,o,s){return b_(()=>{let l,c=!1;const u=[t/i,n/o,(r+t)/i,(a+n)/o],h=[];3===e.rank?(c=!0,l=lR([e])):l=e;for(let e=0;e<l.shape[0];e++)h.push(u);const d=p_(h,[h.length,4]),f=KA(0,h.length,1,"int32"),p=oU(l,d,f,[r,a],"nearest");return xM(c?ij(fR(p)):p,s)})}upsize(e,t,n,r){return b_(()=>xM(iU(e,[t,n]),r))}call(e,t){return b_(()=>{const t=ij(e),n=t.dtype,r=t.shape,a=r[r.length-3],i=r[r.length-2];let o=0;a!==this.height&&(o=Math.floor((a-this.height)/2));let s=0;return i!==this.width&&(s=Math.floor((i-this.width)/2),0===s&&(s=1)),o>=0&&s>=0?this.centerCrop(t,o,s,this.height,this.width,a,i,n):this.upsize(e,this.height,this.width,n)})}getConfig(){const e={height:this.height,width:this.width},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){const t=(e=oj(e)).length-3,n=e.length-2;return e[t]=this.height,e[n]=this.width,e}}sU.className="CenterCrop",kI(sU);class lU extends vj{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){return null==(e=oj(e))?[this.numTokens]:"oneHot"===this.outputMode&&1!==e[e.length-1]?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,t){return b_(()=>{let n;if("int32"!==(e=ij(e)).dtype&&(e=xM(e,"int32")),"undefined"!==typeof t.countWeights){if("count"!==this.outputMode)throw new SP("countWeights is not used when outputMode !== count.\n              Received countWeights=".concat(t.countWeights));n=ij(t.countWeights)}const r=pA(e),a=RA(e),i=cA(this.numTokens,r).bufferSync().get(0),o=uA(a,0).bufferSync().get(0);if(!i||!o)throw new SP("Input values must be between 0 < values <="+" numTokens with numTokens=".concat(this.numTokens));return function(e,t,n,r){let a=ij(e);if("int32"!==a.dtype&&(a=xM(a,"int32")),"int"===t)return a;const i=a.shape;if(0===a.rank&&(a=aA(a,-1)),"oneHot"===t&&1!==a.shape[a.shape.length-1]&&(a=aA(a,-1)),a.rank>2)throw new SP("When outputMode is not int, maximum output rank is 2"+" Received outputMode ".concat(t," and input shape ").concat(i)+" which would result in output rank ".concat(a.rank,"."));const o=["multiHot","oneHot"].includes(t),s=a;let l;if(l=QT(s,"undefined"!==typeof r&&"count"===t?r:[],n,o),"tfIdf"!==t)return l;if(r)return dI(l,r);throw new SP("When outputMode is 'tfIdf', weights must be provided.")}(e,this.outputMode,this.numTokens,n)})}}lU.className="CategoryEncoding",kI(lU);const cU=new Set(["bilinear","nearest"]);class uU extends vj{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation){if(!cU.has(e.interpolation))throw new SP("Invalid interpolation parameter: ".concat(e.interpolation," is not implemented"));this.interpolation=e.interpolation}else this.interpolation="bilinear";this.cropToAspectRatio=Boolean(e.cropToAspectRatio)}computeOutputShape(e){const t=(e=oj(e))[2];return[this.height,this.width,t]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return b_(()=>{const t=[this.height,this.width];if("bilinear"===this.interpolation)return bD.resizeBilinear(e,t,!this.cropToAspectRatio);if("nearest"===this.interpolation)return bD.resizeNearestNeighbor(e,t,!this.cropToAspectRatio);throw new Error("Interpolation is ".concat(this.interpolation," but only ").concat([...cU]," are supported"))})}}uU.className="Resizing",kI(uU);class hU{constructor(e){this.seed=e}next(){if(void 0!==this.seed)return this.seed++}}hU.className="RandomSeed";class dU extends vj{constructor(e){super(e),this.randomGenerator=new hU(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},t=super.getConfig();return Object.assign(e,t),e}}dU.className="BaseRandomLayer";const fU=new Set(["bilinear","nearest"]);class pU extends dU{constructor(e){super(e);const{factor:t,interpolation:n="bilinear"}=e;if(this.factor=t,Array.isArray(this.factor)&&2===this.factor.length)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else{if(Array.isArray(this.factor)||!(this.factor>0))throw new SP("Invalid factor: ".concat(this.factor,". Must be positive number or tuple of 2 numbers"));this.widthLower=-this.factor,this.widthUpper=this.factor}if(this.widthLower<-1||this.widthUpper<-1)throw new SP("factor must have values larger than -1. Got: ".concat(this.factor));if(this.widthUpper<this.widthLower)throw new SP("factor cannot have upper bound less than lower bound.\n        Got upper bound: ".concat(this.widthUpper,".\n        Got lower bound: ").concat(this.widthLower,"\n      "));if(n){if(!fU.has(n))throw new SP("Invalid interpolation parameter: ".concat(n," is not implemented"));this.interpolation=n}}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){const t=(e=oj(e))[2];return[this.imgHeight,-1,t]}call(e,t){return b_(()=>{const t=ij(e);this.imgHeight=t.shape[t.shape.length-3];const n=t.shape[t.shape.length-2];this.widthFactor=qA([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let r=this.widthFactor.dataSync()[0]*n;r=Math.round(r);const a=[this.imgHeight,r];switch(this.interpolation){case"bilinear":return bD.resizeBilinear(e,a);case"nearest":return bD.resizeNearestNeighbor(e,a);default:throw new Error("Interpolation is ".concat(this.interpolation,"\n          but only ").concat([...fU]," are supported"))}})}}pU.className="RandomWidth",kI(pU);var gU,mU;_k().registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,e=>{e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")}),function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_QINT16=15]="DT_QINT16",e[e.DT_QUINT16=16]="DT_QUINT16",e[e.DT_UINT16=17]="DT_UINT16",e[e.DT_COMPLEX128=18]="DT_COMPLEX128",e[e.DT_HALF=19]="DT_HALF",e[e.DT_RESOURCE=20]="DT_RESOURCE",e[e.DT_VARIANT=21]="DT_VARIANT",e[e.DT_UINT32=22]="DT_UINT32",e[e.DT_UINT64=23]="DT_UINT64",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",e[e.DT_QINT16_REF=115]="DT_QINT16_REF",e[e.DT_QUINT16_REF=116]="DT_QUINT16_REF",e[e.DT_UINT16_REF=117]="DT_UINT16_REF",e[e.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",e[e.DT_HALF_REF=119]="DT_HALF_REF",e[e.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",e[e.DT_VARIANT_REF=121]="DT_VARIANT_REF",e[e.DT_UINT32_REF=122]="DT_UINT32_REF",e[e.DT_UINT64_REF=123]="DT_UINT64_REF"}(gU||(gU={})),function(e){let t;!function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"}(t=e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))}(mU||(mU={}));Error;new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function vU(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Set;if(null==e)return null;if("function"===typeof Blob&&e instanceof Blob)return e.slice();if(r.has(e))throw new Error("Circular references are not supported.");if(n.has(e))return n.get(e);const a=t(e);if(a.recurse&&null!==a.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(a.recurse){if(wU(e)){const a=Array.isArray(e)?[]:{};r.add(e);for(const i in e){const o=vU(e[i],t,n,r);a[i]=o}return r.delete(e),e.__proto__&&(a.__proto__=e.__proto__),a}throw new Error("Can't recurse into non-iterable type: ".concat(e))}return n.set(e,a.value),a.value}function bU(e){return xU(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:yU)}function xU(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;const r=e[0];if(n.has(r))throw new Error("Circular references are not supported.");const a=t(e);if(a.recurse&&null!==a.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(a.recurse){if(wU(r)){const a=Array.isArray(r)?[]:{};n.add(r);for(const i in r){const r=e.map(e=>e[i]),o=xU(r,t,n);a[i]=o}return n.delete(r),a}throw new Error("Can't recurse into non-iterable type: ".concat(r))}return a.value}function yU(e){return null===e?null:wU(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}function wU(e){let t=!1;if(_k().get("IS_BROWSER"))t=e instanceof TextDecoder;else{const{StringDecoder:r}=n(551);t=e instanceof r}return null!=e&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||"object"===typeof e&&!(e instanceof FE)&&!(e instanceof Promise)&&!t)}function kU(e){return function(e,t){return vU(e,t)}(e,NU)}function NU(e){return e instanceof FE?{value:e.clone(),recurse:!1}:wU(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}class SU{constructor(e){if(this.capacity=e,this.begin=0,this.end=0,null==e)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(e<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(e),this.doubledCapacity=2*e}wrap(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}get(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}set(e,t){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=t}length(){let e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}isFull(){return this.length()===this.capacity}isEmpty(){return 0===this.length()}push(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}pushAll(e){for(const t of e)this.push(t)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);const e=this.get(this.end);return this.set(this.end,void 0),e}unshift(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}shuffleExcise(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const t=this.wrap(this.begin+e),n=this.get(t);return this.set(t,this.pop()),n}}class CU extends SU{constructor(){super(CU.INITIAL_CAPACITY)}isFull(){return!1}push(e){super.isFull()&&this.expand(),super.push(e)}unshift(e){super.isFull()&&this.expand(),super.unshift(e)}expand(){const e=2*this.capacity,t=new Array(e),n=this.length();for(let r=0;r<n;r++)t[r]=this.get(this.wrap(this.begin+r));this.data=t,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}}function EU(e){return new AU(e)}function _U(e,t){return new WU(e,t)}CU.INITIAL_CAPACITY=32;class IU{async toArray(){const e=[];let t=await this.next();for(;!t.done;)e.push(t.value),t=await this.next();return e}async toArrayForTest(){const e=this.prefetch(100),t=[];let n=await e.next();for(;!n.done;)t.push(n.value),n=await e.next();return t}async resolveFully(){let e=await this.next();for(;!e.done;)e=await this.next()}async resolveWhile(e){let t=await this.next(),n=e(t.value);for(;!t.done&&n;)t=await this.next(),n=e(t.value)}handleErrors(e){return new MU(this,e)}filter(e){return new LU(this,e)}map(e){return new PU(this,e)}mapAsync(e){return new jU(this,e)}serialMapAsync(e){return new jU(this,e).serial()}flatmap(e){return new zU(this,e)}async forEachAsync(e){return this.map(e).resolveFully()}async serialForEach(e){return this.serialMapAsync(e).resolveWhile(e=>!0===e)}rowMajorBatch(e){return new OU(this,e,!(arguments.length>1&&void 0!==arguments[1])||arguments[1])}columnMajorBatch(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:yU;return this.rowMajorBatch(e,t).map(e=>bU(e,n))}concatenate(e,t){return new WU(new TU([this,e]),t)}take(e){return e<0||null==e?this:new FU(this,e)}skip(e){return e<0||null==e?this:new DU(this,e)}prefetch(e){return new VU(this,e)}shuffle(e,t){return new HU(this,e,t)}serial(){return new RU(this)}}class TU extends IU{constructor(e){super(),this.items=e,this.trav=0}summary(){return"Array of ".concat(this.items.length," items")}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};const e=this.items[this.trav];return this.trav++,{value:kU(e),done:!1}}}class AU extends IU{constructor(e){super(),this.nextFn=e}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(ci){throw ci.message="Error thrown while iterating through a dataset: ".concat(ci.message),ci}}}class RU extends IU{constructor(e){super(),this.upstream=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> Serial")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){return this.upstream.next()}}class DU extends IU{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> Skip")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){const e=await this.upstream.next();if(e.done)return e;x_(e.value)}return this.upstream.next()}}class FU extends IU{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0}summary(){return"".concat(this.upstream.summary()," -> Take")}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}}class OU extends IU{constructor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(),this.upstream=e,this.batchSize=t,this.enableSmallLastBatch=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> RowMajorBatch")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){const e=[];for(;e.length<this.batchSize;){const t=await this.upstream.next();if(t.done)return this.enableSmallLastBatch&&e.length>0?{value:e,done:!1}:{value:null,done:!0};e.push(t.value)}return{value:e,done:!1}}}class LU extends IU{constructor(e,t){super(),this.upstream=e,this.predicate=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> Filter")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;){const e=await this.upstream.next();if(e.done||this.predicate(e.value))return e;x_(e.value)}}}class PU extends IU{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return"".concat(this.upstream.summary()," -> Map")}async next(){const e=await this.upstream.next();if(e.done)return{value:null,done:!0};const t=XE(e.value),n=this.transform(e.value),r=XE(n);for(const a of t)KE(a,r)||a.dispose();return{value:n,done:!1}}}class MU extends IU{constructor(e,t){super(),this.upstream=e,this.handler=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> handleErrors")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(ci){if(!this.handler(ci))return{value:null,done:!0}}}}class jU extends IU{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return"".concat(this.upstream.summary()," -> AsyncMap")}async next(){const e=await this.upstream.next();if(e.done)return{value:null,done:!0};const t=XE(e.value),n=await this.transform(e.value),r=XE(n);for(const a of t)KE(a,r)||a.dispose();return{value:n,done:!1}}}class BU extends IU{constructor(){super(),this.outputQueue=new CU,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;0===this.outputQueue.length();)if(!await this.pump())return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}}class zU extends BU{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return"".concat(this.upstream.summary()," -> Flatmap")}async pump(){const e=await this.upstream.next();if(e.done)return!1;const t=XE(e.value),n=this.transform(e.value),r=XE(n);this.outputQueue.pushAll(n);for(const a of t)KE(a,r)||a.dispose();return!0}}class WU extends IU{constructor(e,t){super(),this.baseErrorHandler=t,this.lastRead=null,this.iterator=null,this.moreIterators=e}summary(){return"".concat("TODO: fill in upstream of chained summaries"," -> Chained")}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(e){if(await e,null==this.iterator){const e=await this.moreIterators.next();if(e.done)return{value:null,done:!0};this.iterator=e.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}const t=await this.iterator.next();return t.done?(this.iterator=null,this.readFromChain(e)):t}}var UU;!function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"}(UU||(UU={}));class VU extends IU{constructor(e,t){super(),this.upstream=e,this.bufferSize=t,this.buffer=new SU(t)}summary(){return"".concat(this.upstream.summary()," -> Prefetch")}refill(){for(;!this.buffer.isFull();){const e=this.upstream.next();this.buffer.push(e)}}next(){return this.refill(),this.buffer.shift()}}class HU extends VU{constructor(e,t,n){super(e,t),this.upstream=e,this.windowSize=t,this.upstreamExhausted=!1,this.random=UA.alea(n||mE().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}randomInt(e){return Math.floor(this.random()*e)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){const e=this.chooseIndex(),t=await this.buffer.shuffleExcise(e);if(!t.done)return this.refill(),t;this.upstreamExhausted=!0}return{value:null,done:!0}}}class GU{constructor(){this.size=null}batch(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this;let r;return Kw(e>0,()=>"batchSize needs to be positive, but it is\n      ".concat(e)),r=this.size===1/0||null==this.size?this.size:t?Math.ceil(this.size/e):Math.floor(this.size/e),qU(async()=>(await n.iterator()).columnMajorBatch(e,t,KU),r)}concatenate(e){const t=this;let n;return n=this.size===1/0||e.size===1/0?1/0:null!=this.size&&null!=e.size?this.size+e.size:null,qU(async()=>(await t.iterator()).concatenate(await e.iterator()),n)}filter(e){const t=this;let n;return n=this.size===1/0?1/0:null,qU(async()=>(await t.iterator()).filter(t=>b_(()=>e(t))),n)}async forEachAsync(e){return(await this.iterator()).forEachAsync(e)}map(e){const t=this;return qU(async()=>(await t.iterator()).map(t=>b_(()=>e(t))),this.size)}mapAsync(e){const t=this;return qU(async()=>(await t.iterator()).mapAsync(e),this.size)}prefetch(e){if(null==e)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");const t=this;return qU(async()=>(await t.iterator()).prefetch(e),this.size)}repeat(e){const t=this;let n;return n=null!=this.size&&e>0?this.size*e:0===e?0:null!=this.size&&(void 0===e||e<0)?1/0:null,qU(async()=>_U(EU(async()=>({value:await t.iterator(),done:!1})).take(e)),n)}skip(e){const t=this;let n;return n=null!=this.size&&e>=0&&this.size>=e?this.size-e:null!=this.size&&(this.size<e||void 0===e||e<0)?0:null,qU(async()=>(await t.iterator()).skip(e),n)}shuffle(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(null==e||e<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting "+"bufferSize to the dataset size (".concat(this.size," elements)"));const r=this,a=UA.alea(t||mE().toString());return qU(async()=>{let t=a.int32();return n&&(t+=a.int32()),(await r.iterator()).shuffle(e,t.toString())},this.size)}take(e){const t=this;let n;return n=null!=this.size&&this.size>e?e:null!=this.size&&this.size<=e?this.size:null,qU(async()=>(await t.iterator()).take(e),n)}async toArray(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}}function qU(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new class extends GU{constructor(){super(...arguments),this.size=t}async iterator(){return e()}}}function KU(e){if(null===e)return null;const t=e[0];if(null==(n=t)||function(e){return null===e||"object"!==typeof e&&"function"!==typeof e}(n)||Array.isArray(n)||"object"===typeof n&&n instanceof FE||xE(n)){return{value:function(e){if(0===e.length)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof FE?lR(e):p_(e)}(e),recurse:!1}}var n;return{value:null,recurse:!0}}GU.MAX_BUFFER_SIZE=1e4;Symbol("out"),Symbol("field"),Symbol("quote"),Symbol("quoteafterquote"),Symbol("quoteinquote");function XU(e,t){Array.isArray(e)||(e=[e]),e.forEach(e=>{null!=e&&Kw("complex64"!==e.dtype,()=>"".concat(t," does not support complex64 tensors in the CPU backend."))})}const YU=DF;class $U extends Ww{nextDataId(){return $U.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new zw(this,m_())}write(e,t,n){this.firstUse&&(this.firstUse=!1,_k().get("IS_NODE")&&VC("\n============================\nHi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. \n============================"));const r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:n,refCount:1}),r}makeTensorInfo(e,t,n){let r;if("string"===t&&null!=n&&n.length>0&&ck(n[0])){const a=n.map(e=>vE(e));r=this.write(a,e,t)}else r=this.write(n,e,t);return{dataId:r,shape:e,dtype:t}}refCount(e){if(this.data.has(e)){return this.data.get(e).refCount}return 0}incRef(e){this.data.get(e).refCount++}decRef(e){if(this.data.has(e)){this.data.get(e).refCount--}}move(e,t,n,r,a){this.data.set(e,{values:t,dtype:r,refCount:a})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:t,complexTensorInfos:n}=this.data.get(e);if("complex64"===t){return $D(this.readSync(n.real.dataId),this.readSync(n.imag.dataId))}return function(e,t){if(Array.isArray(e))return e;if("float32"===t)return e instanceof Float32Array?e:new Float32Array(e);if("int32"===t)return e instanceof Int32Array?e:new Int32Array(e);if("bool"===t||"string"===t)return Uint8Array.from(new Int32Array(e));throw new Error("Unknown dtype ".concat(t))}(this.data.get(e).values,t)}bufferSync(e){const t=this.readSync(e.dataId);if("string"===e.dtype)try{const n=t.map(e=>bE(e));return iI(e.shape,e.dtype,n)}catch(Gu){throw new Error("Failed to decode encoded string bytes into utf-8")}return iI(e.shape,e.dtype,t)}makeOutput(e,t,n){return m_().makeTensorFromTensorInfo(this.makeTensorInfo(t,n,e),this)}disposeData(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:n}=this.data.get(e);null!=n&&(this.disposeData(n.real.dataId,!0),this.disposeData(n.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const t=mE();e();return{kernelMs:mE()-t}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){XU([e],"where");const t=this.readSync(e.dataId);return YU(e.shape,t)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}$U.nextDataId=0;function JU(e){return(t,n,r)=>{const a=ok(n,t.length);for(let i=0;i<t.length;++i)a[i]=e(t[i],r);return a}}function QU(e,t,n){return ZU(e,JU(t),n)}function ZU(e,t,n){return r=>{let{inputs:a,attrs:i,backend:o}=r;const{x:s}=a;XU(s,e);const l=o,c=l.data.get(s.dataId).values;let u;if("string"===s.dtype){if(!Array.isArray(c))throw new Error("String tensor's value was not an instance of Array");u=AF(c)}else u=c;const h=n||s.dtype,d=t(u,h,i);return l.makeTensorInfo(s.shape,h,d)}}w_("cpu",()=>new $U,1);const eV=QU(AN,e=>e>=0?e:Math.exp(e)-1),tV={kernelName:AN,backendName:"cpu",kernelFunc:eV};function nV(e){const{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const rV={kernelName:KN,backendName:"cpu",kernelFunc:nV};function aV(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{alpha:i}=r;XU([a],"leakyRelu");const o=$w(a.shape),s=n.data.get(a.dataId).values,l=ik("float32",o);for(let c=0;c<s.length;c++)l[c]=s[c]<0?i*s[c]:s[c];return n.makeTensorInfo(a.shape,"float32",l)}const iV={kernelName:ZN,backendName:"cpu",kernelFunc:aV};function oV(e){return(t,n,r,a,i)=>{const o=FI(t,n),s=o.length,l=pk(o),c=ik(i,$w(o)),u=t.length,h=n.length,d=pk(t),f=pk(n),p=RI(t,o),g=RI(n,o);if(p.length+g.length===0)for(let m=0;m<c.length;++m)c[m]=e(r[m%r.length],a[m%a.length]);else for(let m=0;m<c.length;++m){const t=kk(m,s,l),n=t.slice(-u);p.forEach(e=>n[e]=0);const i=wk(n,u,d),o=t.slice(-h);g.forEach(e=>o[e]=0);const v=wk(o,h,f);c[m]=e(r[i],a[v])}return[c,o]}}const sV=oV((e,t)=>e<0?t*e:e);function lV(e){const{inputs:t,backend:n}=e,{x:r,alpha:a}=t;XU([r,a],"prelu");const i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,[s,l]=sV(r.shape,a.shape,i,o,"float32");return n.makeTensorInfo(l,"float32",s)}const cV={kernelName:OS,backendName:"cpu",kernelFunc:lV},uV=QU(US,e=>Math.max(0,e)),hV={kernelName:US,backendName:"cpu",kernelFunc:uV},dV=QU(XS,e=>Math.min(Math.max(0,e),6)),fV={kernelName:XS,backendName:"cpu",kernelFunc:dV},pV=JU(e=>1/(1+Math.exp(-e))),gV=QU(sC,e=>1/(1+Math.exp(-e))),mV={kernelName:sC,backendName:"cpu",kernelFunc:gV};function vV(e,t,n,r,a){if("linear"===n)return nV({inputs:{x:t},backend:e});if("relu"===n)return uV({inputs:{x:t},backend:e});if("elu"===n)return eV({inputs:{x:t},backend:e});if("relu6"===n)return dV({inputs:{x:t},backend:e});if("prelu"===n)return lV({inputs:{x:t,alpha:r},backend:e});if("leakyrelu"===n)return aV({inputs:{x:t},backend:e,attrs:{alpha:a}});if("sigmoid"===n)return gV({inputs:{x:t},backend:e});throw new Error("Activation ".concat(n," has not been implemented for the CPU backend."))}function bV(e){const{inputs:t,backend:n}=e,{real:r,imag:a}=t,i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,s=n.makeTensorInfo(r.shape,"complex64");return n.data.get(s.dataId).complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",i),imag:n.makeTensorInfo(a.shape,"float32",o)},s}const xV={kernelName:aN,backendName:"cpu",kernelFunc:bV};function yV(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"float32";if("complex64"===n){return bV({inputs:{real:yV(e,t,"float32"),imag:yV(e,t,"float32")},backend:e})}const r=bk($w(t),n);return e.makeTensorInfo(t,n,r)}function wV(e){const{inputs:t,backend:n}=e,{input:r}=t,a=n.data.get(r.dataId).complexTensorInfos.real,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}const kV={kernelName:zS,backendName:"cpu",kernelFunc:wV};function NV(e,t,n,r){if("int32"===r){return[t,"int32",Int32Array.from(e)]}if("bool"===r){const r=gE([0],n),[a,i]=oV((e,t)=>e!==t?1:0)(t,[],e,r,"bool");return[i,"bool",a]}throw new Error("Error in Cast: failed to cast ".concat(n," to ").concat(r))}function SV(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{dtype:i}=r;if("complex64"===i){if("complex64"===a.dtype)return nV({inputs:{x:a},backend:n});const e=yV(n,a.shape,a.dtype),t=SV({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),r=bV({inputs:{real:t,imag:e},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),r}if("complex64"===a.dtype){const e=wV({inputs:{input:a},backend:n}),t=SV({inputs:{x:e},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(e),t}if(!sk(a.dtype,i)){const e=nV({inputs:{x:a},backend:n});return{dataId:e.dataId,shape:e.shape,dtype:i}}const o=n.data.get(a.dataId).values,[s,l,c]=NV(o,a.shape,a.dtype,i);return n.makeTensorInfo(s,l,c)}const CV={kernelName:tN,backendName:"cpu",kernelFunc:SV};function EV(e,t,n,r){return null==n?n=>{let{inputs:a,backend:i}=n;const{a:o,b:s}=a,l=i;XU([o,s],e);const c=l.data.get(o.dataId).values,u=l.data.get(s.dataId).values,h="string"===o.dtype?AF(c):c,d="string"===o.dtype?AF(u):u,f=r||o.dtype,[p,g]=t(o.shape,s.shape,h,d,f);return l.makeTensorInfo(g,f,p)}:e=>{let{inputs:a,backend:i}=e;const{a:o,b:s}=a,l=i;if("complex64"===o.dtype||"complex64"===s.dtype){const e=SV({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),t=l.data.get(e.dataId),r=t.complexTensorInfos.real,a=t.complexTensorInfos.imag,i=l.data.get(r.dataId).values,c=l.data.get(a.dataId).values,u=SV({inputs:{x:s},backend:l,attrs:{dtype:"complex64"}}),h=l.data.get(u.dataId),d=h.complexTensorInfos.real,f=h.complexTensorInfos.imag,p=l.data.get(d.dataId).values,g=l.data.get(f.dataId).values,[m,v,b]=n(o.shape,s.shape,i,c,p,g),x=l.makeTensorInfo(b,"float32",m),y=l.makeTensorInfo(b,"float32",v),w=bV({inputs:{real:x,imag:y},backend:l});return l.disposeIntermediateTensorInfo(e),l.disposeIntermediateTensorInfo(u),l.disposeIntermediateTensorInfo(x),l.disposeIntermediateTensorInfo(y),w}{const e=l.data.get(o.dataId).values,n=l.data.get(s.dataId).values,a=r||o.dtype,[i,c]=t(o.shape,s.shape,e,n,a);return l.makeTensorInfo(c,a,i)}}}function _V(e){return(t,n,r,a,i,o)=>{const s=FI(t,n),l=$w(s),c=s.length,u=pk(s),h=ik("float32",l),d=ik("float32",l),f=RI(t,s),p=RI(n,s),g=$D(r,a),m=$D(i,o),v=t.length,b=pk(t),x=n.length,y=pk(n);if(f.length+p.length===0)for(let w=0;w<h.length;w++){const t=w%g.length,n=w%m.length,r=e(g[2*t],g[2*t+1],m[2*n],m[2*n+1]);h[w]=r.real,d[w]=r.imag}else for(let w=0;w<h.length;w++){const t=kk(w,c,u),n=t.slice(-v);f.forEach(e=>n[e]=0);const r=wk(n,v,b),a=t.slice(-x);p.forEach(e=>a[e]=0);const i=wk(a,x,y),o=e(g[2*r],g[2*r+1],m[2*i],m[2*i+1]);h[w]=o.real,d[w]=o.imag}return[h,d,s]}}const IV=oV((e,t)=>e+t),TV=_V((e,t,n,r)=>({real:e+n,imag:t+r})),AV=EV(Lk,IV,TV),RV={kernelName:Lk,backendName:"cpu",kernelFunc:AV};function DV(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{shape:i}=r,o=$w(a.shape),s=nk(i,o),l=$w(s);Kw(o===l,()=>"The new shape (".concat(s,") has ").concat(l," elements and the old ")+"shape (".concat(a.shape,") has ").concat(o," elements. The new shape and old ")+"shape must have the same number of elements."),n.incRef(a.dataId);const c=n.data.get(a.dataId);if(null!=c.complexTensorInfos){const e=c.complexTensorInfos.real,t=c.complexTensorInfos.imag;e.shape=s,t.shape=s}return{dataId:a.dataId,shape:s,dtype:a.dtype}}const FV={kernelName:VS,backendName:"cpu",kernelFunc:DV};function OV(e){const{inputs:t,backend:n,attrs:r}=e,{a:a,b:i}=t,{transposeA:o,transposeB:s}=r;XU([a,i],"matMul");const l=a.shape.length,c=i.shape.length,u=o?a.shape[l-2]:a.shape[l-1],h=s?i.shape[c-1]:i.shape[c-2],d=o?a.shape[l-1]:a.shape[l-2],f=s?i.shape[c-2]:i.shape[c-1],p=a.shape.slice(0,-2),g=i.shape.slice(0,-2),m=$w(p),v=$w(g),b=FI(a.shape.slice(0,-2),i.shape.slice(0,-2)).concat([d,f]);Kw(u===h,()=>"Error in matMul: inner shapes (".concat(u,") and (")+"".concat(h,") of Tensors with shapes ").concat(a.shape," and ")+"".concat(i.shape," and transposeA=").concat(o)+" and transposeB=".concat(s," must match."));const x=s?[v,f,h]:[v,h,f],y=DV({inputs:{x:a},backend:n,attrs:{shape:o?[m,u,d]:[m,d,u]}}),w=DV({inputs:{x:i},backend:n,attrs:{shape:x}}),k=o?y.shape[1]:y.shape[2],N=o?y.shape[2]:y.shape[1],S=s?w.shape[1]:w.shape[2],C=Math.max(m,v),E=n.data.get(y.dataId).values,_=n.data.get(w.dataId).values,I=pk(y.shape),T=pk(w.shape),[A,R,D]=o?[I[0],1,I[1]]:[I[0],I[1],1],[F,O,L]=s?[1,T[1],T[0]]:[T[1],1,T[0]],P=N*S,M=iI([C,N,S],y.dtype),j=M.values,B=n.blockSize;for(let z=0;z<C;z++){const e=z%m,t=z%v;for(let n=0;n<N;n+=B){const r=Math.min(n+B,N);for(let a=0;a<S;a+=B){const i=Math.min(a+B,S);for(let o=0;o<k;o+=B){const s=Math.min(o+B,k);for(let l=n;l<r;l++)for(let n=a;n<i;n++){let r=0;for(let a=o;a<s;a++){r+=E[e*A+l*R+a*D]*_[a*F+n*O+t*L]}j[z*P+(l*S+n)]+=r}}}}}return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(w),n.makeTensorInfo(b,M.dtype,M.values)}const LV={kernelName:$k,backendName:"cpu",kernelFunc:OV};const PV={kernelName:zC,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{a:a,b:i,bias:o,preluActivationWeights:s}=t,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:h}=r;let d,f,p;const g=[];d=OV({inputs:{a:a,b:i},attrs:{transposeA:l,transposeB:c},backend:n}),o&&(f=AV({inputs:{a:d,b:o},backend:n}),g.push(d),d=f),u&&(p=vV(n,d,u,s,h),g.push(d),d=p);for(const m of g)n.disposeIntermediateTensorInfo(m);return d}};function MV(e){const t=new Float32Array(e.length);for(let n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}const jV={kernelName:Dk,backendName:"cpu",kernelFunc:e=>{const{x:t}=e.inputs,n=e.backend;XU(t,"abs");let r=new Float32Array($w(t.shape));return r=MV(n.data.get(t.dataId).values),n.makeOutput(r,t.shape,t.dtype)}},BV=QU(Fk,e=>Math.acos(e)),zV={kernelName:Fk,backendName:"cpu",kernelFunc:BV},WV=QU(Ok,e=>Math.acosh(e)),UV={kernelName:Ok,backendName:"cpu",kernelFunc:WV};const VV={kernelName:Pk,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,r=t;XU(t,"addN");const a=r.map(e=>n.data.get(e.dataId).values),i=iI(r[0].shape,r[0].dtype),o=i.values;for(let s=0;s<r.length;s++){const e=a[s];for(let t=0;t<o.length;t++)o[t]+=e[t]}return n.makeTensorInfo(i.shape,i.dtype,i.values)}};function HV(e,t,n,r,a){const i=t.length,o=$w(t),s=pk(t),l=pk(a),c=ik(n,$w(a));for(let u=0;u<o;++u){const t=kk(u,i,s),n=new Array(t.length);for(let e=0;e<n.length;e++)n[e]=t[r[e]];c[wk(n,i,l)]=e[u]}return c}function GV(e){const{inputs:t,attrs:n,backend:r}=e,{x:a}=t,{perm:i}=n;XU(a,"transpose");const o=a.shape.length,s=new Array(o);for(let c=0;c<s.length;c++)s[c]=a.shape[i[c]];const l=HV(r.data.get(a.dataId).values,a.shape,a.dtype,i,s);return{dataId:r.write(l,s,a.dtype),shape:s,dtype:a.dtype}}const qV={kernelName:DC,backendName:"cpu",kernelFunc:GV};const KV={kernelName:Mk,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:o}=r;XU(a,"all");const s=rk(i,a.shape);let l=s;const c=kA(l,a.shape.length);let u=a;null!=c&&(u=GV({inputs:{x:a},backend:n,attrs:{perm:c}}),l=SA(l.length,a.shape.length)),wA("all",l,u.shape.length);const[h,d]=xA(u.shape,l),f=$w(d),p=bk($w(h),u.dtype),g=n.data.get(u.dataId).values;for(let v=0;v<p.length;++v){const e=v*f;let t=g[e];for(let n=0;n<f;++n){const r=g[e+n];t=t&&r}p[v]=t}null!=c&&n.disposeIntermediateTensorInfo(u);const m=n.makeTensorInfo(h,u.dtype,p);if(o){const e=DV({inputs:{x:m},backend:n,attrs:{shape:yA(h,s)}});return n.disposeIntermediateTensorInfo(m),e}return m}};const XV={kernelName:jk,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:o}=r;XU(a,"any");const s=rk(i,a.shape);let l=s;const c=kA(l,a.shape.length);let u=a;null!=c&&(u=GV({inputs:{x:a},backend:n,attrs:{perm:c}}),l=SA(l.length,a.shape.length)),wA("any",l,u.shape.length);const[h,d]=xA(u.shape,l),f=$w(d),p=bk($w(h),u.dtype),g=n.data.get(u.dataId).values;for(let v=0;v<p.length;++v){const e=v*f;let t=g[e];for(let n=0;n<f;++n){const r=g[e+n];t=t||r}p[v]=t}null!=c&&n.disposeIntermediateTensorInfo(u);const m=n.makeTensorInfo(h,u.dtype,p);if(o){const e=DV({inputs:{x:m},backend:n,attrs:{shape:yA(h,s)}});return n.disposeIntermediateTensorInfo(m),e}return m}};const YV={kernelName:Bk,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i}=r;XU(a,"argMax");let o=rk(i,a.shape);const s=kA(o,a.shape.length);let l=a;const c=[];null!=s&&(l=GV({inputs:{x:a},backend:n,attrs:{perm:s}}),c.push(l),o=SA(o.length,l.shape.length)),o=[o[0]],wA("argMax",o,l.shape.length);const[u,h]=xA(l.shape,o),d=bk($w(u),"int32"),f=$w(h),p=n.data.get(l.dataId).values;for(let g=0;g<d.length;++g){const e=g*f;let t=p[e],n=0;for(let r=0;r<f;++r){const a=p[e+r];a>t&&(t=a,n=r)}d[g]=n}return c.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.makeTensorInfo(u,"int32",d)}};const $V={kernelName:zk,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i}=r;XU(a,"argMin");let o=rk(i,a.shape);const s=kA(o,a.shape.length);let l=a;const c=[];null!=s&&(l=GV({inputs:{x:a},backend:n,attrs:{perm:s}}),c.push(l),o=SA(o.length,l.shape.length)),o=[o[0]],wA("argMin",o,l.shape.length);const[u,h]=xA(l.shape,o),d=bk($w(u),"int32"),f=$w(h),p=n.data.get(l.dataId).values;for(let g=0;g<d.length;++g){const e=g*f;let t=p[e],n=0;for(let r=0;r<f;++r){const a=p[e+r];a<t&&(t=a,n=r)}d[g]=n}return c.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.makeTensorInfo(u,"int32",d)}},JV=QU(Wk,e=>Math.asin(e)),QV={kernelName:Wk,backendName:"cpu",kernelFunc:JV},ZV=QU(Uk,e=>Math.asinh(e)),eH={kernelName:Uk,backendName:"cpu",kernelFunc:ZV},tH=QU(Vk,e=>Math.atan(e)),nH={kernelName:Vk,backendName:"cpu",kernelFunc:tH},rH=oV((e,t)=>Math.atan2(e,t)),aH=EV(Gk,rH),iH={kernelName:Gk,backendName:"cpu",kernelFunc:aH},oH=QU(Hk,e=>Math.atanh(e)),sH={kernelName:Hk,backendName:"cpu",kernelFunc:oH};function lH(e,t,n,r,a,i){const o=a.strideHeight,s=a.strideWidth,l=a.dilationHeight,c=a.dilationWidth,u=a.effectiveFilterHeight,h=a.effectiveFilterWidth,d=a.padInfo.top,f=a.padInfo.left,p="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=iI(a.outShape,n),m=g.values,v=a.outShape[1]*a.outShape[2]*a.outShape[3],b=a.outShape[2]*a.outShape[3],x=a.outShape[3];for(let y=0;y<a.batchSize;++y){const t=y*v,n=y*r[0];for(let g=0;g<a.inChannels;++g)for(let v=0;v<a.outHeight;++v){const y=v*o-d,w=Math.max(0,y),k=Math.min(a.inHeight,u+y),N=t+v*b;for(let t=0;t<a.outWidth;++t){const o=t*s-f,u=Math.max(0,o),d=Math.min(a.inWidth,h+o);let v=p,b=0,y=0;for(let t=w;t<k;t+=l){const a=n+t*r[1];for(let t=u;t<d;t+=c){const n=e[a+t*r[2]+g];"max"===i&&n>v?v=n:"avg"===i&&(b+=n,y++)}if(isNaN(v))break}m[N+t*x+g]="avg"===i?b/y:v}}}return g}function cH(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const o=iI(r.outShape,"int32"),s=r.strideHeight,l=r.strideWidth,c=r.dilationHeight,u=r.dilationWidth,h=r.effectiveFilterHeight,d=r.effectiveFilterWidth,f=r.padInfo.top,p=r.padInfo.left,g=iI(t,n,e);for(let m=0;m<r.batchSize;++m)for(let e=0;e<r.inChannels;++e)for(let t=0;t<r.outHeight;++t){const n=t*s-f;let v=n;for(;v<0;)v+=c;const b=Math.min(r.inHeight,h+n);for(let s=0;s<r.outWidth;++s){const h=s*l-p;let f=h;for(;f<0;)f+=u;const x=Math.min(r.inWidth,d+h);let y=Number.NEGATIVE_INFINITY,w=-1;for(let t=v;t<b;t+=c){const o=t-n;for(let n=f;n<x;n+=u){const s=n-h,l=g.get(m,t,n,e);l>y&&(y=l,w=a?i?((m*r.inHeight+t)*r.inWidth+n)*r.inChannels+e:(t*r.inWidth+n)*r.inChannels+e:o*d+s)}}o.set(w,m,t,s,e)}}return o}function uH(e,t,n,r,a,i){const o=a.strideDepth,s=a.strideHeight,l=a.strideWidth,c=a.dilationDepth,u=a.dilationHeight,h=a.dilationWidth,d=a.effectiveFilterDepth,f=a.effectiveFilterHeight,p=a.effectiveFilterWidth,g=a.padInfo.front,m=a.padInfo.top,v=a.padInfo.left,b="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,x=iI(a.outShape,n),y=x.values,w=a.outShape[1]*a.outShape[2]*a.outShape[3]*a.outShape[4],k=a.outShape[2]*a.outShape[3]*a.outShape[4],N=a.outShape[3]*a.outShape[4],S=a.outShape[4];for(let C=0;C<a.batchSize;++C){const t=C*w,n=C*r[0];for(let x=0;x<a.inChannels;++x)for(let w=0;w<a.outDepth;++w){const C=w*o-g;let E=C;for(;E<0;)E+=c;const _=Math.min(a.inDepth,d+C),I=t+w*k;for(let t=0;t<a.outHeight;++t){const o=t*s-m;let d=o;for(;d<0;)d+=u;const g=Math.min(a.inHeight,f+o),w=I+t*N;for(let t=0;t<a.outWidth;++t){const o=t*l-v;let s=o;for(;s<0;)s+=h;const f=Math.min(a.inWidth,p+o),m=w+t*S;let k=b,N=0,C=0;for(let t=E;t<_;t+=c){const a=n+t*r[1];for(let t=d;t<g;t+=u){const n=a+t*r[2];for(let t=s;t<f;t+=h){const a=e[n+t*r[3]+x];if("max"===i&&a>k?k=a:"avg"===i&&(N+=a,C++),isNaN(k))break}if(isNaN(k))break}if(isNaN(k))break}y[m+x]="avg"===i?N/Math.max(C,1):k}}}}return x}const hH={kernelName:qk,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t;XU(a,"avgPool");const{filterSize:i,strides:o,pad:s,dimRoundingMode:l}=r;Kw(_T(o,1),()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'"));const c=vT(a.shape,i,o,1,s,l);let u;if(1===c.filterWidth&&1===c.filterHeight&&Jw(c.inShape,c.outShape))u=nV({inputs:{x:a},backend:n});else{const e=n.data.get(a.dataId).values,t=pk(a.shape),r=lH(e,a.shape,a.dtype,t,c,"avg");u=n.makeTensorInfo(c.outShape,a.dtype,r.values)}return u}};const dH={kernelName:Xk,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:i,strides:o,pad:s,dimRoundingMode:l,dataFormat:c}=r;XU(a,"avgPool3d");const u=bT(a.shape,i,o,1,s,l,c),h=uH(n.data.get(a.dataId).values,a.shape,a.dtype,pk(a.shape),u,"avg");return n.makeTensorInfo(h.shape,"float32",h.values)}};const fH={kernelName:Yk,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,{filterSize:o,strides:s,pad:l,dimRoundingMode:c}=r;XU([a,i],"avgPool3DGrad");const u=bT(i.shape,o,s,1,l,c),h=u.strideDepth,d=u.strideHeight,f=u.strideWidth,p=u.filterDepth,g=u.filterHeight,m=u.filterWidth,v=u.dilationDepth,b=u.dilationHeight,x=u.dilationWidth,y=u.effectiveFilterDepth,w=u.effectiveFilterHeight,k=u.effectiveFilterWidth,N=y-1-u.padInfo.front,S=k-1-u.padInfo.left,C=w-1-u.padInfo.top,E=iI(i.shape,"float32"),_=1/(p*g*m),I=n.bufferSync(a);for(let T=0;T<u.batchSize;++T)for(let e=0;e<u.inChannels;++e)for(let t=0;t<u.inDepth;++t)for(let n=0;n<u.inHeight;++n)for(let r=0;r<u.inWidth;++r){const a=t-N,i=n-C,o=r-S;let s=0;for(let t=0;t<y;t+=v){const n=(a+t)/h;if(!(n<0||n>=u.outDepth||Math.floor(n)!==n))for(let t=0;t<w;t+=b){const r=(i+t)/d;if(!(r<0||r>=u.outHeight||Math.floor(r)!==r))for(let t=0;t<k;t+=x){const a=(o+t)/f;if(a<0||a>=u.outWidth||Math.floor(a)!==a)continue;s+=I.get(T,n,r,a,e)}}}E.set(s*_,T,t,n,r,e)}return n.makeTensorInfo(E.shape,E.dtype,E.values)}};const pH={kernelName:Kk,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,o=i;XU([a,i],"avgPoolGrad");const{filterSize:s,strides:l,pad:c}=r,u=vT(o.shape,s,l,1,c),h=u.strideHeight,d=u.strideWidth,f=u.filterHeight,p=u.filterWidth,g=u.dilationHeight,m=u.dilationWidth,v=u.effectiveFilterHeight,b=u.effectiveFilterWidth,x=b-1-u.padInfo.left,y=v-1-u.padInfo.top,w=iI(o.shape,"float32"),k=1/(f*p),N=n.data.get(a.dataId).values,S=iI(a.shape,"float32",N);for(let C=0;C<u.batchSize;++C)for(let e=0;e<u.inChannels;++e)for(let t=0;t<u.inHeight;++t)for(let n=0;n<u.inWidth;++n){const r=t-y,a=n-x;let i=0;for(let t=0;t<v;t+=g){const n=(r+t)/h;if(!(n<0||n>=u.outHeight||Math.floor(n)!==n))for(let t=0;t<b;t+=m){const r=(a+t)/d;if(r<0||r>=u.outWidth||Math.floor(r)!==r)continue;i+=S.get(C,n,r,e)}}w.set(i*k,C,t,n,e)}return n.makeTensorInfo(w.shape,w.dtype,w.values)}};const gH={kernelName:UN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,scale:i,offset:o,mean:s,variance:l}=t;Kw(s.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),Kw(null==o||s.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),Kw(null==i||s.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),XU([a,s,l,i,o],"batchNorm");let{varianceEpsilon:c}=r;null==c&&(c=.001);const u=n.data.get(a.dataId).values,h=n.data.get(s.dataId).values,d=n.data.get(l.dataId).values,f=i?n.data.get(i.dataId).values:new Float32Array([1]),p=o?n.data.get(o.dataId).values:new Float32Array([0]),g=new Float32Array(u.length),m=p.length,v=f.length,b=d.length,x=h.length;let y=0,w=0,k=0,N=0;for(let S=0;S<u.length;++S)g[S]=p[y++]+(u[S]-h[w++])*f[k++]/Math.sqrt(d[N++]+c),y>=m&&(y=0),w>=x&&(w=0),k>=v&&(k=0),N>=b&&(N=0);return n.makeTensorInfo(a.shape,a.dtype,g)}};function mH(e,t,n,r,a){const i=lT(r,t,n),o=$w(n),s=pk(r);if(i){const n=cT(t,s);return"string"===a?e.slice(n,n+o):e.subarray(n,n+o)}const l=iI(r,a,"string"===a?AF(e):e),c=iI(n,a);for(let u=0;u<c.size;++u){const e=c.indexToLoc(u),n=e.map((e,n)=>e+t[n]);c.set(l.get(...n),...e)}return"string"===a?RF(c.values):c.values}function vH(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{begin:i,size:o}=r;XU(a,"slice");const[s,l]=uT(a,i,o);$I(a,s,l);const c=mH(n.data.get(a.dataId).values,s,l,a.shape,a.dtype);return n.makeTensorInfo(l,a.dtype,c)}const bH={kernelName:rC,backendName:"cpu",kernelFunc:vH};const xH={kernelName:Jk,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:i,crops:o}=r;XU([a],"batchToSpaceND");const s=i.reduce((e,t)=>e*t),l=FD(a.shape,i,s),c=OD(l.length,i.length),u=LD(a.shape,i,s),h=PD(o,i.length),d=MD(u,o,i.length),f=DV({inputs:{x:a},backend:n,attrs:{shape:l}}),p=GV({inputs:{x:f},backend:n,attrs:{perm:c}}),g=DV({inputs:{x:p},backend:n,attrs:{shape:u}}),m=vH({inputs:{x:g},backend:n,attrs:{begin:h,size:d}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),m}};function yH(e,t,n,r,a){const i=$w(r),o=bk(a,n);for(let s=0;s<e.length;s++){const n=e[s];if(n<0)throw new Error("Input x must be non-negative!");n>=a||(o[n]+=i>0?t[s]:1)}return o}function wH(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=e.shape[0],i=e.shape[1],o=iI([a,n],t.dtype);for(let s=0;s<a;s++)for(let a=0;a<i;a++){const i=e.get(s,a);if(i<0)throw new Error("Input x must be non-negative!");i>=n||(r?o.set(1,s,i):t.size>0?o.set(o.get(s,i)+t.get(s,a),s,i):o.set(o.get(s,i)+1,s,i))}return o}const kH={kernelName:Qk,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,weights:i}=t,{size:o}=r,s=yH(n.data.get(a.dataId).values,n.data.get(i.dataId).values,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,s)}},NH=oV((e,t)=>e&t),SH={kernelName:Zk,backendName:"cpu",kernelFunc:EV(Zk,NH)};const CH={kernelName:eN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{s0:r,s1:a}=t,i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,s=FI(Array.from(i),Array.from(o));return n.makeTensorInfo([s.length],"int32",Int32Array.from(s))}},EH=JU(e=>Math.ceil(e)),_H=ZU(nN,EH),IH={kernelName:nN,backendName:"cpu",kernelFunc:_H},TH=QU(rN,(e,t)=>{const n=t;return e>n.clipValueMax?n.clipValueMax:e<n.clipValueMin?n.clipValueMin:e}),AH={kernelName:rN,backendName:"cpu",kernelFunc:TH},RH={kernelName:iN,backendName:"cpu",kernelFunc:e=>{const{x:t}=e.inputs,n=e.backend,r=new Float32Array($w(t.shape)),a=n.data.get(t.dataId),i=a.complexTensorInfos.real,o=a.complexTensorInfos.imag,s=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values;for(let c=0;c<s.length;c++){const e=s[c],t=l[c];r[c]=Math.hypot(e,t)}return n.makeOutput(r,t.shape,"float32")}};function DH(e,t,n,r){const a=ok(n,$w(t));if(r&&"string"!==n){let t=0;e.forEach(e=>{const n=$w(e.shape);a.set(e.vals,t),t+=n})}else{let r=0;e.forEach(e=>{const i="string"===n?AF(e.vals):e.vals;let o=0;for(let n=0;n<e.shape[0];++n){const s=n*t[1]+r;for(let t=0;t<e.shape[1];++t)a[s+t]=i[o++]}r+=e.shape[1]})}return a}function FH(e){const{inputs:t,backend:n}=e,{input:r}=t,a=n.data.get(r.dataId).complexTensorInfos.imag,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}const OH={kernelName:YN,backendName:"cpu",kernelFunc:FH};function LH(e){const{inputs:t,backend:n,attrs:r}=e,{axis:a}=r,i=rk(a,t[0].shape)[0],o=t.map(e=>e.shape);ND(o,i);let s=SD(t.map(e=>e.shape),i);if(0===$w(s))return n.makeTensorInfo(s,t[0].dtype,[]);const l=t.filter(e=>$w(e.shape)>0);if(1===l.length)return nV({inputs:{x:l[0]},backend:n});if("complex64"===l[0].dtype){const e=l.map(e=>wV({inputs:{input:e},backend:n})),t=l.map(e=>FH({inputs:{input:e},backend:n})),r=LH({inputs:e,backend:n,attrs:{axis:i}}),a=LH({inputs:t,backend:n,attrs:{axis:i}}),o=bV({inputs:{real:r,imag:a},backend:n});return e.forEach(e=>n.disposeIntermediateTensorInfo(e)),t.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(a),o}const c=l.map(e=>{const t=$w(e.shape.slice(i));return DV({inputs:{x:e},backend:n,attrs:{shape:[-1,t]}})}),u=c.map(e=>({vals:n.data.get(e.dataId).values,shape:e.shape}));s=SD(c.map(e=>e.shape),1);const h=1===c[0].shape[0],d=DH(u,s,t[0].dtype,h),f=SD(l.map(e=>e.shape),i),p=n.makeTensorInfo(f,t[0].dtype,d);return c.forEach(e=>n.disposeIntermediateTensorInfo(e)),p}const PH={kernelName:oN,backendName:"cpu",kernelFunc:LH};function MH(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:o,pad:s,dataFormat:l,dilations:c,dimRoundingMode:u}=r;XU([a,i],"conv2d");const h=TT(l),d=xT(a.shape,i.shape,o,c,s,u,!1,h),f=d.filterHeight,p=d.filterWidth,g=d.dilationHeight,m=d.dilationWidth,v=d.padInfo.left,b=d.padInfo.top,x="channelsLast"===d.dataFormat,y=new TE(d.outShape,a.dtype),w=pk(a.shape),k=pk(i.shape),N=w[0],S=x?w[1]:w[2],C=x?w[2]:1,E=x?1:w[1],_=y.strides[0],I=x?y.strides[1]:y.strides[2],T=x?y.strides[2]:1,A=x?1:y.strides[1],R=n.data.get(a.dataId).values,D=n.data.get(i.dataId).values,F=y.values;for(let O=0;O<d.batchSize;++O){const e=O*N,t=O*_;for(let n=0;n<d.outHeight;++n){const r=t+n*I,a=n*d.strideHeight-b;for(let t=0;t<f;++t){const n=a+t*g;if(n<0||n>=d.inHeight)continue;const i=t*k[0],o=e+n*S;for(let e=0;e<d.outWidth;++e){const t=r+e*T,n=e*d.strideWidth-v;for(let e=0;e<p;++e){const r=n+e*m;if(r<0||r>=d.inWidth)continue;const a=o+r*C;let s=i+e*k[1];for(let e=0;e<d.inChannels;++e){const n=R[a+e*E];for(let e=0;e<d.outChannels;++e)F[t+e*A]+=n*D[s+e];s+=d.outChannels}}}}}}return n.makeTensorInfo(y.shape,y.dtype,F)}const jH={kernelName:sN,backendName:"cpu",kernelFunc:MH};const BH={kernelName:lN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:o,pad:s,dataFormat:l,dimRoundingMode:c,filterShape:u}=r;XU([a,i],"conv2dBackpropFilter");const h=TT(l),d=xT(a.shape,u,o,1,s,c,!1,h),{strideHeight:f,strideWidth:p,filterHeight:g,filterWidth:m}=d,v="channelsLast"===d.dataFormat,b=new TE(d.filterShape,"float32"),x=d.padInfo.left,y=d.padInfo.top,w=n.data.get(a.dataId).values,k=n.data.get(i.dataId).values,N=new TE(a.shape,a.dtype,w),S=new TE(i.shape,i.dtype,k);for(let C=0;C<g;++C){const e=Math.max(0,Math.ceil((y-C)/f)),t=Math.min(d.outHeight,(d.inHeight+y-C)/f);for(let n=0;n<m;++n){const r=Math.max(0,Math.ceil((x-n)/p)),a=Math.min(d.outWidth,(d.inWidth+x-n)/p);for(let i=0;i<d.inChannels;++i)for(let o=0;o<d.outChannels;++o){let s=0;for(let l=0;l<d.batchSize;++l)for(let c=e;c<t;++c){const e=C+c*f-y;for(let t=r;t<a;++t){const r=n+t*p-x;s+=v?N.get(l,e,r,i)*S.get(l,c,t,o):N.get(l,i,e,r)*S.get(l,o,c,t)}}b.set(s,C,n,i,o)}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}};const zH={kernelName:cN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{inputShape:o,strides:s,pad:l,dataFormat:c,dimRoundingMode:u}=r;XU([a,i],"conv2dBackpropInput");const h=pk(i.shape),d=pk(a.shape);let f=TT(c);const p=xT(o,i.shape,s,1,l,u,!1,f),g=new TE(p.inShape,"float32"),m=g.values,v=n.data.get(a.dataId).values,b=n.data.get(i.dataId).values,[x,y,w]=h,{batchSize:k,filterHeight:N,filterWidth:S,inChannels:C,inHeight:E,inWidth:_,outChannels:I,outHeight:T,outWidth:A,strideHeight:R,strideWidth:D}=p;f=p.dataFormat;const F=N-1-p.padInfo.top,O=S-1-p.padInfo.left,L="channelsLast"===f,P=g.strides[0],M=L?g.strides[1]:g.strides[2],j=L?g.strides[2]:1,B=L?1:g.strides[1],z=d[0],W=L?d[1]:d[2],U=L?d[2]:1,V=L?1:d[1];for(let H=0;H<k;++H)for(let e=0;e<C;++e)for(let t=0;t<E;++t){const n=t-F,r=Math.max(0,Math.ceil(n/R)),a=Math.min(T,(N+n)/R);for(let i=0;i<_;++i){const o=i-O,s=Math.max(0,Math.ceil(o/D)),l=Math.min(A,(S+o)/D);let c=0;for(let t=r;t<a;++t){const r=t*R-n;for(let n=s;n<l;++n){const a=z*H+W*t+U*n,i=x*(N-1-r)+y*(S-1-(n*D-o))+w*e;for(let e=0;e<I;++e){c+=v[a+V*e]*b[i+e]}}}m[P*H+M*t+j*i+B*e]=c}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}};const WH={kernelName:uN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:o,pad:s,dilations:l}=r;XU([a,i],"conv3d");const c=yT(a.shape,i.shape,o,l,s),{filterDepth:u,filterHeight:h,filterWidth:d,dilationDepth:f,dilationHeight:p,dilationWidth:g,padInfo:m}=c,v=m.front,b=m.left,x=m.top,y=new TE(c.outShape,a.dtype),w=n.data.get(a.dataId).values,k=n.data.get(i.dataId).values,N=y.values,S=pk(a.shape),C=pk(i.shape);for(let E=0;E<c.batchSize;++E){const e=E*S[0],t=E*y.strides[0];for(let n=0;n<c.outDepth;++n){const r=t+n*y.strides[1],a=n*c.strideDepth-v;for(let t=0;t<u;++t){const n=a+t*f;if(n<0||n>=c.inDepth)continue;const i=t*C[0],o=e+n*S[1];for(let e=0;e<c.outHeight;++e){const t=r+e*y.strides[2],n=e*c.strideHeight-x;for(let e=0;e<h;++e){const r=n+e*p;if(r<0||r>=c.inHeight)continue;const a=i+e*C[1],s=o+r*S[2];for(let e=0;e<c.outWidth;++e){const n=t+e*c.outChannels,r=e*c.strideWidth-b;for(let e=0;e<d;++e){const t=r+e*g;if(t<0||t>=c.inWidth)continue;const i=a+e*C[2],o=s+t*c.inChannels;let l=i;for(let e=0;e<c.inChannels;++e){const t=w[o+e];for(let e=0;e<c.outChannels;++e)N[n+e]+=t*k[l+e];l+=c.outChannels}}}}}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}};const UH={kernelName:hN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:o,pad:s,filterShape:l}=r;XU([a,i],"conv3dBackpropFilterV2");const c=pk(a.shape),u=pk(i.shape),h=yT(a.shape,l,o,1,s),d=h.strideDepth,f=h.strideHeight,p=h.strideWidth,g=h.filterDepth,m=h.filterHeight,v=h.filterWidth,b=new TE(h.filterShape,"float32"),x=b.values,[y,w,k,N]=b.strides,S=n.data.get(i.dataId).values,[C,E,_,I]=u,T=n.data.get(a.dataId).values,[A,R,D,F]=c,O=h.padInfo.front,L=h.padInfo.left,P=h.padInfo.top;for(let M=0;M<g;++M){const e=Math.max(0,Math.ceil((O-M)/d)),t=Math.min(h.outDepth,(h.inDepth+O-M)/d),n=M*y;for(let r=0;r<m;++r){const a=Math.max(0,Math.ceil((P-r)/f)),i=Math.min(h.outHeight,(h.inHeight+P-r)/f),o=r*w+n;for(let n=0;n<v;++n){const s=Math.max(0,Math.ceil((L-n)/p)),l=Math.min(h.outWidth,(h.inWidth+L-n)/p),c=n*k+o;for(let o=0;o<h.inChannels;++o){const u=o*N+c;for(let c=0;c<h.outChannels;++c){let g=0;for(let u=0;u<h.batchSize;++u){const h=u*A,m=u*C;for(let u=e;u<t;++u){const e=(M+u*d-O)*R+h,t=u*E+m;for(let u=a;u<i;++u){const a=(r+u*f-P)*D+e,i=u*_+t;for(let e=s;e<l;++e){const t=e*I+i;g+=T[(n+e*p-L)*F+a+o]*S[t+c]}}}}x[u+c]=g}}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}};const VH={kernelName:dN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{pad:o,strides:s,inputShape:l}=r;XU([a],"conv3dBackpropInputV2");const c=pk(a.shape),u=pk(i.shape),h=yT(l,i.shape,s,1,o),d=new TE(h.inShape,"float32"),f=d.values,[p,g,m,v]=d.strides,b=n.data.get(a.dataId).values,[x,y,w,k]=c,N=n.data.get(i.dataId).values,[S,C,E,_]=u,{batchSize:I,filterDepth:T,filterHeight:A,filterWidth:R,inChannels:D,inDepth:F,inHeight:O,inWidth:L,outChannels:P,outDepth:M,outHeight:j,outWidth:B,strideDepth:z,strideHeight:W,strideWidth:U}=h,V=T-1-h.padInfo.front,H=A-1-h.padInfo.top,G=R-1-h.padInfo.left;for(let q=0;q<I;++q)for(let e=0;e<D;++e)for(let t=0;t<F;++t){const n=t-V,r=Math.max(0,Math.ceil(n/z)),a=Math.min(M,(T+n)/z);for(let i=0;i<O;++i){const o=i-H,s=Math.max(0,Math.ceil(o/W)),l=Math.min(j,(A+o)/W);for(let c=0;c<L;++c){const u=c-G,h=Math.max(0,Math.ceil(u/U)),d=Math.min(B,(R+u)/U);let I=0;for(let t=r;t<a;++t){const r=t*z-n;for(let n=s;n<l;++n){const a=n*W-o;for(let i=h;i<d;++i){const o=x*q+y*t+w*n+k*i,s=S*(T-1-r)+C*(A-1-a)+E*(R-1-(i*U-u))+_*e;for(let e=0;e<P;++e){I+=b[o+e]*N[s+e]}}}}f[p*q+g*t+m*i+v*c+e]=I}}}return n.makeTensorInfo(d.shape,d.dtype,d.values)}},HH=QU(fN,e=>Math.cos(e)),GH={kernelName:fN,backendName:"cpu",kernelFunc:HH},qH=QU(pN,e=>Math.cosh(e)),KH={kernelName:pN,backendName:"cpu",kernelFunc:qH};const XH={kernelName:vN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{image:a,boxes:i,boxInd:o}=t,{cropSize:s,method:l,extrapolationValue:c}=r,[u,h,d,f]=a.shape,p=i.shape[0],[g,m]=s,v=iI([p,g,m,f],"float32"),b=n.data.get(i.dataId).values,x=n.data.get(o.dataId).values,y=n.data.get(a.dataId).values,w=pk(a.shape),k=pk(v.shape);for(let N=0;N<p;N++){const e=4*N,t=b[e],n=b[e+1],r=b[e+2],a=b[e+3],i=x[N];if(i>=u)continue;const o=g>1?(r-t)*(h-1)/(g-1):0,s=m>1?(a-n)*(d-1)/(m-1):0;for(let u=0;u<g;u++){const e=g>1?t*(h-1)+u*o:.5*(t+r)*(h-1);if(e<0||e>h-1)for(let t=0;t<m;t++)for(let e=0;e<f;e++){const n=e+t*k[2]+u*k[1]+N*k[0];v.values[n]=c}else if("bilinear"===l){const t=Math.floor(e),r=Math.ceil(e),o=e-t;for(let e=0;e<m;e++){const l=m>1?n*(d-1)+e*s:.5*(n+a)*(d-1);if(l<0||l>d-1){for(let t=0;t<f;t++){const n=t+e*k[2]+u*k[1]+N*k[0];v.values[n]=c}continue}const h=Math.floor(l),p=Math.ceil(l),g=l-h;for(let n=0;n<f;n++){let a=n+h*w[2]+t*w[1]+i*w[0];const s=y[a];a=n+p*w[2]+t*w[1]+i*w[0];const l=y[a];a=n+h*w[2]+r*w[1]+i*w[0];const c=y[a];a=n+p*w[2]+r*w[1]+i*w[0];const d=s+(l-s)*g,f=c+(y[a]-c)*g;a=n+e*k[2]+u*k[1]+N*k[0],v.values[a]=d+(f-d)*o}}}else for(let t=0;t<m;++t){const r=m>1?n*(d-1)+t*s:.5*(n+a)*(d-1);if(r<0||r>d-1){for(let e=0;e<f;e++){const n=e+t*k[2]+u*k[1]+N*k[0];v.values[n]=c}continue}const o=Math.round(r),l=Math.round(e);for(let e=0;e<f;e++){const n=e+o*w[2]+l*w[1]+i*w[0],r=e+t*k[2]+u*k[1]+N*k[0];v.values[r]=y[n]}}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}};const YH={kernelName:gN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,exclusive:o,reverse:s}=r;XU(a,"cumprod");const l=kA([i],a.shape.length);let c=a;null!=l&&(c=GV({inputs:{x:a},backend:n,attrs:{perm:l}}));const u=SA(1,a.shape.length)[0];if(u!==c.shape.length-1)throw new Error("backend.cumprod in CPU expects an inner-most "+"axis=".concat(c.shape.length-1," but got axis=").concat(u));const h=UE(c.dtype,"int32"),d=vk($w(c.shape),h),f=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],g=s?(e,t)=>e+p-t-1:(e,t)=>e+t;for(let v=0;v<f.length;v+=p)for(let e=0;e<p;e++){const t=g(v,e);if(0===e)d[t]=o?1:f[t];else{const n=g(v,e-1);d[t]=o?f[n]*d[n]:f[t]*d[n]}}const m=n.makeTensorInfo(c.shape,h,d);if(null!=l){const e=GV({inputs:{x:m},backend:n,attrs:{perm:NA(l)}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(c),e}return m}};const $H={kernelName:mN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,exclusive:o,reverse:s}=r;XU(a,"cumsum");const l=kA([i],a.shape.length);let c=a;null!=l&&(c=GV({inputs:{x:a},backend:n,attrs:{perm:l}}));const u=SA(1,a.shape.length)[0];if(u!==c.shape.length-1)throw new Error("backend.cumsum in CPU expects an inner-most "+"axis=".concat(c.shape.length-1," but got axis=").concat(u));const h=UE(c.dtype,"int32"),d=bk($w(c.shape),h),f=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],g=s?(e,t)=>e+p-t-1:(e,t)=>e+t;for(let v=0;v<f.length;v+=p)for(let e=0;e<p;e++){const t=g(v,e);if(0===e)d[t]=o?0:f[t];else{const n=g(v,e-1);d[t]=o?f[n]+d[n]:f[t]+d[n]}}const m=n.makeTensorInfo(c.shape,h,d);if(null!=l){const e=GV({inputs:{x:m},backend:n,attrs:{perm:NA(l)}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(c),e}return m}};const JH={kernelName:bN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,weights:i}=t,{size:o,binaryOutput:s}=r;if(1===a.shape.length){const e=yH(n.data.get(a.dataId).values,n.data.get(i.dataId).values,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,e)}if(2===a.shape.length){const e=wH(n.bufferSync(a),n.bufferSync(i),o,s);return n.makeTensorInfo(e.shape,i.dtype,e.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(a.shape.length,"."))}};const QH={kernelName:xN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockSize:i,dataFormat:o}=r;Kw("NHWC"===o,()=>"Only NHWC dataFormat supported on CPU for depthToSpace. Got ".concat(o));const s=a.shape[0],l=a.shape[1],c=a.shape[2],u=a.shape[3],h=l*i,d=c*i,f=u/(i*i),p=n.data.get(a.dataId).values,g=new Float32Array(s*h*d*f);let m=0;for(let v=0;v<s;++v)for(let e=0;e<h;++e){const t=Math.floor(e/i),n=e%i;for(let e=0;e<d;++e){const r=Math.floor(e/i),a=(n*i+e%i)*f;for(let e=0;e<f;++e){const n=e+a+u*(r+c*(t+l*v));g[m++]=p[n]}}}return n.makeTensorInfo([s,h,d,f],a.dtype,g)}};function ZH(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:o,pad:s,dilations:l,dimRoundingMode:c}=r;XU([a,i],"depthwiseConv2DNative");const u=pk(a.shape),h=pk(i.shape);let d=l;null==d&&(d=[1,1]),Kw(_T(o,d),()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(o," and dilations '").concat(d,"'"));const f=xT(a.shape,i.shape,o,d,s,c,!0),{filterHeight:p,filterWidth:g,dilationHeight:m,dilationWidth:v,padInfo:b}=f,x=b.left,y=b.top,w=f.outChannels/f.inChannels,k=new TE(f.outShape,a.dtype),N=n.data.get(a.dataId).values,S=n.data.get(i.dataId).values,C=k.values;for(let E=0;E<f.batchSize;++E){const e=E*u[0],t=E*k.strides[0];for(let n=0;n<f.outHeight;++n){const r=t+n*k.strides[1],a=n*f.strideHeight-y;for(let t=0;t<p;++t){const n=a+t*m;if(n<0||n>=f.inHeight)continue;const i=t*h[0],o=e+n*u[1];for(let e=0;e<f.outWidth;++e){const t=r+e*k.strides[2],n=e*f.strideWidth-x;for(let e=0;e<g;++e){const r=n+e*v;if(r<0||r>=f.inWidth)continue;const a=i+e*h[1],s=o+r*f.inChannels;let l=t,c=a;for(let e=0;e<f.inChannels;++e){const t=N[s+e];for(let e=0;e<w;++e)C[l+e]+=t*S[c+e];l+=w,c+=w}}}}}}return n.makeTensorInfo(k.shape,k.dtype,k.values)}const eG={kernelName:yN,backendName:"cpu",kernelFunc:ZH};const tG={kernelName:wN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:o,dilations:s,pad:l,dimRoundingMode:c,filterShape:u}=r;XU([a,i],"depthwiseConv2dNativeBackpropFilter");const h=xT(a.shape,u,o,s,l,c,!0),{strideHeight:d,strideWidth:f,filterHeight:p,filterWidth:g}=h,m=new TE(h.filterShape,"float32"),v=h.padInfo.left,b=h.padInfo.top,x=h.outChannels/h.inChannels,y=n.data.get(a.dataId).values,w=new TE(a.shape,a.dtype,y),k=n.data.get(i.dataId).values,N=new TE(i.shape,i.dtype,k);for(let S=0;S<p;++S){const e=Math.max(0,Math.ceil((b-S)/d)),t=Math.min(h.outHeight,(h.inHeight+b-S)/d);for(let n=0;n<g;++n){const r=Math.max(0,Math.ceil((v-n)/f)),a=Math.min(h.outWidth,(h.inWidth+v-n)/f);for(let i=0;i<h.outChannels;++i){const o=Math.trunc(i/x),s=i%x;let l=0;for(let c=0;c<h.batchSize;++c)for(let s=e;s<t;++s){const e=S+s*d-b;for(let t=r;t<a;++t){const r=n+t*f-v;l+=w.get(c,e,r,o)*N.get(c,s,t,i)}}m.set(l,S,n,o,s)}}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}};const nG={kernelName:kN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{strides:o,dilations:s,pad:l,dimRoundingMode:c,inputShape:u}=r;XU([a,i],"depthwiseConv2DNativeBackpropInput");const h=pk(a.shape),d=pk(i.shape),f=xT(u,i.shape,o,s,l,c,!0),p=new TE(f.inShape,"float32"),g=p.values,[m,v,b]=p.strides,x=n.data.get(a.dataId).values,[y,w,k]=h,N=n.data.get(i.dataId).values,[S,C,E]=d,{batchSize:_,filterHeight:I,filterWidth:T,inChannels:A,inHeight:R,inWidth:D,outChannels:F,outHeight:O,outWidth:L,strideHeight:P,strideWidth:M}=f,j=I-1-f.padInfo.top,B=T-1-f.padInfo.left,z=F/A;for(let W=0;W<_;++W)for(let e=0;e<A;++e)for(let t=0;t<R;++t){const n=t-j,r=Math.max(0,Math.ceil(n/P)),a=Math.min(O,(I+n)/P);for(let i=0;i<D;++i){const o=i-B,s=Math.max(0,Math.ceil(o/M)),l=Math.min(L,(T+o)/M);let c=0;for(let t=r;t<a;++t){const r=t*P-n;for(let n=s;n<l;++n){const a=y*W+w*t+k*n,i=S*(I-1-r)+C*(T-1-(n*M-o))+E*e;for(let t=0;t<z;++t){c+=x[a+(e*z+t)]*N[i+t]}}}g[m*W+v*t+b*i+e]=c}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}};const rG={kernelName:NN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t,a=$w(r.shape),i=n.data.get(r.dataId).values,o=iI([a,a],r.dtype),s=o.values;for(let c=0;c<i.length;c++)s[c*a+c]=i[c];const l=[...r.shape,...r.shape];return n.makeTensorInfo(l,o.dtype,o.values)}},aG={kernelName:SN,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e;const{x:a,filter:i}=t,{strides:o,pad:s,dilations:l}=r,c=n,u=c.data.get(a.dataId).values,h=a.shape.length,d=c.data.get(i.dataId).values,f=i.shape.length,{batchSize:p,inHeight:g,inWidth:m,inChannels:v,outHeight:b,outWidth:x,padInfo:y,strideHeight:w,strideWidth:k,filterHeight:N,filterWidth:S,dilationHeight:C,dilationWidth:E,outShape:_}=mT(a.shape,i.shape,o,s,"NHWC",l),I=$w(_),T=_.length,A=ok(a.dtype,I);for(let R=0;R<p;++R)for(let e=0;e<b;++e){const t=e*w-y.top;for(let n=0;n<x;++n){const r=n*k-y.left;for(let o=0;o<v;++o){let s=Number.MIN_SAFE_INTEGER;for(let e=0;e<N;++e){const n=t+e*C;if(n>=0&&n<g)for(let t=0;t<S;++t){const l=r+t*E;if(l>=0&&l<m){const r=wk([R,n,l,o],h,pk(a.shape)),c=wk([e,t,o],f,pk(i.shape)),p=u[r]+d[c];p>s&&(s=p)}}}A[wk([R,e,n,o],T,pk(_))]=s}}}return{dataId:c.write(gE(A,a.dtype),_,a.dtype),shape:_,dtype:a.dtype}}},iG={kernelName:EN,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e;const{x:a,filter:i,dy:o}=t,{strides:s,pad:l,dilations:c}=r,u=n,h=mk(a.shape,u.data.get(a.dataId).values),d=mk(i.shape,u.data.get(i.dataId).values),{batchSize:f,inHeight:p,inWidth:g,inChannels:m,outHeight:v,outWidth:b,padInfo:x,strideHeight:y,strideWidth:w,filterHeight:k,filterWidth:N,dilationHeight:S,dilationWidth:C,outShape:E}=mT(a.shape,i.shape,s,l,"NHWC",c);Kw(o.rank===E.length,()=>"Error in ".concat(EN,", dy ")+"must have the same rank as output ".concat(E.length,", but got ")+"".concat(o.rank));const _=mk(E,u.data.get(o.dataId).values),I=xk(i.shape,i.dtype);for(let T=0;T<f;++T)for(let e=0;e<v;++e){const t=e*y-x.top;for(let n=0;n<b;++n){const r=n*w-x.left;for(let a=0;a<m;++a){let i=Number.MIN_SAFE_INTEGER,o=0,s=0;for(let e=0;e<k;++e){const n=t+e*S;if(n>=0&&n<p)for(let t=0;t<N;++t){const l=r+t*C;if(l>=0&&l<g){const r=h[T][n][l][a]+d[e][t][a];r>i&&(i=r,o=e,s=t)}}}I[o][s][a]+=_[T][e][n][a]}}}return{dataId:u.write(gE(I,a.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}},oG={kernelName:CN,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e;const{x:a,filter:i,dy:o}=t,{strides:s,pad:l,dilations:c}=r,u=n,h=mk(a.shape,u.data.get(a.dataId).values),d=mk(i.shape,u.data.get(i.dataId).values),{batchSize:f,inHeight:p,inWidth:g,inChannels:m,outHeight:v,outWidth:b,padInfo:x,strideHeight:y,strideWidth:w,filterHeight:k,filterWidth:N,dilationHeight:S,dilationWidth:C,outShape:E}=mT(a.shape,i.shape,s,l,"NHWC",c);Kw(o.rank===E.length,()=>"Error in ".concat(CN,", dy ")+"must have the same rank as output ".concat(E.length,", but got ")+"".concat(o.rank));const _=mk(E,u.data.get(o.dataId).values),I=xk(a.shape,a.dtype);for(let T=0;T<f;++T)for(let e=0;e<v;++e){const t=e*y-x.top;for(let n=0;n<b;++n){const r=n*w-x.left;for(let a=0;a<m;++a){let i=Number.MIN_SAFE_INTEGER,o=t<0?0:t,s=r<0?0:r;for(let e=0;e<k;++e){const n=t+e*S;if(n>=0&&n<p)for(let t=0;t<N;++t){const l=r+t*C;if(l>=0&&l<g){const r=h[T][n][l][a]+d[e][t][a];r>i&&(i=r,o=n,s=l)}}}I[T][o][s][a]+=_[T][e][n][a]}}}return{dataId:u.write(gE(I,a.dtype),a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}};const sG={kernelName:_N,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{image:a}=t,{canvas:i,options:o}=r,{contextOptions:s,imageOptions:l}=o||{},c=(null===l||void 0===l?void 0:l.alpha)||1,u=(null===s||void 0===s?void 0:s.contextType)||"2d";if("2d"!==u)throw new Error("Context type ".concat(s.contextType," is not supported by the CPU backend."));const h=i.getContext(u,(null===s||void 0===s?void 0:s.contextAttributes)||{});if(null==h)throw new Error("Could not get the context with ".concat(u," type."));const[d,f]=a.shape.slice(0,2),p=2===a.shape.length?1:a.shape[2],g=n.data.get(a.dataId).values,m="float32"===a.dtype?255:1,v=new Uint8ClampedArray(f*d*4);for(let x=0;x<d*f;++x){const e=[0,0,0,255*c];for(let n=0;n<p;n++){const t=g[x*p+n];if("float32"===a.dtype){if(t<0||t>1)throw new Error("Tensor values for a float32 Tensor must be in the "+"range [0 - 1] but encountered ".concat(t,"."))}else if("int32"===a.dtype&&(t<0||t>255))throw new Error("Tensor values for a int32 Tensor must be in the "+"range [0 - 255] but encountered ".concat(t,"."));1===p?(e[0]=t*m,e[1]=t*m,e[2]=t*m):e[n]=t*m}const t=4*x;v[t+0]=Math.round(e[0]),v[t+1]=Math.round(e[1]),v[t+2]=Math.round(e[2]),v[t+3]=Math.round(e[3])}i.width=f,i.height=d;const b=new ImageData(v,f,d);return h.putImageData(b,0,0),a}},lG=oV((e,t)=>e*t),cG=_V((e,t,n,r)=>({real:e*n-t*r,imag:e*r+t*n})),uG=EV(NS,lG,cG),hG={kernelName:NS,backendName:"cpu",kernelFunc:uG};function dG(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:o}=r;let s;XU(a,"sum"),s="bool"===a.dtype?SV({inputs:{x:a},backend:n,attrs:{dtype:"int32"}}):nV({inputs:{x:a},backend:n});const l=s.shape.length,c=rk(i,s.shape),u=kA(c,l);let h=c,d=s;null!=u&&(d=GV({inputs:{x:s},backend:n,attrs:{perm:u}}),h=SA(h.length,l)),wA("sum",h,d.shape.length);const[f,p]=xA(d.shape,h);let g=yV(n,f,UE(d.dtype,"int32"));const m=$w(p),v=n.data.get(g.dataId).values,b=n.data.get(d.dataId).values;for(let x=0;x<v.length;++x){const e=x*m;let t=0;for(let n=0;n<m;++n)t+=b[e+n];v[x]=t}if(o){const e=g;g=DV({inputs:{x:g},backend:n,attrs:{shape:yA(g.shape,c)}}),n.disposeIntermediateTensorInfo(e)}return n.disposeIntermediateTensorInfo(s),null!=u&&n.disposeIntermediateTensorInfo(d),g}const fG={kernelName:uC,backendName:"cpu",kernelFunc:dG};const pG={kernelName:TN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{equation:a}=r,i=t,{allDims:o,summedDims:s,idDims:l}=lF(a,i.length);uF(o.length,l,i);const{path:c,steps:u}=hF(s,l),h=u.length;let d=null,f=o.length;const p=[];for(let g=0;g<h;++g){for(const e of u[g]){const{permutationIndices:t,expandDims:r}=cF(f,l[e]);let a;dF(t)?a=i[e]:(a=GV({inputs:{x:i[e]},backend:n,attrs:{perm:t}}),p.push(a));const o=a.shape.slice();for(let e=0;e<r.length;++e)o.splice(r[e],0,1);Jw(a.shape,o)||(a=DV({inputs:{x:a},backend:n,attrs:{shape:o}}),p.push(a)),null===d?d=a:(d=uG({inputs:{a:a,b:d},backend:n}),p.push(d))}g<h-1&&(c[g]>=0&&(d=dG({inputs:{x:d},backend:n,attrs:{axis:c[g]-(o.length-f),keepDims:!1}}),p.push(d)),f--)}for(const g of p)g!==d&&n.disposeIntermediateTensorInfo(g);return d}};const gG={kernelName:RN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{dy:r,y:a}=t;XU([r,a],"eluGrad");const i=new Float32Array($w(a.shape)),o=n.data.get(a.dataId).values,s=n.data.get(r.dataId).values;for(let l=0;l<o.length;++l){const e=o[l];i[l]=e>=0?s[l]:s[l]*(e+1)}return n.makeTensorInfo(a.shape,"float32",i)}},mG=oV((e,t)=>e===t?1:0),vG=EV(FN,mG,null,"bool"),bG={kernelName:FN,backendName:"cpu",kernelFunc:vG},xG=HD,yG=GD,wG=qD,kG=KD,NG=XD,SG=YD,CG=QU(DN,e=>{const t=Math.sign(e),n=Math.abs(e),r=1/(1+xG*n);return t*(1-((((SG*r+NG)*r+kG)*r+wG)*r+yG)*r*Math.exp(-n*n))}),EG={kernelName:DN,backendName:"cpu",kernelFunc:CG},_G=JU(e=>Math.exp(e)),IG=ZU(ON,_G,"float32"),TG={kernelName:ON,backendName:"cpu",kernelFunc:IG};function AG(e){const{inputs:t,backend:n,attrs:r}=e,{input:a}=t,{dim:i}=r,o=a.shape.length,s=a.shape.slice();let l=i;return i<0&&(Kw(-(o+1)<=i,()=>"Axis must be in the interval [".concat(-(o+1),", ").concat(o,"]")),l=o+i+1),s.splice(l,0,1),DV({inputs:{x:a},backend:n,attrs:{shape:s}})}const RG={kernelName:LN,backendName:"cpu",kernelFunc:AG},DG=JU(e=>Math.expm1(e)),FG=ZU(PN,DG),OG={kernelName:PN,backendName:"cpu",kernelFunc:FG},LG=oV((e,t)=>e/t),PG=EV(IN,LG),MG={kernelName:IN,backendName:"cpu",kernelFunc:PG},jG=oV((e,t)=>e-t),BG=_V((e,t,n,r)=>({real:e-n,imag:t-r})),zG=EV(EC,jG,BG),WG={kernelName:EC,backendName:"cpu",kernelFunc:zG};function UG(e,t,n){const r=e.shape,a=r[0],i=r[1],o=n.data.get(e.dataId),s=o.complexTensorInfos.real,l=o.complexTensorInfos.imag,c=[a,i],u=$w(c),h=ik("float32",u),d=ik("float32",u);for(let m=0;m<a;m++){const e=vH({inputs:{x:s},backend:n,attrs:{begin:[m,0],size:[1,i]}}),r=vH({inputs:{x:l},backend:n,attrs:{begin:[m,0],size:[1,i]}}),a=bV({inputs:{real:e,imag:r},backend:n}),{real:o,imag:c}=VG(a,t,n),u=$D(o,c);for(let t=0;t<i;t++){const e=eF(u,t);h[m*i+t]=e.real,d[m*i+t]=e.imag}n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(a)}const f=n.makeTensorInfo(c,"float32",h),p=n.makeTensorInfo(c,"float32",d),g=bV({inputs:{real:f,imag:p},backend:n});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),g}function VG(e,t,n){const r=$w(e.shape),a=n.data.get(e.dataId),i=n.data.get(a.complexTensorInfos.real.dataId).values,o=n.data.get(a.complexTensorInfos.imag.dataId).values;if(0===((s=r)&s-1)){const a=HG(i,o,r,t,n),s=[e.shape[0],e.shape[1]];if(t){const e=n.makeTensorInfo(s,"float32",a.real),t=n.makeTensorInfo(s,"float32",a.imag),i=n.makeTensorInfo([],"float32",pE(r,"float32")),o=nV({inputs:{x:i},backend:n}),l=MG.kernelFunc({inputs:{a:e,b:i},backend:n}),c=MG.kernelFunc({inputs:{a:t,b:o},backend:n}),u=n.data.get(l.dataId).values,h=n.data.get(c.dataId).values;return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(c),{real:u,imag:h}}return a}{const e=function(e,t,n){const r=new Float32Array(2*t);for(let a=0;a<t;a++){let i=0,o=0;for(let r=0;r<t;r++){const s=rF(a*r,t,n),l=eF(e,r);i+=l.real*s.real-l.imag*s.imag,o+=l.real*s.imag+l.imag*s.real}n&&(i/=t,o/=t),tF(r,i,o,a)}return r}($D(i,o),r,t);return JD(e)}var s}function HG(e,t,n,r,a){if(1===n)return{real:e,imag:t};const i=$D(e,t),o=n/2,s=QD(i),l=s.real,c=s.imag,u=[l.length],h=a.makeTensorInfo(u,"float32",l),d=a.makeTensorInfo(u,"float32",c),f=bV({inputs:{real:h,imag:d},backend:a}),p=ZD(i),g=p.real,m=p.imag,v=[g.length],b=a.makeTensorInfo(v,"float32",g),x=a.makeTensorInfo(v,"float32",m),y=bV({inputs:{real:b,imag:x},backend:a}),w=HG(l,c,o,r,a),k=w.real,N=w.imag,S=[k.length],C=a.makeTensorInfo(S,"float32",k),E=a.makeTensorInfo(S,"float32",N),_=bV({inputs:{real:C,imag:E},backend:a}),I=HG(g,m,o,r,a),T=I.real,A=I.imag,R=[T.length],D=a.makeTensorInfo(R,"float32",T),F=a.makeTensorInfo(R,"float32",A),O=bV({inputs:{real:D,imag:F},backend:a}),L=nF(n,r),P=[L.real.length],M=a.makeTensorInfo(P,"float32",L.real),j=a.makeTensorInfo(P,"float32",L.imag),B=bV({inputs:{real:M,imag:j},backend:a}),z=uG({inputs:{a:B,b:O},backend:a}),W=AV({inputs:{a:_,b:z},backend:a}),U=zG({inputs:{a:_,b:z},backend:a}),V=wV({inputs:{input:W},backend:a}),H=wV({inputs:{input:U},backend:a}),G=FH({inputs:{input:W},backend:a}),q=FH({inputs:{input:U},backend:a}),K=LH({inputs:[V,H],backend:a,attrs:{axis:0}}),X=LH({inputs:[G,q],backend:a,attrs:{axis:0}}),Y=a.data.get(K.dataId).values,$=a.data.get(X.dataId).values;return a.disposeIntermediateTensorInfo(h),a.disposeIntermediateTensorInfo(d),a.disposeIntermediateTensorInfo(f),a.disposeIntermediateTensorInfo(b),a.disposeIntermediateTensorInfo(x),a.disposeIntermediateTensorInfo(y),a.disposeIntermediateTensorInfo(C),a.disposeIntermediateTensorInfo(E),a.disposeIntermediateTensorInfo(_),a.disposeIntermediateTensorInfo(D),a.disposeIntermediateTensorInfo(F),a.disposeIntermediateTensorInfo(O),a.disposeIntermediateTensorInfo(M),a.disposeIntermediateTensorInfo(j),a.disposeIntermediateTensorInfo(B),a.disposeIntermediateTensorInfo(z),a.disposeIntermediateTensorInfo(W),a.disposeIntermediateTensorInfo(U),a.disposeIntermediateTensorInfo(V),a.disposeIntermediateTensorInfo(G),a.disposeIntermediateTensorInfo(H),a.disposeIntermediateTensorInfo(q),a.disposeIntermediateTensorInfo(K),a.disposeIntermediateTensorInfo(X),{real:Y,imag:$}}const GG={kernelName:MN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{input:r}=t,a=$w(r.shape),i=r.shape[r.shape.length-1],o=DV({inputs:{x:r},backend:n,attrs:{shape:[a/i,i]}}),s=UG(o,!1,n),l=DV({inputs:{x:s},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),l}};function qG(e){const{backend:t,attrs:n}=e,{shape:r,value:a,dtype:i}=n,o=i||hk(a),s=ok(o,$w(r));return function(e,t){e.fill(t)}(s,a),t.makeTensorInfo(r,o,s)}const KG={kernelName:jN,backendName:"cpu",kernelFunc:qG};const XG={kernelName:BN,backendName:"cpu",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{image:a}=t,i=r,o=ik(a.dtype,$w(a.shape)),[s,l,c,u]=a.shape,h=i.data.get(a.dataId).values;for(let d=0;d<s;d++){const e=d*c*l*u;for(let t=0;t<l;t++){const n=t*(c*u);for(let t=0;t<c;t++){const r=t*u;for(let a=0;a<u;a++){const i=Math.round(c-t-1),s=e+n+r+a;let l=h[s];if(i>=0&&i<c){l=h[e+n+i*u+a]}o[s]=l}}}}return{dataId:i.write(o,a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},YG=JU(e=>Math.floor(e)),$G=ZU(zN,YG),JG={kernelName:zN,backendName:"cpu",kernelFunc:$G},QG=oV((e,t)=>Math.floor(e/t)),ZG=EV(WN,QG,null,"int32"),eq={kernelName:WN,backendName:"cpu",kernelFunc:ZG};const tq={kernelName:WC,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i,bias:o,preluActivationWeights:s}=t,{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d,activation:f,leakyreluAlpha:p}=r;let g=MH({inputs:{x:a,filter:i},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d}});if(o){const e=g;if("NCHW"===u&&1===o.shape.length&&1!==o.shape[0]){const e=DV({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});g=AV({inputs:{a:g,b:e},backend:n}),n.disposeIntermediateTensorInfo(e)}else g=AV({inputs:{a:g,b:o},backend:n});n.disposeIntermediateTensorInfo(e)}if(f){const e=g;if("NCHW"===u&&"prelu"===f&&1===s.shape.length&&1!==s.shape[0]){const e=DV({inputs:{x:s},backend:n,attrs:{shape:[s.shape[0],1,1]}});g=vV(n,g,f,e,p),n.disposeIntermediateTensorInfo(e)}else g=vV(n,g,f,s,p);n.disposeIntermediateTensorInfo(e)}return g}};const nq={kernelName:UC,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i,bias:o,preluActivationWeights:s}=t,{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d,activation:f,leakyreluAlpha:p}=r;let g=ZH({inputs:{x:a,filter:i},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d}});if(o){const e=g;g=AV({inputs:{a:g,b:o},backend:n}),n.disposeIntermediateTensorInfo(e)}if(f){const e=g;g=vV(n,g,f,s,p),n.disposeIntermediateTensorInfo(e)}return g}};function rq(e,t,n,r,a,i,o,s,l){const c=iI([r,i],n);for(let u=0;u<r;u++){const n=[];let r=0;for(let t=0;t<a;t++){const i=e[u*a+t];r+=i*o[t],n.push(i)}if(r<0||r>=l/i)throw new Error("Invalid indices: ".concat(n," does not index into ").concat(s));for(let e=0;e<i;e++)c.values[u*i+e]=t.get(...t.indexToLoc(r*i+e))}return c}const aq={kernelName:HN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{params:r,indices:a}=t,i=$w(r.shape),o=a.shape,s=o[o.length-1],[l,c,u,h]=jD(r,a);if(0===c)return n.makeTensorInfo(l,r.dtype,[]);const d=rq(n.data.get(a.dataId).values,n.bufferSync(r),r.dtype,c,s,u,h,r.shape,i);return n.makeTensorInfo(l,r.dtype,d.values)}};function iq(e,t,n){const r=iI(n,e.dtype);for(let a=0;a<r.size;++a){const n=r.indexToLoc(a).slice(),i=n[0],o=n[2],s=t.locToIndex([i,o]);n[2]=t.values[s];const l=e.locToIndex(n);0<=l&&l<e.values.length&&(r.values[a]=e.values[l])}return r}const oq={kernelName:VN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,indices:i}=t,{axis:o,batchDims:s}=r;XU([a,i],"gatherV2");const l=rk(o,a.shape)[0],c=n.data.get(i.dataId).values,u=a.shape[l];for(let x=0;x<c.length;++x){const e=c[x];Kw(e<=u-1&&e>=0,()=>"GatherV2: the index value ".concat(e," is not in [0, ").concat(u-1,"]"))}let h=s;null==s&&(h=0);const d=$w(i.shape),f=TF(a,i,l,h),p=DV({inputs:{x:a},backend:n,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),g=DV({inputs:{x:i},backend:n,attrs:{shape:[f.batchSize,d/f.batchSize]}}),m=[f.batchSize,f.outerSize,d/f.batchSize,f.sliceSize],v=n.bufferSync(g),b=iq(n.bufferSync(p),v,m);return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.makeTensorInfo(f.outputShape,b.dtype,b.values)}},sq=oV((e,t)=>e>t?1:0),lq=EV(GN,sq,null,"bool"),cq={kernelName:GN,backendName:"cpu",kernelFunc:lq},uq=oV((e,t)=>e>=t?1:0),hq=EV(qN,uq,null,"bool"),dq={kernelName:qN,backendName:"cpu",kernelFunc:hq};const fq={kernelName:XN,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{input:r}=t,a=$w(r.shape),i=r.shape[r.shape.length-1],o=DV({inputs:{x:r},backend:n,attrs:{shape:[a/i,i]}}),s=UG(o,!0,n),l=DV({inputs:{x:s},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),l}},pq=QU($N,e=>Number.isFinite(e)?1:0,"bool"),gq={kernelName:$N,backendName:"cpu",kernelFunc:pq},mq=QU(JN,e=>Math.abs(e)===1/0?1:0,"bool"),vq={kernelName:JN,backendName:"cpu",kernelFunc:mq},bq=QU(QN,e=>Number.isNaN(e)?1:0,"bool"),xq={kernelName:QN,backendName:"cpu",kernelFunc:bq},yq=oV((e,t)=>e<t?1:0),wq=EV(eS,yq,null,"bool"),kq={kernelName:eS,backendName:"cpu",kernelFunc:wq},Nq=oV((e,t)=>e<=t?1:0),Sq=EV(tS,Nq,null,"bool"),Cq={kernelName:tS,backendName:"cpu",kernelFunc:Sq};function Eq(e,t,n){const r=(t-e)/(n-1),a=bk(n,"float32");a[0]=e;for(let i=1;i<a.length;i++)a[i]=a[i-1]+r;return a}const _q={kernelName:nS,backendName:"cpu",kernelFunc:function(e){const{backend:t,attrs:n}=e,{start:r,stop:a,num:i}=n,o=Eq(r,a,i);return t.makeTensorInfo([o.length],"float32",o)}},Iq=JU(e=>Math.log(e)),Tq=ZU(rS,Iq),Aq={kernelName:rS,backendName:"cpu",kernelFunc:Tq},Rq=QU(aS,e=>Math.log1p(e)),Dq={kernelName:aS,backendName:"cpu",kernelFunc:Rq},Fq=oV((e,t)=>e&&t),Oq=EV(iS,Fq,null,"bool"),Lq={kernelName:iS,backendName:"cpu",kernelFunc:Oq},Pq=QU(oS,e=>e?0:1,"bool"),Mq={kernelName:oS,backendName:"cpu",kernelFunc:Pq},jq=oV((e,t)=>e||t),Bq=EV(sS,jq,null,"bool"),zq={kernelName:sS,backendName:"cpu",kernelFunc:Bq};const Wq={kernelName:lS,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{depthRadius:i,bias:o,alpha:s,beta:l}=r;XU(a,"LRN");const c=a.shape[3],u=c-1,h=n.data.get(a.dataId).values,d=$w(a.shape),f=new Float32Array(d);function p(e){const t=e%c;let n=e-t+Math.max(0,t-i);const r=e-t+Math.min(t+i,u);let a=0;for(;n<=r;n++){const e=h[n];a+=e*e}return a}for(let g=0;g<d;g++){const e=p(g),t=h[g]*Math.pow(o+s*e,-l);f[g]=t}return n.makeTensorInfo(a.shape,a.dtype,f)}};const Uq={kernelName:cS,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,y:i,dy:o}=t,{depthRadius:s,bias:l,alpha:c,beta:u}=r;XU(o,"LRNGrad");const h=$w(o.shape),d=o.shape[3],f=n.data.get(o.dataId).values,p=n.data.get(a.dataId).values,g=n.data.get(i.dataId).values,m=new Float32Array(h),v=h;for(let b=0;b<v;b++){const e=b%d,t=b-e+Math.max(0,e-s),n=b-e+Math.min(d,e+s+1);let r=0;for(let a=t;a<n;a++)r+=Math.pow(p[a],2);r=c*r+l;for(let a=t;a<n;a++){let e=-2*c*u*p[a]*g[b]/r;b===a&&(e+=Math.pow(r,-u)),e*=f[b],m[a]+=e}}return n.makeTensorInfo(o.shape,a.dtype,m)}};function Vq(e,t,n,r){const a=ik(r,$w(n));for(let i=0;i<a.length;++i){const n=i*t;let r=e[n];for(let a=0;a<t;++a){const t=e[n+a];(Number.isNaN(t)||t>r)&&(r=t)}a[i]=r}return a}function Hq(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{reductionIndices:i,keepDims:o}=r,s=n;let l=a.shape;const c=l.length,u=rk(i,l);let h=u;const d=kA(h,c);let f=s.data.get(a.dataId).values;if(null!=d){const e=new Array(c);for(let t=0;t<e.length;t++)e[t]=l[d[t]];f=HV(f,l,a.dtype,d,e),h=SA(h.length,c),l=e}XU(a,"max"),wA("max",h,c);const[p,g]=xA(l,h),m=Vq(f,$w(g),p,a.dtype),v=s.write(m,p,a.dtype);let b=p;if(o){b=yA(p,u)}return{dataId:v,shape:b,dtype:a.dtype}}const Gq={kernelName:uS,backendName:"cpu",kernelFunc:Hq},qq=oV((e,t)=>Math.max(e,t)),Kq=EV(hS,qq),Xq={kernelName:hS,backendName:"cpu",kernelFunc:Kq};const Yq={kernelName:dS,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t;XU(a,"maxPool");const{filterSize:i,strides:o,pad:s,dimRoundingMode:l}=r;Kw(_T(o,1),()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'"));const c=vT(a.shape,i,o,1,s,l);let u;if(1===c.filterWidth&&1===c.filterHeight&&Jw(c.inShape,c.outShape))u=nV({inputs:{x:a},backend:n});else{const e=n.data.get(a.dataId).values,t=pk(a.shape),r=lH(e,a.shape,a.dtype,t,c,"max");u=n.makeTensorInfo(c.outShape,a.dtype,r.values)}return u}};const $q={kernelName:pS,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:i,strides:o,pad:s,dimRoundingMode:l,dataFormat:c}=r;XU(a,"maxPool3d");const u=bT(a.shape,i,o,1,s,l,c),h=uH(n.data.get(a.dataId).values,a.shape,a.dtype,pk(a.shape),u,"max");return n.makeTensorInfo(h.shape,"float32",h.values)}};const Jq={kernelName:gS,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,{filterSize:o,strides:s,pad:l,dimRoundingMode:c}=r;XU([a,i],"maxPool3DGrad");const u=bT(i.shape,o,s,1,l,c),h=function(e,t){const n=iI(t.outShape,"int32"),r=t.strideDepth,a=t.strideHeight,i=t.strideWidth,o=t.dilationDepth,s=t.dilationHeight,l=t.dilationWidth,c=t.effectiveFilterDepth,u=t.effectiveFilterHeight,h=t.effectiveFilterWidth,d=t.padInfo.front,f=t.padInfo.top,p=t.padInfo.left;for(let g=0;g<t.batchSize;++g)for(let m=0;m<t.inChannels;++m)for(let v=0;v<t.outDepth;++v){const b=v*r-d;let x=b;for(;x<0;)x+=o;const y=Math.min(t.inDepth,c+b);for(let r=0;r<t.outHeight;++r){const c=r*a-f;let d=c;for(;d<0;)d+=s;const w=Math.min(t.inHeight,u+c);for(let a=0;a<t.outWidth;++a){const f=a*i-p;let k=f;for(;k<0;)k+=l;const N=Math.min(t.inWidth,h+f);let S=Number.NEGATIVE_INFINITY,C=-1;for(let t=x;t<y;t+=o){const n=t-b;for(let r=d;r<w;r+=s){const a=r-c;for(let i=k;i<N;i+=l){const o=i-f,s=e.get(g,t,r,i,m);s>=S&&(S=s,C=n*u*h+a*u+o)}}}n.set(C,g,v,r,a,m)}}}return n}(n.bufferSync(i),u),d=u.strideDepth,f=u.strideHeight,p=u.strideWidth,g=u.dilationDepth,m=u.dilationHeight,v=u.dilationWidth,b=u.effectiveFilterDepth,x=u.effectiveFilterHeight,y=u.effectiveFilterWidth,w=b-1-u.padInfo.front,k=y-1-u.padInfo.left,N=x-1-u.padInfo.top,S=iI(i.shape,"float32"),C=n.bufferSync(a);for(let E=0;E<u.batchSize;++E)for(let e=0;e<u.inChannels;++e)for(let t=0;t<u.inDepth;++t)for(let n=0;n<u.inHeight;++n)for(let r=0;r<u.inWidth;++r){const a=t-w,i=n-N,o=r-k;let s=0;for(let t=0;t<b;t+=g){const n=(a+t)/d;if(!(n<0||n>=u.outDepth||Math.floor(n)!==n))for(let r=0;r<x;r+=m){const a=(i+r)/f;if(!(a<0||a>=u.outHeight||Math.floor(a)!==a))for(let i=0;i<y;i+=v){const l=(o+i)/p;if(l<0||l>=u.outWidth||Math.floor(l)!==l)continue;const c=b*x*y-1-h.get(E,n,a,l,e)===t*x*y+r*y+i?1:0;if(0===c)continue;s+=C.get(E,n,a,l,e)*c}}}S.set(s,E,t,n,r,e)}return n.makeTensorInfo(S.shape,S.dtype,S.values)}};const Qq={kernelName:fS,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i,output:o}=t,s=i;XU([i,o],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:h}=r,d=vT(s.shape,l,c,1,u,h),f=n.data.get(s.dataId).values,p=iI(d.outShape,s.dtype,cH(f,s.shape,s.dtype,d).values),g=d.strideHeight,m=d.strideWidth,v=d.dilationHeight,b=d.dilationWidth,x=d.effectiveFilterHeight,y=d.effectiveFilterWidth,w=y-1-d.padInfo.left,k=x-1-d.padInfo.top,N=iI(s.shape,"float32"),S=n.data.get(a.dataId).values,C=iI(a.shape,"float32",S);for(let E=0;E<d.batchSize;++E)for(let e=0;e<d.inChannels;++e)for(let t=0;t<d.inHeight;++t)for(let n=0;n<d.inWidth;++n){const r=t-k,a=n-w;let i=0;for(let t=0;t<x;t+=v){const n=(r+t)/g;if(!(n<0||n>=d.outHeight||Math.floor(n)!==n))for(let r=0;r<y;r+=b){const o=(a+r)/m;if(o<0||o>=d.outWidth||Math.floor(o)!==o)continue;const s=x*y-1-p.get(E,n,o,e)===t*y+r?1:0;if(0===s)continue;i+=C.get(E,n,o,e)*s}}N.set(i,E,t,n,e)}return n.makeTensorInfo(N.shape,N.dtype,N.values)}};const Zq={kernelName:mS,backendName:"cpu",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{x:a}=t,{filterSize:i,strides:o,pad:s,includeBatchInIndex:l}=n,c=r;XU(a,"MaxPoolWithArgmax");const u=c.data.get(a.dataId).values,h=vT(a.shape,i,o,[1,1],s),[d,f]=function(e,t,n,r,a){const i=lH(e,0,n,pk(t),a,"max"),o=cH(e,t,n,a,!0,r);return[i.values,o.values]}(u,a.shape,a.dtype,l,h),p=c.write(d,h.outShape,a.dtype),g=c.write(f,h.outShape,a.dtype);return[{dataId:p,shape:h.outShape,dtype:a.dtype},{dataId:g,shape:h.outShape,dtype:"int32"}]}};const eK={kernelName:vS,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:o}=r,s=rk(i,a.shape),l=$w(xA(a.shape,s)[1]),c=[],u=n.makeTensorInfo([],"float32",new Float32Array([l]));c.push(u);const h=SV({inputs:{x:a},backend:n,attrs:{dtype:"float32"}});c.push(h);const d=PG({inputs:{a:h,b:u},backend:n});c.push(d);const f=dG({inputs:{x:d},backend:n,attrs:{axis:i,keepDims:o}});return c.forEach(e=>n.disposeIntermediateTensorInfo(e)),f}};const tK={kernelName:bS,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:o}=r;XU(a,"min");const s=rk(i,a.shape);let l=s;const c=kA(l,a.shape.length);let u=a;null!=c&&(u=GV({inputs:{x:a},backend:n,attrs:{perm:c}}),l=SA(l.length,a.shape.length)),wA("min",l,u.shape.length);const[h,d]=xA(u.shape,l),f=$w(d),p=bk($w(h),u.dtype),g=n.data.get(u.dataId).values;for(let v=0;v<p.length;++v){const e=v*f;let t=g[e];for(let n=0;n<f;++n){const r=g[e+n];(Number.isNaN(r)||r<t)&&(t=r)}p[v]=t}null!=c&&n.disposeIntermediateTensorInfo(u);const m=n.makeTensorInfo(h,u.dtype,p);if(o){const e=DV({inputs:{x:m},backend:n,attrs:{shape:yA(h,s)}});return n.disposeIntermediateTensorInfo(m),e}return m}},nK=oV((e,t)=>Math.min(e,t)),rK=EV(xS,nK),aK={kernelName:xS,backendName:"cpu",kernelFunc:rK};const iK={kernelName:yS,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{paddings:i,mode:o}=r;XU(a,"mirrorPad");const s=i.map((e,t)=>e[0]+a.shape[t]+e[1]),l=i.map(e=>e[0]),c=i.map((e,t)=>e[0]+a.shape[t]),u="reflect"===o?0:1,h=n.data.get(a.dataId).values,d=a.shape.length,f=pk(a.shape),p=$w(s),g=s.length,m=pk(s),v=ik(a.dtype,p);for(let b=0;b<p;b++){let e=kk(b,g,m);for(let n=0;n<g;n++)e[n]<l[n]?e[n]=2*l[n]-e[n]-u:e[n]>=c[n]&&(e[n]=2*(c[n]-1)-e[n]+u);e=e.map((e,t)=>e-l[t]);const t=wk(e,d,f);v[b]=h[t]}return{dataId:n.write(v,s,a.dtype),shape:s,dtype:a.dtype}}},oK=oV((e,t)=>{const n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t}),sK=EV(wS,oK),lK={kernelName:wS,backendName:"cpu",kernelFunc:sK};function cK(e){const{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{dim:i}=r,o=a.shape.length;let s=i;if(-1===s&&(s=o-1),s!==o-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(o," and dim was ").concat(s));const l=rk([s],a.shape),c=Hq({inputs:{x:a},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),u=yA(c.shape,l),h=DV({inputs:{x:c},backend:n,attrs:{shape:u}}),d=zG({inputs:{a:a,b:h},backend:n}),f=IG({inputs:{x:d},backend:n}),p=dG({inputs:{x:f},backend:n,attrs:{axis:l,keepDims:!1}}),g=DV({inputs:{x:p},backend:n,attrs:{shape:u}}),m=PG({inputs:{a:f,b:g},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),m}const uK={kernelName:fC,backendName:"cpu",kernelFunc:cK};const hK={kernelName:kS,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{numSamples:i,seed:o,normalized:s}=r;XU(a,"multinomial");const l=s?a:cK({inputs:{logits:a},backend:n,attrs:{dim:-1}}),c=l.shape[0],u=l.shape[1],h=n.data.get(l.dataId).values,d=[c,i],f=bk($w(d),"int32");for(let p=0;p<c;++p){const e=p*u,t=new Float32Array(u-1);t[0]=h[e];for(let a=1;a<t.length;++a)t[a]=t[a-1]+h[e+a];const n=UA.alea(o.toString()),r=p*i;for(let a=0;a<i;++a){const e=n();f[r+a]=t.length;for(let n=0;n<t.length;n++)if(e<t[n]){f[r+a]=n;break}}}return s||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(d,"int32",f)}};function dK(e,t,n){const r=pE(-1,n);return lG([],t,r,e,n)}const fK={kernelName:SS,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t;XU(r,"neg");const a=n.data.get(r.dataId).values,[i,o]=dK(a,r.shape,r.dtype);return n.makeTensorInfo(o,r.dtype,i)}},pK=HR;const gK={kernelName:ES,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:o,iouThreshold:s,scoreThreshold:l}=r;XU(a,"NonMaxSuppression");const c=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,{selectedIndices:h}=pK(c,u,o,s,l);return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}},mK=GR;const vK={kernelName:_S,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:o,iouThreshold:s,scoreThreshold:l,padToMaxOutputSize:c}=r;XU(a,"NonMaxSuppressionPadded");const u=n.data.get(a.dataId).values,h=n.data.get(i.dataId).values,{selectedIndices:d,validOutputs:f}=mK(u,h,o,s,l,c);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}},bK=qR;const xK={kernelName:IS,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:o,iouThreshold:s,scoreThreshold:l,softNmsSigma:c}=r;XU(a,"NonMaxSuppressionWithScore");const u=n.data.get(a.dataId).values,h=n.data.get(i.dataId).values,d=o,f=s,p=l,g=c,{selectedIndices:m,selectedScores:v}=bK(u,h,d,f,p,g);return[n.makeTensorInfo([m.length],"int32",new Int32Array(m)),n.makeTensorInfo([v.length],"float32",new Float32Array(v))]}},yK=oV((e,t)=>e!==t?1:0),wK=EV(CS,yK,null,"bool"),kK={kernelName:CS,backendName:"cpu",kernelFunc:wK};const NK={kernelName:AS,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{indices:a}=t,{dtype:i,depth:o,onValue:s,offValue:l}=r;XU(a,"oneHot");const c=$w(a.shape),u=new Float32Array(c*o);u.fill(l);const h=n.data.get(a.dataId).values;for(let d=0;d<c;++d)h[d]>=0&&h[d]<o&&(u[d*o+h[d]]=s);return n.makeTensorInfo([...a.shape,o],i,u)}};function SK(e){const{inputs:t,backend:n}=e,{x:r}=t;if("string"===r.dtype)throw new Error("zerosLike is not supported for string tensors");if("complex64"===r.dtype){const e=wV({inputs:{input:r},backend:n}),t=SK({inputs:{x:e},backend:n}),a=FH({inputs:{input:r},backend:n}),i=SK({inputs:{x:a},backend:n}),o=bV({inputs:{real:t,imag:i},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),o}return qG({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const CK={kernelName:PC,backendName:"cpu",kernelFunc:SK};const EK={kernelName:TS,backendName:"cpu",kernelFunc:function e(t){const{inputs:n,backend:r}=t,{x:a}=n;if("string"===a.dtype)throw new Error("onesLike is not supported for string tensors");if("complex64"===a.dtype){const t=wV({inputs:{input:a},backend:r}),n=e({inputs:{x:t},backend:r}),i=FH({inputs:{input:a},backend:r}),o=SK({inputs:{x:i},backend:r}),s=bV({inputs:{real:n,imag:o},backend:r});return r.disposeIntermediateTensorInfo(t),r.disposeIntermediateTensorInfo(n),r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),s}return qG({backend:r,attrs:{shape:a.shape,value:1,dtype:a.dtype}})}};function _K(e){const{inputs:t,backend:n,attrs:r}=e,{axis:a}=r;if(1===t.length)return AG({inputs:{input:t[0]},backend:n,attrs:{dim:a}});const i=t[0].shape,o=t[0].dtype;t.forEach(e=>{Xw(i,e.shape,"All tensors passed to stack must have matching shapes"),Kw(o===e.dtype,()=>"All tensors passed to stack must have matching dtypes")});const s=[],l=t.map(e=>{const t=AG({inputs:{input:e},backend:n,attrs:{dim:a}});return s.push(t),t}),c=LH({inputs:l,backend:n,attrs:{axis:a}});return s.forEach(e=>n.disposeIntermediateTensorInfo(e)),c}const IK={kernelName:RS,backendName:"cpu",kernelFunc:_K};const TK={kernelName:DS,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{paddings:i,constantValue:o}=r;XU(a,"pad");const s=i.map((e,t)=>e[0]+a.shape[t]+e[1]),l=i.map(e=>e[0]),c=n.data.get(a.dataId).values,u=$w(a.shape),h=a.shape.length,d=pk(a.shape),f=$w(s),p=s.length,g=pk(s),m=ik(a.dtype,f);0!==o&&m.fill(o);for(let v=0;v<u;v++){const e=kk(v,h,d).map((e,t)=>e+l[t]);m[wk(e,p,g)]=c[v]}return{dataId:n.write(m,s,a.dtype),shape:s,dtype:a.dtype}}},AK=oV((e,t)=>Math.pow(e,t)),RK=EV(FS,AK),DK={kernelName:FS,backendName:"cpu",kernelFunc:RK};function FK(e,t,n,r){const[a,i]=xA(e,r),o=UE(t,"int32"),s=bk($w(a),o),l=$w(i);for(let c=0;c<s.length;++c){const e=c*l;let t=1;for(let r=0;r<l;++r)t*=n[e+r];s[c]=t}return{outVals:s,outShape:a,outDtype:o}}const OK={kernelName:LS,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:o}=r;XU(a,"prod");const s=a.shape.length,l=rk(i,a.shape),c=kA(l,s);let u=l,h=a;const d=[];null!=c&&(h=GV({inputs:{x:a},backend:n,attrs:{perm:c}}),d.push(h),u=SA(u.length,s));const f=n.data.get(h.dataId).values,{outVals:p,outShape:g,outDtype:m}=FK(h.shape,h.dtype,f,u);let v=g;return o&&(v=yA(g,l)),d.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.makeTensorInfo(v,m,p)}};function LK(e,t,n,r){const a=[];let i=0;const o=t.length-1+n.length,s=new Array(o).fill(null).map(()=>[0]);!function(e,t){for(let n=0;n<e.length;++n){const r=e[n],a=n===e.length-1?t:e[n+1].length;if(0===r.length)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>a)throw new Error("Ragged splits must not point past values");for(let e=1;e<r.length;++e)if(r[e-1]>r[e])throw new Error("Ragged splits must be sorted in ascending order")}}(n,r);let l=1;for(let c=0;c<t.length-1;++c){l*=t[c];const e=t[c+1];for(let t=1;t<l+1;++t)s[c].push(t*e)}for(let c=0;c<e.length;++c){let r=e[c],o=e[c]+1;for(let e=0;e<n.length;++e){const a=n[e],i=e+t.length-1;if(i>=0){const e=s[i],t=e[e.length-1]-a[r];for(let n=r;n<o;++n)s[i].push(a[n+1]+t)}r=a[r],o=a[o]}o!==r&&(a.push([r,o]),i+=o-r)}return{outSplits:s,valueSlices:a,numValues:i}}function PK(e,t){const n=e.slice(0,t);for(;n.length<t;)n.push(1);for(let r=t;r<e.length;r++)n[t-1]*=e[r];return n}function MK(e,t,n,r,a){const i=t.slice();i[0]=a;const o=ok(n,$w(i)),s=e.length;return function(e,t,n,r,a,i){const o=PK(t,2)[1],s=PK(i,2)[1];let l=0;for(const c of n)for(let t=c[0];t<c[1];++t){for(let n=0;n<r;++n)a[l*s+n]=e[t*o+n];++l}}(e,t,r,0===s?0:s/t[0],o,i),[o,i]}function jK(e,t,n,r,a,i,o,s){if(0===e.length)throw new Error("paramsNestedSplits must be non empty");if(0===t[0].length)throw new Error("Split tensors must not be scalars");if(function(e,t,n){e.forEach((e,r)=>{if(e<0||e>=n){const a=kk(r,t.length,pk(t)).join(",");throw new Error("indices[".concat(a,"] = ").concat(e," is not in [0, ").concat(n,")"))}})}(i,o,t[0][0]-1),0===r.length)throw new Error("params.rank must be nonzero");const l=r[0],{outSplits:c,valueSlices:u,numValues:h}=LK(i,o,e,l),d=function(e){const t=[];for(let n=0;n<e.length;++n){const r=ok("int32",e[n].length);t.push(r),e[n].forEach((e,t)=>r[t]=e)}return t}(c),f=MK(n,r,a,u,h);return[d,f[0],f[1]]}const BK={kernelName:PS,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:a,paramsDenseValues:i,indices:o}=t,{outputRaggedRank:s}=r,l=a.map(e=>n.data.get(e.dataId).values),c=a.map(e=>e.shape),u=n.data.get(i.dataId).values,h=n.data.get(o.dataId).values,[d,f,p]=jK(l,c,u,i.shape,i.dtype,h,o.shape),g=d.map(e=>n.makeTensorInfo([e.length],"int32",e)),m=n.makeTensorInfo(p,i.dtype,f);return g.concat([m])}},zK=2147483647;function WK(e,t,n,r,a,i,o){if(t.length>1)throw new Error("starts must be a scalar or vector");if(a.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");const s=0===t.length,l=0===a.length,c=0===o.length,u=[];s||u.push(t[0]),l||u.push(a[0]),c||u.push(o[0]);for(let g=1;g<u.length;++g)if(u[g]!==u[g-1])throw new Error("starts, limits, and deltas must have the same shape");const h=0===u.length?1:u[0],d=ok("int32",h+1);d[0]=0;for(let g=0;g<h;++g){const t=s?e[0]:e[g],n=l?r[0]:r[g],a=c?i[0]:i[g];if(0===a)throw new Error("Requires delta != 0");let o;if(a>0&&n<t||a<0&&n>t)o=0;else if(o=Math.ceil(Math.abs((n-t)/a)),o>zK)throw new Error("Requires ((limit - start) / delta) <= ".concat(zK));d[g+1]=d[g]+o}const f=ok(n,d[h]);let p=0;for(let g=0;g<h;++g){const t=d[g+1]-d[g];let n=s?e[0]:e[g];const r=c?i[0]:i[g];for(let e=0;e<t;++e)f[p++]=n,n+=r}return[d,f]}const UK={kernelName:MS,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{starts:r,limits:a,deltas:i}=t,o=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,[c,u]=WK(o,r.shape,r.dtype,s,a.shape,l,i.shape);return[n.makeTensorInfo([c.length],"int32",c),n.makeTensorInfo([u.length],r.dtype,u)]}};var VK=CD;class HK{constructor(e,t,n,r,a,i,o,s,l,c){this.shape=e,this.shapeShape=t,this.values=n,this.valuesShape=r,this.valuesDType=a,this.defaultValue=i,this.defaultValueShape=o,this.rowPartitionValues=s,this.rowPartitionValuesShapes=l,this.rowPartitionTypes=_D(c),this.raggedRank=ID(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===VK.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===VK.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const t=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case VK.VALUE_ROWIDS:return HK.getMaxWidthValueRowID(t);case VK.ROW_SPLITS:return HK.getMaxWidthRowSplit(t);default:throw new Error("Cannot handle partition type ".concat(VK[this.getRowPartitionTypeByDimension(e-1)]))}}static getMaxWidthRowSplit(e){const t=e.length;if(0===t||1===t)return 0;let n=0;for(let r=0;r<t-1;++r){const t=e[r+1]-e[r];t>n&&(n=t)}return n}static getMaxWidthValueRowID(e){const t=e.length;if(0===t)return 0;let n=0,r=e[0],a=0;for(let i=1;i<t;++i){const t=e[i];t!==r&&(r=t,a=Math.max(i-n,a),n=i)}return Math.max(t-n,a)}tensorShapeFromTensor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(0===t.length){if(-1===e[0])return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return qK(e,n)}calculateOutputSize(e){const t=this.valuesShape;TD(this.defaultValueShape,t);const n=this.tensorShapeFromTensor(this.shape,this.shapeShape),r=ED(this.raggedRank,n,t);r[0]<0&&(r[0]=e);for(let a=1;a<=this.raggedRank;++a)r[a]<0&&(r[a]=this.getMaxWidth(a));return r}calculateFirstParentOutputIndex(e,t,n){const r=Math.min(e,n),a=[];let i=0;for(let o=0;o<r;++o,i+=t)a.push(i);for(let o=r;o<e;++o)a.push(-1);return Kw(a.length===e,()=>"Final length of result must be equal to firstDimension."),a}calculateOutputIndexRowSplit(e,t,n,r){const a=e.length,i=[];for(let o=0;o<a-1;++o){const a=e[o+1]-e[o];let s=Math.min(r,a),l=t[o];-1===l&&(s=0);for(let e=0;e<s;++e)i.push(l),l+=n;for(let e=0;e<a-s;++e)i.push(-1)}if(a>0&&i.length!==e[a-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(e,t,n,r){const a=e.length,i=[];if(0===a)return[];let o=0,s=e[0];if(s>=t.length)throw new Error("Got currentValueRowId=".concat(s,", which is not less than ").concat(t.length));let l=t[s];i.push(l);for(let c=1;c<a;++c){const a=e[c];if(a===s)l>=0&&(++o,o<r?l+=n:l=-1);else{if(o=0,s=a,a>=t.length)throw new Error("Got nextValueRowId=".concat(a," which is not less than ").concat(t.length));l=t[a]}i.push(l)}if(i.length!==e.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(e,t,n,r){const a=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case VK.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(a,t,n,r);case VK.ROW_SPLITS:if(a.length-1>t.length)throw new Error("Row partition size is greater than output size: ".concat(a.length-1," > ").concat(t.length));return this.calculateOutputIndexRowSplit(a,t,n,r);default:throw new Error("Unsupported partition type: ".concat(VK[i]))}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(0===this.rowPartitionTypes.length)throw new Error("No row_partition_types given.");const t=this.rowPartitionTypes[0];switch(t){case VK.FIRST_DIM_SIZE:return e[0];case VK.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case VK.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error("Cannot handle type ".concat(VK[t]))}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const e=this.getFirstDimensionSize(),t=this.calculateOutputSize(e),n=new Array(this.raggedRank+1);n[n.length-1]=1;for(let i=n.length-2;i>=0;--i)n[i]=n[i+1]*t[i+1];const r=qK(t,!1),a=ok(this.valuesDType,$w(r));if(n[0]*t[0]>0){let i=this.calculateFirstParentOutputIndex(e,n[0],t[0]);for(let e=1;e<=this.raggedRank;++e){i=this.calculateOutputIndex(e-1,i,n[e],t[e])}this.setOutput(this.raggedRank,i,a,r)}return[r,a]}setOutput(e,t,n,r){if(0===n.length)return;const a=this.values,i=n;let o=r.slice();o=o.slice(e+1);const s=$w(o),l=t.length;let c=this.defaultValue;if(c.length!==s&&1!==c.length){const e=this.defaultValueShape;b_(()=>{const t=RT(c,e),n=jT(t,o);c=n.dataSync()})}let u=0,h=0,d=0;for(let f=0;f<=l;++f){let e=f<l?t[f]:-1;if(e!==d){if(h<d){const e=a.subarray(u*s);GK(i.subarray(h*s),e,(d-h)*s)}if(f>=l){const t=n.length;e=Math.floor(t/s)}if(e>d)if(1===this.defaultValue.length)i.subarray(d*s,e*s).fill(this.defaultValue[0]),d=e;else for(;e>d;){GK(i.slice(d*s),c,s),++d}e<0?(u=f+1,h=d):(u=f,h=d,d=h+1)}else++d}}}function GK(e,t,n){for(let r=0;r<n;r++)e[r]=t[r]}function qK(e,t){const n=[];for(let r of e){if(r<0){if(!t)throw new Error("Dimension ".concat(r," must be >= 0"));if(r<-1)throw new Error("Dimension ".concat(r," must be >= -1"));r=-1}n.push(r)}return n}function KK(e,t,n,r,a,i,o,s,l,c){return new HK(e,t,n,r,a,i,o,s,l,c).compute()}const XK={kernelName:jS,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{shape:a,values:i,defaultValue:o,rowPartitionTensors:s}=t,{rowPartitionTypes:l}=r,c=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,h=n.data.get(o.dataId).values,d=s.map(e=>n.data.get(e.dataId).values),f=s.map(e=>e.shape),[p,g]=KK(c,a.shape,u,i.shape,i.dtype,h,o.shape,d,f,l);return n.makeTensorInfo(p,i.dtype,g)}};function YK(e,t,n,r){if(e===t||e<t&&n<0||t<e&&n>1)return bk(0,r);const a=bk(Math.abs(Math.ceil((t-e)/n)),r);t<e&&1===n&&(n=-1),a[0]=e;for(let i=1;i<a.length;i++)a[i]=a[i-1]+n;return a}const $K={kernelName:BS,backendName:"cpu",kernelFunc:function(e){const{backend:t,attrs:n}=e,{start:r,stop:a,dtype:i,step:o}=n,s=YK(r,a,o,i);return t.makeTensorInfo([s.length],i,s)}},JK=QU(WS,e=>1/e),QK={kernelName:WS,backendName:"cpu",kernelFunc:JK};const ZK={kernelName:qS,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:a}=t,{alignCorners:i,halfPixelCenters:o,size:s}=r;XU(a,"resizeBilinear");const l=pk(a.shape),[c,u]=s,[h,d,f,p]=a.shape,g=n.data.get(a.dataId).values,m=new Float32Array($w([h,c,u,p])),v=[i&&c>1?d-1:d,i&&u>1?f-1:f],b=[i&&c>1?c-1:c,i&&u>1?u-1:u];let x=0;const y=v[0]/b[0],w=v[1]/b[1];for(let k=0;k<h;k++)for(let e=0;e<c;e++){let t;t=o?y*(e+.5)-.5:y*e;const n=Math.max(0,Math.floor(t)),r=t-n,a=Math.min(d-1,Math.ceil(t)),i=k*l[0]+n*l[1],s=k*l[0]+a*l[1];for(let e=0;e<u;e++){let t;t=o?w*(e+.5)-.5:w*e;const n=Math.max(0,Math.floor(t)),a=t-n,c=Math.min(f-1,Math.ceil(t)),u=i+n*l[2],h=s+n*l[2],d=i+c*l[2],v=s+c*l[2];for(let e=0;e<p;e++){const t=g[u+e],n=g[h+e],i=t+(g[d+e]-t)*a,o=i+(n+(g[v+e]-n)*a-i)*r;m[x++]=o}}}return n.makeTensorInfo([h,c,u,p],"float32",m)}};const eX={kernelName:KS,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:a,dy:i}=t,{alignCorners:o}=r;XU([i,a],"resizeBilinearGrad");const s=pk(a.shape),[l,c,u,h]=a.shape,[,d,f]=i.shape,p=new Float32Array(l*c*u*h),g=[o&&d>1?c-1:c,o&&f>1?u-1:u],m=[o&&d>1?d-1:d,o&&f>1?f-1:f],v=g[0]/m[0],b=g[1]/m[1],x=n.data.get(i.dataId).values;let y=0;for(let w=0;w<l;w++){const e=w*s[0];for(let t=0;t<d;t++){const n=t*v,r=Math.floor(n),a=Math.min(Math.ceil(n),c-1),i=e+r*s[1],o=e+a*s[1],l=n-r,d=1-l;for(let e=0;e<f;e++){const t=e*b,n=Math.floor(t),r=Math.min(Math.ceil(t),u-1),a=t-n,c=1-a,f=i+n*s[2],g=i+r*s[2],m=o+n*s[2],v=o+r*s[2],w=d*c,k=d*a,N=l*c,S=l*a;for(let e=0;e<h;e++){const t=x[y++];p[f+e]+=t*w,p[g+e]+=t*k,p[m+e]+=t*N,p[v+e]+=t*S}}}}return n.makeTensorInfo([l,u,c,h],"float32",p)}};const tX={kernelName:HS,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:a}=t,{alignCorners:i,halfPixelCenters:o,size:s}=r;XU(a,"resizeNearestNeighbor");const l=pk(a.shape),[c,u]=s,[h,d,f,p]=a.shape,g=n.data.get(a.dataId).values,m=new Float32Array(h*c*u*p),v=[i&&c>1?d-1:d,i&&u>1?f-1:f],b=[i&&c>1?c-1:c,i&&u>1?u-1:u],x=v[0]/b[0],y=v[1]/b[1];let w=0;for(let k=0;k<h;k++){const e=k*l[0];for(let t=0;t<c;t++){const n=o?x*(t+.5):x*t;let r=Math.min(d-1,i?Math.round(n):Math.floor(n));o&&(r=Math.max(0,r));const a=e+r*l[1];for(let e=0;e<u;e++){const t=o?y*(e+.5):y*e;let n=Math.min(f-1,i?Math.round(t):Math.floor(t));o&&(n=Math.max(0,n));const r=a+n*l[2];for(let e=0;e<p;e++){const t=g[r+e];m[w++]=t}}}}return n.makeTensorInfo([h,c,u,p],a.dtype,m)}};const nX={kernelName:GS,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:a,dy:i}=t,{alignCorners:o}=r;XU([i,a],"resizeNearestNeighborGrad");const s=pk(a.shape),l=pk(i.shape),[c,u,h,d]=a.shape,[,f,p]=i.shape,g=new Float32Array(c*u*h*d),m=n.data.get(i.dataId).values,v=[o&&f>1?u-1:u,o&&p>1?h-1:h],b=[o&&f>1?f-1:f,o&&p>1?p-1:p],x=v[0]/b[0],y=v[1]/b[1],w=1/x,k=1/y,N=2*Math.ceil(w)+2,S=2*Math.ceil(k)+2;for(let C=0;C<c;C++){const e=C*s[0];for(let t=0;t<u;t++){const n=e+t*s[1],r=Math.floor(t*w),a=Math.floor(r-N/2);for(let i=0;i<h;i++){const r=n+i*s[2],c=Math.floor(i*k),v=Math.floor(c-S/2);for(let n=0;n<d;n++){let s=0;for(let r=0;r<N;r++){const c=r+a;if(c<0||c>=f)continue;const d=e+c*l[1],g=c*x;if(t===Math.min(u-1,o?Math.round(g):Math.floor(g)))for(let e=0;e<S;e++){const t=e+v;if(t<0||t>=p)continue;const r=d+t*l[2],a=t*y;i===Math.min(h-1,o?Math.round(a):Math.floor(a))&&(s+=m[r+n])}}g[r+n]=s}}}}return n.makeTensorInfo(a.shape,a.dtype,g)}};const rX={kernelName:YS,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{dims:i}=r;XU(a,"reverse");const o=a.shape.length,s=rk(i,a.shape);if(0===o)return nV({inputs:{x:a},backend:n});const l=new TE(a.shape,a.dtype),c=n.bufferSync(a);for(let u=0;u<l.size;u++){const e=l.indexToLoc(u),t=e.slice();s.forEach(e=>t[e]=a.shape[e]-1-t[e]),l.set(c.get(...t),...e)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}},aX={kernelName:BC,backendName:"cpu",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{image:a}=t,{radians:i,fillValue:o,center:s}=n,l=r,c=ik(a.dtype,$w(a.shape)),[u,h,d,f]=a.shape,[p,g]=DD(s,h,d),m=Math.sin(i),v=Math.cos(i),b=l.data.get(a.dataId).values;for(let x=0;x<u;x++){const e=x*d*h*f;for(let t=0;t<h;t++){const n=t*(d*f);for(let r=0;r<d;r++){const a=r*f;for(let i=0;i<f;i++){const s=[u,t,r,i],l=s[2],x=s[1];let y=(l-p)*v-(x-g)*m,w=(l-p)*m+(x-g)*v;y=Math.round(y+p),w=Math.round(w+g);let k=o;if("number"!==typeof o&&(k=3===i?255:o[i]),y>=0&&y<d&&w>=0&&w<h){k=b[e+w*(d*f)+y*f+i]}c[e+n+a+i]=k}}}}return{dataId:l.write(c,a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},iX=QU($S,e=>{const t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2===0?t:t+1}),oX={kernelName:$S,backendName:"cpu",kernelFunc:iX},sX=JU(e=>1/Math.sqrt(e)),lX=ZU(JS,sX),cX={kernelName:JS,backendName:"cpu",kernelFunc:lX};function uX(e,t,n,r,a,i,o,s,l,c){const u=[r/a,a],h=e.values,d=t.values;if(0===r)return iI(n,t.dtype);const f=l instanceof TE?l:iI(u,t.dtype);"string"===typeof l||"number"===typeof l?f.values.fill(l):"boolean"===typeof l&&f.values.fill(+l);for(let p=0;p<i;p++){const e=[];let i=0;for(let t=0;t<o;t++){const n=h[p*o+t];e.push(n),i+=n*s[t]}if(i<0||i>=r/a)throw new Error("Invalid indices: ".concat(e," does not index into ").concat(n));for(let n=0;n<a;n++)c?f.values[i*a+n]+=d[p*a+n]:f.values[i*a+n]=0===t.rank?d[0]:d[p*a+n]}return f}const hX={kernelName:QS,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{indices:a,updates:i}=t,{shape:o}=r,{sliceRank:s,numUpdates:l,sliceSize:c,strides:u,outputSize:h}=WD(0,a,o),d=uX(n.bufferSync(a),n.bufferSync(i),o,h,c,l,s,u,0,!0);return n.makeTensorInfo(o,d.dtype,d.values)}};function dX(e,t){let n=0,r=e.length,a=0;for(;n<r;)a=Math.floor((n+r)/2),e[a]<t?n=a+1:r=a;return r}function fX(e,t){let n=0,r=e.length,a=0;for(;n<r;)a=Math.floor((n+r)/2),e[a]<=t?n=a+1:r=a;return r}const pX={kernelName:eC,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{sortedSequence:a,values:i}=t,{side:o}=r,s=function(e,t,n,r,a,i){const o=ok("int32",n*a);for(let s=0;s<n;++s){const n=e.slice(s*r,(s+1)*r),l=s*a;for(let e=0;e<a;++e)o[l+e]="left"===i?dX(n,t[e+l]):fX(n,t[e+l])}return o}(n.data.get(a.dataId).values,n.data.get(i.dataId).values,a.shape[0],a.shape[1],i.shape[1],o);return n.makeTensorInfo(i.shape,"int32",s)}};const gX={kernelName:tC,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{condition:r,t:a,e:i}=t;XU([r,a,i],"select");const o=r.shape.length,s=n.data.get(r.dataId).values,l=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,u=UE(a.dtype,i.dtype),h=bk($w(a.shape),u);let d=0;const f=0===o||o>1||1===a.shape.length?1:$w(a.shape.slice(1));for(let p=0;p<s.length;p++)for(let e=0;e<f;e++)1===s[p]?h[d++]=l[p]:h[d++]=c[p];return n.makeTensorInfo(a.shape,u,h)}},mX=UD,vX=VD,bX=QU(nC,e=>e>=0?vX*e:mX*(Math.exp(e)-1)),xX={kernelName:nC,backendName:"cpu",kernelFunc:bX},yX=QU(oC,e=>e<0?-1:e>0?1:0),wX={kernelName:oC,backendName:"cpu",kernelFunc:yX},kX=QU(aC,e=>Math.sin(e)),NX={kernelName:aC,backendName:"cpu",kernelFunc:kX},SX=QU(iC,e=>Math.sinh(e)),CX={kernelName:iC,backendName:"cpu",kernelFunc:SX},EX=Math.log(1.1920928955078125e-7)+2,_X=QU(lC,e=>{const t=e>-EX,n=e<EX,r=Math.exp(e);let a;return a=n?r:t?e:Math.log(1+r),a}),IX={kernelName:lC,backendName:"cpu",kernelFunc:_X};const TX={kernelName:hC,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:i,paddings:o}=r;XU([a],"spaceToBatchND");const s=$w(i),l=[[0,0]];l.push(...o);for(let m=1+i.length;m<a.shape.length;++m)l.push([0,0]);const c=TK.kernelFunc({inputs:{x:a},backend:n,attrs:{paddings:l,constantValue:0}}),u=FD(c.shape,i,s,!1),h=OD(u.length,i.length,!1),d=LD(c.shape,i,s,!1),f=DV({inputs:{x:c},backend:n,attrs:{shape:u}}),p=GV({inputs:{x:f},backend:n,attrs:{perm:h}}),g=DV({inputs:{x:p},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),g}};function AX(e,t,n,r,a,i,o){const s=t[0],l=i[0],c=new Array(l),u=new Array(s),h=t[1];if(0===l){if(0!==s)throw new Error(gF(s));return[ok(n,0),[0,h],ok(a,0),c,u]}let d=!0,f=0;const p=new Array(l).fill(0);for(let m=0;m<s;++m){const t=e[m*h];if(t<0)throw new Error(mF(m,t));if(t>=l)throw new Error(vF(m,t,l));++p[t],d=d&&t>=f,f=t}let g=!0;for(let m=0;m<l;++m){const e=0===p[m];c[m]=e,g=g&&!e,p[m]=Math.max(p[m],1),m>0&&(p[m]+=p[m-1])}if(g&&d){const t=e,n=r;for(let e=0;e<s;++e)u[e]=e;return[t,[s,h],n,c,u]}{const t=p[l-1],i=ok(n,t*h),d=ok(a,t),f=new Array(l).fill(0);for(let n=0;n<s;++n){const t=e[n*h],a=f[t],o=(0===t?0:p[t-1])+a;f[t]++;for(let r=0;r<h;++r)i[o*h+r]=e[n*h+r];d[o]=r[n],u[n]=o}for(let e=0;e<l;++e){if(0===f[e]){const t=0===e?0:p[e-1];i[t*h+0]=e;for(let e=1;e<h;++e)i[t*h+e]=0;d[t]=o}}return[i,[t,h],d,c,u]}}const RX={kernelName:pC,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{indices:r,values:a,denseShape:i,defaultValue:o}=t;if(1!==i.shape.length)throw new Error("Dense shape must be a vector, saw:\n        ".concat(i.shape));if(2!==r.shape.length)throw new Error("Indices must be a matrix, saw:\n        ".concat(r.shape));if(1!==a.shape.length)throw new Error("Values must be a vector, saw:\n        ".concat(a.shape));if(0!==o.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(o.shape));const s=n.data.get(r.dataId).values,l=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values[0],[h,d,f,p,g]=AX(s,r.shape,r.dtype,l,a.dtype,c,u);return[n.makeTensorInfo(d,r.dtype,h),n.makeTensorInfo([d[0]],a.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(e=>Number(e)))),n.makeTensorInfo([g.length],r.dtype,new Int32Array(g))]}};function DX(e,t,n,r,a){const i=$w(r),o=t[0],s=a.length,l=[];let c=1,u=-1;for(let g=0;g<s;++g){const e=a[g];if(-1===e){if(-1!==u)throw new Error(bF(u,g));u=g,l.push(1)}else{if(e<0)throw new Error(xF(g,e));c*=e,l.push(e)}}if(-1!==u){if(c<=0)throw new Error("reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero");const e=Math.trunc(i/c);if(c*e!==i)throw new Error(wF(r,l));l[u]=e}if($w(l)!==i)throw new Error(kF(r,l));const h=r.length,d=[];if(h>0){d[h-1]=1;for(let e=h-2;e>=0;--e)d[e]=d[e+1]*r[e+1]}const f=[];if(s>0){f[s-1]=1;for(let e=s-2;e>=0;--e)f[e]=f[e+1]*l[e+1]}const p=ok(n,o*s);for(let g=0;g<o;++g){let t=0;for(let n=0;n<h;++n)t+=e[g*h+n]*d[n];for(let e=0;e<s;++e)p[g*s+e]=Math.trunc(t/f[e]),t%=f[e]}return[p,[o,s],l]}const FX={kernelName:gC,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{inputIndices:r,inputShape:a,newShape:i}=t;if(2!==r.shape.length)throw new Error("Input indices should be a matrix but received shape\n        ".concat(r.shape));if(1!==a.shape.length)throw new Error("Input shape should be a vector but received shape\n        ".concat(a.shape));if(1!==i.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(i.shape));const o=Array.from(n.data.get(a.dataId).values),s=n.data.get(r.dataId).values,l=Array.from(n.data.get(i.dataId).values),[c,u,h]=DX(s,r.shape,r.dtype,o,l);return[n.makeTensorInfo(u,r.dtype,c),n.makeTensorInfo([h.length],i.dtype,new Int32Array(h))]}};function OX(e,t,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;const s=r.length,l=[t[0],e.length/t[0]],c=l[1],u=s>0?a[s-1]+1:0;if(u<0)throw new Error("segment ids must be >= 0");const h=t.slice();h[0]=u;const d=h.reduce((e,t)=>e*t,1),f=ok(n,d);if(0===s)return u>0&&f.fill(o),[f,h];if(u<=0)throw new Error("segment ids must be >= 0");let p=0,g=1,m=0,v=a[p];for(;;){let t=0;if(g<s){if(t=a[g],v===t){++g;continue}if(v>=t)throw new Error(SF())}if(v<0||v>=u)throw new Error(CF(v,u));v>m&&f.fill(o,m*c,v*c);for(let n=p;n<g;++n){const t=r[n];if(t<0||t>=l[0])throw new Error(EF(n,r[n],l[0]));for(let n=0;n<c;n++)f[v*c+n]+=e[t*c+n]}if(i)for(let e=0;e<c;e++)f[v*c+e]/=g-p;if(p=g,++g,m=v+1,v=t,g>s)break}return m<u&&f.fill(o,m*c,u*c),[f,h]}const LX={kernelName:mC,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{data:r,indices:a,segmentIds:i}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n          ".concat(a.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n          ".concat(i.shape));if(a.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,[c,u]=OX(o,r.shape,r.dtype,s,l,!0);return n.makeTensorInfo(u,r.dtype,c)}};const PX={kernelName:vC,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{data:r,indices:a,segmentIds:i}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n         ".concat(a.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n         ".concat(i.shape));if(a.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,[c,u]=OX(o,r.shape,r.dtype,s,l);return n.makeTensorInfo(u,r.dtype,c)}};const MX={kernelName:bC,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{sparseIndices:a,sparseValues:i,defaultValue:o}=t,{outputShape:s}=r,{sliceRank:l,numUpdates:c,sliceSize:u,strides:h,outputSize:d}=WD(0,a,s),f=!1,p=n.bufferSync(a);let g;switch(i.dtype){case"bool":g=uX(p,n.bufferSync(i),s,d,u,c,l,h,Boolean(n.data.get(o.dataId).values[0]),f);break;case"float32":g=uX(p,n.bufferSync(i),s,d,u,c,l,h,n.data.get(o.dataId).values[0],f);break;case"int32":g=uX(p,n.bufferSync(i),s,d,u,c,l,h,n.data.get(o.dataId).values[0],f);break;case"string":g=uX(p,n.bufferSync(i),s,d,u,c,l,h,bE(n.data.get(o.dataId).values[0]),f);break;default:throw new Error("Unsupported type ".concat(i.dtype))}return n.makeTensorInfo(s,g.dtype,g.values)}};const jX={kernelName:dC,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{numOrSizeSplits:i,axis:o}=r,s=rk(o,a.shape)[0],l=pF(a,i,s),c=new Array(a.shape.length).fill(0),u=a.shape.slice();return l.map(e=>{const t=[...u];t[s]=e;const r=vH({inputs:{x:a},backend:n,attrs:{begin:c,size:t}});return c[s]+=e,r})}},BX=JU(e=>Math.sqrt(e)),zX=QU(cC,e=>Math.sqrt(e)),WX={kernelName:cC,backendName:"cpu",kernelFunc:zX},UX={kernelName:yC,backendName:"cpu",kernelFunc:e=>{let{inputs:t,backend:n}=e;const{x:r}=t,a=n;XU(r,"square");const i=a.data.get(r.dataId).values,o=new Float32Array(i.length);for(let s=0;s<i.length;++s){const e=i[s];o[s]=e*e}return{dataId:a.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},VX=oV((e,t)=>{const n=e-t;return n*n}),HX=EV(xC,VX),GX={kernelName:xC,backendName:"cpu",kernelFunc:HX},qX=JU((e,t)=>{const{pattern:n,replaceGlobal:r,rewrite:a}=t;return e.replace(new RegExp(n,r?"g":""),a)}),KX=ZU(wC,qX),XX={kernelName:wC,backendName:"cpu",kernelFunc:KX},YX=QU(MC,(e,t)=>{const n=t;return isNaN(e)?NaN:e>0?1:n.alpha}),$X={kernelName:MC,backendName:"cpu",kernelFunc:YX};function JX(e,t,n,r){const a=iI(e,t.dtype);for(let i=0;i<a.size;i++){const e=a.indexToLoc(i),o=new Array(e.length);for(let t=0;t<o.length;t++)o[t]=e[t]*n[t]+r[t];a.set(t.get(...o),...e)}return a}const QX={kernelName:kC,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{begin:i,end:o,strides:s,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:h,shrinkAxisMask:d}=r;XU(a,"stridedSlice");const{finalShapeSparse:f,finalShape:p,isIdentity:g,sliceDim0:m,isSimpleSlice:v,begin:b,end:x,strides:y}=hT(a.shape,i,o,s,l,c,u,h,d);let w;if(g)w=DV({inputs:{x:a},backend:n,attrs:{shape:p}});else if(m||v){Kw(a.shape.length>=1,()=>"Input must have rank at least 1, got: ".concat(a.shape.length));const e=QI(b,x,y),t=vH({inputs:{x:a},backend:n,attrs:{begin:b,size:e}});w=DV({inputs:{x:t},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(t)}else{const e=JX(f,n.bufferSync(a),y,b);w=n.makeTensorInfo(p,e.dtype,e.values)}return w}};class ZX{constructor(e,t,n,r,a,i){this.separator=vE(e),this.nGramWidths=t,this.leftPad=vE(n),this.rightPad=vE(r),this.padWidth=a,this.preserveShort=i}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){const n=this.getPadWidth(t);return Math.max(0,e+2*n-t+1)}createNGrams(e,t,n,r,a,i){for(let o=0;o<a;++o){const s=this.getPadWidth(i),l=Math.max(0,s-o),c=Math.max(0,s-(a-(o+1))),u=i-(l+c),h=t+(l>0?0:o-s);let d=0;d+=l*this.leftPad.length;for(let t=0;t<u;++t)d+=e[h+t].length;d+=c*this.rightPad.length;d+=(l+c+u-1)*this.separator.length,n[r+o]=new Uint8Array(d);const f=n[r+o];let p=0;const g=e=>e.forEach(e=>f[p++]=e);for(let e=0;e<l;++e)g(this.leftPad),g(this.separator);for(let t=0;t<u-1;++t)g(e[h+t]),g(this.separator);if(u>0){g(e[h+u-1]);for(let e=0;e<c;++e)g(this.separator),g(this.rightPad)}else{for(let e=0;e<c-1;++e)g(this.rightPad),g(this.separator);g(this.rightPad)}}}compute(e,t){const n=e.length,r=t.length;if(r>0){let e=t[0];if(0!==e)throw new Error("First split value must be 0, got ".concat(e));for(let a=1;a<r;++a){let r=t[a]>=e;if(r=r&&t[a]<=n,!r)throw new Error("Invalid split value ".concat(t[a],", must be in [").concat(e,", ").concat(n,"]"));e=t[a]}if(e!==n)throw new Error("Last split value must be data size. Expected ".concat(n,", got ").concat(e))}const a=r-1,i=ok("int32",r);if(0===n||0===r){const e=new Array(n);for(let t=0;t<=a;++t)i[t]=0;return[e,i]}i[0]=0;for(let s=1;s<=a;++s){const e=t[s]-t[s-1];let n=0;this.nGramWidths.forEach(t=>{n+=this.getNumNGrams(e,t)}),this.preserveShort&&e>0&&0===n&&(n=1),i[s]=i[s-1]+n}const o=new Array(i[a]);for(let s=0;s<a;++s){const n=t[s];let r=i[s];if(this.nGramWidths.forEach(a=>{const i=t[s+1]-t[s],l=this.getNumNGrams(i,a);this.createNGrams(e,n,o,r,l,a),r+=l}),this.preserveShort&&r===i[s]){const a=t[s+1]-t[s];if(0===a)continue;const i=a+2*this.padWidth,l=1;this.createNGrams(e,n,o,r,l,i)}}return[o,i]}}function eY(e,t,n,r,a,i,o,s){return new ZX(n,r,a,i,o,s).compute(e,t)}const tY={kernelName:NC,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{separator:a,nGramWidths:i,leftPad:o,rightPad:s,padWidth:l,preserveShortSequences:c}=r,{data:u,dataSplits:h}=t,d=n.data.get(u.dataId).values,f=n.data.get(h.dataId).values,[p,g]=eY(d,f,a,i,o,s,l,c);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(h.shape,"int32",g)]}};function nY(e,t,n,r){if(!e.length)return;if(0===t.length){for(let t=0;t<e.length;++t)r.push(e.subarray(t,t+1));return}if(1===t.length){const a=t[0];let i=e.indexOf(a);for(;-1!==i;){const t=e.subarray(0,i);n&&0===t.length||r.push(t),i=(e=e.subarray(i+1)).indexOf(a)}return void(n&&0===e.length||r.push(e))}let a=0;for(let i=0;i<e.length+1;i++)if(i===e.length||-1!==t.indexOf(e[i])){const t=e.subarray(a,i);n&&0===t.length||r.push(t),a=i+1}}function rY(e,t,n){const r=e.length,a=[];let i=0,o=0;const s=new Array(r);for(let d=0;d<r;++d){const r=a.length;nY(e[d],t,n,a);const l=a.length-r;s[d]=l,i+=l,o=Math.max(o,l)}const l=ok("int32",2*i),c=new Array(i),u=[r,o];let h=0;for(let d=0;d<r;++d)for(let e=0;e<s[d];++e)l[2*h]=d,l[2*h+1]=e,c[h]=a[h],++h;return[l,c,u]}const aY={kernelName:SC,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{skipEmpty:a}=r,{input:i,delimiter:o}=t;if("string"!==i.dtype)throw new Error("Input must be of datatype string");if(1!==i.shape.length)throw new Error("Input must be a vector, got shape: ".concat(i.shape));if(0!==o.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(o.shape));const s=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values[0],[c,u,h]=rY(s,l,a),d=u.length;return[n.makeTensorInfo([d,2],"int32",c),n.makeTensorInfo([d],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(h))]}};function iY(e,t){const n=ok("int32",e.length);for(let r=0;r<e.length;++r)n[r]=fE(e[r]).modulo(t).getLowBitsUnsigned();return n}const oY={kernelName:CC,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{numBuckets:a}=r,{input:i}=t;if("string"!==i.dtype)throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");const o=iY(n.data.get(i.dataId).values,a);return n.makeTensorInfo(i.shape,"int32",o)}},sY=QU(_C,e=>Math.tan(e)),lY={kernelName:_C,backendName:"cpu",kernelFunc:sY},cY=QU(IC,e=>Math.tanh(e));const uY={kernelName:ZS,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{tensor:r,indices:a,updates:i}=t,{sliceRank:o,numUpdates:s,sliceSize:l,strides:c,outputSize:u}=WD(0,a,r.shape),h=n.bufferSync(a),d=n.bufferSync(i),f=n.bufferSync(r),p=uX(h,d,r.shape,u,l,s,o,c,f,!1);return n.makeTensorInfo(r.shape,p.dtype,p.values)}};function hY(e,t){const n=new Array(e.rank);for(let a=0;a<n.length;a++)n[a]=e.shape[a]*t[a];const r=iI(n,e.dtype);for(let a=0;a<r.values.length;++a){const t=r.indexToLoc(a),n=new Array(e.rank);for(let r=0;r<n.length;r++)n[r]=t[r]%e.shape[r];const i=e.locToIndex(n);r.values[a]=e.values[i]}return r}const dY={kernelName:TC,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{reps:i}=r;XU(a,"tile");const o=hY(n.bufferSync(a),i);return n.makeTensorInfo(o.shape,o.dtype,o.values)}},fY=(e,t)=>{const n=t.value-e.value;return 0===n?e.index-t.index:n};function pY(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length-1;for(;r>n;){if(r-n>600){const a=r-n+1,i=t-n+1,o=Math.log(a),s=.5*Math.exp(2*o/3),l=.5*Math.sqrt(o*s*(a-s)/a)*Math.sign(i-a/2);pY(e,t,Math.max(n,Math.floor(t-i*s/a+l)),Math.min(r,Math.floor(t+(a-i)*s/a+l)))}const a=e[t];let i=n,o=r;for(qw(e,n,t),fY(e[r],a)>0&&qw(e,n,r);i<o;){for(qw(e,i,o),i++,o--;fY(e[i],a)<0;)i+=1;for(;fY(e[o],a)>0;)o-=1}0===fY(e[n],a)?qw(e,n,o):(o+=1,qw(e,o,r)),o<=t&&(n=o+1),t<=o&&(r=o-1)}}function gY(e,t,n,r,a){const i=t[t.length-1],[o,s]=[e.length/i,i],l=ik(n,o*r),c=ik("int32",o*r);for(let h=0;h<o;h++){const t=h*s,n=e.subarray(t,t+s);let i=new Array(n.length);n.forEach((e,t)=>i[t]={value:e,index:t}),r<i.length&&(pY(i,r),i=i.slice(0,r)),a&&i.sort(fY);const o=h*r,u=l.subarray(o,o+r),d=c.subarray(o,o+r);for(let e=0;e<r;e++)u[e]=i[e].value,d[e]=i[e].index}const u=t.slice();return u[u.length-1]=r,[iI(u,n,l),iI(u,"int32",c)]}const mY={kernelName:AC,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{k:i,sorted:o}=r;XU(a,"topk");const s=n.data.get(a.dataId).values,[l,c]=gY(s,a.shape,a.dtype,i,o);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}};const vY={kernelName:RC,backendName:"cpu",kernelFunc:function(e){const{inputs:t,attrs:n,backend:r}=e,{image:a,transforms:i}=t,{interpolation:o,fillMode:s,fillValue:l,outputShape:c}=n,[u,h,d,f]=a.shape,[p,g]=null!=c?c:[h,d],m=[u,p,g,f],v=pk(a.shape),b=v[0],x=v[1],y=v[2],w=pk(m),k=w[0],N=w[1],S=w[2],C=ik(a.dtype,$w(m));C.fill(l);const E=r.data.get(a.dataId).values,_=r.data.get(i.dataId).values;for(let I=0;I<u;++I){const e=1===i.shape[0]?_:_.subarray(8*I,8*I+8);for(let t=0;t<p;++t)for(let n=0;n<g;++n)for(let r=0;r<f;++r){let a;const i=e[6]*n+e[7]*t+1;if(0===i)continue;const c=(e[0]*n+e[1]*t+e[2])/i,u=(e[3]*n+e[4]*t+e[5])/i,f=bY(c,d,s),p=bY(u,h,s);switch(o){case"nearest":a=yY(E,h,d,b,x,y,I,p,f,r,l);break;case"bilinear":a=wY(E,h,d,b,x,y,I,p,f,r,l);break;default:throw new Error("Error in Transform: Expect 'nearest' or "+"'bilinear', but got ".concat(o))}C[I*k+t*N+n*S+r]=a}return r.makeTensorInfo(m,a.dtype,C)}return{dataId:r.write(C,m,a.dtype),shape:a.shape,dtype:a.dtype}}};function bY(e,t,n){switch(n){case"reflect":return function(e,t){let n=e;if(n<0)if(t<=1)n=0;else{const e=2*t;n<e&&(n=e*Math.trunc(-n/e)+n),n=n<-t?n+e:-n-1}else if(n>t-1)if(t<=1)n=0;else{const e=2*t;n-=e*Math.trunc(n/e),n>=t&&(n=e-n-1)}return Hw(0,n,t-1)}(e,t);case"wrap":return function(e,t){let n=e;if(n<0)if(t<=1)n=0;else{const e=t-1;n+=t*(Math.trunc(-n/e)+1)}else if(n>t-1)if(t<=1)n=0;else{const e=t-1;n-=t*Math.trunc(n/e)}return Hw(0,n,t-1)}(e,t);case"nearest":return function(e,t){return Hw(0,e,t-1)}(e,t);default:return function(e){return e}(e)}}function xY(e,t,n,r,a,i,o,s,l,c,u){return 0<=s&&s<t&&0<=l&&l<n?e[o*r+s*a+l*i+c]:u}function yY(e,t,n,r,a,i,o,s,l,c,u){return xY(e,t,n,r,a,i,o,Math.round(s),Math.round(l),c,u)}function wY(e,t,n,r,a,i,o,s,l,c,u){const h=Math.floor(s),d=Math.floor(l),f=h+1,p=d+1;return(f-s)*((p-l)*xY(e,t,n,r,a,i,o,h,d,c,u)+(l-d)*xY(e,t,n,r,a,i,o,h,p,c,u))+(s-h)*((p-l)*xY(e,t,n,r,a,i,o,f,d,c,u)+(l-d)*xY(e,t,n,r,a,i,o,f,p,c,u))}function kY(e,t,n,r){const a=rk(t,n)[0],i=[1,n[0],1];for(let p=0;p<a;p++)i[0]*=n[p];i[1]=n[a];for(let p=a+1;p<n.length;p++)i[2]*=n[p];const o=new Map,s=new Int32Array(n[a]),l=new TE(i,r,e),c=[],u=1===i[0]&&1===i[2];for(let p=0;p<n[a];p++){let t;if(u)t=e[p].toString();else{const e=[];for(let t=0;t<i[0];t++)for(let n=0;n<i[2];n++)e.push(l.get(t,p,n));t=e.join(",")}const n=o.get(t);if(null!=n)s[p]=n;else{const e=o.size;o.set(t,e),s[p]=e,c.push(p)}}const h=i.slice();h[1]=o.size;const d=new TE(h,r);c.forEach((e,t)=>{for(let n=0;n<i[0];n++)for(let r=0;r<i[2];r++)d.set(l.get(n,e,r),n,t,r)});const f=n.slice();return f[a]=h[1],{outputValues:d.values,outputShape:f,indices:s}}const NY={kernelName:FC,backendName:"cpu",kernelFunc:function(e){const{inputs:t,attrs:n,backend:r}=e,{axis:a}=n,{x:i}=t;XU(i,"unique");const o=r.data.get(i.dataId).values,{outputValues:s,outputShape:l,indices:c}=kY(o,a,i.shape,i.dtype);return[r.makeTensorInfo(l,i.dtype,s),r.makeTensorInfo([c.length],"int32",c)]}};const SY={kernelName:OC,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{value:a}=t;let{axis:i}=r;i<0&&(i+=a.shape.length);const o=a.shape.length,s=a.shape[i],l=new Array(o-1);let c=0;for(let f=0;f<o;f++)f!==i&&(l[c++]=a.shape[f]);const u=new Array(o).fill(0),h=a.shape.slice();h[i]=1;const d=new Array(s);for(let f=0;f<d.length;f++){u[i]=f;const e=vH({inputs:{x:a},backend:n,attrs:{begin:u,size:h}});d[f]=DV({inputs:{x:e},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(e)}return d}};const CY={kernelName:LC,backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,segmentIds:i}=t,{numSegments:o}=r;XU(a,"unsortedSegmentSum");const s=[],l=[],c=a.shape.length-i.shape.length;let u=i;for(let d=0;d<c;++d){const e=AG({inputs:{input:u},backend:n,attrs:{dim:d+1}});u=e,l.push(e)}for(let d=0;d<o;++d){const e=pE(d,"int32"),t=n.makeTensorInfo([],"int32",e),r=vG({inputs:{a:t,b:u},backend:n}),i=SV({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),o=uG({inputs:{a:i,b:a},backend:n}),c=dG({inputs:{x:o},backend:n,attrs:{axis:0,keepDims:!1}});s.push(c),l.push(t),l.push(r),l.push(i),l.push(o),l.push(c)}const h=_K({inputs:s,backend:n,attrs:{axis:0}});return l.forEach(e=>n.disposeIntermediateTensorInfo(e)),h}},EY=[PV,jV,zV,UV,RV,VV,KV,XV,YV,$V,QV,eH,nH,iH,sH,hH,dH,fH,pH,LV,gH,xH,kH,SH,CH,CV,IH,AH,xV,RH,PH,jH,BH,zH,WH,UH,VH,GH,KH,XH,YH,$H,JH,QH,eG,tG,nG,rG,aG,iG,oG,sG,pG,tV,gG,bG,EG,TG,RG,OG,GG,KG,XG,JG,eq,tq,nq,aq,oq,cq,dq,rV,fq,OH,gq,vq,xq,iV,kq,Cq,_q,Aq,Dq,Lq,Mq,zq,Wq,Uq,Gq,Xq,Yq,$q,Jq,Qq,Zq,eK,tK,aK,iK,lK,hK,hG,fK,gK,vK,xK,kK,NK,EK,IK,TK,DK,cV,OK,BK,UK,XK,$K,kV,MG,QK,hV,fV,FV,ZK,eX,tX,nX,rX,aX,oX,cX,hX,pX,gX,xX,mV,wX,NX,CX,bH,uK,IX,TX,RX,FX,LX,PX,MX,jX,WX,UX,GX,XX,$X,QX,tY,aY,oY,WG,fG,lY,{kernelName:IC,backendName:"cpu",kernelFunc:cY},uY,dY,mY,vY,qV,NY,SY,CY,CK];for(const n of EY)$C(n);const _Y={},IY={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function TY(e,t){if(!(e in _Y)||null!=t){const n=function(e,t){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=null==t?function(e){if(_k().getBool("IS_SAFARI")||"undefined"===typeof OffscreenCanvas||2!==e){if("undefined"!==typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}return new OffscreenCanvas(300,150)}(e):t;n.addEventListener("webglcontextlost",t=>{t.preventDefault(),delete _Y[e]},!1),_k().getBool("SOFTWARE_WEBGL_ENABLED")&&(IY.failIfMajorPerformanceCaveat=!1);if(1===e)return n.getContext("webgl",IY)||n.getContext("experimental-webgl",IY);return n.getContext("webgl2",IY)}(e,t);if(null===n)return console.log("Could not get context for WebGL version",e),null;_Y[e]=n}const n=_Y[e];return null==n||n.isContextLost()?(delete _Y[e],TY(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),_Y[e])}var AY,RY,DY;function FY(e,t){return[t,e]}function OY(e){const t=$w(e);return Zw(Math.ceil(t/4))}function LY(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function PY(e,t){const n=e;let r,a,i,o,s,l,c,u,h,d;return 2===_k().getNumber("WEBGL_VERSION")?(r=n.R32F,a=n.R16F,i=n.RGBA16F,o=n.RGBA32F,s=n.RED,c=4,u=1,h=n.HALF_FLOAT,d=n.FLOAT,l=n.RGBA8):(r=e.RGBA,a=e.RGBA,i=e.RGBA,o=n.RGBA,s=e.RGBA,c=4,u=4,h=null!=t?t.HALF_FLOAT_OES:null,d=e.FLOAT,l=e.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:a,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:s,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:u,textureTypeHalfFloat:h,textureTypeFloat:d}}function MY(e,t){const n=t();return _k().getBool("DEBUG")&&function(e){const t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+function(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code ".concat(t)}}(e,t))}(e),n}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(AY||(AY={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(RY||(RY={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(DY||(DY={}));function jY(e){return!!(_k().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||5.96e-8<Math.abs(e)&&Math.abs(e)<65504)}function BY(e,t){return XY(e,()=>e.getExtension(t),'Extension "'+t+'" not supported on this browser.')}const zY=/ERROR: [0-9]+:([0-9]+):/g;function WY(e,t){const n=zY.exec(t);if(null==n)return console.log("Couldn't parse line number in error: ".concat(t)),void console.log(e);const r=+n[1],a=e.split("\n"),i=a.length.toString().length+2,o=a.map((e,t)=>ek((t+1).toString(),i)+e);let s=0;for(let h=0;h<o.length;h++)s=Math.max(o[h].length,s);const l=o.slice(0,r-1),c=o.slice(r-1,r),u=o.slice(r);console.log(l.join("\n")),console.log(t.split("\n")[0]),console.log("%c ".concat(ek(c[0],s)),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join("\n"))}function UY(e,t){if(MY(e,()=>e.validateProgram(t)),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function VY(e,t,n,r,a,i,o){const s=e.getAttribLocation(t,n);return-1!==s&&(MY(e,()=>e.bindBuffer(e.ARRAY_BUFFER,r)),MY(e,()=>e.vertexAttribPointer(s,a,e.FLOAT,!1,i,o)),MY(e,()=>e.enableVertexAttribArray(s)),!0)}function HY(e,t,n,r){MY(e,()=>function(e,t,n){YY(e,n),MY(e,()=>e.activeTexture(e.TEXTURE0+n)),MY(e,()=>e.bindTexture(e.TEXTURE_2D,t))}(e,t,r)),MY(e,()=>e.uniform1i(n,r))}function GY(e,t,n){MY(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,n)),MY(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0))}function qY(e,t){MY(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,t)),MY(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0))}function KY(e){const t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error ".concat(t)}}(e,t))}function XY(e,t,n){const r=MY(e,()=>t());if(null==r)throw new Error(n);return r}function YY(e,t){const n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n){const e="[gl.TEXTURE0, gl.TEXTURE".concat(n,"]");throw new Error("textureUnit must be in ".concat(e,"."))}}function $Y(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return $w(e.slice(0,e.length-t))}function JY(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function QY(e){let t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[$Y(e),...JY(e)]),t}function ZY(e){return e%2===0}function e$(e,t){if(Jw(e=e.slice(-2),t=t.slice(-2)))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){const n=e[e.length-1],r=t[t.length-1];if(n===r)return!0;if(ZY(n)&&ZY(r)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&ZY(e[0])&&ZY(t[0])}let t$,n$;function r$(e,t){return null!=e.getExtension(t)}function a$(e){try{if(null!=TY(e))return!0}catch(ci){return console.log("Error when getting WebGL context: ",ci),!1}return!1}function i$(e){if(0===e)return!1;const t=TY(e);if(1!==e){if(r$(t,"EXT_color_buffer_float"))return o$(t);const e="EXT_color_buffer_half_float";if(r$(t,e)){const n=t.getExtension(e);return function(e,t){const n=PY(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);const a=1,i=1;e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,a,i,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const o=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,o),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);const s=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(o),s}(t,n)}return!1}if(!r$(t,"OES_texture_float"))return!1;if(!r$(t,"WEBGL_color_buffer_float"))return!1;return o$(t)}function o$(e){const t=PY(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n);e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);const r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);const a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),a}function s$(e,t){Array.isArray(e)||(e=[e]),e.forEach(e=>{null!=e&&Kw("complex64"!==e.dtype,()=>"".concat(t," does not support complex64 tensors ")+"in the WebGL backend.")})}const l$=_k();function c$(){let e,t,n,r,a,i,o,s,l,c;return 2===_k().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",r="in",a="texture",i="outputColor",o="out vec4 outputColor;",s=_k().getBool("WEBGL2_ISNAN_CUSTOM")?"\n      bool isnan_custom(float val) {\n        uint floatToUint = floatBitsToUint(val);\n        return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ":"",l="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",r="varying",a="texture2D",i="gl_FragColor",o="",s="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",l="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:a,output:i,defineOutput:o,defineSpecialNaN:s,defineSpecialInf:l,defineRound:c}}function u$(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const r=pk(t);return r.map((t,a)=>{const i="int ".concat(e[a]," = ").concat(n," / ").concat(t),o=a===r.length-1?"int ".concat(e[a+1]," = ").concat(n," - ").concat(e[a]," * ").concat(t):"index -= ".concat(e[a]," * ").concat(t);return"".concat(i,"; ").concat(o,";")}).join("")}function h$(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const r=pk(t);return r.map((t,a)=>{const i="int ".concat(e[a]," = ").concat(n," / outShapeStrides[").concat(a,"]"),o=a===r.length-1?"int ".concat(e[a+1]," = ").concat(n," - ").concat(e[a]," * outShapeStrides[").concat(a,"]"):"index -= ".concat(e[a]," * outShapeStrides[").concat(a,"]");return"".concat(i,"; ").concat(o,";")}).join("")}function d$(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const r=e.map((e,t)=>t),a=function(e,t){const n=e.length,r=e.map(e=>"".concat(t,"[").concat(e,"]")),a=new Array(n-1);a[n-2]=r[n-1];for(let i=n-3;i>=0;--i)a[i]="(".concat(a[i+1]," * ").concat(r[i+1],")");return a}(r,t);return a.map((t,r)=>{const i="int ".concat(e[r]," = ").concat(n," / ").concat(a[r]),o=r===a.length-1?"int ".concat(e[r+1]," = ").concat(n," - ").concat(e[r]," * ").concat(a[r]):"index -= ".concat(e[r]," * ").concat(a[r]);return"".concat(i,"; ").concat(o,";")}).join("")}function f$(e){const t=pk(e).map(e=>e.toString());return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(t[0]," + coords.y * ").concat(t[1]," + coords.z;\n  }\n")}l$.registerFlag("HAS_WEBGL",()=>l$.getNumber("WEBGL_VERSION")>0),l$.registerFlag("WEBGL_VERSION",()=>a$(2)?2:a$(1)?1:0),l$.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1),l$.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>2===l$.get("WEBGL_VERSION")),l$.registerFlag("WEBGL_CPU_FORWARD",()=>!0),l$.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1),l$.registerFlag("WEBGL_PACK",()=>l$.getBool("HAS_WEBGL")),l$.registerFlag("WEBGL_PACK_NORMALIZATION",()=>l$.getBool("WEBGL_PACK")),l$.registerFlag("WEBGL_PACK_CLIP",()=>l$.getBool("WEBGL_PACK")),l$.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>l$.getBool("WEBGL_PACK")),l$.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>l$.getBool("WEBGL_PACK")),l$.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>l$.getBool("WEBGL_PACK")),l$.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>l$.getBool("WEBGL_PACK")),l$.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>l$.getBool("WEBGL_PACK")),l$.registerFlag("WEBGL_PACK_REDUCE",()=>l$.getBool("WEBGL_PACK")),l$.registerFlag("WEBGL_LAZILY_UNPACK",()=>l$.getBool("WEBGL_PACK")),l$.registerFlag("WEBGL_CONV_IM2COL",()=>l$.getBool("WEBGL_PACK")),l$.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>l$.getBool("WEBGL_PACK")),l$.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>function(e){if(null==t$){const t=TY(e);t$=t.getParameter(t.MAX_TEXTURE_SIZE)}return t$}(l$.getNumber("WEBGL_VERSION"))),l$.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>function(e){if(null==n$){const t=TY(e);n$=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,n$)}(l$.getNumber("WEBGL_VERSION"))),l$.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const e=l$.getNumber("WEBGL_VERSION");return 0===e?0:function(e){if(0===e)return 0;let t;const n=TY(e);return t=r$(n,"EXT_disjoint_timer_query_webgl2")&&2===e?2:r$(n,"EXT_disjoint_timer_query")?1:0,t}(e)}),l$.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>l$.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!r_()),l$.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>function(e){if(0===e)return!1;const t=TY(e);if(1===e){if(!r$(t,"OES_texture_float"))return!1}else if(!r$(t,"EXT_color_buffer_float"))return!1;return o$(t)}(l$.getNumber("WEBGL_VERSION"))),l$.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>!l$.getBool("WEBGL_FORCE_F16_TEXTURES")&&l$.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")),l$.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>i$(l$.getNumber("WEBGL_VERSION"))),l$.registerFlag("WEBGL_FENCE_API_ENABLED",()=>{return 2===(e=l$.getNumber("WEBGL_VERSION"))&&null!=TY(e).fenceSync;var e}),l$.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>l$.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0),l$.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,e=>{if("number"!==typeof e)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but "+"got ".concat(e,"."));if(e<0&&-1!==e)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never "+"delete) or at least 0, but got ".concat(e,"."))}),l$.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>r_()?1:-1,e=>{if("number"!==typeof e)throw new Error("WEBGL_FLUSH_THRESHOLD must be a number but got "+"".concat(e,"."));if(e<0&&-1!==e)throw new Error("WEBGL_FLUSH_THRESHOLD must be -1 (indicating never "+"manual flush) or at least 0, but got ".concat(e,"."))}),l$.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128),l$.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1),l$.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5),l$.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128),l$.registerFlag("WEBGL_EXP_CONV",()=>!1),l$.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>l$.getBool("IS_TEST")),l$.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0),l$.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1),l$.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1),l$.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);const p$="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",{getBroadcastDims:g$}=a;function m$(e,t,n){const r=[];if(e.forEach(e=>{const t=$w(e.shapeInfo.logicalShape);if(e.shapeInfo.isUniform?r.push("uniform float ".concat(e.name).concat(t>1?"[".concat(t,"]"):"",";")):(r.push("uniform sampler2D ".concat(e.name,";")),r.push("uniform int offset".concat(e.name,";"))),n.enableShapeUniforms){const{uniformShape:t}=E$(n.packedInputs,e.shapeInfo.logicalShape,e.shapeInfo.texShape);switch(t.length){case 1:r.push("uniform int ".concat(e.name,"Shape;"));break;case 2:r.push("uniform ivec2 ".concat(e.name,"Shape;"));break;case 3:r.push("uniform ivec3 ".concat(e.name,"Shape;"));break;case 4:r.push("uniform ivec4 ".concat(e.name,"Shape;"))}r.push("uniform ivec2 ".concat(e.name,"TexShape;"))}}),n.enableShapeUniforms){switch(t.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;")}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(e=>{r.push("uniform ".concat(e.type," ").concat(e.name).concat(e.arrayIndex?"[".concat(e.arrayIndex,"]"):"",";"))});const a=r.join("\n"),i=e.map(e=>function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,a="";a+=n?b$(e,r):v$(e,r);const i=e.shapeInfo.logicalShape,o=t.logicalShape;i.length<=o.length&&(a+=n?function(e,t){const n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",i=e.shapeInfo.logicalShape.length,o=t.logicalShape.length,s=g$(e.shapeInfo.logicalShape,t.logicalShape),l=C$(o),c=o-i;let u;const h=["x","y","z","w","u","v"];u=0===i?"":o<2&&s.length>=1?"coords = 0;":s.map(e=>"coords.".concat(h[e+c]," = 0;")).join("\n");let d="";d=o<2&&i>0?"coords":e.shapeInfo.logicalShape.map((e,t)=>"coords.".concat(h[t+c])).join(", ");let f="return outputValue;";const p=1===$w(e.shapeInfo.logicalShape),g=$w(t.logicalShape),m=1===g;if(1!==i||p||m){if(p&&!m)f=1===o?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(s.length){const e=i-2,t=i-1;s.indexOf(e)>-1&&s.indexOf(t)>-1?f="return vec4(outputValue.x);":s.indexOf(e)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":s.indexOf(t)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}}else f="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 ".concat(a,"() {\n      ").concat(l," coords = getOutputCoords();\n      ").concat(u,"\n      vec4 outputValue = get").concat(r,"(").concat(d,");\n      ").concat(f,"\n    }\n  ")}(e,t):function(e,t){const n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",i=t.texShape,o=e.shapeInfo.texShape,s=e.shapeInfo.logicalShape.length,l=t.logicalShape.length;if(!e.shapeInfo.isUniform&&s===l&&null==e.shapeInfo.flatOffset&&Jw(o,i))return"\n      float ".concat(a,"() {\n        return sampleTexture(").concat(n,", resultUV);\n      }\n    ");const c=C$(l),u=g$(e.shapeInfo.logicalShape,t.logicalShape),h=l-s;let d;const f=["x","y","z","w","u","v"];d=0===s?"":l<2&&u.length>=1?"coords = 0;":u.map(e=>"coords.".concat(f[e+h]," = 0;")).join("\n");let p="";p=l<2&&s>0?"coords":e.shapeInfo.logicalShape.map((e,t)=>"coords.".concat(f[t+h])).join(", ");return"\n    float ".concat(a,"() {\n      ").concat(c," coords = getOutputCoords();\n      ").concat(d,"\n      return get").concat(r,"(").concat(p,");\n    }\n  ")}(e,t));return a}(e,t,n.packedInputs,n.enableShapeUniforms)).join("\n"),o=t.texShape,s=c$(),l=function(e){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(e.texture2D,"(textureSampler, uv).r;\n    }\n  ")}(s);let c,u,h=function(e){const t="".concat(e.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(e.varyingFs," vec2 resultUV;\n    ").concat(e.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(e.defineSpecialNaN,"\n    ").concat(e.defineSpecialInf,"\n    ").concat(e.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat(x$,"\n    ").concat(y$,"\n    ").concat(w$,"\n  ");return t}(s);t.isPacked?(c=function(e,t,n){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t,n){const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(1===r[0])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(r[1],".0);\n      }\n    ");if(1===r[1])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(r[0],".0);\n      }\n    ");if(n)return"\n    int getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);\n    }\n  ";return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      return 2 * (resTexRC.x * ").concat(r[1]," + resTexRC.y);\n    }\n  ")}(0,t,n);case 2:return function(e,t,n){const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(Jw(e,t))return n?"\n      ivec2 getOutputCoords() {\n        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(r[0],", ").concat(r[1],"));\n      }\n    ");const a=Math.ceil(e[1]/2);if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec2(r, c);\n    }\n  ";return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec2(r, c);\n    }\n  ")}(e,t,n);case 3:return function(e,t,n){if(n)return"\n    ivec3 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],a=Math.ceil(e[2]/2),i=a*Math.ceil(e[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n\n      int b = index / ").concat(i,";\n      index -= b * ").concat(i,";\n\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ")}(e,t,n);default:return function(e,t,n){if(n)return"\n    ivec4 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatchN = texelsInBatch * outShape[1];\n\n      int b2 = index / texelsInBatchN;\n      index -= b2 * texelsInBatchN;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  ";const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],a=Math.ceil(e[e.length-1]/2),i=a*Math.ceil(e[e.length-2]/2);let o=i,s="",l="b, r, c";for(let c=2;c<e.length-1;c++)o*=e[e.length-c-1],s="\n      int b".concat(c," = index / ").concat(o,";\n      index -= b").concat(c," * ").concat(o,";\n    ")+s,l="b".concat(c,", ")+l;return"\n    ivec".concat(e.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(r[0],", ").concat(r[1],"));\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n\n      ").concat(s,"\n\n      int b = index / ").concat(i,";\n      index -= b * ").concat(i,";\n\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec").concat(e.length,"(").concat(l,");\n    }\n  ")}(e,t,n)}}(t.logicalShape,o,n.enableShapeUniforms),u=function(e){return"\n    void setOutput(vec4 val) {\n      ".concat(e.output," = val;\n    }\n  ")}(s)):(c=function(e,t,n){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t,n){if(1===t[0])return n?"\n      int getOutputCoords() {\n        return int(resultUV.x * float(outTexShape[1]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(t[1],".0);\n      }\n    ");if(1===t[1])return n?"\n      int getOutputCoords() {\n        return int(resultUV.y * float(outTexShape[0]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(t[0],".0);\n      }\n    ");if(n)return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      return resTexRC.x * outTexShape[1] + resTexRC.y;\n    }\n  ";return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      return resTexRC.x * ").concat(t[1]," + resTexRC.y;\n    }\n  ")}(0,t,n);case 2:return function(e,t,n){if(Jw(e,t))return n?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(t[0],", ").concat(t[1],"));\n      }\n    ");if(1===e[1])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ");if(1===e[0])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ");if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      int r = index / outShape[1];\n      int c = index - r * outShape[1];\n      return ivec2(r, c);\n    }\n  ";return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      int r = index / ").concat(e[1],";\n      int c = index - r * ").concat(e[1],";\n      return ivec2(r, c);\n    }\n  ")}(e,t,n);case 3:return function(e,t,n){if(n){const t=h$(["r","c","d"],e);return"\n  ivec3 getOutputCoords() {\n    ivec2 resTexRC = ivec2(resultUV.yx *\n                           vec2(outTexShape[0], outTexShape[1]));\n    int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n    ".concat(t,"\n    return ivec3(r, c, d);\n  }\n")}const r=u$(["r","c","d"],e);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(r,"\n      return ivec3(r, c, d);\n    }\n  ")}(e,t,n);case 4:return function(e,t,n){if(n){const t=h$(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      ".concat(t,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}const r=u$(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(r,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}(e,t,n);case 5:return function(e,t){const n=u$(["r","c","d","d2","d3"],e);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(t[0],",\n                             ").concat(t[1],"));\n\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ")}(e,t);case 6:return function(e,t){const n=u$(["r","c","d","d2","d3","d4"],e);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ")}(e,t);default:throw new Error("".concat(e.length,"-D output sampling is not yet supported"))}}(t.logicalShape,o,n.enableShapeUniforms),u=function(e){return"\n    void setOutput(float val) {\n      ".concat(e.output," = vec4(val, 0, 0, 0);\n    }\n  ")}(s)),n.packedInputs&&(h+=k$);return[h,l,u,a,c,i,n.userCode].join("\n")}function v$(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e.shapeInfo.logicalShape;switch(n.length){case 0:return function(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"float ".concat(r,"() {return ").concat(n,";}");const[a,i]=e.shapeInfo.texShape;if(1===a&&1===i)return"\n      float ".concat(r,"() {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");const o=N$(n);if(t)return"\n    float ".concat(r,"() {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], ").concat(o,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");const[s,l]=e.shapeInfo.texShape;return"\n    float ".concat(r,"() {\n      vec2 uv = uvFromFlat(").concat(s,", ").concat(l,", ").concat(o,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e,t);case 1:return function(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int index) {\n        ").concat(S$(e),"\n      }\n    ");const a=e.shapeInfo.texShape,i=a[0],o=a[1];if(1===o&&1===i)return"\n      float ".concat(r,"(int index) {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");const s=N$(n);if(1===o)return t?"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(s,") + 0.5) / float(").concat(n,"TexShape[0]));\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(s,") + 0.5) / ").concat(i,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(1===i)return t?"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(s,") + 0.5) / float(").concat(n,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(s,") + 0.5) / ").concat(o,".0, 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(t)return"\n    float ".concat(r,"(int index) {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], index + ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");return"\n    float ".concat(r,"(int index) {\n      vec2 uv = uvFromFlat(").concat(i,", ").concat(o,", index + ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e,t);case 2:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape;if(null!=i&&Jw(n,i)){if(t)return"\n      float ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");const e=i[0],n=i[1];return"\n    float ".concat(a,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(n,".0, ").concat(e,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}const{newShape:o,keptDims:s}=ak(n),l=o;if(l.length<n.length){const n=_$(e,l),r=["row","col"];return"\n      ".concat(v$(n,t),"\n      float ").concat(a,"(int row, int col) {\n        return ").concat(a,"(").concat(I$(r,s),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(n[1],", 1)));\n        ").concat(S$(e),"\n      }\n    ");const c=i[0],u=i[1],h=N$(r);if(1===u)return t?"\n      float ".concat(a,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(h,"), vec3(").concat(r,"Shape[1], 1, 1));\n        vec2 uv = vec2(0.5, (index + 0.5) / float(").concat(r,"TexShape[0]));\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(h,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(c,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");if(1===c)return t?"\n      float ".concat(a,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(h,"), vec3(").concat(r,"Shape[1], 1, 1));\n        vec2 uv = vec2((index + 0.5) / float(").concat(r,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(h,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(u,".0, 0.5);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");if(t)return"\n      float ".concat(a,"(int row, int col) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(r,"Shape[1] + col + ").concat(h,";\n        vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");return"\n  float ".concat(a,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(n[1]," + col + ").concat(h,";\n    vec2 uv = uvFromFlat(").concat(c,", ").concat(u,", index);\n    return sampleTexture(").concat(r,", uv);\n  }\n")}(e,t);case 3:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[1]*n[2],o=n[2],{newShape:s,keptDims:l}=ak(n),c=s;if(c.length<n.length){const n=_$(e,c),r=["row","col","depth"];return"\n        ".concat(v$(n,t),"\n        float ").concat(a,"(int row, int col, int depth) {\n          return ").concat(a,"(").concat(I$(r,l),");\n        }\n      ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(i,", ").concat(o,", 1)));\n        ").concat(S$(e),"\n      }\n    ");const u=e.shapeInfo.texShape,h=u[0],d=u[1],f=e.shapeInfo.flatOffset;if(d===i&&null==f)return t?"\n      float ".concat(a,"(int row, int col, int depth) {\n        int stride1 = ").concat(r,"Shape[2];\n        float texR = float(row);\n        float texC = dot(vec2(col, depth), vec2(stride1, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n        float ".concat(a,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(o,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(d,".0, ").concat(h,".0);\n          return sampleTexture(").concat(r,", uv);\n        }\n      ");if(d===o&&null==f)return t?"\n      float ".concat(a,"(int row, int col, int depth) {\n        float texR = dot(vec2(row, col), vec2(").concat(r,"Shape[1], 1));\n        float texC = float(depth);\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(n[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(d,".0, ").concat(h,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");const p=N$(r);if(t)return"\n    float ".concat(a,"(int row, int col, int depth) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int stride0 = ").concat(r,"Shape[1] * ").concat(r,"Shape[2];\n      int stride1 = ").concat(r,"Shape[2];\n      int index = row * stride0 + col * stride1 + depth + ").concat(p,";\n      vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index);\n      return sampleTexture(").concat(r,", uv);\n    }\n    ");return"\n      float ".concat(a,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(i," + col * ").concat(o," + depth + ").concat(p,";\n        vec2 uv = uvFromFlat(").concat(h,", ").concat(d,", index);\n        return sampleTexture(").concat(r,", uv);\n      }\n  ")}(e,t);case 4:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[3],o=n[2]*i,s=n[1]*o,{newShape:l,keptDims:c}=ak(n);if(l.length<n.length){const n=_$(e,l),r=["row","col","depth","depth2"];return"\n      ".concat(v$(n,t),"\n      float ").concat(a,"(int row, int col, int depth, int depth2) {\n        return ").concat(a,"(").concat(I$(r,c),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(s,", ").concat(o,", ").concat(i,", 1)));\n        ").concat(S$(e),"\n      }\n    ");const u=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,d=h[0],f=h[1],p="int stride2 = ".concat(r,"Shape[3];"),g="int stride1 = ".concat(r,"Shape[2] * stride2;"),m="int stride0 = ".concat(r,"Shape[1] * stride1;");if(f===s&&null==u)return t?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        ").concat(p,"\n        ").concat(g,"\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(stride1, stride2, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(o,", ").concat(i,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(f,".0, ").concat(d,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");if(f===i&&null==u)return t?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(r,"Shape[1] * ").concat(r,"Shape[2], ").concat(r,"Shape[2], 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(n[1]*n[2],", ").concat(n[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(f,".0, ").concat(d,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");const v=N$(r);if(t)return"\n    float ".concat(a,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      ").concat(p,"\n      ").concat(g,"\n      ").concat(m,"\n      int index = row * stride0 + col * stride1 +\n          depth * stride2 + depth2;\n      vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index + ").concat(v,");\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");return"\n    float ".concat(a,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(s," + col * ").concat(o," +\n          depth * ").concat(i," + depth2;\n      vec2 uv = uvFromFlat(").concat(d,", ").concat(f,", index + ").concat(v,");\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}(e,t);case 5:return function(e){const t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[4],i=t[3]*a,o=t[2]*i,s=t[1]*o,{newShape:l,keptDims:c}=ak(t);if(l.length<t.length){const t=_$(e,l),n=["row","col","depth","depth2","depth3"];return"\n      ".concat(v$(t),"\n      float ").concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(r,"(").concat(I$(n,c),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(s,", ").concat(o,", ").concat(i,", ").concat(a,")) +\n          depth3;\n        ").concat(S$(e),"\n      }\n    ");const u=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,d=h[0],f=h[1];if(f===s&&null==u)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(o,", ").concat(i,", ").concat(a,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(f,".0, ").concat(d,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(f===a&&null==u)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3],",\n               ").concat(t[2]*t[3],", ").concat(t[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(f,".0, ").concat(d,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");const p=N$(n);return"\n    float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(s," + col * ").concat(o," + depth * ").concat(i," +\n          depth2 * ").concat(a," + depth3 + ").concat(p,";\n      vec2 uv = uvFromFlat(").concat(d,", ").concat(f,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);case 6:return function(e){const t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:a,keptDims:i}=ak(t);if(a.length<t.length){const t=_$(e,a),n=["row","col","depth","depth2","depth3","depth4"];return"\n      ".concat(v$(t),"\n      float ").concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(r,"(").concat(I$(n,i),");\n      }\n    ")}const o=t[5],s=t[4]*o,l=t[3]*s,c=t[2]*l,u=t[1]*c;if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(u,", ").concat(c,", ").concat(l,", ").concat(s,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(o,", 1)));\n        ").concat(S$(e),"\n      }\n    ");const h=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,f=d[0],p=d[1];if(p===u&&null==h)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(c,", ").concat(l,", ").concat(s,", ").concat(o,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(p,".0, ").concat(f,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(p===o&&null==h)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3]*t[4],",\n               ").concat(t[2]*t[3]*t[4],",\n               ").concat(t[3]*t[4],",\n               ").concat(t[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(p,".0, ").concat(f,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");const g=N$(n);return"\n    float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(u," + col * ").concat(c," + depth * ").concat(l," +\n          depth2 * ").concat(s," + depth3 * ").concat(o," + depth4 + ").concat(g,";\n      vec2 uv = uvFromFlat(").concat(f,", ").concat(p,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);default:throw new Error("".concat(n.length,"-D input sampling")+" is not yet supported")}}function b$(e,t){switch(e.shapeInfo.logicalShape.length){case 0:return function(e){const t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=c$();return"\n    vec4 ".concat(n,"() {\n      return ").concat(r.texture2D,"(").concat(t,", halfCR);\n    }\n  ")}(e);case 1:return function(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,i=c$();if(t)return"\n    vec4 ".concat(r,"(int index) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      vec2 uv = packedUVfrom1D(\n        packedTexShape[0], packedTexShape[1], index);\n      return ").concat(i.texture2D,"(").concat(n,", uv);\n    }\n  ");const o=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return"\n    vec4 ".concat(r,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(o[0],", ").concat(o[1],", index);\n      return ").concat(i.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e,t);case 2:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,o=i[0],s=i[1],l=c$();if(null!=i&&Jw(n,i))return t?"\n      vec4 ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n\n        return ").concat(l.texture2D,"(").concat(r,", uv);\n      }\n    "):"\n      vec4 ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(s,".0, ").concat(o,".0);\n\n        return ").concat(l.texture2D,"(").concat(r,", uv);\n      }\n    ");if(t)return"\n    vec4 ".concat(a,"(int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(r,"TexShape[0]) / 2.0), ceil(float(").concat(r,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(r,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);\n      return ").concat(l.texture2D,"(").concat(r,", uv);\n    }\n  ");const c=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],u=Math.ceil(n[1]/2);return"\n    vec4 ".concat(a,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(u,", ").concat(c[0],", ").concat(c[1],", row, col);\n      return ").concat(l.texture2D,"(").concat(r,", uv);\n    }\n  ")}(e,t);case 3:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(1===n[0]){const r=[1,2],i=_$(e,n.slice(1)),o=["b","row","col"];return"\n        ".concat(b$(i,t),"\n        vec4 ").concat(a,"(int b, int row, int col) {\n          return ").concat(a,"(").concat(I$(o,r),");\n        }\n      ")}const s=c$();if(t)return"\n    vec4 ".concat(a,"(int b, int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(r,"TexShape[0]) / 2.0), ceil(float(").concat(r,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(r,"Shape[2]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(r,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom3D(\n        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);\n      return ").concat(s.texture2D,"(").concat(r,", uv);\n    }\n  ");const l=o[0],c=o[1],u=Math.ceil(n[2]/2),h=u*Math.ceil(n[1]/2);return"\n    vec4 ".concat(a,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(l,", ").concat(c,", ").concat(h,", ").concat(u,", b, row, col);\n      return ").concat(s.texture2D,"(").concat(r,", uv);\n    }\n  ")}(e,t);default:return function(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=c$();if(t)return"\n    vec4 ".concat(r,"(int b2, int b, int row, int col) {\n      int valuesPerRow = int(ceil(float(").concat(n,"Shape[3]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(n,"Shape[2]) / 2.0));\n      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);\n      texelsInBatch *= ").concat(n,"Shape[1];\n      index = b2 * texelsInBatch + index;\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      int texR = index / packedTexShape[1];\n      int texC = index - texR * packedTexShape[1];\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ").concat(a.texture2D,"(").concat(n,", uv);\n    }\n  ");const i=e.shapeInfo.logicalShape,o=i.length,s=e.shapeInfo.texShape,l=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],c=l[0],u=l[1],h=Math.ceil(i[o-1]/2);let d=h*Math.ceil(i[o-2]/2),f="int b, int row, int col",p="b * ".concat(d," + (row / 2) * ").concat(h," + (col / 2)");for(let g=2;g<o-1;g++)f="int b".concat(g,", ")+f,d*=i[o-g-1],p="b".concat(g," * ").concat(d," + ")+p;return"\n    vec4 ".concat(r,"(").concat(f,") {\n      int index = ").concat(p,";\n      int texR = index / ").concat(u,";\n      int texC = index - texR * ").concat(u,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(u,", ").concat(c,");\n      return ").concat(a.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e,t)}}const x$="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",y$="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",w$="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",k$="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function N$(e){return"offset".concat(e)}function S$(e){const t=e.name,n=$w(e.shapeInfo.logicalShape);return n<2?"return ".concat(t,";"):"\n    for (int i = 0; i < ".concat(n,"; i++) {\n      if (i == index) {\n        return ").concat(t,"[i];\n      }\n    }\n  ")}function C$(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank ".concat(e," is not yet supported"))}function E$(e,t,n){const{newShape:r,keptDims:a}=ak(t),i=t.length,o=e&&3===i&&1===t[0],s=o?t.slice(1):r,l=!e&&i>1&&!Jw(t,n)&&r.length<i||o;return{useSqueezeShape:l,uniformShape:l?s:t,keptDims:a}}function _$(e,t){const n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function I$(e,t){return t.map(t=>e[t]).join(", ")}function T$(e,t,n,r){const a=n.map((e,n)=>{const r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}}),i=a.map(e=>e.shapeInfo),o={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},s=m$(a,o,t),l=function(e,t){const n=XY(e,()=>e.createShader(e.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(MY(e,()=>e.shaderSource(n,t)),MY(e,()=>e.compileShader(n)),_k().get("ENGINE_COMPILE_ONLY"))return n;if(!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw WY(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}(e.gl,s),c=e.createProgram(l);return _k().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:l,source:s,webGLProgram:c,inShapeInfos:i,outShapeInfo:o,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(e.buildVao(c),Object.assign({program:t,fragmentShader:l,source:s,webGLProgram:c,inShapeInfos:i,outShapeInfo:o},A$(e,t,c)))}function A$(e,t,n){const r=[],a=[];let i,o,s,l=null,c=null;c=e.getUniformLocation(n,"NAN",!1),1===_k().getNumber("WEBGL_VERSION")&&(l=e.getUniformLocation(n,"INFINITY",!1));const u=!1;for(const h of t.variableNames){const a={name:h,uniform:e.getUniformLocation(n,h,u),offset:e.getUniformLocation(n,"offset".concat(h),u)};t.enableShapeUniforms&&(a.shape=e.getUniformLocation(n,"".concat(h,"Shape"),u),a.texShape=e.getUniformLocation(n,"".concat(h,"TexShape"),u)),r.push(a)}if(t.enableShapeUniforms&&(i=e.getUniformLocation(n,"outShape",u),s=e.getUniformLocation(n,"outShapeStrides",u),o=e.getUniformLocation(n,"outTexShape",u)),t.customUniforms)for(const h of t.customUniforms)a.push(e.getUniformLocation(n,h.name,u));return{variablesLocations:r,customUniformLocations:a,infLoc:l,nanLoc:c,outShapeLocation:i,outShapeStridesLocation:s,outTexShapeLocation:o}}function R$(e,t){if(e.length!==t.length)throw Error("Binary was compiled with ".concat(e.length," inputs, but ")+"was executed with ".concat(t.length," inputs"));e.forEach((e,n)=>{const r=e.logicalShape,a=t[n],i=a.shape;if(!Jw(r,i))throw Error("Binary was compiled with different shapes than "+"the current args. Shapes ".concat(r," and ").concat(i," must match"));if(e.isUniform&&a.isUniform)return;const o=e.texShape,s=a.isUniform?null:a.texData.texShape;if(!Jw(o,s))throw Error("Binary was compiled with different texture shapes than the"+" current args. Shape ".concat(o," and ").concat(s," must match"))})}function D$(e){return _k().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}class F${constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=AY.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=c$();this.outputShape=e,this.enableShapeUniforms=D$(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?h$(["r","c","d"],e):u$(["r","c","d"],e),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(t.output," = result;\n      }\n    ")}}class O${constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=AY.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=c$();this.outputShape=e,this.enableShapeUniforms=D$(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?h$(["r","c","d"],e):u$(["r","c","d"],e),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(t.output," = result;\n      }\n    ")}}class L${constructor(e){this.variableNames=["A"],this.outTexUsage=RY.DOWNLOAD;const t=c$();this.outputShape=e,this.userCode="\n      ".concat(p$,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(t.output," = encode_float(x);\n      }\n    ")}}class P${constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=RY.DOWNLOAD;const t=c$();this.outputShape=e,this.userCode="\n      ".concat(p$,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(t.output," = encode_float(x);\n      }\n    ")}}const M$={R:0,G:1,B:2,A:3};class j${constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"RGBA";this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=c$();this.outputShape=e,this.enableShapeUniforms=D$(this.outputShape.length);let a="result";t&&(a="floor(result * 255. + 0.5)");let i="";for(let o=0;o<n.length;o++){const e=n[o];i+="\n          if(offset == ".concat(o,") {\n            result = values[").concat(M$[e],"];\n          }")}this.userCode="\n      ".concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":f$(e),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int flatIndex = getFlatIndex(coords);\n        float result = 0.;\n        int offset = imod(flatIndex, ").concat(n.length,");\n\n        flatIndex = idiv(flatIndex, ").concat(n.length,", 1.);\n\n        int r = flatIndex / texShape[1];\n        if (r < texShape[0]) {\n          int c = imod(flatIndex, texShape[1]);\n          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n          vec4 values = ").concat(r.texture2D,"(A, uv);\n          ").concat(i,"\n        }\n        ").concat(r.output," = vec4(").concat(a,", 0., 0., 0.);\n      }\n    ")}}class B${constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=c$();this.outputShape=e,this.enableShapeUniforms=D$(this.outputShape.length);let r="",a="result";t&&(a="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let t=0;t<=1;t++){const a=2*i+t;r+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(t," < ").concat(this.enableShapeUniforms?"outShape[2]":"".concat(e[2]),") {\n          localCoords[2] += ").concat(t,";\n          if (localCoords[1] + ").concat(i," < ").concat(this.enableShapeUniforms?"outShape[1]":"".concat(e[1]),") {\n            localCoords[1] += ").concat(i,";\n\n            flatIndex = getFlatIndex(localCoords);\n            offset = imod(flatIndex, 4);\n\n            flatIndex = idiv(flatIndex, 4, 1.);\n\n            int r = flatIndex / texShape[1];\n            int c = imod(flatIndex, texShape[1]);\n            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n            values = ").concat(n.texture2D,"(A, uv);\n\n            if (offset == 0) {\n              result[").concat(a,"] = values[0];\n            } else if (offset == 1) {\n              result[").concat(a,"] = values[1];\n            } else if (offset == 2) {\n              result[").concat(a,"] = values[2];\n            } else {\n              result[").concat(a,"] = values[3];\n            }\n          }\n        }\n        ")}this.userCode="\n        ".concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":f$(e),"\n\n        void main() {\n          ivec3 coords = getOutputCoords();\n\n          vec4 result = vec4(0.);\n          int flatIndex, r, c, offset;\n          ivec3 localCoords;\n          vec2 uv;\n          vec4 values;\n\n          ").concat(r,"\n\n          ").concat(n.output," = ").concat(a,";\n        }\n    ")}}function z$(e){const t=c$();return function(e,t){const n=XY(e,()=>e.createShader(e.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(MY(e,()=>e.shaderSource(n,t)),MY(e,()=>e.compileShader(n)),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}(e,"".concat(t.version,"\n    precision highp float;\n    ").concat(t.attribute," vec3 clipSpacePos;\n    ").concat(t.attribute," vec2 uv;\n    ").concat(t.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }"))}function W$(e){return function(e,t){const n=XY(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return MY(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),MY(e,()=>e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)),n}(e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function U$(e){return function(e,t){const n=XY(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return MY(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)),MY(e,()=>e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)),n}(e,new Uint16Array([0,1,2,2,1,3]))}function V$(e,t,n,r,a,i){!function(e,t){const n=_k().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){const n="[".concat(e,"x").concat(t,"]");throw new Error("Requested texture size "+n+" is invalid.")}if(e>n||t>n){const r="[".concat(e,"x").concat(t,"]"),a="[".concat(n,"x").concat(n,"]");throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+a+".")}}(t,n);const o=function(e){return XY(e,()=>e.createTexture(),"Unable to create WebGLTexture.")}(e),s=e.TEXTURE_2D;return MY(e,()=>e.bindTexture(s,o)),MY(e,()=>e.texParameteri(s,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)),MY(e,()=>e.texParameteri(s,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),MY(e,()=>e.texParameteri(s,e.TEXTURE_MIN_FILTER,e.NEAREST)),MY(e,()=>e.texParameteri(s,e.TEXTURE_MAG_FILTER,e.NEAREST)),1===_k().getNumber("WEBGL_VERSION")?MY(e,()=>e.texImage2D(s,0,r,t,n,0,a,i,null)):MY(e,()=>e.texStorage2D(s,1,r,t,n)),MY(e,()=>e.bindTexture(e.TEXTURE_2D,null)),{texture:o,texShape:[n,t]}}function H$(e){return e.internalFormatFloat}function G$(e){return e.internalFormatHalfFloat}function q$(e){return e.downloadTextureFormat}function K$(e){return e.internalFormatPackedFloat}function X$(e){return e.internalFormatPackedHalfFloat}function Y$(e,t,n,r,a,i,o,s){const l=e,c=new Float32Array(function(e,t){const[n,r]=LY(e,t);return n*r*4}(i,o));return l.bindBuffer(l.PIXEL_PACK_BUFFER,t),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}class $${constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const t=_k().getNumber("WEBGL_VERSION");if(null!=e?(this.gl=e,function(e,t){_Y[e]=t}(t,e)):this.gl=TY(t),e=this.gl,2===_k().getNumber("WEBGL_VERSION")){const t=e;this.createVertexArray=()=>MY(t,()=>t.createVertexArray()),this.bindVertexArray=e=>MY(t,()=>t.bindVertexArray(e)),this.deleteVertexArray=e=>MY(t,()=>t.deleteVertexArray(e)),this.getVertexArray=()=>MY(t,()=>t.getParameter(t.VERTEX_ARRAY_BINDING))}else if(null!=e){const t=e.getExtension("OES_vertex_array_object");if(null==t)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>MY(e,()=>t.createVertexArrayOES()),this.bindVertexArray=n=>MY(e,()=>t.bindVertexArrayOES(n)),this.deleteVertexArray=n=>MY(e,()=>t.deleteVertexArrayOES(n)),this.getVertexArray=()=>MY(e,()=>e.getParameter(t.VERTEX_ARRAY_BINDING_OES))}let n="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),1===_k().getNumber("WEBGL_VERSION")){const e="OES_texture_float",t="OES_texture_half_float";if(this.textureFloatExtension=BY(this.gl,e),r$(this.gl,t))this.textureHalfFloatExtension=BY(this.gl,t);else if(_k().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),r$(this.gl,r))this.colorBufferHalfFloatExtension=BY(this.gl,r);else if(_k().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",r$(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!r$(this.gl,r))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(r)}this.vertexBuffer=W$(this.gl),this.indexBuffer=U$(this.gl),this.framebuffer=function(e){return XY(e,()=>e.createFramebuffer(),"Unable to create WebGLFramebuffer.")}(this.gl),this.textureConfig=PY(this.gl,this.textureHalfFloatExtension)}get debug(){return _k().getBool("DEBUG")}dispose(){if(this.disposed)return;null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;MY(e,()=>e.finish()),MY(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),MY(e,()=>e.deleteFramebuffer(this.framebuffer)),MY(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),MY(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),MY(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[a,i]=FY(t,n);return V$(e,a,i,H$(r),r.textureFormatFloat,e.FLOAT)}(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[a,i]=FY(t,n);return V$(e,a,i,G$(r),r.textureFormatFloat,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[a,i]=FY(t,n);return V$(e,a,i,q$(r),e.RGBA,e.UNSIGNED_BYTE)}(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),function(e,t,n){MY(e,()=>e.bindTexture(e.TEXTURE_2D,t)),n.data instanceof Uint8Array?2===_k().getNumber("WEBGL_VERSION")?MY(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,e.RGBA,e.UNSIGNED_BYTE,n.data)):MY(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)):2===_k().getNumber("WEBGL_VERSION")?MY(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,n)):MY(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)),MY(e,()=>e.bindTexture(e.TEXTURE_2D,null))}(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,n,r){this.throwIfDisposed(),function(e,t,n,r,a,i){let o,s,l;MY(e,()=>e.bindTexture(e.TEXTURE_2D,t)),a instanceof Uint8Array?(o=new Uint8Array(n*r*4),s=e.UNSIGNED_BYTE,l=e.RGBA):(o=new Float32Array(n*r*4),s=e.FLOAT,l=i.internalFormatPackedFloat),o.set(a),2===_k().getNumber("WEBGL_VERSION")?MY(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,r,e.RGBA,s,o)):MY(e,()=>e.texImage2D(e.TEXTURE_2D,0,l,n,r,0,e.RGBA,s,o)),MY(e,()=>e.bindTexture(e.TEXTURE_2D,null))}(this.gl,e,t,n,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[a,i]=LY(t,n);return V$(e,a,i,X$(r),e.RGBA,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[a,i]=LY(t,n);return V$(e,a,i,K$(r),e.RGBA,e.FLOAT)}(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(qY(this.gl,this.framebuffer),this.outputTexture=null),MY(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,n){return this.downloadMatrixDriver(e,()=>function(e,t,n,r){const[a,i]=FY(t,n),o=new Uint8Array(t*n*4);return MY(e,()=>e.readPixels(0,0,a,i,r.downloadTextureFormat,e.UNSIGNED_BYTE,o)),new Float32Array(o.buffer)}(this.gl,t,n,this.textureConfig))}downloadPackedMatrixFromBuffer(e,t,n,r,a,i){return Y$(this.gl,e,0,0,0,a,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return function(e,t,n){const r=e,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}(this.gl,e,t)}createBufferFromTexture(e,t,n){this.bindTextureToFrameBuffer(e);const r=function(e,t,n){const r=e.createBuffer();MY(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,r));const a=16*t*n;return MY(e,()=>e.bufferData(e.PIXEL_PACK_BUFFER,a,e.STREAM_READ)),MY(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)),MY(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,null)),r}(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,n;if(_k().getBool("WEBGL_FENCE_API_ENABLED")){const r=e,a=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=()=>{const e=r.clientWaitSync(a,0,0);return e===r.ALREADY_SIGNALED||e===r.CONDITION_SATISFIED},t=a}else _k().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(t,_k().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:t,isFencePassed:n}}downloadMatrixFromPackedTexture(e,t,n){return this.downloadMatrixDriver(e,()=>function(e,t,n){const r=new Float32Array(t*n*4);return MY(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r)),r}(this.gl,t,n))}createProgram(e){this.throwIfDisposed();const t=this.gl;null==this.vertexShader&&(this.vertexShader=z$(t));const n=function(e){return XY(e,()=>e.createProgram(),"Unable to create WebGLProgram.")}(t);MY(t,()=>t.attachShader(n,this.vertexShader)),MY(t,()=>t.attachShader(n,e)),function(e,t){if(MY(e,()=>e.linkProgram(t)),!_k().get("ENGINE_COMPILE_ONLY")&&!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}(t,n);const r=Object.assign(n,{vao:this.createVertexArray()});return this.debug&&UY(t,r),r}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const t=this.gl;MY(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),function(e,t,n){MY(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),VY(e,t,"clipSpacePos",n,3,20,0)&&VY(e,t,"uv",n,2,20,12)}(t,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&(MY(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&UY(this.gl,this.program),MY(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.throwIfDisposed(),n?function(e,t,n){return XY(e,()=>e.getUniformLocation(t,n),'uniform "'+n+'" not present in program.')}(this.gl,e,t):function(e,t,n){return e.getUniformLocation(t,n)}(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),MY(this.gl,()=>this.gl.getAttribLocation(e,t))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),HY(this.gl,e,t,n)}setOutputMatrixTexture(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}setOutputPackedMatrixTexture(e,t,n){this.throwIfDisposed();const[r,a]=LY(t,n);this.setOutputMatrixTextureDriver(e,r,a)}setOutputMatrixWriteRegion(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)}setOutputPackedMatrixWriteRegion(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){null!=this.program&&UY(this.gl,this.program),KY(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const e=this.getVertexArray();console.assert(e===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}MY(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),MY(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=BY(this.gl,2===_k().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(2===_k().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}const e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(2===_k().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const e=this.gl,t=this.getQueryTimerExtensionWebGL2();return void e.endQuery(t.TIME_ELAPSED_EXT)}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await tk(()=>this.disposed||this.isQueryAvailable(e,_k().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,_k().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(0===t)return null;if(2===t){const t=this.gl;return t.getQueryParameter(e,t.QUERY_RESULT)/1e6}{const t=this.getQueryTimerExtensionWebGL1();return t.getQueryObjectEXT(e,t.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(0===t)return!0;if(2===t){const t=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=t.getQueryParameter(e,t.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),r&&!this.disjoint}{const t=this.getQueryTimerExtensionWebGL1(),n=t.getQueryObjectEXT(e,t.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(t.GPU_DISJOINT_EXT)),n&&!this.disjoint}}pollFence(e){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})}pollItems(){const e=function(e){let t=0;for(;t<e.length;++t){if(!e[t]())break}return t-1}(this.itemsToPoll.map(e=>e.isDoneFn));for(let t=0;t<=e;++t){const{resolveFn:e}=this.itemsToPoll[t];e()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let n;"setTimeoutCustom"in _k().platform&&(n=_k().platform.setTimeoutCustom.bind(_k().platform)),tk(()=>(this.pollItems(),0===this.itemsToPoll.length),()=>0,null,n)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),GY(this.gl,e,this.framebuffer),this.debug&&KY(this.gl)}unbindTextureToFrameBuffer(){null!=this.outputTexture?(GY(this.gl,this.outputTexture,this.framebuffer),this.debug&&KY(this.gl)):qY(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);const n=t();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(e,t,n){this.throwIfDisposed();const r=this.gl;GY(r,e,this.framebuffer),this.debug&&KY(r),this.outputTexture=e,MY(r,()=>r.viewport(0,0,t,n)),MY(r,()=>r.scissor(0,0,t,n))}setOutputMatrixWriteRegionDriver(e,t,n,r){this.throwIfDisposed(),MY(this.gl,()=>this.gl.scissor(e,t,n,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(null==this.program)throw new Error("No GPU program is currently set.")}}const{mx:J$,XI:Q$,Nk:Z$,f6:eJ,ct:tJ,YG:nJ,hH:rJ,z3:aJ,sG:iJ,uM:oJ,vS:sJ,qB:lJ,GG:cJ,rq:uJ,lg:hJ,WR:dJ,cu:fJ,GE:pJ,px:gJ,jC:mJ,He:vJ,hE:bJ,BF:xJ,Dk:yJ,cl:wJ,_B:kJ,ub:NJ,_f:SJ,Ku:CJ,qy:EJ,Zy:_J,bu:IJ,zv:TJ,dH:AJ,HS:RJ,yH:DJ,l3:FJ,z9:OJ,x6:LJ,_m:PJ,eW:MJ,GK:jJ,SP:BJ,yr:zJ,dl:WJ,Dw:UJ,xT:VJ,_X:HJ,wz:GJ}=i;function qJ(e,t){return["x","y","z","w","u","v"].slice(0,t).map(t=>"".concat(e,".").concat(t))}function KJ(e,t){return 1===t?[e]:qJ(e,t)}class XJ{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=D$(this.outputShape.length),0===this.rank)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{const e=KJ("rc",this.rank),t=C$(this.rank),n=this.getOutOfBoundsCondition(e),r=this.getSetup(e),a=this.getOutput(e);this.userCode="\n        void main() {\n          ".concat(t," rc = getOutputCoords();\n\n          if(").concat(n,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(r,"\n\n            setOutput(vec4(").concat(a,"));\n          }\n        }\n      ")}}getSourceCoordsArr(e){const t=[];for(let n=0;n<=1;n++)for(let r=0;r<=1;r++){let a="".concat(0===n?"r":"rp1",", ").concat(0===r?"c":"cp1");for(let t=2;t<this.rank;t++)a="".concat(e[e.length-1-t],",")+a;t.push(a)}return t}getOutOfBoundsCondition(e){if(1===this.rank)return"rc > ".concat(this.enableShapeUniforms?"outShape":this.outputShape[0]);let t="";for(let n=this.rank-2;n<this.rank;n++)t+="".concat(e[n]," >= ").concat(this.enableShapeUniforms?"outShape[".concat(n,"]"):this.outputShape[n]),n<this.rank-1&&(t+="||");return t}getSetup(e){if(1===this.rank)return"";const t=e.slice(-2),n=this.enableShapeUniforms?"outShape[".concat(this.rank," - 1]"):this.outputShape[this.rank-1],r=this.enableShapeUniforms?"outShape[".concat(this.rank," - 2]"):this.outputShape[this.rank-2];return"\n      int r = ".concat(t[0],";\n      int c = ").concat(t[1],";\n      int rp1 = r + 1;\n      int cp1 = c + 1;\n\n      bool cEdge = cp1 >= ").concat(n,";\n      bool rEdge = rp1 >= ").concat(r,";\n    ")}getOutput(e){const t=this.getSourceCoordsArr(e);if(1===this.rank){const e=this.enableShapeUniforms?"outShape":this.outputShape[0];return"getA(rc), (rc + 1 >= ".concat(e," ? 0. : getA(rc + 1)), 0, 0")}return"getA(".concat(t[0],"),\n            cEdge ? 0. : getA(").concat(t[1],"),\n            rEdge ? 0. : getA(").concat(t[2],"),\n            rEdge || cEdge ? 0. : getA(").concat(t[3],")")}}class YJ{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=D$(this.outputShape.length);let n="";for(let r=0;r<4;r++){let e="thisRC = rc;";r%2===1&&(e+="thisRC.z += 1;"),r>1&&(e+="thisRC.y += 1;"),n+="\n        ".concat(e,"\n        ").concat(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(r,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(r>0?"}":"","\n      ")}this.userCode="\n      ".concat(function(e,t){const n=t?d$(["r","c","d"],"inputShape"):u$(["r","c","d"],e);return"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(n,"\n      return ivec3(r, c, d);\n    }\n  ")}(t,this.enableShapeUniforms),"\n      ").concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":f$(e),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(this.enableShapeUniforms?"outShape[1]":e[1],";\n        int cols = ").concat(this.enableShapeUniforms?"outShape[2]":e[2],";\n\n        ").concat(n,"\n\n        setOutput(result);\n      }\n    ")}}class $J{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,t,n){const r=QJ(t,n),a=ZJ(e,r,n);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);const i=JJ(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();const e=this.freeTextures[a].pop();return this.usedTextures[a].push(e),e}let o;return r===DY.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===DY.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===DY.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===DY.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===DY.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(o),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),o}releaseTexture(e,t,n,r){if(null==this.freeTextures)return;const a=QJ(n,r),i=ZJ(t,a,r);i in this.freeTextures||(this.freeTextures[i]=[]);const o=JJ(t,a,this.gpgpu.gl,this.gpgpu.textureConfig,r),s=_k().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==s&&this._numBytesAllocated>s?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=o):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=o),this.numUsedTextures--;const l=this.usedTextures[i],c=l&&l.indexOf(e);if(null==c||c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");l[c]=l[l.length-1],l.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(e,")"));const t=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: ".concat(this._numBytesAllocated)),console.log("Bytes unused: ".concat(this._numBytesFree," (").concat(Math.round(100*t),"%)"))}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(null!=this.freeTextures){for(const e in this.freeTextures)this.freeTextures[e].forEach(e=>{this.gpgpu.deleteMatrixTexture(e.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(e=>{this.gpgpu.deleteMatrixTexture(e.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function JJ(e,t,n,r,a){const i=function(e,t){switch(e){case DY.PACKED_2X2_FLOAT32:return K$(t);case DY.PACKED_2X2_FLOAT16:return X$(t);case DY.UNPACKED_FLOAT32:return H$(t);case DY.UNPACKED_FLOAT16:return G$(t);case DY.PACKED_4X1_UNSIGNED_BYTE:return q$(t);default:throw new Error("Unknown physical texture type ".concat(e))}}(t,r);let o;if(a){const[t,n]=LY(e[0],e[1]);o=t*n}else{const[t,n]=FY(e[0],e[1]);o=t*n}const s=function(e,t){const n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw new Error("Unknown internal format ".concat(t))}(n,i);return o*s}function QJ(e,t){if(e===RY.UPLOAD)return DY.PACKED_2X2_FLOAT32;if(e===RY.RENDER||null==e)return function(e){return _k().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?DY.PACKED_2X2_FLOAT32:DY.UNPACKED_FLOAT32:e?DY.PACKED_2X2_FLOAT16:DY.UNPACKED_FLOAT16}(t);if(e===RY.DOWNLOAD||e===RY.PIXELS)return DY.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type ".concat(e))}function ZJ(e,t,n){return"".concat(e[0],"_").concat(e[1],"_").concat(t,"_").concat(n)}class eQ{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=D$(this.outputShape.length),this.userCode="\n      float unaryOperation(float x) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")}}const tQ="if (isnan(x)) return x;",nQ="return abs(x);";const rQ=tQ+"\n  return (x < 0.0) ? 0.0 : x;\n",aQ=tQ+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",iQ="return x;";class oQ{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=D$(this.outputShape.length),this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(t,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")}}class sQ{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=D$(this.outputShape.length);const t=e.length,n=KJ("rc",t),r=C$(t),a=function(e,t){if(1===e)return"rc";let n="";for(let r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(t,n),i=n.slice(-2),o=t<=1?"rc":"vec2(".concat(i.join(","),")");this.userCode="\n      void main() {\n        ".concat(r," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(a,");\n\n        setOutput(getChannel(packedInput, ").concat(o,"));\n      }\n    ")}}const lQ=DF,cQ={};const uQ=_k().getNumber("CPU_HANDOFF_SIZE_THRESHOLD");class hQ extends Ww{nextDataId(){return hQ.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!_k().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let t;if(null!=e){if(e instanceof $$)t=e;else{const n=TY(_k().getNumber("WEBGL_VERSION"),e);t=new $$(n)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const e=TY(_k().getNumber("WEBGL_VERSION"));t=new $$(e),this.binaryCache=((n=_k().getNumber("WEBGL_VERSION"))in cQ||(cQ[n]={}),cQ[n]),this.gpgpuCreatedLocally=!0}var n;this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new $J(this.gpgpu),this.numMBBeforeWarning=null==_k().global.screen?1024:_k().global.screen.height*_k().global.screen.width*window.devicePixelRatio*600/1024/1024,this.texData=new zw(this,m_())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,t,n,r,a,i){const o=this.makeTensorInfo(t,n),s=this.texData.get(o.dataId);s.isPacked=!1,s.texture={texture:e,texShape:[r,a]},s.texShape=[r,a];const l=QY(t),c=new j$(l,!1,i),u=this.runWebGLProgram(c,[o],n,[[r,a]]);return u.shape=t,s.texture=null,this.disposeIntermediateTensorInfo(o),u.dataId}write(e,t,n){if((_k().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||_k().getBool("DEBUG"))&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:RY.UPLOAD,refCount:1}),r}refCount(e){if(this.texData.has(e)){return this.texData.get(e).refCount}return 0}incRef(e){this.texData.get(e).refCount++}decRef(e){if(this.texData.has(e)){this.texData.get(e).refCount--}}move(e,t,n,r,a){if(_k().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:RY.UPLOAD,refCount:a})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const t=this.texData.get(e),{values:n,dtype:r,complexTensorInfos:a,slice:i,shape:o,isPacked:s}=t;if(null!=i){let t;t=s?new oQ(o,iQ):new eQ(o,iQ);const n=this.runWebGLProgram(t,[{dataId:e,shape:o,dtype:r}],r),a=this.readSync(n.dataId);return this.disposeIntermediateTensorInfo(n),a}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===r)return n;const l=null!=this.activeTimers;let c,u;if(l&&(c=mE()),"complex64"===r){u=$D(this.readSync(a.real.dataId),this.readSync(a.imag.dataId))}else u=this.getValuesFromTexture(e);return l&&(this.downloadWaitMs+=mE()-c),this.convertAndCacheOnCPU(e,u)}async read(e){if(this.pendingRead.has(e)){const t=this.pendingRead.get(e);return new Promise(e=>t.push(e))}const t=this.texData.get(e),{values:n,shape:r,slice:a,dtype:i,complexTensorInfos:o,isPacked:s}=t;if(null!=a){let t;t=s?new oQ(r,iQ):new eQ(r,iQ);const n=this.runWebGLProgram(t,[{dataId:e,shape:r,dtype:i}],i),a=this.read(n.dataId);return this.disposeIntermediateTensorInfo(n),a}if(null!=n)return this.convertAndCacheOnCPU(e);if(_k().getBool("DEBUG")&&!_k().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===_k().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let l,c,u=null;if("complex64"!==i&&_k().get("WEBGL_BUFFER_SUPPORTED")){l=this.decode(e);const t=this.texData.get(l.dataId);u=this.gpgpu.createBufferFromTexture(t.texture.texture,...OY(r))}if(this.pendingRead.set(e,[]),"complex64"!==i&&await this.gpgpu.createAndWaitForFence(),"complex64"===i){const e=await Promise.all([this.read(o.real.dataId),this.read(o.imag.dataId)]);c=$D(e[0],e[1])}else if(null==u)c=this.getValuesFromTexture(e);else{const e=$w(r);c=this.gpgpu.downloadFloat32MatrixFromBuffer(u,e)}if(null!=l&&this.disposeIntermediateTensorInfo(l),null!=u){const e=this.gpgpu.gl;MY(e,()=>e.deleteBuffer(u))}const h=this.convertAndCacheOnCPU(e,c),d=this.pendingRead.get(e);return this.pendingRead.delete(e),d.forEach(e=>e(h)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&m_().removeDataId(e,this),this.pendingDeletes--),h}readToGPU(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=this.texData.get(e),{values:r,shape:a,slice:i,dtype:o,isPacked:s,texture:l}=n;if("complex64"===o)throw new Error("Does not support reading texture for complex64 dtype.");if(null!=i){let n;n=s?new oQ(a,iQ):new eQ(a,iQ);const r=this.runWebGLProgram(n,[{dataId:e,shape:a,dtype:o}],o),i=this.readToGPU(r,t);return this.disposeIntermediateTensorInfo(r),i}if(null==l)throw null!=r?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const c=this.decode(e,t.customTexShape),u=m_().makeTensorFromTensorInfo(c),h=this.texData.get(c.dataId);return Object.assign({tensorRef:u},h.texture)}bufferSync(e){const t=this.readSync(e.dataId);if("string"===e.dtype)try{const n=t.map(e=>bE(e));return iI(e.shape,e.dtype,n)}catch(Gu){throw new Error("Failed to decode encoded string bytes into utf-8")}return iI(e.shape,e.dtype,t)}checkNumericalProblems(e){if(null!=e)for(let t=0;t<e.length;t++){const n=e[t];if(!jY(n)){if(_k().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value ".concat(n," cannot be represented with your ")+"current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value ".concat(n," cannot be represented on this device."))}}}getValuesFromTexture(e){const{shape:t,dtype:n,isPacked:r}=this.texData.get(e),a=$w(t);if(_k().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const n=this.decode(e),r=this.texData.get(n.dataId),i=this.gpgpu.downloadMatrixFromPackedTexture(r.texture.texture,...OY(t)).subarray(0,a);return this.disposeIntermediateTensorInfo(n),i}const i=_k().getBool("WEBGL_PACK")&&!0===r,o=i?QY(t):t,s=i?new P$(o):new L$(o),l=this.runWebGLProgram(s,[{shape:o,dtype:n,dataId:e}],"float32"),c=this.texData.get(l.dataId),u=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture.texture,c.texShape[0],c.texShape[1]).subarray(0,a);return this.disposeIntermediateTensorInfo(l),u}timerAvailable(){return _k().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const t=this.activeTimers,n=[];let r=!1;null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,e();const a=yE(this.activeTimers.map(e=>e.query)).filter(e=>null!=e),i=yE(this.activeTimers.map(e=>e.name)).filter(e=>null!=e);this.activeTimers=t,r&&(this.programTimersStack=null);const o={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(_k().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const e=await Promise.all(a);o.kernelMs=function(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t}(e),o.getExtraProfileInfo=()=>e.map((e,t)=>({name:i[t],ms:e})).map(e=>"".concat(e.name,": ").concat(e.ms)).join(", ")}else o.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,o})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return _k().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:mE(),endMs:null}}endTimer(e){return _k().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=mE(),e)}async getQueryTime(e){if(_k().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const t=e;return t.endMs-t.startMs}disposeData(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:n}=this.texData.get(e);return null!=n&&(this.disposeData(n.real.dataId,t),this.disposeData(n.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:t,dtype:n,texShape:r,usage:a,isPacked:i,slice:o}=this.texData.get(e),s=o&&o.origDataId||e,l=this.dataRefCount.get(s);l>1?this.dataRefCount.set(s,l-1):(this.dataRefCount.delete(s),null!=t&&(this.numBytesInGPU-=this.computeBytes(r,n),this.textureManager.releaseTexture(t,r,a,i)));const c=this.texData.get(e);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:uQ;return _k().getBool("WEBGL_CPU_FORWARD")&&e.every(e=>null==this.texData.get(e.dataId).texture&&$w(e.shape)<t)}getGPGPUContext(){return this.gpgpu}where(e){VC("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const t=e.dataSync();return lQ(e.shape,t)}packedUnaryOp(e,t,n){const r=new oQ(e.shape,t),a=this.compileAndRun(r,[e],n);return m_().makeTensorFromTensorInfo(a)}abs(e){if(this.shouldExecuteOnCPU([e])&&"complex64"!==e.dtype){const t=AJ(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,t)}if(_k().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,nQ,e.dtype);const t=new eQ(e.shape,nQ),n=this.compileAndRun(t,[e]);return m_().makeTensorFromTensorInfo(n)}makeTensorInfo(e,t,n){let r;if("string"===t&&null!=n&&n.length>0&&ck(n[0])){const a=n.map(e=>vE(e));r=this.write(a,e,t)}else r=this.write(n,e,t);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:t}}makeOutput(e,t,n){return m_().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,n),this)}unpackTensor(e){const t=new sQ(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){const t=new XJ(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}packedReshape(e,t){const n=[$Y(e.shape),...JY(e.shape)],r={dtype:e.dtype,shape:n,dataId:e.dataId},a=[$Y(t),...JY(t)],i=new YJ(a,n),o=[n],s=this.runWebGLProgram(i,[r],e.dtype,o,!0);return{dataId:s.dataId,shape:t,dtype:s.dtype}}decode(e,t){const n=this.texData.get(e),{isPacked:r,shape:a,dtype:i}=n;if(null!=t){Kw($w(a)<=t[0]*t[1]*4,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const o=QY(a);let s;s=r?new O$(o):new F$(o);const l=[null!=t?t:OY(o)];return{dtype:i,shape:a,dataId:this.runWebGLProgram(s,[{shape:o,dtype:i,dataId:e}],i,l,!0,t).dataId}}runWebGLProgram(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5?arguments[5]:void 0;const o=this.makeTensorInfo(e.outputShape,n),s=this.texData.get(o.dataId);if(e.packedOutput&&(s.isPacked=!0),e.outPackingScheme===AY.DENSE){const t=null!=i?i:OY(e.outputShape);s.texShape=t.map(e=>2*e)}if(null!=e.outTexUsage&&(s.usage=e.outTexUsage),0===$w(o.shape))return s.values=ik(o.dtype,0),o;const l=[],c=t.map(t=>{if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let n=this.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&$w(t.shape)<=_k().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}if(this.uploadToGPU(t.dataId),!!n.isPacked!==!!e.packedInputs)t=n.isPacked?this.unpackTensor(t):this.packTensor(t),l.push(t),n=this.texData.get(t.dataId);else if(n.isPacked&&!e$(n.shape,t.shape)){const e=t,r=t.shape;t.shape=n.shape,t=this.packedReshape(t,r),l.push(t),n=this.texData.get(t.dataId),e.shape=r}return{shape:t.shape,texData:n,isUniform:!1}});this.uploadToGPU(o.dataId);const u={shape:o.shape,texData:s,isUniform:!1},h=function(e,t,n){let r="";t.concat(n).forEach(t=>{const a=null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!t.isUniform){const i=t.texData.texShape,{useSqueezeShape:o,uniformShape:s,keptDims:l}=E$(e.packedInputs,t.shape,i);let c="",u="",h="";if(1===s.length&&e.packedInputs){const e=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];c="".concat(e[0]>1,"_").concat(e[1]>1)}else if(2!==s.length||e.packedInputs){if(s.length>2&&!e.packedInputs){const e=pk(s);h="".concat(e[0]===i[1],"_").concat(e[e.length-1]===i[1])}}else u="".concat(s[0]>1,"_").concat(s[1]>1);const d=t.shape.length,f=2===s.length&&Jw(t.shape,i),p=1===$w(t.shape),g=RI(t.shape,n.shape),m=!e.packedInputs&&d===n.shape.length&&Jw(i,n.texData.texShape),v=e.packedInputs||s.length>2?"":"".concat(i[0]>1,"_").concat(i[1]>1);r+="".concat(d,"_").concat(m,"_").concat(o?l:"","_").concat(s.length,"_").concat(p,"_").concat(g,"_").concat(f,"_").concat(c,"_").concat(u,"_").concat(h,"_").concat(v,"_").concat(a)}else{const e=t.isUniform?"uniform":t.texData.texShape;r+="".concat(t.shape,"_").concat(e,"_").concat(a)}});const a=e.userCode;let i=e.constructor.name;return i+="_"+r+"_"+a+"".concat(_k().getNumber("WEBGL_VERSION")),i}(e,c,u),d=this.getAndSaveBinary(h,()=>T$(this.gpgpu,e,c,u)),f=null!=this.activeTimers;let p;f&&(p=this.startTimer()),_k().get("ENGINE_COMPILE_ONLY")||function(e,t,n,r,a){t.program.enableShapeUniforms||(R$(t.inShapeInfos,n),R$([t.outShapeInfo],[r]));const i=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(i.texture,o[0],o[1]):e.setOutputMatrixTexture(i.texture,o[0],o[1]),e.setProgram(t.webGLProgram),e.bindVertexArray(t.webGLProgram.vao),1===_k().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN);for(let l=0;l<n.length;++l){const r=n[l],{uniform:a,offset:i,shape:o,texShape:s}=t.variablesLocations[l];if(o){const{uniformShape:n}=E$(t.program.packedInputs,r.shape,r.texData.texShape);switch(n.length){case 1:e.gl.uniform1iv(o,new Int32Array(n));break;case 2:e.gl.uniform2iv(o,new Int32Array(n));break;case 3:e.gl.uniform3iv(o,new Int32Array(n));break;case 4:e.gl.uniform4iv(o,new Int32Array(n))}}if(s&&e.gl.uniform2i(s,r.texData.texShape[0],r.texData.texShape[1]),null!=a)if(r.isUniform)if($w(r.shape)<2)e.gl.uniform1f(a,r.uniformValues[0]);else{let t=r.uniformValues;t instanceof Float32Array||(t=new Float32Array(t)),e.gl.uniform1fv(a,t)}else null!=r.texData.slice&&null!=i&&e.gl.uniform1i(i,r.texData.slice.flatOffset),e.setInputMatrixTexture(r.texData.texture.texture,a,l)}const s=t.outShapeLocation;if(s)switch(r.shape.length){case 1:e.gl.uniform1iv(s,new Int32Array(r.shape));break;case 2:e.gl.uniform2iv(s,new Int32Array(r.shape));break;case 3:e.gl.uniform3iv(s,new Int32Array(r.shape));break;case 4:e.gl.uniform4iv(s,new Int32Array(r.shape))}if(t.outShapeStridesLocation){const n=pk(r.shape);switch(r.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(n));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(n));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(n))}}if(t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),t.program.customUniforms&&a)for(let l=0;l<t.program.customUniforms.length;++l){const n=t.program.customUniforms[l],r=t.customUniformLocations[l],i=a[l];if("float"===n.type)e.gl.uniform1fv(r,i);else if("vec2"===n.type)e.gl.uniform2fv(r,i);else if("vec3"===n.type)e.gl.uniform3fv(r,i);else if("vec4"===n.type)e.gl.uniform4fv(r,i);else if("int"===n.type)e.gl.uniform1iv(r,i);else if("ivec2"===n.type)e.gl.uniform2iv(r,i);else if("ivec3"===n.type)e.gl.uniform3iv(r,i);else{if("ivec4"!==n.type)throw Error("uniform type ".concat(n.type," is not supported yet."));e.gl.uniform4iv(r,i)}}e.executeProgram()}(this.gpgpu,d,c,u,r),l.forEach(e=>this.disposeIntermediateTensorInfo(e)),f&&(p=this.endTimer(p),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(p)}));const g=_k().getNumber("WEBGL_FLUSH_THRESHOLD");if(g>0){const e=mE();e-this.lastGlFlushTime>g&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=e)}if(!_k().getBool("WEBGL_LAZILY_UNPACK")&&s.isPacked&&!1===a){const e=this.unpackTensor(o);return this.disposeIntermediateTensorInfo(o),e}return o}compileAndRun(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];n=n||t[0].dtype;return this.runWebGLProgram(e,t,n,r,a)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){if(!this.disposed){if(!_k().getBool("IS_TEST")){Object.keys(this.binaryCache).forEach(e=>{this.gpgpu.deleteProgram(this.binaryCache[e].webGLProgram),delete this.binaryCache[e]})}this.textureManager.dispose(),null!=this.canvas&&"undefined"!==typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0}}floatPrecision(){return null==this.floatPrecisionValue&&(this.floatPrecisionValue=b_(()=>{if(!_k().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=_k().getBool("DEBUG");_k().set("DEBUG",!1);const t=this.abs(vI(1e-8)).dataSync()[0];if(_k().set("DEBUG",e),t>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}uploadToGPU(e){const t=this.texData.get(e),{shape:n,dtype:r,values:a,texture:i,usage:o,isPacked:s}=t;if(null!=i)return;const l=null!=this.activeTimers;let c;l&&(c=mE());let u=t.texShape;if(null==u&&(u=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=_k().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=_k().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");if(r===1/0&&_k().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),t&&(n*=2,r*=2,e=e.map((t,n)=>n>=e.length-2?Gw(e[n]):e[n]),1===e.length&&(e=[2,e[0]])),2!==e.length){const t=ak(e);e=t.newShape}let a=$w(e),i=null;e.length<=1&&a<=n?i=[1,a]:2===e.length&&e[0]<=n&&e[1]<=n?i=e:3===e.length&&e[0]*e[1]<=n&&e[2]<=n?i=[e[0]*e[1],e[2]]:3===e.length&&e[0]<=n&&e[1]*e[2]<=n?i=[e[0],e[1]*e[2]]:4===e.length&&e[0]*e[1]*e[2]<=n&&e[3]<=n?i=[e[0]*e[1]*e[2],e[3]]:4===e.length&&e[0]<=n&&e[1]*e[2]*e[3]<=n&&(i=[e[0],e[1]*e[2]*e[3]]);const o=null!=i&&Math.max(...i)>r&&Math.min(...i)<=(t?2:1)&&Math.min(...i)>0;if(null==i||o)if(t){const t=$Y(e);let n=2,r=2;e.length&&([n,r]=JY(e)),a=t*(n/2)*(r/2),i=Zw(a).map(e=>2*e)}else i=Zw(a);return i}(n,s),t.texShape=u),null!=a){const e=QY(n);let i,o=u[1],h=u[0];const d=a instanceof Uint8Array||a instanceof Uint8ClampedArray;!s&&d||([o,h]=LY(u[0],u[1])),i=s?new B$(e,d):new j$(e,d);const f=d?[h,o]:u,p=this.makeTensorInfo(f,r),g=this.texData.get(p.dataId);g.usage=d?RY.PIXELS:RY.UPLOAD,g.texShape=f,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(p.dataId),o,h,a);const m=[[h,o]],v=!0,b=this.runWebGLProgram(i,[p],r,m,v),x=this.texData.get(b.dataId);t.texShape=x.texShape,t.isPacked=x.isPacked,t.usage=x.usage,_k().get("ENGINE_COMPILE_ONLY")?this.disposeData(b.dataId):(t.texture=x.texture,t.values=null,this.texData.delete(b.dataId)),this.disposeIntermediateTensorInfo(p),l&&(this.uploadWaitMs+=mE()-c)}else{const e=this.acquireTexture(u,o,r,s);t.texture=e}}convertAndCacheOnCPU(e,t){const n=this.texData.get(e),{dtype:r}=n;return null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){const n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length);for(let t=0;t<n.length;++t)n[t]=Math.round(e[t]);return n}throw new Error("Unknown dtype ".concat(t))}(t,r)),n.values}acquireTexture(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){const e=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(e," MB, ")+"most likely due to a memory leak")}return this.textureManager.acquireTexture(e,t,r)}computeBytes(e,t){return e[0]*e[1]*lk(t)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}for(const[,t]of Object.entries(this.binaryCache)){const n=new Promise(e=>{try{this.checkCompletion_(t),e(!0)}catch(n){throw n}});e.push(n)}return Promise.all(e)}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await kD(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(!1===this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)){if(console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),!1===this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS))throw WY(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.");throw new Error("Failed to link vertex and fragment shaders.")}return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:t,customUniformLocations:n,infLoc:r,nanLoc:a,outShapeLocation:i,outShapeStridesLocation:o,outTexShapeLocation:s}=A$(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=t,e.customUniformLocations=n,e.infLoc=r,e.nanLoc=a,e.outShapeLocation=i,e.outShapeStridesLocation=o,e.outTexShapeLocation=s}}createTensorFromGPUData(e,t,n){e.channels=e.channels||"RGBA";const{texture:r,height:a,width:i,channels:o}=e,s=m_().backend;if(!s.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const l=s.writeTexture(r,t,n,a,i,o);return m_().makeTensorFromDataId(l,t,n,s)}}hQ.nextDataId=0;a_()&&w_("webgl",()=>new hQ,2);const dQ="\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n";class fQ{constructor(e,t,n){this.variableNames=["A","B"],this.outputShape=FI(t,n),this.enableShapeUniforms=D$(this.outputShape.length),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(e,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")}}const pQ="\n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n";class gQ{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=FI(t,n);const a=this.outputShape.length;this.enableShapeUniforms=D$(a);let i="";if(r)if(0===a||1===$w(this.outputShape))i="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else{const e=C$(a);if(i="\n          ".concat(e," coords = getOutputCoords();\n        "),1===a)this.enableShapeUniforms?i+="\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ":i+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{const e=KJ("coords",a);this.enableShapeUniforms?i+="\n            bool nextRowOutOfBounds =\n              (".concat(e[a-2]," + 1) >= outShape[").concat(a," - 2];\n            bool nextColOutOfBounds =\n              (").concat(e[a-1]," + 1) >= outShape[").concat(a," - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "):i+="\n            bool nextRowOutOfBounds =\n              (".concat(e[a-2]," + 1) >= ").concat(this.outputShape[a-2],";\n            bool nextColOutOfBounds =\n              (").concat(e[a-1]," + 1) >= ").concat(this.outputShape[a-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(e,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(i,"\n\n        setOutput(result);\n      }\n    ")}}function mQ(e){const{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const vQ={kernelName:KN,backendName:"webgl",kernelFunc:mQ};function bQ(e){const{inputs:t,backend:n}=e,{real:r,imag:a}=t,i=n.makeTensorInfo(r.shape,"complex64"),o=n.texData.get(i.dataId),s=mQ({inputs:{x:r},backend:n}),l=mQ({inputs:{x:a},backend:n});return o.complexTensorInfos={real:s,imag:l},i}const xQ={kernelName:aN,backendName:"webgl",kernelFunc:bQ},yQ="return (a < 0.) ? b * a : a;",wQ="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";const kQ={kernelName:ZN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{alpha:i}=r,o=n.makeTensorInfo([],"float32",pE(i,"float32")),s=_k().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new gQ(wQ,a.shape,o.shape):new fQ(yQ,a.shape,o.shape),l=n.runWebGLProgram(s,[a,o],"float32");return n.disposeIntermediateTensorInfo(o),l}},NQ="return (a < 0.) ? b * a : a;",SQ="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";const CQ={kernelName:OS,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r,alpha:a}=t,i=_k().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new gQ(SQ,r.shape,a.shape):new fQ(NQ,r.shape,a.shape);return n.runWebGLProgram(i,[r,a],"float32")}},EQ="if (isnan(x)) return x;";function _Q(e){let{opSnippet:t,packedOpSnippet:n,cpuKernelImpl:r,dtype:a}=e;return e=>{let{inputs:i,backend:o}=e;const{x:s}=i,l=o,c=a||s.dtype;if(l.shouldExecuteOnCPU([s])&&null!=r){const e=l.texData.get(s.dataId),t=r(e.values,c);return l.makeTensorInfo(s.shape,c,t)}let u;return u=_k().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=n?new oQ(s.shape,n):new eQ(s.shape,t),l.runWebGLProgram(u,[s],c)}}function IQ(e){let{opSnippet:t,packedOpSnippet:n,checkOutOfBounds:r=!1,supportsComplex:a=!1,cpuKernelImpl:i,dtype:o}=e;return e=>{let{inputs:s,backend:l}=e;const{a:c,b:u}=s,h=l;if(a&&"complex64"===c.dtype){const e=h.texData.get(c.dataId),n=h.texData.get(u.dataId),[r,a]=[[e.complexTensorInfos.real,n.complexTensorInfos.real],[e.complexTensorInfos.imag,n.complexTensorInfos.imag]].map(e=>{const[n,r]=e,a={dataId:n.dataId,dtype:n.dtype,shape:c.shape},i={dataId:r.dataId,dtype:r.dtype,shape:u.shape},o=new fQ(t,c.shape,u.shape);return h.runWebGLProgram(o,[a,i],UE(n.dtype,r.dtype))}),i=bQ({inputs:{real:r,imag:a},backend:h});return h.disposeIntermediateTensorInfo(r),h.disposeIntermediateTensorInfo(a),i}const d=o||UE(c.dtype,u.dtype);if(("string"===c.dtype||"string"===u.dtype||h.shouldExecuteOnCPU([c,u]))&&null!=i){const e=h.texData.get(c.dataId).values,t=h.texData.get(u.dataId).values,n="string"===c.dtype?AF(e):e,r="string"===c.dtype?AF(t):t,[a,o]=i(c.shape,u.shape,n,r,d),s=h.makeTensorInfo(o,d);return h.texData.get(s.dataId).values=a,s}let f;return f=_k().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=n?new gQ(n,c.shape,u.shape,r):new fQ(t,c.shape,u.shape),h.runWebGLProgram(f,[c,u],d)}}function TQ(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("linear"===e)return"return x;";if("relu"===e)return t?"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n":rQ;if("elu"===e)return t?"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n":"return (x >= 0.0) ? x : (exp(x) - 1.0);";if("relu6"===e)return t?"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n":aQ;if("prelu"===e)return t?SQ:NQ;if("leakyrelu"===e)return t?wQ:yQ;if("sigmoid"===e)return"return 1.0 / (1.0 + exp(-1.0 * x));";throw new Error("Activation ".concat(e," has not been implemented for the WebGL backend."))}class AQ{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8&&void 0!==arguments[8]&&arguments[8];this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.enableShapeUniforms=D$(this.outputShape.length);const c=r?e[1]:e[2],u=Math.ceil(c/2),h=r?"i * 2, rc.y":"rc.y, i * 2",d=a?"rc.z, i * 2":"i * 2, rc.z",f=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],p=a?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let g="",m="";o&&(g=s?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(o,"\n        }"):l?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(o,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(o,"\n        }"),m="result = activation(result);");const v=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),l&&this.variableNames.push("leakyreluAlpha");let b="rc.x",x="rc.x";e[0]<t[0]?b="imod(rc.x, ".concat(e[0],")"):t[0]<e[0]&&(x="imod(rc.x, ".concat(t[0],")")),this.userCode="\n      ".concat(g,"\n      // Don't use uniform for sharedDimensionPacked for performance.\n      const float sharedDimension = ").concat(u,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        int batchA = ").concat(b,";\n        int batchB = ").concat(x,";\n        for (int i = 0; i < ").concat(u,"; i++) {\n          vec4 a = getMatrixA(batchA, ").concat(h,");\n          vec4 b = getMatrixB(batchB, ").concat(d,");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(f[0]," * ").concat(p[0],");\n          result += (").concat(f[1]," * ").concat(p[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(v,"\n\n        ").concat(m,"\n\n        setOutput(result);\n      }\n    ")}}const RQ="return areal * breal - aimag * bimag;",DQ="return areal * bimag + aimag * breal;";class FQ{constructor(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=FI(t,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(e,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")}}const OQ="return a * b;";function LQ(e){const{inputs:t,backend:n}=e,{a:r,b:a}=t,i=UE(r.dtype,a.dtype);if("complex64"===r.dtype){const e=n.texData.get(r.dataId),t=n.texData.get(a.dataId),i=new FQ(RQ,r.shape,a.shape),o=new FQ(DQ,r.shape,a.shape),s=[{dataId:e.complexTensorInfos.real.dataId,dtype:e.complexTensorInfos.real.dtype,shape:r.shape},{dataId:e.complexTensorInfos.imag.dataId,dtype:e.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:t.complexTensorInfos.real.dataId,dtype:t.complexTensorInfos.real.dtype,shape:a.shape},{dataId:t.complexTensorInfos.imag.dataId,dtype:t.complexTensorInfos.imag.dtype,shape:a.shape}],l=n.runWebGLProgram(i,s,"float32"),c=n.runWebGLProgram(o,s,"float32"),u=bQ({inputs:{real:l,imag:c},backend:n});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(c),u}if(n.shouldExecuteOnCPU([r,a])){const e=n.texData.get(r.dataId),t=n.texData.get(a.dataId),[o,s]=xJ(r.shape,a.shape,e.values,t.values,i),l=n.makeTensorInfo(s,i);return n.texData.get(l.dataId).values=o,l}let o;return o=_k().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new gQ(OQ,r.shape,a.shape):new fQ(OQ,r.shape,a.shape),n.runWebGLProgram(o,[r,a],i)}const PQ={kernelName:NS,backendName:"webgl",kernelFunc:LQ};function MQ(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{shape:i}=r,o=n,s=$w(a.shape),l=nk(i,s),c=$w(l);Kw(s===c,()=>"The new shape (".concat(l,") has ").concat(c," elements and the old ")+"shape (".concat(a.shape,") has ").concat(s," elements. The new shape and old ")+"shape must have the same number of elements.");const u=o.texData.get(a.dataId);return!u.isPacked||e$(a.shape,l)||null!==u.texture&&e$(u.shape,l)?(o.incRef(a.dataId),{dataId:a.dataId,shape:l,dtype:a.dtype}):function(e,t,n){const r=[$Y(e.shape),...JY(e.shape)],a={dtype:e.dtype,shape:r,dataId:e.dataId},i=[$Y(t),...JY(t)],o=new YJ(i,r),s=[r],l=n.runWebGLProgram(o,[a],e.dtype,s,!0);return{dataId:l.dataId,shape:t,dtype:l.dtype}}(a,l,o)}const jQ={kernelName:VS,backendName:"webgl",kernelFunc:MQ};class BQ{constructor(e,t){this.variableNames=["x"];const{windowSize:n,batchSize:r,inSize:a,outSize:i}=e;this.outputShape=[r,i];const o=4*Math.floor(n/4),s=n%4;let l="sumValue += dot(values, ones);";if(null!=t){const e=1/t;l="sumValue += dot(values * ".concat(Qw(e)?e.toPrecision(2):e,", ones);")}let c="";a%n>0&&(c="\n        if (inIdx < 0 || inIdx >= ".concat(a,") {\n          return 0.0;\n        }\n      ")),this.userCode="\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ".concat(c,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(o,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(l,"\n        }\n\n        int inIdx = inOffset + ").concat(o,";\n        if (").concat(1===s,") {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ").concat(l,"\n        } else if (").concat(2===s,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ").concat(l,"\n        } else if (").concat(3===s,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ").concat(l,"\n        }\n        setOutput(sumValue);\n      }\n    ")}}class zQ{constructor(e,t){this.variableNames=["x"];const{windowSize:n,batchSize:r,inSize:a,outSize:i}=e;this.outputShape=[r,i];let o="0.0",s="";"prod"===t?o="1.0":"min"===t?(o="1.0 / 1e-20",s="min"):"max"===t&&(o="-1.0 / 1e-20",s="max");let l="".concat(t,"(").concat(t,"(").concat(t,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===t?l="sumValue":"prod"===t?l="prodValue":"all"===t?l="allValue":"any"===t&&(l="anyValue");const c=4*Math.floor(n/4),u=n%4;let h="\n      if (".concat("sum"===t,") {\n        sumValue += dot(values, ones);\n      } else if (").concat("prod"===t,") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(s,"(values, minMaxValue);\n        if (").concat("min"===t," || ").concat("max"===t,") {\n          minMaxValue = ").concat(s,"(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    "),d="vec4";"all"===t?(o="1.0",h="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",d="bvec4"):"any"===t&&(o="0.0",h="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",d="bvec4");let f="";a%n>0&&(f="\n        if (inIdx < 0 || inIdx >= ".concat(a,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(o,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(f,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        vec4 minMaxValue = vec4(").concat(o,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(c,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(h,"\n        }\n\n        int inIdx = inOffset + ").concat(c,";\n        if (").concat(1===u,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(h,"\n        } else if (").concat(2===u,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(h,"\n        } else if (").concat(3===u,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(h,"\n        }\n        setOutput(").concat(l,");\n      }\n    ")}}function WQ(e,t,n,r){const a=function(e){const t=[];for(;0===t.length||1!==t[t.length-1].outSize;){const n=t.length?t[t.length-1].outSize:e[1],r=RD(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}(e.shape);let i=e;for(let o=0;o<a.length;o++){const{inSize:s,windowSize:l,outSize:c}=a[o];let u,h;u="mean"===n?0===o?new BQ({windowSize:l,inSize:s,batchSize:e.shape[0],outSize:c},s):new BQ({windowSize:l,inSize:s,batchSize:e.shape[0],outSize:c}):new zQ({windowSize:l,inSize:s,batchSize:e.shape[0],outSize:c},n),h=i,i=r.runWebGLProgram(u,[i],t),h.dataId!==e.dataId&&r.disposeIntermediateTensorInfo(h)}return i}class UQ{constructor(e,t){this.variableNames=["A"];const n=new Array(e.length);for(let i=0;i<n.length;i++)n[i]=e[t[i]];this.outputShape=n,this.rank=n.length;const r=C$(this.rank),a=function(e){const t=e.length;if(t>6)throw Error("Transpose for rank ".concat(t," is not yet supported"));const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t);for(let a=0;a<e.length;a++)r[e[a]]=n[a];return r.join()}(t);this.userCode="\n    void main() {\n      ".concat(r," resRC = getOutputCoords();\n      setOutput(getA(").concat(a,"));\n    }\n    ")}}class VQ{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const n=new Array(e.length);for(let c=0;c<n.length;c++)n[c]=e[t[c]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));const r=C$(this.rank),a=qJ("rc",this.rank),i=new Array(this.rank);for(let c=0;c<t.length;c++)i[t[c]]=a[c];const o="vec2(".concat(i.slice(-2).join(),")"),s="++".concat(a[this.rank-1]," < ").concat(n[this.rank-1]),l="getChannel(getA(".concat(i.join(),"), ").concat(o,")");this.userCode="\n    void main() {\n      ".concat(r," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(l,";\n      if(").concat(s,") {\n        result[1] = ").concat(l,";\n      }\n      --").concat(a[this.rank-1],";\n      if(++").concat(a[this.rank-2]," < ").concat(n[this.rank-2],") {\n        result[2] = ").concat(l,";\n        if(").concat(s,") {\n          result[3] = ").concat(l,";\n        }\n      }\n      setOutput(result);\n    }\n    ")}}function HQ(e,t,n){const r=_k().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new VQ(e.shape,t):new UQ(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}function GQ(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:o}=r;return function(e,t,n,r){const a=t,i=e.shape.length,o=rk(a,e.shape);let s=o;const l=kA(s,i),c=null!=l;let u=e;c&&(u=HQ(e,l,r),s=SA(s.length,i)),wA("sum",s,i);const[h,d]=xA(u.shape,s);let f=h;n&&(f=yA(h,o));const p=$w(d),g=MQ({inputs:{x:u},attrs:{shape:[$w(e.shape)/p,p]},backend:r}),m=WQ(g,VE(e.dtype),"sum",r),v=MQ({inputs:{x:m},attrs:{shape:f},backend:r});return r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(m),c&&r.disposeIntermediateTensorInfo(u),v}(a,i,o,n)}const qQ={kernelName:uC,backendName:"webgl",kernelFunc:GQ};function KQ(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{perm:i}=r,o=n,s=a.shape.length,l=new Array(s);for(let u=0;u<l.length;u++)l[u]=a.shape[i[u]];let c;if(o.shouldExecuteOnCPU([a])){const e=o.texData.get(a.dataId).values,t=HJ(e,a.shape,a.dtype,i,l);c=o.makeTensorInfo(l,a.dtype);o.texData.get(c.dataId).values=t}else c=HQ(a,i,o);return c}const XQ={kernelName:DC,backendName:"webgl",kernelFunc:KQ};function YQ(e){let{a:t,b:n,transposeA:r,transposeB:a,backend:i,bias:o=null,preluActivationWeights:s=null,leakyreluAlpha:l=0,activation:c=null}=e;const u=t.shape.length,h=n.shape.length,d=r?t.shape[u-2]:t.shape[u-1],f=a?n.shape[h-1]:n.shape[h-2],p=r?t.shape[u-1]:t.shape[u-2],g=a?n.shape[h-2]:n.shape[h-1],m=t.shape.slice(0,-2),v=n.shape.slice(0,-2),b=$w(m),x=$w(v),y=FI(t.shape.slice(0,-2),n.shape.slice(0,-2)).concat([p,g]);Kw(d===f,()=>"Error in matMul: inner shapes (".concat(d,") and (")+"".concat(f,") of Tensors with shapes ").concat(t.shape," and ")+"".concat(n.shape," and transposeA=").concat(r)+" and transposeB=".concat(a," must match."));const w=r?[b,d,p]:[b,p,d],k=a?[x,g,f]:[x,f,g],N=MQ({inputs:{x:t},backend:i,attrs:{shape:w}}),S=MQ({inputs:{x:n},backend:i,attrs:{shape:k}}),C=[N,S],E=Math.max(b,x),_=r?N.shape[1]:N.shape[2],I=null!=o,T=null!=s,A="leakyrelu"===c,R=null!=c?TQ(c,!0):null;let D;if((1===p||1===g)&&_>1e3&&!1===(I||T||A||null!=R)){let e=N,t=S;r&&(e=KQ({inputs:{x:N},backend:i,attrs:{perm:[0,2,1]}}),C.push(e)),a&&(t=KQ({inputs:{x:S},backend:i,attrs:{perm:[0,2,1]}}),C.push(t));const n=1===g;let o=e;1!==g&&(o=MQ({inputs:{x:e},backend:i,attrs:{shape:[E,_,1]}}),C.push(o));const s=1===g?2:1;let l=t;n&&(l=MQ({inputs:{x:t},backend:i,attrs:{shape:[E,1,_]}}),C.push(l));const c=LQ({inputs:{a:o,b:l},backend:i});D=GQ({inputs:{x:c},backend:i,attrs:{axis:s,keepDims:!0}}),C.push(c)}else{const e=UE(t.dtype,n.dtype),c=new AQ(w,k,[E,p,g],r,a,I,R,T,A),u=[N,S];if(null!=o&&u.push(o),T&&u.push(s),A){const e=i.makeTensorInfo([],"float32",pE(l,"float32"));u.push(e),C.push(e)}D=i.runWebGLProgram(c,u,e)}const F=MQ({inputs:{x:D},backend:i,attrs:{shape:y}});C.push(D);for(const O of C)i.disposeIntermediateTensorInfo(O);return F}const $Q={kernelName:zC,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{a:a,b:i,bias:o,preluActivationWeights:s}=t,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:h}=r;return YQ({a:a,b:i,transposeA:l,transposeB:c,backend:n,bias:o,preluActivationWeights:s,leakyreluAlpha:h,activation:u})}},JQ="return abs(x);";const QQ={kernelName:Dk,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])&&"complex64"!==r.dtype){const e=n.texData.get(r.dataId),t=AJ(e.values);return n.makeTensorInfo(r.shape,r.dtype,t)}let a;return a=_k().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new oQ(r.shape,JQ):new eQ(r.shape,JQ),n.runWebGLProgram(a,[r],r.dtype)}},ZQ=_Q({opSnippet:tQ+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),eZ={kernelName:Fk,backendName:"webgl",kernelFunc:ZQ},tZ=_Q({opSnippet:tQ+"\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),nZ={kernelName:Ok,backendName:"webgl",kernelFunc:tZ},rZ="return a + b;",aZ=IQ({opSnippet:rZ,packedOpSnippet:rZ,supportsComplex:!0,cpuKernelImpl:J$}),iZ={kernelName:Lk,backendName:"webgl",kernelFunc:aZ};class oZ{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((e,t)=>"T".concat(t));const n=[];this.variableNames.forEach(e=>{n.push("float v".concat(e," = get").concat(e,"AtOutCoords();"))});const r=this.variableNames.map(e=>"v".concat(e)).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        float result = ").concat(r,";\n        setOutput(result);\n      }\n    ")}}class sZ{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((e,t)=>"T".concat(t));const n=[];this.variableNames.forEach(e=>{n.push("vec4 v".concat(e," = get").concat(e,"AtOutCoords();"))});const r=this.variableNames.map(e=>"v".concat(e)).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        vec4 result = ").concat(r,";\n        setOutput(result);\n      }\n    ")}}const lZ={kernelName:Pk,backendName:"webgl",kernelFunc:function e(t){const{inputs:n,backend:r}=t,a=n;if(1===a.length)return mQ({inputs:{x:a[0]},backend:r});if(a.length>_k().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const t=Math.floor(a.length/2),n=e({inputs:a.slice(0,t),backend:r}),i=e({inputs:a.slice(t),backend:r});return e({inputs:[n,i],backend:r})}const i=a.map(e=>e.dtype).reduce((e,t)=>UE(e,t)),o=a.map(e=>e.shape),s=_k().getBool("WEBGL_PACK")?new sZ(a[0].shape,o):new oZ(a[0].shape,o);return r.runWebGLProgram(s,a,i)}};const cZ={kernelName:Mk,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:o}=r,s=a.shape.length,l=rk(i,a.shape);let c=l;const u=kA(c,s);let h=a;null!=u&&(h=KQ({inputs:{x:a},backend:n,attrs:{perm:u}}),c=SA(c.length,s)),wA("all",c,s);const[d,f]=xA(h.shape,c),p=MQ({inputs:{x:h},backend:n,attrs:{shape:[-1,$w(f)]}}),g=WQ(p,p.dtype,"all",n);let m;if(o){m=MQ({inputs:{x:g},backend:n,attrs:{shape:yA(d,l)}})}else m=MQ({inputs:{x:g},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),null!=u&&n.disposeIntermediateTensorInfo(h),m}};const uZ={kernelName:jk,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:o}=r,s=a.shape.length,l=rk(i,a.shape);let c=l;const u=kA(c,s);let h=a;null!=u&&(h=KQ({inputs:{x:a},backend:n,attrs:{perm:u}}),c=SA(c.length,s)),wA("any",c,s);const[d,f]=xA(h.shape,c),p=MQ({inputs:{x:h},backend:n,attrs:{shape:[-1,$w(f)]}}),g=WQ(p,p.dtype,"any",n);let m;if(o){m=MQ({inputs:{x:g},backend:n,attrs:{shape:yA(d,l)}})}else m=MQ({inputs:{x:g},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),null!=u&&n.disposeIntermediateTensorInfo(h),m}};class hZ{constructor(e,t,n){this.variableNames=["A"];const{windowSize:r,batchSize:a,outSize:i}=e;n||this.variableNames.push("bestIndicesA"),this.outputShape=[a,i];const o="max"===t?">":"<",s=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(r,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(r,"; i++) {\n          int inIdx = ").concat(s,";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat(o," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")}}class dZ{constructor(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,Kw(e.length>2,()=>"Packed arg".concat(n.charAt(0).toUpperCase()+n.slice(1)," supports only inputs with rank above 2."));const a=e[e.length-1],i=Math.ceil(a/t);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");const o=this.outputShape,s=o.length,l=C$(s),c=KJ("coords",s);let u,h;if(1===i){h=s+1;const e=C$(h);u="\n        ".concat(e," sourceLocR = ").concat(e,"(").concat(c.join(),", 0);\n        ++").concat(c[s-1],";\n        ").concat(e," sourceLocG = ").concat(e,"(").concat(c.join(),", 0);\n        ++").concat(c[s-2],";\n        ").concat(e," sourceLocA = ").concat(e,"(").concat(c.join(),", 0);\n        --").concat(c[s-1],";\n        ").concat(e," sourceLocB = ").concat(e,"(").concat(c.join(),", 0);\n        --").concat(c[s-2],";")}else h=s,u="\n        ".concat(l," sourceLocR = coords;\n        ++").concat(c[s-1],";\n        ").concat(l," sourceLocG = coords;\n        ++").concat(c[s-2],";\n        ").concat(l," sourceLocA = coords;\n        --").concat(c[s-1],";\n        ").concat(l," sourceLocB = coords;\n        --").concat(c[s-2],";");const d=["x","y","z","w","u","v"].slice(0,h),f="."+d[h-1],p=d.map(e=>"int "+e),g=KJ("sourceLocR",h-1).concat("inIdx.r"),m=KJ("sourceLocG",h-1).concat("inIdx.g"),v=KJ("sourceLocB",h-1).concat("inIdx.b"),b=KJ("sourceLocA",h-1).concat("inIdx.a"),x="max"===n?"greaterThan":"lessThan",y=r?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(g.join(),"),\n                             getBestIndicesAChannel(").concat(m.join(),"),\n                             getBestIndicesAChannel(").concat(v.join(),"),\n                             getBestIndicesAChannel(").concat(b.join(),")));"),w="vec4(\n            getAChannel(".concat(g.join(),"),\n            hasNextCol ? getAChannel(").concat(m.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(v.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(b.join(),") : 0.)"),k=r?"":"\n      float getBestIndicesAChannel(".concat(p.join(),") {\n        return getChannel(getBestIndicesA(").concat(d.join(),"),\n                                          vec2(").concat(d.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(p.join(),") {\n        return getChannel(getA(").concat(d.join(),"),\n                               vec2(").concat(d.slice(-2).join(),"));\n      }\n      ").concat(k,"\n      void main() {\n        ").concat(l," coords = getOutputCoords();\n        bool hasNextCol = ").concat(c[s-1]," < ").concat(o[s-1]-1,";\n        bool hasNextRow = ").concat(c[s-2]," < ").concat(o[s-2]-1,";\n        ").concat(u,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(f,", sourceLocG").concat(f,",\n          sourceLocB").concat(f,", sourceLocA").concat(f,") * ").concat(t,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(w,";\n\n        for (int i = 0; i < ").concat(t,"; i++) {\n          inIdx = srcIdx;\n          ").concat(y,"\n          vec4 candidate = ").concat(w,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(x,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")}}function fZ(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=t.shape[0],i=t.shape[1];null!=r&&(a=r.shape[0],i=r.shape[1]);const o=RD(i),s={windowSize:o,inSize:i,batchSize:a,outSize:Math.ceil(i/o)},l=new hZ(s,n,null==r),c=[t];null!=r&&c.push(r);const u=e.runWebGLProgram(l,c,"int32");if(1===u.shape[1])return u;const h=fZ(e,t,n,u);return e.disposeIntermediateTensorInfo(u),h}function pZ(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const a=null!=r?r.shape:t.shape,i=RD(a[a.length-1]),o=new dZ(a,i,n,null==r),s=null==r?[t]:[t,r],l=e.runWebGLProgram(o,s,"int32");if(l.shape.length===t.shape.length){const r=pZ(e,t,n,l);return e.disposeIntermediateTensorInfo(l),r}return l}function gZ(e,t,n,r){const a=[n];if(wA("arg"+r.charAt(0).toUpperCase()+r.slice(1),a,t.shape.length),!_k().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){const n=[],i=e.texData.get(t.dataId);let o=t;null!==i&&i.isPacked&&(o=e.unpackTensor(t),n.push(o));const[s,l]=xA(o.shape,a),c=$w(l),u=MQ({inputs:{x:o},backend:e,attrs:{shape:[-1,c]}});n.push(u);const h=fZ(e,u,r);n.push(h);const d=MQ({inputs:{x:h},backend:e,attrs:{shape:s}});return n.forEach(t=>e.disposeIntermediateTensorInfo(t)),d}return pZ(e,t,r)}const mZ={kernelName:Bk,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i}=r;let o=rk(i,a.shape);const s=kA(o,a.shape.length);let l=a;const c=[];null!=s&&(l=KQ({inputs:{x:a},backend:n,attrs:{perm:s}}),c.push(l),o=SA(o.length,l.shape.length)),wA("argMax",[o[0]],l.shape.length);const u=gZ(n,l,o[0],"max");return c.forEach(e=>n.disposeIntermediateTensorInfo(e)),u}};const vZ={kernelName:zk,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i}=r;let o=rk(i,a.shape);const s=kA(o,a.shape.length);let l=a;const c=[];null!=s&&(l=KQ({inputs:{x:a},backend:n,attrs:{perm:s}}),c.push(l),o=SA(o.length,l.shape.length)),wA("argMin",[o[0]],l.shape.length);const u=gZ(n,l,o[0],"min");return c.forEach(e=>n.disposeIntermediateTensorInfo(e)),u}},bZ=_Q({opSnippet:tQ+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),xZ={kernelName:Wk,backendName:"webgl",kernelFunc:bZ},yZ=_Q({opSnippet:tQ+"return log(x + sqrt(x * x + 1.0));"}),wZ={kernelName:Uk,backendName:"webgl",kernelFunc:yZ},kZ=_Q({opSnippet:tQ+"\n  return atan(x);\n"}),NZ={kernelName:Vk,backendName:"webgl",kernelFunc:kZ},SZ=IQ({opSnippet:dQ+"\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+pQ+"\n  return result;\n"}),CZ={kernelName:Gk,backendName:"webgl",kernelFunc:SZ},EZ=_Q({opSnippet:tQ+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),_Z={kernelName:Hk,backendName:"webgl",kernelFunc:EZ};class IZ{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,o=e.strideHeight,s=e.strideWidth,l=e.dilationHeight,c=e.dilationWidth,u=e.effectiveFilterHeight,h=e.effectiveFilterWidth,d=e.padInfo.top,f=e.padInfo.left;this.outputShape=e.outShape;const p="avg"===t,g="((batch  * ".concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + d"),m="(xR * ".concat(e.inWidth," + xC) * ").concat(e.inChannels," + d");let v="0.0";if(p||(v="-1.0 / 1e-20"),n){const t=">=";return void(this.userCode="\n        const ivec2 strides = ivec2(".concat(o,", ").concat(s,");\n        const ivec2 pads = ivec2(").concat(d,", ").concat(f,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(u,";\n              wR += ").concat(l,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(h,";\n                wC += ").concat(c,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ").concat(t," currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(r?a?g:m:"wR * ".concat(h," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      "))}let b="".concat(t,"(").concat(t,"(").concat(t,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(b="avgValue / max(count, 1.0)");const x=4*Math.floor(i/4),y=i%4,w="\n      if (".concat(p,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(o,", ").concat(s,");\n      const ivec2 pads = ivec2(").concat(d,", ").concat(f,");\n      const float initializationValue = ").concat(v,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(e.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(v,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(u,";\n            wR += ").concat(l,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(e.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(x,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(c,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(c,", d),\n              getValue(batch, xR, xC + 2 * ").concat(c,", d),\n              getValue(batch, xR, xC + 3 * ").concat(c,", d)\n            );\n\n            ").concat(w,"\n          }\n\n          int xC = xCCorner + ").concat(x,";\n          if (").concat(1===y,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(w,"\n          } else if (").concat(2===y,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(c,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(w,"\n          } else if (").concat(3===y,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(c,", d),\n              getValue(batch, xR, xC + 2 * ").concat(c,", d),\n              initializationValue\n            );\n\n            ").concat(w,"\n          }\n        }\n        setOutput(").concat(b,");\n      }\n    ")}}class TZ{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,o=e.strideDepth,s=e.strideHeight,l=e.strideWidth,c=e.dilationDepth,u=e.dilationHeight,h=e.dilationWidth,d=e.effectiveFilterDepth,f=e.effectiveFilterHeight,p=e.effectiveFilterWidth,g=e.padInfo.front,m=e.padInfo.top,v=e.padInfo.left;this.outputShape=e.outShape;const b="avg"===t;let x="0.0";if(b||(x="-1.0 / 1e-20"),n){const t=">=";return void(this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(o,", ").concat(s,", ").concat(l,");\n        const ivec3 pads = ivec3(").concat(g,", ").concat(m,", ").concat(v,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(d,";\n              wD += ").concat(c,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(e.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(f,";\n                wR += ").concat(u,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(e.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(p,";\n                  wC += ").concat(h,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ").concat(t," currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(r?a?"(((batch * ".concat(e.inDepth," + xD) * ").concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + ch"):"((xD * ".concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + ch"):"wD * ".concat(f," * ").concat(p," +\n                      wR * ").concat(p," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      "))}let y="".concat(t,"(").concat(t,"(").concat(t,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(y="avgValue / max(count, 1.0)");const w=4*Math.floor(i/4),k=i%4,N="\n      if (".concat(b,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(o,", ").concat(s,", ").concat(l,");\n      const ivec3 pads = ivec3(").concat(g,", ").concat(m,", ").concat(v,");\n      const float initializationValue = ").concat(x,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(e.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(x,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(d,";\n            wD += ").concat(c,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(e.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(f,";\n            wR += ").concat(u,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(w,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(h,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(h,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(h,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(h,", ch)\n              );\n\n              ").concat(N,"\n            }\n\n            int xC = xCCorner + ").concat(w,";\n            if (").concat(1===k,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(N,"\n            } else if (").concat(2===k,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(h,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(N,"\n            } else if (").concat(3===k,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(h,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(h,", ch),\n                initializationValue\n              );\n\n              ").concat(N,"\n            }\n          }\n        }\n        setOutput(").concat(y,");\n      }\n    ")}}const AZ={kernelName:qk,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t;s$(a,"avgPool");const{filterSize:i,strides:o,pad:s,dimRoundingMode:l}=r;Kw(_T(o,1),()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'"));const c=vT(a.shape,i,o,1,s,l);if(1===c.filterWidth&&1===c.filterHeight&&Jw(c.inShape,c.outShape))return mQ({inputs:{x:a},backend:n});const u=new IZ(c,"avg",!1);return n.runWebGLProgram(u,[a],"float32")}};const RZ={kernelName:Xk,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:i,strides:o,pad:s,dimRoundingMode:l,dataFormat:c}=r,u=bT(a.shape,i,o,[1,1,1],s,l,c),h=new TZ(u,"avg",!1);return n.runWebGLProgram(h,[a],"float32")}};class DZ{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i=e.dilationHeight,o=e.dilationWidth,s=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=s-1-e.padInfo.top,u=l-1-e.padInfo.left,h=1/(t*n);this.userCode="\n      const ivec2 pads = ivec2(".concat(c,", ").concat(u,");\n      const float avgMultiplier = float(").concat(h,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(s,";\n            wR += ").concat(i,") {\n          float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(l,";\n            wC+= ").concat(o,") {\n            float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class FZ{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,a=e.strideDepth,i=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,l=e.dilationHeight,c=e.dilationWidth,u=e.effectiveFilterDepth,h=e.effectiveFilterHeight,d=e.effectiveFilterWidth,f=u-1-e.padInfo.front,p=h-1-e.padInfo.top,g=d-1-e.padInfo.left,m=1/(t*n*r);this.userCode="\n      const ivec3 pads = ivec3(".concat(f,", ").concat(p,", ").concat(g,");\n      const float avgMultiplier = float(").concat(m,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(u,";\n            wD += ").concat(s,") {\n          float dyD = float(dyDCorner + wD) / ").concat(a,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(e.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(h,";\n              wR += ").concat(l,") {\n            float dyR = float(dyRCorner + wR) / ").concat(i,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(d,";\n                wC += ").concat(c,") {\n              float dyC = float(dyCCorner + wC) / ").concat(o,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const OZ={kernelName:Yk,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,o=i,{filterSize:s,strides:l,pad:c,dimRoundingMode:u}=r,h=bT(o.shape,s,l,[1,1,1],c,u),d=new FZ(h);return n.runWebGLProgram(d,[a],o.dtype)}};const LZ={kernelName:Kk,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,o=i;s$([a,i],"avgPoolGrad");const{filterSize:s,strides:l,pad:c}=r,u=vT(o.shape,s,l,1,c),h=new DZ(u);return n.runWebGLProgram(h,[a],o.dtype)}};const PZ={kernelName:$k,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{a:a,b:i}=t,{transposeA:o,transposeB:s}=r;return YQ({a:a,b:i,transposeA:o,transposeB:s,backend:n})}};class MZ{constructor(e,t,n,r,a,i){this.outputShape=[],this.variableNames=["x","mean","variance"],FI(e,t),FI(e,n);let o="0.0";null!=r&&(FI(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let s="1.0";null!=a&&(FI(e,a),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(o,";\n        float scale = ").concat(s,";\n        float inv = scale * inversesqrt(variance + float(").concat(i,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")}}class jZ{constructor(e,t,n,r,a,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],FI(e,t),FI(e,n);let o="vec4(0.0)";null!=r&&(FI(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let s="vec4(1.0)";null!=a&&(FI(e,a),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        vec4 offset = ".concat(o,";\n        vec4 scale = ").concat(s,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(i,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")}}const BZ={kernelName:UN,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e;const{x:a,mean:i,variance:o,offset:s,scale:l}=t;Kw(i.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),Kw(null==s||i.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),Kw(null==l||i.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:c}=r;null==c&&(c=.001);const u=[a,i,o];let h=null;null!=s&&(h=s.shape,u.push(s));let d=null;null!=l&&(d=l.shape,u.push(l));const f=_k().getBool("WEBGL_PACK_NORMALIZATION")?new jZ(a.shape,i.shape,o.shape,h,d,c):new MZ(a.shape,i.shape,o.shape,h,d,c);return n.runWebGLProgram(f,u,u[0].dtype)}};class zZ{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const t=C$(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=function(e){if(1===e)return"sourceLoc";if(e<=6)return WZ.slice(0,e).map(e=>"sourceLoc."+e).join(",");throw Error("Slicing for rank ".concat(e," is not yet supported"))}(this.rank);let r;const a=e.map((e,t)=>"sourceLoc.".concat(WZ[t]," = start[").concat(t,"] + coords.").concat(WZ[t],";"));r="\n        ".concat(t," sourceLoc;\n        ").concat(t," coords = getOutputCoords();\n        ").concat(a.join("\n"),"\n      "),this.userCode="\n      void main() {\n        ".concat(r,"\n        setOutput(getSource(").concat(n,"));\n      }\n    ")}}const WZ=["x","y","z","w","u","v"];class UZ{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const t=C$(this.rank),n=KJ("coords",this.rank),r=KJ("sourceLoc",this.rank),a=1===this.rank?"sourceLoc":"vec2(".concat(r.slice(-2).join(),")"),i="getChannel(getSource(".concat(r.join(),"), ").concat(a,")"),o="\n      result.x = ".concat(i,";\n      if (++").concat(n[this.rank-1]," < ").concat(e[this.rank-1],") {\n        ++").concat(r[this.rank-1],";\n        result.y = ").concat(i,";\n        --").concat(r[this.rank-1],";\n      }\n    "),s=1===this.rank?"":"\n      --".concat(n[this.rank-1],";\n      if (++").concat(n[this.rank-2]," < ").concat(e[this.rank-2],") {\n        ++").concat(r[this.rank-2],";\n        result.z = ").concat(i,";\n        if (++").concat(n[this.rank-1]," < ").concat(e[this.rank-1],") {\n          ++").concat(r[this.rank-1],";\n          result.w = ").concat(i,";\n        }\n      }\n    "),l=this.rank<=4?"sourceLoc = coords +\n            ".concat(t,"(").concat(e.map((e,t)=>"start[".concat(t,"]")).join(),");"):e.map((e,t)=>"".concat(r[t]," = ").concat(n[t]," + start[").concat(t,"];")).join("\n");this.userCode="\n      void main() {\n        ".concat(t," coords = getOutputCoords();\n        ").concat(t," sourceLoc;\n        ").concat(l,"\n        vec4 result = vec4(0.);\n        ").concat(o,"\n        ").concat(s,"\n        setOutput(result);\n      }\n    ")}}function VZ(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{begin:i,size:o}=r,[s,l]=uT(a,i,o);if($I(a,s,l),0===$w(l))return n.makeTensorInfo(l,a.dtype,[]);if(n.shouldExecuteOnCPU([a])||"string"===a.dtype){const e=n.texData.get(a.dataId),t=RJ(e.values,s,l,a.shape,a.dtype);return n.makeTensorInfo(l,a.dtype,t)}const{isPacked:c}=n.texData.get(a.dataId),u=lT(a.shape,s,l);if(c||!u){const e=_k().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new UZ(l):new zZ(l),t=[s];return n.runWebGLProgram(e,[a],a.dtype,t)}return n.uploadToGPU(a.dataId),function(e,t,n,r){const a=r.texData.get(e.dataId),i=r.makeTensorInfo(n,e.dtype),o=r.texData.get(i.dataId);Object.assign(o,a),o.refCount=1,o.shape=n,o.dtype=e.dtype;let s=cT(t,pk(e.shape));a.slice&&(s+=a.slice.flatOffset),o.slice={flatOffset:s,origDataId:a.slice&&a.slice.origDataId||e.dataId};const l=r.dataRefCount.get(o.slice.origDataId)||1;return r.dataRefCount.set(o.slice.origDataId,l+1),i}(a,s,l,n)}const HZ={kernelName:rC,backendName:"webgl",kernelFunc:VZ},GZ={kernelName:Jk,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:i,crops:o}=r;Kw(a.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const s=i.reduce((e,t)=>e*t),l=FD(a.shape,i,s),c=OD(l.length,i.length),u=LD(a.shape,i,s),h=PD(o,i.length),d=MD(u,o,i.length),f=[],p=MQ({inputs:{x:a},backend:n,attrs:{shape:l}}),g=KQ({inputs:{x:p},backend:n,attrs:{perm:c}}),m=MQ({inputs:{x:g},backend:n,attrs:{shape:u}}),v=VZ({inputs:{x:m},backend:n,attrs:{begin:h,size:d}});return f.push(p),f.push(g),f.push(m),f.forEach(e=>n.disposeIntermediateTensorInfo(e)),v}};const qZ={kernelName:Qk,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,weights:i}=t,{size:o}=r,s=n.readSync(a.dataId),l=n.readSync(i.dataId),c=Q$(s,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}};const KZ={kernelName:Zk,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{a:r,b:a}=t,i=_k().getBool("WEBGL_PACK_BINARY_OPERATIONS"),o=_k().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([r,a])||1===o){const e=n.texData.get(r.dataId).values,t=n.texData.get(a.dataId).values,[i,o]=eJ(r.shape,a.shape,e,t,r.dtype),s=n.makeTensorInfo(o,r.dtype);return n.texData.get(s.dataId).values=i,s}let s;return s=i?new gQ("\n  int r = int(a.r) & int(b.r);\n  int g = int(a.g) & int(b.g);\n  int rb = int(a.b) & int(b.b);\n  int ra = int(a.a) & int(b.a);\n  return vec4(r, g, rb, ra);\n",r.shape,a.shape,!1):new fQ("\n  return float(int(a.r) & int(b.r));\n",r.shape,a.shape),n.runWebGLProgram(s,[r,a],r.dtype)}};const XZ={kernelName:eN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{s0:r,s1:a}=t,i=n.readSync(r.dataId),o=n.readSync(a.dataId),s=FI(Array.from(i),Array.from(o));return n.makeTensorInfo([s.length],"int32",Int32Array.from(s))}},YZ=IQ({opSnippet:"return float(a != b);",cpuKernelImpl:wJ,dtype:"bool"}),$Z={kernelName:CS,backendName:"webgl",kernelFunc:YZ};function JZ(e){const{inputs:t,backend:n}=e,{input:r}=t;return mQ({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.real},backend:n})}const QZ={kernelName:zS,backendName:"webgl",kernelFunc:JZ};const ZZ={kernelName:tN,backendName:"webgl",kernelFunc:function e(t){const{inputs:n,backend:r,attrs:a}=t,{x:i}=n,{dtype:o}=a;if("complex64"===o){if("complex64"===i.dtype)return mQ({inputs:{x:i},backend:r});const t=MA(i.shape),n=e({inputs:{x:i},backend:r,attrs:{dtype:"float32"}}),a=bQ({inputs:{real:n,imag:t},backend:r});return t.dispose(),r.disposeIntermediateTensorInfo(n),a}if("complex64"===i.dtype){const t=JZ({inputs:{input:i},backend:r}),n=e({inputs:{x:t},backend:r,attrs:{dtype:o}});return r.disposeIntermediateTensorInfo(t),n}if(!sk(i.dtype,o)){const e=mQ({inputs:{x:i},backend:r});return{dataId:e.dataId,shape:e.shape,dtype:o}}if(r.shouldExecuteOnCPU([i])){const e=r.texData.get(i.dataId).values,[t,n,a]=tJ(e,i.shape,i.dtype,o);return r.makeTensorInfo(t,n,a)}if("int32"===o)return function(e,t){const n=new eQ(e.shape,"return float(int(x));"),r=t.runWebGLProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}(i,r);if("bool"===o){const e=r.makeTensorInfo([],"bool",ik("bool",1)),t=YZ({inputs:{a:i,b:e},backend:r});return r.disposeIntermediateTensorInfo(e),t}throw new Error("Error in Cast: failed to cast ".concat(i.dtype," to ").concat(o))}},e0="return ceil(x);",t0=_Q({opSnippet:e0,packedOpSnippet:e0,cpuKernelImpl:nJ}),n0={kernelName:nN,backendName:"webgl",kernelFunc:t0};class r0{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}}class a0{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}}const i0={kernelName:rN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{clipValueMin:i,clipValueMax:o}=r;let s;s=_k().getBool("WEBGL_PACK_CLIP")?new a0(a.shape):new r0(a.shape);const l=[[i],[o]];return n.runWebGLProgram(s,[a],a.dtype,l)}};class o0{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}}function s0(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}const l0={kernelName:iN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t,a=n.texData.get(r.dataId),i=new o0(r.shape),o=[s0(r,a.complexTensorInfos.real),s0(r,a.complexTensorInfos.imag)];return n.runWebGLProgram(i,o,o[0].dtype)}};class c0{constructor(e){this.outputShape=[],this.outputShape=SD(e,1),this.variableNames=e.map((e,t)=>"T".concat(t));const t=new Array(e.length-1);t[0]=e[0][1];for(let i=1;i<t.length;i++)t[i]=t[i-1]+e[i][1];const n=["if (yC < ".concat(t[0],") setOutput(getT0(yR, yC));")];for(let i=1;i<t.length;i++){const e=t[i-1];n.push("else if (yC < ".concat(t[i],") ")+"setOutput(getT".concat(i,"(yR, yC-").concat(e,"));"))}const r=t.length,a=t[t.length-1];n.push("else setOutput(getT".concat(r,"(yR, yC-").concat(a,"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(n.join("\n        "),"\n      }\n    ")}}class u0{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=SD(e,t);const n=this.outputShape,r=n.length,a=C$(r),i=KJ("coords",r),o=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((e,t)=>"T".concat(t));const s=new Array(e.length-1);s[0]=e[0][t];for(let p=1;p<s.length;p++)s[p]=s[p-1]+e[p][t];const l=o[t],c=o.slice(-2),u=o.join();let h="if (".concat(l," < ").concat(s[0],") {\n        return getChannel(\n            getT0(").concat(u,"), vec2(").concat(c.join(),"));\n        }");for(let p=1;p<s.length;p++){const e=s[p-1];h+="\n        if (".concat(l," < ").concat(s[p],"  && ").concat(l," >= ").concat(s[p-1],") {\n          return getChannel(\n            getT").concat(p,"(").concat(h0(o,l,e),"),\n            vec2(").concat(h0(c,l,e),"));\n        }")}const d=s.length,f=s[s.length-1];h+="\n        return getChannel(\n          getT".concat(d,"(").concat(h0(o,l,f),"),\n          vec2(").concat(h0(c,l,f),"));"),this.userCode="\n      float getValue(".concat(o.map(e=>"int "+e),") {\n        ").concat(h,"\n      }\n\n      void main() {\n        ").concat(a," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(i,"), 0., 0., 0.);\n\n        ").concat(i[r-1]," = ").concat(i[r-1]," + 1;\n        if (").concat(i[r-1]," < ").concat(n[r-1],") {\n          result.g = getValue(").concat(i,");\n        }\n\n        ").concat(i[r-2]," = ").concat(i[r-2]," + 1;\n        if (").concat(i[r-2]," < ").concat(n[r-2],") {\n          result.a = getValue(").concat(i,");\n        }\n\n        ").concat(i[r-1]," = ").concat(i[r-1]," - 1;\n        if (").concat(i[r-2]," < ").concat(n[r-2]," &&\n            ").concat(i[r-1]," < ").concat(n[r-1],") {\n          result.b = getValue(").concat(i,");\n        }\n        setOutput(result);\n      }\n    ")}}function h0(e,t,n){const r=e.indexOf(t),a=e.map((e,t)=>t===r?"".concat(e," - ").concat(n):e);return a.join()}function d0(e){const{inputs:t,backend:n}=e,{input:r}=t;return mQ({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.imag},backend:n})}const f0={kernelName:YN,backendName:"webgl",kernelFunc:d0};function p0(e,t,n){const r=e[0].dtype;if("complex64"===r){const r=e.map(e=>JZ({inputs:{input:e},backend:n})),a=e.map(e=>d0({inputs:{input:e},backend:n})),i=p0(r,t,n),o=p0(a,t,n),s=bQ({inputs:{real:i,imag:o},backend:n});return r.forEach(e=>n.disposeIntermediateTensorInfo(e)),a.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),s}let a=n.shouldExecuteOnCPU(e);if("string"===r&&(a=!0),a){const a=e.map(e=>{const r=$w(e.shape.slice(t));return MQ({inputs:{x:e},backend:n,attrs:{shape:[-1,r]}})}),i=a.map(e=>({vals:n.readSync(e.dataId),shape:e.shape})),o=SD(a.map(e=>e.shape),1),s=1===a[0].shape[0],l=rJ(i,o,r,s),c=SD(e.map(e=>e.shape),t),u=n.makeTensorInfo(c,r,l);return a.forEach(e=>n.disposeIntermediateTensorInfo(e)),u}const i=e.filter(e=>$w(e.shape)>0),o=_k().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&i[0].shape.length>1;if(1===i.length){const t=o?new eQ(e[0].shape,iQ):new oQ(e[0].shape,iQ);return n.runWebGLProgram(t,e,r)}const s=_k().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(i.length>s){const e=[];for(let a=0;a<i.length;a+=s){const r=i.slice(a,a+s);e.push(p0(r,t,n))}const r=p0(e,t,n);for(const t of e)n.disposeIntermediateTensorInfo(t);return r}if(o){const e=new u0(i.map(e=>e.shape),t);return n.runWebGLProgram(e,i,r)}const{tensors2D:l,outShape:c}=function(e,t,n){const r=SD(e.map(e=>e.shape),t),a=e.map(e=>MQ({inputs:{x:e},attrs:{shape:[-1,$w(e.shape.slice(t))]},backend:n}));return{tensors2D:a,outShape:r}}(i,t,n),u=new c0(l.map(e=>e.shape)),h=n.runWebGLProgram(u,l,r);l.forEach(e=>n.disposeIntermediateTensorInfo(e));const d=MQ({inputs:{x:h},attrs:{shape:c},backend:n});return n.disposeIntermediateTensorInfo(h),d}function g0(e){const{inputs:t,backend:n,attrs:r}=e,{axis:a}=r,i=rk(a,t[0].shape)[0],o=t.map(e=>e.shape);ND(o,i);const s=SD(t.map(e=>e.shape),i);if(0===$w(s))return n.makeTensorInfo(s,t[0].dtype,[]);const l=t.filter(e=>$w(e.shape)>0);return 1===l.length?mQ({inputs:{x:l[0]},backend:n}):p0(l,i,n)}const m0={kernelName:oN,backendName:"webgl",kernelFunc:g0};class v0{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.outputShape=e.outShape;const i=e.padInfo.top,o=e.padInfo.left,s=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,u=e.dilationWidth,h=e.filterHeight,d=e.filterWidth,f=4*Math.floor(e.inChannels/4),p=e.inChannels%4,g="channelsLast"===e.dataFormat,m=g?1:2,v=g?2:3,b=g?3:1;let x="",y="";n&&(x=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):a?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),y="result = activation(result);");const w=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(x,"\n\n      const ivec2 strides = ivec2(").concat(s,", ").concat(l,");\n      const ivec2 pads = ivec2(").concat(i,", ").concat(o,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(b,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(m,"], coords[").concat(v,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(h,"; wR++) {\n          int xR = xRCorner + wR * ").concat(c,";\n\n          if (xR < 0 || xR >= ").concat(e.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(d,"; wC++) {\n            int xC = xCCorner + wC * ").concat(u,";\n\n            if (xC < 0 || xC >= ").concat(e.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(f,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(g,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(1===p,") {\n\n              if (").concat(g,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(f,") *\n                    getW(wR, wC, ").concat(f,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(f,", xR, xC) *\n                    getW(wR, wC, ").concat(f,", d2);\n              }\n\n            } else if (").concat(2===p,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(f,", d2),\n                getW(wR, wC, ").concat(f," + 1, d2)\n              );\n\n              if (").concat(g,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(f,"),\n                  getX(batch, xR, xC, ").concat(f," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(f,", xR, xC),\n                  getX(batch, ").concat(f," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(3===p,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(f,", d2),\n                getW(wR, wC, ").concat(f," + 1, d2),\n                getW(wR, wC, ").concat(f," + 2, d2)\n              );\n\n              if (").concat(g,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(f,"),\n                  getX(batch, xR, xC, ").concat(f," + 1),\n                  getX(batch, xR, xC, ").concat(f," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(f,", xR, xC),\n                  getX(batch, ").concat(f," + 1, xR, xC),\n                  getX(batch, ").concat(f," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(w,"\n        ").concat(y,"\n        setOutput(result);\n      }\n    ")}}class b0{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,a=e.strideDepth,i=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,l=e.dilationHeight,c=e.dilationWidth,u=e.filterDepth,h=e.filterHeight,d=e.filterWidth,f=4*Math.floor(e.inChannels/4),p=e.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(a,", ").concat(i,", ").concat(o,");\n      const ivec3 pads = ivec3(").concat(t,", ").concat(n,", ").concat(r,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(u,"; wF++) {\n          int xF = xFCorner + wF * ").concat(s,";\n\n          if (xF < 0 || xF >= ").concat(e.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(h,"; wR++) {\n            int xR = xRCorner + wR * ").concat(l,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(d,"; wC++) {\n              int xC = xCCorner + wC * ").concat(c,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(f,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(1===p,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(f,") *\n                  getW(wF, wR, wC, ").concat(f,", d2);\n              } else if (").concat(2===p,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(f,"),\n                  getX(batch, xF, xR, xC, ").concat(f," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(f,", d2),\n                  getW(wF, wR, wC, ").concat(f," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(3===p,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(f,"),\n                  getX(batch, xF, xR, xC, ").concat(f," + 1),\n                  getX(batch, xF, xR, xC, ").concat(f," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(f,", d2),\n                  getW(wF, wR, wC, ").concat(f," + 1, d2),\n                  getW(wF, wR, wC, ").concat(f," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class x0{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=D$(this.outputShape.length);const i=e.padInfo.left,o=e.strideWidth,s=e.dilationWidth,l=e.filterHeight,c=e.filterWidth,u=c;let h="\n       int xR; int xC; int xCOffset;\n       vec4 wTexel; vec4 previous; vec4 final;";for(let g=0;g<c;g++)h+="\n           vec4 xTexelC".concat(2*g,";\n           int xTexelC").concat(2*g,"Ready;\n           vec4 xTexelC").concat(2*g+1,";\n           int xTexelC").concat(2*g+1,"Ready;\n           vec4 xC").concat(g,";");h+="\n     for (int r = 0; r < ".concat(l,"; r++) {\n      for (int d1 = 0; d1 < ").concat(e.inChannels,"; d1 += 2) {\n       ");for(let g=0;g<c;g++)h+="\n           xTexelC".concat(2*g," = vec4(0.0);\n           xTexelC").concat(2*g,"Ready = 0;\n           xTexelC").concat(2*g+1," = vec4(0.0);\n           xTexelC").concat(2*g+1,"Ready = 0;\n           xC").concat(g," = vec4(0.0);");h+="\n         xR = xRCorner + r * dilations[0];\n         if (xR >=0 && xR < inDims[0]) {\n       ";for(let g=0;g<(u+1)/2;g++){const t=2*g;if(h+="\n           xC = xCCorner + ".concat(t*s,";\n           "),1===o){if(t<c&&(i%2===1?(h+="\n                 xCOffset = xC + 1;\n                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                   xTexelC").concat(t," = getX(batch, xR, xCOffset, d1);\n\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(t,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t,"Ready = 1;\n                 }\n               "),h+=1===s&&t>0?"\n                 xC".concat(t," = vec4(xTexelC").concat(t-2,".zw, xTexelC").concat(t,".xy);\n                 "):"\n                   xCOffset = xC + 1 - 2;\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       previous.zw = vec2(0.0);\n                     }\n\n                     xC".concat(t," = vec4(previous.zw, xTexelC").concat(t,".xy);\n                   } else {\n                     xC").concat(t," = vec4(0.0, 0.0, xTexelC").concat(t,".xy);\n                   }\n                   ")):h+="\n                 if (xC >= 0 && xC < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                   xTexelC").concat(t," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(t,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t,"Ready = 1;\n                 }\n\n                 xC").concat(t," = xTexelC").concat(t,";\n                 "),t+1<c)){const e=i%2===0?Gw(s):s;s%2===0&&i%2===1||s%2!==0&&i%2!==1?(h+="\n                   xCOffset = xC + imod(pads[1], 2) + ".concat(e,";\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                     xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       xTexelC").concat(t+1,".zw = vec2(0.0);\n                     }\n                     xTexelC").concat(t+1,"Ready = 1;\n                   }\n                   "),h+=s>1?"\n                     xCOffset -= 2;\n                     if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                      previous = getX(batch, xR, xCOffset, d1);\n                      xC".concat(t+1," = vec4(previous.zw, xTexelC").concat(t+1,".xy);\n                     } else {\n                      xC").concat(t+1," = vec4(0.0, 0.0, xTexelC").concat(t+1,".xy);\n                     }\n                     "):"\n                     xC".concat(t+1," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".xy);\n                     ")):h+=1===e?"\n                     xC".concat(t+1," = xTexelC").concat(t,";\n                     "):"\n                     xCOffset = xC + ".concat(e,";\n\n                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                       xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n                       if (xCOffset + 1 >= inDims[1]) {\n                         xTexelC").concat(t+1,".zw = vec2(0.0);\n                       }\n                       xTexelC").concat(t+1,"Ready = 1;\n                     }\n\n                     xC").concat(t+1," = xTexelC").concat(t+1,";\n                     ")}}else t<c&&(i%2===1?(h+="\n                 xCOffset = xC + 1 - strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                   xTexelC").concat(t," = getX(batch, xR, xCOffset, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(t,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t,"Ready = 1;\n                 }\n\n                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                   xTexelC").concat(t+1," = getX(batch, xR, xC + 1, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xC + 2 >= inDims[1]) {\n                     xTexelC").concat(t+1,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t+1,"Ready = 1;\n                 }\n\n                 xC").concat(t," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".zw);\n               "),t+1<c&&(h+="\n                   final = vec4(0.0);\n                   xCOffset = xC + 1 + strides[1];\n                   if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                     final = getX(batch, xR, xCOffset, d1);\n                   }\n                   xC".concat(t+1," = vec4(xTexelC").concat(t+1,".xy, final.xy);\n                 "))):(h+="\n                 if(xC >= 0 && xC < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                   xTexelC").concat(t," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(t,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t,"Ready = 1;\n                 }\n\n                 xCOffset = xC + strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                   xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(t+1,".zw = vec2(0.);\n                   }\n                   xTexelC").concat(t+1,"Ready = 1;\n                 }\n\n                 xC").concat(t," = vec4(\n                   xTexelC").concat(t,".xy, xTexelC").concat(t+1,".xy);\n               "),t+1<c&&(h+="\n                   xC".concat(t+1," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".zw);\n                 "))));t<c&&(h+="\n             wTexel = getW(r, ".concat(t,", d1, d2);\n             dotProd += xC").concat(t,".xxzz * vec4(wTexel.xy, wTexel.xy);\n             if(d1 + 1 < ").concat(e.inChannels,") {\n               dotProd += xC").concat(t,".yyww * vec4(wTexel.zw, wTexel.zw);\n             }\n           "),t+1<c&&(h+="\n               wTexel = getW(r, ".concat(t+1,", d1, d2);\n               dotProd += xC").concat(t+1,".xxzz * vec4(wTexel.xy, wTexel.xy);\n               if(d1 + 1 < ").concat(e.inChannels,") {\n                 dotProd += xC").concat(t+1,".yyww * vec4(wTexel.zw, wTexel.zw);\n               }\n             ")))}h+="\n     }\n   ",h+="\n     }\n   ",h+="\n     }\n   ";let d="",f="";n&&(d=r?"vec4 activation(vec4 a) {\n           vec4 b = getPreluActivationWeightsAtOutCoords();\n           ".concat(n,"\n         }"):a?"vec4 activation(vec4 a) {\n           vec4 b = getLeakyreluAlphaAtOutCoords();\n           ".concat(n,"\n         }"):"vec4 activation(vec4 x) {\n           ".concat(n,"\n         }"),f="result = activation(result);");const p=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n       ".concat(d,"\n\n       void main() {\n         ivec4 coords = getOutputCoords();\n         int batch = coords.x;\n         ivec2 xRCCorner = coords.yz * strides - pads;\n         int d2 = coords.w;\n         int xRCorner = xRCCorner.x;\n         int xCCorner = xRCCorner.y;\n\n         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n         vec4 dotProd = vec4(0.000000000000001);\n\n         ").concat(h,"\n\n         vec4 result = dotProd - vec4(0.000000000000001);\n         ").concat(p,"\n         ").concat(f,"\n         setOutput(result);\n       }\n     ")}}class y0{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=D$(this.outputShape.length);const{dataFormat:n}=t,r=c$(),a="channelsLast"===n,i=a?1:2,o=a?2:3,s=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":"if(blockIndex < ".concat(e[2]," && pos < ").concat(e[1],") {");let l="";for(let c=0;c<=1;c++)for(let e=0;e<=1;e++)l+="\n          blockIndex = rc.z + ".concat(e,";\n          pos = rc.y + ").concat(c,";\n\n          ").concat(s,"\n            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];\n            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);\n\n            if(d0 < inputShape[").concat(i,"] && d0 >= 0) {\n              // Use custom imod instead mod. On Intel GPU, mod may generate\n              // unexpected value.\n              // https://github.com/tensorflow/tfjs/issues/5447\n              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];\n              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /\n                  inChannels);\n\n              if(d1 < inputShape[").concat(o,"] && d1 >= 0) {\n\n                ch = imod(pos, inChannels);\n\n                if (").concat(a,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(2*c+e,"] = getChannel(\n                    getA(rc.x, d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(2*c+e,"] = getChannel(\n                    getA(rc.x, ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(l,"\n\n        ").concat(r.output," = result;\n      }\n    ")}}function w0(e,t){const n=e.length;return n>=3?t?[...e.slice(0,-3),e[n-3]*e[n-2],e[n-1]]:[...e.slice(0,-3),e[n-3],e[n-2]*e[n-1]]:!t&&1===n&&e[0]>1?[e[0],1]:null}function k0(e){let{x:t,filter:n,convInfo:r,backend:a,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:s=0,activation:l=null}=e;const c=t.shape,u=a.texData.get(t.dataId),h=r.inChannels,d=c[0]*c[1]*c[2],f=r.outChannels,p="channelsLast"===r.dataFormat,g=!1;let m;const v=[];if(null!=o){const e=w0(o.shape,p);null!=e&&(o=MQ({inputs:{x:o},backend:a,attrs:{shape:e}}),v.push(o))}if(null!=i){const e=w0(i.shape,p);null!=e&&(i=MQ({inputs:{x:i},backend:a,attrs:{shape:e}}),v.push(i))}if(!((1===d||1===f)&&h>1e3)&&u.isPacked&&p&&null!=u.texture&&c[2]%2!==0&&Jw(u.shape.slice(-3),c.slice(-3))){const e=c[0]*c[1]*(c[2]+1),h={dataId:t.dataId,shape:[1,e,r.inChannels],dtype:t.dtype},d=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,Kw(e$(u.shape,h.shape),()=>"packed reshape ".concat(u.shape," to ").concat(h.shape," isn't free"));const f=MQ({inputs:{x:n},backend:a,attrs:{shape:[1,r.inChannels,r.outChannels]}});v.push(f);const p=YQ({a:h,b:f,backend:a,transposeA:false,transposeB:g,bias:i,activation:l,preluActivationWeights:o,leakyreluAlpha:s}),b=a.texData.get(p.dataId);Kw(b.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=d,b.shape=r.outShape,m=mQ({inputs:{x:p},backend:a}),m.shape=r.outShape,v.push(p)}else{const e=r.outHeight*r.outWidth,c=MQ({inputs:{x:t},backend:a,attrs:{shape:p?[r.batchSize,e,r.inChannels]:[r.batchSize,r.inChannels,e]}}),u=MQ({inputs:{x:n},backend:a,attrs:{shape:[1,r.inChannels,r.outChannels]}}),h=YQ({a:p?c:u,b:p?u:c,transposeA:!p,transposeB:g,backend:a,bias:i,activation:l,preluActivationWeights:o,leakyreluAlpha:s});m=MQ({inputs:{x:h},backend:a,attrs:{shape:r.outShape}}),v.push(c),v.push(u),v.push(h)}for(const b of v)a.disposeIntermediateTensorInfo(b);return m}function N0(e){let{x:t,filter:n,convInfo:r,backend:a,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:s=0,activation:l=null}=e;const{filterWidth:c,filterHeight:u,inChannels:h,outWidth:d,outHeight:f,dataFormat:p}=r,g="channelsLast"===p,m=c*u*h,v=f*d,b=[r.batchSize,m,v],x=[];if(null!=o){const e=w0(o.shape,g);null!=e&&(o=MQ({inputs:{x:o},backend:a,attrs:{shape:e}}),x.push(o))}if(null!=i){const e=w0(i.shape,g);null!=e&&(i=MQ({inputs:{x:i},backend:a,attrs:{shape:e}}),x.push(i))}const y=MQ({inputs:{x:n},backend:a,attrs:{shape:[1,m,$w(n.shape)/m]}});x.push(y);const w=new y0(b,r),k=[t.shape,[r.padInfo.top,r.padInfo.left],[r.strideHeight,r.strideWidth],[r.dilationHeight,r.dilationWidth],[r.inChannels],[r.filterWidth*r.inChannels],[r.outWidth]],N=a.runWebGLProgram(w,[t],"float32",k),S=MQ({inputs:{x:N},backend:a,attrs:{shape:b}});x.push(N),x.push(S);const C=null!=i,E=null!=o,_="leakyrelu"===l,I=l?TQ(l,!0):null,T=new AQ(g?S.shape:y.shape,g?y.shape:S.shape,g?[r.batchSize,v,r.outChannels]:[r.batchSize,r.outChannels,v],!0,!1,C,I,E,_),A=g?[S,y]:[y,S];if(i&&A.push(i),E&&A.push(o),_){const e=a.makeTensorInfo([],"float32",pE(s,"float32"));A.push(e),x.push(e)}const R=a.runWebGLProgram(T,A,"float32"),D=MQ({inputs:{x:R},backend:a,attrs:{shape:r.outShape}});x.push(R);for(const F of x)a.disposeIntermediateTensorInfo(F);return D}const S0={kernelName:sN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:o,pad:s,dataFormat:l,dilations:c,dimRoundingMode:u}=r,h=TT(l),d=xT(a.shape,i.shape,o,c,s,u,!1,h);let f;if(1!==d.filterHeight||1!==d.filterWidth||1!==d.dilationHeight||1!==d.dilationWidth||1!==d.strideHeight||1!==d.strideWidth||"SAME"!==d.padInfo.type&&"VALID"!==d.padInfo.type)if(d.strideWidth<=2&&"channelsLast"===h&&_k().getBool("WEBGL_EXP_CONV")){const e=new x0(d),t=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];f=n.runWebGLProgram(e,[a,i],"float32",t)}else if(_k().getBool("WEBGL_CONV_IM2COL"))f=N0({x:a,filter:i,convInfo:d,backend:n});else{const e=new v0(d);f=n.runWebGLProgram(e,[a,i],"float32")}else f=k0({x:a,filter:i,convInfo:d,backend:n});const p=MQ({inputs:{x:f},backend:n,attrs:{shape:d.outShape}});return n.disposeIntermediateTensorInfo(f),p}};class C0{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,i="channelsLast"===e.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(e.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(t," - ").concat(r,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(a,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              ").concat(i?"float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);":"float dyValue = getDy(b, d2, yR, yC);\n              float xValue = getX(b, d1, xR, xC);\n              dotProd += (xValue * dyValue);","\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class E0{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i="channelsLast"===e.dataFormat,o=t-1-e.padInfo.top,s=n-1-e.padInfo.left,l=i?1:2,c=i?2:3,u=i?3:1;this.userCode="\n      const ivec2 pads = ivec2(".concat(o,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(u,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(l,"], coords[").concat(c,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(t,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(t," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2++) {\n\n              if (").concat(i,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class _0{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,a=e.padInfo.front,i=e.padInfo.top,o=e.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(e.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(e.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(t," - ").concat(a,";\n\n            if (xF < 0 || xF >= ").concat(e.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(n," - ").concat(i,";\n\n              if (xR < 0 || xR >= ").concat(e.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(r," - ").concat(o,";\n\n                if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class I0{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,a=e.strideDepth,i=e.strideHeight,o=e.strideWidth,s=t-1-e.padInfo.front,l=n-1-e.padInfo.top,c=r-1-e.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3(".concat(s,", ").concat(l,", ").concat(c,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(t,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(a,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(e.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(t," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(n,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(i,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(n," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(r,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(o,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(r," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const T0={kernelName:lN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:o,pad:s,dataFormat:l,dimRoundingMode:c,filterShape:u}=r,h=TT(l),d=xT(a.shape,u,o,1,s,c,!1,h),f=new C0(d);return n.runWebGLProgram(f,[a,i],"float32")}};class A0{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=D$(this.outputShape.length);const t=e.filterHeight,n=e.filterWidth,r=t-1-e.padInfo.top,a=n-1-e.padInfo.left;this.userCode="\n      const ivec2 pads = ivec2(".concat(r,", ").concat(a,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        vec4 result = vec4(0.);\n        for (int wR = 0; wR < ").concat(t,"; wR++) {\n          float dyR = float(dyRCorner + wR) / strides[0];\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n          int wRPerm = ").concat(t," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            float dyC = float(dyCCorner + wC) / strides[1];\n            bool idyCVal = (dyC >= 0.0) && (dyC < ").concat(e.outWidth,".0)\n              && (fract(dyC) == 0.0);\n            int idyC = int(dyC);\n\n            float dyC2 = float(dyCCorner + wC + 1) / strides[1];\n            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ").concat(e.outWidth,".0)\n              && (fract(dyC2) == 0.0);\n            int idyC2 = int(dyC2);\n\n            if (idyCVal && idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?\n                  dySample : getDy(batch, idyR, idyC2, d2);\n\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n\n                dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample2.xy : dySample2.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal) {\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC2, d2);\n                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            }\n          }\n        }\n        setOutput(result);\n      }\n    ")}}const R0={kernelName:cN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{inputShape:o,strides:s,pad:l,dataFormat:c,dimRoundingMode:u}=r,h=TT(c),d=xT(o,i.shape,s,1,l,u,!1,h);if(_k().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&"channelsLast"===h){const e=[[d.strideHeight,d.strideWidth]],t=new A0(d);return n.runWebGLProgram(t,[a,i],"float32",e)}{const e=new E0(d);return n.runWebGLProgram(e,[a,i],"float32")}}};const D0={kernelName:uN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:o,pad:s,dilations:l}=r,c=yT(a.shape,i.shape,o,l,s),u=new b0(c);return n.runWebGLProgram(u,[a,i],"float32")}};const F0={kernelName:hN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:o,pad:s,filterShape:l}=r,c=yT(a.shape,l,o,1,s),u=new _0(c);return n.runWebGLProgram(u,[a,i],"float32")}};const O0={kernelName:dN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{pad:o,strides:s,inputShape:l}=r,c=yT(l,i.shape,s,1,o),u=new I0(c);return n.runWebGLProgram(u,[a,i],"float32")}},L0=_Q({opSnippet:EQ+"\n  return cos(x);\n",packedOpSnippet:"\n  vec4 result = cos(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(pQ,"\n  return result;\n")}),P0={kernelName:fN,backendName:"webgl",kernelFunc:L0},M0=_Q({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),j0={kernelName:pN,backendName:"webgl",kernelFunc:M0};class B0{constructor(e,t,n,r,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[i,o,s,l]=e,[c]=t,[u,h]=n;this.outputShape=[c,u,h,l];const d="bilinear"===r?1:0,[f,p]=["".concat(o-1,".0"),"".concat(s-1,".0")],[g,m,v]=u>1?["".concat((o-1)/(u-1)),"(y2-y1) * height_ratio","y1*".concat(f," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(f)],[b,x,y]=h>1?["".concat((s-1)/(h-1)),"(x2-x1) * width_ratio","x1*".concat(p," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(p)];this.userCode="\n      const float height_ratio = float(".concat(g,");\n      const float width_ratio = float(").concat(b,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(i,") {\n          return;\n        }\n\n        float height_scale = ").concat(m,";\n        float width_scale = ").concat(x,";\n\n        float in_y = ").concat(v,";\n        if( in_y < 0.0 || in_y > ").concat(f," ) {\n          setOutput(float(").concat(a,"));\n          return;\n        }\n        float in_x = ").concat(y,";\n        if( in_x < 0.0 || in_x > ").concat(p," ) {\n          setOutput(float(").concat(a,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(d," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")}}const z0={kernelName:vN,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{image:a,boxes:i,boxInd:o}=t,{cropSize:s,method:l,extrapolationValue:c}=r,u=new B0(a.shape,i.shape,s,l,c);return n.runWebGLProgram(u,[a,i,o],"float32")}};var W0;!function(e){e.Prod="*",e.Sum="+"}(W0||(W0={}));class U0{constructor(e,t,n,r){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const a=this.outputShape.length,i=this.op===W0.Prod?"1.0":"0.0",o=n?i:"getX(".concat(V0(a,"coords",this.op),")"),s=this.outputShape[this.outputShape.length-1];let l="",c="";n?(l=r?"end != ".concat(s-1):"end != 0",c=r?"end + 1":"end - 1"):(l=r?"end + pow2 < ".concat(s):"end >= pow2",c=r?"end + pow2":"end - pow2"),this.userCode="\n      void main() {\n        ".concat(C$(a)," coords = getOutputCoords();\n        int end = ").concat(H0(a,"coords",this.op),";\n        float val = ").concat(o,";\n        int pow2 = int(pow(2.0, index));\n        if (").concat(l,") {\n          int idx = ").concat(c,";\n          ").concat(H0(a,"coords",this.op)," = idx;\n          val ").concat(this.op,"= getX(").concat(V0(a,"coords",this.op),");\n        }\n        setOutput(val);\n      }\n    ")}}function V0(e,t,n){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".x, ").concat(t,".y");if(3===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z");if(4===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z, ").concat(t,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(e," is not yet supported"))}function H0(e,t,n){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".y");if(3===e)return"".concat(t,".z");if(4===e)return"".concat(t,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(e," is not yet supported"))}function G0(e,t,n,r,a,i){const o=t.shape.length,s=kA([r],o);let l=t;null!=s&&(l=KQ({inputs:{x:t},backend:n,attrs:{perm:s}}));const c=SA(1,o)[0];if(c!==o-1)throw new Error("WebGL cumprod shader expects an inner-most axis=".concat(t.shape.length-1," ")+"but got axis=".concat(r));const u=l.shape[c];let h=mQ({inputs:{x:l},backend:n});for(let d=0;d<=Math.ceil(Math.log2(u))-1;d++){const t=new U0(e,l.shape,!1,i),r=[[d]],a=h;h=n.runWebGLProgram(t,[h],h.dtype,r),n.disposeIntermediateTensorInfo(a)}if(a){const t=new U0(e,l.shape,a,i),r=h;h=n.runWebGLProgram(t,[h],h.dtype),n.disposeIntermediateTensorInfo(r)}if(null!=s){const e=KQ({inputs:{x:h},backend:n,attrs:{perm:NA(s)}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(l),e}return h}const q0={kernelName:gN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,exclusive:o,reverse:s}=r;return G0(W0.Prod,a,n,i,o,s)}};const K0={kernelName:mN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,exclusive:o,reverse:s}=r;return G0(W0.Sum,a,n,i,o,s)}};const X0={kernelName:bN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,weights:i}=t,{size:o,binaryOutput:s}=r;if(1===a.shape.length){const e=n.readSync(a.dataId),t=n.readSync(i.dataId),r=Q$(e,t,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,r)}if(2===a.shape.length){const e=n.bufferSync(a),t=n.bufferSync(i),r=Z$(e,t,o,s);return n.makeTensorInfo(r.shape,i.dtype,r.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(a.shape.length,"."))}};class Y0{constructor(e,t,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(t,";\n      int offset_h = imod(h, ").concat(t,");\n      int in_w = w / ").concat(t,";\n      int offset_w = imod(w, ").concat(t,");\n      int offset_d = (offset_h * ").concat(t," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}getHeightCoordString(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}getWidthCoordString(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}getDepthCoordString(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}getOutputDepthSize(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}const $0={kernelName:xN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockSize:i,dataFormat:o}=r,s=a.shape[0],l=("NHWC"===o?a.shape[1]:a.shape[2])*i,c=("NHWC"===o?a.shape[2]:a.shape[3])*i,u=("NHWC"===o?a.shape[3]:a.shape[1])/(i*i),h=new Y0("NHWC"===o?[s,l,c,u]:[s,u,l,c],i,o);return n.runWebGLProgram(h,[a],a.dtype)}};class J0{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=D$(this.outputShape.length);const i=e.filterHeight,o=e.filterWidth,s=e.outChannels/e.inChannels;let l="",c="";n&&(l=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):a?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),c="result = activation(result);");const u=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(l,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(s,";\n        int q = d2 - d1 * ").concat(s,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(i,"; wR++) {\n          int xR = xRCorner + wR * dilations[0];\n\n          if (xR < 0 || xR >= inDims[0]) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(o,"; wC++) {\n            int xC = xCCorner + wC * dilations[1];\n\n            if (xC < 0 || xC >= inDims[1]) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(u,"\n        ").concat(c,"\n        setOutput(result);\n      }\n    ")}}class Q0{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=D$(this.outputShape.length);const i=e.outChannels/e.inChannels,o=e.padInfo.left,s=e.strideWidth,l=e.dilationWidth,c=e.filterHeight,u=e.filterWidth,h=u;let d="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;";for(let m=0;m<u;m++)d+="\n          vec4 xTexelC".concat(2*m,";\n          int xTexelC").concat(2*m,"Ready;\n          vec4 xTexelC").concat(2*m+1,";\n          int xTexelC").concat(2*m+1,"Ready;\n          vec4 xC").concat(m,";");d+="\n    for (int r = 0; r < ".concat(c,"; r++) {\n      ");for(let m=0;m<u;m++)d+="\n          xTexelC".concat(2*m," = vec4(0.0);\n          xTexelC").concat(2*m,"Ready = 0;\n          xTexelC").concat(2*m+1," = vec4(0.0);\n          xTexelC").concat(2*m+1,"Ready = 0;\n          xC").concat(m," = vec4(0.0);");d+="\n        xR = xRCorner + r * dilations[0];\n        if (xR >=0 && xR < inDims[0]) {\n      ";for(let m=0;m<(h+1)/2;m++){const e=2*m;if(d+="\n          xC = xCCorner + ".concat(e*l,";\n          "),1===s){if(e<u&&(o%2===1?(d+="\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                  xTexelC").concat(e," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(e,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e,"Ready = 1;\n                }\n              "),d+=1===l&&e>0?"\n                xC".concat(e," = vec4(xTexelC").concat(e-2,".zw, xTexelC").concat(e,".xy);\n                "):"\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC".concat(e," = vec4(previous.zw, xTexelC").concat(e,".xy);\n                  } else {\n                    xC").concat(e," = vec4(0.0, 0.0, xTexelC").concat(e,".xy);\n                  }\n                  ")):d+="\n                if (xC >= 0 && xC < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                  xTexelC").concat(e," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(e,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e,"Ready = 1;\n                }\n\n                xC").concat(e," = xTexelC").concat(e,";\n                "),e+1<u)){const t=o%2===0?Gw(l):l;l%2===0&&o%2===1||l%2!==0&&o%2!==1?(d+="\n                  xCOffset = xC + imod(pads[1], 2) + ".concat(t,";\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                    xTexelC").concat(e+1," = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      xTexelC").concat(e+1,".zw = vec2(0.0);\n                    }\n                    xTexelC").concat(e+1,"Ready = 1;\n                  }\n                  "),d+=l>1?"\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n                     xC".concat(e+1," = vec4(previous.zw, xTexelC").concat(e+1,".xy);\n                    } else {\n                     xC").concat(e+1," = vec4(0.0, 0.0, xTexelC").concat(e+1,".xy);\n                    }\n                    "):"\n                    xC".concat(e+1," = vec4(xTexelC").concat(e,".zw, xTexelC").concat(e+1,".xy);\n                    ")):d+=1===t?"\n                    xC".concat(e+1," = xTexelC").concat(e,";\n                    "):"\n                    xCOffset = xC + ".concat(t,";\n\n                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                      xTexelC").concat(e+1," = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= inDims[1]) {\n                        xTexelC").concat(e+1,".zw = vec2(0.0);\n                      }\n                      xTexelC").concat(e+1,"Ready = 1;\n                    }\n\n                    xC").concat(e+1," = xTexelC").concat(e+1,";\n                    ")}}else e<u&&(o%2===1?(d+="\n                xCOffset = xC + 1 - strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                  xTexelC").concat(e," = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(e,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e,"Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                  xTexelC").concat(e+1," = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= inDims[1]) {\n                    xTexelC").concat(e+1,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e+1,"Ready = 1;\n                }\n\n                xC").concat(e," = vec4(xTexelC").concat(e,".zw, xTexelC").concat(e+1,".zw);\n              "),e+1<u&&(d+="\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + strides[1];\n                  if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC".concat(e+1," = vec4(xTexelC").concat(e+1,".xy, final.xy);\n                "))):(d+="\n                if(xC >= 0 && xC < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                  xTexelC").concat(e," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(e,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e,"Ready = 1;\n                }\n\n                xCOffset = xC + strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                  xTexelC").concat(e+1," = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(e+1,".zw = vec2(0.);\n                  }\n                  xTexelC").concat(e+1,"Ready = 1;\n                }\n\n                xC").concat(e," = vec4(\n                  xTexelC").concat(e,".xy, xTexelC").concat(e+1,".xy);\n              "),e+1<u&&(d+="\n                  xC".concat(e+1," = vec4(xTexelC").concat(e,".zw, xTexelC").concat(e+1,".zw);\n                "))));e<u&&(d+="\n            wTexel = getW(r, ".concat(e,", d1, q);\n            dotProd += xC").concat(e," * vec4(wTexel.xz, wTexel.xz);\n          "),e+1<u&&(d+="\n              wTexel = getW(r, ".concat(e+1,", d1, q);\n              dotProd += xC").concat(e+1," * vec4(wTexel.xz, wTexel.xz);\n            ")))}d+="\n    }\n  ",d+="\n      }\n    ";let f="",p="";n&&(f=r?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):a?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(n,"\n        }"),p="result = activation(result);");const g=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(f,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(i,";\n        int q = d2 - d1 * ").concat(i,";\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ").concat(d,"\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ").concat(g,"\n        ").concat(p,"\n        setOutput(result);\n      }\n    ")}}const Z0={kernelName:yN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:o,pad:s,dilations:l,dimRoundingMode:c}=r;let u=l;null==u&&(u=[1,1]),Kw(_T(o,u),()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(o," and dilations '").concat(u,"'"));const h=xT(a.shape,i.shape,o,u,s,c,!0);let d;d=_k().getBool("WEBGL_PACK_DEPTHWISECONV")&&h.strideWidth<=2&&h.outChannels/h.inChannels===1?new Q0(h):new J0(h);const f=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];return n.runWebGLProgram(d,[a,i],"float32",f)}};class e1{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(i," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(e.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(t," - ").concat(r,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(a,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class t1{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i=t-1-e.padInfo.top,o=n-1-e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(i,", ").concat(o,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(t,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(t," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(s,"; dm++) {\n              int d2 = d1 * ").concat(s," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const n1={kernelName:wN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,dy:i}=t,{strides:o,dilations:s,pad:l,dimRoundingMode:c,filterShape:u}=r,h=xT(a.shape,u,o,s,l,c,!0),d=new e1(h);return n.runWebGLProgram(d,[a,i],"float32")}};const r1={kernelName:kN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:i}=t,{strides:o,dilations:s,pad:l,dimRoundingMode:c,inputShape:u}=r,h=xT(u,i.shape,o,s,l,c,!0),d=new t1(h);return n.runWebGLProgram(d,[a,i],"float32")}};class a1{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}}const i1={kernelName:NN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t,a=[...r.shape,...r.shape],i=$w(r.shape),o=MQ({inputs:{x:r},backend:n,attrs:{shape:[i]}}),s=new a1(i),l=n.runWebGLProgram(s,[o],o.dtype),c=MQ({inputs:{x:l},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),c}};class o1{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:t,inWidth:n,padInfo:r,strideHeight:a,strideWidth:i,filterHeight:o,filterWidth:s,dilationHeight:l,dilationWidth:c}=e,{top:u,left:h}=r;this.userCode="\n      const ivec2 strides = ivec2(".concat(a,", ").concat(i,");\n      const ivec2 pads = ivec2(").concat(u,", ").concat(h,");\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ").concat(o,"; h++) {\n          int hIn = hBeg + h * ").concat(l,";\n\n          if (hIn >= 0 && hIn < ").concat(t,") {\n            for (int w = 0; w < ").concat(s,"; w++) {\n              int wIn = wBeg + w * ").concat(c,";\n\n              if (wIn >= 0 && wIn < ").concat(n,") {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    ")}}const s1={kernelName:SN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i}=t,{strides:o,pad:s,dilations:l}=r,c=mT(a.shape,i.shape,o,s,"NHWC",l);let u;const h=new o1(c);u=n.runWebGLProgram(h,[a,i],"float32");const d=MQ({inputs:{x:u},backend:n,attrs:{shape:c.outShape}});return n.disposeIntermediateTensorInfo(u),d}};const l1={kernelName:TN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{equation:a}=r,i=t,{allDims:o,summedDims:s,idDims:l}=lF(a,i.length);uF(o.length,l,i);const{path:c,steps:u}=hF(s,l),h=u.length;let d=null,f=o.length;const p=[];for(let g=0;g<h;++g){for(const e of u[g]){const{permutationIndices:t,expandDims:r}=cF(f,l[e]);let a;dF(t)?a=i[e]:(a=KQ({inputs:{x:i[e]},backend:n,attrs:{perm:t}}),p.push(a));const o=a.shape.slice();for(let e=0;e<r.length;++e)o.splice(r[e],0,1);Jw(a.shape,o)||(a=MQ({inputs:{x:a},backend:n,attrs:{shape:o}}),p.push(a)),null===d?d=a:(d=LQ({inputs:{a:a,b:d},backend:n}),p.push(d))}g<h-1&&(c[g]>=0&&(d=GQ({inputs:{x:d},backend:n,attrs:{axis:c[g]-(o.length-f),keepDims:!1}}),p.push(d)),f--)}for(const g of p)g!==d&&n.disposeIntermediateTensorInfo(g);return d}},c1=_Q({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),u1={kernelName:AN,backendName:"webgl",kernelFunc:c1},h1={kernelName:RN,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n}=e,{dy:r,y:a}=t,i=_k().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new gQ("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",r.shape,a.shape):new fQ("return (b >= 0.0) ? a : a * (b + 1.0);",r.shape,a.shape);return n.runWebGLProgram(i,[r,a],r.dtype)}},d1=IQ({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool",cpuKernelImpl:aJ}),f1={kernelName:FN,backendName:"webgl",kernelFunc:d1},p1=_Q({opSnippet:'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(HD,";\n  float a1 = ").concat(GD,";\n  float a2 = ").concat(qD,";\n  float a3 = ").concat(KD,";\n  float a4 = ").concat(XD,";\n  float a5 = ").concat(YD,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n")}),g1={kernelName:DN,backendName:"webgl",kernelFunc:p1},m1=_Q({opSnippet:EQ+"\n  return exp(x);\n",packedOpSnippet:"\n  vec4 result = exp(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:iJ,dtype:"float32"}),v1={kernelName:ON,backendName:"webgl",kernelFunc:m1};function b1(e){const{inputs:t,attrs:n,backend:r}=e,{dim:a}=n,{input:i}=t,o=i.shape.length,s=i.shape.slice();let l=a;return a<0&&(Kw(-(o+1)<=a,()=>"Axis must be in the interval [".concat(-(o+1),", ").concat(o,"]")),l=o+a+1),s.splice(l,0,1),MQ({inputs:{x:i},backend:r,attrs:{shape:s}})}const x1={kernelName:LN,backendName:"webgl",kernelFunc:b1},y1="return exp(x) - 1.0;",w1=_Q({opSnippet:y1,packedOpSnippet:y1,cpuKernelImpl:oJ}),k1={kernelName:PN,backendName:"webgl",kernelFunc:w1};class N1{constructor(e,t,n){this.variableNames=["real","imag"];const r=t[1];this.outputShape=t;const a=n?"2.0 * ".concat(Math.PI):"-2.0 * ".concat(Math.PI),i=n?"".concat(r,".0"):"1.0";let o;if("real"===e)o="return real * expR - imag * expI;";else{if("imag"!==e)throw new Error('FFT component must be either "real" or "imag", got '.concat(e,"."));o="return real * expI + imag * expR;"}this.userCode="\n      const float exponentMultiplier = ".concat(a,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(o,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(r,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(r,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(i,";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")}}function S1(e,t,n){const r=n.texData.get(e.dataId),a=$w(e.shape),i=e.shape[e.shape.length-1],o=MQ({inputs:{x:e},backend:n,attrs:{shape:[a/i,i]}}),s=o.shape,l=new N1("real",s,t),c=new N1("imag",s,t),u=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:s},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:s}],h=n.runWebGLProgram(l,u,"float32"),d=n.runWebGLProgram(c,u,"float32"),f=bQ({inputs:{real:h,imag:d},backend:n});n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d);const p=MQ({inputs:{x:f},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(f),p}const C1={kernelName:MN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{input:r}=t;return S1(r,!1,n)}};class E1{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode="\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}}function _1(e){const{backend:t,attrs:n}=e,{shape:r,value:a}=n;let{dtype:i}=n;if(i=i||hk(a),"string"===i){const e=ok(i,$w(r));return e.fill(a),t.makeTensorInfo(r,i,e)}{const e=new E1(r,a),n=[[a]];return t.runWebGLProgram(e,[],i,n)}}const I1={kernelName:jN,backendName:"webgl",kernelFunc:_1};class T1{constructor(e){this.variableNames=["Image"],this.outputShape=[];const t=e[2];this.outputShape=e,this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ".concat(t," - x - 1;\n          float outputValue;\n          if(coordX >= 0 && coordX < ").concat(t,") {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}}const A1={kernelName:BN,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n}=e;const{image:r}=t,a=n,i=new T1(r.shape);return a.runWebGLProgram(i,[r],r.dtype)}},R1="return floor(x);",D1=_Q({opSnippet:R1,packedOpSnippet:R1,cpuKernelImpl:sJ}),F1={kernelName:zN,backendName:"webgl",kernelFunc:D1},O1=IQ({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),L1={kernelName:WN,backendName:"webgl",kernelFunc:O1};class P1{constructor(e){this.variableNames=["A"];const t=c$(),[n,r]=e;this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(r,".0, ").concat(n,".0);\n\n        vec4 values = ").concat(t.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")}}class M1{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const t=c$(),[n,r]=e;this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(r,".0, ").concat(n,".0);\n            vec4 values = ").concat(t.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(t.output," = result;\n      }\n    ")}}const j1={kernelName:jC,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e;let{pixels:a}=t;const{numChannels:i}=r,o="undefined"!==typeof HTMLVideoElement&&a instanceof HTMLVideoElement,s="undefined"!==typeof HTMLImageElement&&a instanceof HTMLImageElement,[l,c]=o?[a.videoWidth,a.videoHeight]:[a.width,a.height],u=[c,l],h=[c,l,i];if(s||o){const e=_k().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");null!=B1&&e===z1||(z1=e,B1=document.createElement("canvas").getContext("2d",{willReadFrequently:z1})),B1.canvas.width=l,B1.canvas.height=c,B1.drawImage(a,0,0,l,c),a=B1.canvas}const d=n.makeTensorInfo(u,"int32");n.texData.get(d.dataId).usage=RY.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(d.dataId),a);const f=_k().getBool("WEBGL_PACK")?new M1(h):new P1(h),p=n.runWebGLProgram(f,[d],"int32");return n.disposeData(d.dataId),p}};let B1,z1=_k().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");const W1={kernelName:WC,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i,bias:o,preluActivationWeights:s}=t,{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d,activation:f,leakyreluAlpha:p}=r,g=TT(u),m=xT(a.shape,i.shape,l,h,c,d,!1,g);let v;const b=[],x=null!=o,y=null!=s,w="leakyrelu"===f,k=()=>{const e=[a,i],t=(e,t)=>{if("NCHW"===t&&1===e.shape.length&&1!==e.shape[0]){const t=MQ({inputs:{x:e},backend:n,attrs:{shape:[e.shape[0],1,1]}});return b.push(t),t}return e};if(x&&e.push(t(o,u)),y&&e.push(t(s,u)),w){const t=n.makeTensorInfo([],"float32",pE(p,"float32"));e.push(t),b.push(t)}return e};if(1!==m.filterHeight||1!==m.filterWidth||1!==m.dilationHeight||1!==m.dilationWidth||1!==m.strideHeight||1!==m.strideWidth||"SAME"!==m.padInfo.type&&"VALID"!==m.padInfo.type)if(m.strideWidth<=2&&"channelsLast"===g&&_k().getBool("WEBGL_EXP_CONV")){const e=f?TQ(f,!0):null,t=new x0(m,x,e,y,w),r=[[m.padInfo.top,m.padInfo.left],[m.strideHeight,m.strideWidth],[m.dilationHeight,m.dilationWidth],[m.inHeight,m.inWidth]],a=k();v=n.runWebGLProgram(t,a,"float32",r)}else if(_k().getBool("WEBGL_CONV_IM2COL"))v=N0({x:a,filter:i,convInfo:m,backend:n,bias:o,activation:f,preluActivationWeights:s,leakyreluAlpha:p});else{const e=f?TQ(f,!1):null,t=new v0(m,x,e,y,w),r=k();v=n.runWebGLProgram(t,r,"float32")}else v=k0({x:a,filter:i,convInfo:m,backend:n,bias:o,activation:f,preluActivationWeights:s,leakyreluAlpha:p});const N=MQ({inputs:{x:v},backend:n,attrs:{shape:m.outShape}});return b.push(v),b.forEach(e=>n.disposeIntermediateTensorInfo(e)),N}};const U1={kernelName:UC,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:i,bias:o,preluActivationWeights:s}=t,{strides:l,pad:c,dilations:u,dimRoundingMode:h,activation:d,leakyreluAlpha:f}=r,p=[];let g=u;null==g&&(g=[1,1]),Kw(_T(l,g),()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(l," and dilations '").concat(g,"'"));const m=xT(a.shape,i.shape,l,g,c,h,!0),v=_k().getBool("WEBGL_PACK_DEPTHWISECONV")&&m.strideWidth<=2&&m.outChannels/m.inChannels===1,b=d?TQ(d,v):null,x=[a,i],y=null!=o,w=null!=s,k="leakyrelu"===d;if(y&&x.push(o),w&&x.push(s),k){const e=n.makeTensorInfo([],"float32",pE(f,"float32"));x.push(e),p.push(e)}let N;N=v?new Q0(m,y,b,w,k):new J0(m,y,b,w,k);const S=[[m.padInfo.top,m.padInfo.left],[m.strideHeight,m.strideWidth],[m.dilationHeight,m.dilationWidth],[m.inHeight,m.inWidth]],C=n.runWebGLProgram(N,x,"float32",S);return p.forEach(e=>n.disposeIntermediateTensorInfo(e)),C}};class V1{constructor(e,t,n,r){this.sliceDim=e,this.strides=t,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=n;const a=C$(n.length);let i="\n    int index;";for(let o=0;o<this.sliceDim;o++)i+="\n          index = round(getIndices(coords[0], ".concat(o,"));\n          out_of_bounds = out_of_bounds || index < 0;\n          out_of_bounds = out_of_bounds || index >= ").concat(this.paramsShape[o],";\n          flattenIndex += index * ").concat(this.strides[o],";");this.userCode="\n         void main() {\n          ".concat(a," coords = getOutputCoords();\n          int flattenIndex = 0;\n          bool out_of_bounds = false;\n\n          ").concat(i,"\n\n          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));\n        }\n      ")}}const H1={kernelName:HN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{params:r,indices:a}=t,i=a.shape,o=i[i.length-1],s=$w(r.shape),[l,c,u,h]=jD(r,a),d=MQ({inputs:{x:a},backend:n,attrs:{shape:[c,o]}}),f=MQ({inputs:{x:r},backend:n,attrs:{shape:[$w(r.shape)/u,u]}});if(n.shouldExecuteOnCPU([r,a])||"string"===r.dtype){const e=n.readSync(a.dataId),t=n.bufferSync(r),i=lJ(e,t,r.dtype,c,o,u,h,r.shape,s);return n.makeTensorInfo(l,r.dtype,i.values)}const p=new V1(o,h,[c,u],r.shape),g=n.runWebGLProgram(p,[f,d],f.dtype),m=MQ({inputs:{x:g},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),m}};class G1{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;const n=C$(this.rank),r=function(e){const t=["resRC.x","resRC.y","resRC.z","resRC.w"],n=[];for(let r=0;r<e.length;r++)2===r?n.push("index"):n.push("".concat(t[r]));return n.join()}(e);this.userCode="\n      void main() {\n        ".concat(n," resRC = getOutputCoords();\n        int index = int(getIndices(resRC.x, resRC.z));\n        float inBounds = (index >= 0) && (index < ").concat(e[2],") ? 1.0 : 0.0;\n        setOutput(inBounds * getA(").concat(r,"));\n      }\n    ")}}function q1(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,indices:i}=t,{axis:o,batchDims:s}=r,l=rk(o,a.shape)[0];if(_k().get("DEBUG")){const e=n.readSync(i.dataId),t=a.shape[l];for(let n=0;n<e.length;++n){const r=e[n];Kw(r<=t-1&&r>=0,()=>"GatherV2: the index value ".concat(r," is not in [0, ").concat(t-1,"]"))}}const c=TF(a,i,l,s),u=$w(i.shape),h=[],d=MQ({inputs:{x:a},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),f=MQ({inputs:{x:i},backend:n,attrs:{shape:[c.batchSize,u/c.batchSize]}});h.push(d),h.push(f);const p=[c.batchSize,c.outerSize,u/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([a,i])||"string"===a.dtype){const e=n.bufferSync(f),t=n.bufferSync(d),r=cJ(t,e,p);return h.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.makeTensorInfo(c.outputShape,r.dtype,r.values)}const g=new G1(d.shape,p),m=n.runWebGLProgram(g,[d,f],d.dtype);h.push(m);const v=MQ({inputs:{x:m},backend:n,attrs:{shape:c.outputShape}});return h.forEach(e=>n.disposeIntermediateTensorInfo(e)),v}const K1={kernelName:VN,backendName:"webgl",kernelFunc:q1},X1=IQ({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:uJ,dtype:"bool"}),Y1={kernelName:GN,backendName:"webgl",kernelFunc:X1},$1=IQ({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool",cpuKernelImpl:hJ}),J1={kernelName:qN,backendName:"webgl",kernelFunc:$1};const Q1={kernelName:XN,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{input:r}=t;return S1(r,!0,n)}},Z1=_Q({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),e2={kernelName:$N,backendName:"webgl",kernelFunc:Z1},t2=_Q({opSnippet:"return float(isinf(x));",dtype:"bool"}),n2={kernelName:JN,backendName:"webgl",kernelFunc:t2},r2=_Q({opSnippet:"return float(isnan(x));",dtype:"bool"}),a2={kernelName:QN,backendName:"webgl",kernelFunc:r2},i2=IQ({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:dJ,dtype:"bool"}),o2={kernelName:eS,backendName:"webgl",kernelFunc:i2},s2=IQ({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",cpuKernelImpl:fJ,dtype:"bool"}),l2={kernelName:tS,backendName:"webgl",kernelFunc:s2};const c2={kernelName:nS,backendName:"webgl",kernelFunc:function(e){const{backend:t,attrs:n}=e,{start:r,stop:a,num:i}=n,o=pJ(r,a,i);return t.makeTensorInfo([o.length],"float32",o)}},u2=_Q({opSnippet:EQ+"\n  return x < 0.0 ? 0./0. : log(x);\n",packedOpSnippet:"\n  vec4 result = log(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);\n  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);\n  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);\n  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);\n  return result;\n",cpuKernelImpl:gJ}),h2={kernelName:rS,backendName:"webgl",kernelFunc:u2},d2=_Q({opSnippet:EQ+"\n  return log(1.0 + x);\n"}),f2={kernelName:aS,backendName:"webgl",kernelFunc:d2},p2=IQ({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),g2={kernelName:iS,backendName:"webgl",kernelFunc:p2},m2=_Q({opSnippet:"return float(!(x >= 1.0));"}),v2={kernelName:oS,backendName:"webgl",kernelFunc:m2},b2=IQ({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),x2={kernelName:sS,backendName:"webgl",kernelFunc:b2};class y2{constructor(e,t,n,r,a){this.variableNames=["x"],this.outputShape=[];const i=t,o=e[3]-1;let s;this.outputShape=e;const l="float(".concat(n,") + float(").concat(r,") * sum");s=.5===a?"inversesqrt(".concat(l,")"):1===a?"1.0/(".concat(l,")"):"exp(log(".concat(l,") * float(-").concat(a,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(i,"; j <= ").concat(i,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(o,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(s,";\n        setOutput(val);\n      }\n    ")}}class w2{constructor(e,t,n,r,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const i=t,o=e[3]-1;let s;this.outputShape=e;const l="float(".concat(n,") + float(").concat(r,") * sum");s=.5===a?"inversesqrt(".concat(l,")"):1===a?"1.0/(".concat(l,")"):"exp(log(".concat(l,") * float(-").concat(a,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(i,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(i,"; j <= ").concat(i,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(o,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(s,";\n        setOutput(result);\n      }\n    ")}}const k2={kernelName:lS,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{depthRadius:i,bias:o,alpha:s,beta:l}=r,c=_k().getBool("WEBGL_PACK_NORMALIZATION")?new w2(a.shape,i,o,s,l):new y2(a.shape,i,o,s,l);return n.runWebGLProgram(c,[a],a.dtype)}};class N2{constructor(e,t,n,r,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=a,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(t,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(t," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(r,") * norm + float(").concat(n,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(r,")\n                * float(").concat(a,")\n                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(a,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")}}const S2={kernelName:cS,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{x:a,y:i,dy:o}=t,{depthRadius:s,bias:l,alpha:c,beta:u}=r,h=new N2(a.shape,s,l,c,u);return n.runWebGLProgram(h,[a,i,o],a.dtype)}};function C2(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{reductionIndices:i,keepDims:o}=r,s=a.shape.length,l=rk(i,a.shape);let c=l;const u=kA(c,s),h=null!=u,d=n.shouldExecuteOnCPU([a]);let f=a;if(h){if(d){const e=n.texData.get(f.dataId).values,t=new Array(s);for(let n=0;n<t.length;n++)t[n]=a.shape[u[n]];const r=HJ(e,a.shape,a.dtype,u,t);f=n.makeTensorInfo(t,a.dtype);n.texData.get(f.dataId).values=r}else f=HQ(a,u,n);c=SA(c.length,s)}wA("max",c,s);const[p,g]=xA(f.shape,c);let m,v=p;if(o&&(v=yA(p,l)),d){const e=n.texData.get(f.dataId).values,t=mJ(e,$w(g),v,a.dtype);m=n.makeTensorInfo(v,a.dtype);n.texData.get(m.dataId).values=t}else m=function(e,t,n,r){const a=$w(t),i=MQ({inputs:{x:e},attrs:{shape:[$w(e.shape)/a,a]},backend:r}),o=WQ(i,e.dtype,"max",r),s=MQ({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),s}(f,g,v,n);return h&&n.disposeIntermediateTensorInfo(f),m}const E2={kernelName:uS,backendName:"webgl",kernelFunc:C2},_2=IQ({opSnippet:dQ+"\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+pQ+"\n  return result;\n",cpuKernelImpl:vJ}),I2={kernelName:hS,backendName:"webgl",kernelFunc:_2};const T2={kernelName:dS,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t;s$(a,"maxPool");const{filterSize:i,strides:o,pad:s,dimRoundingMode:l}=r;Kw(_T(o,1),()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'"));const c=vT(a.shape,i,o,1,s,l);if(1===c.filterWidth&&1===c.filterHeight&&Jw(c.inShape,c.outShape))return mQ({inputs:{x:a},backend:n});const u=new IZ(c,"max",!1);return n.runWebGLProgram(u,[a],a.dtype)}};const A2={kernelName:pS,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:i,strides:o,pad:s,dataFormat:l,dimRoundingMode:c}=r,u=bT(a.shape,i,o,[1,1,1],s,c,l),h=new TZ(u,"max",!1);return n.runWebGLProgram(h,[a],a.dtype)}};class R2{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,a=e.effectiveFilterHeight,i=e.effectiveFilterWidth,o=a-1-e.padInfo.top,s=i-1-e.padInfo.left,l=a*i-1;this.userCode="\n      const ivec2 pads = ivec2(".concat(o,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(a,";\n          wR += ").concat(r,") {\n          float dyR = float(dyRCorner + wR) / ").concat(t,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(i,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(n,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(l," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(i," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class D2{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,a=e.dilationDepth,i=e.dilationHeight,o=e.dilationWidth,s=e.effectiveFilterDepth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,u=s-1-e.padInfo.front,h=l-1-e.padInfo.top,d=c-1-e.padInfo.left,f=s*l*c-1;this.userCode="\n      const ivec3 pads = ivec3(".concat(u,", ").concat(h,", ").concat(d,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(s,";\n           wD += ").concat(a,") {\n          float dyD = float(dyDCorner + wD) / ").concat(t,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(e.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(l,";\n              wR += ").concat(i,") {\n            float dyR = float(dyRCorner + wR) / ").concat(n,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(c,";\n                wC += ").concat(o,") {\n              float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(f," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(l," * ").concat(c," +\n                  wR * ").concat(c," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const F2={kernelName:gS,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i}=t,o=i,{filterSize:s,strides:l,pad:c,dimRoundingMode:u}=r,h=bT(o.shape,s,l,[1,1,1],c,u),d=new TZ(h,"max",!0),f=n.runWebGLProgram(d,[o],o.dtype),p=new D2(h),g=n.runWebGLProgram(p,[a,f],o.dtype);return n.disposeIntermediateTensorInfo(f),g}};const O2={kernelName:fS,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,input:i,output:o}=t,s=i;s$([i,o],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:h}=r,d=vT(s.shape,l,c,1,u,h),f=new IZ(d,"max",!0),p=n.runWebGLProgram(f,[s],s.dtype),g=new R2(d),m=n.runWebGLProgram(g,[a,p],s.dtype);return n.disposeIntermediateTensorInfo(p),m}};const L2={kernelName:mS,backendName:"webgl",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{x:a}=t,{filterSize:i,strides:o,pad:s,includeBatchInIndex:l}=n,c=r;Kw(4===a.shape.length,()=>"Error in maxPool: input must be rank 4 but got rank ".concat(a.shape.length,"."));const u=[1,1];Kw(_T(o,u),()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(u,"'"));const h=vT(a.shape,i,o,u,s),[d,f]=function(e,t,n,r){let a=new IZ(n,"max",!1);const i=r.runWebGLProgram(a,[e],"float32");return a=new IZ(n,"max",!0,!0,t),[i,r.runWebGLProgram(a,[e],"float32")]}(a,l,h,c);return[d,f]}};const P2={kernelName:vS,backendName:"webgl",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{x:a}=t,{keepDims:i,axis:o}=n,s=r,l=a.shape.length,c=rk(o,a.shape);let u=c;const h=kA(u,l),d=null!=h,f=s.shouldExecuteOnCPU([a]),p=[];let g=a;if(d){if(f){const e=s.texData.get(g.dataId).values,t=new Array(l);for(let r=0;r<t.length;r++)t[r]=a.shape[h[r]];const n=HJ(e,a.shape,a.dtype,h,t);g=s.makeTensorInfo(t,a.dtype);s.texData.get(g.dataId).values=n}else g=HQ(a,h,s);p.push(g),u=SA(u.length,l)}wA("sum",u,l);const[m,v]=xA(g.shape,u);let b=m;i&&(b=yA(m,c));const x=function(e,t,n,r){const a=$w(t),i=MQ({inputs:{x:e},attrs:{shape:[$w(e.shape)/a,a]},backend:r}),o=WQ(i,"float32","mean",r),s=MQ({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),s}(g,v,b,s);for(const y of p)s.disposeIntermediateTensorInfo(y);return x}};const M2={kernelName:bS,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:o}=r,s=a.shape.length,l=rk(i,a.shape);let c=l;const u=kA(c,s);let h=a;null!=u&&(h=KQ({inputs:{x:a},backend:n,attrs:{perm:u}}),c=SA(c.length,a.shape.length)),wA("min",c,s);const[d,f]=xA(h.shape,c),p=MQ({inputs:{x:h},backend:n,attrs:{shape:[-1,$w(f)]}}),g=WQ(p,p.dtype,"min",n);let m;if(o){m=MQ({inputs:{x:g},backend:n,attrs:{shape:yA(d,l)}})}else m=MQ({inputs:{x:g},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),null!=u&&n.disposeIntermediateTensorInfo(h),m}},j2=IQ({opSnippet:dQ+"\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+pQ+"\n  return result;\n",cpuKernelImpl:bJ}),B2={kernelName:xS,backendName:"webgl",kernelFunc:j2};class z2{constructor(e,t,n){this.variableNames=["x"],this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);const r=e.length,a=C$(r),i=t.map(e=>e[0]).join(","),o=t.map((t,n)=>t[0]+e[n]).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),l="reflect"===n?0:1;this.userCode=1!==r?"\n      ".concat(a," start = ").concat(a,"(").concat(i,");\n      ").concat(a," end = ").concat(a,"(").concat(o,");\n\n      void main() {\n        ").concat(a," outC = getOutputCoords();\n        for (int i = 0; i < ").concat(r,"; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ").concat(l,";\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ").concat(l,";\n          }\n        }\n        ").concat(a," coords = outC - start;\n        setOutput(getX(").concat(s,"));\n      }\n    "):"\n        int start = ".concat(i,";\n        int end = ").concat(o,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ").concat(l,";\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ").concat(l,";\n          }\n          setOutput(getX(outC - start));\n        }\n      ")}}class W2{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);const r=e.length,a=C$(r),i=t.map(e=>e[0]).join(","),o=t.map((t,n)=>t[0]+e[n]).join(","),s=KJ("rc",r),l=KJ("source",r),c="".concat(s[r-1]," < ").concat(this.outputShape[r-1]),u=1===r?"source":"vec2(".concat(l.slice(-2).join(),")"),h="reflect"===n?0:1;let d="";if(1===r){const e="\n        ".concat(a," source = rc;\n        if (source < start) {\n          source = start * 2 - source - ").concat(h,";\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ").concat(h,";\n        }\n        source -= start;\n      ");d="\n        ".concat(a," rc = outputLoc;\n        ").concat(e,"\n        result[0] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n        ").concat(s[r-1]," += 1;\n        if(").concat(c,") {\n          ").concat(e,"\n          result[1] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n        }\n      ")}else{const e="\n        ".concat(a," source = rc;\n        ").concat(a," lt = ").concat(a,"(lessThan(source, start));\n        ").concat(a," gte = ").concat(a,"(greaterThanEqual(source, end));\n        ").concat(a," orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ").concat(h,") +\n                gte * ((end - 1) * 2 - source + ").concat(h,");\n        source -= start;\n      ");d="\n        ".concat(a," rc = outputLoc;\n        ").concat(e,"\n        result[0] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n        ").concat(s[r-1]," += 1;\n        if(").concat(c,") {\n          ").concat(e,"\n          result[1] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n        }\n        rc = outputLoc;\n        ").concat(s[r-2]," += 1;\n        if(").concat(s[r-2]," < ").concat(this.outputShape[r-2],") {\n          ").concat(e,"\n          result[2] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n          ").concat(s[r-1]," += 1;\n          if(").concat(c,") {\n            ").concat(e,"\n            result[3] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n          }\n        }\n      ")}this.userCode="\n      const ".concat(a," start = ").concat(a,"(").concat(i,");\n      const ").concat(a," end = ").concat(a,"(").concat(o,");\n\n      void main() {\n        ").concat(a," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(d,"\n        setOutput(result);\n      }\n    ")}}const U2={kernelName:yS,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e;const{x:a}=t,{paddings:i,mode:o}=r,s=_k().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new W2(a.shape,i,o):new z2(a.shape,i,o);return n.runWebGLProgram(s,[a],a.dtype)}},V2=IQ({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  bvec4 isNaN = equal(b, vec4(0.0));\n  "+pQ+"\n  return result;\n"}),H2={kernelName:wS,backendName:"webgl",kernelFunc:V2};class G2{constructor(e,t,n){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(t-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(t-1,"));\n      }\n    ")}}const q2=IQ({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),K2={kernelName:IN,backendName:"webgl",kernelFunc:q2},X2="return a - b;",Y2=IQ({opSnippet:X2,packedOpSnippet:X2,supportsComplex:!0,cpuKernelImpl:WJ}),$2={kernelName:EC,backendName:"webgl",kernelFunc:Y2};function J2(e){const{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{dim:i}=r,o=rk([i],a.shape),s=C2({inputs:{x:a},backend:n,attrs:{reductionIndices:o,keepDims:!1}}),l=yA(s.shape,o),c=MQ({inputs:{x:s},backend:n,attrs:{shape:l}}),u=Y2({inputs:{a:a,b:c},backend:n}),h=m1({inputs:{x:u},backend:n}),d=GQ({inputs:{x:h},backend:n,attrs:{axis:o,keepDims:!1}}),f=MQ({inputs:{x:d},backend:n,attrs:{shape:l}}),p=q2({inputs:{a:h,b:f},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),p}const Q2={kernelName:fC,backendName:"webgl",kernelFunc:J2};const Z2={kernelName:kS,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{numSamples:i,seed:o,normalized:s}=r,l=s?a:J2({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),c=l.shape[0],u=l.shape[1],h=new G2(c,u,i),d=[[o]],f=n.runWebGLProgram(h,[l],"int32",d);return s||n.disposeIntermediateTensorInfo(l),f}},e4=tQ+"\n  return -x;\n";const t4={kernelName:SS,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])){const e=n.texData.get(r.dataId),[t,a]=yJ(e.values,r.shape,r.dtype);return n.makeTensorInfo(a,r.dtype,t)}let a;return a=_k().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new oQ(r.shape,"\n  vec4 result = -x;\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"):new eQ(r.shape,e4),n.runWebGLProgram(a,[r],r.dtype)}},n4=HR;const r4={kernelName:ES,backendName:"webgl",kernelFunc:function(e){VC("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:o,iouThreshold:s,scoreThreshold:l}=r,c=n.readSync(a.dataId),u=n.readSync(i.dataId),{selectedIndices:h}=n4(c,u,o,s,l);return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}},a4=GR;const i4={kernelName:_S,backendName:"webgl",kernelFunc:function(e){VC("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:o,iouThreshold:s,scoreThreshold:l,padToMaxOutputSize:c}=r,u=n.readSync(a.dataId),h=n.readSync(i.dataId),{selectedIndices:d,validOutputs:f}=a4(u,h,o,s,l,c);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}},o4=qR;const s4={kernelName:IS,backendName:"webgl",kernelFunc:function(e){VC("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:i}=t,{maxOutputSize:o,iouThreshold:s,scoreThreshold:l,softNmsSigma:c}=r,u=n.readSync(a.dataId),h=n.readSync(i.dataId),d=o,f=s,p=l,g=c,{selectedIndices:m,selectedScores:v}=o4(u,h,d,f,p,g);return[n.makeTensorInfo([m.length],"int32",new Int32Array(m)),n.makeTensorInfo([v.length],"float32",new Float32Array(v))]}};class l4{constructor(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(r,"), float(").concat(n,"),\n                      float(index == coords.y)));\n      }\n    ")}}const c4={kernelName:AS,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{indices:a}=t,{dtype:i,depth:o,onValue:s,offValue:l}=r,c=$w(a.shape),u=new l4(c,o,s,l),h=MQ({inputs:{x:a},backend:n,attrs:{shape:[c]}}),d=n.runWebGLProgram(u,[h],i);n.disposeIntermediateTensorInfo(h);const f=MQ({inputs:{x:d},backend:n,attrs:{shape:[...a.shape,o]}});return n.disposeIntermediateTensorInfo(d),f}};function u4(e){const{inputs:t,backend:n}=e,{x:r}=t;if("complex64"===r.dtype){const e=JZ({inputs:{input:r},backend:n}),t=u4({inputs:{x:e},backend:n}),a=d0({inputs:{input:r},backend:n}),i=u4({inputs:{x:a},backend:n}),o=bQ({inputs:{real:t,imag:i},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),o}return _1({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:n})}const h4={kernelName:PC,backendName:"webgl",kernelFunc:u4};const d4={kernelName:TS,backendName:"webgl",kernelFunc:function e(t){const{inputs:n,backend:r}=t,{x:a}=n;if("string"===a.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===a.dtype){const t=JZ({inputs:{input:a},backend:r}),n=e({inputs:{x:t},backend:r}),i=d0({inputs:{input:a},backend:r}),o=u4({inputs:{x:i},backend:r}),s=bQ({inputs:{real:n,imag:o},backend:r});return r.disposeIntermediateTensorInfo(t),r.disposeIntermediateTensorInfo(n),r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),s}return _1({attrs:{shape:a.shape,dtype:a.dtype,value:1},backend:r})}};const f4={kernelName:RS,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{axis:a}=r;if(1===t.length)return b1({inputs:{input:t[0]},backend:n,attrs:{dim:a}});const i=t[0].shape,o=t[0].dtype;t.forEach(e=>{Xw(i,e.shape,"All tensors passed to stack must have matching shapes"),Kw(o===e.dtype,()=>"All tensors passed to stack must have matching dtypes")});const s=[],l=t.map(e=>{const t=b1({inputs:{input:e},backend:n,attrs:{dim:a}});return s.push(t),t}),c=g0({inputs:l,backend:n,attrs:{axis:a}});return s.forEach(e=>n.disposeIntermediateTensorInfo(e)),c}};class p4{constructor(e,t,n){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);const r=e.length,a=C$(r),i=t.map(e=>e[0]).join(","),o=t.map((t,n)=>t[0]+e[n]).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?"\n      ".concat(a," start = ").concat(a,"(").concat(i,");\n      ").concat(a," end = ").concat(a,"(").concat(o,");\n\n      void main() {\n        ").concat(a," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ").concat(a," coords = outC - start;\n          setOutput(getX(").concat(s,"));\n        }\n      }\n    "):"\n        int start = ".concat(i,";\n        int end = ").concat(o,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ")}}class g4{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);const r=e.length,a=C$(r),i=t.map(e=>e[0]).join(","),o=t.map((t,n)=>t[0]+e[n]).join(","),s=KJ("rc",r),l=KJ("source",r),c="".concat(s[r-1]," < ").concat(this.outputShape[r-1]),u=1===r?"source":"vec2(".concat(l.slice(-2).join(),")"),h=["".concat(a," rc = outputLoc;"),"".concat(s[r-1]," += 1;\n       if(").concat(c,") {\n      "),1===r?"":"}\n       rc = outputLoc;\n       ".concat(s[r-2]," += 1;\n       if(").concat(s[r-2]," < ").concat(this.outputShape[r-2],") {"),1===r?"":"  ".concat(s[r-1]," += 1;\n         if(").concat(c,") {")],d=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let f="";for(let p=0,g=1===r?2:4;p<g;p++)f+="\n        ".concat(h[p],"\n        if (").concat(d,") {\n          result[").concat(p,"] = float(value);\n        } else {\n          ").concat(a," source = rc - start;\n          result[").concat(p,"] = getChannel(getX(").concat(l.join(),"), ").concat(u,");\n        }\n      ");f+=1===r?"} ":"}}",this.userCode="\n      const ".concat(a," start = ").concat(a,"(").concat(i,");\n      const ").concat(a," end = ").concat(a,"(").concat(o,");\n\n      void main() {\n        ").concat(a," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(f,"\n        setOutput(result);\n      }\n    ")}}const m4=e=>{const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{paddings:i,constantValue:o}=r;if(0===$w(a.shape)){const e=i.map((e,t)=>e[0]+a.shape[t]+e[1]);return _1({backend:n,attrs:{shape:e,value:o,dtype:a.dtype}})}const s=_k().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new g4(a.shape,i,o):new p4(a.shape,i,o),l=[[o]];return n.runWebGLProgram(s,[a],a.dtype,l)},v4={kernelName:DS,backendName:"webgl",kernelFunc:m4},b4=IQ({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  bvec4 isNaN1 = lessThan(a, vec4(0.0));\n  bvec4 isNaN2 = lessThan(floor(b), b);\n  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);\n  "+pQ+"\n  return result;\n"}),x4={kernelName:FS,backendName:"webgl",kernelFunc:b4};const y4={kernelName:LS,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:i,keepDims:o}=r,s=a.shape.length,l=[],c=rk(i,a.shape);let u=c;const h=kA(u,s);let d,f=a;if(null!=h&&(f=KQ({inputs:{x:a},backend:n,attrs:{perm:h}}),u=SA(u.length,s),l.push(f)),wA("prod",u,s),n.shouldExecuteOnCPU([f])){const e=n.texData.get(f.dataId).values,{outVals:t,outShape:r,outDtype:a}=kJ(f.shape,f.dtype,e,u);d=n.makeTensorInfo(r,a,t)}else{const[e,t]=xA(f.shape,u),r=$w(t),i=MQ({inputs:{x:f},backend:n,attrs:{shape:[-1,r]}}),o=WQ(i,VE(a.dtype),"prod",n);d=MQ({inputs:{x:o},backend:n,attrs:{shape:e}}),l.push(i),l.push(o)}if(o){l.push(d);const e=yA(d.shape,c);d=MQ({inputs:{x:d},backend:n,attrs:{shape:e}})}return l.forEach(e=>n.disposeIntermediateTensorInfo(e)),d}};const w4={kernelName:PS,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:a,paramsDenseValues:i,indices:o}=t,{outputRaggedRank:s}=r,l=a.map(e=>n.readSync(e.dataId)),c=a.map(e=>e.shape),u=n.readSync(i.dataId),h=n.readSync(o.dataId),[d,f,p]=NJ(l,c,u,i.shape,i.dtype,h,o.shape,s),g=d.map(e=>n.makeTensorInfo([e.length],"int32",e)),m=n.makeTensorInfo(p,i.dtype,f);return g.concat([m])}};const k4={kernelName:MS,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{starts:r,limits:a,deltas:i}=t,o=n.readSync(r.dataId),s=n.readSync(a.dataId),l=n.readSync(i.dataId),[c,u]=SJ(o,r.shape,r.dtype,s,a.shape,l,i.shape);return[n.makeTensorInfo([c.length],"int32",c),n.makeTensorInfo([u.length],r.dtype,u)]}};const N4={kernelName:jS,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{shape:a,values:i,defaultValue:o,rowPartitionTensors:s}=t,{rowPartitionTypes:l}=r,c=n.readSync(a.dataId),u=n.readSync(i.dataId),h=n.readSync(o.dataId),d=s.map(e=>n.readSync(e.dataId)),f=s.map(e=>e.shape),[p,g]=CJ(c,a.shape,u,i.shape,i.dtype,h,o.shape,d,f,l);return n.makeTensorInfo(p,i.dtype,g)}},S4=e=>{const{backend:t,attrs:n}=e,{start:r,stop:a,step:i,dtype:o}=n,s=EJ(r,a,i,o);return t.makeTensorInfo([s.length],o,s)},C4={kernelName:BS,backendName:"webgl",kernelFunc:S4},E4=_Q({opSnippet:"return 1.0 / x;"}),_4={kernelName:WS,backendName:"webgl",kernelFunc:E4},I4=_Q({opSnippet:tQ+"\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),T4={kernelName:US,backendName:"webgl",kernelFunc:I4},A4=_Q({opSnippet:tQ+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),R4={kernelName:XS,backendName:"webgl",kernelFunc:A4};class D4{constructor(e,t,n,r,a){this.variableNames=["A"],this.outputShape=[];const[i,o,s,l]=e;this.outputShape=[i,t,n,l];const c=[r&&t>1?o-1:o,r&&n>1?s-1:s],u=[r&&t>1?t-1:t,r&&n>1?n-1:n];let h;h=a?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(c[0]/u[0],",\n          ").concat(c[1]/u[1],");\n      const vec2 inputShapeRC = vec2(").concat(o,".0, ").concat(s,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")}}class F4{constructor(e,t,n,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,o,s,l]=e;this.outputShape=[i,t,n,l];const c=[r&&t>1?o-1:o,r&&n>1?s-1:s],u=[r&&t>1?t-1:t,r&&n>1?n-1:n];let h;h=a?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(c[0]/u[0],",\n          ").concat(c[1]/u[1],",\n          ").concat(c[1]/u[1],");\n      const vec3 inputShapeRC = vec3(").concat(o,".0, ").concat(s,".0,\n                                     ").concat(s,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(l-1,";\n        bool hasNextRow = coords.z < ").concat(n-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")}}const O4={kernelName:qS,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:a}=t,{alignCorners:i,halfPixelCenters:o,size:s}=r,[l,c]=s,u=_k().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new F4(a.shape,l,c,i,o):new D4(a.shape,l,c,i,o);return n.runWebGLProgram(u,[a],"float32")}};class L4{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,r,a]=t,[,i,o]=e,s=[n&&i>1?r-1:r,n&&o>1?a-1:a],l=[n&&i>1?i-1:i,n&&o>1?o-1:o],c=s[0]/l[0],u=s[1]/l[1],h=1/c,d=1/u,f=2*Math.ceil(h)+2,p=2*Math.ceil(d)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(c,");\n        const float widthScale = float(").concat(u,");\n\n        const float invHeightScale = float(").concat(h,");\n        const float invWidthScale = float(").concat(d,");\n\n        const int winHeight = int(").concat(f,");\n        const int winWidth = int(").concat(p,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(i,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(o,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(r-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(a-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}}const P4={kernelName:KS,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:a,dy:i}=t,{alignCorners:o}=r,s=new L4(i.shape,a.shape,o);return n.runWebGLProgram(s,[i],i.dtype)}};class M4{constructor(e,t,n,r,a){this.variableNames=["A"],this.outputShape=[];const[i,o,s,l]=e;this.outputShape=[i,t,n,l];const c=[r&&t>1?o-1:o,r&&n>1?s-1:s],u=[r&&t>1?t-1:t,r&&n>1?n-1:n],h=r?"0.5":"0.0";let d;d=a?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(c[0]/u[0],",\n          ").concat(c[1]/u[1],");\n      const vec2 inputShapeRC = vec2(").concat(o,".0, ").concat(s,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(d,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(h,")));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")}}class j4{constructor(e,t,n,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,o,s,l]=e;this.outputShape=[i,t,n,l];const c=[r&&t>1?o-1:o,r&&n>1?s-1:s],u=[r&&t>1?t-1:t,r&&n>1?n-1:n],h=r?"0.5":"0.0";let d;d=a?"max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(c[0]/u[0],",\n          ").concat(c[1]/u[1],",\n          ").concat(c[1]/u[1],");\n      const vec3 inputShapeRC = vec3(").concat(o,".0, ").concat(s,".0,\n                                     ").concat(s,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(d,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(h,")));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(l-1,";\n        bool hasNextRow = coords.z < ").concat(n-1,";\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    ")}}const B4={kernelName:HS,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:a}=t,{alignCorners:i,halfPixelCenters:o,size:s}=r,[l,c]=s,u=_k().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new j4(a.shape,l,c,i,o):new M4(a.shape,l,c,i,o);return n.runWebGLProgram(u,[a],a.dtype)}};class z4{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,r,a]=t,[,i,o]=e,s=[n&&i>1?r-1:r,n&&o>1?a-1:a],l=[n&&i>1?i-1:i,n&&o>1?o-1:o],c=s[0]/l[0],u=s[1]/l[1],h=1/c,d=1/u,f=2*Math.ceil(h)+2,p=2*Math.ceil(d)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(c,");\n        const float widthScale = float(").concat(u,");\n\n        const float invHeightScale = float(").concat(h,");\n        const float invWidthScale = float(").concat(d,");\n\n        const int winHeight = int(").concat(f,");\n        const int winWidth = int(").concat(p,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(i,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(o,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(s[0],") *\n                (float(dyR) / float(").concat(l[0],"));\n\n            float sourceFracCol =\n                float(").concat(s[1],") *\n                  (float(dyC) / float(").concat(l[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(r,") - 1),\n                ").concat(n," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(a,") - 1),\n                ").concat(n," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}}const W4={kernelName:GS,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:a,dy:i}=t,{alignCorners:o}=r,s=new z4(i.shape,a.shape,o);return n.runWebGLProgram(s,[i],i.dtype)}};class U4{constructor(e,t){this.variableNames=["x"];const n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));if(this.outputShape=e,1===n)return void(this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(e[0]," - coord - 1));\n        }\n      "));const r=e.map((n,r)=>(n=>-1!==t.indexOf(n)&&1!==e[n]?"".concat(e[n]," - coords[").concat(n,"] - 1"):"coords[".concat(n,"]"))(r)).join(","),a=C$(n);this.userCode="\n      void main() {\n        ".concat(a," coords = getOutputCoords();\n        setOutput(getX(").concat(r,"));\n      }\n    ")}}class V4{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));this.outputShape=e;const r=KJ("rc",n),a="".concat(r[n-1]," + 1 < ").concat(this.outputShape[n-1]),i="".concat(r[n-2]," + 1 < ").concat(this.outputShape[n-2]),o=C$(n);function s(n){const r=e.map((r,a)=>function(n,r){return-1!==t.indexOf(n)&&1!==e[n]?"".concat(e[n]," - ").concat(r[n]," - 1"):"".concat(r[n])}(a,n)),a=r.join(","),i=r.slice(-2).join(",");return"getChannel(getX(".concat(a,"), vec2(").concat(i,"))")}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(e[0]," - rc - 1),\n            ").concat(e[0]," - rc - 1);\n          if(").concat(a,"){\n              result.g = getChannel(getX(").concat(e[0]," - (rc  + 1) - 1),\n                ").concat(e[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):"\n        void main() {\n          ".concat(o," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat(function(e){return s(e)}(r.slice()),";\n          if(").concat(a,"){\n            result.g = ").concat(function(e){return e[n-1]="("+e[n-1]+" + 1)",s(e)}(r.slice()),";\n          }\n          if(").concat(i,") {\n            result.b = ").concat(function(e){return e[n-2]="("+e[n-2]+" + 1)",s(e)}(r.slice()),";\n            if(").concat(a,") {\n              result.a = ").concat(function(e){return e[n-1]="("+e[n-1]+" + 1)",e[n-2]="("+e[n-2]+" + 1)",s(e)}(r.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ")}}const H4={kernelName:YS,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{dims:i}=r,o=a.shape.length,s=rk(i,a.shape);if(0===o)return mQ({inputs:{x:a},backend:n});const l=_k().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new V4(a.shape,s):new U4(a.shape,s);return n.runWebGLProgram(l,[a],a.dtype)}};class G4{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const n=e[1],r=e[2];this.outputShape=e;let a="";a="number"===typeof t?"float outputValue = ".concat(t.toFixed(2),";"):"\n        vec3 fill = vec3(".concat(t.join(","),");\n        float outputValue = fill[coords[3]];"),this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ".concat(a,"\n          if(coordX >= 0 && coordX < ").concat(r," && coordY >= 0 && coordY < ").concat(n,") {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}}const q4={kernelName:BC,backendName:"webgl",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{image:a}=t,{radians:i,fillValue:o,center:s}=n,l=r,c=new G4(a.shape,o),[u,h]=DD(s,a.shape[1],a.shape[2]),d=[[u,h,Math.sin(i),Math.cos(i)]];return l.runWebGLProgram(c,[a],a.dtype,d)}},K4=_Q({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),X4={kernelName:$S,backendName:"webgl",kernelFunc:K4},Y4=_Q({opSnippet:"return inversesqrt(x);",cpuKernelImpl:_J}),$4={kernelName:JS,backendName:"webgl",kernelFunc:Y4};class J4{constructor(e,t,n,r,a,i){let o=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;const s=C$(a.length),l=C$(i.length);let c="";1===n?c="i":2===n&&(c="i, j");const u="getIndices(".concat(c,")");let h="";1===r?h="i":2===r&&(h="i, coords[1]");const d="getUpdates(".concat(h,")");let f="";o&&(f="coords[0], coords[1]");const p="getDefaultValue(".concat(f,")"),g=t>1?"strides[j]":"strides";this.userCode="\n        ".concat(s," strides = ").concat(s,"(").concat(a,");\n\n        void main() {\n          ").concat(l," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(e,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(t,"; j++) {\n              int index = round(").concat(u,");\n              flattenedIndex += index * ").concat(g,";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ").concat(d,";\n              found = true;\n            }\n          }\n          setOutput(mix(").concat(p,", sum, float(found)));\n        }\n      ")}}class Q4{constructor(e,t,n,r,a,i){let o=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i;const s=C$(a.length),l=C$(i.length);let c="";1===n?c="i":2===n&&(c="i, j");const u="getIndices(".concat(c,")");let h="";1===r?h="i":2===r&&(h="i, coords[1]");const d="getUpdates(".concat(h,")");let f="";o&&(f="coords[0], coords[1]");const p="getDefaultValue(".concat(f,")"),g=t>1?"strides[j]":"strides",m=t>1?"strides[j + 1]":"strides";this.userCode="\n        ".concat(s," strides = ").concat(s,"(").concat(a,");\n\n        void main() {\n          ").concat(l," coords = getOutputCoords();\n          vec4 sum = vec4(0.);\n          vec4 found = vec4(0.);\n          for (int i = 0; i < ").concat(e,"; i+=2) {\n            ivec2 flattenedIndex = ivec2(0);\n            for (int j = 0; j < ").concat(t,"; j+=2) {\n              ivec4 index = round(").concat(u,");\n              flattenedIndex += index.xz * ").concat(g,";\n              if (j + 1 < ").concat(t,") {\n                flattenedIndex += index.yw * ").concat(m,";\n              }\n            }\n            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||\n                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {\n              vec4 updVals = ").concat(d,";\n              if (flattenedIndex[0] == coords[0]) {\n                sum.xy += updVals.xy;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[0] == coords[0] + 1) {\n                sum.zw += updVals.xy;\n                found.zw = vec2(1.);\n              }\n              if (flattenedIndex[1] == coords[0]) {\n                sum.xy += updVals.zw;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[1] == coords[0] + 1) {\n                sum.zw += updVals.zw;\n                found.zw = vec2(1.);\n              }\n            }\n          }\n          setOutput(mix(").concat(p,", sum, found));\n        }\n      ")}}const Z4={kernelName:QS,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{indices:a,updates:i}=t,{shape:o}=r,{sliceRank:s,numUpdates:l,sliceSize:c,strides:u,outputSize:h}=WD(0,a,o),d=[h/c,c];if(0===h)return n.makeTensorInfo(o,a.dtype);const f=MQ({inputs:{x:a},backend:n,attrs:{shape:[l,s]}}),p=MQ({inputs:{x:i},backend:n,attrs:{shape:[l,c]}}),g=n.makeTensorInfo([],"float32",new Float32Array([0]));let m;m=_k().getBool("WEBGL_PACK")?new Q4(l,s,f.shape.length,p.shape.length,u,d):new J4(l,s,f.shape.length,p.shape.length,u,d);const v=n.runWebGLProgram(m,[p,f,g],p.dtype),b=MQ({inputs:{x:v},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(g),b}};class e3{constructor(e,t,n,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,n];const a="for (int i = 0; i < ".concat(Math.ceil(Math.log2(t+1)),"; ++i) { if (left >= right) break;"),i=2===_k().getNumber("WEBGL_VERSION")?"while (left < right) {":a,o="left"===r?"<":"<=";this.userCode="\n       int findBound(int batch, float value) {\n         int left = 0;\n         int right = numInputs;\n         int mid;\n         ".concat(i,"\n           mid = (left + right) / 2;\n           if (getSortedSequence(batch, mid) ").concat(o," value) {\n             left = mid + 1;\n           } else {\n             right = mid;\n           }\n         }\n         return right;\n       }\n\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int valueIndex = coords[1];\n\n         float value = getValues(batch, valueIndex);\n\n         setOutput(float(findBound(batch, value)));\n       }\n     ")}}const t3={kernelName:eC,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{sortedSequence:a,values:i}=t,{side:o}=r,s=new e3(a.shape[0],a.shape[1],i.shape[1],o),l=[[a.shape[1]]];return n.runWebGLProgram(s,[a,i],"int32",l)}};class n3{constructor(e,t,n){let r,a;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank ".concat(n," is not yet supported"));if(1===n)a="resRC",r="resRC";else{const n=["resRC.x","resRC.y","resRC.z","resRC.w"],i=[],o=[];for(let r=0;r<t.length;r++)o.push("".concat(n[r])),r<e&&i.push("".concat(n[r]));r=i.join(),a=o.join()}const i=C$(n);this.userCode="\n      void main() {\n        ".concat(i," resRC = getOutputCoords();\n        float cVal = getC(").concat(r,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(a,"));\n        } else {\n          setOutput(getB(").concat(a,"));\n        }\n      }\n    ")}}const r3={kernelName:tC,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{condition:r,t:a,e:i}=t,o=new n3(r.shape.length,a.shape,a.shape.length);return n.runWebGLProgram(o,[r,a,i],UE(a.dtype,i.dtype))}},a3=_Q({opSnippet:"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat(UD,";\n  float scale = ").concat(VD,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n")}),i3={kernelName:nC,backendName:"webgl",kernelFunc:a3},o3=_Q({opSnippet:EQ+"\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",packedOpSnippet:"\n  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:TJ}),s3={kernelName:sC,backendName:"webgl",kernelFunc:o3},l3=_Q({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),c3={kernelName:oC,backendName:"webgl",kernelFunc:l3},u3=_Q({opSnippet:EQ+"\n  return sin(x);\n",packedOpSnippet:"\n  vec4 result = sin(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(pQ,"\n  return result;\n")}),h3={kernelName:aC,backendName:"webgl",kernelFunc:u3},d3=_Q({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),f3={kernelName:iC,backendName:"webgl",kernelFunc:d3},p3=_Q({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),g3={kernelName:lC,backendName:"webgl",kernelFunc:p3},m3={kernelName:hC,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:i,paddings:o}=r;Kw(a.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const s=i.reduce((e,t)=>e*t),l=[[0,0]];l.push(...o);for(let v=1+i.length;v<a.shape.length;++v)l.push([0,0]);const c=[],u=m4({inputs:{x:a},backend:n,attrs:{paddings:l,constantValue:0}}),h=FD(u.shape,i,s,!1),d=OD(h.length,i.length,!1),f=LD(u.shape,i,s,!1),p=MQ({inputs:{x:u},backend:n,attrs:{shape:h}}),g=KQ({inputs:{x:p},backend:n,attrs:{perm:d}}),m=MQ({inputs:{x:g},backend:n,attrs:{shape:f}});return c.push(u),c.push(p),c.push(g),c.forEach(e=>n.disposeIntermediateTensorInfo(e)),m}};const v3={kernelName:pC,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{indices:r,values:a,denseShape:i,defaultValue:o}=t;if(1!==i.shape.length)throw new Error("Dense shape must be a vector, saw:\n         ".concat(i.shape));if(2!==r.shape.length)throw new Error("Indices must be a matrix, saw:\n         ".concat(r.shape));if(1!==a.shape.length)throw new Error("Values must be a vector, saw:\n         ".concat(a.shape));if(0!==o.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(o.shape));const s=n.readSync(r.dataId),l=n.readSync(a.dataId),c=n.readSync(i.dataId),u=n.readSync(o.dataId)[0],[h,d,f,p,g]=DJ(s,r.shape,r.dtype,l,a.dtype,c,u);return[n.makeTensorInfo(d,r.dtype,h),n.makeTensorInfo([d[0]],a.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(e=>Number(e)))),n.makeTensorInfo([g.length],r.dtype,new Int32Array(g))]}};const b3={kernelName:gC,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{inputIndices:r,inputShape:a,newShape:i}=t;if(2!==r.shape.length)throw new Error("Input indices should be a matrix but received shape ".concat(r.shape));if(1!==a.shape.length)throw new Error("Input shape should be a vector but received shape ".concat(a.shape));if(1!==i.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(i.shape));const o=Array.from(n.readSync(a.dataId)),s=n.readSync(r.dataId),l=Array.from(n.readSync(i.dataId)),[c,u,h]=FJ(s,r.shape,r.dtype,o,l);return[n.makeTensorInfo(u,r.dtype,c),n.makeTensorInfo([h.length],i.dtype,new Int32Array(h))]}};const x3={kernelName:mC,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{data:r,indices:a,segmentIds:i}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n              ".concat(a.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n              ".concat(i.shape));const o=n.readSync(r.dataId),s=n.readSync(a.dataId),l=n.readSync(i.dataId),[c,u]=OJ(o,r.shape,r.dtype,s,l,!0);return n.makeTensorInfo(u,r.dtype,c)}};const y3={kernelName:vC,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{data:r,indices:a,segmentIds:i}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n             ".concat(a.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n             ".concat(i.shape));const o=n.readSync(r.dataId),s=n.readSync(a.dataId),l=n.readSync(i.dataId),[c,u]=OJ(o,r.shape,r.dtype,s,l);return n.makeTensorInfo(u,r.dtype,c)}};const w3={kernelName:bC,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{sparseIndices:a,sparseValues:i,defaultValue:o}=t,{outputShape:s}=r,{sliceRank:l,numUpdates:c,sliceSize:u,strides:h,outputSize:d}=WD(0,a,s),f=!1;if("string"===i.dtype){const e=n.bufferSync(a),t=n.bufferSync(i),r=bE(n.readSync(o.dataId)[0]),p=IJ(e,t,s,d,u,c,l,h,r,f);return n.makeTensorInfo(s,p.dtype,p.values)}const p=new J4(c,l,a.shape.length,i.shape.length,h,[d,1],f),g=n.runWebGLProgram(p,[i,a,o],i.dtype),m=MQ({inputs:{x:g},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(g),m}};const k3={kernelName:dC,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{numOrSizeSplits:i,axis:o}=r,s=rk(o,a.shape)[0],l=pF(a,i,s),c=a.shape.length,u=new Array(c).fill(0),h=a.shape.slice();return l.map(e=>{const t=[...h];t[s]=e;const r=VZ({inputs:{x:a},backend:n,attrs:{begin:u,size:t}});return u[s]+=e,r})}},N3="return sqrt(x);",S3=_Q({opSnippet:N3,packedOpSnippet:N3,cpuKernelImpl:LJ}),C3={kernelName:cC,backendName:"webgl",kernelFunc:S3},E3={kernelName:yC,backendName:"webgl",kernelFunc:_Q({opSnippet:"return x * x;"})},_3="return (a - b) * (a - b);",I3=IQ({opSnippet:_3,packedOpSnippet:_3}),T3={kernelName:xC,backendName:"webgl",kernelFunc:I3};const A3={kernelName:wC,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t;if("string"!==a.dtype)throw new Error("Input must be of datatype string");const i=AF(n.readSync(a.dataId)),o=PJ(i,"string",r);return n.makeTensorInfo(a.shape,"string",o)}};const R3={kernelName:MC,backendName:"webgl",kernelFunc:function(e){let{inputs:t,attrs:n,backend:r}=e;const{x:a}=t,i=tQ+"\n    return x > 0.0 ? 1.0 : float(".concat(n.alpha,");\n  "),o=new eQ(a.shape,i);return r.runWebGLProgram(o,[a],a.dtype)}};class D3{constructor(e,t,n){this.variableNames=["x"],this.outputShape=n;const r=n.length,a=C$(n.length),i=C$(n.length);let o="";if(1===r)o="coords * strides + begin";else{let e=0;o=n.map((t,r)=>(e++,1===n.length?"coords * strides[".concat(r,"] + begin[").concat(r,"]"):"coords[".concat(e-1,"] * strides[").concat(r,"] + begin[").concat(r,"]"))).join(",")}this.userCode="\n      ".concat(a," begin = ").concat(a,"(").concat(e,");\n      ").concat(a," strides = ").concat(a,"(").concat(t,");\n\n      void main() {\n        ").concat(i," coords = getOutputCoords();\n        setOutput(getX(").concat(o,"));\n      }\n    ")}}const F3={kernelName:kC,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{begin:i,end:o,strides:s,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:h,shrinkAxisMask:d}=r,{finalShapeSparse:f,finalShape:p,isIdentity:g,sliceDim0:m,isSimpleSlice:v,begin:b,end:x,strides:y}=hT(a.shape,i,o,s,l,c,u,h,d);let w;if(g)w=MQ({inputs:{x:a},backend:n,attrs:{shape:p}});else if(m||v){Kw(a.shape.length>=1,()=>"Input must have rank at least 1, got: ".concat(a.shape.length));const e=QI(b,x,y),t=VZ({inputs:{x:a},backend:n,attrs:{begin:b,size:e}});w=MQ({inputs:{x:t},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(t)}else{if(n.shouldExecuteOnCPU([a])){const e=n.readSync(a.dataId),t=iI(a.shape,a.dtype,e),r=MJ(f,t,y,b);w=n.makeTensorInfo(p,a.dtype,r.values)}else{const e=new D3(b,y,f);w=n.runWebGLProgram(e,[a],a.dtype)}}const k=MQ({inputs:{x:w},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(w),k}};const O3={kernelName:NC,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{separator:a,nGramWidths:i,leftPad:o,rightPad:s,padWidth:l,preserveShortSequences:c}=r,{data:u,dataSplits:h}=t,d=n.readSync(u.dataId),f=n.readSync(h.dataId),[p,g]=jJ(d,f,a,i,o,s,l,c);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(h.shape,"int32",g)]}};const L3={kernelName:SC,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{skipEmpty:a}=r,{input:i,delimiter:o}=t;if("string"!==i.dtype)throw new Error("Input must be of datatype string");if(1!==i.shape.length)throw new Error("Input must be a vector, got shape: ".concat(i.shape));if(0!==o.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(o.shape));const s=n.readSync(i.dataId),l=n.readSync(o.dataId)[0],[c,u,h]=BJ(s,l,a),d=u.length;return[n.makeTensorInfo([d,2],"int32",c),n.makeTensorInfo([d],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(h))]}};const P3={kernelName:CC,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{numBuckets:a}=r,{input:i}=t;if("string"!==i.dtype)throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");const o=n.readSync(i.dataId),s=zJ(o,a);return n.makeTensorInfo(i.shape,"int32",s)}},M3=_Q({opSnippet:"return tan(x);"}),j3={kernelName:_C,backendName:"webgl",kernelFunc:M3},B3=_Q({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),z3={kernelName:IC,backendName:"webgl",kernelFunc:B3};const W3={kernelName:ZS,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{tensor:a,indices:i,updates:o}=t,{}=r,{sliceRank:s,numUpdates:l,sliceSize:c,strides:u,outputSize:h}=WD(0,i,a.shape),d=[h/c,c];if(0===h)return n.makeTensorInfo(a.shape,i.dtype);const f=MQ({inputs:{x:i},backend:n,attrs:{shape:[l,s]}}),p=MQ({inputs:{x:o},backend:n,attrs:{shape:[l,c]}}),g=MQ({inputs:{x:a},backend:n,attrs:{shape:d}}),m=new J4(l,s,f.shape.length,p.shape.length,u,d,!1,!0),v=n.runWebGLProgram(m,[p,f,g],g.dtype),b=MQ({inputs:{x:v},backend:n,attrs:{shape:a.shape}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(v),b}};class U3{constructor(e,t){this.variableNames=["A"];const n=new Array(e.length);for(let i=0;i<n.length;i++)n[i]=e[i]*t[i];this.outputShape=n,this.rank=n.length;const r=C$(this.rank),a=function(e){const t=e.length;if(t>5)throw Error("Tile for rank ".concat(t," is not yet supported"));if(1===t)return"imod(resRC, ".concat(e[0],")");const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let a=0;a<e.length;a++)r.push("imod(".concat(n[a],", ").concat(e[a],")"));return r.join()}(e);this.userCode="\n      void main() {\n        ".concat(r," resRC = getOutputCoords();\n        setOutput(getA(").concat(a,"));\n      }\n    ")}}function V3(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{reps:i}=r;if("string"===a.dtype||a.shape.length>5){const e=n.readSync(a.dataId),t="string"===a.dtype?e.map(e=>bE(e)):e,r=iI(a.shape,a.dtype,t),o=UJ(r,i);return n.makeTensorInfo(o.shape,o.dtype,o.values)}const o=new U3(a.shape,i);return n.runWebGLProgram(o,[a],a.dtype)}const H3={kernelName:TC,backendName:"webgl",kernelFunc:V3};class G3{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode="\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // We compare elements pair-wise within a group of size 2 * inc.\n         // The comparing rule for each group alternates between ascending\n         // and descending. Within each group, we compare each pair at\n         // positions i and i+inc. To decide whether an element at position i\n         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n         // inc, it is in the first half of the group, we denote it as x0,\n         // otherwise we denote it as x1.\n         // For example, as shown in the Bitonic top K paper referenced above,\n         // Figure5(a) shows that element[1] is in the\n         // second half of the group when group size is 2, but it is in the\n         // first half of the group when group size is 4.\n\n         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;\n         int i = isFirstInPair ? elemIdx : elemIdx - inc;\n\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));\n         float x0 = i0 < n ? getX(batch, i0) : negativeInf;\n         float x1 = i1 < n ? getX(batch, i1) : negativeInf;\n\n         // Denotes which direction indices are in (ascending or descending).\n         bool reverse = imod(elemIdx, 2 * dir) >= dir;\n         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n         if (reverse == isGreater) { // Elements in opposite order of direction\n           int iTemp = i0;\n           i0 = i1;\n           i1 = iTemp;\n         }\n         if (isFirstInPair) {\n            setOutput(float(i0));\n         } else {\n            setOutput(float(i1));\n         }\n       }\n     "}}class q3{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode="\n    void main() {\n         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // The output size is half of the previous size.\n         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),\n         // we only need to output the indices at positions |, the indices at\n         // positions _ can be thrown away, see Figure5(b) After Phase 2\n         // (Merge phase) in the Bitonic Top K paper referenced above.\n         // For example, the paper shows we only need to output the orange bars.\n         // The output sequence should look like this | | | | | | | |.\n         // Because the sequence is halved, to map the output index back\n         // to the previous sequence to find the corresponding value,\n         // we need to double the index. When we double the index,\n         // we basically interpolate a position, so 2i looks like\n         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position\n         // of each 2k positions by - elemIdx % k. E.g. for output at\n         // index 4,5,6,7, we want to get the corresponding element at\n         // original index 8,9,10,11, for output at index 8,9,10,11,\n         // we want to get the corresponding element at original index\n         // 16,17,18,19, so on and so forth.\n\n         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));\n\n         float x0 = getX(batch, i0);\n         float x1 = i1 < n ? getX(batch, i1) : x0;\n\n         setOutput(x0 >= x1 ? float(i0) : float(i1));\n       }\n     "}}function K3(e,t){null!==t&&e.disposeIntermediateTensorInfo(t)}function X3(e){let t=1;for(;t<e;)t*=2;return t}const Y3={kernelName:AC,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{k:i,sorted:o}=r,s=_k().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=_k().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=a.shape,u=c[c.length-1];if(n.shouldExecuteOnCPU([a])||u<s||i>l){const e=n.readSync(a.dataId),[t,r]=VJ(e,c,a.dtype,i,o);return[n.makeTensorInfo(t.shape,t.dtype,t.values),n.makeTensorInfo(r.shape,r.dtype,r.values)]}if(0===i)return c[c.length-1]=0,[n.makeTensorInfo(c,a.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(1===u)return[a,_1({attrs:{shape:c,dtype:"int32",value:0},backend:n})];const h=n.texData.get(a.dataId),d=null!==h&&h.isPacked,f=d?n.unpackTensor(a):a,p=$w(c)/u,g=MQ({inputs:{x:f},attrs:{shape:[p,u]},backend:n});d&&K3(n,f);const m=X3(i),v=X3(u);let b=null;const x=()=>null===b?[g,g]:[g,b],y=(e,t,r)=>{const a=x(),i=new G3(r),o=[[u],[null===b?1:0],[Number.NEGATIVE_INFINITY],[e],[t]],s=b;b=n.runWebGLProgram(i,a,"int32",o),K3(n,s)};for(let C=1;C<m;C*=2){const e=2*C;for(let t=C;t>=1;t/=2)y(e,t,[p,v])}for(let C=v;C>m;C/=2){const e=x(),t=new q3([p,C/2]),r=[[u],[null===b?1:0],[m]],a=b;b=n.runWebGLProgram(t,e,"int32",r),K3(n,a);const i=m/2,o=2*i;for(let n=i;n>=1;n/=2)y(o,n,b.shape)}let w=b;b=VZ({inputs:{x:b},backend:n,attrs:{begin:0,size:[p,i]}}),K3(n,w);let k=q1({inputs:{x:g,indices:b},backend:n,attrs:{axis:1,batchDims:1}});K3(n,g);const N=c.slice(0,-1);N.push(i),w=b,b=MQ({inputs:{x:b},attrs:{shape:N},backend:n}),K3(n,w);const S=k;return k=MQ({inputs:{x:k},attrs:{shape:N},backend:n}),K3(n,S),[k,b]}};class $3{constructor(e,t,n,r,a,i){this.variableNames=["Image","Transforms"],this.outputShape=i;const o="nearest"===n?1:2;let s;switch(r){case"constant":default:s=1;break;case"reflect":s=2;break;case"wrap":s=3;break;case"nearest":s=4}this.userCode="\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(".concat(s," == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ").concat(e," && 0 <= coordX && coordX < ").concat(t,") {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(").concat(a,");\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(").concat(a,");\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(").concat(t,"));\n                float mapY = mapCoord(inY, float(").concat(e,"));\n\n                if (").concat(o," == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        ")}}const J3={kernelName:RC,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{image:a,transforms:i}=t,{interpolation:o,fillMode:s,fillValue:l,outputShape:c}=r,[u,h,d,f]=a.shape,[p,g]=null!=c?c:[h,d],m=new $3(h,d,o,s,l,[u,p,g,f]);return n.runWebGLProgram(m,[a,i],"float32")}};const Q3={kernelName:FC,backendName:"webgl",kernelFunc:function(e){const{inputs:t,attrs:n,backend:r}=e,{axis:a}=n,{x:i}=t;s$(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=r.readSync(i.dataId),{outputValues:s,outputShape:l,indices:c}=GJ(o,a,i.shape,i.dtype);return[r.makeTensorInfo(l,i.dtype,s),r.makeTensorInfo([c.length],"int32",c)]}};const Z3={kernelName:OC,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{value:a}=t;let{axis:i}=r;i<0&&(i+=a.shape.length);const o=a,s=o.shape.length,l=a.shape[i],c=new Array(s-1);let u=0;for(let g=0;g<s;g++)g!==i&&(c[u++]=o.shape[g]);const h=[],d=new Array(s).fill(0),f=o.shape.slice();f[i]=1;const p=new Array(l);for(let g=0;g<p.length;g++){d[i]=g;const e=VZ({inputs:{x:o},backend:n,attrs:{begin:d,size:f}}),t=MQ({inputs:{x:e},backend:n,attrs:{shape:c}});p[g]=t,h.push(e)}return h.forEach(e=>n.disposeIntermediateTensorInfo(e)),p}};class e5{constructor(e,t){this.variableNames=["x","segmentIds"];const n=e.windowSize,r=e.batchSize,a=e.inSize,i=e.numSegments,o=i*Math.ceil(a/n);this.outputShape=[r,o];const s=4*Math.floor(n/4),l=n%4,c="\n        sumValue += dot(values, segFilter);\n    ";let u="";a%n>0&&(u="\n        if (inIdx < 0 || inIdx >= ".concat(a,") {\n          return initializationValue;\n        }\n      "));let h="";a%n>0&&(h="\n        if (inIdx < 0 || inIdx >= ".concat(a,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat("0.0",";\n\n      float getValue(int batch, int inIdx) {\n        ").concat(u,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(h,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(i,")) * float(").concat(n,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(i,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(s,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(c,"\n        }\n\n        int inIdx = inOffset + ").concat(s,";\n        if (").concat(1===l,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(c,"\n        } else if (").concat(2===l,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(c,"\n        } else if (").concat(3===l,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(c,"\n        }\n        setOutput(").concat("sumValue",");\n      }\n    ")}}const t5={kernelName:LC,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,segmentIds:i}=t,{numSegments:o}=r,s=a.shape.length,l=[];let c=0;const u=kA([c],s);let h=a;null!=u&&(h=KQ({inputs:{x:a},backend:n,attrs:{perm:u}}),l.push(h),c=SA(1,s)[0]);const d=IF(h.shape,c,o),f=$w([h.shape[c]]),p=MQ({inputs:{x:h},backend:n,attrs:{shape:[-1,f]}});l.push(p);const g=VE(a.dtype),m=(e,t,r,a,i)=>{const o=e.shape[0],s=e.shape[1],c=_F(s,i),u=new e5({windowSize:c,inSize:s,batchSize:o,numSegments:i},t),h=n.compileAndRun(u,[e,r],a);if(l.push(h),h.shape[1]===i)return h;const d=S4({backend:n,attrs:{start:0,stop:i,step:1,dtype:"float32"}}),f=V3({inputs:{x:d},backend:n,attrs:{reps:[s/c]}});l.push(d),l.push(f);return m(h,t,f,a,i)},v=MQ({inputs:{x:m(p,"unsortedSegmentSum",i,g,o)},backend:n,attrs:{shape:d}});let b=v;if(null!=u){l.push(v);const e=NA(u);b=KQ({inputs:{x:b},backend:n,attrs:{perm:e}})}return l.forEach(e=>n.disposeIntermediateTensorInfo(e)),b}},n5=[$Q,QQ,eZ,nZ,iZ,lZ,cZ,uZ,mZ,vZ,xZ,wZ,NZ,CZ,_Z,AZ,RZ,OZ,LZ,PZ,BZ,GZ,qZ,KZ,XZ,ZZ,n0,i0,xQ,l0,m0,S0,T0,R0,D0,F0,O0,P0,j0,z0,q0,K0,X0,$0,Z0,n1,r1,i1,s1,l1,u1,h1,f1,g1,v1,x1,k1,C1,I1,A1,F1,L1,j1,W1,U1,H1,K1,Y1,J1,vQ,Q1,f0,e2,n2,a2,kQ,o2,l2,c2,h2,f2,g2,v2,x2,k2,S2,E2,I2,T2,A2,F2,O2,L2,P2,M2,B2,U2,H2,Z2,PQ,t4,r4,i4,s4,$Z,c4,d4,f4,v4,x4,CQ,y4,w4,k4,N4,C4,QZ,K2,_4,T4,R4,jQ,O4,P4,B4,W4,H4,q4,X4,$4,Z4,t3,r3,i3,s3,c3,h3,f3,HZ,Q2,g3,m3,v3,b3,x3,y3,w3,k3,C3,E3,T3,A3,R3,F3,O3,L3,P3,$2,qQ,j3,z3,W3,H3,Y3,J3,XQ,Q3,Z3,t5,h4];for(const n of n5)$C(n);var r5={version:"0.18.5"},a5=1200,i5=1252,o5=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],s5={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},l5=function(e){-1!=o5.indexOf(e)&&(i5=s5[0]=e)};var c5=function(e){a5=e,l5(e)};function u5(){c5(1200),l5(1252)}function h5(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n+1)+(e.charCodeAt(2*n)<<8));return t.join("")}var d5,f5=function(e){return String.fromCharCode(e)},p5=function(e){return String.fromCharCode(e)};var g5="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function m5(e){for(var t="",n=0,r=0,a=0,i=0,o=0,s=0,l=0,c=0;c<e.length;)i=(n=e.charCodeAt(c++))>>2,o=(3&n)<<4|(r=e.charCodeAt(c++))>>4,s=(15&r)<<2|(a=e.charCodeAt(c++))>>6,l=63&a,isNaN(r)?s=l=64:isNaN(a)&&(l=64),t+=g5.charAt(i)+g5.charAt(o)+g5.charAt(s)+g5.charAt(l);return t}function v5(e){var t="",n=0,r=0,a=0,i=0,o=0,s=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)n=g5.indexOf(e.charAt(l++))<<2|(i=g5.indexOf(e.charAt(l++)))>>4,t+=String.fromCharCode(n),r=(15&i)<<4|(o=g5.indexOf(e.charAt(l++)))>>2,64!==o&&(t+=String.fromCharCode(r)),a=(3&o)<<6|(s=g5.indexOf(e.charAt(l++))),64!==s&&(t+=String.fromCharCode(a));return t}var b5=function(){return"undefined"!==typeof Buffer&&"undefined"!==typeof process&&"undefined"!==typeof process.versions&&!!process.versions.node}(),x5=function(){if("undefined"!==typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(ci){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function y5(e){return b5?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function w5(e){return b5?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var k5=function(e){return b5?x5(e,"binary"):e.split("").map(function(e){return 255&e.charCodeAt(0)})};function N5(e){if("undefined"===typeof ArrayBuffer)return k5(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=255&e.charCodeAt(r);return t}function S5(e){if(Array.isArray(e))return e.map(function(e){return String.fromCharCode(e)}).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}var C5=b5?function(e){return Buffer.concat(e.map(function(e){return Buffer.isBuffer(e)?e:x5(e)}))}:function(e){if("undefined"!==typeof Uint8Array){var t=0,n=0;for(t=0;t<e.length;++t)n+=e[t].length;var r=new Uint8Array(n),a=0;for(t=0,n=0;t<e.length;n+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)r.set(e[t],n);else{if("string"==typeof e[t])throw"wtf";r.set(new Uint8Array(e[t]),n)}return r}return[].concat.apply([],e.map(function(e){return Array.isArray(e)?e:[].slice.call(e)}))};var E5=/\u0000/g,_5=/[\u0001-\u0006]/g;function I5(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function T5(e,t){var n=""+e;return n.length>=t?n:W6("0",t-n.length)+n}function A5(e,t){var n=""+e;return n.length>=t?n:W6(" ",t-n.length)+n}function R5(e,t){var n=""+e;return n.length>=t?n:n+W6(" ",t-n.length)}var D5=Math.pow(2,32);function F5(e,t){return e>D5||e<-D5?function(e,t){var n=""+Math.round(e);return n.length>=t?n:W6("0",t-n.length)+n}(e,t):function(e,t){var n=""+e;return n.length>=t?n:W6("0",t-n.length)+n}(Math.round(e),t)}function O5(e,t){return t=t||0,e.length>=7+t&&103===(32|e.charCodeAt(t))&&101===(32|e.charCodeAt(t+1))&&110===(32|e.charCodeAt(t+2))&&101===(32|e.charCodeAt(t+3))&&114===(32|e.charCodeAt(t+4))&&97===(32|e.charCodeAt(t+5))&&108===(32|e.charCodeAt(t+6))}var L5=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],P5=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var M5={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},j5={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},B5={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function z5(e,t,n){for(var r=e<0?-1:1,a=e*r,i=0,o=1,s=0,l=1,c=0,u=0,h=Math.floor(a);c<t&&(s=(h=Math.floor(a))*o+i,u=h*c+l,!(a-h<5e-8));)a=1/(a-h),i=o,o=s,l=c,c=u;if(u>t&&(c>t?(u=l,s=i):(u=c,s=o)),!n)return[0,r*s,u];var d=Math.floor(r*s/u);return[d,r*s-d*u,u]}function W5(e,t,n){if(e>2958465||e<0)return null;var r=0|e,a=Math.floor(86400*(e-r)),i=0,o=[],s={D:r,T:a,u:86400*(e-r)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(s.u)<1e-6&&(s.u=0),t&&t.date1904&&(r+=1462),s.u>.9999&&(s.u=0,86400==++a&&(s.T=a=0,++r,++s.D)),60===r)o=n?[1317,10,29]:[1900,2,29],i=3;else if(0===r)o=n?[1317,8,29]:[1900,1,0],i=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),r<60&&(i=(i+6)%7),n&&(i=function(e,t){t[0]-=581;var n=e.getDay();e<60&&(n=(n+6)%7);return n}(l,o))}return s.y=o[0],s.m=o[1],s.d=o[2],s.S=a%60,a=Math.floor(a/60),s.M=a%60,a=Math.floor(a/60),s.H=a,s.q=i,s}var U5=new Date(1899,11,31,0,0,0),V5=U5.getTime(),H5=new Date(1900,2,1,0,0,0);function G5(e,t){var n=e.getTime();return t?n-=1262304e5:e>=H5&&(n+=864e5),(n-(V5+6e4*(e.getTimezoneOffset()-U5.getTimezoneOffset())))/864e5}function q5(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function K5(e){var t,n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=n>=-4&&n<=-1?e.toPrecision(10+n):Math.abs(n)<=9?function(e){var t=e<0?12:11,n=q5(e.toFixed(12));return n.length<=t||(n=e.toPrecision(10)).length<=t?n:e.toExponential(5)}(e):10===n?e.toFixed(10).substr(0,12):function(e){var t=q5(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),q5(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function X5(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):K5(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return g6(14,G5(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Y5(e,t,n,r){var a,i="",o=0,s=0,l=n.y,c=0;switch(e){case 98:l=n.y+543;case 121:switch(t.length){case 1:case 2:a=l%100,c=2;break;default:a=l%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:a=n.m,c=t.length;break;case 3:return P5[n.m-1][1];case 5:return P5[n.m-1][0];default:return P5[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:a=n.d,c=t.length;break;case 3:return L5[n.q][0];default:return L5[n.q][1]}break;case 104:switch(t.length){case 1:case 2:a=1+(n.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:a=n.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:a=n.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==n.u||"s"!=t&&"ss"!=t?(s=r>=2?3===r?1e3:100:1===r?10:1,(o=Math.round(s*(n.S+n.u)))>=60*s&&(o=0),"s"===t?0===o?"0":""+o/s:(i=T5(o,2+r),"ss"===t?i.substr(0,2):"."+i.substr(2,t.length-1))):T5(n.S,t.length);case 90:switch(t){case"[h]":case"[hh]":a=24*n.D+n.H;break;case"[m]":case"[mm]":a=60*(24*n.D+n.H)+n.M;break;case"[s]":case"[ss]":a=60*(60*(24*n.D+n.H)+n.M)+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:a=l,c=1}return c>0?T5(a,c):""}function $5(e){if(e.length<=3)return e;for(var t=e.length%3,n=e.substr(0,t);t!=e.length;t+=3)n+=(n.length>0?",":"")+e.substr(t,3);return n}var J5=/%/g;function Q5(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+Q5(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),-1===(n=(t/Math.pow(10,i)).toPrecision(r+1+(a+i)%a)).indexOf("e")){var o=Math.floor(Math.log(t)*Math.LOG10E);for(-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(o-n.length+i):n+="E+"+(o-i);"0."===n.substr(0,2);)n=(n=n.charAt(0)+n.substr(2,a)+"."+n.substr(2+a)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,n,r){return t+n+r.substr(0,(a+i)%a)+"."+r.substr(i)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var Z5=/# (\?+)( ?)\/( ?)(\d+)/;var e6=/^#*0*\.([0#]+)/,t6=/\).*[0#]/,n6=/\(###\) ###\\?-####/;function r6(e){for(var t,n="",r=0;r!=e.length;++r)switch(t=e.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function a6(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function i6(e,t){var n=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(n*r)).length?0:Math.round(n*r)}function o6(e,t,n){if(40===e.charCodeAt(0)&&!t.match(t6)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?o6("n",r,n):"("+o6("n",r,-n)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,n){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return c6(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}(e,t,n);if(-1!==t.indexOf("%"))return function(e,t,n){var r=t.replace(J5,""),a=t.length-r.length;return c6(e,r,n*Math.pow(10,2*a))+W6("%",a)}(e,t,n);if(-1!==t.indexOf("E"))return Q5(t,n);if(36===t.charCodeAt(0))return"$"+o6(e,t.substr(" "==t.charAt(1)?2:1),n);var a,i,o,s,l=Math.abs(n),c=n<0?"-":"";if(t.match(/^00+$/))return c+F5(l,t.length);if(t.match(/^[#?]+$/))return"0"===(a=F5(n,0))&&(a=""),a.length>t.length?a:r6(t.substr(0,t.length-a.length))+a;if(i=t.match(Z5))return function(e,t,n){var r=parseInt(e[4],10),a=Math.round(t*r),i=Math.floor(a/r),o=a-i*r,s=r;return n+(0===i?"":""+i)+" "+(0===o?W6(" ",e[1].length+1+e[4].length):A5(o,e[1].length)+e[2]+"/"+e[3]+T5(s,e[4].length))}(i,l,c);if(t.match(/^#+0+$/))return c+F5(l,t.length-t.indexOf("0"));if(i=t.match(e6))return a=a6(n,i[1].length).replace(/^([^\.]+)$/,"$1."+r6(i[1])).replace(/\.$/,"."+r6(i[1])).replace(/\.(\d*)$/,function(e,t){return"."+t+W6("0",r6(i[1]).length-t.length)}),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+a6(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+$5(F5(l,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+o6(e,t,-n):$5(""+(Math.floor(n)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(n,i[1].length)))+"."+T5(i6(n,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return o6(e,t.replace(/^#,#*,/,""),n);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=I5(o6(e,t.replace(/[\\-]/g,""),n)),o=0,I5(I5(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return o<a.length?a.charAt(o++):"0"===e?"0":""}));if(t.match(n6))return"("+(a=o6(e,"##########",n)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),s=z5(l,Math.pow(10,o)-1,!1),a=""+c," "==(u=c6("n",i[1],s[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],(u=R5(s[2],o)).length<i[4].length&&(u=r6(i[4].substr(i[4].length-u.length))+u),a+=u;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),c+((s=z5(l,Math.pow(10,o)-1,!0))[0]||(s[1]?"":"0"))+" "+(s[1]?A5(s[1],o)+i[2]+"/"+i[3]+R5(s[2],o):W6(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=F5(n,0),t.length<=a.length?a:r6(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var h=t.indexOf(".")-o,d=t.length-a.length-h;return r6(t.substr(0,h)+a+t.substr(t.length-d))}if(i=t.match(/^00,000\.([#0]*0)$/))return o=i6(n,i[1].length),n<0?"-"+o6(e,t,-n):$5(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?T5(0,3-e.length):"")+e})+"."+T5(o,i[1].length);switch(t){case"###,##0.00":return o6(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var f=$5(F5(l,0));return"0"!==f?c+f:"";case"###,###.00":return o6(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return o6(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function s6(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+s6(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),!(n=(t/Math.pow(10,i)).toPrecision(r+1+(a+i)%a)).match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(o-n.length+i):n+="E+"+(o-i),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,n,r){return t+n+r.substr(0,(a+i)%a)+"."+r.substr(i)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function l6(e,t,n){if(40===e.charCodeAt(0)&&!t.match(t6)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?l6("n",r,n):"("+l6("n",r,-n)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,n){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return c6(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}(e,t,n);if(-1!==t.indexOf("%"))return function(e,t,n){var r=t.replace(J5,""),a=t.length-r.length;return c6(e,r,n*Math.pow(10,2*a))+W6("%",a)}(e,t,n);if(-1!==t.indexOf("E"))return s6(t,n);if(36===t.charCodeAt(0))return"$"+l6(e,t.substr(" "==t.charAt(1)?2:1),n);var a,i,o,s,l=Math.abs(n),c=n<0?"-":"";if(t.match(/^00+$/))return c+T5(l,t.length);if(t.match(/^[#?]+$/))return a=""+n,0===n&&(a=""),a.length>t.length?a:r6(t.substr(0,t.length-a.length))+a;if(i=t.match(Z5))return function(e,t,n){return n+(0===t?"":""+t)+W6(" ",e[1].length+2+e[4].length)}(i,l,c);if(t.match(/^#+0+$/))return c+T5(l,t.length-t.indexOf("0"));if(i=t.match(e6))return a=(a=(""+n).replace(/^([^\.]+)$/,"$1."+r6(i[1])).replace(/\.$/,"."+r6(i[1]))).replace(/\.(\d*)$/,function(e,t){return"."+t+W6("0",r6(i[1]).length-t.length)}),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+$5(""+l);if(i=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+l6(e,t,-n):$5(""+n)+"."+W6("0",i[1].length);if(i=t.match(/^#,#*,#0/))return l6(e,t.replace(/^#,#*,/,""),n);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=I5(l6(e,t.replace(/[\\-]/g,""),n)),o=0,I5(I5(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return o<a.length?a.charAt(o++):"0"===e?"0":""}));if(t.match(n6))return"("+(a=l6(e,"##########",n)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),s=z5(l,Math.pow(10,o)-1,!1),a=""+c," "==(u=c6("n",i[1],s[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],(u=R5(s[2],o)).length<i[4].length&&(u=r6(i[4].substr(i[4].length-u.length))+u),a+=u;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),c+((s=z5(l,Math.pow(10,o)-1,!0))[0]||(s[1]?"":"0"))+" "+(s[1]?A5(s[1],o)+i[2]+"/"+i[3]+R5(s[2],o):W6(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+n,t.length<=a.length?a:r6(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var h=t.indexOf(".")-o,d=t.length-a.length-h;return r6(t.substr(0,h)+a+t.substr(t.length-d))}if(i=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+l6(e,t,-n):$5(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?T5(0,3-e.length):"")+e})+"."+T5(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var f=$5(""+l);return"0"!==f?c+f:"";default:if(t.match(/\.[0#?]*$/))return l6(e,t.slice(0,t.lastIndexOf(".")),n)+r6(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function c6(e,t,n){return(0|n)===n?l6(e,t,n):o6(e,t,n)}var u6=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function h6(e){for(var t=0,n="",r="";t<e.length;)switch(n=e.charAt(t)){case"G":O5(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("\u4e0a\u5348/\u4e0b\u5348"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(r=n;"]"!==e.charAt(t++)&&t<e.length;)r+=e.charAt(t);if(r.match(u6))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||"\\"==n&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var d6=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function f6(e,t){if(null==t)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0}return!1}function p6(e,t){var n=function(e){for(var t=[],n=!1,r=0,a=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(a,r-a),a=r+1}if(t[t.length]=e.substr(a),!0===n)throw new Error("Format |"+e+"| unterminated string ");return t}(e),r=n.length,a=n[r-1].indexOf("@");if(r<4&&a>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if("number"!==typeof t)return[4,4===n.length||a>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=a>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=a>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=a>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"]}var i=t>0?n[0]:t<0?n[1]:n[2];if(-1===n[0].indexOf("[")&&-1===n[1].indexOf("["))return[r,i];if(null!=n[0].match(/\[[=<>]/)||null!=n[1].match(/\[[=<>]/)){var o=n[0].match(d6),s=n[1].match(d6);return f6(t,o)?[r,n[0]]:f6(t,s)?[r,n[1]]:[r,n[null!=o&&null!=s?2:1]]}return[r,i]}function g6(e,t,n){null==n&&(n={});var r="";switch(typeof e){case"string":r="m/d/yy"==e&&n.dateNF?n.dateNF:e;break;case"number":null==(r=14==e&&n.dateNF?n.dateNF:(null!=n.table?n.table:M5)[e])&&(r=n.table&&n.table[j5[e]]||M5[j5[e]]),null==r&&(r=B5[e]||"General")}if(O5(r,0))return X5(t,n);t instanceof Date&&(t=G5(t,n.date1904));var a=p6(r,t);if(O5(a[1]))return X5(t,n);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,n,r){for(var a,i,o,s=[],l="",c=0,u="",h="t",d="H";c<e.length;)switch(u=e.charAt(c)){case"G":if(!O5(e,c))throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";34!==(o=e.charCodeAt(++c))&&c<e.length;)l+=String.fromCharCode(o);s[s.length]={t:"t",v:l},++c;break;case"\\":var f=e.charAt(++c),p="("===f||")"===f?f:"t";s[s.length]={t:p,v:f},++c;break;case"_":s[s.length]={t:"t",v:" "},c+=2;break;case"@":s[s.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==a&&null==(a=W5(t,n,"2"===e.charAt(c+1))))return"";s[s.length]={t:"X",v:e.substr(c,2)},h=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==a&&null==(a=W5(t,n)))return"";for(l=u;++c<e.length&&e.charAt(c).toLowerCase()===u;)l+=u;"m"===u&&"h"===h.toLowerCase()&&(u="M"),"h"===u&&(u=d),s[s.length]={t:u,v:l},h=u;break;case"A":case"a":case"\u4e0a":var g={t:u,v:u};if(null==a&&(a=W5(t,n)),"A/P"===e.substr(c,3).toUpperCase()?(null!=a&&(g.v=a.H>=12?"P":"A"),g.t="T",d="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=a&&(g.v=a.H>=12?"PM":"AM"),g.t="T",c+=5,d="h"):"\u4e0a\u5348/\u4e0b\u5348"===e.substr(c,5).toUpperCase()?(null!=a&&(g.v=a.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),g.t="T",c+=5,d="h"):(g.t="t",++c),null==a&&"T"===g.t)return"";s[s.length]=g,h=u;break;case"[":for(l=u;"]"!==e.charAt(c++)&&c<e.length;)l+=e.charAt(c);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(u6)){if(null==a&&null==(a=W5(t,n)))return"";s[s.length]={t:"Z",v:l.toLowerCase()},h=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",h6(e)||(s[s.length]={t:"t",v:l}));break;case".":if(null!=a){for(l=u;++c<e.length&&"0"===(u=e.charAt(c));)l+=u;s[s.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++c<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(c))>-1;)l+=u;s[s.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++c)===u;)l+=u;s[s.length]={t:u,v:l},h=u;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":s[s.length]={t:1===r?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);s[s.length]={t:"D",v:l};break;case" ":s[s.length]={t:u,v:u},++c;break;case"$":s[s.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(u))throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"t",v:u},++c}var m,v=0,b=0;for(c=s.length-1,h="t";c>=0;--c)switch(s[c].t){case"h":case"H":s[c].t=d,h="h",v<1&&(v=1);break;case"s":(m=s[c].v.match(/\.0+$/))&&(b=Math.max(b,m[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":h=s[c].t;break;case"m":"s"===h&&(s[c].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&s[c].v.match(/[Hh]/)&&(v=1),v<2&&s[c].v.match(/[Mm]/)&&(v=2),v<3&&s[c].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M),a.M>=60&&(a.M=0,++a.H);break;case 2:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M)}var x,y="";for(c=0;c<s.length;++c)switch(s[c].t){case"t":case"T":case" ":case"D":break;case"X":s[c].v="",s[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[c].v=Y5(s[c].t.charCodeAt(0),s[c].v,a,b),s[c].t="t";break;case"n":case"?":for(x=c+1;null!=s[x]&&("?"===(u=s[x].t)||"D"===u||(" "===u||"t"===u)&&null!=s[x+1]&&("?"===s[x+1].t||"t"===s[x+1].t&&"/"===s[x+1].v)||"("===s[c].t&&(" "===u||"n"===u||")"===u)||"t"===u&&("/"===s[x].v||" "===s[x].v&&null!=s[x+1]&&"?"==s[x+1].t));)s[c].v+=s[x].v,s[x]={v:"",t:";"},++x;y+=s[c].v,c=x-1;break;case"G":s[c].t="t",s[c].v=X5(t,n)}var w,k,N="";if(y.length>0){40==y.charCodeAt(0)?(w=t<0&&45===y.charCodeAt(0)?-t:t,k=c6("n",y,w)):(k=c6("n",y,w=t<0&&r>1?-t:t),w<0&&s[0]&&"t"==s[0].t&&(k=k.substr(1),s[0].v="-"+s[0].v)),x=k.length-1;var S=s.length;for(c=0;c<s.length;++c)if(null!=s[c]&&"t"!=s[c].t&&s[c].v.indexOf(".")>-1){S=c;break}var C=s.length;if(S===s.length&&-1===k.indexOf("E")){for(c=s.length-1;c>=0;--c)null!=s[c]&&-1!=="n?".indexOf(s[c].t)&&(x>=s[c].v.length-1?(x-=s[c].v.length,s[c].v=k.substr(x+1,s[c].v.length)):x<0?s[c].v="":(s[c].v=k.substr(0,x+1),x=-1),s[c].t="t",C=c);x>=0&&C<s.length&&(s[C].v=k.substr(0,x+1)+s[C].v)}else if(S!==s.length&&-1===k.indexOf("E")){for(x=k.indexOf(".")-1,c=S;c>=0;--c)if(null!=s[c]&&-1!=="n?".indexOf(s[c].t)){for(i=s[c].v.indexOf(".")>-1&&c===S?s[c].v.indexOf(".")-1:s[c].v.length-1,N=s[c].v.substr(i+1);i>=0;--i)x>=0&&("0"===s[c].v.charAt(i)||"#"===s[c].v.charAt(i))&&(N=k.charAt(x--)+N);s[c].v=N,s[c].t="t",C=c}for(x>=0&&C<s.length&&(s[C].v=k.substr(0,x+1)+s[C].v),x=k.indexOf(".")+1,c=S;c<s.length;++c)if(null!=s[c]&&(-1!=="n?(".indexOf(s[c].t)||c===S)){for(i=s[c].v.indexOf(".")>-1&&c===S?s[c].v.indexOf(".")+1:0,N=s[c].v.substr(0,i);i<s[c].v.length;++i)x<k.length&&(N+=k.charAt(x++));s[c].v=N,s[c].t="t",C=c}}}for(c=0;c<s.length;++c)null!=s[c]&&"n?".indexOf(s[c].t)>-1&&(w=r>1&&t<0&&c>0&&"-"===s[c-1].v?-t:t,s[c].v=c6(s[c].t,s[c].v,w),s[c].t="t");var E="";for(c=0;c!==s.length;++c)null!=s[c]&&(E+=s[c].v);return E}(a[1],t,n,a[0])}function m6(e,t){if("number"!=typeof t){t=+t||-1;for(var n=0;n<392;++n)if(void 0!=M5[n]){if(M5[n]==e){t=n;break}}else t<0&&(t=n);t<0&&(t=391)}return M5[t]=e,t}function v6(e){for(var t=0;392!=t;++t)void 0!==e[t]&&m6(e[t],t)}function b6(){M5=function(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',e}()}var x6=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var y6=function(){var e={};e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),n=0;256!=n;++n)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=n)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[n]=e;return"undefined"!==typeof Int32Array?new Int32Array(t):t}();var n=function(e){var t=0,n=0,r=0,a="undefined"!==typeof Int32Array?new Int32Array(4096):new Array(4096);for(r=0;256!=r;++r)a[r]=e[r];for(r=0;256!=r;++r)for(n=e[r],t=256+r;t<4096;t+=256)n=a[t]=n>>>8^e[255&n];var i=[];for(r=1;16!=r;++r)i[r-1]="undefined"!==typeof Int32Array?a.subarray(256*r,256*r+256):a.slice(256*r,256*r+256);return i}(t),r=n[0],a=n[1],i=n[2],o=n[3],s=n[4],l=n[5],c=n[6],u=n[7],h=n[8],d=n[9],f=n[10],p=n[11],g=n[12],m=n[13],v=n[14];return e.table=t,e.bstr=function(e,n){for(var r=-1^n,a=0,i=e.length;a<i;)r=r>>>8^t[255&(r^e.charCodeAt(a++))];return~r},e.buf=function(e,n){for(var b=-1^n,x=e.length-15,y=0;y<x;)b=v[e[y++]^255&b]^m[e[y++]^b>>8&255]^g[e[y++]^b>>16&255]^p[e[y++]^b>>>24]^f[e[y++]]^d[e[y++]]^h[e[y++]]^u[e[y++]]^c[e[y++]]^l[e[y++]]^s[e[y++]]^o[e[y++]]^i[e[y++]]^a[e[y++]]^r[e[y++]]^t[e[y++]];for(x+=15;y<x;)b=b>>>8^t[255&(b^e[y++])];return~b},e.str=function(e,n){for(var r=-1^n,a=0,i=e.length,o=0,s=0;a<i;)(o=e.charCodeAt(a++))<128?r=r>>>8^t[255&(r^o)]:o<2048?r=(r=r>>>8^t[255&(r^(192|o>>6&31))])>>>8^t[255&(r^(128|63&o))]:o>=55296&&o<57344?(o=64+(1023&o),s=1023&e.charCodeAt(a++),r=(r=(r=(r=r>>>8^t[255&(r^(240|o>>8&7))])>>>8^t[255&(r^(128|o>>2&63))])>>>8^t[255&(r^(128|s>>6&15|(3&o)<<4))])>>>8^t[255&(r^(128|63&s))]):r=(r=(r=r>>>8^t[255&(r^(224|o>>12&15))])>>>8^t[255&(r^(128|o>>6&63))])>>>8^t[255&(r^(128|63&o))];return~r},e}(),w6=function(){var e,t={};function n(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:n(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function r(e){if("/"==e.charAt(e.length-1))return r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function a(e,t){"string"===typeof t&&(t=new Date(t));var n=t.getHours();n=(n=n<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,n);var r=t.getFullYear()-1980;r=(r=r<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,r)}function i(e){m7(e,0);for(var t={},n=0;e.l<=e.length-4;){var r=e.read_shift(2),a=e.read_shift(2),i=e.l+a,o={};if(21589===r)1&(n=e.read_shift(1))&&(o.mtime=e.read_shift(4)),a>5&&(2&n&&(o.atime=e.read_shift(4)),4&n&&(o.ctime=e.read_shift(4))),o.mtime&&(o.mt=new Date(1e3*o.mtime));e.l=i,t[r]=o}return t}function o(){return e||(e={})}function s(e,t){if(80==e[0]&&75==e[1])return re(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=k(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var n=t&&t.root||"",r=(b5&&Buffer.isBuffer(e)?e.toString("binary"):k(e)).split("\r\n"),a=0,i="";for(a=0;a<r.length;++a)if(i=r[a],/^Content-Location:/i.test(i)&&(i=i.slice(i.indexOf("file")),n||(n=i.slice(0,i.lastIndexOf("/")+1)),i.slice(0,n.length)!=n))for(;n.length>0&&(n=(n=n.slice(0,n.length-1)).slice(0,n.lastIndexOf("/")+1),i.slice(0,n.length)!=n););var o=(r[1]||"").match(/boundary="(.*?)"/);if(!o)throw new Error("MAD cannot find boundary");var s="--"+(o[1]||""),l=[],c=[],u={FileIndex:l,FullPaths:c};d(u);var h,f=0;for(a=0;a<r.length;++a){var p=r[a];p!==s&&p!==s+"--"||(f++&&ce(u,r.slice(h,a),n),h=a)}return u}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var n,r,a,i,o,s,f=512,p=[],g=e.slice(0,512);m7(g,0);var m=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(b,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(g);switch(n=m[0]){case 3:f=512;break;case 4:f=4096;break;case 0:if(0==m[1])return re(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+n)}512!==f&&m7(g=e.slice(0,f),28);var x=e.slice(0,f);!function(e,t){var n=9;switch(e.l+=2,n=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+n);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+n);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+n)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(g,n);var y=g.read_shift(4,"i");if(3===n&&0!==y)throw new Error("# Directory Sectors: Expected 0 saw "+y);g.l+=4,i=g.read_shift(4,"i"),g.l+=4,g.chk("00100000","Mini Stream Cutoff Size: "),o=g.read_shift(4,"i"),r=g.read_shift(4,"i"),s=g.read_shift(4,"i"),a=g.read_shift(4,"i");for(var w=-1,N=0;N<109&&!((w=g.read_shift(4,"i"))<0);++N)p[N]=w;var S=function(e,t){for(var n=Math.ceil(e.length/t)-1,r=[],a=1;a<n;++a)r[a-1]=e.slice(a*t,(a+1)*t);return r[n-1]=e.slice(n*t),r}(e,f);c(s,a,S,f,p);var C=function(e,t,n,r){var a=e.length,i=[],o=[],s=[],l=[],c=r-1,u=0,h=0,d=0,f=0;for(u=0;u<a;++u)if(s=[],(d=u+t)>=a&&(d-=a),!o[d]){l=[];var p=[];for(h=d;h>=0;){p[h]=!0,o[h]=!0,s[s.length]=h,l.push(e[h]);var g=n[Math.floor(4*h/r)];if(r<4+(f=4*h&c))throw new Error("FAT boundary crossed: "+h+" 4 "+r);if(!e[g])break;if(p[h=l7(e[g],f)])break}i[d]={nodes:s,data:M8([l])}}return i}(S,i,p,f);C[i].name="!Directory",r>0&&o!==v&&(C[o].name="!MiniFAT"),C[p[0]].name="!FAT",C.fat_addrs=p,C.ssz=f;var E=[],_=[],I=[];!function(e,t,n,r,a,i,o,s){for(var c,d=0,f=r.length?2:0,p=t[e].data,g=0,m=0;g<p.length;g+=128){var b=p.slice(g,g+128);m7(b,64),m=b.read_shift(2),c=B8(b,0,m-f),r.push(c);var x={name:c,type:b.read_shift(1),color:b.read_shift(1),L:b.read_shift(4,"i"),R:b.read_shift(4,"i"),C:b.read_shift(4,"i"),clsid:b.read_shift(16),state:b.read_shift(4,"i"),start:0,size:0};0!==b.read_shift(2)+b.read_shift(2)+b.read_shift(2)+b.read_shift(2)&&(x.ct=h(b,b.l-8)),0!==b.read_shift(2)+b.read_shift(2)+b.read_shift(2)+b.read_shift(2)&&(x.mt=h(b,b.l-8)),x.start=b.read_shift(4,"i"),x.size=b.read_shift(4,"i"),x.size<0&&x.start<0&&(x.size=x.type=0,x.start=v,x.name=""),5===x.type?(d=x.start,a>0&&d!==v&&(t[d].name="!StreamData")):x.size>=4096?(x.storage="fat",void 0===t[x.start]&&(t[x.start]=u(n,x.start,t.fat_addrs,t.ssz)),t[x.start].name=x.name,x.content=t[x.start].data.slice(0,x.size)):(x.storage="minifat",x.size<0?x.size=0:d!==v&&x.start!==v&&t[d]&&(x.content=l(x,t[d].data,(t[s]||{}).data))),x.content&&m7(x.content,0),i[c]=x,o.push(x)}}(i,C,S,E,r,{},_,o),function(e,t,n){for(var r=0,a=0,i=0,o=0,s=0,l=n.length,c=[],u=[];r<l;++r)c[r]=u[r]=r,t[r]=n[r];for(;s<u.length;++s)a=e[r=u[s]].L,i=e[r].R,o=e[r].C,c[r]===r&&(-1!==a&&c[a]!==a&&(c[r]=c[a]),-1!==i&&c[i]!==i&&(c[r]=c[i])),-1!==o&&(c[o]=r),-1!==a&&r!=c[r]&&(c[a]=c[r],u.lastIndexOf(a)<s&&u.push(a)),-1!==i&&r!=c[r]&&(c[i]=c[r],u.lastIndexOf(i)<s&&u.push(i));for(r=1;r<l;++r)c[r]===r&&(-1!==i&&c[i]!==i?c[r]=c[i]:-1!==a&&c[a]!==a&&(c[r]=c[a]));for(r=1;r<l;++r)if(0!==e[r].type){if((s=r)!=c[s])do{s=c[s],t[r]=t[s]+"/"+t[r]}while(0!==s&&-1!==c[s]&&s!=c[s]);c[r]=-1}for(t[0]+="/",r=1;r<l;++r)2!==e[r].type&&(t[r]+="/")}(_,I,E),E.shift();var T={FileIndex:_,FullPaths:I};return t&&t.raw&&(T.raw={header:x,sectors:S}),T}function l(e,t,n){for(var r=e.start,a=e.size,i=[],o=r;n&&a>0&&o>=0;)i.push(t.slice(o*m,o*m+m)),a-=m,o=l7(n,4*o);return 0===i.length?b7(0):C5(i).slice(0,e.size)}function c(e,t,n,r,a){var i=v;if(e===v){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var o=n[e],s=(r>>>2)-1;if(!o)return;for(var l=0;l<s&&(i=l7(o,4*l))!==v;++l)a.push(i);c(l7(o,r-4),t-1,n,r,a)}}function u(e,t,n,r,a){var i=[],o=[];a||(a=[]);var s=r-1,l=0,c=0;for(l=t;l>=0;){a[l]=!0,i[i.length]=l,o.push(e[l]);var u=n[Math.floor(4*l/r)];if(r<4+(c=4*l&s))throw new Error("FAT boundary crossed: "+l+" 4 "+r);if(!e[u])break;l=l7(e[u],c)}return{nodes:i,data:M8([o])}}function h(e,t){return new Date(1e3*(s7(e,t+4)/1e7*Math.pow(2,32)+s7(e,t)/1e7-11644473600))}function d(e,t){var n=t||{},r=n.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=r+"/",e.FileIndex[0]={name:r,type:5}),n.CLSID&&(e.FileIndex[0].clsid=n.CLSID),function(e){var t="\x01Sh33tJ5";if(w6.find(e,"/"+t))return;var n=b7(4);n[0]=55,n[1]=n[3]=50,n[2]=54,e.FileIndex.push({name:t,type:2,content:n,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),f(e)}(e)}function f(e,t){d(e);for(var a=!1,i=!1,o=e.FullPaths.length-1;o>=0;--o){var s=e.FileIndex[o];switch(s.type){case 0:i?a=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:i=!0,isNaN(s.R*s.L*s.C)&&(a=!0),s.R>-1&&s.L>-1&&s.R==s.L&&(a=!0);break;default:a=!0}}if(a||t){var l=new Date(1987,1,19),c=0,u=Object.create?Object.create(null):{},h=[];for(o=0;o<e.FullPaths.length;++o)u[e.FullPaths[o]]=!0,0!==e.FileIndex[o].type&&h.push([e.FullPaths[o],e.FileIndex[o]]);for(o=0;o<h.length;++o){var f=n(h[o][0]);(i=u[f])||(h.push([f,{name:r(f).replace("/",""),type:1,clsid:y,ct:l,mt:l,content:null}]),u[f]=!0)}for(h.sort(function(e,t){return function(e,t){for(var n=e.split("/"),r=t.split("/"),a=0,i=0,o=Math.min(n.length,r.length);a<o;++a){if(i=n[a].length-r[a].length)return i;if(n[a]!=r[a])return n[a]<r[a]?-1:1}return n.length-r.length}(e[0],t[0])}),e.FullPaths=[],e.FileIndex=[],o=0;o<h.length;++o)e.FullPaths[o]=h[o][0],e.FileIndex[o]=h[o][1];for(o=0;o<h.length;++o){var p=e.FileIndex[o],g=e.FullPaths[o];if(p.name=r(g).replace("/",""),p.L=p.R=p.C=-(p.color=1),p.size=p.content?p.content.length:0,p.start=0,p.clsid=p.clsid||y,0===o)p.C=h.length>1?1:-1,p.size=0,p.type=5;else if("/"==g.slice(-1)){for(c=o+1;c<h.length&&n(e.FullPaths[c])!=g;++c);for(p.C=c>=h.length?-1:c,c=o+1;c<h.length&&n(e.FullPaths[c])!=n(g);++c);p.R=c>=h.length?-1:c,p.type=1}else n(e.FullPaths[o+1]||"")==n(g)&&(p.R=o+1),p.type=2}}}function p(e,t){var n=t||{};if("mad"==n.fileType)return function(e,t){for(var n=t||{},r=n.boundary||"SheetJS",a=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(r="------="+r).slice(2)+'"',"","",""],i=e.FullPaths[0],o=i,s=e.FileIndex[0],l=1;l<e.FullPaths.length;++l)if(o=e.FullPaths[l].slice(i.length),(s=e.FileIndex[l]).size&&s.content&&"\x01Sh33tJ5"!=o){o=o.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"});for(var c=s.content,u=b5&&Buffer.isBuffer(c)?c.toString("binary"):k(c),h=0,d=Math.min(1024,u.length),f=0,p=0;p<=d;++p)(f=u.charCodeAt(p))>=32&&f<128&&++h;var g=h>=4*d/5;a.push(r),a.push("Content-Location: "+(n.root||"file:///C:/SheetJS/")+o),a.push("Content-Transfer-Encoding: "+(g?"quoted-printable":"base64")),a.push("Content-Type: "+oe(s,o)),a.push(""),a.push(g?le(u):se(u))}return a.push(r+"--\r\n"),a.join("\r\n")}(e,n);if(f(e),"zip"===n.fileType)return function(e,t){var n=t||{},r=[],i=[],o=b7(1),s=n.compression?8:0,l=0;0;var c=0,u=0,h=0,d=0,f=e.FullPaths[0],p=f,g=e.FileIndex[0],m=[],v=0;for(c=1;c<e.FullPaths.length;++c)if(p=e.FullPaths[c].slice(f.length),(g=e.FileIndex[c]).size&&g.content&&"\x01Sh33tJ5"!=p){var b=h,x=b7(p.length);for(u=0;u<p.length;++u)x.write_shift(1,127&p.charCodeAt(u));x=x.slice(0,x.l),m[d]=y6.buf(g.content,0);var y=g.content;8==s&&(y=N(y)),(o=b7(30)).write_shift(4,67324752),o.write_shift(2,20),o.write_shift(2,l),o.write_shift(2,s),g.mt?a(o,g.mt):o.write_shift(4,0),o.write_shift(-4,8&l?0:m[d]),o.write_shift(4,8&l?0:y.length),o.write_shift(4,8&l?0:g.content.length),o.write_shift(2,x.length),o.write_shift(2,0),h+=o.length,r.push(o),h+=x.length,r.push(x),h+=y.length,r.push(y),8&l&&((o=b7(12)).write_shift(-4,m[d]),o.write_shift(4,y.length),o.write_shift(4,g.content.length),h+=o.l,r.push(o)),(o=b7(46)).write_shift(4,33639248),o.write_shift(2,0),o.write_shift(2,20),o.write_shift(2,l),o.write_shift(2,s),o.write_shift(4,0),o.write_shift(-4,m[d]),o.write_shift(4,y.length),o.write_shift(4,g.content.length),o.write_shift(2,x.length),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(4,0),o.write_shift(4,b),v+=o.l,i.push(o),v+=x.length,i.push(x),++d}return o=b7(22),o.write_shift(4,101010256),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,d),o.write_shift(2,d),o.write_shift(4,v),o.write_shift(4,h),o.write_shift(2,0),C5([C5(r),C5(i),o])}(e,n);var r=function(e){for(var t=0,n=0,r=0;r<e.FileIndex.length;++r){var a=e.FileIndex[r];if(a.content){var i=a.content.length;i>0&&(i<4096?t+=i+63>>6:n+=i+511>>9)}}for(var o=e.FullPaths.length+3>>2,s=t+127>>7,l=(t+7>>3)+n+o+s,c=l+127>>7,u=c<=109?0:Math.ceil((c-109)/127);l+c+u+127>>7>c;)u=++c<=109?0:Math.ceil((c-109)/127);var h=[1,u,c,s,o,n,t,0];return e.FileIndex[0].size=t<<6,h[7]=(e.FileIndex[0].start=h[0]+h[1]+h[2]+h[3]+h[4]+h[5])+(h[6]+7>>3),h}(e),i=b7(r[7]<<9),o=0,s=0;for(o=0;o<8;++o)i.write_shift(1,x[o]);for(o=0;o<8;++o)i.write_shift(2,0);for(i.write_shift(2,62),i.write_shift(2,3),i.write_shift(2,65534),i.write_shift(2,9),i.write_shift(2,6),o=0;o<3;++o)i.write_shift(2,0);for(i.write_shift(4,0),i.write_shift(4,r[2]),i.write_shift(4,r[0]+r[1]+r[2]+r[3]-1),i.write_shift(4,0),i.write_shift(4,4096),i.write_shift(4,r[3]?r[0]+r[1]+r[2]-1:v),i.write_shift(4,r[3]),i.write_shift(-4,r[1]?r[0]-1:v),i.write_shift(4,r[1]),o=0;o<109;++o)i.write_shift(-4,o<r[2]?r[1]+o:-1);if(r[1])for(s=0;s<r[1];++s){for(;o<236+127*s;++o)i.write_shift(-4,o<r[2]?r[1]+o:-1);i.write_shift(-4,s===r[1]-1?v:s+1)}var l=function(e){for(s+=e;o<s-1;++o)i.write_shift(-4,o+1);e&&(++o,i.write_shift(-4,v))};for(s=o=0,s+=r[1];o<s;++o)i.write_shift(-4,w.DIFSECT);for(s+=r[2];o<s;++o)i.write_shift(-4,w.FATSECT);l(r[3]),l(r[4]);for(var c=0,u=0,h=e.FileIndex[0];c<e.FileIndex.length;++c)(h=e.FileIndex[c]).content&&((u=h.content.length)<4096||(h.start=s,l(u+511>>9)));for(l(r[6]+7>>3);511&i.l;)i.write_shift(-4,w.ENDOFCHAIN);for(s=o=0,c=0;c<e.FileIndex.length;++c)(h=e.FileIndex[c]).content&&(!(u=h.content.length)||u>=4096||(h.start=s,l(u+63>>6)));for(;511&i.l;)i.write_shift(-4,w.ENDOFCHAIN);for(o=0;o<r[4]<<2;++o){var d=e.FullPaths[o];if(d&&0!==d.length){h=e.FileIndex[o],0===o&&(h.start=h.size?h.start-1:v);var p=0===o&&n.root||h.name;if(u=2*(p.length+1),i.write_shift(64,p,"utf16le"),i.write_shift(2,u),i.write_shift(1,h.type),i.write_shift(1,h.color),i.write_shift(-4,h.L),i.write_shift(-4,h.R),i.write_shift(-4,h.C),h.clsid)i.write_shift(16,h.clsid,"hex");else for(c=0;c<4;++c)i.write_shift(4,0);i.write_shift(4,h.state||0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,h.start),i.write_shift(4,h.size),i.write_shift(4,0)}else{for(c=0;c<17;++c)i.write_shift(4,0);for(c=0;c<3;++c)i.write_shift(4,-1);for(c=0;c<12;++c)i.write_shift(4,0)}}for(o=1;o<e.FileIndex.length;++o)if((h=e.FileIndex[o]).size>=4096)if(i.l=h.start+1<<9,b5&&Buffer.isBuffer(h.content))h.content.copy(i,i.l,0,h.size),i.l+=h.size+511&-512;else{for(c=0;c<h.size;++c)i.write_shift(1,h.content[c]);for(;511&c;++c)i.write_shift(1,0)}for(o=1;o<e.FileIndex.length;++o)if((h=e.FileIndex[o]).size>0&&h.size<4096)if(b5&&Buffer.isBuffer(h.content))h.content.copy(i,i.l,0,h.size),i.l+=h.size+63&-64;else{for(c=0;c<h.size;++c)i.write_shift(1,h.content[c]);for(;63&c;++c)i.write_shift(1,0)}if(b5)i.l=i.length;else for(;i.l<i.length;)i.write_shift(1,0);return i}t.version="1.2.1";var g,m=64,v=-2,b="d0cf11e0a1b11ae1",x=[208,207,17,224,161,177,26,225],y="00000000000000000000000000000000",w={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:v,FREESECT:-1,HEADER_SIGNATURE:b,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:y,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function k(e){for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function N(e){return g?g.deflateRawSync(e):X(e)}var S=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],C=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],E=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function _(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var I="undefined"!==typeof Uint8Array,T=I?new Uint8Array(256):[],A=0;A<256;++A)T[A]=_(A);function R(e,t){var n=T[255&e];return t<=8?n>>>8-t:(n=n<<8|T[e>>8&255],t<=16?n>>>16-t:(n=n<<8|T[e>>16&255])>>>24-t)}function D(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=6?0:e[r+1]<<8))>>>n&3}function F(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=5?0:e[r+1]<<8))>>>n&7}function O(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=3?0:e[r+1]<<8))>>>n&31}function L(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=1?0:e[r+1]<<8))>>>n&127}function P(e,t,n){var r=7&t,a=t>>>3,i=(1<<n)-1,o=e[a]>>>r;return n<8-r?o&i:(o|=e[a+1]<<8-r,n<16-r?o&i:(o|=e[a+2]<<16-r,n<24-r?o&i:(o|=e[a+3]<<24-r)&i))}function M(e,t,n){var r=7&t,a=t>>>3;return r<=5?e[a]|=(7&n)<<r:(e[a]|=n<<r&255,e[a+1]=(7&n)>>8-r),t+3}function j(e,t,n){return n=(1&n)<<(7&t),e[t>>>3]|=n,t+1}function B(e,t,n){var r=t>>>3;return n<<=7&t,e[r]|=255&n,n>>>=8,e[r+1]=n,t+8}function z(e,t,n){var r=t>>>3;return n<<=7&t,e[r]|=255&n,n>>>=8,e[r+1]=255&n,e[r+2]=n>>>8,t+16}function W(e,t){var n=e.length,r=2*n>t?2*n:t+5,a=0;if(n>=t)return e;if(b5){var i=w5(r);if(e.copy)e.copy(i);else for(;a<e.length;++a)i[a]=e[a];return i}if(I){var o=new Uint8Array(r);if(o.set)o.set(e);else for(;a<n;++a)o[a]=e[a];return o}return e.length=r,e}function U(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=0;return t}function V(e,t,n){var r=1,a=0,i=0,o=0,s=0,l=e.length,c=I?new Uint16Array(32):U(32);for(i=0;i<32;++i)c[i]=0;for(i=l;i<n;++i)e[i]=0;l=e.length;var u=I?new Uint16Array(l):U(l);for(i=0;i<l;++i)c[a=e[i]]++,r<a&&(r=a),u[i]=0;for(c[0]=0,i=1;i<=r;++i)c[i+16]=s=s+c[i-1]<<1;for(i=0;i<l;++i)0!=(s=e[i])&&(u[i]=c[s+16]++);var h=0;for(i=0;i<l;++i)if(0!=(h=e[i]))for(s=R(u[i],r)>>r-h,o=(1<<r+4-h)-1;o>=0;--o)t[s|o<<h]=15&h|i<<4;return r}var H=I?new Uint16Array(512):U(512),G=I?new Uint16Array(32):U(32);if(!I){for(var q=0;q<512;++q)H[q]=0;for(q=0;q<32;++q)G[q]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);V(e,G,32);var n=[];for(t=0;t<=143;t++)n.push(8);for(;t<=255;t++)n.push(9);for(;t<=279;t++)n.push(7);for(;t<=287;t++)n.push(8);V(n,H,288)}();var K=function(){for(var e=I?new Uint8Array(32768):[],t=0,n=0;t<E.length-1;++t)for(;n<E[t+1];++n)e[n]=t;for(;n<32768;++n)e[n]=29;var r=I?new Uint8Array(259):[];for(t=0,n=0;t<C.length-1;++t)for(;n<C[t+1];++n)r[n]=t;return function(t,n){return t.length<8?function(e,t){for(var n=0;n<e.length;){var r=Math.min(65535,e.length-n),a=n+r==e.length;for(t.write_shift(1,+a),t.write_shift(2,r),t.write_shift(2,65535&~r);r-- >0;)t[t.l++]=e[n++]}return t.l}(t,n):function(t,n){for(var a=0,i=0,o=I?new Uint16Array(32768):[];i<t.length;){var s=Math.min(65535,t.length-i);if(s<10){for(7&(a=M(n,a,+!(i+s!=t.length)))&&(a+=8-(7&a)),n.l=a/8|0,n.write_shift(2,s),n.write_shift(2,65535&~s);s-- >0;)n[n.l++]=t[i++];a=8*n.l}else{a=M(n,a,+!(i+s!=t.length)+2);for(var l=0;s-- >0;){var c=t[i],u=-1,h=0;if((u=o[l=32767&(l<<5^c)])&&((u|=-32768&i)>i&&(u-=32768),u<i))for(;t[u+h]==t[i+h]&&h<250;)++h;if(h>2){(c=r[h])<=22?a=B(n,a,T[c+1]>>1)-1:(B(n,a,3),B(n,a+=5,T[c-23]>>5),a+=3);var d=c<8?0:c-4>>2;d>0&&(z(n,a,h-C[c]),a+=d),c=e[i-u],a=B(n,a,T[c]>>3),a-=3;var f=c<4?0:c-2>>1;f>0&&(z(n,a,i-u-E[c]),a+=f);for(var p=0;p<h;++p)o[l]=32767&i,l=32767&(l<<5^t[i]),++i;s-=h-1}else c<=143?c+=48:a=j(n,a,1),a=B(n,a,T[c]),o[l]=32767&i,++i}a=B(n,a,0)-1}}return n.l=(a+7)/8|0,n.l}(t,n)}}();function X(e){var t=b7(50+Math.floor(1.1*e.length)),n=K(e,t);return t.slice(0,n)}var Y=I?new Uint16Array(32768):U(32768),$=I?new Uint16Array(32768):U(32768),J=I?new Uint16Array(128):U(128),Q=1,Z=1;function ee(e,t){var n=O(e,t)+257,r=O(e,t+=5)+1,a=function(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=4?0:e[r+1]<<8))>>>n&15}(e,t+=5)+4;t+=4;for(var i=0,o=I?new Uint8Array(19):U(19),s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,c=I?new Uint8Array(8):U(8),u=I?new Uint8Array(8):U(8),h=o.length,d=0;d<a;++d)o[S[d]]=i=F(e,t),l<i&&(l=i),c[i]++,t+=3;var f=0;for(c[0]=0,d=1;d<=l;++d)u[d]=f=f+c[d-1]<<1;for(d=0;d<h;++d)0!=(f=o[d])&&(s[d]=u[f]++);var p=0;for(d=0;d<h;++d)if(0!=(p=o[d])){f=T[s[d]]>>8-p;for(var g=(1<<7-p)-1;g>=0;--g)J[f|g<<p]=7&p|d<<3}var m=[];for(l=1;m.length<n+r;)switch(t+=7&(f=J[L(e,t)]),f>>>=3){case 16:for(i=3+D(e,t),t+=2,f=m[m.length-1];i-- >0;)m.push(f);break;case 17:for(i=3+F(e,t),t+=3;i-- >0;)m.push(0);break;case 18:for(i=11+L(e,t),t+=7;i-- >0;)m.push(0);break;default:m.push(f),l<f&&(l=f)}var v=m.slice(0,n),b=m.slice(n);for(d=n;d<286;++d)v[d]=0;for(d=r;d<30;++d)b[d]=0;return Q=V(v,Y,286),Z=V(b,$,30),t}function te(e,t){var n=function(e,t){if(3==e[0]&&!(3&e[1]))return[y5(t),2];for(var n=0,r=0,a=w5(t||1<<18),i=0,o=a.length>>>0,s=0,l=0;0==(1&r);)if(r=F(e,n),n+=3,r>>>1!=0)for(r>>1==1?(s=9,l=5):(n=ee(e,n),s=Q,l=Z);;){!t&&o<i+32767&&(o=(a=W(a,i+32767)).length);var c=P(e,n,s),u=r>>>1==1?H[c]:Y[c];if(n+=15&u,0===((u>>>=4)>>>8&255))a[i++]=u;else{if(256==u)break;var h=(u-=257)<8?0:u-4>>2;h>5&&(h=0);var d=i+C[u];h>0&&(d+=P(e,n,h),n+=h),c=P(e,n,l),n+=15&(u=r>>>1==1?G[c]:$[c]);var f=(u>>>=4)<4?0:u-2>>1,p=E[u];for(f>0&&(p+=P(e,n,f),n+=f),!t&&o<d&&(o=(a=W(a,d+100)).length);i<d;)a[i]=a[i-p],++i}}else{7&n&&(n+=8-(7&n));var g=e[n>>>3]|e[(n>>>3)+1]<<8;if(n+=32,g>0)for(!t&&o<i+g&&(o=(a=W(a,i+g)).length);g-- >0;)a[i++]=e[n>>>3],n+=8}return t?[a,n+7>>>3]:[a.slice(0,i),n+7>>>3]}(e.slice(e.l||0),t);return e.l+=n[1],n[0]}function ne(e,t){if(!e)throw new Error(t);"undefined"!==typeof console&&console.error(t)}function re(e,t){var n=e;m7(n,0);var r={FileIndex:[],FullPaths:[]};d(r,{root:t.root});for(var a=n.length-4;(80!=n[a]||75!=n[a+1]||5!=n[a+2]||6!=n[a+3])&&a>=0;)--a;n.l=a+4,n.l+=4;var o=n.read_shift(2);n.l+=6;var s=n.read_shift(4);for(n.l=s,a=0;a<o;++a){n.l+=20;var l=n.read_shift(4),c=n.read_shift(4),u=n.read_shift(2),h=n.read_shift(2),f=n.read_shift(2);n.l+=8;var p=n.read_shift(4),g=i(n.slice(n.l+u,n.l+u+h));n.l+=u+h+f;var m=n.l;n.l=p+4,ae(n,l,c,r,g),n.l=m}return r}function ae(e,t,n,r,a){e.l+=2;var o=e.read_shift(2),s=e.read_shift(2),l=function(e){var t=65535&e.read_shift(2),n=65535&e.read_shift(2),r=new Date,a=31&n,i=15&(n>>>=5);n>>>=4,r.setMilliseconds(0),r.setFullYear(n+1980),r.setMonth(i-1),r.setDate(a);var o=31&t,s=63&(t>>>=5);return t>>>=6,r.setHours(t),r.setMinutes(s),r.setSeconds(o<<1),r}(e);if(8257&o)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var c=e.read_shift(4),u=e.read_shift(4),h=e.read_shift(2),d=e.read_shift(2),f="",p=0;p<h;++p)f+=String.fromCharCode(e[e.l++]);if(d){var m=i(e.slice(e.l,e.l+d));(m[21589]||{}).mt&&(l=m[21589].mt),((a||{})[21589]||{}).mt&&(l=a[21589].mt)}e.l+=d;var v=e.slice(e.l,e.l+c);switch(s){case 8:v=function(e,t){if(!g)return te(e,t);var n=new(0,g.InflateRaw),r=n._processChunk(e.slice(e.l),n._finishFlushFlag);return e.l+=n.bytesRead,r}(e,u);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+s)}var b=!1;8&o&&(134695760==e.read_shift(4)&&(e.read_shift(4),b=!0),c=e.read_shift(4),u=e.read_shift(4)),c!=t&&ne(b,"Bad compressed size: "+t+" != "+c),u!=n&&ne(b,"Bad uncompressed size: "+n+" != "+u),ue(r,f,v,{unsafe:!0,mt:l})}var ie={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function oe(e,t){if(e.ctype)return e.ctype;var n=e.name||"",r=n.match(/\.([^\.]+)$/);return r&&ie[r[1]]||t&&(r=(n=t).match(/[\.\\]([^\.\\])+$/))&&ie[r[1]]?ie[r[1]]:"application/octet-stream"}function se(e){for(var t=m5(e),n=[],r=0;r<t.length;r+=76)n.push(t.slice(r,r+76));return n.join("\r\n")+"\r\n"}function le(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)});"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var n=[],r=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),a=0;a<r.length;++a){var i=r[a];if(0!=i.length)for(var o=0;o<i.length;){var s=76,l=i.slice(o,o+s);"="==l.charAt(s-1)?s--:"="==l.charAt(s-2)?s-=2:"="==l.charAt(s-3)&&(s-=3),l=i.slice(o,o+s),(o+=s)<i.length&&(l+="="),n.push(l)}else n.push("")}return n.join("\r\n")}function ce(e,t,n){for(var r,a="",i="",o="",s=0;s<10;++s){var l=t[s];if(!l||l.match(/^\s*$/))break;var c=l.match(/^(.*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":a=c[2].trim();break;case"content-type":o=c[2].trim();break;case"content-transfer-encoding":i=c[2].trim()}}switch(++s,i.toLowerCase()){case"base64":r=k5(v5(t.slice(s).join("")));break;case"quoted-printable":r=function(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n];n<=e.length&&"="==r.charAt(r.length-1);)r=r.slice(0,r.length-1)+e[++n];t.push(r)}for(var a=0;a<t.length;++a)t[a]=t[a].replace(/[=][0-9A-Fa-f]{2}/g,function(e){return String.fromCharCode(parseInt(e.slice(1),16))});return k5(t.join("\r\n"))}(t.slice(s));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+i)}var u=ue(e,a.slice(n.length),r,{unsafe:!0});o&&(u.ctype=o)}function ue(e,t,n,a){var i=a&&a.unsafe;i||d(e);var o=!i&&w6.find(e,t);if(!o){var s=e.FullPaths[0];t.slice(0,s.length)==s?s=t:("/"!=s.slice(-1)&&(s+="/"),s=(s+t).replace("//","/")),o={name:r(t),type:2},e.FileIndex.push(o),e.FullPaths.push(s),i||w6.utils.cfb_gc(e)}return o.content=n,o.size=n?n.length:0,a&&(a.CLSID&&(o.clsid=a.CLSID),a.mt&&(o.mt=a.mt),a.ct&&(o.ct=a.ct)),o}return t.find=function(e,t){var n=e.FullPaths.map(function(e){return e.toUpperCase()}),r=n.map(function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]}),a=!1;47===t.charCodeAt(0)?(a=!0,t=n[0].slice(0,-1)+t):a=-1!==t.indexOf("/");var i=t.toUpperCase(),o=!0===a?n.indexOf(i):r.indexOf(i);if(-1!==o)return e.FileIndex[o];var s=!i.match(_5);for(i=i.replace(E5,""),s&&(i=i.replace(_5,"!")),o=0;o<n.length;++o){if((s?n[o].replace(_5,"!"):n[o]).replace(E5,"")==i)return e.FileIndex[o];if((s?r[o].replace(_5,"!"):r[o]).replace(E5,"")==i)return e.FileIndex[o]}return null},t.read=function(t,n){var r=n&&n.type;switch(r||b5&&Buffer.isBuffer(t)&&(r="buffer"),r||"base64"){case"file":return function(t,n){return o(),s(e.readFileSync(t),n)}(t,n);case"base64":return s(k5(v5(t)),n);case"binary":return s(k5(t),n)}return s(t,n)},t.parse=s,t.write=function(t,n){var r=p(t,n);switch(n&&n.type||"buffer"){case"file":return o(),e.writeFileSync(n.filename,r),r;case"binary":return"string"==typeof r?r:k(r);case"base64":return m5("string"==typeof r?r:k(r));case"buffer":if(b5)return Buffer.isBuffer(r)?r:x5(r);case"array":return"string"==typeof r?k5(r):r}return r},t.writeFile=function(t,n,r){o();var a=p(t,r);e.writeFileSync(n,a)},t.utils={cfb_new:function(e){var t={};return d(t,e),t},cfb_add:ue,cfb_del:function(e,t){d(e);var n=w6.find(e,t);if(n)for(var r=0;r<e.FileIndex.length;++r)if(e.FileIndex[r]==n)return e.FileIndex.splice(r,1),e.FullPaths.splice(r,1),!0;return!1},cfb_mov:function(e,t,n){d(e);var a=w6.find(e,t);if(a)for(var i=0;i<e.FileIndex.length;++i)if(e.FileIndex[i]==a)return e.FileIndex[i].name=r(n),e.FullPaths[i]=n,!0;return!1},cfb_gc:function(e){f(e,!0)},ReadShift:u7,CheckField:g7,prep_blob:m7,bconcat:C5,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");g=e}catch(ci){console.error("cannot use native zlib: "+(ci.message||ci))}},_deflateRaw:X,_inflateRaw:te,consts:w},t}();let k6;function N6(e){return"string"===typeof e?N5(e):Array.isArray(e)?function(e){if("undefined"===typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(e)}(e):e}function S6(e,t,n){if("undefined"!==typeof k6&&k6.writeFileSync)return n?k6.writeFileSync(e,t,n):k6.writeFileSync(e,t);if("undefined"!==typeof Deno){if(n&&"string"==typeof t)switch(n){case"utf8":t=new TextEncoder(n).encode(t);break;case"binary":t=N5(t);break;default:throw new Error("Unsupported encoding "+n)}return Deno.writeFileSync(e,t)}var r="utf8"==n?l8(t):t;if("undefined"!==typeof IE_SaveFile)return IE_SaveFile(r,e);if("undefined"!==typeof Blob){var a=new Blob([N6(r)],{type:"application/octet-stream"});if("undefined"!==typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if("undefined"!==typeof saveAs)return saveAs(a,e);if("undefined"!==typeof URL&&"undefined"!==typeof document&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if("object"===typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var o=document.createElement("a");if(null!=o.download)return o.download=e,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var s=File(e);return s.open("w"),s.encoding="binary",Array.isArray(t)&&(t=S5(t)),s.write(t),s.close(),t}catch(ci){if(!ci.message||!ci.message.match(/onstruct/))throw ci}throw new Error("cannot save file "+e)}function C6(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&n.push(t[r]);return n}function E6(e,t){for(var n=[],r=C6(e),a=0;a!==r.length;++a)null==n[e[r[a]][t]]&&(n[e[r[a]][t]]=r[a]);return n}function _6(e){for(var t=[],n=C6(e),r=0;r!==n.length;++r)t[e[n[r]]]=n[r];return t}function I6(e){for(var t=[],n=C6(e),r=0;r!==n.length;++r)t[e[n[r]]]=parseInt(n[r],10);return t}var T6=new Date(1899,11,30,0,0,0);function A6(e,t){var n=e.getTime();return t&&(n-=1263168e5),(n-(T6.getTime()+6e4*(e.getTimezoneOffset()-T6.getTimezoneOffset())))/864e5}var R6=new Date,D6=T6.getTime()+6e4*(R6.getTimezoneOffset()-T6.getTimezoneOffset()),F6=R6.getTimezoneOffset();function O6(e){var t=new Date;return t.setTime(24*e*60*60*1e3+D6),t.getTimezoneOffset()!==F6&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-F6)),t}var L6=new Date("2017-02-19T19:06:09.000Z"),P6=isNaN(L6.getFullYear())?new Date("2/19/17"):L6,M6=2017==P6.getFullYear();function j6(e,t){var n=new Date(e);if(M6)return t>0?n.setTime(n.getTime()+60*n.getTimezoneOffset()*1e3):t<0&&n.setTime(n.getTime()-60*n.getTimezoneOffset()*1e3),n;if(e instanceof Date)return e;if(1917==P6.getFullYear()&&!isNaN(n.getFullYear())){var r=n.getFullYear();return e.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-60*i.getTimezoneOffset()*1e3)),i}function B6(e,t){if(b5&&Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return l8(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return l8(h5(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!==typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return l8(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return l8(new TextDecoder("utf-16be").decode(e.slice(2)))}var n={"\u20ac":"\x80","\u201a":"\x82","\u0192":"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02c6":"\x88","\u2030":"\x89","\u0160":"\x8a","\u2039":"\x8b","\u0152":"\x8c","\u017d":"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99","\u0161":"\x9a","\u203a":"\x9b","\u0153":"\x9c","\u017e":"\x9e","\u0178":"\x9f"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,function(e){return n[e]||e})}catch(ci){}for(var r=[],a=0;a!=e.length;++a)r.push(String.fromCharCode(e[a]));return r.join("")}function z6(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=z6(e[n]));return t}function W6(e,t){for(var n="";n.length<t;)n+=e;return n}function U6(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var n=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return isNaN(t=Number(r))?(r=r.replace(/[(](.*)[)]/,function(e,t){return n=-n,t}),isNaN(t=Number(r))?t:t/n):t/n}var V6=["january","february","march","april","may","june","july","august","september","october","november","december"];function H6(e){var t=new Date(e),n=new Date(NaN),r=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return n;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==V6.indexOf(o))return n}else if(o.match(/[a-z]/))return n;return r<0||r>8099?n:(a>0||i>1)&&101!=r?t:e.match(/[^-0-9:,\/\\]/)?n:t}function G6(e,t,n){if(e.FullPaths){var r;if("string"==typeof n)return r=b5?x5(n):function(e){for(var t=[],n=0,r=e.length+250,a=y5(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)a[n++]=o;else if(o<2048)a[n++]=192|o>>6&31,a[n++]=128|63&o;else if(o>=55296&&o<57344){o=64+(1023&o);var s=1023&e.charCodeAt(++i);a[n++]=240|o>>8&7,a[n++]=128|o>>2&63,a[n++]=128|s>>6&15|(3&o)<<4,a[n++]=128|63&s}else a[n++]=224|o>>12&15,a[n++]=128|o>>6&63,a[n++]=128|63&o;n>r&&(t.push(a.slice(0,n)),n=0,a=y5(65535),r=65530)}return t.push(a.slice(0,n)),C5(t)}(n),w6.utils.cfb_add(e,t,r);w6.utils.cfb_add(e,t,n)}else e.file(t,n)}function q6(){return w6.utils.cfb_new()}var K6='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n';var X6={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Y6=_6(X6),$6=/[&<>'"]/g,J6=/[\u0000-\u0008\u000b-\u001f]/g;function Q6(e){return(e+"").replace($6,function(e){return Y6[e]}).replace(J6,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Z6(e){return Q6(e).replace(/ /g,"_x0020_")}var e8=/[\u0000-\u001f]/g;function t8(e){return(e+"").replace($6,function(e){return Y6[e]}).replace(/\n/g,"<br/>").replace(e8,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}function n8(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function r8(e){for(var t="",n=0,r=0,a=0,i=0,o=0,s=0;n<e.length;)(r=e.charCodeAt(n++))<128?t+=String.fromCharCode(r):(a=e.charCodeAt(n++),r>191&&r<224?(o=(31&r)<<6,o|=63&a,t+=String.fromCharCode(o)):(i=e.charCodeAt(n++),r<240?t+=String.fromCharCode((15&r)<<12|(63&a)<<6|63&i):(s=((7&r)<<18|(63&a)<<12|(63&i)<<6|63&(o=e.charCodeAt(n++)))-65536,t+=String.fromCharCode(55296+(s>>>10&1023)),t+=String.fromCharCode(56320+(1023&s)))));return t}function a8(e){var t,n,r,a=y5(2*e.length),i=1,o=0,s=0;for(n=0;n<e.length;n+=i)i=1,(r=e.charCodeAt(n))<128?t=r:r<224?(t=64*(31&r)+(63&e.charCodeAt(n+1)),i=2):r<240?(t=4096*(15&r)+64*(63&e.charCodeAt(n+1))+(63&e.charCodeAt(n+2)),i=3):(i=4,t=262144*(7&r)+4096*(63&e.charCodeAt(n+1))+64*(63&e.charCodeAt(n+2))+(63&e.charCodeAt(n+3)),s=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==s&&(a[o++]=255&s,a[o++]=s>>>8,s=0),a[o++]=t%256,a[o++]=t>>>8;return a.slice(0,o).toString("ucs2")}function i8(e){return x5(e,"binary").toString("utf8")}var o8="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",s8=b5&&(i8(o8)==r8(o8)&&i8||a8(o8)==r8(o8)&&a8)||r8,l8=b5?function(e){return x5(e,"utf8").toString("binary")}:function(e){for(var t=[],n=0,r=0,a=0;n<e.length;)switch(r=e.charCodeAt(n++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(63&r)));break;case r>=55296&&r<57344:r-=55296,a=e.charCodeAt(n++)-56320+(r<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(63&a)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(63&r)))}return t.join("")},c8=function(){var e=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),r=0;r<e.length;++r)n=n.replace(e[r][0],e[r][1]);return n}}();var u8=/(^\s|\s$|\n)/;function h8(e,t){return"<"+e+(t.match(u8)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function d8(e){return C6(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function f8(e,t,n){return"<"+e+(null!=n?d8(n):"")+(null!=t?(t.match(u8)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function p8(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(ci){if(t)throw ci}return""}var g8="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",m8="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",v8="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",b8="http://schemas.openxmlformats.org/package/2006/content-types",x8="http://schemas.openxmlformats.org/package/2006/relationships",y8="http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",w8="http://purl.org/dc/elements/1.1/",k8="http://purl.org/dc/terms/",N8="http://purl.org/dc/dcmitype/",S8="http://schemas.openxmlformats.org/officeDocument/2006/relationships",C8="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",E8="http://www.w3.org/2001/XMLSchema-instance",_8="http://www.w3.org/2001/XMLSchema",I8=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],T8="urn:schemas-microsoft-com:office:office",A8="urn:schemas-microsoft-com:office:excel",R8="urn:schemas-microsoft-com:office:spreadsheet",D8="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",F8="http://macVmlSchemaUri",O8="urn:schemas-microsoft-com:vml",L8="http://www.w3.org/TR/REC-html40";var P8=function(e){for(var t=[],n=0;n<e[0].length;++n)if(e[0][n])for(var r=0,a=e[0][n].length;r<a;r+=10240)t.push.apply(t,e[0][n].slice(r,r+10240));return t},M8=b5?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(e){return Buffer.isBuffer(e)?e:x5(e)})):P8(e)}:P8,j8=function(e,t,n){for(var r=[],a=t;a<n;a+=2)r.push(String.fromCharCode(i7(e,a)));return r.join("").replace(E5,"")},B8=b5?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(E5,""):j8(e,t,n)}:j8,z8=function(e,t,n){for(var r=[],a=t;a<t+n;++a)r.push(("0"+e[a].toString(16)).slice(-2));return r.join("")},W8=b5?function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):z8(e,t,n)}:z8,U8=function(e,t,n){for(var r=[],a=t;a<n;a++)r.push(String.fromCharCode(a7(e,a)));return r.join("")},V8=b5?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf8",t,n):U8(e,t,n)}:U8,H8=function(e,t){var n=s7(e,t);return n>0?V8(e,t+4,t+4+n-1):""},G8=H8,q8=function(e,t){var n=s7(e,t);return n>0?V8(e,t+4,t+4+n-1):""},K8=q8,X8=function(e,t){var n=2*s7(e,t);return n>0?V8(e,t+4,t+4+n-1):""},Y8=X8,$8=function(e,t){var n=s7(e,t);return n>0?B8(e,t+4,t+4+n):""},J8=$8,Q8=function(e,t){var n=s7(e,t);return n>0?V8(e,t+4,t+4+n):""},Z8=Q8,e7=function(e,t){return function(e,t){for(var n=1-2*(e[t+7]>>>7),r=((127&e[t+7])<<4)+(e[t+6]>>>4&15),a=15&e[t+6],i=5;i>=0;--i)a=256*a+e[t+i];return 2047==r?0==a?n*(1/0):NaN:(0==r?r=-1022:(r-=1023,a+=Math.pow(2,52)),n*Math.pow(2,r-52)*a)}(e,t)},t7=e7,n7=function(e){return Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array};function r7(){B8=function(e,t,n){return d5.utils.decode(1200,e.slice(t,n)).replace(E5,"")},V8=function(e,t,n){return d5.utils.decode(65001,e.slice(t,n))},G8=function(e,t){var n=s7(e,t);return n>0?d5.utils.decode(i5,e.slice(t+4,t+4+n-1)):""},K8=function(e,t){var n=s7(e,t);return n>0?d5.utils.decode(a5,e.slice(t+4,t+4+n-1)):""},Y8=function(e,t){var n=2*s7(e,t);return n>0?d5.utils.decode(1200,e.slice(t+4,t+4+n-1)):""},J8=function(e,t){var n=s7(e,t);return n>0?d5.utils.decode(1200,e.slice(t+4,t+4+n)):""},Z8=function(e,t){var n=s7(e,t);return n>0?d5.utils.decode(65001,e.slice(t+4,t+4+n)):""}}b5&&(G8=function(e,t){if(!Buffer.isBuffer(e))return H8(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},K8=function(e,t){if(!Buffer.isBuffer(e))return q8(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},Y8=function(e,t){if(!Buffer.isBuffer(e))return X8(e,t);var n=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n-1)},J8=function(e,t){if(!Buffer.isBuffer(e))return $8(e,t);var n=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n)},Z8=function(e,t){if(!Buffer.isBuffer(e))return Q8(e,t);var n=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+n)},t7=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):e7(e,t)},n7=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array}),"undefined"!==typeof d5&&r7();var a7=function(e,t){return e[t]},i7=function(e,t){return 256*e[t+1]+e[t]},o7=function(e,t){var n=256*e[t+1]+e[t];return n<32768?n:-1*(65535-n+1)},s7=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},l7=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},c7=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function u7(e,t){var n,r,a,i,o,s,l="",c=[];switch(t){case"dbcs":if(s=this.l,b5&&Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(o=0;o<e;++o)l+=String.fromCharCode(i7(this,s)),s+=2;e*=2;break;case"utf8":l=V8(this,this.l,this.l+e);break;case"utf16le":e*=2,l=B8(this,this.l,this.l+e);break;case"wstr":if("undefined"===typeof d5)return u7.call(this,e,"dbcs");l=d5.utils.decode(a5,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":l=G8(this,this.l),e=4+s7(this,this.l);break;case"lpstr-cp":l=K8(this,this.l),e=4+s7(this,this.l);break;case"lpwstr":l=Y8(this,this.l),e=4+2*s7(this,this.l);break;case"lpp4":e=4+s7(this,this.l),l=J8(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+s7(this,this.l),l=Z8(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(a=a7(this,this.l+e++));)c.push(f5(a));l=c.join("");break;case"_wstr":for(e=0,l="";0!==(a=i7(this,this.l+e));)c.push(f5(a)),e+=2;e+=2,l=c.join("");break;case"dbcs-cont":for(l="",s=this.l,o=0;o<e;++o){if(this.lens&&-1!==this.lens.indexOf(s))return a=a7(this,s),this.l=s+1,i=u7.call(this,e-o,a?"dbcs-cont":"sbcs-cont"),c.join("")+i;c.push(f5(i7(this,s))),s+=2}l=c.join(""),e*=2;break;case"cpstr":if("undefined"!==typeof d5){l=d5.utils.decode(a5,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(l="",s=this.l,o=0;o!=e;++o){if(this.lens&&-1!==this.lens.indexOf(s))return a=a7(this,s),this.l=s+1,i=u7.call(this,e-o,a?"dbcs-cont":"sbcs-cont"),c.join("")+i;c.push(f5(a7(this,s))),s+=1}l=c.join("");break;default:switch(e){case 1:return n=a7(this,this.l),this.l++,n;case 2:return n=("i"===t?o7:i7)(this,this.l),this.l+=2,n;case 4:case-4:return"i"===t||0===(128&this[this.l+3])?(n=(e>0?l7:c7)(this,this.l),this.l+=4,n):(r=s7(this,this.l),this.l+=4,r);case 8:case-8:if("f"===t)return r=8==e?t7(this,this.l):t7([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;e=8;case 16:l=W8(this,this.l,e)}}return this.l+=e,l}var h7=function(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},d7=function(e,t,n){e[n]=255&t,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255},f7=function(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255};function p7(e,t,n){var r=0,a=0;if("dbcs"===n){for(a=0;a!=t.length;++a)f7(this,t.charCodeAt(a),this.l+2*a);r=2*t.length}else if("sbcs"===n){if("undefined"!==typeof d5&&874==i5)for(a=0;a!=t.length;++a){var i=d5.utils.encode(i5,t.charAt(a));this[this.l+a]=i[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=255&t.charCodeAt(a);r=t.length}else{if("hex"===n){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}if("utf16le"===n){var o=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var s=t.charCodeAt(a);this[this.l++]=255&s,this[this.l++]=s>>8}for(;this.l<o;)this[this.l++]=0;return this}switch(e){case 1:r=1,this[this.l]=255&t;break;case 2:r=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:r=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:r=4,h7(this,t,this.l);break;case 8:if(r=8,"f"===n){!function(e,t,n){var r=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,o=r?-t:t;isFinite(o)?0==o?a=i=0:(a=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var s=0;s<=5;++s,i/=256)e[n+s]=255&i;e[n+6]=(15&a)<<4|15&i,e[n+7]=a>>4|r}(this,t,this.l);break}case 16:break;case-4:r=4,d7(this,t,this.l)}}return this.l+=r,this}function g7(e,t){var n=W8(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function m7(e,t){e.l=t,e.read_shift=u7,e.chk=g7,e.write_shift=p7}function v7(e,t){e.l+=t}function b7(e){var t=y5(e);return m7(t,0),t}function x7(){var e=[],t=b5?256:2048,n=function(e){var t=b7(e);return m7(t,0),t},r=n(t),a=function(){r&&(r.length>r.l&&((r=r.slice(0,r.l)).l=r.length),r.length>0&&e.push(r),r=null)},i=function(e){return r&&e<r.length-r.l?r:(a(),r=n(Math.max(e+1,t)))};return{next:i,push:function(e){a(),null==(r=e).l&&(r.l=r.length),i(t)},end:function(){return a(),C5(e)},_bufs:e}}function y7(e,t,n,r){var a,i=+t;if(!isNaN(i)){r||(r=Lne[i].p||(n||[]).length||0),a=1+(i>=128?1:0)+1,r>=128&&++a,r>=16384&&++a,r>=2097152&&++a;var o=e.next(a);i<=127?o.write_shift(1,i):(o.write_shift(1,128+(127&i)),o.write_shift(1,i>>7));for(var s=0;4!=s;++s){if(!(r>=128)){o.write_shift(1,r);break}o.write_shift(1,128+(127&r)),r>>=7}r>0&&n7(n)&&e.push(n)}}function w7(e,t,n){var r=z6(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function k7(e,t,n){var r=z6(e);return r.s=w7(r.s,t.s,n),r.e=w7(r.e,t.s,n),r}function N7(e,t){if(e.cRel&&e.c<0)for(e=z6(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=z6(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var n=A7(e);return e.cRel||null==e.cRel||(n=n.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(n=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(n)),n}function S7(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?N7(e.s,t.biff)+":"+N7(e.e,t.biff):(e.s.rRel?"":"$")+E7(e.s.r)+":"+(e.e.rRel?"":"$")+E7(e.e.r):(e.s.cRel?"":"$")+I7(e.s.c)+":"+(e.e.cRel?"":"$")+I7(e.e.c)}function C7(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function E7(e){return""+(e+1)}function _7(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),n=0,r=0;r!==t.length;++r)n=26*n+t.charCodeAt(r)-64;return n-1}function I7(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function T7(e){for(var t=0,n=0,r=0;r<e.length;++r){var a=e.charCodeAt(r);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(n=26*n+(a-64))}return{c:n-1,r:t-1}}function A7(e){for(var t=e.c+1,n="";t;t=(t-1)/26|0)n=String.fromCharCode((t-1)%26+65)+n;return n+(e.r+1)}function R7(e){var t=e.indexOf(":");return-1==t?{s:T7(e),e:T7(e)}:{s:T7(e.slice(0,t)),e:T7(e.slice(t+1))}}function D7(e,t){return"undefined"===typeof t||"number"===typeof t?D7(e.s,e.e):("string"!==typeof e&&(e=A7(e)),"string"!==typeof t&&(t=A7(t)),e==t?e:e+":"+t)}function F7(e){var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,a=0,i=e.length;for(n=0;r<i&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(t.s.c=--n,n=0;r<i&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;if(t.s.r=--n,r===i||10!=a)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,n=0;r!=i&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(t.e.c=--n,n=0;r!=i&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;return t.e.r=--n,t}function O7(e,t){var n="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=g6(e.z,n?A6(t):t)}catch(ci){}try{return e.w=g6((e.XF||{}).numFmtId||(n?14:0),n?A6(t):t)}catch(ci){return""+t}}function L7(e,t,n){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),"e"==e.t?m9[e.v]||e.v:O7(e,void 0==t?e.v:t))}function P7(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",r={};return r[n]=e,{SheetNames:[n],Sheets:r}}function M7(e,t,n){var r=n||{},a=e?Array.isArray(e):r.dense;var i=e||(a?[]:{}),o=0,s=0;if(i&&null!=r.origin){if("number"==typeof r.origin)o=r.origin;else{var l="string"==typeof r.origin?T7(r.origin):r.origin;o=l.r,s=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=F7(i["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),-1==o&&(c.e.r=o=u.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=t[h].length;++d)if("undefined"!==typeof t[h][d]){var f={v:t[h][d]},p=o+h,g=s+d;if(c.s.r>p&&(c.s.r=p),c.s.c>g&&(c.s.c=g),c.e.r<p&&(c.e.r=p),c.e.c<g&&(c.e.c=g),!t[h][d]||"object"!==typeof t[h][d]||Array.isArray(t[h][d])||t[h][d]instanceof Date)if(Array.isArray(f.v)&&(f.f=t[h][d][1],f.v=f.v[0]),null===f.v)if(f.f)f.t="n";else if(r.nullError)f.t="e",f.v=0;else{if(!r.sheetStubs)continue;f.t="z"}else"number"===typeof f.v?f.t="n":"boolean"===typeof f.v?f.t="b":f.v instanceof Date?(f.z=r.dateNF||M5[14],r.cellDates?(f.t="d",f.w=g6(f.z,A6(f.v))):(f.t="n",f.v=A6(f.v),f.w=g6(f.z,f.v))):f.t="s";else f=t[h][d];if(a)i[p]||(i[p]=[]),i[p][g]&&i[p][g].z&&(f.z=i[p][g].z),i[p][g]=f;else{var m=A7({c:g,r:p});i[m]&&i[m].z&&(f.z=i[m].z),i[m]=f}}}return c.s.c<1e7&&(i["!ref"]=D7(c)),i}function j7(e,t){return M7(null,e,t)}function B7(e,t){return t||(t=b7(4)),t.write_shift(4,e),t}function z7(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function W7(e,t){var n=!1;return null==t&&(n=!0,t=b7(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}function U7(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function V7(e,t){var n=e.l,r=e.read_shift(1),a=z7(e),i=[],o={t:a,h:a};if(0!==(1&r)){for(var s=e.read_shift(4),l=0;l!=s;++l)i.push(U7(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=n+t,o}var H7=V7;function G7(e,t){var n=!1;return null==t&&(n=!0,t=b7(23+4*e.t.length)),t.write_shift(1,1),W7(e.t,t),t.write_shift(4,1),function(e,t){t||(t=b7(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0)}({ich:0,ifnt:0},t),n?t.slice(0,t.l):t}function q7(e){var t=e.read_shift(4),n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:n}}function K7(e,t){return null==t&&(t=b7(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function X7(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Y7(e,t){return null==t&&(t=b7(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var $7=z7,J7=W7;function Q7(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}function Z7(e,t){var n=!1;return null==t&&(n=!0,t=b7(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}var e9=z7,t9=Q7,n9=Z7;function r9(e){var t=e.slice(e.l,e.l+4),n=1&t[0],r=2&t[0];e.l+=4;var a=0===r?t7([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):l7(t,0)>>2;return n?a/100:a}function a9(e,t){null==t&&(t=b7(4));var n=0,r=0,a=100*e;if(e==(0|e)&&e>=-(1<<29)&&e<1<<29?r=1:a==(0|a)&&a>=-(1<<29)&&a<1<<29&&(r=1,n=1),!r)throw new Error("unsupported RkNumber "+e);t.write_shift(-4,((n?a:e)<<2)+(n+2))}function i9(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var o9=i9,s9=function(e,t){return t||(t=b7(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t};function l9(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function c9(e,t){return(t||b7(8)).write_shift(8,e,"f")}function u9(e,t){if(t||(t=b7(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;null!=e.index?(t.write_shift(1,2),t.write_shift(1,e.index)):null!=e.theme?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var n=e.tint||0;if(n>0?n*=32767:n<0&&(n*=32768),t.write_shift(2,n),e.rgb&&null==e.theme){var r=e.rgb||"FFFFFF";"number"==typeof r&&(r=("000000"+r.toString(16)).slice(-6)),t.write_shift(1,parseInt(r.slice(0,2),16)),t.write_shift(1,parseInt(r.slice(2,4),16)),t.write_shift(1,parseInt(r.slice(4,6),16)),t.write_shift(1,255)}else t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);return t}var h9=80,d9={1:{n:"CodePage",t:2},2:{n:"Category",t:h9},3:{n:"PresentationFormat",t:h9},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:h9},15:{n:"Company",t:h9},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:h9},27:{n:"ContentStatus",t:h9},28:{n:"Language",t:h9},29:{n:"Version",t:h9},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},f9={1:{n:"CodePage",t:2},2:{n:"Title",t:h9},3:{n:"Subject",t:h9},4:{n:"Author",t:h9},5:{n:"Keywords",t:h9},6:{n:"Comments",t:h9},7:{n:"Template",t:h9},8:{n:"LastAuthor",t:h9},9:{n:"RevNumber",t:h9},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:h9},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}};function p9(e){return e.map(function(e){return[e>>16&255,e>>8&255,255&e]})}var g9=z6(p9([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),m9={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},v9={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},b9={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function x9(e,t){var n,r=function(e){for(var t=[],n=C6(e),r=0;r!==n.length;++r)null==t[e[n[r]]]&&(t[e[n[r]]]=[]),t[e[n[r]]].push(n[r]);return t}(v9),a=[];a[a.length]=K6,a[a.length]=f8("Types",null,{xmlns:b8,"xmlns:xsd":_8,"xmlns:xsi":E8}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(e){return f8("Default",null,{Extension:e[0],ContentType:e[1]})}));var i=function(r){e[r]&&e[r].length>0&&(n=e[r][0],a[a.length]=f8("Override",null,{PartName:("/"==n[0]?"":"/")+n,ContentType:b9[r][t.bookType]||b9[r].xlsx}))},o=function(n){(e[n]||[]).forEach(function(e){a[a.length]=f8("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:b9[n][t.bookType]||b9[n].xlsx})})},s=function(t){(e[t]||[]).forEach(function(e){a[a.length]=f8("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:r[t][0]})})};return i("workbooks"),o("sheets"),o("charts"),s("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(s),s("vba"),s("comments"),s("threadedcomments"),s("drawings"),o("metadata"),s("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var y9={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function w9(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function k9(e){var t=[K6,f8("Relationships",null,{xmlns:x8})];return C6(e["!id"]).forEach(function(n){t[t.length]=f8("Relationship",null,e["!id"][n])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function N9(e,t,n,r,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=r,a.Target=n,i?a.TargetMode=i:[y9.HLINK,y9.XPATH,y9.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}function S9(e,t,n){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+t+'"/>\n',"  </rdf:Description>\n"].join("")}function C9(e,t){return['  <rdf:Description rdf:about="'+e+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+'"/>\n',"  </rdf:Description>\n"].join("")}function E9(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+r5.version+"</meta:generator></office:meta></office:document-meta>"}var _9=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function I9(e,t,n,r,a){null==a[e]&&null!=t&&""!==t&&(a[e]=t,t=Q6(t),r[r.length]=n?f8(e,t,n):h8(e,t))}function T9(e,t){var n=t||{},r=[K6,f8("cp:coreProperties",null,{"xmlns:cp":g8,"xmlns:dc":w8,"xmlns:dcterms":k8,"xmlns:dcmitype":N8,"xmlns:xsi":E8})],a={};if(!e&&!n.Props)return r.join("");e&&(null!=e.CreatedDate&&I9("dcterms:created","string"===typeof e.CreatedDate?e.CreatedDate:p8(e.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,a),null!=e.ModifiedDate&&I9("dcterms:modified","string"===typeof e.ModifiedDate?e.ModifiedDate:p8(e.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,a));for(var i=0;i!=_9.length;++i){var o=_9[i],s=n.Props&&null!=n.Props[o[1]]?n.Props[o[1]]:e?e[o[1]]:null;!0===s?s="1":!1===s?s="0":"number"==typeof s&&(s=String(s)),null!=s&&I9(o[0],s,null,r,a)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var A9=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],R9=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function D9(e){var t=[],n=f8;return e||(e={}),e.Application="SheetJS",t[t.length]=K6,t[t.length]=f8("Properties",null,{xmlns:v8,"xmlns:vt":C8}),A9.forEach(function(r){if(void 0!==e[r[1]]){var a;switch(r[2]){case"string":a=Q6(String(e[r[1]]));break;case"bool":a=e[r[1]]?"true":"false"}void 0!==a&&(t[t.length]=n(r[0],a))}}),t[t.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=n("TitlesOfParts",n("vt:vector",e.SheetNames.map(function(e){return"<vt:lpstr>"+Q6(e)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function F9(e){var t=[K6,f8("Properties",null,{xmlns:m8,"xmlns:vt":C8})];if(!e)return t.join("");var n=1;return C6(e).forEach(function(r){++n,t[t.length]=f8("property",function(e,t){switch(typeof e){case"string":var n=f8("vt:lpwstr",Q6(e));return t&&(n=n.replace(/&quot;/g,"_x0022_")),n;case"number":return f8((0|e)==e?"vt:i4":"vt:r8",Q6(String(e)));case"boolean":return f8("vt:bool",e?"true":"false")}if(e instanceof Date)return f8("vt:filetime",p8(e));throw new Error("Unable to serialize "+e)}(e[r],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:Q6(r)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var O9={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function L9(e,t){var n=b7(4),r=b7(4);switch(n.write_shift(4,80==e?31:e),e){case 3:r.write_shift(-4,t);break;case 5:(r=b7(8)).write_shift(8,t,"f");break;case 11:r.write_shift(4,t?1:0);break;case 64:r=function(e){var t=("string"==typeof e?new Date(Date.parse(e)):e).getTime()/1e3+11644473600,n=t%Math.pow(2,32),r=(t-n)/Math.pow(2,32);r*=1e7;var a=(n*=1e7)/Math.pow(2,32)|0;a>0&&(n%=Math.pow(2,32),r+=a);var i=b7(8);return i.write_shift(4,n),i.write_shift(4,r),i}(t);break;case 31:case 80:for((r=b7(4+2*(t.length+1)+(t.length%2?0:2))).write_shift(4,t.length+1),r.write_shift(0,t,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return C5([n,r])}var P9=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function M9(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return-1}function j9(e,t,n){var r=b7(8),a=[],i=[],o=8,s=0,l=b7(8),c=b7(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),i.push(l),a.push(c),o+=8+l.length,!t){(c=b7(8)).write_shift(4,0),a.unshift(c);var u=[b7(4)];for(u[0].write_shift(4,e.length),s=0;s<e.length;++s){var h=e[s][0];for((l=b7(8+2*(h.length+1)+(h.length%2?0:2))).write_shift(4,s+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=C5(u),i.unshift(l),o+=8+l.length}for(s=0;s<e.length;++s)if((!t||t[e[s][0]])&&!(P9.indexOf(e[s][0])>-1||R9.indexOf(e[s][0])>-1)&&null!=e[s][1]){var d=e[s][1],f=0;if(t){var p=n[f=+t[e[s][0]]];if("version"==p.p&&"string"==typeof d){var g=d.split(".");d=(+g[0]<<16)+(+g[1]||0)}l=L9(p.t,d)}else{var m=M9(d);-1==m&&(m=31,d=String(d)),l=L9(m,d)}i.push(l),(c=b7(8)).write_shift(4,t?f:2+s),a.push(c),o+=8+l.length}var v=8*(i.length+1);for(s=0;s<i.length;++s)a[s].write_shift(4,v),v+=i[s].length;return r.write_shift(4,o),r.write_shift(4,i.length),C5([r].concat(a).concat(i))}function B9(e,t,n,r,a,i){var o=b7(a?68:48),s=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,w6.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,a?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,a?68:48);var l=j9(e,n,r);if(s.push(l),a){var c=j9(a,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+l.length),s.push(c)}return C5(s)}function z9(e,t){return 1===e.read_shift(t)}function W9(e,t){return t||(t=b7(2)),t.write_shift(2,+!!e),t}function U9(e){return e.read_shift(2,"u")}function V9(e,t){return t||(t=b7(2)),t.write_shift(2,e),t}function H9(e,t,n){return n||(n=b7(2)),n.write_shift(1,"e"==t?+e:+!!e),n.write_shift(1,"e"==t?1:0),n}function G9(e,t,n){var r=e.read_shift(n&&n.biff>=12?2:1),a="sbcs-cont",i=a5;(n&&n.biff>=8&&(a5=1200),n&&8!=n.biff)?12==n.biff&&(a="wstr"):e.read_shift(1)&&(a="dbcs-cont");n.biff>=2&&n.biff<=5&&(a="cpstr");var o=r?e.read_shift(r,a):"";return a5=i,o}function q9(e){var t=e.t||"",n=b7(3);n.write_shift(2,t.length),n.write_shift(1,1);var r=b7(2*t.length);return r.write_shift(2*t.length,t,"utf16le"),C5([n,r])}function K9(e,t,n){if(n){if(n.biff>=2&&n.biff<=5)return e.read_shift(t,"cpstr");if(n.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function X9(e,t,n){var r=e.read_shift(n&&2==n.biff?1:2);return 0===r?(e.l++,""):K9(e,r,n)}function Y9(e,t,n){if(n.biff>5)return X9(e,0,n);var r=e.read_shift(1);return 0===r?(e.l++,""):e.read_shift(r,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function $9(e,t,n){return n||(n=b7(3+2*e.length)),n.write_shift(2,e.length),n.write_shift(1,1),n.write_shift(31,e,"utf16le"),n}function J9(e,t){t||(t=b7(6+2*e.length)),t.write_shift(4,1+e.length);for(var n=0;n<e.length;++n)t.write_shift(2,e.charCodeAt(n));return t.write_shift(2,0),t}function Q9(e){var t=b7(512),n=0,r=e.Target;"file://"==r.slice(0,7)&&(r=r.slice(7));var a=r.indexOf("#"),i=a>-1?31:23;switch(r.charAt(0)){case"#":i=28;break;case".":i&=-3}t.write_shift(4,2),t.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(n=0;n<o.length;++n)t.write_shift(4,o[n]);if(28==i)J9(r=r.slice(1),t);else if(2&i){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<o.length;++n)t.write_shift(1,parseInt(o[n],16));var s=a>-1?r.slice(0,a):r;for(t.write_shift(4,2*(s.length+1)),n=0;n<s.length;++n)t.write_shift(2,s.charCodeAt(n));t.write_shift(2,0),8&i&&J9(a>-1?r.slice(a+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<o.length;++n)t.write_shift(1,parseInt(o[n],16));for(var l=0;"../"==r.slice(3*l,3*l+3)||"..\\"==r.slice(3*l,3*l+3);)++l;for(t.write_shift(2,l),t.write_shift(4,r.length-3*l+1),n=0;n<r.length-3*l;++n)t.write_shift(1,255&r.charCodeAt(n+3*l));for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),n=0;n<6;++n)t.write_shift(4,0)}return t.slice(0,t.l)}function Z9(e,t,n,r){return r||(r=b7(6)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,n||0),r}function eee(e,t,n){var r=n.biff>8?4:2;return[e.read_shift(r),e.read_shift(r,"i"),e.read_shift(r,"i")]}function tee(e){var t=e.read_shift(2),n=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:n}}}function nee(e,t){return t||(t=b7(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function ree(e,t,n){var r=1536,a=16;switch(n.bookType){case"biff8":case"xla":break;case"biff5":r=1280,a=8;break;case"biff4":r=4,a=6;break;case"biff3":r=3,a=6;break;case"biff2":r=2,a=4;break;default:throw new Error("unsupported BIFF version")}var i=b7(a);return i.write_shift(2,r),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function aee(e,t){var n=!t||t.biff>=8?2:1,r=b7(8+n*e.name.length);r.write_shift(4,e.pos),r.write_shift(1,e.hs||0),r.write_shift(1,e.dt),r.write_shift(1,e.name.length),t.biff>=8&&r.write_shift(1,1),r.write_shift(n*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=r.slice(0,r.l);return a.l=r.l,a}function iee(e,t,n,r){var a=n&&5==n.biff;r||(r=b7(a?3+t.length:5+2*t.length)),r.write_shift(2,e),r.write_shift(a?1:2,t.length),a||r.write_shift(1,1),r.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=r.length>r.l?r.slice(0,r.l):r;return null==i.l&&(i.l=i.length),i}function oee(e,t,n,r){var a=n&&5==n.biff;r||(r=b7(a?16:20)),r.write_shift(2,0),e.style?(r.write_shift(2,e.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,e.numFmtId||0),r.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),r.write_shift(4,i),r.write_shift(4,0),a||r.write_shift(4,0),r.write_shift(2,0),r}function see(e,t,n){if(n.biff<8)return function(e,t,n){3==e[e.l+1]&&e[e.l]++;var r=G9(e,0,n);return 3==r.charCodeAt(0)?r.slice(1):r}(e,0,n);for(var r=[],a=e.l+t,i=e.read_shift(n.biff>8?4:2);0!==i--;)r.push(eee(e,n.biff,n));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return r}function lee(e){var t=b7(24),n=T7(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(r[a],16));return C5([t,Q9(e[1])])}function cee(e){var t=e[1].Tooltip,n=b7(10+2*(t.length+1));n.write_shift(2,2048);var r=T7(e[0]);n.write_shift(2,r.r),n.write_shift(2,r.r),n.write_shift(2,r.c),n.write_shift(2,r.c);for(var a=0;a<t.length;++a)n.write_shift(2,t.charCodeAt(a));return n.write_shift(2,0),n}function uee(e,t,n){if(!n.cellStyles)return v7(e,t);var r=n&&n.biff>=12?4:2,a=e.read_shift(r),i=e.read_shift(r),o=e.read_shift(r),s=e.read_shift(r),l=e.read_shift(2);2==r&&(e.l+=2);var c={s:a,e:i,w:o,ixfe:s,flags:l};return(n.biff>=5||!n.biff)&&(c.level=l>>8&7),c}var hee=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=_6({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(t,n){var r=n||{};r.dateNF||(r.dateNF="yyyymmdd");var a=j7(function(t,n){var r=[],a=y5(1);switch(n.type){case"base64":a=k5(v5(t));break;case"binary":a=k5(t);break;case"buffer":case"array":a=t}m7(a,0);var i=a.read_shift(1),o=!!(136&i),s=!1,l=!1;switch(i){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:s=!0,o=!0;break;case 140:l=!0;break;default:throw new Error("DBF Unsupported Version: "+i.toString(16))}var c=0,u=521;2==i&&(c=a.read_shift(2)),a.l+=3,2!=i&&(c=a.read_shift(4)),c>1048576&&(c=1e6),2!=i&&(u=a.read_shift(2));var h=a.read_shift(2),d=n.codepage||1252;2!=i&&(a.l+=16,a.read_shift(1),0!==a[a.l]&&(d=e[a[a.l]]),a.l+=1,a.l+=2),l&&(a.l+=36);for(var f=[],p={},g=Math.min(a.length,2==i?521:u-10-(s?264:0)),m=l?32:11;a.l<g&&13!=a[a.l];)switch((p={}).name=d5.utils.decode(d,a.slice(a.l,a.l+m)).replace(/[\u0000\r\n].*$/g,""),a.l+=m,p.type=String.fromCharCode(a.read_shift(1)),2==i||l||(p.offset=a.read_shift(4)),p.len=a.read_shift(1),2==i&&(p.offset=a.read_shift(2)),p.dec=a.read_shift(1),p.name.length&&f.push(p),2!=i&&(a.l+=l?13:14),p.type){case"B":s&&8==p.len||!n.WTF||console.log("Skipping "+p.name+":"+p.type);break;case"G":case"P":n.WTF&&console.log("Skipping "+p.name+":"+p.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+p.type)}if(13!==a[a.l]&&(a.l=u-1),13!==a.read_shift(1))throw new Error("DBF Terminator not found "+a.l+" "+a[a.l]);a.l=u;var v=0,b=0;for(r[0]=[],b=0;b!=f.length;++b)r[0][b]=f[b].name;for(;c-- >0;)if(42!==a[a.l])for(++a.l,r[++v]=[],b=0,b=0;b!=f.length;++b){var x=a.slice(a.l,a.l+f[b].len);a.l+=f[b].len,m7(x,0);var y=d5.utils.decode(d,x);switch(f[b].type){case"C":y.trim().length&&(r[v][b]=y.replace(/\s+$/,""));break;case"D":8===y.length?r[v][b]=new Date(+y.slice(0,4),+y.slice(4,6)-1,+y.slice(6,8)):r[v][b]=y;break;case"F":r[v][b]=parseFloat(y.trim());break;case"+":case"I":r[v][b]=l?2147483648^x.read_shift(-4,"i"):x.read_shift(4,"i");break;case"L":switch(y.trim().toUpperCase()){case"Y":case"T":r[v][b]=!0;break;case"N":case"F":r[v][b]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+y+"|")}break;case"M":if(!o)throw new Error("DBF Unexpected MEMO for type "+i.toString(16));r[v][b]="##MEMO##"+(l?parseInt(y.trim(),10):x.read_shift(4));break;case"N":(y=y.replace(/\u0000/g,"").trim())&&"."!=y&&(r[v][b]=+y||0);break;case"@":r[v][b]=new Date(x.read_shift(-8,"f")-621356832e5);break;case"T":r[v][b]=new Date(864e5*(x.read_shift(4)-2440588)+x.read_shift(4));break;case"Y":r[v][b]=x.read_shift(4,"i")/1e4+x.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":r[v][b]=-x.read_shift(-8,"f");break;case"B":if(s&&8==f[b].len){r[v][b]=x.read_shift(8,"f");break}case"G":case"P":x.l+=f[b].len;break;case"0":if("_NullFlags"===f[b].name)break;default:throw new Error("DBF Unsupported data type "+f[b].type)}}else a.l+=h;if(2!=i&&a.l<a.length&&26!=a[a.l++])throw new Error("DBF EOF Marker missing "+(a.l-1)+" of "+a.length+" "+a[a.l-1].toString(16));return n&&n.sheetRows&&(r=r.slice(0,n.sheetRows)),n.DBF=f,r}(t,r),r);return a["!cols"]=r.DBF.map(function(e){return{wch:e.len,DBF:e}}),delete r.DBF,a}var r={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return P7(n(e,t),t)}catch(ci){if(t&&t.WTF)throw ci}return{SheetNames:[],Sheets:{}}},to_sheet:n,from_sheet:function(e,n){var a=n||{};if(+a.codepage>=0&&c5(+a.codepage),"string"==a.type)throw new Error("Cannot write DBF to JS string");var i=x7(),o=Dre(e,{header:1,raw:!0,cellDates:!0}),s=o[0],l=o.slice(1),c=e["!cols"]||[],u=0,h=0,d=0,f=1;for(u=0;u<s.length;++u)if(((c[u]||{}).DBF||{}).name)s[u]=c[u].DBF.name,++d;else if(null!=s[u]){if(++d,"number"===typeof s[u]&&(s[u]=s[u].toString(10)),"string"!==typeof s[u])throw new Error("DBF Invalid column name "+s[u]+" |"+typeof s[u]+"|");if(s.indexOf(s[u])!==u)for(h=0;h<1024;++h)if(-1==s.indexOf(s[u]+"_"+h)){s[u]+="_"+h;break}}var p=F7(e["!ref"]),g=[],m=[],v=[];for(u=0;u<=p.e.c-p.s.c;++u){var b="",x="",y=0,w=[];for(h=0;h<l.length;++h)null!=l[h][u]&&w.push(l[h][u]);if(0!=w.length&&null!=s[u]){for(h=0;h<w.length;++h){switch(typeof w[h]){case"number":x="B";break;case"string":default:x="C";break;case"boolean":x="L";break;case"object":x=w[h]instanceof Date?"D":"C"}y=Math.max(y,String(w[h]).length),b=b&&b!=x?"C":x}y>250&&(y=250),"C"==(x=((c[u]||{}).DBF||{}).type)&&c[u].DBF.len>y&&(y=c[u].DBF.len),"B"==b&&"N"==x&&(b="N",v[u]=c[u].DBF.dec,y=c[u].DBF.len),m[u]="C"==b||"N"==x?y:r[b]||0,f+=m[u],g[u]=b}else g[u]="?"}var k=i.next(32);for(k.write_shift(4,318902576),k.write_shift(4,l.length),k.write_shift(2,296+32*d),k.write_shift(2,f),u=0;u<4;++u)k.write_shift(4,0);for(k.write_shift(4,(+t[i5]||3)<<8),u=0,h=0;u<s.length;++u)if(null!=s[u]){var N=i.next(32),S=(s[u].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);N.write_shift(1,S,"sbcs"),N.write_shift(1,"?"==g[u]?"C":g[u],"sbcs"),N.write_shift(4,h),N.write_shift(1,m[u]||r[g[u]]||0),N.write_shift(1,v[u]||0),N.write_shift(1,2),N.write_shift(4,0),N.write_shift(1,0),N.write_shift(4,0),N.write_shift(4,0),h+=m[u]||r[g[u]]||0}var C=i.next(264);for(C.write_shift(4,13),u=0;u<65;++u)C.write_shift(4,0);for(u=0;u<l.length;++u){var E=i.next(f);for(E.write_shift(1,0),h=0;h<s.length;++h)if(null!=s[h])switch(g[h]){case"L":E.write_shift(1,null==l[u][h]?63:l[u][h]?84:70);break;case"B":E.write_shift(8,l[u][h]||0,"f");break;case"N":var _="0";for("number"==typeof l[u][h]&&(_=l[u][h].toFixed(v[h]||0)),d=0;d<m[h]-_.length;++d)E.write_shift(1,32);E.write_shift(1,_,"sbcs");break;case"D":l[u][h]?(E.write_shift(4,("0000"+l[u][h].getFullYear()).slice(-4),"sbcs"),E.write_shift(2,("00"+(l[u][h].getMonth()+1)).slice(-2),"sbcs"),E.write_shift(2,("00"+l[u][h].getDate()).slice(-2),"sbcs")):E.write_shift(8,"00000000","sbcs");break;case"C":var I=String(null!=l[u][h]?l[u][h]:"").slice(0,m[h]);for(E.write_shift(1,I,"sbcs"),d=0;d<m[h]-I.length;++d)E.write_shift(1,32)}}return i.next(1).write_shift(1,26),i.end()}}}(),dee=function(){var e={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1bN("+C6(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(t,n){var r=e[n];return"number"==typeof r?p5(r):r},r=function(e,t,n){var r=t.charCodeAt(0)-32<<4|n.charCodeAt(0)-48;return 59==r?e:p5(r)};function a(e,a){var i,o=e.split(/[\n\r]+/),s=-1,l=-1,c=0,u=0,h=[],d=[],f=null,p={},g=[],m=[],v=[],b=0;for(+a.codepage>=0&&c5(+a.codepage);c!==o.length;++c){b=0;var x,y=o[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,n),w=y.replace(/;;/g,"\0").split(";").map(function(e){return e.replace(/\u0000/g,";")}),k=w[0];if(y.length>0)switch(k){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==w[1].charAt(0)&&d.push(y.slice(3).replace(/;;/g,";"));break;case"C":var N=!1,S=!1,C=!1,E=!1,_=-1,I=-1;for(u=1;u<w.length;++u)switch(w[u].charAt(0)){case"A":case"G":break;case"X":l=parseInt(w[u].slice(1))-1,S=!0;break;case"Y":for(s=parseInt(w[u].slice(1))-1,S||(l=0),i=h.length;i<=s;++i)h[i]=[];break;case"K":'"'===(x=w[u].slice(1)).charAt(0)?x=x.slice(1,x.length-1):"TRUE"===x?x=!0:"FALSE"===x?x=!1:isNaN(U6(x))?isNaN(H6(x).getDate())||(x=j6(x)):(x=U6(x),null!==f&&h6(f)&&(x=O6(x))),"undefined"!==typeof d5&&"string"==typeof x&&"string"!=(a||{}).type&&(a||{}).codepage&&(x=d5.utils.decode(a.codepage,x)),N=!0;break;case"E":E=!0;var T=rte(w[u].slice(1),{r:s,c:l});h[s][l]=[h[s][l],T];break;case"S":C=!0,h[s][l]=[h[s][l],"S5S"];break;case"R":_=parseInt(w[u].slice(1))-1;break;case"C":I=parseInt(w[u].slice(1))-1;break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+y)}if(N&&(h[s][l]&&2==h[s][l].length?h[s][l][0]=x:h[s][l]=x,f=null),C){if(E)throw new Error("SYLK shared formula cannot have own formula");var A=_>-1&&h[_][I];if(!A||!A[1])throw new Error("SYLK shared formula cannot find base");h[s][l][1]=ote(A[1],{r:s-_,c:l-I})}break;case"F":var R=0;for(u=1;u<w.length;++u)switch(w[u].charAt(0)){case"X":l=parseInt(w[u].slice(1))-1,++R;break;case"Y":for(s=parseInt(w[u].slice(1))-1,i=h.length;i<=s;++i)h[i]=[];break;case"M":b=parseInt(w[u].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":f=d[parseInt(w[u].slice(1))];break;case"W":for(v=w[u].slice(1).split(" "),i=parseInt(v[0],10);i<=parseInt(v[1],10);++i)b=parseInt(v[2],10),m[i-1]=0===b?{hidden:!0}:{wch:b},Tee(m[i-1]);break;case"C":m[l=parseInt(w[u].slice(1))-1]||(m[l]={});break;case"R":g[s=parseInt(w[u].slice(1))-1]||(g[s]={}),b>0?(g[s].hpt=b,g[s].hpx=Dee(b)):0===b&&(g[s].hidden=!0);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+y)}R<1&&(f=null);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+y)}}return g.length>0&&(p["!rows"]=g),m.length>0&&(p["!cols"]=m),a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),[h,p]}function i(e,t){var n=function(e,t){switch(t.type){case"base64":return a(v5(e),t);case"binary":return a(e,t);case"buffer":return a(b5&&Buffer.isBuffer(e)?e.toString("binary"):S5(e),t);case"array":return a(B6(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),r=n[0],i=n[1],o=j7(r,t);return C6(i).forEach(function(e){o[e]=i[e]}),o}function o(e,t,n,r){var a="C;Y"+(n+1)+";X"+(r+1)+";K";switch(e.t){case"n":a+=e.v||0,e.f&&!e.F&&(a+=";E"+ite(e.f,{r:n,c:r}));break;case"b":a+=e.v?"TRUE":"FALSE";break;case"e":a+=e.w||e.v;break;case"d":a+='"'+(e.w||e.v)+'"';break;case"s":a+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return a}return e["|"]=254,{to_workbook:function(e,t){return P7(i(e,t),t)},to_sheet:i,from_sheet:function(e,t){var n,r,a=["ID;PWXL;N;E"],i=[],s=F7(e["!ref"]),l=Array.isArray(e),c="\r\n";a.push("P;PGeneral"),a.push("F;P0;DG0G8;M255"),e["!cols"]&&(r=a,e["!cols"].forEach(function(e,t){var n="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?n+="0":("number"!=typeof e.width||e.wpx||(e.wpx=Eee(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=_ee(e.wpx)),"number"==typeof e.wch&&(n+=Math.round(e.wch)))," "!=n.charAt(n.length-1)&&r.push(n)})),e["!rows"]&&function(e,t){t.forEach(function(t,n){var r="F;";t.hidden?r+="M0;":t.hpt?r+="M"+20*t.hpt+";":t.hpx&&(r+="M"+20*Ree(t.hpx)+";"),r.length>2&&e.push(r+"R"+(n+1))})}(a,e["!rows"]),a.push("B;Y"+(s.e.r-s.s.r+1)+";X"+(s.e.c-s.s.c+1)+";D"+[s.s.c,s.s.r,s.e.c,s.e.r].join(" "));for(var u=s.s.r;u<=s.e.r;++u)for(var h=s.s.c;h<=s.e.c;++h){var d=A7({r:u,c:h});(n=l?(e[u]||[])[h]:e[d])&&(null!=n.v||n.f&&!n.F)&&i.push(o(n,0,u,h))}return a.join(c)+c+i.join(c)+c+"E"+c}}}(),fee=function(){function e(e,t){for(var n=e.split("\n"),r=-1,a=-1,i=0,o=[];i!==n.length;++i)if("BOT"!==n[i].trim()){if(!(r<0)){for(var s=n[i].trim().split(","),l=s[0],c=s[1],u=n[++i]||"";1&(u.match(/["]/g)||[]).length&&i<n.length-1;)u+="\n"+n[++i];switch(u=u.trim(),+l){case-1:if("BOT"===u){o[++r]=[],a=0;continue}if("EOD"!==u)throw new Error("Unrecognized DIF special command "+u);break;case 0:"TRUE"===u?o[r][a]=!0:"FALSE"===u?o[r][a]=!1:isNaN(U6(c))?isNaN(H6(c).getDate())?o[r][a]=c:o[r][a]=j6(c):o[r][a]=U6(c),++a;break;case 1:(u=(u=u.slice(1,u.length-1)).replace(/""/g,'"'))&&u.match(/^=".*"$/)&&(u=u.slice(2,-1)),o[r][a++]=""!==u?u:null}if("EOD"===u)break}}else o[++r]=[],a=0;return t&&t.sheetRows&&(o=o.slice(0,t.sheetRows)),o}function t(t,n){return j7(function(t,n){switch(n.type){case"base64":return e(v5(t),n);case"binary":return e(t,n);case"buffer":return e(b5&&Buffer.isBuffer(t)?t.toString("binary"):S5(t),n);case"array":return e(B6(t),n)}throw new Error("Unrecognized type "+n.type)}(t,n),n)}var n=function(){var e=function(e,t,n,r,a){e.push(t),e.push(n+","+r),e.push('"'+a.replace(/"/g,'""')+'"')},t=function(e,t,n,r){e.push(t+","+n),e.push(1==t?'"'+r.replace(/"/g,'""')+'"':r)};return function(n){var r,a=[],i=F7(n["!ref"]),o=Array.isArray(n);e(a,"TABLE",0,1,"sheetjs"),e(a,"VECTORS",0,i.e.r-i.s.r+1,""),e(a,"TUPLES",0,i.e.c-i.s.c+1,""),e(a,"DATA",0,0,"");for(var s=i.s.r;s<=i.e.r;++s){t(a,-1,0,"BOT");for(var l=i.s.c;l<=i.e.c;++l){var c=A7({r:s,c:l});if(r=o?(n[s]||[])[l]:n[c])switch(r.t){case"n":var u=r.w;u||null==r.v||(u=r.v),null==u?r.f&&!r.F?t(a,1,0,"="+r.f):t(a,1,0,""):t(a,0,u,"V");break;case"b":t(a,0,r.v?1:0,r.v?"TRUE":"FALSE");break;case"s":t(a,1,0,isNaN(r.v)?r.v:'="'+r.v+'"');break;case"d":r.w||(r.w=g6(r.z||M5[14],A6(j6(r.v)))),t(a,0,r.w,"V");break;default:t(a,1,0,"")}else t(a,1,0,"")}}t(a,-1,0,"EOD");return a.join("\r\n")}}();return{to_workbook:function(e,n){return P7(t(e,n),n)},to_sheet:t,from_sheet:n}}(),pee=function(){function e(e){return e.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function t(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(t,n){return j7(function(t,n){for(var r=t.split("\n"),a=-1,i=-1,o=0,s=[];o!==r.length;++o){var l=r[o].trim().split(":");if("cell"===l[0]){var c=T7(l[1]);if(s.length<=c.r)for(a=s.length;a<=c.r;++a)s[a]||(s[a]=[]);switch(a=c.r,i=c.c,l[2]){case"t":s[a][i]=e(l[3]);break;case"v":s[a][i]=+l[3];break;case"vtf":var u=l[l.length-1];case"vtc":"nl"===l[3]?s[a][i]=!!+l[4]:s[a][i]=+l[4],"vtf"==l[2]&&(s[a][i]=[s[a][i],u])}}}return n&&n.sheetRows&&(s=s.slice(0,n.sheetRows)),s}(t,n),n)}var r=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",i=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),o="--SocialCalcSpreadsheetControlSave--";function s(e){if(!e||!e["!ref"])return"";for(var n,r=[],a=[],i="",o=R7(e["!ref"]),s=Array.isArray(e),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c)if(i=A7({r:l,c:c}),(n=s?(e[l]||[])[c]:e[i])&&null!=n.v&&"z"!==n.t){switch(a=["cell",i,"t"],n.t){case"s":case"str":a.push(t(n.v));break;case"n":n.f?(a[2]="vtf",a[3]="n",a[4]=n.v,a[5]=t(n.f)):(a[2]="v",a[3]=n.v);break;case"b":a[2]="vt"+(n.f?"f":"c"),a[3]="nl",a[4]=n.v?"1":"0",a[5]=t(n.f||(n.v?"TRUE":"FALSE"));break;case"d":var u=A6(j6(n.v));a[2]="vtc",a[3]="nd",a[4]=""+u,a[5]=n.w||g6(n.z||M5[14],u);break;case"e":continue}r.push(a.join(":"))}return r.push("sheet:c:"+(o.e.c-o.s.c+1)+":r:"+(o.e.r-o.s.r+1)+":tvf:1"),r.push("valueformat:1:text-wiki"),r.join("\n")}return{to_workbook:function(e,t){return P7(n(e,t),t)},to_sheet:n,from_sheet:function(e){return[r,a,i,a,s(e),o].join("\n")}}}(),gee=function(){function e(e,t,n,r,a){a.raw?t[n][r]=e:""===e||("TRUE"===e?t[n][r]=!0:"FALSE"===e?t[n][r]=!1:isNaN(U6(e))?isNaN(H6(e).getDate())?t[n][r]=e:t[n][r]=j6(e):t[n][r]=U6(e))}var t={44:",",9:"\t",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function r(e){for(var r={},a=!1,i=0,o=0;i<e.length;++i)34==(o=e.charCodeAt(i))?a=!a:!a&&o in t&&(r[o]=(r[o]||0)+1);for(i in o=[],r)Object.prototype.hasOwnProperty.call(r,i)&&o.push([r[i],i]);if(!o.length)for(i in r=n)Object.prototype.hasOwnProperty.call(r,i)&&o.push([r[i],i]);return o.sort(function(e,t){return e[0]-t[0]||n[e[1]]-n[t[1]]}),t[o.pop()[1]]||44}function a(e,t){var n=t||{},a="";var i=n.dense?[]:{},o={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(a=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(a=e.charAt(4),e=e.slice(6)):a=r(e.slice(0,1024)):a=n&&n.FS?n.FS:r(e.slice(0,1024));var s=0,l=0,c=0,u=0,h=0,d=a.charCodeAt(0),f=!1,p=0,g=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var m=null!=n.dateNF?function(e){var t="number"==typeof e?M5[e]:e;return t=t.replace(x6,"(\\d+)"),new RegExp("^"+t+"$")}(n.dateNF):null;function v(){var t=e.slice(u,h),r={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)r.t="z";else if(n.raw)r.t="s",r.v=t;else if(0===t.trim().length)r.t="s",r.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(r.t="s",r.v=t.slice(2,-1).replace(/""/g,'"')):!function(e){return 1!=e.length}(t)?(r.t="s",r.v=t):(r.t="n",r.f=t.slice(1));else if("TRUE"==t)r.t="b",r.v=!0;else if("FALSE"==t)r.t="b",r.v=!1;else if(isNaN(c=U6(t)))if(!isNaN(H6(t).getDate())||m&&t.match(m)){r.z=n.dateNF||M5[14];var a=0;m&&t.match(m)&&(t=function(e,t,n){var r=-1,a=-1,i=-1,o=-1,s=-1,l=-1;(t.match(x6)||[]).forEach(function(e,t){var c=parseInt(n[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":r=c;break;case"d":i=c;break;case"h":o=c;break;case"s":l=c;break;case"m":o>=0?s=c:a=c}}),l>=0&&-1==s&&a>=0&&(s=a,a=-1);var c=(""+(r>=0?r:(new Date).getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);7==c.length&&(c="0"+c),8==c.length&&(c="20"+c);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==o&&-1==s&&-1==l?c:-1==r&&-1==a&&-1==i?u:c+"T"+u}(0,n.dateNF,t.match(m)||[]),a=1),n.cellDates?(r.t="d",r.v=j6(t,a)):(r.t="n",r.v=A6(j6(t,a))),!1!==n.cellText&&(r.w=g6(r.z,r.v instanceof Date?A6(r.v):r.v)),n.cellNF||delete r.z}else r.t="s",r.v=t;else r.t="n",!1!==n.cellText&&(r.w=t),r.v=c;if("z"==r.t||(n.dense?(i[s]||(i[s]=[]),i[s][l]=r):i[A7({c:l,r:s})]=r),u=h+1,g=e.charCodeAt(u),o.e.c<l&&(o.e.c=l),o.e.r<s&&(o.e.r=s),p==d)++l;else if(l=0,++s,n.sheetRows&&n.sheetRows<=s)return!0}e:for(;h<e.length;++h)switch(p=e.charCodeAt(h)){case 34:34===g&&(f=!f);break;case d:case 10:case 13:if(!f&&v())break e}return h-u>0&&v(),i["!ref"]=D7(o),i}function i(t,n){return n&&n.PRN?n.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?a(t,n):j7(function(t,n){var r=n||{},a=[];if(!t||0===t.length)return a;for(var i=t.split(/[\r\n]/),o=i.length-1;o>=0&&0===i[o].length;)--o;for(var s=10,l=0,c=0;c<=o;++c)-1==(l=i[c].indexOf(" "))?l=i[c].length:l++,s=Math.max(s,l);for(c=0;c<=o;++c){a[c]=[];var u=0;for(e(i[c].slice(0,s).trim(),a,c,u,r),u=1;u<=(i[c].length-s)/10+1;++u)e(i[c].slice(s+10*(u-1),s+10*u).trim(),a,c,u,r)}return r.sheetRows&&(a=a.slice(0,r.sheetRows)),a}(t,n),n):a(t,n)}function o(e,t){var n="",r="string"==t.type?[0,0,0,0]:Sre(e,t);switch(t.type){case"base64":n=v5(e);break;case"binary":case"string":n=e;break;case"buffer":n=65001==t.codepage?e.toString("utf8"):t.codepage&&"undefined"!==typeof d5?d5.utils.decode(t.codepage,e):b5&&Buffer.isBuffer(e)?e.toString("binary"):S5(e);break;case"array":n=B6(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==r[0]&&187==r[1]&&191==r[2]?n=s8(n.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?n=s8(n):"binary"==t.type&&"undefined"!==typeof d5&&t.codepage&&(n=d5.utils.decode(t.codepage,d5.utils.encode(28591,n))),"socialcalc:version:"==n.slice(0,19)?pee.to_sheet("string"==t.type?n:s8(n),t):i(n,t)}return{to_workbook:function(e,t){return P7(o(e,t),t)},to_sheet:o,from_sheet:function(e){for(var t,n=[],r=F7(e["!ref"]),a=Array.isArray(e),i=r.s.r;i<=r.e.r;++i){for(var o=[],s=r.s.c;s<=r.e.c;++s){var l=A7({r:i,c:s});if((t=a?(e[i]||[])[s]:e[l])&&null!=t.v){for(var c=(t.w||(L7(t),t.w)||"").slice(0,10);c.length<10;)c+=" ";o.push(c+(0===s?" ":""))}else o.push("          ")}n.push(o.join(""))}return n.join("\n")}}}();var mee=function(){function e(e,t,n){if(e){m7(e,e.l||0);for(var r=n.Enum||v;e.l<e.length;){var a=e.read_shift(2),i=r[a]||r[65535],o=e.read_shift(2),s=e.l+o,l=i.f&&i.f(e,o,n);if(e.l=s,t(l,i,a))return}}}function t(t,n){if(!t)return t;var r=n||{};var a=r.dense?[]:{},i="Sheet1",o="",s=0,l={},c=[],u=[],h={s:{r:0,c:0},e:{r:0,c:0}},d=r.sheetRows||0;if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw new Error("Unsupported Works 3 for Mac file");if(2==t[2])r.Enum=v,e(t,function(e,t,n){switch(n){case 0:r.vers=e,e>=4096&&(r.qpro=!0);break;case 6:h=e;break;case 204:e&&(o=e);break;case 222:o=e;break;case 15:case 51:r.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==n&&112==(112&e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=r.dateNF||M5[14],r.cellDates&&(e[1].t="d",e[1].v=O6(e[1].v))),r.qpro&&e[3]>s&&(a["!ref"]=D7(h),l[i]=a,c.push(i),a=r.dense?[]:{},h={s:{r:0,c:0},e:{r:0,c:0}},s=e[3],i=o||"Sheet"+(s+1),o="");var u=r.dense?(a[e[0].r]||[])[e[0].c]:a[A7(e[0])];if(u){u.t=e[1].t,u.v=e[1].v,null!=e[1].z&&(u.z=e[1].z),null!=e[1].f&&(u.f=e[1].f);break}r.dense?(a[e[0].r]||(a[e[0].r]=[]),a[e[0].r][e[0].c]=e[1]):a[A7(e[0])]=e[1]}},r);else{if(26!=t[2]&&14!=t[2])throw new Error("Unrecognized LOTUS BOF "+t[2]);r.Enum=b,14==t[2]&&(r.qpro=!0,t.l=0),e(t,function(e,t,n){switch(n){case 204:i=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>s&&(a["!ref"]=D7(h),l[i]=a,c.push(i),a=r.dense?[]:{},h={s:{r:0,c:0},e:{r:0,c:0}},s=e[3],i="Sheet"+(s+1)),d>0&&e[0].r>=d)break;r.dense?(a[e[0].r]||(a[e[0].r]=[]),a[e[0].r][e[0].c]=e[1]):a[A7(e[0])]=e[1],h.e.c<e[0].c&&(h.e.c=e[0].c),h.e.r<e[0].r&&(h.e.r=e[0].r);break;case 27:e[14e3]&&(u[e[14e3][0]]=e[14e3][1]);break;case 1537:u[e[0]]=e[1],e[0]==s&&(i=e[1])}},r)}if(a["!ref"]=D7(h),l[o||i]=a,c.push(o||i),!u.length)return{SheetNames:c,Sheets:l};for(var f={},p=[],g=0;g<u.length;++g)l[c[g]]?(p.push(u[g]||c[g]),f[u[g]]=l[u[g]]||l[c[g]]):(p.push(u[g]),f[u[g]]={"!ref":"A1"});return{SheetNames:p,Sheets:f}}function n(e,t,n){var r=[{c:0,r:0},{t:"n",v:0},0,0];return n.qpro&&20768!=n.vers?(r[0].c=e.read_shift(1),r[3]=e.read_shift(1),r[0].r=e.read_shift(2),e.l+=2):(r[2]=e.read_shift(1),r[0].c=e.read_shift(2),r[0].r=e.read_shift(2)),r}function r(e,t,r){var a=e.l+t,i=n(e,0,r);if(i[1].t="s",20768==r.vers){e.l++;var o=e.read_shift(1);return i[1].v=e.read_shift(o,"utf8"),i}return r.qpro&&e.l++,i[1].v=e.read_shift(a-e.l,"cstr"),i}function a(e,t,n){var r=b7(7+n.length);r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(1,39);for(var a=0;a<r.length;++a){var i=n.charCodeAt(a);r.write_shift(1,i>=128?95:i)}return r.write_shift(1,0),r}function i(e,t,n){var r=b7(7);return r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(2,n,"i"),r}function o(e,t,n){var r=b7(13);return r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(8,n,"f"),r}function s(e,t,n){var r=32768&t;return t=(r?e:0)+((t&=-32769)>=8192?t-16384:t),(r?"":"$")+(n?I7(t):E7(t))}var l={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},c=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function u(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function h(e,t,n,r){var a=b7(6+r.length);a.write_shift(2,e),a.write_shift(1,n),a.write_shift(1,t),a.write_shift(1,39);for(var i=0;i<r.length;++i){var o=r.charCodeAt(i);a.write_shift(1,o>=128?95:o)}return a.write_shift(1,0),a}function d(e,t){var n=u(e),r=e.read_shift(4),a=e.read_shift(4),i=e.read_shift(2);if(65535==i)return 0===r&&3221225472===a?(n[1].t="e",n[1].v=15):0===r&&3489660928===a?(n[1].t="e",n[1].v=42):n[1].v=0,n;var o=32768&i;return i=(32767&i)-16446,n[1].v=(1-2*o)*(a*Math.pow(2,i+32)+r*Math.pow(2,i)),n}function f(e,t,n,r){var a=b7(14);if(a.write_shift(2,e),a.write_shift(1,n),a.write_shift(1,t),0==r)return a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,65535),a;var i,o=0,s=0,l=0;return r<0&&(o=1,r=-r),s=0|Math.log2(r),0==(2147483648&(l=(r/=Math.pow(2,s-31))>>>0))&&(++s,l=(r/=2)>>>0),r-=l,l|=2147483648,l>>>=0,i=(r*=Math.pow(2,32))>>>0,a.write_shift(4,i),a.write_shift(4,l),s+=16383+(o?32768:0),a.write_shift(2,s),a}function p(e,t){var n=u(e),r=e.read_shift(8,"f");return n[1].v=r,n}function g(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function m(e,t){var n=b7(5+e.length);n.write_shift(2,14e3),n.write_shift(2,t);for(var r=0;r<e.length;++r){var a=e.charCodeAt(r);n[n.l++]=a>127?95:a}return n[n.l++]=0,n}var v={0:{n:"BOF",f:U9},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,n){var r={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&n.qpro?(r.s.c=e.read_shift(1),e.l++,r.s.r=e.read_shift(2),r.e.c=e.read_shift(1),e.l++,r.e.r=e.read_shift(2),r):(r.s.c=e.read_shift(2),r.s.r=e.read_shift(2),12==t&&n.qpro&&(e.l+=2),r.e.c=e.read_shift(2),r.e.r=e.read_shift(2),12==t&&n.qpro&&(e.l+=2),65535==r.s.c&&(r.s.c=r.e.c=r.s.r=r.e.r=0),r)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,r){var a=n(e,0,r);return a[1].v=e.read_shift(2,"i"),a}},14:{n:"NUMBER",f:function(e,t,r){var a=n(e,0,r);return a[1].v=e.read_shift(8,"f"),a}},15:{n:"LABEL",f:r},16:{n:"FORMULA",f:function(e,t,r){var a=e.l+t,i=n(e,0,r);if(i[1].v=e.read_shift(8,"f"),r.qpro)e.l=a;else{var o=e.read_shift(2);!function(e,t){m7(e,0);var n=[],r=0,a="",i="",o="",u="";for(;e.l<e.length;){var h=e[e.l++];switch(h){case 0:n.push(e.read_shift(8,"f"));break;case 1:i=s(t[0].c,e.read_shift(2),!0),a=s(t[0].r,e.read_shift(2),!1),n.push(i+a);break;case 2:var d=s(t[0].c,e.read_shift(2),!0),f=s(t[0].r,e.read_shift(2),!1);i=s(t[0].c,e.read_shift(2),!0),a=s(t[0].r,e.read_shift(2),!1),n.push(d+f+":"+i+a);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:n.push("("+n.pop()+")");break;case 5:n.push(e.read_shift(2));break;case 6:for(var p="";h=e[e.l++];)p+=String.fromCharCode(h);n.push('"'+p.replace(/"/g,'""')+'"');break;case 8:n.push("-"+n.pop());break;case 23:n.push("+"+n.pop());break;case 22:n.push("NOT("+n.pop()+")");break;case 20:case 21:u=n.pop(),o=n.pop(),n.push(["AND","OR"][h-20]+"("+o+","+u+")");break;default:if(h<32&&c[h])u=n.pop(),o=n.pop(),n.push(o+c[h]+u);else{if(!l[h])return h<=7?console.error("WK1 invalid opcode "+h.toString(16)):h<=24?console.error("WK1 unsupported op "+h.toString(16)):h<=30?console.error("WK1 invalid opcode "+h.toString(16)):h<=115?console.error("WK1 unsupported function opcode "+h.toString(16)):console.error("WK1 unrecognized opcode "+h.toString(16));if(69==(r=l[h][1])&&(r=e[e.l++]),r>n.length)return void console.error("WK1 bad formula parse 0x"+h.toString(16)+":|"+n.join("|")+"|");var g=n.slice(-r);n.length-=r,n.push(l[h][0]+"("+g.join(",")+")")}}}1==n.length?t[1].f=""+n[0]:console.error("WK1 bad formula parse |"+n.join("|")+"|")}(e.slice(e.l,e.l+o),i),e.l+=o}return i}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:r},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:g},222:{n:"SHEETNAMELP",f:function(e,t){var n=e[e.l++];n>t-1&&(n=t-1);for(var r="";r.length<n;)r+=String.fromCharCode(e[e.l++]);return r}},65535:{n:""}},b={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var n=u(e);return n[1].t="s",n[1].v=e.read_shift(t-4,"cstr"),n}},23:{n:"NUMBER17",f:d},24:{n:"NUMBER18",f:function(e,t){var n=u(e);n[1].v=e.read_shift(2);var r=n[1].v>>1;if(1&n[1].v)switch(7&r){case 0:r=5e3*(r>>3);break;case 1:r=500*(r>>3);break;case 2:r=(r>>3)/20;break;case 3:r=(r>>3)/200;break;case 4:r=(r>>3)/2e3;break;case 5:r=(r>>3)/2e4;break;case 6:r=(r>>3)/16;break;case 7:r=(r>>3)/64}return n[1].v=r,n}},25:{n:"FORMULA19",f:function(e,t){var n=d(e);return e.l+=t-14,n}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var n={},r=e.l+t;e.l<r;){var a=e.read_shift(2);if(14e3==a){for(n[a]=[0,""],n[a][0]=e.read_shift(2);e[e.l];)n[a][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return n}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var n=u(e),r=e.read_shift(4);return n[1].v=r>>6,n}},38:{n:"??"},39:{n:"NUMBER27",f:p},40:{n:"FORMULA28",f:function(e,t){var n=p(e);return e.l+=t-10,n}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:g},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,n){if(n.qpro&&!(t<21)){var r=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[r,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,t){var n=t||{};if(+n.codepage>=0&&c5(+n.codepage),"string"==n.type)throw new Error("Cannot write WK1 to JS string");var r=x7(),s=F7(e["!ref"]),l=Array.isArray(e),c=[];Pne(r,0,function(e){var t=b7(2);return t.write_shift(2,e),t}(1030)),Pne(r,6,function(e){var t=b7(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(s));for(var u=Math.min(s.e.r,8191),h=s.s.r;h<=u;++h)for(var d=E7(h),f=s.s.c;f<=s.e.c;++f){h===s.s.r&&(c[f]=I7(f));var p=c[f]+d,g=l?(e[h]||[])[f]:e[p];if(g&&"z"!=g.t)if("n"==g.t)(0|g.v)==g.v&&g.v>=-32768&&g.v<=32767?Pne(r,13,i(h,f,g.v)):Pne(r,14,o(h,f,g.v));else Pne(r,15,a(h,f,L7(g).slice(0,239)))}return Pne(r,1),r.end()},book_to_wk3:function(e,t){var n=t||{};if(+n.codepage>=0&&c5(+n.codepage),"string"==n.type)throw new Error("Cannot write WK3 to JS string");var r=x7();Pne(r,0,function(e){var t=b7(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var n=0,r=0,a=0,i=0;i<e.SheetNames.length;++i){var o=e.SheetNames[i],s=e.Sheets[o];if(s&&s["!ref"]){++a;var l=R7(s["!ref"]);n<l.e.r&&(n=l.e.r),r<l.e.c&&(r=l.e.c)}}n>8191&&(n=8191);return t.write_shift(2,n),t.write_shift(1,a),t.write_shift(1,r),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var a=0,i=0;a<e.SheetNames.length;++a)(e.Sheets[e.SheetNames[a]]||{})["!ref"]&&Pne(r,27,m(e.SheetNames[a],i++));var o=0;for(a=0;a<e.SheetNames.length;++a){var s=e.Sheets[e.SheetNames[a]];if(s&&s["!ref"]){for(var l=F7(s["!ref"]),c=Array.isArray(s),u=[],d=Math.min(l.e.r,8191),p=l.s.r;p<=d;++p)for(var g=E7(p),v=l.s.c;v<=l.e.c;++v){p===l.s.r&&(u[v]=I7(v));var b=u[v]+g,x=c?(s[p]||[])[v]:s[b];if(x&&"z"!=x.t)if("n"==x.t)Pne(r,23,f(p,v,o,x.v));else Pne(r,22,h(p,v,o,L7(x).slice(0,239)))}++o}}return Pne(r,1),r.end()},to_workbook:function(e,n){switch(n.type){case"base64":return t(k5(v5(e)),n);case"binary":return t(k5(e),n);case"buffer":case"array":return t(e,n)}throw"Unsupported type "+n.type}}}();var vee=/^\s|\s$|[\t\n\r]/;function bee(e,t){if(!t.bookSST)return"";var n=[K6];n[n.length]=f8("sst",null,{xmlns:I8[0],count:e.Count,uniqueCount:e.Unique});for(var r=0;r!=e.length;++r)if(null!=e[r]){var a=e[r],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(vee)&&(i+=' xml:space="preserve"'),i+=">"+Q6(a.t)+"</t>"),i+="</si>",n[n.length]=i}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}var xee=function(e,t){var n=!1;return null==t&&(n=!0,t=b7(15+4*e.t.length)),t.write_shift(1,0),W7(e.t,t),n?t.slice(0,t.l):t};function yee(e){var t=x7();y7(t,159,function(e,t){return t||(t=b7(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}(e));for(var n=0;n<e.length;++n)y7(t,19,xee(e[n]));return y7(t,160),t.end()}function wee(e){if("undefined"!==typeof d5)return d5.utils.encode(i5,e);for(var t=[],n=e.split(""),r=0;r<n.length;++r)t[r]=n[r].charCodeAt(0);return t}function kee(e){var t,n,r=0,a=wee(e),i=a.length+1;for((t=y5(i))[0]=a.length,n=1;n!=i;++n)t[n]=a[n-1];for(n=i-1;n>=0;--n)r=((0===(16384&r)?0:1)|r<<1&32767)^t[n];return 52811^r}var Nee=function(){function e(e,n){switch(n.type){case"base64":return t(v5(e),n);case"binary":return t(e,n);case"buffer":return t(b5&&Buffer.isBuffer(e)?e.toString("binary"):S5(e),n);case"array":return t(B6(e),n)}throw new Error("Unrecognized type "+n.type)}function t(e,t){var n=(t||{}).dense?[]:{},r=e.match(/\\trowd.*?\\row\b/g);if(!r.length)throw new Error("RTF missing table");var a={s:{c:0,r:0},e:{c:0,r:r.length-1}};return r.forEach(function(e,t){Array.isArray(n)&&(n[t]=[]);for(var r,i=/\\\w+\b/g,o=0,s=-1;r=i.exec(e);){if("\\cell"===r[0]){var l=e.slice(o,i.lastIndex-r[0].length);if(" "==l[0]&&(l=l.slice(1)),++s,l.length){var c={v:l,t:"s"};Array.isArray(n)?n[t][s]=c:n[A7({r:t,c:s})]=c}}o=i.lastIndex}s>a.e.c&&(a.e.c=s)}),n["!ref"]=D7(a),n}return{to_workbook:function(t,n){return P7(e(t,n),n)},to_sheet:e,from_sheet:function(e){for(var t,n=["{\\rtf1\\ansi"],r=F7(e["!ref"]),a=Array.isArray(e),i=r.s.r;i<=r.e.r;++i){n.push("\\trowd\\trautofit1");for(var o=r.s.c;o<=r.e.c;++o)n.push("\\cellx"+(o+1));for(n.push("\\pard\\intbl"),o=r.s.c;o<=r.e.c;++o){var s=A7({r:i,c:o});(t=a?(e[i]||[])[o]:e[s])&&(null!=t.v||t.f&&!t.F)&&(n.push(" "+(t.w||(L7(t),t.w))),n.push("\\cell"))}n.push("\\pard\\intbl\\row")}return n.join("")+"}"}}}();function See(e){for(var t=0,n=1;3!=t;++t)n=256*n+(e[t]>255?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}var Cee=6;function Eee(e){return Math.floor((e+Math.round(128/Cee)/256)*Cee)}function _ee(e){return Math.floor((e-5)/Cee*100+.5)/100}function Iee(e){return Math.round((e*Cee+5)/Cee*256)/256}function Tee(e){e.width?(e.wpx=Eee(e.width),e.wch=_ee(e.wpx),e.MDW=Cee):e.wpx?(e.wch=_ee(e.wpx),e.width=Iee(e.wch),e.MDW=Cee):"number"==typeof e.wch&&(e.width=Iee(e.wch),e.wpx=Eee(e.width),e.MDW=Cee),e.customWidth&&delete e.customWidth}var Aee=96;function Ree(e){return 96*e/Aee}function Dee(e){return e*Aee/96}function Fee(e,t){var n,r=[K6,f8("styleSheet",null,{xmlns:I8[0],"xmlns:vt":C8})];return e.SSF&&null!=(n=function(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)null!=e[r]&&(t[t.length]=f8("numFmt",null,{numFmtId:r,formatCode:Q6(e[r])}))}),1===t.length?"":(t[t.length]="</numFmts>",t[0]=f8("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(e.SSF))&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=function(e){var t=[];return t[t.length]=f8("cellXfs",null),e.forEach(function(e){t[t.length]=f8("xf",null,e)}),t[t.length]="</cellXfs>",2===t.length?"":(t[0]=f8("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Oee(e,t,n){n||(n=b7(6+4*t.length)),n.write_shift(2,e),W7(t,n);var r=n.length>n.l?n.slice(0,n.l):n;return null==n.l&&(n.l=n.length),r}function Lee(e,t){t||(t=b7(153)),t.write_shift(2,20*e.sz),function(e,t){t||(t=b7(2));var n=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);t.write_shift(1,n),t.write_shift(1,0)}(e,t),t.write_shift(2,e.bold?700:400);var n=0;"superscript"==e.vertAlign?n=1:"subscript"==e.vertAlign&&(n=2),t.write_shift(2,n),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),u9(e.color,t);var r=0;return"major"==e.scheme&&(r=1),"minor"==e.scheme&&(r=2),t.write_shift(1,r),W7(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Pee,Mee=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],jee=v7;function Bee(e,t){t||(t=b7(84)),Pee||(Pee=_6(Mee));var n=Pee[e.patternType];null==n&&(n=40),t.write_shift(4,n);var r=0;if(40!=n)for(u9({auto:1},t),u9({auto:1},t);r<12;++r)t.write_shift(4,0);else{for(;r<4;++r)t.write_shift(4,0);for(;r<12;++r)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function zee(e,t,n){n||(n=b7(16)),n.write_shift(2,t||0),n.write_shift(2,e.numFmtId||0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);return n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n}function Wee(e,t){return t||(t=b7(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Uee=v7;function Vee(e){y7(e,613,B7(1)),y7(e,46,function(e,t){return t||(t=b7(51)),t.write_shift(1,0),Wee(0,t),Wee(0,t),Wee(0,t),Wee(0,t),Wee(0,t),t.length>t.l?t.slice(0,t.l):t}()),y7(e,614)}function Hee(e){y7(e,619,B7(1)),y7(e,48,function(e,t){return t||(t=b7(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),Z7(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}({xfId:0,builtinId:0,name:"Normal"})),y7(e,620)}function Gee(e){y7(e,508,function(e,t,n){var r=b7(2052);return r.write_shift(4,e),Z7(t,r),Z7(n,r),r.length>r.l?r.slice(0,r.l):r}(0,"TableStyleMedium9","PivotStyleMedium4")),y7(e,509)}function qee(e,t){var n=x7();return y7(n,278),function(e,t){if(t){var n=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var r=e[0];r<=e[1];++r)null!=t[r]&&++n}),0!=n&&(y7(e,615,B7(n)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)null!=t[r]&&y7(e,44,Oee(r,t[r]))}),y7(e,616))}}(n,e.SSF),function(e){y7(e,611,B7(1)),y7(e,43,Lee({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),y7(e,612)}(n),function(e){y7(e,603,B7(2)),y7(e,45,Bee({patternType:"none"})),y7(e,45,Bee({patternType:"gray125"})),y7(e,604)}(n),Vee(n),function(e){y7(e,626,B7(1)),y7(e,47,zee({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),y7(e,627)}(n),function(e,t){y7(e,617,B7(t.length)),t.forEach(function(t){y7(e,47,zee(t,0))}),y7(e,618)}(n,t.cellXfs),Hee(n),function(e){y7(e,505,B7(0)),y7(e,506)}(n),Gee(n),y7(n,279),n.end()}function Kee(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var n=[K6];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',n[n.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',n[n.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',n[n.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',n[n.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',n[n.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',n[n.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function Xee(){var e=x7();return y7(e,332),y7(e,334,B7(1)),y7(e,335,function(e){var t=b7(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),W7(e.name,t),t.slice(0,t.l)}({name:"XLDAPR",version:12e4,flags:3496657072})),y7(e,336),y7(e,339,function(e,t){var n=b7(8+2*t.length);return n.write_shift(4,e),W7(t,n),n.slice(0,n.l)}(1,"XLDAPR")),y7(e,52),y7(e,35,B7(514)),y7(e,4096,B7(0)),y7(e,4097,V9(1)),y7(e,36),y7(e,53),y7(e,340),y7(e,337,function(e,t){var n=b7(8);return n.write_shift(4,e),n.write_shift(4,t?1:0),n}(1,!0)),y7(e,51,function(e){var t=b7(4+8*e.length);t.write_shift(4,e.length);for(var n=0;n<e.length;++n)t.write_shift(4,e[n][0]),t.write_shift(4,e[n][1]);return t}([[1,0]])),y7(e,338),y7(e,333),e.end()}function Yee(){var e=[K6];return e.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),e.join("")}var $ee=1024;function Jee(e,t){for(var n=[21600,21600],r=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),a=[f8("xml",null,{"xmlns:v":O8,"xmlns:o":T8,"xmlns:x":A8,"xmlns:mv":F8}).replace(/\/>/,">"),f8("o:shapelayout",f8("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),f8("v:shapetype",[f8("v:stroke",null,{joinstyle:"miter"}),f8("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:r})];$ee<1e3*e;)$ee+=1e3;return t.forEach(function(e){var t=T7(e[0]),n={color2:"#BEFF82",type:"gradient"};"gradient"==n.type&&(n.angle="-180");var r="gradient"==n.type?f8("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,i=f8("v:fill",r,n);++$ee,a=a.concat(["<v:shape"+d8({id:"_x0000_s"+$ee,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",i,f8("v:shadow",null,{on:"t",obscured:"t"}),f8("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",h8("x:Anchor",[t.c+1,0,t.r+1,0,t.c+3,20,t.r+5,20].join(",")),h8("x:AutoFill","False"),h8("x:Row",String(t.r)),h8("x:Column",String(t.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function Qee(e){var t=[K6,f8("comments",null,{xmlns:I8[0]})],n=[];return t.push("<authors>"),e.forEach(function(e){e[1].forEach(function(e){var r=Q6(e.a);-1==n.indexOf(r)&&(n.push(r),t.push("<author>"+r+"</author>")),e.T&&e.ID&&-1==n.indexOf("tc="+e.ID)&&(n.push("tc="+e.ID),t.push("<author>tc="+e.ID+"</author>"))})}),0==n.length&&(n.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(e){var r=0,a=[];if(e[1][0]&&e[1][0].T&&e[1][0].ID?r=n.indexOf("tc="+e[1][0].ID):e[1].forEach(function(e){e.a&&(r=n.indexOf(Q6(e.a))),a.push(e.t||"")}),t.push('<comment ref="'+e[0]+'" authorId="'+r+'"><text>'),a.length<=1)t.push(h8("t",Q6(a[0]||"")));else{for(var i="Comment:\n    "+a[0]+"\n",o=1;o<a.length;++o)i+="Reply:\n    "+a[o]+"\n";t.push(h8("t",Q6(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function Zee(e,t,n){var r=[K6,f8("ThreadedComments",null,{xmlns:y8}).replace(/[\/]>/,">")];return e.forEach(function(e){var a="";(e[1]||[]).forEach(function(i,o){if(i.T){i.a&&-1==t.indexOf(i.a)&&t.push(i.a);var s={ref:e[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+n.tcid++).slice(-12)+"}"};0==o?a=s.id:s.parentId=a,i.ID=s.id,i.a&&(s.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),r.push(f8("threadedComment",h8("text",i.t||""),s))}else delete i.ID})}),r.push("</ThreadedComments>"),r.join("")}var ete=z7;function tte(e){var t=x7(),n=[];return y7(t,628),y7(t,630),e.forEach(function(e){e[1].forEach(function(e){n.indexOf(e.a)>-1||(n.push(e.a.slice(0,54)),y7(t,632,function(e){return W7(e.slice(0,54))}(e.a)))})}),y7(t,631),y7(t,633),e.forEach(function(e){e[1].forEach(function(r){r.iauthor=n.indexOf(r.a);var a={s:T7(e[0]),e:T7(e[0])};y7(t,635,function(e,t){return null==t&&(t=b7(36)),t.write_shift(4,e[1].iauthor),s9(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}([a,r])),r.t&&r.t.length>0&&y7(t,637,G7(r)),y7(t,636),delete r.iauthor})}),y7(t,634),y7(t,629),t.end()}var nte=["xlsb","xlsm","xlam","biff8","xla"];var rte=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function n(e,n,r,a){var i=!1,o=!1;0==r.length?o=!0:"["==r.charAt(0)&&(o=!0,r=r.slice(1,-1)),0==a.length?i=!0:"["==a.charAt(0)&&(i=!0,a=a.slice(1,-1));var s=r.length>0?0|parseInt(r,10):0,l=a.length>0?0|parseInt(a,10):0;return i?l+=t.c:--l,o?s+=t.r:--s,n+(i?"":"$")+I7(l)+(o?"":"$")+E7(s)}return function(r,a){return t=a,r.replace(e,n)}}(),ate=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,ite=function(){return function(e,t){return e.replace(ate,function(e,n,r,a,i,o){var s=_7(a)-(r?0:t.c),l=C7(o)-(i?0:t.r);return n+"R"+(0==l?"":i?l+1:"["+l+"]")+"C"+(0==s?"":r?s+1:"["+s+"]")})}}();function ote(e,t){return e.replace(ate,function(e,n,r,a,i,o){return n+("$"==r?r+a:I7(_7(a)+t.c))+("$"==i?i+o:E7(C7(o)+t.r))})}function ste(e){e.l+=1}function lte(e,t){var n=e.read_shift(1==t?1:2);return[16383&n,n>>14&1,n>>15&1]}function cte(e,t,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return ute(e);12==n.biff&&(r=4)}var a=e.read_shift(r),i=e.read_shift(r),o=lte(e,2),s=lte(e,2);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:s[0],cRel:s[1],rRel:s[2]}}}function ute(e){var t=lte(e,2),n=lte(e,2),r=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:n[0],c:a,cRel:n[1],rRel:n[2]}}}function hte(e,t,n){if(n&&n.biff>=2&&n.biff<=5)return function(e){var t=lte(e,2),n=e.read_shift(1);return{r:t[0],c:n,cRel:t[1],rRel:t[2]}}(e);var r=e.read_shift(n&&12==n.biff?4:2),a=lte(e,2);return{r:r,c:a[0],cRel:a[1],rRel:a[2]}}function dte(e){var t=e.read_shift(2),n=e.read_shift(2);return{r:t,c:255&n,fQuoted:!!(16384&n),cRel:n>>15,rRel:n>>15}}function fte(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function pte(e){return[e.read_shift(1),e.read_shift(1)]}function gte(e,t){var n=[e.read_shift(1)];if(12==t)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2}switch(n[0]){case 4:n[1]=z9(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:n[1]=m9[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:n[1]=l9(e);break;case 2:n[1]=Y9(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function mte(e,t,n){for(var r=e.read_shift(12==n.biff?4:2),a=[],i=0;i!=r;++i)a.push((12==n.biff?o9:tee)(e,8));return a}function vte(e,t,n){var r=0,a=0;12==n.biff?(r=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),r=1+e.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,0==--a&&(a=256));for(var i=0,o=[];i!=r&&(o[i]=[]);++i)for(var s=0;s!=a;++s)o[i][s]=gte(e,n.biff);return o}function bte(e,t,n){return e.l+=2,[dte(e)]}function xte(e){return e.l+=6,[]}function yte(e){return e.l+=2,[U9(e),1&e.read_shift(2)]}var wte=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var kte={1:{n:"PtgExp",f:function(e,t,n){return e.l++,n&&12==n.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(n&&2==n.biff?1:2)]}},2:{n:"PtgTbl",f:v7},3:{n:"PtgAdd",f:ste},4:{n:"PtgSub",f:ste},5:{n:"PtgMul",f:ste},6:{n:"PtgDiv",f:ste},7:{n:"PtgPower",f:ste},8:{n:"PtgConcat",f:ste},9:{n:"PtgLt",f:ste},10:{n:"PtgLe",f:ste},11:{n:"PtgEq",f:ste},12:{n:"PtgGe",f:ste},13:{n:"PtgGt",f:ste},14:{n:"PtgNe",f:ste},15:{n:"PtgIsect",f:ste},16:{n:"PtgUnion",f:ste},17:{n:"PtgRange",f:ste},18:{n:"PtgUplus",f:ste},19:{n:"PtgUminus",f:ste},20:{n:"PtgPercent",f:ste},21:{n:"PtgParen",f:ste},22:{n:"PtgMissArg",f:ste},23:{n:"PtgStr",f:function(e,t,n){return e.l++,G9(e,0,n)}},26:{n:"PtgSheet",f:function(e,t,n){return e.l+=5,e.l+=2,e.l+=2==n.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,n){return e.l+=2==n.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,m9[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,l9(e)}},32:{n:"PtgArray",f:function(e,t,n){var r=(96&e[e.l++])>>5;return e.l+=2==n.biff?6:12==n.biff?14:7,[r]}},33:{n:"PtgFunc",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(n&&n.biff<=3?1:2);return[Wte[a],zte[a],r]}},34:{n:"PtgFuncVar",f:function(e,t,n){var r=e[e.l++],a=e.read_shift(1),i=n&&n.biff<=3?[88==r?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[a,(0===i[0]?zte:Bte)[i[1]]]}},35:{n:"PtgName",f:function(e,t,n){var r=e.read_shift(1)>>>5&3,a=!n||n.biff>=8?4:2,i=e.read_shift(a);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[r,0,i]}},36:{n:"PtgRef",f:function(e,t,n){var r=(96&e[e.l])>>5;return e.l+=1,[r,hte(e,0,n)]}},37:{n:"PtgArea",f:function(e,t,n){return[(96&e[e.l++])>>5,cte(e,n.biff>=2&&n.biff,n)]}},38:{n:"PtgMemArea",f:function(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=n&&2==n.biff?3:4,[r,e.read_shift(n&&2==n.biff?1:2)]}},39:{n:"PtgMemErr",f:v7},40:{n:"PtgMemNoMem",f:v7},41:{n:"PtgMemFunc",f:function(e,t,n){return[e.read_shift(1)>>>5&3,e.read_shift(n&&2==n.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,12==n.biff&&(e.l+=2),[r]}},43:{n:"PtgAreaErr",f:function(e,t,n){var r=(96&e[e.l++])>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}},44:{n:"PtgRefN",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var a=function(e,t,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return function(e){var t=e.read_shift(2),n=e.read_shift(1),r=(32768&t)>>15,a=(16384&t)>>14;return t&=16383,1==r&&t>=8192&&(t-=16384),1==a&&n>=128&&(n-=256),{r:t,c:n,cRel:a,rRel:r}}(e);var a=e.read_shift(r>=12?4:2),i=e.read_shift(2),o=(16384&i)>>14,s=(32768&i)>>15;if(i&=16383,1==s)for(;a>524287;)a-=1048576;if(1==o)for(;i>8191;)i-=16384;return{r:a,c:i,cRel:o,rRel:s}}(e,0,n);return[r,a]}},45:{n:"PtgAreaN",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=function(e,t,n){if(n.biff<8)return ute(e);var r=e.read_shift(12==n.biff?4:2),a=e.read_shift(12==n.biff?4:2),i=lte(e,2),o=lte(e,2);return{s:{r:r,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}(e,0,n);return[r,a]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,n){return 5==n.biff?function(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[t,n,r]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(2);return n&&5==n.biff&&(e.l+=12),[r,a,hte(e,0,n)]}},59:{n:"PtgArea3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=e.read_shift(2,"i");if(n)switch(n.biff){case 5:e.l+=12;break;case 12:0}return[r,a,cte(e,0,n)]}},60:{n:"PtgRefErr3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=e.read_shift(2),i=4;if(n)switch(n.biff){case 5:i=15;break;case 12:i=6}return e.l+=i,[r,a]}},61:{n:"PtgAreaErr3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=e.read_shift(2),i=8;if(n)switch(n.biff){case 5:e.l+=12,i=6;break;case 12:i=12}return e.l+=i,[r,a]}},255:{}},Nte={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Ste={1:{n:"PtgElfLel",f:yte},2:{n:"PtgElfRw",f:bte},3:{n:"PtgElfCol",f:bte},6:{n:"PtgElfRwV",f:bte},7:{n:"PtgElfColV",f:bte},10:{n:"PtgElfRadical",f:bte},11:{n:"PtgElfRadicalS",f:xte},13:{n:"PtgElfColS",f:xte},15:{n:"PtgElfColSV",f:xte},16:{n:"PtgElfRadicalLel",f:yte},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2);return{ixti:t,coltype:3&n,rt:wte[n>>2&31],idx:r,c:a,C:i}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},Cte={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=n&&2==n.biff?3:4,[r]}},2:{n:"PtgAttrIf",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(n&&2==n.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,n){e.l+=2;for(var r=e.read_shift(n&&2==n.biff?1:2),a=[],i=0;i<=r;++i)a.push(e.read_shift(n&&2==n.biff?1:2));return a}},8:{n:"PtgAttrGoto",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(n&&2==n.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,n){e.l+=n&&2==n.biff?3:4}},32:{n:"PtgAttrBaxcel",f:fte},33:{n:"PtgAttrBaxcel",f:fte},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),pte(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),pte(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function Ete(e,t,n,r){if(r.biff<8)return v7(e,t);for(var a=e.l+t,i=[],o=0;o!==n.length;++o)switch(n[o][0]){case"PtgArray":n[o][1]=vte(e,0,r),i.push(n[o][1]);break;case"PtgMemArea":n[o][2]=mte(e,n[o][1],r),i.push(n[o][2]);break;case"PtgExp":r&&12==r.biff&&(n[o][1][1]=e.read_shift(4),i.push(n[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[o][0]}return 0!==(t=a-e.l)&&i.push(v7(e,t)),i}function _te(e,t,n){for(var r,a,i=e.l+t,o=[];i!=e.l;)t=i-e.l,a=e[e.l],r=kte[a]||kte[Nte[a]],24!==a&&25!==a||(r=(24===a?Ste:Cte)[e[e.l+1]]),r&&r.f?o.push([r.n,r.f(e,t,n)]):v7(e,t);return o}function Ite(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n],a=[],i=0;i<r.length;++i){var o=r[i];if(o)if(2===o[0])a.push('"'+o[1].replace(/"/g,'""')+'"');else a.push(o[1]);else a.push("")}t.push(a.join(","))}return t.join(";")}var Tte={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Ate(e,t,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(n.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var a="";if(n.biff>8)switch(e[r[0]][0]){case 357:return a=-1==r[1]?"#REF":e.SheetNames[r[1]],r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 358:return null!=n.SID?e.SheetNames[n.SID]:"SH33TJSSAME"+e[r[0]][0];default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return a=-1==r[1]?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(e){return e.Name}).join(";;");default:return e[r[0]][0][3]?(a=-1==r[1]?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?a:a+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function Rte(e,t,n){var r=Ate(e,t,n);return"#REF"==r?r:function(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(r,n)}function Dte(e,t,n,r,a){var i,o,s,l,c=a&&a.biff||8,u={s:{c:0,r:0},e:{c:0,r:0}},h=[],d=0,f=0,p="";if(!e[0]||!e[0][0])return"";for(var g=-1,m="",v=0,b=e[0].length;v<b;++v){var x=e[0][v];switch(x[0]){case"PtgUminus":h.push("-"+h.pop());break;case"PtgUplus":h.push("+"+h.pop());break;case"PtgPercent":h.push(h.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(i=h.pop(),o=h.pop(),g>=0){switch(e[0][g][1][0]){case 0:m=W6(" ",e[0][g][1][1]);break;case 1:m=W6("\r",e[0][g][1][1]);break;default:if(m="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}o+=m,g=-1}h.push(o+Tte[x[0]]+i);break;case"PtgIsect":i=h.pop(),o=h.pop(),h.push(o+" "+i);break;case"PtgUnion":i=h.pop(),o=h.pop(),h.push(o+","+i);break;case"PtgRange":i=h.pop(),o=h.pop(),h.push(o+":"+i);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":s=w7(x[1][1],u,a),h.push(N7(s,c));break;case"PtgRefN":s=n?w7(x[1][1],n,a):x[1][1],h.push(N7(s,c));break;case"PtgRef3d":d=x[1][1],s=w7(x[1][2],u,a);p=Rte(r,d,a);h.push(p+"!"+N7(s,c));break;case"PtgFunc":case"PtgFuncVar":var y=x[1][0],w=x[1][1];y||(y=0);var k=0==(y&=127)?[]:h.slice(-y);h.length-=y,"User"===w&&(w=k.shift()),h.push(w+"("+k.join(",")+")");break;case"PtgBool":h.push(x[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":h.push(x[1]);break;case"PtgNum":h.push(String(x[1]));break;case"PtgStr":h.push('"'+x[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":l=k7(x[1][1],n?{s:n}:u,a),h.push(S7(l,a));break;case"PtgArea":l=k7(x[1][1],u,a),h.push(S7(l,a));break;case"PtgArea3d":d=x[1][1],l=x[1][2],p=Rte(r,d,a),h.push(p+"!"+S7(l,a));break;case"PtgAttrSum":h.push("SUM("+h.pop()+")");break;case"PtgName":f=x[1][2];var N=(r.names||[])[f-1]||(r[0]||[])[f],S=N?N.Name:"SH33TJSNAME"+String(f);S&&"_xlfn."==S.slice(0,6)&&!a.xlfn&&(S=S.slice(6)),h.push(S);break;case"PtgNameX":var C,E=x[1][1];if(f=x[1][2],!(a.biff<=5)){var _="";if(14849==((r[E]||[])[0]||[])[0]||(1025==((r[E]||[])[0]||[])[0]?r[E][f]&&r[E][f].itab>0&&(_=r.SheetNames[r[E][f].itab-1]+"!"):_=r.SheetNames[f-1]+"!"),r[E]&&r[E][f])_+=r[E][f].Name;else if(r[0]&&r[0][f])_+=r[0][f].Name;else{var I=(Ate(r,E,a)||"").split(";;");I[f-1]?_=I[f-1]:_+="SH33TJSERRX"}h.push(_);break}E<0&&(E=-E),r[E]&&(C=r[E][f]),C||(C={Name:"SH33TJSERRY"}),h.push(C.Name);break;case"PtgParen":var T="(",A=")";if(g>=0){switch(m="",e[0][g][1][0]){case 2:T=W6(" ",e[0][g][1][1])+T;break;case 3:T=W6("\r",e[0][g][1][1])+T;break;case 4:A=W6(" ",e[0][g][1][1])+A;break;case 5:A=W6("\r",e[0][g][1][1])+A;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}h.push(T+h.pop()+A);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":h.push("#REF!");break;case"PtgExp":s={c:x[1][1],r:x[1][0]};var R={c:n.c,r:n.r};if(r.sharedf[A7(s)]){var D=r.sharedf[A7(s)];h.push(Dte(D,u,R,r,a))}else{var F=!1;for(i=0;i!=r.arrayf.length;++i)if(o=r.arrayf[i],!(s.c<o[0].s.c||s.c>o[0].e.c)&&!(s.r<o[0].s.r||s.r>o[0].e.r)){h.push(Dte(o[1],u,R,r,a)),F=!0;break}F||h.push(x[1])}break;case"PtgArray":h.push("{"+Ite(x[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=v;break;case"PtgMissArg":h.push("");break;case"PtgList":h.push("Table"+x[1].idx+"[#"+x[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(x))}if(3!=a.biff&&g>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][v][0])){var O=!0;switch((x=e[0][g])[1][0]){case 4:O=!1;case 0:m=W6(" ",x[1][1]);break;case 5:O=!1;case 1:m=W6("\r",x[1][1]);break;default:if(m="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+x[1][0])}h.push((O?m:"")+h.pop()+(O?"":m)),g=-1}}if(h.length>1&&a.WTF)throw new Error("bad formula stack");return h[0]}function Fte(e,t,n,r,a){var i=Z9(t,n,a),o=function(e){if(null==e){var t=b7(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}return c9("number"==typeof e?e:0)}(e.v),s=b7(6);s.write_shift(2,33),s.write_shift(4,0);for(var l=b7(e.bf.length),c=0;c<e.bf.length;++c)l[c]=e.bf[c];return C5([i,o,s,l])}function Ote(e,t,n){var r=e.read_shift(4),a=_te(e,r,n),i=e.read_shift(4);return[a,i>0?Ete(e,i,a,n):null]}var Lte=Ote,Pte=Ote,Mte=Ote,jte=Ote,Bte={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},zte={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Wte={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Ute(e){return("of:="+e.replace(ate,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")}function Vte(e){return e.replace(/\./,"!")}var Hte="undefined"!==typeof Map;function Gte(e,t,n){var r=0,a=e.length;if(n){if(Hte?n.has(t):Object.prototype.hasOwnProperty.call(n,t))for(var i=Hte?n.get(t):n[t];r<i.length;++r)if(e[i[r]].t===t)return e.Count++,i[r]}else for(;r<a;++r)if(e[r].t===t)return e.Count++,r;return e[a]={t:t},e.Count++,e.Unique++,n&&(Hte?(n.has(t)||n.set(t,[]),n.get(t).push(a)):(Object.prototype.hasOwnProperty.call(n,t)||(n[t]=[]),n[t].push(a))),a}function qte(e,t){var n={min:e+1,max:e+1},r=-1;return t.MDW&&(Cee=t.MDW),null!=t.width?n.customWidth=1:null!=t.wpx?r=_ee(t.wpx):null!=t.wch&&(r=t.wch),r>-1?(n.width=Iee(r),n.customWidth=1):null!=t.width&&(n.width=t.width),t.hidden&&(n.hidden=!0),null!=t.level&&(n.outlineLevel=n.level=t.level),n}function Kte(e,t){if(e){var n=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(n=[1,1,1,1,.5,.5]),null==e.left&&(e.left=n[0]),null==e.right&&(e.right=n[1]),null==e.top&&(e.top=n[2]),null==e.bottom&&(e.bottom=n[3]),null==e.header&&(e.header=n[4]),null==e.footer&&(e.footer=n[5])}}function Xte(e,t,n){var r=n.revssf[null!=t.z?t.z:"General"],a=60,i=e.length;if(null==r&&n.ssf)for(;a<392;++a)if(null==n.ssf[a]){m6(t.z,a),n.ssf[a]=t.z,n.revssf[t.z]=r=a;break}for(a=0;a!=i;++a)if(e[a].numFmtId===r)return a;return e[i]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function Yte(e,t,n){if(e&&e["!ref"]){var r=F7(e["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+n+"): "+e["!ref"])}}var $te=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Jte=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Qte(e,t,n,r){if(e.c&&n["!comments"].push([t,e.c]),void 0===e.v&&"string"!==typeof e.f||"z"===e.t&&!e.f)return"";var a="",i=e.t,o=e.v;if("z"!==e.t)switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=m9[e.v];break;case"d":r&&r.cellDates?a=j6(e.v,-1).toISOString():((e=z6(e)).t="n",a=""+(e.v=A6(j6(e.v)))),"undefined"===typeof e.z&&(e.z=M5[14]);break;default:a=e.v}var s=h8("v",Q6(a)),l={r:t},c=Xte(r.cellXfs,e,r);switch(0!==c&&(l.s=c),e.t){case"n":case"z":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;default:if(null==e.v){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){s=h8("v",""+Gte(r.Strings,e.v,r.revStrings)),l.t="s";break}l.t="str"}if(e.t!=i&&(e.t=i,e.v=o),"string"==typeof e.f&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;s=f8("f",Q6(e.f),u)+(null!=e.v?s:"")}return e.l&&n["!links"].push([t,e.l]),e.D&&(l.cm=1),f8("c",s,l)}function Zte(e,t,n,r){var a,i=[K6,f8("worksheet",null,{xmlns:I8[0],"xmlns:r":S8})],o=n.SheetNames[e],s="",l=n.Sheets[o];null==l&&(l={});var c=l["!ref"]||"A1",u=F7(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=D7(u)}r||(r={}),l["!comments"]=[];var h=[];!function(e,t,n,r,a){var i=!1,o={},s=null;if("xlsx"!==r.bookType&&t.vbaraw){var l=t.SheetNames[n];try{t.Workbook&&(l=t.Workbook.Sheets[n].CodeName||l)}catch(ci){}i=!0,o.codeName=l8(Q6(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),s=(s||"")+f8("outlinePr",null,c)}(i||s)&&(a[a.length]=f8("sheetPr",s,o))}(l,n,e,t,i),i[i.length]=f8("dimension",null,{ref:c}),i[i.length]=function(e,t,n,r){var a={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),f8("sheetViews",f8("sheetView",null,a),{})}(0,0,0,n),t.sheetFormat&&(i[i.length]=f8("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),null!=l["!cols"]&&l["!cols"].length>0&&(i[i.length]=function(e,t){for(var n,r=["<cols>"],a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=f8("col",null,qte(a,n)));return r[r.length]="</cols>",r.join("")}(0,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],null!=l["!ref"]&&(s=function(e,t){var n,r,a=[],i=[],o=F7(e["!ref"]),s="",l="",c=[],u=0,h=0,d=e["!rows"],f=Array.isArray(e),p={r:l},g=-1;for(h=o.s.c;h<=o.e.c;++h)c[h]=I7(h);for(u=o.s.r;u<=o.e.r;++u){for(i=[],l=E7(u),h=o.s.c;h<=o.e.c;++h){n=c[h]+l;var m=f?(e[u]||[])[h]:e[n];void 0!==m&&null!=(s=Qte(m,n,e,t))&&i.push(s)}(i.length>0||d&&d[u])&&(p={r:l},d&&d[u]&&((r=d[u]).hidden&&(p.hidden=1),g=-1,r.hpx?g=Ree(r.hpx):r.hpt&&(g=r.hpt),g>-1&&(p.ht=g,p.customHeight=1),r.level&&(p.outlineLevel=r.level)),a[a.length]=f8("row",i.join(""),p))}if(d)for(;u<d.length;++u)d&&d[u]&&(p={r:u+1},(r=d[u]).hidden&&(p.hidden=1),g=-1,r.hpx?g=Ree(r.hpx):r.hpt&&(g=r.hpt),g>-1&&(p.ht=g,p.customHeight=1),r.level&&(p.outlineLevel=r.level),a[a.length]=f8("row","",p));return a.join("")}(l,t,0,0),s.length>0&&(i[i.length]=s)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=function(e){var t={sheet:1};return $te.forEach(function(n){null!=e[n]&&e[n]&&(t[n]="1")}),Jte.forEach(function(n){null==e[n]||e[n]||(t[n]="0")}),e.password&&(t.password=kee(e.password).toString(16).toUpperCase()),f8("sheetProtection",null,t)}(l["!protect"])),null!=l["!autofilter"]&&(i[i.length]=function(e,t,n,r){var a="string"==typeof e.ref?e.ref:D7(e.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var i=n.Workbook.Names,o=R7(a);o.s.r==o.e.r&&(o.e.r=R7(t["!ref"]).e.r,a=D7(o));for(var s=0;s<i.length;++s){var l=i[s];if("_xlnm._FilterDatabase"==l.Name&&l.Sheet==r){l.Ref="'"+n.SheetNames[r]+"'!"+a;break}}return s==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+a}),f8("autoFilter",null,{ref:a})}(l["!autofilter"],l,n,e)),null!=l["!merges"]&&l["!merges"].length>0&&(i[i.length]=function(e){if(0===e.length)return"";for(var t='<mergeCells count="'+e.length+'">',n=0;n!=e.length;++n)t+='<mergeCell ref="'+D7(e[n])+'"/>';return t+"</mergeCells>"}(l["!merges"]));var d,f,p=-1,g=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(e){e[1].Target&&(d={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(g=N9(r,-1,Q6(e[1].Target).replace(/#.*$/,""),y9.HLINK),d["r:id"]="rId"+g),(p=e[1].Target.indexOf("#"))>-1&&(d.location=Q6(e[1].Target.slice(p+1))),e[1].Tooltip&&(d.tooltip=Q6(e[1].Tooltip)),i[i.length]=f8("hyperlink",null,d))}),i[i.length]="</hyperlinks>"),delete l["!links"],null!=l["!margins"]&&(i[i.length]=(Kte(f=l["!margins"]),f8("pageMargins",null,f))),t&&!t.ignoreEC&&void 0!=t.ignoreEC||(i[i.length]=h8("ignoredErrors",f8("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(g=N9(r,-1,"../drawings/drawing"+(e+1)+".xml",y9.DRAW),i[i.length]=f8("drawing",null,{"r:id":"rId"+g}),l["!drawing"]=h),l["!comments"].length>0&&(g=N9(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",y9.VML),i[i.length]=f8("legacyDrawing",null,{"r:id":"rId"+g}),l["!legacy"]=g),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function ene(e,t,n,r){var a=function(e,t,n){var r=b7(145),a=(n["!rows"]||[])[e]||{};r.write_shift(4,e),r.write_shift(4,0);var i=320;a.hpx?i=20*Ree(a.hpx):a.hpt&&(i=20*a.hpt),r.write_shift(2,i),r.write_shift(1,0);var o=0;a.level&&(o|=a.level),a.hidden&&(o|=16),(a.hpx||a.hpt)&&(o|=32),r.write_shift(1,o),r.write_shift(1,0);var s=0,l=r.l;r.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var h=-1,d=-1,f=u<<10;f<u+1<<10;++f)c.c=f,(Array.isArray(n)?(n[c.r]||[])[c.c]:n[A7(c)])&&(h<0&&(h=f),d=f);h<0||(++s,r.write_shift(4,h),r.write_shift(4,d))}var p=r.l;return r.l=l,r.write_shift(4,s),r.l=p,r.length>r.l?r.slice(0,r.l):r}(r,n,t);(a.length>17||(t["!rows"]||[])[r])&&y7(e,0,a)}var tne=o9,nne=s9;function rne(e){return[X7(e),l9(e),"n"]}var ane=o9,ine=s9;var one=["left","right","top","bottom","header","footer"];function sne(e,t,n,r,a,i,o){if(void 0===t.v)return!1;var s="";switch(t.t){case"b":s=t.v?"1":"0";break;case"d":(t=z6(t)).z=t.z||M5[14],t.v=A6(j6(t.v)),t.t="n";break;case"n":case"e":s=""+t.v;break;default:s=t.v}var l={r:n,c:r};switch(l.s=Xte(a.cellXfs,t,a),t.l&&i["!links"].push([A7(l),t.l]),t.c&&i["!comments"].push([A7(l),t.c]),t.t){case"s":case"str":return a.bookSST?(s=Gte(a.Strings,t.v,a.revStrings),l.t="s",l.v=s,o?y7(e,18,function(e,t,n){return null==n&&(n=b7(8)),Y7(t,n),n.write_shift(4,t.v),n}(0,l)):y7(e,7,function(e,t,n){return null==n&&(n=b7(12)),K7(t,n),n.write_shift(4,t.v),n}(0,l))):(l.t="str",o?y7(e,17,function(e,t,n){return null==n&&(n=b7(8+4*e.v.length)),Y7(t,n),W7(e.v,n),n.length>n.l?n.slice(0,n.l):n}(t,l)):y7(e,6,function(e,t,n){return null==n&&(n=b7(12+4*e.v.length)),K7(t,n),W7(e.v,n),n.length>n.l?n.slice(0,n.l):n}(t,l))),!0;case"n":return t.v==(0|t.v)&&t.v>-1e3&&t.v<1e3?o?y7(e,13,function(e,t,n){return null==n&&(n=b7(8)),Y7(t,n),a9(e.v,n),n}(t,l)):y7(e,2,function(e,t,n){return null==n&&(n=b7(12)),K7(t,n),a9(e.v,n),n}(t,l)):o?y7(e,16,function(e,t,n){return null==n&&(n=b7(12)),Y7(t,n),c9(e.v,n),n}(t,l)):y7(e,5,function(e,t,n){return null==n&&(n=b7(16)),K7(t,n),c9(e.v,n),n}(t,l)),!0;case"b":return l.t="b",o?y7(e,15,function(e,t,n){return null==n&&(n=b7(5)),Y7(t,n),n.write_shift(1,e.v?1:0),n}(t,l)):y7(e,4,function(e,t,n){return null==n&&(n=b7(9)),K7(t,n),n.write_shift(1,e.v?1:0),n}(t,l)),!0;case"e":return l.t="e",o?y7(e,14,function(e,t,n){return null==n&&(n=b7(8)),Y7(t,n),n.write_shift(1,e.v),n.write_shift(2,0),n.write_shift(1,0),n}(t,l)):y7(e,3,function(e,t,n){return null==n&&(n=b7(9)),K7(t,n),n.write_shift(1,e.v),n}(t,l)),!0}return o?y7(e,12,function(e,t,n){return null==n&&(n=b7(4)),Y7(t,n)}(0,l)):y7(e,1,function(e,t,n){return null==n&&(n=b7(8)),K7(t,n)}(0,l)),!0}function lne(e,t){t&&t["!merges"]&&(y7(e,177,function(e,t){return null==t&&(t=b7(4)),t.write_shift(4,e),t}(t["!merges"].length)),t["!merges"].forEach(function(t){y7(e,176,ine(t))}),y7(e,178))}function cne(e,t){t&&t["!cols"]&&(y7(e,390),t["!cols"].forEach(function(t,n){t&&y7(e,60,function(e,t,n){null==n&&(n=b7(18));var r=qte(e,t);n.write_shift(-4,e),n.write_shift(-4,e),n.write_shift(4,256*(r.width||10)),n.write_shift(4,0);var a=0;return t.hidden&&(a|=1),"number"==typeof r.width&&(a|=2),t.level&&(a|=t.level<<8),n.write_shift(2,a),n}(n,t))}),y7(e,391))}function une(e,t){t&&t["!ref"]&&(y7(e,648),y7(e,649,function(e){var t=b7(24);return t.write_shift(4,4),t.write_shift(4,1),s9(e,t),t}(F7(t["!ref"]))),y7(e,650))}function hne(e,t,n){t["!links"].forEach(function(t){if(t[1].Target){var r=N9(n,-1,t[1].Target.replace(/#.*$/,""),y9.HLINK);y7(e,494,function(e,t){var n=b7(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));s9({s:T7(e[0]),e:T7(e[0])},n),n9("rId"+t,n);var r=e[1].Target.indexOf("#");return W7((-1==r?"":e[1].Target.slice(r+1))||"",n),W7(e[1].Tooltip||"",n),W7("",n),n.slice(0,n.l)}(t,r))}}),delete t["!links"]}function dne(e,t,n){y7(e,133),y7(e,137,function(e,t,n){null==n&&(n=b7(30));var r=924;return(((t||{}).Views||[])[0]||{}).RTL&&(r|=32),n.write_shift(2,r),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,100),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n}(0,n)),y7(e,138),y7(e,134)}function fne(e,t){t["!protect"]&&y7(e,535,function(e,t){return null==t&&(t=b7(66)),t.write_shift(2,e.password?kee(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(n){n[1]?t.write_shift(4,null==e[n[0]]||e[n[0]]?0:1):t.write_shift(4,null!=e[n[0]]&&e[n[0]]?0:1)}),t}(t["!protect"]))}function pne(e,t,n,r){var a=x7(),i=n.SheetNames[e],o=n.Sheets[i]||{},s=i;try{n&&n.Workbook&&(s=n.Workbook.Sheets[e].CodeName||s)}catch(ci){}var l=F7(o["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],y7(a,129),(n.vbaraw||o["!outline"])&&y7(a,147,function(e,t,n){null==n&&(n=b7(84+4*e.length));var r=192;t&&(t.above&&(r&=-65),t.left&&(r&=-129)),n.write_shift(1,r);for(var a=1;a<3;++a)n.write_shift(1,0);return u9({auto:1},n),n.write_shift(-4,-1),n.write_shift(-4,-1),J7(e,n),n.slice(0,n.l)}(s,o["!outline"])),y7(a,148,nne(l)),dne(a,0,n.Workbook),cne(a,o),function(e,t,n,r){var a,i=F7(t["!ref"]||"A1"),o="",s=[];y7(e,145);var l=Array.isArray(t),c=i.e.r;t["!rows"]&&(c=Math.max(i.e.r,t["!rows"].length-1));for(var u=i.s.r;u<=c;++u){o=E7(u),ene(e,t,i,u);var h=!1;if(u<=i.e.r)for(var d=i.s.c;d<=i.e.c;++d){u===i.s.r&&(s[d]=I7(d)),a=s[d]+o;var f=l?(t[u]||[])[d]:t[a];h=!!f&&sne(e,f,u,d,r,t,h)}}y7(e,146)}(a,o,0,t),fne(a,o),function(e,t,n,r){if(t["!autofilter"]){var a=t["!autofilter"],i="string"===typeof a.ref?a.ref:D7(a.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var o=n.Workbook.Names,s=R7(i);s.s.r==s.e.r&&(s.e.r=R7(t["!ref"]).e.r,i=D7(s));for(var l=0;l<o.length;++l){var c=o[l];if("_xlnm._FilterDatabase"==c.Name&&c.Sheet==r){c.Ref="'"+n.SheetNames[r]+"'!"+i;break}}l==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+i}),y7(e,161,s9(F7(i))),y7(e,162)}}(a,o,n,e),lne(a,o),hne(a,o,r),o["!margins"]&&y7(a,476,function(e,t){return null==t&&(t=b7(48)),Kte(e),one.forEach(function(n){c9(e[n],t)}),t}(o["!margins"])),t&&!t.ignoreEC&&void 0!=t.ignoreEC||une(a,o),function(e,t,n,r){if(t["!comments"].length>0){var a=N9(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",y9.VML);y7(e,551,n9("rId"+a)),t["!legacy"]=a}}(a,o,e,r),y7(a,130),a.end()}var gne=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];var mne="][*?/\\".split("");function vne(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var n=!0;return mne.forEach(function(r){if(-1!=e.indexOf(r)){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");n=!1}}),n}function bne(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];!function(e,t,n){e.forEach(function(r,a){vne(r);for(var i=0;i<a;++i)if(r==e[i])throw new Error("Duplicate Sheet Name: "+r);if(n){var o=t&&t[a]&&t[a].CodeName||r;if(95==o.charCodeAt(0)&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}(e.SheetNames,t,!!e.vbaraw);for(var n=0;n<e.SheetNames.length;++n)Yte(e.Sheets[e.SheetNames[n]],e.SheetNames[n],n)}function xne(e){var t=[K6];t[t.length]=f8("workbook",null,{xmlns:I8[0],"xmlns:r":S8});var n=e.Workbook&&(e.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(gne.forEach(function(t){null!=e.Workbook.WBProps[t[0]]&&e.Workbook.WBProps[t[0]]!=t[1]&&(r[t[0]]=e.Workbook.WBProps[t[0]])}),e.Workbook.WBProps.CodeName&&(r.codeName=e.Workbook.WBProps.CodeName,delete r.CodeName)),t[t.length]=f8("workbookPr",null,r);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&a[i]&&a[i].Hidden;++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var o={name:Q6(e.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden"}t[t.length]=f8("sheet",null,o)}return t[t.length]="</sheets>",n&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(e){var n={name:e.Name};e.Comment&&(n.comment=e.Comment),null!=e.Sheet&&(n.localSheetId=""+e.Sheet),e.Hidden&&(n.hidden="1"),e.Ref&&(t[t.length]=f8("definedName",Q6(e.Ref),n))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function yne(e,t){return t||(t=b7(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),n9(e.strRelID,t),W7(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function wne(e,t){if(t.Workbook&&t.Workbook.Sheets){for(var n=t.Workbook.Sheets,r=0,a=-1,i=-1;r<n.length;++r)!n[r]||!n[r].Hidden&&-1==a?a=r:1==n[r].Hidden&&-1==i&&(i=r);i>a||(y7(e,135),y7(e,158,function(e,t){return t||(t=b7(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e),t.write_shift(1,120),t.length>t.l?t.slice(0,t.l):t}(a)),y7(e,136))}}function kne(e,t){var n=x7();return y7(n,131),y7(n,128,function(e,t){t||(t=b7(127));for(var n=0;4!=n;++n)t.write_shift(4,0);return W7("SheetJS",t),W7(r5.version,t),W7(r5.version,t),W7("7262",t),t.length>t.l?t.slice(0,t.l):t}()),y7(n,153,function(e,t){t||(t=b7(72));var n=0;return e&&e.filterPrivacy&&(n|=8),t.write_shift(4,n),t.write_shift(4,0),J7(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}(e.Workbook&&e.Workbook.WBProps||null)),wne(n,e),function(e,t){y7(e,143);for(var n=0;n!=t.SheetNames.length;++n)y7(e,156,yne({Hidden:t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[n]&&t.Workbook.Sheets[n].Hidden||0,iTabID:n+1,strRelID:"rId"+(n+1),name:t.SheetNames[n]}));y7(e,144)}(n,e),y7(n,132),n.end()}function Nne(e,t,n,r,a){return(".bin"===t.slice(-4)?pne:Zte)(e,n,r,a)}function Sne(e,t,n){return(".bin"===t.slice(-4)?tte:Qee)(e,n)}function Cne(e,t){var n=[];return e.Props&&n.push(function(e,t){var n=[];return C6(O9).map(function(e){for(var t=0;t<_9.length;++t)if(_9[t][1]==e)return _9[t];for(t=0;t<A9.length;++t)if(A9[t][1]==e)return A9[t];throw e}).forEach(function(r){if(null!=e[r[1]]){var a=t&&t.Props&&null!=t.Props[r[1]]?t.Props[r[1]]:e[r[1]];"date"===r[2]&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof a?a=String(a):!0===a||!1===a?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),n.push(h8(O9[r[1]]||r[1],a))}}),f8("DocumentProperties",n.join(""),{xmlns:T8})}(e.Props,t)),e.Custprops&&n.push(function(e,t){var n=["Worksheets","SheetNames"],r="CustomDocumentProperties",a=[];return e&&C6(e).forEach(function(t){if(Object.prototype.hasOwnProperty.call(e,t)){for(var r=0;r<_9.length;++r)if(t==_9[r][1])return;for(r=0;r<A9.length;++r)if(t==A9[r][1])return;for(r=0;r<n.length;++r)if(t==n[r])return;var i=e[t],o="string";"number"==typeof i?(o="float",i=String(i)):!0===i||!1===i?(o="boolean",i=i?"1":"0"):i=String(i),a.push(f8(Z6(t),i,{"dt:dt":o}))}}),t&&C6(t).forEach(function(n){if(Object.prototype.hasOwnProperty.call(t,n)&&(!e||!Object.prototype.hasOwnProperty.call(e,n))){var r=t[n],i="string";"number"==typeof r?(i="float",r=String(r)):!0===r||!1===r?(i="boolean",r=r?"1":"0"):r instanceof Date?(i="dateTime.tz",r=r.toISOString()):r=String(r),a.push(f8(Z6(n),r,{"dt:dt":i}))}}),"<"+r+' xmlns="'+T8+'">'+a.join("")+"</"+r+">"}(e.Props,e.Custprops)),n.join("")}function Ene(e){return f8("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+ite(e.Ref,{r:0,c:0})})}function _ne(e,t,n,r,a,i,o){if(!e||void 0==e.v&&void 0==e.f)return"";var s={};if(e.f&&(s["ss:Formula"]="="+Q6(ite(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var l=T7(e.F.slice(t.length+1));s["ss:ArrayRange"]="RC:R"+(l.r==o.r?"":"["+(l.r-o.r)+"]")+"C"+(l.c==o.c?"":"["+(l.c-o.c)+"]")}if(e.l&&e.l.Target&&(s["ss:HRef"]=Q6(e.l.Target),e.l.Tooltip&&(s["x:HRefScreenTip"]=Q6(e.l.Tooltip))),n["!merges"])for(var c=n["!merges"],u=0;u!=c.length;++u)c[u].s.c==o.c&&c[u].s.r==o.r&&(c[u].e.c>c[u].s.c&&(s["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(s["ss:MergeDown"]=c[u].e.r-c[u].s.r));var h="",d="";switch(e.t){case"z":if(!r.sheetStubs)return"";break;case"n":h="Number",d=String(e.v);break;case"b":h="Boolean",d=e.v?"1":"0";break;case"e":h="Error",d=m9[e.v];break;case"d":h="DateTime",d=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||M5[14]);break;case"s":h="String",d=((e.v||"")+"").replace($6,function(e){return Y6[e]}).replace(e8,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}var f=Xte(r.cellXfs,e,r);s["ss:StyleID"]="s"+(21+f),s["ss:Index"]=o.c+1;var p=null!=e.v?d:"",g="z"==e.t?"":'<Data ss:Type="'+h+'">'+p+"</Data>";return(e.c||[]).length>0&&(g+=e.c.map(function(e){var t=f8("ss:Data",(e.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return f8("Comment",t,{"ss:Author":e.a})}).join("")),f8("Cell",g,s)}function Ine(e,t){var n='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Dee(t.hpt)),t.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(n+=' ss:Hidden="1"')),n+">"}function Tne(e,t,n){var r=[],a=n.SheetNames[e],i=n.Sheets[a],o=i?function(e,t,n,r){if(!e)return"";if(!((r||{}).Workbook||{}).Names)return"";for(var a=r.Workbook.Names,i=[],o=0;o<a.length;++o){var s=a[o];s.Sheet==n&&(s.Name.match(/^_xlfn\./)||i.push(Ene(s)))}return i.join("")}(i,0,e,n):"";return o.length>0&&r.push("<Names>"+o+"</Names>"),o=i?function(e,t){if(!e["!ref"])return"";var n=F7(e["!ref"]),r=e["!merges"]||[],a=0,i=[];e["!cols"]&&e["!cols"].forEach(function(e,t){Tee(e);var n=!!e.width,r=qte(t,e),a={"ss:Index":t+1};n&&(a["ss:Width"]=Eee(r.width)),e.hidden&&(a["ss:Hidden"]="1"),i.push(f8("Column",null,a))});for(var o=Array.isArray(e),s=n.s.r;s<=n.e.r;++s){for(var l=[Ine(s,(e["!rows"]||[])[s])],c=n.s.c;c<=n.e.c;++c){var u=!1;for(a=0;a!=r.length;++a)if(!(r[a].s.c>c)&&!(r[a].s.r>s)&&!(r[a].e.c<c)&&!(r[a].e.r<s)){r[a].s.c==c&&r[a].s.r==s||(u=!0);break}if(!u){var h={r:s,c:c},d=A7(h),f=o?(e[s]||[])[c]:e[d];l.push(_ne(f,d,e,t,0,0,h))}}l.push("</Row>"),l.length>2&&i.push(l.join(""))}return i.join("")}(i,t):"",o.length>0&&r.push("<Table>"+o+"</Table>"),r.push(function(e,t,n,r){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(f8("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(f8("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(f8("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[n])if(r.Workbook.Sheets[n].Hidden)a.push(f8("Visible",1==r.Workbook.Sheets[n].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<n&&(!r.Workbook.Sheets[i]||r.Workbook.Sheets[i].Hidden);++i);i==n&&a.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(h8("ProtectContents","True")),e["!protect"].objects&&a.push(h8("ProtectObjects","True")),e["!protect"].scenarios&&a.push(h8("ProtectScenarios","True")),null==e["!protect"].selectLockedCells||e["!protect"].selectLockedCells?null==e["!protect"].selectUnlockedCells||e["!protect"].selectUnlockedCells||a.push(h8("EnableSelection","UnlockedCells")):a.push(h8("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(t){e["!protect"][t[0]]&&a.push("<"+t[1]+"/>")})),0==a.length?"":f8("WorksheetOptions",a.join(""),{xmlns:A8})}(i,0,e,n)),r.join("")}function Ane(e,t){t||(t={}),e.SSF||(e.SSF=z6(M5)),e.SSF&&(b6(),v6(e.SSF),t.revssf=I6(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Xte(t.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(Cne(e,t)),n.push(""),n.push(""),n.push("");for(var r=0;r<e.SheetNames.length;++r)n.push(f8("Worksheet",Tne(r,t,e),{"ss:Name":Q6(e.SheetNames[r])}));return n[2]=function(e,t){var n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(e,t){var r=[];r.push(f8("NumberFormat",null,{"ss:Format":Q6(M5[e.numFmtId])}));var a={"ss:ID":"s"+(21+t)};n.push(f8("Style",r.join(""),a))}),f8("Styles",n.join(""))}(0,t),n[3]=function(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,n=[],r=0;r<t.length;++r){var a=t[r];null==a.Sheet&&(a.Name.match(/^_xlfn\./)||n.push(Ene(a)))}return f8("Names",n.join(""))}(e),K6+f8("Workbook",n.join(""),{xmlns:R8,"xmlns:o":T8,"xmlns:x":A8,"xmlns:ss":R8,"xmlns:dt":D8,"xmlns:html":L8})}var Rne="e0859ff2f94f6810ab9108002b27b3d9",Dne="02d5cdd59c2e1b10939708002b2cf9ae",Fne="05d5cdd59c2e1b10939708002b2cf9ae";function One(e,t){var n=t||{},r=w6.utils.cfb_new({root:"R"}),a="/Workbook";switch(n.bookType||"xls"){case"xls":n.bookType="biff8";case"xla":n.bookType||(n.bookType="xla");case"biff8":a="/Workbook",n.biff=8;break;case"biff5":a="/Book",n.biff=5;break;default:throw new Error("invalid type "+n.bookType+" for XLS CFB")}return w6.utils.cfb_add(r,a,Gne(e,n)),8==n.biff&&(e.Props||e.Custprops)&&function(e,t){var n,r=[],a=[],i=[],o=0,s=E6(d9,"n"),l=E6(f9,"n");if(e.Props)for(n=C6(e.Props),o=0;o<n.length;++o)(Object.prototype.hasOwnProperty.call(s,n[o])?r:Object.prototype.hasOwnProperty.call(l,n[o])?a:i).push([n[o],e.Props[n[o]]]);if(e.Custprops)for(n=C6(e.Custprops),o=0;o<n.length;++o)Object.prototype.hasOwnProperty.call(e.Props||{},n[o])||(Object.prototype.hasOwnProperty.call(s,n[o])?r:Object.prototype.hasOwnProperty.call(l,n[o])?a:i).push([n[o],e.Custprops[n[o]]]);var c=[];for(o=0;o<i.length;++o)P9.indexOf(i[o][0])>-1||R9.indexOf(i[o][0])>-1||null!=i[o][1]&&c.push(i[o]);a.length&&w6.utils.cfb_add(t,"/\x05SummaryInformation",B9(a,Rne,l,f9)),(r.length||c.length)&&w6.utils.cfb_add(t,"/\x05DocumentSummaryInformation",B9(r,Dne,s,d9,c.length?c:null,Fne))}(e,r),8==n.biff&&e.vbaraw&&function(e,t){t.FullPaths.forEach(function(n,r){if(0!=r){var a=n.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==a.slice(-1)&&w6.utils.cfb_add(e,a,t.FileIndex[r].content)}})}(r,w6.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})),r}var Lne={0:{f:function(e,t){var n={},r=e.l+t;n.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=r,7&i&&(n.level=7&i),16&i&&(n.hidden=!0),32&i&&(n.hpt=a/20),n}},1:{f:function(e){return[q7(e)]}},2:{f:function(e){return[q7(e),r9(e),"n"]}},3:{f:function(e){return[q7(e),e.read_shift(1),"e"]}},4:{f:function(e){return[q7(e),e.read_shift(1),"b"]}},5:{f:function(e){return[q7(e),l9(e),"n"]}},6:{f:function(e){return[q7(e),z7(e),"str"]}},7:{f:function(e){return[q7(e),e.read_shift(4),"s"]}},8:{f:function(e,t,n){var r=e.l+t,a=q7(e);a.r=n["!row"];var i=[a,z7(e),"str"];if(n.cellFormula){e.l+=2;var o=Pte(e,r-e.l,n);i[3]=Dte(o,0,a,n.supbooks,n)}else e.l=r;return i}},9:{f:function(e,t,n){var r=e.l+t,a=q7(e);a.r=n["!row"];var i=[a,l9(e),"n"];if(n.cellFormula){e.l+=2;var o=Pte(e,r-e.l,n);i[3]=Dte(o,0,a,n.supbooks,n)}else e.l=r;return i}},10:{f:function(e,t,n){var r=e.l+t,a=q7(e);a.r=n["!row"];var i=[a,e.read_shift(1),"b"];if(n.cellFormula){e.l+=2;var o=Pte(e,r-e.l,n);i[3]=Dte(o,0,a,n.supbooks,n)}else e.l=r;return i}},11:{f:function(e,t,n){var r=e.l+t,a=q7(e);a.r=n["!row"];var i=[a,e.read_shift(1),"e"];if(n.cellFormula){e.l+=2;var o=Pte(e,r-e.l,n);i[3]=Dte(o,0,a,n.supbooks,n)}else e.l=r;return i}},12:{f:function(e){return[X7(e)]}},13:{f:function(e){return[X7(e),r9(e),"n"]}},14:{f:function(e){return[X7(e),e.read_shift(1),"e"]}},15:{f:function(e){return[X7(e),e.read_shift(1),"b"]}},16:{f:rne},17:{f:function(e){return[X7(e),z7(e),"str"]}},18:{f:function(e){return[X7(e),e.read_shift(4),"s"]}},19:{f:V7},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,n){var r=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=e9(e),o=Mte(e,0,n),s=Q7(e);e.l=r;var l={Name:i,Ptg:o};return a<268435455&&(l.Sheet=a),s&&(l.Comment=s),l}},40:{},42:{},43:{f:function(e,t,n){var r={};r.sz=e.read_shift(2)/20;var a=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(a.fItalic&&(r.italic=1),a.fCondense&&(r.condense=1),a.fExtend&&(r.extend=1),a.fShadow&&(r.shadow=1),a.fOutline&&(r.outline=1),a.fStrikeout&&(r.strike=1),700===e.read_shift(2)&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript"}var i=e.read_shift(1);0!=i&&(r.underline=i);var o=e.read_shift(1);o>0&&(r.family=o);var s=e.read_shift(1);switch(s>0&&(r.charset=s),e.l++,r.color=function(e){var t={},n=e.read_shift(1)>>>1,r=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),s=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=r;var l=g9[r];l&&(t.rgb=See(l));break;case 2:t.rgb=See([i,o,s]);break;case 3:t.theme=r}return 0!=a&&(t.tint=a>0?a/32767:a/32768),t}(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor"}return r.name=z7(e),r}},44:{f:function(e,t){return[e.read_shift(2),z7(e)]}},45:{f:jee},46:{f:Uee},47:{f:function(e,t){var n=e.l+t,r=e.read_shift(2),a=e.read_shift(2);return e.l=n,{ixfe:r,numFmtId:a}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],n=e.read_shift(4);n-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:uee},62:{f:function(e){return[q7(e),V7(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var n={};n.r=e.read_shift(4),n.c=e.read_shift(4),t.r=A7(n);var r=e.read_shift(1);return 2&r&&(t.l="1"),8&r&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:v7,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var n={},r=e[e.l];return++e.l,n.above=!(64&r),n.left=!(128&r),e.l+=18,n.name=$7(e,t-19),n}},148:{f:tne,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var n={},r=e.read_shift(4);n.defaultThemeVersion=e.read_shift(4);var a=t>8?z7(e):"";return a.length>0&&(n.CodeName=a),n.autoCompressPictures=!!(65536&r),n.backupFile=!!(64&r),n.checkCompatibility=!!(4096&r),n.date1904=!!(1&r),n.filterPrivacy=!!(8&r),n.hidePivotFieldList=!!(1024&r),n.promptedSolutions=!!(16&r),n.publishItems=!!(2048&r),n.refreshAllConnections=!!(262144&r),n.saveExternalLinkValues=!!(128&r),n.showBorderUnselectedTables=!!(4&r),n.showInkAnnotation=!!(32&r),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(32768&r),n.updateLinks=["userSet","never","always"][r>>8&3],n}},154:{},155:{},156:{f:function(e,t){var n={};return n.Hidden=e.read_shift(4),n.iTabID=e.read_shift(4),n.strRelID=t9(e,t-8),n.name=z7(e),n}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:o9},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:ane},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:z7(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:t9},357:{},358:{},359:{},360:{T:1},361:{},362:{f:see},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,n){var r=e.l+t,a=i9(e),i=e.read_shift(1),o=[a];if(o[2]=i,n.cellFormula){var s=Lte(e,r-e.l,n);o[1]=s}else e.l=r;return o}},427:{f:function(e,t,n){var r=e.l+t,a=[o9(e,16)];if(n.cellFormula){var i=jte(e,r-e.l,n);a[1]=i,e.l=r}else e.l=r;return a}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return one.forEach(function(n){t[n]=l9(e)}),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var n=e.l+t,r=o9(e,16),a=Q7(e),i=z7(e),o=z7(e),s=z7(e);e.l=n;var l={rfx:r,relId:a,loc:i,display:s};return o&&(l.Tooltip=o),l}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:t9},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:ete},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var n=o9(e,16);return t.rfx=n.s,t.ref=A7(n.s),e.l+=16,t}},636:{T:-1},637:{f:H7},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:z7(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Pne(e,t,n,r){var a=t;if(!isNaN(a)){var i=r||(n||[]).length||0,o=e.next(4);o.write_shift(2,a),o.write_shift(2,i),i>0&&n7(n)&&e.push(n)}}function Mne(e,t,n){return e||(e=b7(7)),e.write_shift(2,t),e.write_shift(2,n),e.write_shift(2,0),e.write_shift(1,0),e}function jne(e,t,n,r){if(null!=t.v)switch(t.t){case"d":case"n":var a="d"==t.t?A6(j6(t.v)):t.v;return void(a==(0|a)&&a>=0&&a<65536?Pne(e,2,function(e,t,n){var r=b7(9);return Mne(r,e,t),r.write_shift(2,n),r}(n,r,a)):Pne(e,3,function(e,t,n){var r=b7(15);return Mne(r,e,t),r.write_shift(8,n,"f"),r}(n,r,a)));case"b":case"e":return void Pne(e,5,function(e,t,n,r){var a=b7(9);return Mne(a,e,t),H9(n,r||"b",a),a}(n,r,t.v,t.t));case"s":case"str":return void Pne(e,4,function(e,t,n){var r=b7(8+2*n.length);return Mne(r,e,t),r.write_shift(1,n.length),r.write_shift(n.length,n,"sbcs"),r.l<r.length?r.slice(0,r.l):r}(n,r,(t.v||"").slice(0,255)))}Pne(e,1,Mne(null,n,r))}function Bne(e,t){var n=t||{};for(var r=x7(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==n.sheet&&(a=i);if(0==a&&n.sheet&&e.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return Pne(r,4==n.biff?1033:3==n.biff?521:9,ree(0,16,n)),function(e,t,n,r){var a,i=Array.isArray(t),o=F7(t["!ref"]||"A1"),s="",l=[];if(o.e.c>255||o.e.r>16383){if(r.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.c,16383),a=D7(o)}for(var c=o.s.r;c<=o.e.r;++c){s=E7(c);for(var u=o.s.c;u<=o.e.c;++u){c===o.s.r&&(l[u]=I7(u)),a=l[u]+s;var h=i?(t[c]||[])[u]:t[a];h&&jne(e,h,c,u)}}}(r,e.Sheets[e.SheetNames[a]],0,n),Pne(r,10),r.end()}function zne(e,t,n){Pne(e,49,function(e,t){var n=e.name||"Arial",r=t&&5==t.biff,a=b7(r?15+n.length:16+2*n.length);return a.write_shift(2,20*(e.sz||12)),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,n.length),r||a.write_shift(1,1),a.write_shift((r?1:2)*n.length,n,r?"sbcs":"utf16le"),a}({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},n))}function Wne(e,t){if(t){var n=0;t.forEach(function(t,r){++n<=256&&t&&Pne(e,125,function(e,t){var n=b7(12);n.write_shift(2,t),n.write_shift(2,t),n.write_shift(2,256*e.width),n.write_shift(2,0);var r=0;return e.hidden&&(r|=1),n.write_shift(1,r),r=e.level||0,n.write_shift(1,r),n.write_shift(2,0),n}(qte(r,t),r))})}}function Une(e,t,n,r,a){var i=16+Xte(a.cellXfs,t,a);if(null!=t.v||t.bf)if(t.bf)Pne(e,6,Fte(t,n,r,0,i));else switch(t.t){case"d":case"n":Pne(e,515,function(e,t,n,r){var a=b7(14);return Z9(e,t,r,a),c9(n,a),a}(n,r,"d"==t.t?A6(j6(t.v)):t.v,i));break;case"b":case"e":Pne(e,517,function(e,t,n,r,a,i){var o=b7(8);return Z9(e,t,r,o),H9(n,i,o),o}(n,r,t.v,i,0,t.t));break;case"s":case"str":if(a.bookSST)Pne(e,253,function(e,t,n,r){var a=b7(10);return Z9(e,t,r,a),a.write_shift(4,n),a}(n,r,Gte(a.Strings,t.v,a.revStrings),i));else Pne(e,516,function(e,t,n,r,a){var i=!a||8==a.biff,o=b7(+i+8+(1+i)*n.length);return Z9(e,t,r,o),o.write_shift(2,n.length),i&&o.write_shift(1,1),o.write_shift((1+i)*n.length,n,i?"utf16le":"sbcs"),o}(n,r,(t.v||"").slice(0,255),i,a));break;default:Pne(e,513,Z9(n,r,i))}else Pne(e,513,Z9(n,r,i))}function Vne(e,t,n){var r,a=x7(),i=n.SheetNames[e],o=n.Sheets[i]||{},s=(n||{}).Workbook||{},l=(s.Sheets||[])[e]||{},c=Array.isArray(o),u=8==t.biff,h="",d=[],f=F7(o["!ref"]||"A1"),p=u?65536:16384;if(f.e.c>255||f.e.r>=p){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,p-1)}Pne(a,2057,ree(0,16,t)),Pne(a,13,V9(1)),Pne(a,12,V9(100)),Pne(a,15,W9(!0)),Pne(a,17,W9(!1)),Pne(a,16,c9(.001)),Pne(a,95,W9(!0)),Pne(a,42,W9(!1)),Pne(a,43,W9(!1)),Pne(a,130,V9(1)),Pne(a,128,function(e){var t=b7(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}([0,0])),Pne(a,131,W9(!1)),Pne(a,132,W9(!1)),u&&Wne(a,o["!cols"]),Pne(a,512,function(e,t){var n=8!=t.biff&&t.biff?2:4,r=b7(2*n+6);return r.write_shift(n,e.s.r),r.write_shift(n,e.e.r+1),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c+1),r.write_shift(2,0),r}(f,t)),u&&(o["!links"]=[]);for(var g=f.s.r;g<=f.e.r;++g){h=E7(g);for(var m=f.s.c;m<=f.e.c;++m){g===f.s.r&&(d[m]=I7(m)),r=d[m]+h;var v=c?(o[g]||[])[m]:o[r];v&&(Une(a,v,g,m,t),u&&v.l&&o["!links"].push([r,v.l]))}}var b=l.CodeName||l.name||i;return u&&Pne(a,574,function(e){var t=b7(18),n=1718;return e&&e.RTL&&(n|=64),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}((s.Views||[])[0])),u&&(o["!merges"]||[]).length&&Pne(a,229,function(e){var t=b7(2+8*e.length);t.write_shift(2,e.length);for(var n=0;n<e.length;++n)nee(e[n],t);return t}(o["!merges"])),u&&function(e,t){for(var n=0;n<t["!links"].length;++n){var r=t["!links"][n];Pne(e,440,lee(r)),r[1].Tooltip&&Pne(e,2048,cee(r))}delete t["!links"]}(a,o),Pne(a,442,$9(b)),u&&function(e,t){var n=b7(19);n.write_shift(4,2151),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,1),n.write_shift(4,0),Pne(e,2151,n),(n=b7(39)).write_shift(4,2152),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(2,1),n.write_shift(4,4),n.write_shift(2,0),nee(F7(t["!ref"]||"A1"),n),n.write_shift(4,4),Pne(e,2152,n)}(a,o),Pne(a,10),a.end()}function Hne(e,t,n){var r=x7(),a=(e||{}).Workbook||{},i=a.Sheets||[],o=a.WBProps||{},s=8==n.biff,l=5==n.biff;(Pne(r,2057,ree(0,5,n)),"xla"==n.bookType&&Pne(r,135),Pne(r,225,s?V9(1200):null),Pne(r,193,function(e,t){t||(t=b7(e));for(var n=0;n<e;++n)t.write_shift(1,0);return t}(2)),l&&Pne(r,191),l&&Pne(r,192),Pne(r,226),Pne(r,92,function(e,t){var n=!t||8==t.biff,r=b7(n?112:54);for(r.write_shift(8==t.biff?2:1,7),n&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(n?0:536870912));r.l<r.length;)r.write_shift(1,n?0:32);return r}(0,n)),Pne(r,66,V9(s?1200:1252)),s&&Pne(r,353,V9(0)),s&&Pne(r,448),Pne(r,317,function(e){for(var t=b7(2*e),n=0;n<e;++n)t.write_shift(2,n+1);return t}(e.SheetNames.length)),s&&e.vbaraw&&Pne(r,211),s&&e.vbaraw)&&Pne(r,442,$9(o.CodeName||"ThisWorkbook"));Pne(r,156,V9(17)),Pne(r,25,W9(!1)),Pne(r,18,W9(!1)),Pne(r,19,V9(0)),s&&Pne(r,431,W9(!1)),s&&Pne(r,444,V9(0)),Pne(r,61,function(){var e=b7(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}()),Pne(r,64,W9(!1)),Pne(r,141,V9(0)),Pne(r,34,W9("true"==function(e){return e.Workbook&&e.Workbook.WBProps&&n8(e.Workbook.WBProps.date1904)?"true":"false"}(e))),Pne(r,14,W9(!0)),s&&Pne(r,439,W9(!1)),Pne(r,218,V9(0)),zne(r,0,n),function(e,t,n){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)null!=t[a]&&Pne(e,1054,iee(a,t[a],n))})}(r,e.SSF,n),function(e,t){for(var n=0;n<16;++n)Pne(e,224,oee({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Pne(e,224,oee(n,0,t))})}(r,n),s&&Pne(r,352,W9(!1));var c=r.end(),u=x7();s&&Pne(u,140,function(e){return e||(e=b7(4)),e.write_shift(2,1),e.write_shift(2,1),e}()),s&&n.Strings&&function(e,t,n,r){var a=r||(n||[]).length||0;if(a<=8224)return Pne(e,t,n,a);var i=t;if(!isNaN(i)){for(var o=n.parts||[],s=0,l=0,c=0;c+(o[s]||8224)<=8224;)c+=o[s]||8224,s++;var u=e.next(4);for(u.write_shift(2,i),u.write_shift(2,c),e.push(n.slice(l,l+c)),l+=c;l<a;){for((u=e.next(4)).write_shift(2,60),c=0;c+(o[s]||8224)<=8224;)c+=o[s]||8224,s++;u.write_shift(2,c),e.push(n.slice(l,l+c)),l+=c}}}(u,252,function(e){var t=b7(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var n=[],r=0;r<e.length;++r)n[r]=q9(e[r]);var a=C5([t].concat(n));return a.parts=[t.length].concat(n.map(function(e){return e.length})),a}(n.Strings)),Pne(u,10);var h=u.end(),d=x7(),f=0,p=0;for(p=0;p<e.SheetNames.length;++p)f+=(s?12:11)+(s?2:1)*e.SheetNames[p].length;var g=c.length+f+h.length;for(p=0;p<e.SheetNames.length;++p){Pne(d,133,aee({pos:g,hs:(i[p]||{}).Hidden||0,dt:0,name:e.SheetNames[p]},n)),g+=t[p].length}var m=d.end();if(f!=m.length)throw new Error("BS8 "+f+" != "+m.length);var v=[];return c.length&&v.push(c),m.length&&v.push(m),h.length&&v.push(h),C5(v)}function Gne(e,t){for(var n=0;n<=e.SheetNames.length;++n){var r=e.Sheets[e.SheetNames[n]];if(r&&r["!ref"])R7(r["!ref"]).e.c>255&&"undefined"!=typeof console&&console.error&&console.error("Worksheet '"+e.SheetNames[n]+"' extends beyond column IV (255).  Data may be lost.")}var a=t||{};switch(a.biff||2){case 8:case 5:return function(e,t){var n=t||{},r=[];e&&!e.SSF&&(e.SSF=z6(M5)),e&&e.SSF&&(b6(),v6(e.SSF),n.revssf=I6(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,wre(n),n.cellXfs=[],Xte(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)r[r.length]=Vne(a,n,e);return r.unshift(Hne(e,r,n)),C5(r)}(e,t);case 4:case 3:case 2:return Bne(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function qne(e,t,n,r){for(var a=e["!merges"]||[],i=[],o=t.s.c;o<=t.e.c;++o){for(var s=0,l=0,c=0;c<a.length;++c)if(!(a[c].s.r>n||a[c].s.c>o)&&!(a[c].e.r<n||a[c].e.c<o)){if(a[c].s.r<n||a[c].s.c<o){s=-1;break}s=a[c].e.r-a[c].s.r+1,l=a[c].e.c-a[c].s.c+1;break}if(!(s<0)){var u=A7({r:n,c:o}),h=r.dense?(e[n]||[])[o]:e[u],d=h&&null!=h.v&&(h.h||t8(h.w||(L7(h),h.w)||""))||"",f={};s>1&&(f.rowspan=s),l>1&&(f.colspan=l),r.editable?d='<span contenteditable="true">'+d+"</span>":h&&(f["data-t"]=h&&h.t||"z",null!=h.v&&(f["data-v"]=h.v),null!=h.z&&(f["data-z"]=h.z),h.l&&"#"!=(h.l.Target||"#").charAt(0)&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),f.id=(r.id||"sjs")+"-"+u,i.push(f8("td",d,f))}}return"<tr>"+i.join("")+"</tr>"}var Kne='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Xne="</body></html>";function Yne(e,t,n){return[].join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function $ne(e,t){var n=t||{},r=null!=n.header?n.header:Kne,a=null!=n.footer?n.footer:Xne,i=[r],o=R7(e["!ref"]);n.dense=Array.isArray(e),i.push(Yne(0,0,n));for(var s=o.s.r;s<=o.e.r;++s)i.push(qne(e,o,s,n));return i.push("</table>"+a),i.join("")}function Jne(e,t,n){var r=n||{};var a=0,i=0;if(null!=r.origin)if("number"==typeof r.origin)a=r.origin;else{var o="string"==typeof r.origin?T7(r.origin):r.origin;a=o.r,i=o.c}var s=t.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,s.length),c={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var u=R7(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),-1==a&&(c.e.r=a=u.e.r+1)}var h=[],d=0,f=e["!rows"]||(e["!rows"]=[]),p=0,g=0,m=0,v=0,b=0,x=0;for(e["!cols"]||(e["!cols"]=[]);p<s.length&&g<l;++p){var y=s[p];if(Zne(y)){if(r.display)continue;f[g]={hidden:!0}}var w=y.children;for(m=v=0;m<w.length;++m){var k=w[m];if(!r.display||!Zne(k)){var N=k.hasAttribute("data-v")?k.getAttribute("data-v"):k.hasAttribute("v")?k.getAttribute("v"):c8(k.innerHTML),S=k.getAttribute("data-z")||k.getAttribute("z");for(d=0;d<h.length;++d){var C=h[d];C.s.c==v+i&&C.s.r<g+a&&g+a<=C.e.r&&(v=C.e.c+1-i,d=-1)}x=+k.getAttribute("colspan")||1,((b=+k.getAttribute("rowspan")||1)>1||x>1)&&h.push({s:{r:g+a,c:v+i},e:{r:g+a+(b||1)-1,c:v+i+(x||1)-1}});var E={t:"s",v:N},_=k.getAttribute("data-t")||k.getAttribute("t")||"";null!=N&&(0==N.length?E.t=_||"z":r.raw||0==N.trim().length||"s"==_||("TRUE"===N?E={t:"b",v:!0}:"FALSE"===N?E={t:"b",v:!1}:isNaN(U6(N))?isNaN(H6(N).getDate())||(E={t:"d",v:j6(N)},r.cellDates||(E={t:"n",v:A6(E.v)}),E.z=r.dateNF||M5[14]):E={t:"n",v:U6(N)})),void 0===E.z&&null!=S&&(E.z=S);var I="",T=k.getElementsByTagName("A");if(T&&T.length)for(var A=0;A<T.length&&(!T[A].hasAttribute("href")||"#"==(I=T[A].getAttribute("href")).charAt(0));++A);I&&"#"!=I.charAt(0)&&(E.l={Target:I}),r.dense?(e[g+a]||(e[g+a]=[]),e[g+a][v+i]=E):e[A7({c:v+i,r:g+a})]=E,c.e.c<v+i&&(c.e.c=v+i),v+=x}}++g}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,g-1+a),e["!ref"]=D7(c),g>=l&&(e["!fullref"]=D7((c.e.r=s.length-p+g-1+a,c))),e}function Qne(e,t){return Jne((t||{}).dense?[]:{},e,t)}function Zne(e){var t="",n=function(e){return e.ownerDocument.defaultView&&"function"===typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"===typeof getComputedStyle?getComputedStyle:null}(e);return n&&(t=n(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}var ere=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+d8({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return K6+t}}(),tre=function(){var e=function(e){return Q6(e).replace(/  +/g,function(e){return'<text:s text:c="'+e.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t="          <table:table-cell />\n",n=function(n,r,a){var i=[];i.push('      <table:table table:name="'+Q6(r.SheetNames[a])+'" table:style-name="ta1">\n');var o=0,s=0,l=R7(n["!ref"]||"A1"),c=n["!merges"]||[],u=0,h=Array.isArray(n);if(n["!cols"])for(s=0;s<=l.e.c;++s)i.push("        <table:table-column"+(n["!cols"][s]?' table:style-name="co'+n["!cols"][s].ods+'"':"")+"></table:table-column>\n");var d="",f=n["!rows"]||[];for(o=0;o<l.s.r;++o)d=f[o]?' table:style-name="ro'+f[o].ods+'"':"",i.push("        <table:table-row"+d+"></table:table-row>\n");for(;o<=l.e.r;++o){for(d=f[o]?' table:style-name="ro'+f[o].ods+'"':"",i.push("        <table:table-row"+d+">\n"),s=0;s<l.s.c;++s)i.push(t);for(;s<=l.e.c;++s){var p=!1,g={},m="";for(u=0;u!=c.length;++u)if(!(c[u].s.c>s)&&!(c[u].s.r>o)&&!(c[u].e.c<s)&&!(c[u].e.r<o)){c[u].s.c==s&&c[u].s.r==o||(p=!0),g["table:number-columns-spanned"]=c[u].e.c-c[u].s.c+1,g["table:number-rows-spanned"]=c[u].e.r-c[u].s.r+1;break}if(p)i.push("          <table:covered-table-cell/>\n");else{var v=A7({r:o,c:s}),b=h?(n[o]||[])[s]:n[v];if(b&&b.f&&(g["table:formula"]=Q6(Ute(b.f)),b.F&&b.F.slice(0,v.length)==v)){var x=R7(b.F);g["table:number-matrix-columns-spanned"]=x.e.c-x.s.c+1,g["table:number-matrix-rows-spanned"]=x.e.r-x.s.r+1}if(b){switch(b.t){case"b":m=b.v?"TRUE":"FALSE",g["office:value-type"]="boolean",g["office:boolean-value"]=b.v?"true":"false";break;case"n":m=b.w||String(b.v||0),g["office:value-type"]="float",g["office:value"]=b.v||0;break;case"s":case"str":m=null==b.v?"":b.v,g["office:value-type"]="string";break;case"d":m=b.w||j6(b.v).toISOString(),g["office:value-type"]="date",g["office:date-value"]=j6(b.v).toISOString(),g["table:style-name"]="ce1";break;default:i.push(t);continue}var y=e(m);if(b.l&&b.l.Target){var w=b.l.Target;"#"==(w="#"==w.charAt(0)?"#"+Vte(w.slice(1)):w).charAt(0)||w.match(/^\w+:/)||(w="../"+w),y=f8("text:a",y,{"xlink:href":w.replace(/&/g,"&amp;")})}i.push("          "+f8("table:table-cell",f8("text:p",y,{}),g)+"\n")}else i.push(t)}}i.push("        </table:table-row>\n")}return i.push("      </table:table>\n"),i.join("")};return function(e,t){var r=[K6],a=d8({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),i=d8({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==t.bookType?(r.push("<office:document"+a+i+">\n"),r.push(E9().replace(/office:document-meta/g,"office:meta"))):r.push("<office:document-content"+a+">\n"),function(e,t){e.push(" <office:automatic-styles>\n"),e.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),e.push('   <number:month number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push('   <number:day number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push("   <number:year/>\n"),e.push("  </number:date-style>\n");var n=0;t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(t){if(t&&t["!cols"])for(var r=0;r<t["!cols"].length;++r)if(t["!cols"][r]){var a=t["!cols"][r];if(null==a.width&&null==a.wpx&&null==a.wch)continue;Tee(a),a.ods=n;var i=t["!cols"][r].wpx+"px";e.push('  <style:style style:name="co'+n+'" style:family="table-column">\n'),e.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+i+'"/>\n'),e.push("  </style:style>\n"),++n}});var r=0;t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(t){if(t&&t["!rows"])for(var n=0;n<t["!rows"].length;++n)if(t["!rows"][n]){t["!rows"][n].ods=r;var a=t["!rows"][n].hpx+"px";e.push('  <style:style style:name="ro'+r+'" style:family="table-row">\n'),e.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+a+'"/>\n'),e.push("  </style:style>\n"),++r}}),e.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),e.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),e.push("  </style:style>\n"),e.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),e.push(" </office:automatic-styles>\n")}(r,e),r.push("  <office:body>\n"),r.push("    <office:spreadsheet>\n");for(var o=0;o!=e.SheetNames.length;++o)r.push(n(e.Sheets[e.SheetNames[o]],e,o));return r.push("    </office:spreadsheet>\n"),r.push("  </office:body>\n"),"fods"==t.bookType?r.push("</office:document>"):r.push("</office:document-content>"),r.join("")}}();function nre(e,t){if("fods"==t.bookType)return tre(e,t);var n=q6(),r="",a=[],i=[];return G6(n,r="mimetype","application/vnd.oasis.opendocument.spreadsheet"),G6(n,r="content.xml",tre(e,t)),a.push([r,"text/xml"]),i.push([r,"ContentFile"]),G6(n,r="styles.xml",ere(e,t)),a.push([r,"text/xml"]),i.push([r,"StylesFile"]),G6(n,r="meta.xml",K6+E9()),a.push([r,"text/xml"]),i.push([r,"MetadataFile"]),G6(n,r="manifest.rdf",function(e){var t=[K6];t.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var n=0;n!=e.length;++n)t.push(S9(e[n][0],e[n][1])),t.push(C9("",e[n][0]));return t.push(S9("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}(i)),a.push([r,"application/rdf+xml"]),G6(n,r="META-INF/manifest.xml",function(e){var t=[K6];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var n=0;n<e.length;++n)t.push('  <manifest:file-entry manifest:full-path="'+e[n][0]+'" manifest:media-type="'+e[n][1]+'"/>\n');return t.push("</manifest:manifest>"),t.join("")}(a)),n}function rre(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function are(e){return"undefined"!=typeof TextEncoder?(new TextEncoder).encode(e):k5(l8(e))}function ire(e){var t=e.reduce(function(e,t){return e+t.length},0),n=new Uint8Array(t),r=0;return e.forEach(function(e){n.set(e,r),r+=e.length}),n}function ore(e,t){var n=t?t[0]:0,r=127&e[n];e:if(e[n++]>=128){if(r|=(127&e[n])<<7,e[n++]<128)break e;if(r|=(127&e[n])<<14,e[n++]<128)break e;if(r|=(127&e[n])<<21,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,28),++n,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,35),++n,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,42),++n,e[n++]<128)break e}return t&&(t[0]=n),r}function sre(e){var t=new Uint8Array(7);t[0]=127&e;var n=1;e:if(e>127){if(t[n-1]|=128,t[n]=e>>7&127,++n,e<=16383)break e;if(t[n-1]|=128,t[n]=e>>14&127,++n,e<=2097151)break e;if(t[n-1]|=128,t[n]=e>>21&127,++n,e<=268435455)break e;if(t[n-1]|=128,t[n]=e/256>>>21&127,++n,e<=34359738367)break e;if(t[n-1]|=128,t[n]=e/65536>>>21&127,++n,e<=4398046511103)break e;t[n-1]|=128,t[n]=e/16777216>>>21&127,++n}return t.slice(0,n)}function lre(e){var t=0,n=127&e[t];e:if(e[t++]>=128){if(n|=(127&e[t])<<7,e[t++]<128)break e;if(n|=(127&e[t])<<14,e[t++]<128)break e;if(n|=(127&e[t])<<21,e[t++]<128)break e;n|=(127&e[t])<<28}return n}function cre(e){for(var t=[],n=[0];n[0]<e.length;){var r,a=n[0],i=ore(e,n),o=7&i,s=0;if(0==(i=Math.floor(i/8)))break;switch(o){case 0:for(var l=n[0];e[n[0]++]>=128;);r=e.slice(l,n[0]);break;case 5:s=4,r=e.slice(n[0],n[0]+s),n[0]+=s;break;case 1:s=8,r=e.slice(n[0],n[0]+s),n[0]+=s;break;case 2:s=ore(e,n),r=e.slice(n[0],n[0]+s),n[0]+=s;break;default:throw new Error("PB Type ".concat(o," for Field ").concat(i," at offset ").concat(a))}var c={data:r,type:o};null==t[i]?t[i]=[c]:t[i].push(c)}return t}function ure(e){var t=[];return e.forEach(function(e,n){e.forEach(function(e){e.data&&(t.push(sre(8*n+e.type)),2==e.type&&t.push(sre(e.data.length)),t.push(e.data))})}),ire(t)}function hre(e){for(var t,n=[],r=[0];r[0]<e.length;){var a=ore(e,r),i=cre(e.slice(r[0],r[0]+a));r[0]+=a;var o={id:lre(i[1][0].data),messages:[]};i[2].forEach(function(t){var n=cre(t.data),a=lre(n[3][0].data);o.messages.push({meta:n,data:e.slice(r[0],r[0]+a)}),r[0]+=a}),(null==(t=i[3])?void 0:t[0])&&(o.merge=lre(i[3][0].data)>>>0>0),n.push(o)}return n}function dre(e){var t=[];return e.forEach(function(e){var n=[];n[1]=[{data:sre(e.id),type:0}],n[2]=[],null!=e.merge&&(n[3]=[{data:sre(+!!e.merge),type:0}]);var r=[];e.messages.forEach(function(e){r.push(e.data),e.meta[3]=[{type:0,data:sre(e.data.length)}],n[2].push({data:ure(e.meta),type:2})});var a=ure(n);t.push(sre(a.length)),t.push(a),r.forEach(function(e){return t.push(e)})}),ire(t)}function fre(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var n=[0],r=ore(t,n),a=[];n[0]<t.length;){var i=3&t[n[0]];if(0!=i){var o=0,s=0;if(1==i?(s=4+(t[n[0]]>>2&7),o=(224&t[n[0]++])<<3,o|=t[n[0]++]):(s=1+(t[n[0]++]>>2),2==i?(o=t[n[0]]|t[n[0]+1]<<8,n[0]+=2):(o=(t[n[0]]|t[n[0]+1]<<8|t[n[0]+2]<<16|t[n[0]+3]<<24)>>>0,n[0]+=4)),a=[ire(a)],0==o)throw new Error("Invalid offset 0");if(o>a[0].length)throw new Error("Invalid offset beyond length");if(s>=o)for(a.push(a[0].slice(-o)),s-=o;s>=a[a.length-1].length;)a.push(a[a.length-1]),s-=a[a.length-1].length;a.push(a[0].slice(-o,-o+s))}else{var l=t[n[0]++]>>2;if(l<60)++l;else{var c=l-59;l=t[n[0]],c>1&&(l|=t[n[0]+1]<<8),c>2&&(l|=t[n[0]+2]<<16),c>3&&(l|=t[n[0]+3]<<24),l>>>=0,l++,n[0]+=c}a.push(t.slice(n[0],n[0]+l)),n[0]+=l}}var u=ire(a);if(u.length!=r)throw new Error("Unexpected length: ".concat(u.length," != ").concat(r));return u}function pre(e){for(var t=[],n=0;n<e.length;){var r=e[n++],a=e[n]|e[n+1]<<8|e[n+2]<<16;n+=3,t.push(fre(r,e.slice(n,n+a))),n+=a}if(n!==e.length)throw new Error("data is not a valid framed stream!");return ire(t)}function gre(e){for(var t=[],n=0;n<e.length;){var r=Math.min(e.length-n,268435455),a=new Uint8Array(4);t.push(a);var i=sre(r),o=i.length;t.push(i),r<=60?(o++,t.push(new Uint8Array([r-1<<2]))):r<=256?(o+=2,t.push(new Uint8Array([240,r-1&255]))):r<=65536?(o+=3,t.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(o+=4,t.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(o+=5,t.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),t.push(e.slice(n,n+r)),o+=r,a[0]=0,a[1]=255&o,a[2]=o>>8&255,a[3]=o>>16&255,n+=r}return ire(t)}function mre(e,t){var n=new Uint8Array(32),r=rre(n),a=12,i=0;switch(n[0]=5,e.t){case"n":n[1]=2,function(e,t,n){var r=Math.floor(0==n?0:Math.LOG10E*Math.log(Math.abs(n)))+6176-20,a=n/Math.pow(10,r-6176);e[t+15]|=r>>7,e[t+14]|=(127&r)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=255&a;e[t+15]|=n>=0?0:128}(n,a,e.v),i|=1,a+=16;break;case"b":n[1]=6,r.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));n[1]=3,r.setUint32(a,t.indexOf(e.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(8,i,!0),n.slice(0,a)}function vre(e,t){var n=new Uint8Array(32),r=rre(n),a=12,i=0;switch(n[0]=3,e.t){case"n":n[2]=2,r.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":n[2]=6,r.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));n[2]=3,r.setUint32(a,t.indexOf(e.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(4,i,!0),n.slice(0,a)}function bre(e){return ore(cre(e)[1][0].data)}function xre(e,t,n){var r,a,i,o;if(!(null==(r=e[6])?void 0:r[0])||!(null==(a=e[7])?void 0:a[0]))throw"Mutation only works on post-BNC storages!";if((null==(o=null==(i=e[8])?void 0:i[0])?void 0:o.data)&&lre(e[8][0].data)>0||!1)throw"Math only works with normal offsets";for(var s=0,l=rre(e[7][0].data),c=0,u=[],h=rre(e[4][0].data),d=0,f=[],p=0;p<t.length;++p)if(null!=t[p]){var g,m;switch(l.setUint16(2*p,c,!0),h.setUint16(2*p,d,!0),typeof t[p]){case"string":g=mre({t:"s",v:t[p]},n),m=vre({t:"s",v:t[p]},n);break;case"number":g=mre({t:"n",v:t[p]},n),m=vre({t:"n",v:t[p]},n);break;case"boolean":g=mre({t:"b",v:t[p]},n),m=vre({t:"b",v:t[p]},n);break;default:throw new Error("Unsupported value "+t[p])}u.push(g),c+=g.length,f.push(m),d+=m.length,++s}else l.setUint16(2*p,65535,!0),h.setUint16(2*p,65535);for(e[2][0].data=sre(s);p<e[7][0].data.length/2;++p)l.setUint16(2*p,65535,!0),h.setUint16(2*p,65535,!0);return e[6][0].data=ire(u),e[3][0].data=ire(f),s}function yre(e){return function(t){for(var n=0;n!=e.length;++n){var r=e[n];void 0===t[r[0]]&&(t[r[0]]=r[1]),"n"===r[2]&&(t[r[0]]=Number(t[r[0]]))}}}function wre(e){yre([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function kre(e,t){return"ods"==t.bookType?nre(e,t):"numbers"==t.bookType?function(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var n=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=R7(n["!ref"]);r.s.r=r.s.c=0;var a=!1;r.e.c>9&&(a=!0,r.e.c=9),r.e.r>49&&(a=!0,r.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(D7(r)));var i=Dre(n,{range:r,header:1}),o=["~Sh33tJ5~"];i.forEach(function(e){return e.forEach(function(e){"string"==typeof e&&o.push(e)})});var s={},l=[],c=w6.read(t.numbers,{type:"base64"});c.FileIndex.map(function(e,t){return[e,c.FullPaths[t]]}).forEach(function(e){var t=e[0],n=e[1];2==t.type&&t.name.match(/\.iwa/)&&hre(pre(t.content)).forEach(function(e){l.push(e.id),s[e.id]={deps:[],location:n,type:lre(e.messages[0].meta[1][0].data)}})}),l.sort(function(e,t){return e-t});var u=l.filter(function(e){return e>1}).map(function(e){return[e,sre(e)]});c.FileIndex.map(function(e,t){return[e,c.FullPaths[t]]}).forEach(function(e){var t=e[0];e[1],t.name.match(/\.iwa/)&&hre(pre(t.content)).forEach(function(e){e.messages.forEach(function(t){u.forEach(function(t){e.messages.some(function(e){return 11006!=lre(e.meta[1][0].data)&&function(e,t){e:for(var n=0;n<=e.length-t.length;++n){for(var r=0;r<t.length;++r)if(e[n+r]!=t[r])continue e;return!0}return!1}(e.data,t[1])})&&s[t[0]].deps.push(e.id)})})})});for(var h,d=w6.find(c,s[1].location),f=hre(pre(d.content)),p=0;p<f.length;++p){var g=f[p];1==g.id&&(h=g)}var m=bre(cre(h.messages[0].data)[1][0].data);for(f=hre(pre((d=w6.find(c,s[m].location)).content)),p=0;p<f.length;++p)(g=f[p]).id==m&&(h=g);for(m=bre(cre(h.messages[0].data)[2][0].data),f=hre(pre((d=w6.find(c,s[m].location)).content)),p=0;p<f.length;++p)(g=f[p]).id==m&&(h=g);for(m=bre(cre(h.messages[0].data)[2][0].data),f=hre(pre((d=w6.find(c,s[m].location)).content)),p=0;p<f.length;++p)(g=f[p]).id==m&&(h=g);var v=cre(h.messages[0].data);v[6][0].data=sre(r.e.r+1),v[7][0].data=sre(r.e.c+1);for(var b=bre(v[46][0].data),x=w6.find(c,s[b].location),y=hre(pre(x.content)),w=0;w<y.length&&y[w].id!=b;++w);if(y[w].id!=b)throw"Bad ColumnRowUIDMapArchive";var k=cre(y[w].messages[0].data);k[1]=[],k[2]=[],k[3]=[];for(var N=0;N<=r.e.c;++N){var S=[];S[1]=S[2]=[{type:0,data:sre(N+420690)}],k[1].push({type:2,data:ure(S)}),k[2].push({type:0,data:sre(N)}),k[3].push({type:0,data:sre(N)})}k[4]=[],k[5]=[],k[6]=[];for(var C=0;C<=r.e.r;++C)(S=[])[1]=S[2]=[{type:0,data:sre(C+726270)}],k[4].push({type:2,data:ure(S)}),k[5].push({type:0,data:sre(C)}),k[6].push({type:0,data:sre(C)});y[w].messages[0].data=ure(k),x.content=gre(dre(y)),x.size=x.content.length,delete v[46];var E=cre(v[4][0].data);E[7][0].data=sre(r.e.r+1);var _=bre(cre(E[1][0].data)[2][0].data);if((y=hre(pre((x=w6.find(c,s[_].location)).content)))[0].id!=_)throw"Bad HeaderStorageBucket";var I=cre(y[0].messages[0].data);for(C=0;C<i.length;++C){var T=cre(I[2][0].data);T[1][0].data=sre(C),T[4][0].data=sre(i[C].length),I[2][C]={type:I[2][0].type,data:ure(T)}}y[0].messages[0].data=ure(I),x.content=gre(dre(y)),x.size=x.content.length;var A=bre(E[2][0].data);if((y=hre(pre((x=w6.find(c,s[A].location)).content)))[0].id!=A)throw"Bad HeaderStorageBucket";for(I=cre(y[0].messages[0].data),N=0;N<=r.e.c;++N)(T=cre(I[2][0].data))[1][0].data=sre(N),T[4][0].data=sre(r.e.r+1),I[2][N]={type:I[2][0].type,data:ure(T)};y[0].messages[0].data=ure(I),x.content=gre(dre(y)),x.size=x.content.length;var R=bre(E[4][0].data);!function(){for(var e,t=w6.find(c,s[R].location),n=hre(pre(t.content)),r=0;r<n.length;++r){var a=n[r];a.id==R&&(e=a)}var i=cre(e.messages[0].data);i[3]=[];var l=[];o.forEach(function(e,t){l[1]=[{type:0,data:sre(t)}],l[2]=[{type:0,data:sre(1)}],l[3]=[{type:2,data:are(e)}],i[3].push({type:2,data:ure(l)})}),e.messages[0].data=ure(i);var u=gre(dre(n));t.content=u,t.size=t.content.length}();var D=cre(E[3][0].data),F=D[1][0];delete D[2];var O=cre(F.data),L=bre(O[2][0].data);!function(){for(var e,t=w6.find(c,s[L].location),n=hre(pre(t.content)),a=0;a<n.length;++a){var l=n[a];l.id==L&&(e=l)}var u=cre(e.messages[0].data);delete u[6],delete D[7];var h=new Uint8Array(u[5][0].data);u[5]=[];for(var d=0,f=0;f<=r.e.r;++f){var p=cre(h);d+=xre(p,i[f],o),p[1][0].data=sre(f),u[5].push({data:ure(p),type:2})}u[1]=[{type:0,data:sre(r.e.c+1)}],u[2]=[{type:0,data:sre(r.e.r+1)}],u[3]=[{type:0,data:sre(d)}],u[4]=[{type:0,data:sre(r.e.r+1)}],e.messages[0].data=ure(u);var g=gre(dre(n));t.content=g,t.size=t.content.length}(),F.data=ure(O),E[3][0].data=ure(D),v[4][0].data=ure(E),h.messages[0].data=ure(v);var P=gre(dre(f));return d.content=P,d.size=d.content.length,c}(e,t):"xlsb"==t.bookType?function(e,t){$ee=1024,e&&!e.SSF&&(e.SSF=z6(M5));e&&e.SSF&&(b6(),v6(e.SSF),t.revssf=I6(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF);t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Hte?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xlsb"==t.bookType?"bin":"xml",r=nte.indexOf(t.bookType)>-1,a={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};wre(t=t||{});var i=q6(),o="",s=0;t.cellXfs=[],Xte(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});if(o="docProps/core.xml",G6(i,o,T9(e.Props,t)),a.coreprops.push(o),N9(t.rels,2,o,y9.CORE_PROPS),o="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,G6(i,o,D9(e.Props)),a.extprops.push(o),N9(t.rels,3,o,y9.EXT_PROPS),e.Custprops!==e.Props&&C6(e.Custprops||{}).length>0&&(G6(i,o="docProps/custom.xml",F9(e.Custprops)),a.custprops.push(o),N9(t.rels,4,o,y9.CUST_PROPS));for(s=1;s<=e.SheetNames.length;++s){var u={"!id":{}},h=e.Sheets[e.SheetNames[s-1]];(h||{})["!type"];if(G6(i,o="xl/worksheets/sheet"+s+"."+n,Nne(s-1,o,t,e,u)),a.sheets.push(o),N9(t.wbrels,-1,"worksheets/sheet"+s+"."+n,y9.WS[0]),h){var d=h["!comments"],f=!1,p="";d&&d.length>0&&(G6(i,p="xl/comments"+s+"."+n,Sne(d,p,t)),a.comments.push(p),N9(u,-1,"../comments"+s+"."+n,y9.CMNT),f=!0),h["!legacy"]&&f&&G6(i,"xl/drawings/vmlDrawing"+s+".vml",Jee(s,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&G6(i,w9(o),k9(u))}null!=t.Strings&&t.Strings.length>0&&(G6(i,o="xl/sharedStrings."+n,function(e,t,n){return(".bin"===t.slice(-4)?yee:bee)(e,n)}(t.Strings,o,t)),a.strs.push(o),N9(t.wbrels,-1,"sharedStrings."+n,y9.SST));o="xl/workbook."+n,G6(i,o,function(e,t,n){return(".bin"===t.slice(-4)?kne:xne)(e,n)}(e,o,t)),a.workbooks.push(o),N9(t.rels,1,o,y9.WB),o="xl/theme/theme1.xml",G6(i,o,Kee(e.Themes,t)),a.themes.push(o),N9(t.wbrels,-1,"theme/theme1.xml",y9.THEME),o="xl/styles."+n,G6(i,o,function(e,t,n){return(".bin"===t.slice(-4)?qee:Fee)(e,n)}(e,o,t)),a.styles.push(o),N9(t.wbrels,-1,"styles."+n,y9.STY),e.vbaraw&&r&&(G6(i,o="xl/vbaProject.bin",e.vbaraw),a.vba.push(o),N9(t.wbrels,-1,"vbaProject.bin",y9.VBA));return o="xl/metadata."+n,G6(i,o,function(e){return(".bin"===e.slice(-4)?Xee:Yee)()}(o)),a.metadata.push(o),N9(t.wbrels,-1,"metadata."+n,y9.XLMETA),G6(i,"[Content_Types].xml",x9(a,t)),G6(i,"_rels/.rels",k9(t.rels)),G6(i,"xl/_rels/workbook."+n+".rels",k9(t.wbrels)),delete t.revssf,delete t.ssf,i}(e,t):Nre(e,t)}function Nre(e,t){$ee=1024,e&&!e.SSF&&(e.SSF=z6(M5)),e&&e.SSF&&(b6(),v6(e.SSF),t.revssf=I6(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Hte?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xml",r=nte.indexOf(t.bookType)>-1,a={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};wre(t=t||{});var i=q6(),o="",s=0;if(t.cellXfs=[],Xte(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),G6(i,o="docProps/core.xml",T9(e.Props,t)),a.coreprops.push(o),N9(t.rels,2,o,y9.CORE_PROPS),o="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,G6(i,o,D9(e.Props)),a.extprops.push(o),N9(t.rels,3,o,y9.EXT_PROPS),e.Custprops!==e.Props&&C6(e.Custprops||{}).length>0&&(G6(i,o="docProps/custom.xml",F9(e.Custprops)),a.custprops.push(o),N9(t.rels,4,o,y9.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,s=1;s<=e.SheetNames.length;++s){var h={"!id":{}},d=e.Sheets[e.SheetNames[s-1]];(d||{})["!type"];if(G6(i,o="xl/worksheets/sheet"+s+"."+n,Zte(s-1,t,e,h)),a.sheets.push(o),N9(t.wbrels,-1,"worksheets/sheet"+s+"."+n,y9.WS[0]),d){var f=d["!comments"],p=!1,g="";if(f&&f.length>0){var m=!1;f.forEach(function(e){e[1].forEach(function(e){1==e.T&&(m=!0)})}),m&&(G6(i,g="xl/threadedComments/threadedComment"+s+"."+n,Zee(f,u,t)),a.threadedcomments.push(g),N9(h,-1,"../threadedComments/threadedComment"+s+"."+n,y9.TCMNT)),G6(i,g="xl/comments"+s+"."+n,Qee(f)),a.comments.push(g),N9(h,-1,"../comments"+s+"."+n,y9.CMNT),p=!0}d["!legacy"]&&p&&G6(i,"xl/drawings/vmlDrawing"+s+".vml",Jee(s,d["!comments"])),delete d["!comments"],delete d["!legacy"]}h["!id"].rId1&&G6(i,w9(o),k9(h))}return null!=t.Strings&&t.Strings.length>0&&(G6(i,o="xl/sharedStrings."+n,bee(t.Strings,t)),a.strs.push(o),N9(t.wbrels,-1,"sharedStrings."+n,y9.SST)),G6(i,o="xl/workbook."+n,xne(e)),a.workbooks.push(o),N9(t.rels,1,o,y9.WB),G6(i,o="xl/theme/theme1.xml",Kee(e.Themes,t)),a.themes.push(o),N9(t.wbrels,-1,"theme/theme1.xml",y9.THEME),G6(i,o="xl/styles."+n,Fee(e,t)),a.styles.push(o),N9(t.wbrels,-1,"styles."+n,y9.STY),e.vbaraw&&r&&(G6(i,o="xl/vbaProject.bin",e.vbaraw),a.vba.push(o),N9(t.wbrels,-1,"vbaProject.bin",y9.VBA)),G6(i,o="xl/metadata."+n,Yee()),a.metadata.push(o),N9(t.wbrels,-1,"metadata."+n,y9.XLMETA),u.length>1&&(G6(i,o="xl/persons/person.xml",function(e){var t=[K6,f8("personList",null,{xmlns:y8,"xmlns:x":I8[0]}).replace(/[\/]>/,">")];return e.forEach(function(e,n){t.push(f8("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:e,providerId:"None"}))}),t.push("</personList>"),t.join("")}(u)),a.people.push(o),N9(t.wbrels,-1,"persons/person.xml",y9.PEOPLE)),G6(i,"[Content_Types].xml",x9(a,t)),G6(i,"_rels/.rels",k9(t.rels)),G6(i,"xl/_rels/workbook.xml.rels",k9(t.wbrels)),delete t.revssf,delete t.ssf,i}function Sre(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=v5(e.slice(0,12));break;case"binary":n=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function Cre(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return S6(t.file,w6.write(e,{type:b5?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return w6.write(e,t)}function Ere(e,t){var n={},r=b5?"nodebuffer":"undefined"!==typeof Uint8Array?"array":"string";if(t.compression&&(n.compression="DEFLATE"),t.password)n.type=r;else switch(t.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":n.type=r;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?w6.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type,compression:!!t.compression}):e.generate(n);if("undefined"!==typeof Deno&&"string"==typeof a){if("binary"==t.type||"base64"==t.type)return a;a=new Uint8Array(N5(a))}return t.password&&"undefined"!==typeof encrypt_agile?Cre(encrypt_agile(a,t.password),t):"file"===t.type?S6(t.file,a):"string"==t.type?s8(a):a}function _re(e,t,n){n||(n="");var r=n+e;switch(t.type){case"base64":return m5(l8(r));case"binary":return l8(r);case"string":return e;case"file":return S6(t.file,r,"utf8");case"buffer":return b5?x5(r,"utf8"):"undefined"!==typeof TextEncoder?(new TextEncoder).encode(r):_re(r,{type:"binary"}).split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Ire(e,t){switch(t.type){case"string":case"base64":case"binary":for(var n="",r=0;r<e.length;++r)n+=String.fromCharCode(e[r]);return"base64"==t.type?m5(n):"string"==t.type?s8(n):n;case"file":return S6(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Tre(e,t){u5(),bne(e);var n=z6(t||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),"array"==n.type){n.type="binary";var r=Tre(e,n);return n.type="array",N5(r)}var a=0;if(n.sheet&&(a="number"==typeof n.sheet?n.sheet:e.SheetNames.indexOf(n.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+n.sheet+" : "+typeof n.sheet);switch(n.bookType||"xlsb"){case"xml":case"xlml":return _re(Ane(e,n),n);case"slk":case"sylk":return _re(dee.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"htm":case"html":return _re($ne(e.Sheets[e.SheetNames[a]],n),n);case"txt":return function(e,t){switch(t.type){case"base64":return m5(e);case"binary":case"string":return e;case"file":return S6(t.file,e,"binary");case"buffer":return b5?x5(e,"binary"):e.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}(Pre(e.Sheets[e.SheetNames[a]],n),n);case"csv":return _re(Lre(e.Sheets[e.SheetNames[a]],n),n,"\ufeff");case"dif":return _re(fee.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"dbf":return Ire(hee.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"prn":return _re(gee.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"rtf":return _re(Nee.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"eth":return _re(pee.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"fods":return _re(nre(e,n),n);case"wk1":return Ire(mee.sheet_to_wk1(e.Sheets[e.SheetNames[a]],n),n);case"wk3":return Ire(mee.book_to_wk3(e,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),Ire(Gne(e,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),function(e,t){var n=t||{};return Cre(One(e,n),n)}(e,n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return function(e,t){var n=z6(t||{});return Ere(kre(e,n),n)}(e,n);default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function Are(e){if(!e.bookType){var t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[e.bookType]||e.bookType}}function Rre(e,t,n,r,a,i,o,s){var l=E7(n),c=s.defval,u=s.raw||!Object.prototype.hasOwnProperty.call(s,"raw"),h=!0,d=1===a?[]:{};if(1!==a)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:n,enumerable:!1})}catch(ci){d.__rowNum__=n}else d.__rowNum__=n;if(!o||e[n])for(var f=t.s.c;f<=t.e.c;++f){var p=o?e[n][f]:e[r[f]+l];if(void 0!==p&&void 0!==p.t){var g=p.v;switch(p.t){case"z":if(null==g)break;continue;case"e":g=0==g?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(null!=i[f]){if(null==g)if("e"==p.t&&null===g)d[i[f]]=null;else if(void 0!==c)d[i[f]]=c;else{if(!u||null!==g)continue;d[i[f]]=null}else d[i[f]]=u&&("n"!==p.t||"n"===p.t&&!1!==s.rawNumbers)?g:L7(p,g,s);null!=g&&(h=!1)}}else{if(void 0===c)continue;null!=i[f]&&(d[i[f]]=c)}}return{row:d,isempty:h}}function Dre(e,t){if(null==e||null==e["!ref"])return[];var n={t:"n",v:0},r=0,a=1,i=[],o=0,s="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=null!=c.range?c.range:e["!ref"];switch(1===c.header?r=1:"A"===c.header?r=2:Array.isArray(c.header)?r=3:null==c.header&&(r=0),typeof u){case"string":l=F7(u);break;case"number":(l=F7(e["!ref"])).s.r=u;break;default:l=u}r>0&&(a=0);var h=E7(l.s.r),d=[],f=[],p=0,g=0,m=Array.isArray(e),v=l.s.r,b=0,x={};m&&!e[v]&&(e[v]=[]);var y=c.skipHidden&&e["!cols"]||[],w=c.skipHidden&&e["!rows"]||[];for(b=l.s.c;b<=l.e.c;++b)if(!(y[b]||{}).hidden)switch(d[b]=I7(b),n=m?e[v][b]:e[d[b]+h],r){case 1:i[b]=b-l.s.c;break;case 2:i[b]=d[b];break;case 3:i[b]=c.header[b-l.s.c];break;default:if(null==n&&(n={w:"__EMPTY",t:"s"}),s=o=L7(n,null,c),g=x[o]||0){do{s=o+"_"+g++}while(x[s]);x[o]=g,x[s]=1}else x[o]=1;i[b]=s}for(v=l.s.r+a;v<=l.e.r;++v)if(!(w[v]||{}).hidden){var k=Rre(e,l,v,d,r,i,m,c);(!1===k.isempty||(1===r?!1!==c.blankrows:c.blankrows))&&(f[p++]=k.row)}return f.length=p,f}var Fre=/"/g;function Ore(e,t,n,r,a,i,o,s){for(var l=!0,c=[],u="",h=E7(n),d=t.s.c;d<=t.e.c;++d)if(r[d]){var f=s.dense?(e[n]||[])[d]:e[r[d]+h];if(null==f)u="";else if(null!=f.v){l=!1,u=""+(s.rawNumbers&&"n"==f.t?f.v:L7(f,null,s));for(var p=0,g=0;p!==u.length;++p)if((g=u.charCodeAt(p))===a||g===i||34===g||s.forceQuotes){u='"'+u.replace(Fre,'""')+'"';break}"ID"==u&&(u='"ID"')}else null==f.f||f.F?u="":(l=!1,(u="="+f.f).indexOf(",")>=0&&(u='"'+u.replace(Fre,'""')+'"'));c.push(u)}return!1===s.blankrows&&l?null:c.join(o)}function Lre(e,t){var n=[],r=null==t?{}:t;if(null==e||null==e["!ref"])return"";var a=F7(e["!ref"]),i=void 0!==r.FS?r.FS:",",o=i.charCodeAt(0),s=void 0!==r.RS?r.RS:"\n",l=s.charCodeAt(0),c=new RegExp(("|"==i?"\\|":i)+"+$"),u="",h=[];r.dense=Array.isArray(e);for(var d=r.skipHidden&&e["!cols"]||[],f=r.skipHidden&&e["!rows"]||[],p=a.s.c;p<=a.e.c;++p)(d[p]||{}).hidden||(h[p]=I7(p));for(var g=0,m=a.s.r;m<=a.e.r;++m)(f[m]||{}).hidden||null!=(u=Ore(e,a,m,h,o,l,i,r))&&(r.strip&&(u=u.replace(c,"")),(u||!1!==r.blankrows)&&n.push((g++?s:"")+u));return delete r.dense,n.join("")}function Pre(e,t){t||(t={}),t.FS="\t",t.RS="\n";var n=Lre(e,t);if("undefined"==typeof d5||"string"==t.type)return n;var r=d5.utils.encode(1200,n,"str");return String.fromCharCode(255)+String.fromCharCode(254)+r}function Mre(e,t,n){var r,a=n||{},i=+!a.skipHeader,o=e||{},s=0,l=0;if(o&&null!=a.origin)if("number"==typeof a.origin)s=a.origin;else{var c="string"==typeof a.origin?T7(a.origin):a.origin;s=c.r,l=c.c}var u={s:{c:0,r:0},e:{c:l,r:s+t.length-1+i}};if(o["!ref"]){var h=F7(o["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),-1==s&&(s=h.e.r+1,u.e.r=s+t.length-1+i)}else-1==s&&(s=0,u.e.r=t.length-1+i);var d=a.header||[],f=0;t.forEach(function(e,t){C6(e).forEach(function(n){-1==(f=d.indexOf(n))&&(d[f=d.length]=n);var c=e[n],u="z",h="",p=A7({c:l+f,r:s+t+i});r=jre(o,p),!c||"object"!==typeof c||c instanceof Date?("number"==typeof c?u="n":"boolean"==typeof c?u="b":"string"==typeof c?u="s":c instanceof Date?(u="d",a.cellDates||(u="n",c=A6(c)),h=a.dateNF||M5[14]):null===c&&a.nullError&&(u="e",c=0),r?(r.t=u,r.v=c,delete r.w,delete r.R,h&&(r.z=h)):o[p]=r={t:u,v:c},h&&(r.z=h)):o[p]=c})}),u.e.c=Math.max(u.e.c,l+d.length-1);var p=E7(s);if(i)for(f=0;f<d.length;++f)o[I7(f+l)+p]={t:"s",v:d[f]};return o["!ref"]=D7(u),o}function jre(e,t,n){if("string"==typeof t){if(Array.isArray(e)){var r=T7(t);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return jre(e,A7("number"!=typeof t?t:{r:t,c:n||0}))}function Bre(){return{SheetNames:[],Sheets:{}}}function zre(e,t,n,r){var a=1;if(!n)for(;a<=65535&&-1!=e.SheetNames.indexOf(n="Sheet"+a);++a,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(n)>=0){var i=n.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var o=i&&i[1]||n;for(++a;a<=65535&&-1!=e.SheetNames.indexOf(n=o+a);++a);}if(vne(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=t,n}function Wre(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e}var Ure={encode_col:I7,encode_row:E7,encode_cell:A7,encode_range:D7,decode_col:_7,decode_row:C7,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:T7,decode_range:R7,format_cell:L7,sheet_add_aoa:M7,sheet_add_json:Mre,sheet_add_dom:Jne,aoa_to_sheet:j7,json_to_sheet:function(e,t){return Mre(null,e,t)},table_to_sheet:Qne,table_to_book:function(e,t){return P7(Qne(e,t),t)},sheet_to_csv:Lre,sheet_to_txt:Pre,sheet_to_json:Dre,sheet_to_html:$ne,sheet_to_formulae:function(e){var t,n="",r="";if(null==e||null==e["!ref"])return[];var a,i=F7(e["!ref"]),o="",s=[],l=[],c=Array.isArray(e);for(a=i.s.c;a<=i.e.c;++a)s[a]=I7(a);for(var u=i.s.r;u<=i.e.r;++u)for(o=E7(u),a=i.s.c;a<=i.e.c;++a)if(n=s[a]+o,r="",void 0!==(t=c?(e[u]||[])[a]:e[n])){if(null!=t.F){if(n=t.F,!t.f)continue;r=t.f,-1==n.indexOf(":")&&(n=n+":"+n)}if(null!=t.f)r=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)r=""+t.v;else if("b"==t.t)r=t.v?"TRUE":"FALSE";else if(void 0!==t.w)r="'"+t.w;else{if(void 0===t.v)continue;r="s"==t.t?"'"+t.v:""+t.v}}l[l.length]=n+"="+r}return l},sheet_to_row_object_array:Dre,sheet_get_cell:jre,book_new:Bre,book_append_sheet:zre,book_set_sheet_visibility:function(e,t,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var n=e.SheetNames.indexOf(t);if(n>-1)return n;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[r].Hidden=n},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:Wre,cell_set_internal_link:function(e,t,n){return Wre(e,"#"+t,n)},cell_add_comment:function(e,t,n){e.c||(e.c=[]),e.c.push({t:t,a:n||"SheetJS"})},sheet_set_array_formula:function(e,t,n,r){for(var a="string"!=typeof t?t:F7(t),i="string"==typeof t?t:D7(t),o=a.s.r;o<=a.e.r;++o)for(var s=a.s.c;s<=a.e.c;++s){var l=jre(e,o,s);l.t="n",l.F=i,delete l.v,o==a.s.r&&s==a.s.c&&(l.f=n,r&&(l.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};r5.version;var Vre=n(7762),Hre=n(557),Gre=n.n(Hre);const qre=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Sheet1";const r=Ure.book_new(),a=Ure.json_to_sheet(e);Ure.book_append_sheet(r,a,n),function(e,t,n){var r=n||{};r.type="file",r.file=t,Are(r),Tre(e,r)}(r,"".concat(t,".xlsx"))},Kre=e=>e.map(e=>{const t=e.checkIns.filter(e=>!e.late).map(e=>new Date(e.time).toLocaleTimeString()).join(", "),n=[...e.checkIns.filter(e=>e.late),...e.checkOuts].map(e=>new Date(e.time).toLocaleTimeString()).join(", "),r=new Date(e.date);return{date:"".concat(String(r.getDate()).padStart(2,"0"),"/").concat(String(r.getMonth()+1).padStart(2,"0"),"/").concat(r.getFullYear().toString().slice(-2)),checkIns:t||"-",checkOuts:n||"-",duration:e.duration||"00:00:00"}}),Xre=()=>{var e;const[t,n]=(0,l.useState)(null),[r,a]=(0,l.useState)([]),[i,o]=(0,l.useState)(!0),[s,c]=(0,l.useState)(""),[u,h]=(0,l.useState)(""),[d,f]=(0,l.useState)(null),[p,g]=(0,l.useState)(!1),[m,v]=(0,l.useState)([]),b=(0,l.useRef)(null),[x,y]=(0,l.useState)(!1),[w,k]=(0,l.useState)(null),[N,S]=(0,l.useState)(null),[C,E]=(0,l.useState)(!1),[_,I]=(0,l.useState)(null),[T,A]=(0,l.useState)([]),[R,D]=(0,l.useState)(!1),[F,O]=(0,l.useState)({startDate:"",endDate:""});(0,l.useEffect)(()=>{(async()=>{try{_k().flagRegistry.GPGPU&&_k().set("WEBGL_FORCE_F16_TEXTURES",!0),await Promise.all([dw.ssdMobilenetv1.loadFromUri("/models"),dw.faceLandmark68Net.loadFromUri("/models"),dw.faceRecognitionNet.loadFromUri("/models")]),y(!0)}catch(e){console.error("Error loading face-api models:",e)}})(),L(),P()},[]);const L=async()=>{try{o(!0);const{data:e}=await ja.get("/attendance/all");a(e)}catch(gfe){c("Failed to fetch attendance records.")}finally{o(!1)}},P=async()=>{try{const{data:e}=await ja.get("/fighters/rfids");v(e)}catch(gfe){console.error("Failed to fetch RFIDs for autosuggest.",gfe)}},M=e=>{h(""),f(null),S(null),n(e),"face"===e&&B()},j=()=>{z(),n(null)},B=()=>{if(w)return;const e=setInterval(async()=>{if(b.current&&x){const r=b.current.getScreenshot();if(!r)return;const a=await Sx(r),i=await Fw(a,new Ry({minConfidence:.75})).withFaceLandmarks().withFaceDescriptor();if(i){z(),g(!0);try{const e=Array.from(i.descriptor),{data:t}=await ja.post("/attendance/admin/face-recognition",{faceDescriptor:e});f({type:"success",message:t.msg,fighter:t.fighter}),L()}catch(gfe){var e,t,n;const a=(null===(e=gfe.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.msg)||"Recognition failed.";if(f({type:"error",message:a}),400===(null===(n=gfe.response)||void 0===n?void 0:n.status))return void g(!1)}finally{g(!1),setTimeout(()=>j(),3e3)}}}},1e3);k(e)},z=()=>{w&&(clearInterval(w),k(null))},W=async e=>{D(!0);try{let t="/attendance/fighter/".concat(e);const n=new URLSearchParams;F.startDate&&F.endDate&&(n.append("startDate",F.startDate),n.append("endDate",F.endDate)),n.toString()&&(t+="?".concat(n.toString()));const{data:r}=await ja.get(t);A(r)}catch(gfe){console.error("Failed to fetch fighter attendance:",gfe)}finally{D(!1)}};(0,l.useEffect)(()=>{C&&_&&(F.startDate&&F.endDate||!F.startDate&&!F.endDate)&&W(_.id)},[F,C,_]);return(0,Ba.jsxs)("div",{className:"p-4 md:p-8 bg-gray-50 min-h-screen",children:[(0,Ba.jsx)("h2",{className:"text-3xl font-bold text-gray-800 mb-6",children:"Attendance Management"}),(0,Ba.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[(0,Ba.jsxs)("div",{className:"p-6",children:[(0,Ba.jsx)("h3",{className:"text-xl font-semibold text-gray-700 mb-4",children:"Recent Attendance Records"}),(0,Ba.jsxs)("div",{className:"hidden md:flex justify-between items-center",children:[(0,Ba.jsx)("div",{})," ",(0,Ba.jsxs)("div",{className:"flex gap-4",children:[(0,Ba.jsxs)("button",{onClick:()=>M("rfid"),className:"flex items-center gap-2 bg-blue-500 text-white px-4 py-2 rounded-lg font-semibold hover:bg-blue-600 transition duration-300",children:[(0,Ba.jsx)(ln,{})," RFID"]}),(0,Ba.jsxs)("button",{onClick:()=>M("face"),className:"flex items-center gap-2 bg-teal-500 text-white px-4 py-2 rounded-lg font-semibold hover:bg-teal-600 transition duration-300",disabled:!x,children:[(0,Ba.jsx)(ft,{})," ",x?"Face ID":"Loading..."]})]})]}),(0,Ba.jsxs)("div",{className:"md:hidden flex flex-col gap-3 mb-4",children:[(0,Ba.jsxs)("button",{onClick:()=>M("rfid"),className:"flex items-center justify-center gap-2 bg-blue-500 text-white px-4 py-2 rounded-lg font-semibold hover:bg-blue-600 transition duration-300",children:[(0,Ba.jsx)(ln,{})," RFID"]}),(0,Ba.jsxs)("button",{onClick:()=>M("face"),className:"flex items-center justify-center gap-2 bg-teal-500 text-white px-4 py-2 rounded-lg font-semibold hover:bg-teal-600 transition duration-300",disabled:!x,children:[(0,Ba.jsx)(ft,{})," ",x?"Face ID":"Loading..."]})]})]}),(0,Ba.jsx)("div",{className:"overflow-x-auto",children:i?(0,Ba.jsx)("div",{className:"text-center p-8 text-gray-500",children:"Loading records..."}):s?(0,Ba.jsx)("div",{className:"text-center p-8 text-red-500",children:s}):(0,Ba.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,Ba.jsx)("thead",{className:"bg-gray-50",children:(0,Ba.jsxs)("tr",{children:[(0,Ba.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fighter Name"}),(0,Ba.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"RFID"}),(0,Ba.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,Ba.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Check In"}),(0,Ba.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Check Out"}),(0,Ba.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Duration"})]})}),(0,Ba.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:r.length>0?r.map(e=>(0,Ba.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,Ba.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:(0,Ba.jsx)("button",{onClick:()=>(async(e,t)=>{let n=t.fighterId;!n&&t.id&&(n=t.id.split("-")[0]),n&&(I({name:e,id:n}),E(!0),await W(n))})(e.fighterName,e),className:"text-blue-600 hover:text-blue-800 hover:underline",children:e.fighterName})}),(0,Ba.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.rfid}),(0,Ba.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(()=>{const t=new Date(e.date),n=String(t.getUTCDate()).padStart(2,"0"),r=String(t.getUTCMonth()+1).padStart(2,"0"),a=t.getUTCFullYear().toString().slice(-2);return"".concat(n,"/").concat(r,"/").concat(a)})()}),(0,Ba.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(0,Ba.jsx)("div",{children:e.checkIns&&e.checkIns.map?e.checkIns.map((e,t)=>(0,Ba.jsxs)("div",{className:"flex items-center gap-2",children:[e.missed&&(0,Ba.jsx)(Et,{className:"text-red-500",title:"Indicates a missed punch-out on the previous day"}),(0,Ba.jsx)("span",{className:"text-green-600 font-semibold",children:new Date(e.time).toLocaleTimeString()})]},"in-".concat(t))):null})}),(0,Ba.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(0,Ba.jsx)("div",{children:e.checkOuts&&e.checkOuts.map?e.checkOuts.map((e,t)=>(0,Ba.jsx)("div",{className:"flex items-center gap-2",children:e.late?(0,Ba.jsxs)(Ba.Fragment,{children:[(0,Ba.jsx)("span",{className:"text-gray-500 font-semibold",children:new Date(e.time).toLocaleTimeString()}),(0,Ba.jsx)(Et,{className:"text-yellow-400",title:"Indicates a late punch-out from a previous day"})]}):(0,Ba.jsx)("span",{className:"text-red-600 font-semibold",children:new Date(e.time).toLocaleTimeString()})},"out-".concat(t))):null})}),(0,Ba.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-700",children:e.duration})]},e.id)):(0,Ba.jsx)("tr",{children:(0,Ba.jsx)("td",{colSpan:"6",className:"px-6 py-4 text-center text-sm text-gray-500",children:"No attendance records found."})})})]})})]}),C&&_&&(0,Ba.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4",children:(0,Ba.jsxs)("div",{className:"bg-white rounded-lg shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,Ba.jsxs)("div",{className:"flex justify-between items-center p-6 border-b",children:[(0,Ba.jsxs)("h3",{className:"text-xl font-semibold text-gray-800",children:["Attendance Report for ",_.name]}),(0,Ba.jsx)("button",{onClick:()=>{E(!1),I(null),A([]),O({startDate:"",endDate:""})},className:"text-gray-500 hover:text-gray-800 text-2xl",children:(0,Ba.jsx)(Qt,{})})]}),(0,Ba.jsx)("div",{className:"p-6 border-b bg-gray-50",children:(0,Ba.jsxs)("div",{className:"flex items-center gap-4 flex-wrap",children:[(0,Ba.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ba.jsx)(ht,{className:"text-gray-500"}),(0,Ba.jsx)("span",{className:"font-medium text-gray-700",children:"Date Filter:"})]}),(0,Ba.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,Ba.jsx)("input",{type:"date",value:F.startDate,onChange:e=>O(fn(fn({},F),{},{startDate:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-md text-sm",placeholder:"Start Date"}),(0,Ba.jsx)("span",{className:"flex items-center text-gray-500",children:"to"}),(0,Ba.jsx)("input",{type:"date",value:F.endDate,onChange:e=>O(fn(fn({},F),{},{endDate:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-md text-sm",placeholder:"End Date"})]}),(0,Ba.jsxs)("div",{className:"flex gap-2",children:[(0,Ba.jsxs)("button",{onClick:async()=>{F.startDate&&F.endDate?new Date(F.startDate)>new Date(F.endDate)?alert("Start date cannot be after end date."):_&&await W(_.id):alert("Please select both start and end dates.")},className:"flex items-center gap-2 bg-blue-500 text-white px-4 py-2 rounded-md text-sm hover:bg-blue-600",children:[(0,Ba.jsx)(Dt,{})," Apply Filter"]}),(0,Ba.jsx)("button",{onClick:async()=>{O({startDate:"",endDate:""}),_&&setTimeout(async()=>{await W(_.id)},100)},className:"flex items-center gap-2 bg-gray-500 text-white px-4 py-2 rounded-md text-sm hover:bg-gray-600",children:"Reset"})]})]})}),(0,Ba.jsx)("div",{className:"flex-grow overflow-auto",children:R?(0,Ba.jsx)("div",{className:"text-center p-8 text-gray-500",children:"Loading attendance report..."}):(0,Ba.jsx)("div",{className:"overflow-x-auto",children:(0,Ba.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,Ba.jsx)("thead",{className:"bg-gray-50 sticky top-0",children:(0,Ba.jsxs)("tr",{children:[(0,Ba.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,Ba.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Check-Ins"}),(0,Ba.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Check-Outs"}),(0,Ba.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Duration"})]})}),(0,Ba.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:T.length>0?T.map(e=>{const t=e.checkIns.filter(e=>!e.late),n=[...e.checkIns.filter(e=>e.late),...e.checkOuts];return(0,Ba.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,Ba.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:(()=>{const t=new Date(e.date),n=String(t.getDate()).padStart(2,"0"),r=String(t.getMonth()+1).padStart(2,"0"),a=t.getFullYear().toString().slice(-2);return"".concat(n,"/").concat(r,"/").concat(a)})()}),(0,Ba.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:t&&t.map?t.map((e,t)=>(0,Ba.jsx)("div",{className:"flex items-center gap-2",children:(0,Ba.jsx)("span",{className:"text-green-600 font-semibold",children:new Date(e.time).toLocaleTimeString()})},"in-".concat(t))):null}),(0,Ba.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(0,Ba.jsx)("div",{className:"flex flex-col space-y-0.1",children:n&&n.map?n.map((e,t)=>(0,Ba.jsx)("div",{className:"flex items-center gap-2",children:e.late?(0,Ba.jsxs)("div",{className:"flex items-center gap-2 px-1 rounded w-full",children:[(0,Ba.jsx)("span",{className:"text-gray-500 font-semibold",children:new Date(e.time).toLocaleTimeString()}),(0,Ba.jsx)(Et,{className:"text-yellow-500",title:"Indicates a late punch-out from a previous day"})]}):(0,Ba.jsx)("span",{className:"text-red-600 font-semibold pl-1",children:new Date(e.time).toLocaleTimeString()})},"out-".concat(t))):null})}),(0,Ba.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-800",children:e.duration})]},e.id||e.date)}):(0,Ba.jsx)("tr",{children:(0,Ba.jsx)("td",{colSpan:"4",className:"px-6 py-4 text-center text-sm text-gray-500",children:"No attendance records found for this fighter."})})})]})})}),(0,Ba.jsx)("div",{className:"p-6 border-t bg-gray-50",children:(0,Ba.jsxs)("div",{className:"flex justify-between items-center flex-wrap gap-4",children:[(0,Ba.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,Ba.jsxs)("button",{onClick:()=>{const e=Kre(T);qre(e,"attendance_".concat(_.name.replace(/\s+/g,"_")),"Attendance")},className:"flex items-center gap-2 bg-green-500 text-white px-3 py-1 rounded-md font-semibold hover:bg-green-600 transition duration-300 text-sm",disabled:R||0===T.length,children:[(0,Ba.jsx)(Tt,{})," Excel"]}),(0,Ba.jsxs)("button",{onClick:()=>{!function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Attendance Report";const a=new Vre.default;a.setFontSize(18),a.text(r,14,20),a.setFontSize(12),a.text("Generated on: ".concat((new Date).toLocaleDateString()),14,30),Gre()(a,{head:[t.map(e=>e.header)],body:e.map(e=>t.map(t=>t.key.includes(".")?t.key.split(".").reduce((e,t)=>e&&e[t],e)||"":e[t.key]||"")),startY:40,styles:{fontSize:8,cellPadding:2},headStyles:{fillColor:[66,66,66],textColor:[255,255,255]},alternateRowStyles:{fillColor:[245,245,245]}}),a.save("".concat(n,".pdf"))}(Kre(T),[{header:"Date",key:"date"},{header:"Check-Ins",key:"checkIns"},{header:"Check-Outs",key:"checkOuts"},{header:"Duration",key:"duration"}],"attendance_".concat(_.name.replace(/\s+/g,"_")),"Attendance Report - ".concat(_.name))},className:"flex items-center gap-2 bg-red-500 text-white px-3 py-1 rounded-md font-semibold hover:bg-red-600 transition duration-300 text-sm",disabled:R||0===T.length,children:[(0,Ba.jsx)(Rt,{})," PDF"]})]}),(0,Ba.jsxs)("div",{className:"flex flex-col items-end",children:[(0,Ba.jsxs)("div",{className:"text-sm text-gray-600",children:["Total Days: ",T.length]}),(0,Ba.jsxs)("div",{className:"text-sm text-gray-600",children:["Total Duration: ",(()=>{const e=T.reduce((e,t)=>{const[n,r,a]=t.duration.split(":").map(Number);return e+3600*n+60*r+a},0),t=Math.floor(e/3600),n=Math.floor(e%3600/60),r=e%60;return"".concat(t.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"),":").concat(r.toString().padStart(2,"0"))})()]})]})]})})]})}),t&&(0,Ba.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50",children:(0,Ba.jsxs)("div",{className:"bg-white rounded-lg shadow-2xl p-6 w-full max-w-md relative",children:[(0,Ba.jsx)("button",{onClick:j,className:"absolute top-3 right-3 text-gray-500 hover:text-gray-800 text-2xl",children:(0,Ba.jsx)(Qt,{})}),(0,Ba.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"rfid"===t?"RFID Punch In / Out":"Face Recognition"}),"rfid"===t&&(0,Ba.jsx)("div",{children:N?(0,Ba.jsxs)("div",{className:"text-center",children:[(0,Ba.jsxs)("p",{className:"text-lg font-medium text-gray-800",children:["Fighter: ",(0,Ba.jsx)("span",{className:"font-bold",children:N.fighter.name})]}),(0,Ba.jsxs)("p",{className:"text-sm text-gray-500 mb-4",children:["RFID: ",N.fighter.rfid]}),(0,Ba.jsx)("button",{onClick:async()=>{if(N){g(!0),f(null);try{let e=null,t="";if(navigator.geolocation)try{const t=await new Promise((e,t)=>{navigator.geolocation.getCurrentPosition(t=>e(t),e=>t(e),{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})});e={latitude:t.coords.latitude,longitude:t.coords.longitude}}catch(n){t="Could not get your location."}const{data:r}=await ja.post("/attendance/admin/rfid",{rfid:N.fighter.rfid,location:e});let a=r.msg;t&&(a+=" Note: ".concat(t)),f({type:"success",message:a,fighter:r.fighter}),h(""),L(),setTimeout(()=>j(),3e3)}catch(gfe){var e,t;const r=(null===(e=gfe.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.msg)||"An error occurred.";f({type:"error",message:r})}finally{g(!1),S(null)}}},className:"w-full px-6 py-3 rounded-lg font-bold text-white text-lg disabled:bg-gray-400 ".concat("in"===N.nextAction?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700"),disabled:p,children:p?"Processing...":"Confirm Punch ".concat(N.nextAction.toUpperCase())})]}):(0,Ba.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const t=u.trim();if(t){g(!0),f(null),S(null);try{const{data:e}=await ja.get("/attendance/status/".concat(t));S(e)}catch(gfe){var n,r;const t=(null===(n=gfe.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.msg)||"An error occurred.";f({type:"error",message:t})}finally{g(!1)}}else f({type:"error",message:"Please enter a valid RFID."})},className:"flex flex-col gap-4",children:[(0,Ba.jsxs)("div",{className:"relative",children:[(0,Ba.jsx)(Lt,{className:"absolute top-1/2 left-3 -translate-y-1/2 text-gray-400"}),(0,Ba.jsx)("input",{type:"text",value:u,onChange:e=>h(e.target.value),placeholder:"Enter or select Fighter RFID",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg",disabled:p,autoFocus:!0,list:"rfid-suggestions"}),(0,Ba.jsx)("datalist",{id:"rfid-suggestions",children:m.map((e,t)=>(0,Ba.jsx)("option",{value:e},t))})]}),(0,Ba.jsx)("button",{type:"submit",className:"w-full bg-blue-600 text-white px-6 py-2 rounded-lg font-semibold hover:bg-blue-700 disabled:bg-gray-400",disabled:p,children:p?"Searching...":"Find Fighter"})]})}),"face"===t&&(0,Ba.jsxs)("div",{className:"text-center",children:[(0,Ba.jsxs)("div",{className:"relative w-full border-4 border-gray-300 rounded-lg overflow-hidden",children:[(0,Ba.jsx)(si(),{ref:b,audio:!1,screenshotFormat:"image/jpeg",className:"w-full h-auto"}),p&&(0,Ba.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center text-white text-lg font-semibold",children:"Processing..."})]}),(0,Ba.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"Position face in the frame. Scan will start automatically."}),(0,Ba.jsx)("p",{className:"mt-1 text-xs text-gray-400",children:"Make sure the fighter's face is well-lit and centered."})]}),d&&(0,Ba.jsxs)("div",{className:"mt-4 p-3 rounded-lg flex items-center gap-3 text-sm ".concat("success"===d.type?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:[(0,Ba.jsx)(gt,{}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("p",{className:"font-semibold",children:d.message}),(null===(e=d.fighter)||void 0===e?void 0:e.name)&&(0,Ba.jsx)("p",{children:"Fighter: ".concat(d.fighter.name)})]})]})]})})]})},Yre=()=>{const[e,t]=(0,l.useState)([]),[n,r]=(0,l.useState)(!0),[a,i]=(0,l.useState)(""),[o,s]=(0,l.useState)({planName:"Monthly",amount:"",durationMonths:1,paymentMode:"Cash"}),[c,u]=(0,l.useState)("");(0,l.useEffect)(()=>{(async()=>{try{const e=await ja.get("/fighters/roster");t(e.data)}catch(gfe){console.error("Failed to fetch fighters")}finally{r(!1)}})()},[]);const h=e=>{s(fn(fn({},o),{},{[e.target.name]:e.target.value}))};return n?(0,Ba.jsx)("div",{className:"p-8 text-center",children:"Loading Fighters..."}):(0,Ba.jsxs)("div",{className:"p-6 md:p-8 bg-gray-50 min-h-screen",children:[(0,Ba.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-8",children:"Manage Subscriptions"}),(0,Ba.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6 max-w-2xl mx-auto border border-gray-100",children:[(0,Ba.jsxs)("h2",{className:"text-xl font-semibold mb-6 text-gray-700 flex items-center gap-2",children:[(0,Ba.jsx)(Wt,{className:"text-green-500"})," Assign New Membership"]}),c&&(0,Ba.jsxs)("div",{className:"mb-6 p-4 bg-green-100 text-green-700 rounded-lg flex items-center gap-2 animate-fade-in",children:[(0,Ba.jsx)(gt,{})," ",c]}),(0,Ba.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!a)return alert("Please select a fighter");try{await ja.post("/subscriptions/assign",fn({fighterId:a},o)),u("Subscription assigned successfully!"),s({planName:"Monthly",amount:"",durationMonths:1,paymentMode:"Cash"}),i(""),setTimeout(()=>u(""),3e3)}catch(gfe){var t,n;alert((null===(t=gfe.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.msg)||"Error assigning subscription")}},className:"space-y-6",children:[(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Fighter"}),(0,Ba.jsxs)("div",{className:"relative",children:[(0,Ba.jsx)(cn,{className:"absolute left-3 top-3 text-gray-400"}),(0,Ba.jsxs)("select",{className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none appearance-none bg-white transition-shadow",value:a,onChange:e=>i(e.target.value),required:!0,children:[(0,Ba.jsx)("option",{value:"",children:"-- Choose a Fighter --"}),e.map(e=>(0,Ba.jsxs)("option",{value:e._id,children:[e.name," (",e.rfid,")"]},e._id))]})]})]}),(0,Ba.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plan Name"}),(0,Ba.jsx)("input",{type:"text",name:"planName",value:o.planName,onChange:h,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-shadow",placeholder:"e.g. Gold Plan",required:!0})]}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Amount (\u20b9)"}),(0,Ba.jsx)("input",{type:"number",name:"amount",value:o.amount,onChange:h,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-shadow",placeholder:"e.g. 1500",required:!0})]})]}),(0,Ba.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Duration (Months)"}),(0,Ba.jsxs)("div",{className:"relative",children:[(0,Ba.jsx)(ht,{className:"absolute left-3 top-3 text-gray-400"}),(0,Ba.jsx)("input",{type:"number",name:"durationMonths",value:o.durationMonths,onChange:h,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-shadow",min:"1",required:!0})]})]}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Mode"}),(0,Ba.jsxs)("select",{name:"paymentMode",value:o.paymentMode,onChange:h,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none bg-white transition-shadow",children:[(0,Ba.jsx)("option",{children:"Cash"}),(0,Ba.jsx)("option",{children:"UPI"}),(0,Ba.jsx)("option",{children:"Card"}),(0,Ba.jsx)("option",{children:"Bank Transfer"})]})]})]}),(0,Ba.jsx)("button",{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3.5 rounded-lg transition-all shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:"Assign Subscription"})]})]})]})},$re=Object.create(null);$re.open="0",$re.close="1",$re.ping="2",$re.pong="3",$re.message="4",$re.upgrade="5",$re.noop="6";const Jre=Object.create(null);Object.keys($re).forEach(e=>{Jre[$re[e]]=e});const Qre={type:"error",data:"parser error"},Zre="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),eae="function"===typeof ArrayBuffer,tae=e=>"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,nae=(e,t,n)=>{let{type:r,data:a}=e;return Zre&&a instanceof Blob?t?n(a):rae(a,n):eae&&(a instanceof ArrayBuffer||tae(a))?t?n(a):rae(new Blob([a]),n):n($re[r]+(a||""))},rae=(e,t)=>{const n=new FileReader;return n.onload=function(){const e=n.result.split(",")[1];t("b"+(e||""))},n.readAsDataURL(e)};function aae(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let iae;const oae="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",sae="undefined"===typeof Uint8Array?[]:new Uint8Array(256);for(let n=0;n<64;n++)sae[oae.charCodeAt(n)]=n;const lae="function"===typeof ArrayBuffer,cae=(e,t)=>{if("string"!==typeof e)return{type:"message",data:hae(e,t)};const n=e.charAt(0);if("b"===n)return{type:"message",data:uae(e.substring(1),t)};return Jre[n]?e.length>1?{type:Jre[n],data:e.substring(1)}:{type:Jre[n]}:Qre},uae=(e,t)=>{if(lae){const n=(e=>{let t,n,r,a,i,o=.75*e.length,s=e.length,l=0;"="===e[e.length-1]&&(o--,"="===e[e.length-2]&&o--);const c=new ArrayBuffer(o),u=new Uint8Array(c);for(t=0;t<s;t+=4)n=sae[e.charCodeAt(t)],r=sae[e.charCodeAt(t+1)],a=sae[e.charCodeAt(t+2)],i=sae[e.charCodeAt(t+3)],u[l++]=n<<2|r>>4,u[l++]=(15&r)<<4|a>>2,u[l++]=(3&a)<<6|63&i;return c})(e);return hae(n,t)}return{base64:!0,data:e}},hae=(e,t)=>"blob"===t?e instanceof Blob?e:new Blob([e]):e instanceof ArrayBuffer?e:e.buffer,dae=String.fromCharCode(30);function fae(){return new TransformStream({transform(e,t){!function(e,t){Zre&&e.data instanceof Blob?e.data.arrayBuffer().then(aae).then(t):eae&&(e.data instanceof ArrayBuffer||tae(e.data))?t(aae(e.data)):nae(e,!1,e=>{iae||(iae=new TextEncoder),t(iae.encode(e))})}(e,n=>{const r=n.length;let a;if(r<126)a=new Uint8Array(1),new DataView(a.buffer).setUint8(0,r);else if(r<65536){a=new Uint8Array(3);const e=new DataView(a.buffer);e.setUint8(0,126),e.setUint16(1,r)}else{a=new Uint8Array(9);const e=new DataView(a.buffer);e.setUint8(0,127),e.setBigUint64(1,BigInt(r))}e.data&&"string"!==typeof e.data&&(a[0]|=128),t.enqueue(a),t.enqueue(n)})}})}let pae;function gae(e){return e.reduce((e,t)=>e+t.length,0)}function mae(e,t){if(e[0].length===t)return e.shift();const n=new Uint8Array(t);let r=0;for(let a=0;a<t;a++)n[a]=e[0][r++],r===e[0].length&&(e.shift(),r=0);return e.length&&r<e[0].length&&(e[0]=e[0].slice(r)),n}function vae(e){if(e)return function(e){for(var t in vae.prototype)e[t]=vae.prototype[t];return e}(e)}vae.prototype.on=vae.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},vae.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},vae.prototype.off=vae.prototype.removeListener=vae.prototype.removeAllListeners=vae.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var a=0;a<r.length;a++)if((n=r[a])===t||n.fn===t){r.splice(a,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},vae.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var a=(n=n.slice(0)).length;r<a;++r)n[r].apply(this,t)}return this},vae.prototype.emitReserved=vae.prototype.emit,vae.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},vae.prototype.hasListeners=function(e){return!!this.listeners(e).length};const bae="function"===typeof Promise&&"function"===typeof Promise.resolve?e=>Promise.resolve().then(e):(e,t)=>t(e,0),xae="undefined"!==typeof self?self:"undefined"!==typeof window?window:Function("return this")();function yae(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.reduce((t,n)=>(e.hasOwnProperty(n)&&(t[n]=e[n]),t),{})}const wae=xae.setTimeout,kae=xae.clearTimeout;function Nae(e,t){t.useNativeTimers?(e.setTimeoutFn=wae.bind(xae),e.clearTimeoutFn=kae.bind(xae)):(e.setTimeoutFn=xae.setTimeout.bind(xae),e.clearTimeoutFn=xae.clearTimeout.bind(xae))}function Sae(e){return"string"===typeof e?function(e){let t=0,n=0;for(let r=0,a=e.length;r<a;r++)t=e.charCodeAt(r),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}(e):Math.ceil(1.33*(e.byteLength||e.size))}function Cae(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}class Eae extends Error{constructor(e,t,n){super(e),this.description=t,this.context=n,this.type="TransportError"}}class _ae extends vae{constructor(e){super(),this.writable=!1,Nae(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,n){return super.emitReserved("error",new Eae(e,t,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=cae(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return-1===e.indexOf(":")?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(e){const t=function(e){let t="";for(let n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}(e);return t.length?"?"+t:""}}class Iae extends _ae{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let e=0;this._polling&&(e++,this.once("pollComplete",function(){--e||t()})),this.writable||(e++,this.once("drain",function(){--e||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){((e,t)=>{const n=e.split(dae),r=[];for(let a=0;a<n.length;a++){const e=cae(n[a],t);if(r.push(e),"error"===e.type)break}return r})(e,this.socket.binaryType).forEach(e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)}),"closed"!==this.readyState&&(this._polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};"open"===this.readyState?e():this.once("open",e)}write(e){this.writable=!1,((e,t)=>{const n=e.length,r=new Array(n);let a=0;e.forEach((e,i)=>{nae(e,!1,e=>{r[i]=e,++a===n&&t(r.join(dae))})})})(e,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=Cae()),this.supportsBinary||t.sid||(t.b64=1),this.createUri(e,t)}}let Tae=!1;try{Tae="undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(gfe){}const Aae=Tae;function Rae(){}class Dae extends Iae{constructor(e){if(super(e),"undefined"!==typeof location){const t="https:"===location.protocol;let n=location.port;n||(n=t?"443":"80"),this.xd="undefined"!==typeof location&&e.hostname!==location.hostname||n!==e.port}}doWrite(e,t){const n=this.request({method:"POST",data:e});n.on("success",t),n.on("error",(e,t)=>{this.onError("xhr post error",e,t)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(e,t)=>{this.onError("xhr poll error",e,t)}),this.pollXhr=e}}class Fae extends vae{constructor(e,t,n){super(),this.createRequest=e,Nae(this,n),this._opts=n,this._method=n.method||"GET",this._uri=t,this._data=void 0!==n.data?n.data:null,this._create()}_create(){var e;const t=yae(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(t);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let e in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(e)&&n.setRequestHeader(e,this._opts.extraHeaders[e])}}catch(ci){}if("POST"===this._method)try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(ci){}try{n.setRequestHeader("Accept","*/*")}catch(ci){}null===(e=this._opts.cookieJar)||void 0===e||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var e;3===n.readyState&&(null===(e=this._opts.cookieJar)||void 0===e||e.parseCookies(n.getResponseHeader("set-cookie"))),4===n.readyState&&(200===n.status||1223===n.status?this._onLoad():this.setTimeoutFn(()=>{this._onError("number"===typeof n.status?n.status:0)},0))},n.send(this._data)}catch(ci){return void this.setTimeoutFn(()=>{this._onError(ci)},0)}"undefined"!==typeof document&&(this._index=Fae.requestsCount++,Fae.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if("undefined"!==typeof this._xhr&&null!==this._xhr){if(this._xhr.onreadystatechange=Rae,e)try{this._xhr.abort()}catch(ci){}"undefined"!==typeof document&&delete Fae.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}if(Fae.requestsCount=0,Fae.requests={},"undefined"!==typeof document)if("function"===typeof attachEvent)attachEvent("onunload",Oae);else if("function"===typeof addEventListener){addEventListener("onpagehide"in xae?"pagehide":"unload",Oae,!1)}function Oae(){for(let e in Fae.requests)Fae.requests.hasOwnProperty(e)&&Fae.requests[e].abort()}const Lae=function(){const e=Pae({xdomain:!1});return e&&null!==e.responseType}();function Pae(e){const t=e.xdomain;try{if("undefined"!==typeof XMLHttpRequest&&(!t||Aae))return new XMLHttpRequest}catch(ci){}if(!t)try{return new(xae[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(ci){}}const Mae="undefined"!==typeof navigator&&"string"===typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class jae extends _ae{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,n=Mae?{}:yae(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,n)}catch(gfe){return this.emitReserved("error",gfe)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],r=t===e.length-1;nae(n,this.supportsBinary,e=>{try{this.doWrite(n,e)}catch(ci){}r&&bae(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){"undefined"!==typeof this.ws&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=Cae()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const Bae=xae.WebSocket||xae.MozWebSocket;const zae={websocket:class extends jae{createSocket(e,t,n){return Mae?new Bae(e,t,n):t?new Bae(e,t):new Bae(e)}doWrite(e,t){this.ws.send(t)}},webtransport:class extends _ae{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(gfe){return this.emitReserved("error",gfe)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=function(e,t){pae||(pae=new TextDecoder);const n=[];let r=0,a=-1,i=!1;return new TransformStream({transform(o,s){for(n.push(o);;){if(0===r){if(gae(n)<1)break;const e=mae(n,1);i=128===(128&e[0]),a=127&e[0],r=a<126?3:126===a?1:2}else if(1===r){if(gae(n)<2)break;const e=mae(n,2);a=new DataView(e.buffer,e.byteOffset,e.length).getUint16(0),r=3}else if(2===r){if(gae(n)<8)break;const e=mae(n,8),t=new DataView(e.buffer,e.byteOffset,e.length),i=t.getUint32(0);if(i>Math.pow(2,21)-1){s.enqueue(Qre);break}a=i*Math.pow(2,32)+t.getUint32(4),r=3}else{if(gae(n)<a)break;const e=mae(n,a);s.enqueue(cae(i?e:pae.decode(e),t)),r=0}if(0===a||a>e){s.enqueue(Qre);break}}}})}(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(t).getReader(),r=fae();r.readable.pipeTo(e.writable),this._writer=r.writable.getWriter();const a=()=>{n.read().then(e=>{let{done:t,value:n}=e;t||(this.onPacket(n),a())}).catch(e=>{})};a();const i={type:"open"};this.query.sid&&(i.data='{"sid":"'.concat(this.query.sid,'"}')),this._writer.write(i).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],r=t===e.length-1;this._writer.write(n).then(()=>{r&&bae(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;null===(e=this._transport)||void 0===e||e.close()}},polling:class extends Dae{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=Lae&&!t}request(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign(e,{xd:this.xd},this.opts),new Fae(Pae,this.uri(),e)}}},Wae=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Uae=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Vae(e){if(e.length>8e3)throw"URI too long";const t=e,n=e.indexOf("["),r=e.indexOf("]");-1!=n&&-1!=r&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));let a=Wae.exec(e||""),i={},o=14;for(;o--;)i[Uae[o]]=a[o]||"";return-1!=n&&-1!=r&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=function(e,t){const n=/\/{2,9}/g,r=t.replace(n,"/").split("/");"/"!=t.slice(0,1)&&0!==t.length||r.splice(0,1);"/"==t.slice(-1)&&r.splice(r.length-1,1);return r}(0,i.path),i.queryKey=function(e,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(e,t,r){t&&(n[t]=r)}),n}(0,i.query),i}const Hae="function"===typeof addEventListener&&"function"===typeof removeEventListener,Gae=[];Hae&&addEventListener("offline",()=>{Gae.forEach(e=>e())},!1);class qae extends vae{constructor(e,t){if(super(),this.binaryType="arraybuffer",this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&"object"===typeof e&&(t=e,e=null),e){const n=Vae(e);t.hostname=n.host,t.secure="https"===n.protocol||"wss"===n.protocol,t.port=n.port,n.query&&(t.query=n.query)}else t.host&&(t.hostname=Vae(t.host).host);Nae(this,t),this.secure=null!=t.secure?t.secure:"undefined"!==typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!==typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!==typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(e=>{const t=e.prototype.name;this.transports.push(t),this._transportsByName[t]=e}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"===typeof this.opts.query&&(this.opts.query=function(e){let t={},n=e.split("&");for(let r=0,a=n.length;r<a;r++){let e=n[r].split("=");t[decodeURIComponent(e[0])]=decodeURIComponent(e[1])}return t}(this.opts.query)),Hae&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Gae.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);const n=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](n)}_open(){if(0===this.transports.length)return void this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);const e=this.opts.rememberUpgrade&&qae.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket")?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",e=>this._onClose("transport close",e))}onOpen(){this.readyState="open",qae.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush()}_onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let t=0;t<this.writeBuffer.length;t++){const n=this.writeBuffer[t].data;if(n&&(e+=Sae(n)),t>0&&e>this._maxPayload)return this.writeBuffer.slice(0,t);e+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,bae(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,n){return this._sendPacket("message",e,t,n),this}send(e,t,n){return this._sendPacket("message",e,t,n),this}_sendPacket(e,t,n,r){if("function"===typeof t&&(r=t,t=void 0),"function"===typeof n&&(r=n,n=null),"closing"===this.readyState||"closed"===this.readyState)return;(n=n||{}).compress=!1!==n.compress;const a={type:e,data:t,options:n};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),r&&this.once("flush",r),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},n=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():e()}):this.upgrading?n():e()),this}_onError(e){if(qae.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&"opening"===this.readyState)return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Hae&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const e=Gae.indexOf(this._offlineEventListener);-1!==e&&Gae.splice(e,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}qae.protocol=4;class Kae extends qae{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),"open"===this.readyState&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),n=!1;qae.priorWebsocketSuccess=!1;const r=()=>{n||(t.send([{type:"ping",data:"probe"}]),t.once("packet",e=>{if(!n)if("pong"===e.type&&"probe"===e.data){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;qae.priorWebsocketSuccess="websocket"===t.name,this.transport.pause(()=>{n||"closed"!==this.readyState&&(c(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const e=new Error("probe error");e.transport=t.name,this.emitReserved("upgradeError",e)}}))};function a(){n||(n=!0,c(),t.close(),t=null)}const i=e=>{const n=new Error("probe error: "+e);n.transport=t.name,a(),this.emitReserved("upgradeError",n)};function o(){i("transport closed")}function s(){i("socket closed")}function l(e){t&&e.name!==t.name&&a()}const c=()=>{t.removeListener("open",r),t.removeListener("error",i),t.removeListener("close",o),this.off("close",s),this.off("upgrading",l)};t.once("open",r),t.once("error",i),t.once("close",o),this.once("close",s),this.once("upgrading",l),-1!==this._upgrades.indexOf("webtransport")&&"webtransport"!==e?this.setTimeoutFn(()=>{n||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let n=0;n<e.length;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}class Xae extends Kae{constructor(e){const t="object"===typeof e?e:arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(!t.transports||t.transports&&"string"===typeof t.transports[0])&&(t.transports=(t.transports||["polling","websocket","webtransport"]).map(e=>zae[e]).filter(e=>!!e)),super(e,t)}}const Yae="function"===typeof ArrayBuffer,$ae=Object.prototype.toString,Jae="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===$ae.call(Blob),Qae="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===$ae.call(File);function Zae(e){return Yae&&(e instanceof ArrayBuffer||(e=>"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer)(e))||Jae&&e instanceof Blob||Qae&&e instanceof File}function eie(e,t){if(!e||"object"!==typeof e)return!1;if(Array.isArray(e)){for(let t=0,n=e.length;t<n;t++)if(eie(e[t]))return!0;return!1}if(Zae(e))return!0;if(e.toJSON&&"function"===typeof e.toJSON&&1===arguments.length)return eie(e.toJSON(),!0);for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&eie(e[n]))return!0;return!1}function tie(e){const t=[],n=e.data,r=e;return r.data=nie(n,t),r.attachments=t.length,{packet:r,buffers:t}}function nie(e,t){if(!e)return e;if(Zae(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}if(Array.isArray(e)){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=nie(e[r],t);return n}if("object"===typeof e&&!(e instanceof Date)){const n={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=nie(e[r],t));return n}return e}function rie(e,t){return e.data=aie(e.data,t),delete e.attachments,e}function aie(e,t){if(!e)return e;if(e&&!0===e._placeholder){if("number"===typeof e.num&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=aie(e[n],t);else if("object"===typeof e)for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=aie(e[n],t));return e}const iie=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],oie=5;var sie;!function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(sie||(sie={}));class lie{constructor(e){this.replacer=e}encode(e){return e.type!==sie.EVENT&&e.type!==sie.ACK||!eie(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===sie.EVENT?sie.BINARY_EVENT:sie.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})}encodeAsString(e){let t=""+e.type;return e.type!==sie.BINARY_EVENT&&e.type!==sie.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=tie(e),n=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(n),r}}function cie(e){return"[object Object]"===Object.prototype.toString.call(e)}class uie extends vae{constructor(e){super(),this.reviver=e}add(e){let t;if("string"===typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const n=t.type===sie.BINARY_EVENT;n||t.type===sie.BINARY_ACK?(t.type=n?sie.EVENT:sie.ACK,this.reconstructor=new hie(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else{if(!Zae(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t))}}decodeString(e){let t=0;const n={type:Number(e.charAt(0))};if(void 0===sie[n.type])throw new Error("unknown packet type "+n.type);if(n.type===sie.BINARY_EVENT||n.type===sie.BINARY_ACK){const r=t+1;for(;"-"!==e.charAt(++t)&&t!=e.length;);const a=e.substring(r,t);if(a!=Number(a)||"-"!==e.charAt(t))throw new Error("Illegal attachments");n.attachments=Number(a)}if("/"===e.charAt(t+1)){const r=t+1;for(;++t;){if(","===e.charAt(t))break;if(t===e.length)break}n.nsp=e.substring(r,t)}else n.nsp="/";const r=e.charAt(t+1);if(""!==r&&Number(r)==r){const r=t+1;for(;++t;){const n=e.charAt(t);if(null==n||Number(n)!=n){--t;break}if(t===e.length)break}n.id=Number(e.substring(r,t+1))}if(e.charAt(++t)){const r=this.tryParse(e.substr(t));if(!uie.isPayloadValid(n.type,r))throw new Error("invalid payload");n.data=r}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(ci){return!1}}static isPayloadValid(e,t){switch(e){case sie.CONNECT:return cie(t);case sie.DISCONNECT:return void 0===t;case sie.CONNECT_ERROR:return"string"===typeof t||cie(t);case sie.EVENT:case sie.BINARY_EVENT:return Array.isArray(t)&&("number"===typeof t[0]||"string"===typeof t[0]&&-1===iie.indexOf(t[0]));case sie.ACK:case sie.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class hie{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const e=rie(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function die(e,t,n){return e.on(t,n),function(){e.off(t,n)}}const fie=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class pie extends vae{constructor(e,t,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[die(e,"open",this.onopen.bind(this)),die(e,"packet",this.onpacket.bind(this)),die(e,"error",this.onerror.bind(this)),die(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.unshift("message"),this.emit.apply(this,t),this}emit(e){var t,n,r;if(fie.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');for(var a=arguments.length,i=new Array(a>1?a-1:0),o=1;o<a;o++)i[o-1]=arguments[o];if(i.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(i),this;const s={type:sie.EVENT,data:i,options:{}};if(s.options.compress=!1!==this.flags.compress,"function"===typeof i[i.length-1]){const e=this.ids++,t=i.pop();this._registerAckCallback(e,t),s.id=e}const l=null===(n=null===(t=this.io.engine)||void 0===t?void 0:t.transport)||void 0===n?void 0:n.writable,c=this.connected&&!(null===(r=this.io.engine)||void 0===r?void 0:r._hasPingExpired());return this.flags.volatile&&!l||(c?(this.notifyOutgoingListeners(s),this.packet(s)):this.sendBuffer.push(s)),this.flags={},this}_registerAckCallback(e,t){var n,r=this;const a=null!==(n=this.flags.timeout)&&void 0!==n?n:this._opts.ackTimeout;if(void 0===a)return void(this.acks[e]=t);const i=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===e&&this.sendBuffer.splice(t,1);t.call(this,new Error("operation has timed out"))},a),o=function(){r.io.clearTimeoutFn(i);for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];t.apply(r,n)};o.withError=!0,this.acks[e]=o}emitWithAck(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return new Promise((t,r)=>{const a=(e,n)=>e?r(e):t(n);a.withError=!0,n.push(a),this.emit(e,...n)})}_addToQueue(e){var t=this;let n;"function"===typeof e[e.length-1]&&(n=e.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push(function(e){if(r!==t._queue[0])return;if(null!==e)r.tryCount>t._opts.retries&&(t._queue.shift(),n&&n(e));else if(t._queue.shift(),n){for(var a=arguments.length,i=new Array(a>1?a-1:0),o=1;o<a;o++)i[o-1]=arguments[o];n(null,...i)}return r.pending=!1,t._drainQueue()}),this._queue.push(r),this._drainQueue()}_drainQueue(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.connected||0===this._queue.length)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){"function"==typeof this.auth?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:sie.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(t=>String(t.id)===e)){const t=this.acks[e];delete this.acks[e],t.withError&&t.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case sie.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case sie.EVENT:case sie.BINARY_EVENT:this.onevent(e);break;case sie.ACK:case sie.BINARY_ACK:this.onack(e);break;case sie.DISCONNECT:this.ondisconnect();break;case sie.CONNECT_ERROR:this.destroy();const t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}onevent(e){const t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const n of t)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&"string"===typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let n=!1;return function(){if(!n){n=!0;for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];t.packet({type:sie.ACK,id:e,data:a})}}}onack(e){const t=this.acks[e.id];"function"===typeof t&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:sie.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const n of t)n.apply(this,e.data)}}}function gie(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}gie.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},gie.prototype.reset=function(){this.attempts=0},gie.prototype.setMin=function(e){this.ms=e},gie.prototype.setMax=function(e){this.max=e},gie.prototype.setJitter=function(e){this.jitter=e};class mie extends vae{constructor(e,t){var n;super(),this.nsps={},this.subs=[],e&&"object"===typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.opts=t,Nae(this,t),this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(n=t.randomizationFactor)&&void 0!==n?n:.5),this.backoff=new gie({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this._readyState="closed",this.uri=e;const r=t.parser||o;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Xae(this.uri,this.opts);const t=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const r=die(t,"open",function(){n.onopen(),e&&e()}),a=t=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",t),e?e(t):this.maybeReconnectOnOpen()},i=die(t,"error",a);if(!1!==this._timeout){const e=this._timeout,n=this.setTimeoutFn(()=>{r(),a(new Error("timeout")),t.close()},e);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}return this.subs.push(r),this.subs.push(i),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(die(e,"ping",this.onping.bind(this)),die(e,"data",this.ondata.bind(this)),die(e,"error",this.onerror.bind(this)),die(e,"close",this.onclose.bind(this)),die(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(ci){this.onclose("parse error",ci)}}ondecoded(e){bae(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new pie(this,e,t),this.nsps[e]=n),n}_destroy(e){const t=Object.keys(this.nsps);for(const n of t){if(this.nsps[n].active)return}this._close()}_packet(e){const t=this.encoder.encode(e);for(let n=0;n<t.length;n++)this.engine.write(t[n],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var n;this.cleanup(),null===(n=this.engine)||void 0===n||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open(t=>{t?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):e.onreconnect()}))},t);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const vie={};function bie(e,t){"object"===typeof e&&(t=e,e=void 0);const n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r=e;n=n||"undefined"!==typeof location&&location,null==e&&(e=n.protocol+"//"+n.host),"string"===typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(e="undefined"!==typeof n?n.protocol+"//"+e:"https://"+e),r=Vae(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const a=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+a+":"+r.port+t,r.href=r.protocol+"://"+a+(n&&n.port===r.port?"":":"+r.port),r}(e,(t=t||{}).path||"/socket.io"),r=n.source,a=n.id,i=n.path,o=vie[a]&&i in vie[a].nsps;let s;return t.forceNew||t["force new connection"]||!1===t.multiplex||o?s=new mie(r,t):(vie[a]||(vie[a]=new mie(r,t)),s=vie[a]),n.query&&!t.query&&(t.query=n.queryKey),s.socket(n.path,t)}Object.assign(bie,{Manager:mie,Socket:pie,io:bie,connect:bie});let xie=null,yie=null;const wie=e=>(xie&&xie.disconnect(),yie=e,xie=bie("http://localhost:5000"),xie.emit("register_user",{userId:e._id,role:e.role,name:e.name||("admin"===e.role?"Admin":"Fighter")}),console.log("[SOCKET] Initialized socket connection for user:",e._id),xie),kie=e=>{xie&&(xie.off("new_message",e),xie.on("new_message",e))},Nie=e=>{xie&&(xie.off("new_notification",e),xie.on("new_notification",e))},Sie=()=>{xie&&(xie.disconnect(),xie=null,yie=null,console.log("[SOCKET] Disconnected socket"))};let Cie=null;const Eie=()=>{try{if(Cie||(Cie=new(window.AudioContext||window.webkitAudioContext)),!Cie)return void console.warn("AudioContext not available");const e=Cie.createOscillator(),t=Cie.createGain();e.connect(t),t.connect(Cie.destination),e.type="sine",e.frequency.value=800,t.gain.value=.3,e.start(),setTimeout(()=>{e.stop()},200)}catch(e){console.warn("Could not play notification sound:",e)}},_ie=e=>{const{currentUser:t,adminId:n,fighters:r,messages:a,activeChat:i,setActiveChat:o,newMessage:s,setNewMessage:c,loading:u,error:h,unreadCounts:d,notifications:f,setNotifications:p,handleSendMessage:g,handleDeleteMessage:m,getFilteredMessages:v,getNextMessageType:b,notification:x,notificationsEnabled:y,setNotificationsEnabled:w}=e,[k,N]=(0,l.useState)(()=>localStorage.getItem("theme")||"dark"),[S,C]=(0,l.useState)("chats");(0,l.useEffect)(()=>{localStorage.setItem("theme",k),document.documentElement.classList.toggle("dark","dark"===k)},[k]);const E=()=>{N(e=>"dark"===e?"light":"dark")};return(0,Ba.jsxs)("div",{className:"flex h-screen ".concat("dark"===k?"bg-gray-900":"bg-gray-100"),children:[(0,Ba.jsxs)("div",{className:"w-80 border-r ".concat("dark"===k?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:[(0,Ba.jsx)("div",{className:"p-4 border-b ".concat("dark"===k?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:(0,Ba.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ba.jsx)("h2",{className:"text-xl font-bold ".concat("dark"===k?"text-white":"text-gray-800"),children:"Ask Doubt"}),(0,Ba.jsx)("button",{onClick:E,className:"p-2 rounded-full transition-colors ".concat("dark"===k?"text-yellow-400 bg-gray-700 hover:bg-gray-600":"text-gray-700 bg-gray-200 hover:bg-gray-300"),title:"dark"===k?"Switch to light mode":"Switch to dark mode",children:"dark"===k?(0,Ba.jsx)(Yt,{className:"text-lg"}):(0,Ba.jsx)(Ut,{className:"text-lg"})})]})}),(0,Ba.jsxs)("div",{className:"flex border-b ".concat("dark"===k?"border-gray-700":"border-gray-200"),children:[(0,Ba.jsx)("button",{onClick:()=>C("chats"),className:"flex-1 py-3 text-center font-medium ".concat("chats"===S?"dark"===k?"text-blue-400 border-b-2 border-blue-400":"text-blue-600 border-b-2 border-blue-600":"dark"===k?"text-gray-400 hover:text-gray-300":"text-gray-500 hover:text-gray-700"),children:"Chats"}),(0,Ba.jsxs)("button",{onClick:()=>C("notifications"),className:"flex-1 py-3 text-center font-medium relative ".concat("notifications"===S?"dark"===k?"text-blue-400 border-b-2 border-blue-400":"text-blue-600 border-b-2 border-blue-600":"dark"===k?"text-gray-400 hover:text-gray-300":"text-gray-500 hover:text-gray-700"),children:["Notifications",f.length>0&&(0,Ba.jsx)("span",{className:"absolute top-2 right-4 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:f.length})]})]}),(0,Ba.jsx)("div",{className:"h-[calc(100vh-120px)] overflow-y-auto",children:"chats"===S?(()=>{var e;return(0,Ba.jsxs)("div",{className:"p-4 ".concat("dark"===k?"bg-gray-800":"bg-gray-100"," rounded-lg"),children:[(0,Ba.jsx)("h3",{className:"text-lg font-bold mb-4 ".concat("dark"===k?"text-white":"text-gray-800"),children:"Chat Rooms"}),(0,Ba.jsxs)("div",{className:"space-y-2",children:[(0,Ba.jsx)("button",{onClick:()=>o({type:"common",peer:{_id:null,name:"Common Group"}}),className:"w-full text-left p-3 rounded-lg transition-colors ".concat("common"===(null===i||void 0===i?void 0:i.type)?"dark"===k?"bg-blue-600 text-white":"bg-blue-500 text-white":"dark"===k?"bg-gray-700 text-gray-200 hover:bg-gray-600":"bg-white text-gray-800 hover:bg-gray-200"),children:(0,Ba.jsxs)("div",{className:"flex items-center",children:[(0,Ba.jsx)(un,{className:"mr-2"}),(0,Ba.jsx)("span",{children:"Common Group"}),d.common>0&&(0,Ba.jsx)("span",{className:"ml-auto bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:d.common})]})}),(0,Ba.jsxs)("div",{className:"mt-4",children:[(0,Ba.jsx)("h4",{className:"font-medium mb-2 ".concat("dark"===k?"text-gray-300":"text-gray-600"),children:"Private Chats"}),"admin"===(null===t||void 0===t?void 0:t.role)?r.map(e=>{var t;return(0,Ba.jsx)("button",{onClick:()=>o({type:"private",peer:e}),className:"w-full text-left p-3 rounded-lg transition-colors mb-1 ".concat("private"===(null===i||void 0===i?void 0:i.type)&&(null===i||void 0===i||null===(t=i.peer)||void 0===t?void 0:t._id)===e._id?"dark"===k?"bg-blue-600 text-white":"bg-blue-500 text-white":"dark"===k?"bg-gray-700 text-gray-200 hover:bg-gray-600":"bg-white text-gray-800 hover:bg-gray-200"),children:(0,Ba.jsxs)("div",{className:"flex items-center",children:[(0,Ba.jsx)(sn,{className:"mr-2"}),(0,Ba.jsx)("span",{children:e.name}),d[e._id]>0&&(0,Ba.jsx)("span",{className:"ml-auto bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:d[e._id]})]})},e._id)}):(0,Ba.jsx)("button",{onClick:()=>o({type:"private",peer:{_id:n,name:"Admin"}}),className:"w-full text-left p-3 rounded-lg transition-colors ".concat("private"===(null===i||void 0===i?void 0:i.type)&&(null===i||void 0===i||null===(e=i.peer)||void 0===e?void 0:e._id)===n?"dark"===k?"bg-blue-600 text-white":"bg-blue-500 text-white":"dark"===k?"bg-gray-700 text-gray-200 hover:bg-gray-600":"bg-white text-gray-800 hover:bg-gray-200"),children:(0,Ba.jsxs)("div",{className:"flex items-center",children:[(0,Ba.jsx)(sn,{className:"mr-2"}),(0,Ba.jsx)("span",{children:"Admin"}),d[n]>0&&(0,Ba.jsx)("span",{className:"ml-auto bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:d[n]})]})})]})]})]})})():(0,Ba.jsxs)("div",{className:"p-4",children:[(0,Ba.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Ba.jsx)("h3",{className:"text-lg font-bold ".concat("dark"===k?"text-white":"text-gray-800"),children:"Notifications"}),f.length>0&&(0,Ba.jsx)("button",{onClick:()=>p([]),className:"text-sm ".concat("dark"===k?"text-blue-400 hover:text-blue-300":"text-blue-600 hover:text-blue-800"),children:"Clear All"})]}),0===f.length?(0,Ba.jsxs)("div",{className:"text-center py-8",children:[(0,Ba.jsx)(lt,{className:"text-4xl mx-auto mb-2 ".concat("dark"===k?"text-gray-600":"text-gray-400")}),(0,Ba.jsx)("p",{className:"dark"===k?"text-gray-400":"text-gray-600",children:"No notifications yet"})]}):(0,Ba.jsx)("div",{className:"space-y-3",children:f.map(e=>(0,Ba.jsxs)("div",{className:"p-4 rounded-lg border ".concat("dark"===k?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:[(0,Ba.jsxs)("div",{className:"flex justify-between",children:[(0,Ba.jsx)("h4",{className:"font-bold ".concat("dark"===k?"text-white":"text-gray-800"),children:e.senderName}),(0,Ba.jsx)("span",{className:"text-xs ".concat("dark"===k?"text-gray-400":"text-gray-500"),children:new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),(0,Ba.jsx)("p",{className:"mt-2 ".concat("dark"===k?"text-gray-300":"text-gray-600"),children:e.text}),(0,Ba.jsx)("div",{className:"mt-3 flex space-x-2",children:(0,Ba.jsx)("button",{onClick:()=>{if(e.senderId){const t=r.find(t=>t._id===e.senderId);t&&(o({type:"private",peer:t}),C("chats"))}},className:"text-sm px-3 py-1 rounded ".concat("dark"===k?"bg-blue-600 hover:bg-blue-700 text-white":"bg-blue-500 hover:bg-blue-600 text-white"),children:"View Chat"})})]},e.id))})]})})]}),(0,Ba.jsx)("div",{className:"flex-grow",children:(()=>{var e;const n=v();return(0,Ba.jsxs)("div",{className:"flex flex-col h-full",children:[(0,Ba.jsx)("div",{className:"p-4 border-b ".concat("dark"===k?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:(0,Ba.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ba.jsxs)("div",{className:"flex items-center",children:["private"===(null===i||void 0===i?void 0:i.type)&&(0,Ba.jsx)("button",{onClick:()=>o({type:"common",peer:{_id:null,name:"Common Group"}}),className:"mr-3 p-2 rounded-lg ".concat("dark"===k?"hover:bg-gray-700":"hover:bg-gray-100"),children:(0,Ba.jsx)(mt,{})}),(0,Ba.jsx)("h3",{className:"text-xl font-bold ".concat("dark"===k?"text-white":"text-gray-800"),children:(null===i||void 0===i||null===(e=i.peer)||void 0===e?void 0:e.name)||"Common Group"})]}),(0,Ba.jsx)("button",{onClick:E,className:"p-2 rounded-full transition-colors ".concat("dark"===k?"text-yellow-400 bg-gray-700 hover:bg-gray-600":"text-gray-700 bg-gray-200 hover:bg-gray-300"),title:"dark"===k?"Switch to light mode":"Switch to dark mode",children:"dark"===k?(0,Ba.jsx)(Yt,{className:"text-lg"}):(0,Ba.jsx)(Ut,{className:"text-lg"})})]})}),(0,Ba.jsx)("div",{className:"flex-grow overflow-y-auto p-4 ".concat("dark"===k?"bg-gray-900":"bg-gray-50"),children:u?(0,Ba.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,Ba.jsxs)("div",{className:"text-center",children:[(0,Ba.jsx)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500 mb-2"}),(0,Ba.jsx)("p",{className:"dark"===k?"text-gray-400":"text-gray-600",children:"Loading messages..."})]})}):h?(0,Ba.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,Ba.jsxs)("div",{className:"text-center p-4 rounded-lg bg-red-100 text-red-700",children:[(0,Ba.jsxs)("p",{children:["Error: ",h]}),(0,Ba.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-2 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"Retry"})]})}):0===n.length?(0,Ba.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,Ba.jsx)("p",{className:"dark"===k?"text-gray-400":"text-gray-600",children:"common"===(null===i||void 0===i?void 0:i.type)?"No messages yet. Start a conversation!":"No messages yet. Send a message to start chatting!"})}):(0,Ba.jsx)("div",{className:"space-y-4",children:n.map(e=>{var n,r,a,i,o;return(0,Ba.jsxs)("div",{className:"p-4 rounded-lg max-w-3/4 ".concat((null===(n=e.user)||void 0===n?void 0:n._id)===(null===t||void 0===t?void 0:t._id)?"dark"===k?"bg-blue-600 text-white ml-auto":"bg-blue-500 text-white ml-auto":"dark"===k?"bg-gray-800 text-white":"bg-white text-gray-800"),children:[(null===(r=e.user)||void 0===r?void 0:r._id)!==(null===t||void 0===t?void 0:t._id)&&(0,Ba.jsx)("p",{className:"text-sm font-semibold mb-1 ".concat("dark"===k?"text-blue-300":"text-blue-600"),children:null===(a=e.user)||void 0===a?void 0:a.name}),(0,Ba.jsx)("p",{className:"whitespace-pre-wrap",children:e.text}),(0,Ba.jsx)("p",{className:"text-xs mt-2 ".concat((null===(i=e.user)||void 0===i?void 0:i._id)===(null===t||void 0===t?void 0:t._id)?"dark"===k?"text-blue-200":"text-blue-100":"dark"===k?"text-gray-400":"text-gray-500"),children:new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),"admin"===(null===t||void 0===t?void 0:t.role)&&(null===(o=e.user)||void 0===o?void 0:o._id)!==(null===t||void 0===t?void 0:t._id)&&(0,Ba.jsx)("div",{className:"mt-2 flex space-x-2",children:(0,Ba.jsx)("button",{onClick:()=>m(e._id),className:"text-xs px-2 py-1 rounded ".concat("dark"===k?"bg-red-700 hover:bg-red-600 text-white":"bg-red-500 hover:bg-red-600 text-white"),children:"Delete"})})]},e._id)})})}),(0,Ba.jsx)("div",{className:"p-4 border-t ".concat("dark"===k?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:(0,Ba.jsxs)("div",{className:"flex",children:[(0,Ba.jsx)("input",{type:"text",value:s,onChange:e=>c(e.target.value),onKeyPress:e=>{"Enter"===e.key&&s.trim()&&(g({text:s,messageType:b()}),c(""))},placeholder:"common"===(null===i||void 0===i?void 0:i.type)?"Type a message to the group...":"Type a message...",className:"flex-grow p-3 rounded-l-lg border ".concat("dark"===k?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300 text-gray-800 placeholder-gray-500")}),(0,Ba.jsx)("button",{onClick:()=>{s.trim()&&(g({text:s,messageType:b()}),c(""))},disabled:!s.trim(),className:"px-6 py-3 rounded-r-lg font-medium transition-colors ".concat(s.trim()?"dark"===k?"bg-blue-600 hover:bg-blue-700 text-white":"bg-blue-500 hover:bg-blue-600 text-white":"dark"===k?"bg-gray-700 text-gray-500 cursor-not-allowed":"bg-gray-200 text-gray-400 cursor-not-allowed"),children:"Send"})]})})]})})()})]})},Iie=e=>{const{currentUser:t,adminId:n,fighters:r,messages:a,activeChat:i,setActiveChat:o,newMessage:s,setNewMessage:c,loading:u,error:h,unreadCounts:d,notifications:f,setNotifications:p,handleSendMessage:g,handleDeleteMessage:m,getFilteredMessages:v,getNextMessageType:b,notification:x,notificationsEnabled:y,setNotificationsEnabled:w}=e,[k,N]=(0,l.useState)(()=>localStorage.getItem("theme")||"dark"),[S,C]=(0,l.useState)("common"),[E,_]=(0,l.useState)(null);(0,l.useEffect)(()=>{localStorage.setItem("theme",k),document.documentElement.classList.toggle("dark","dark"===k)},[k]);return(0,Ba.jsxs)("div",{className:"flex flex-col h-screen ".concat("dark"===k?"bg-gray-900":"bg-gray-100"),children:[(0,Ba.jsx)("div",{className:"p-4 border-b shadow-sm ".concat("dark"===k?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:(0,Ba.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ba.jsxs)("div",{className:"flex items-center",children:[(()=>{var e;return"private"===S&&"private"===(null===i||void 0===i?void 0:i.type)&&(null===i||void 0===i||null===(e=i.peer)||void 0===e?void 0:e._id)})()&&(0,Ba.jsx)("button",{onClick:()=>{"private"===S&&"private"===(null===i||void 0===i?void 0:i.type)||C("common"),o({type:"common",peer:{_id:null,name:"Common Group"}})},className:"mr-3 p-2 rounded-lg ".concat("dark"===k?"hover:bg-gray-700":"hover:bg-gray-100"),children:(0,Ba.jsx)(mt,{})}),(0,Ba.jsx)("h3",{className:"text-xl font-bold ".concat("dark"===k?"text-white":"text-gray-800"),children:"common"===S?"Common Chat":"private"===S?"Private Chats":"Notifications"})]}),(0,Ba.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ba.jsx)("button",{onClick:()=>{N(e=>"dark"===e?"light":"dark")},className:"p-2 rounded-full transition-colors ".concat("dark"===k?"text-yellow-400 bg-gray-700 hover:bg-gray-600":"text-gray-700 bg-gray-200 hover:bg-gray-300"),title:"dark"===k?"Switch to light mode":"Switch to dark mode",children:"dark"===k?(0,Ba.jsx)(Yt,{className:"text-lg"}):(0,Ba.jsx)(Ut,{className:"text-lg"})}),"notifications"===S&&f.length>0&&(0,Ba.jsx)("button",{onClick:()=>p([]),className:"text-sm ".concat("dark"===k?"text-blue-400 hover:text-blue-300":"text-blue-600 hover:text-blue-800"),children:"Clear All"})]})]})}),(0,Ba.jsx)("div",{className:"flex-grow overflow-hidden",children:(()=>{var e;return(0,Ba.jsxs)("div",{className:"p-4 ".concat("dark"===k?"bg-gray-900 text-white":"bg-gray-100 text-gray-800"),children:[(0,Ba.jsxs)("p",{children:["Active Tab: ",S]}),(0,Ba.jsxs)("p",{children:["Active Chat: ",(null===i||void 0===i||null===(e=i.peer)||void 0===e?void 0:e.name)||"None"]})]})})()}),(0,Ba.jsxs)("div",{className:"flex justify-around items-center border-t p-2 ".concat("dark"===k?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:[(0,Ba.jsxs)("button",{onClick:()=>{C("common"),o({type:"common",peer:{_id:null,name:"Common Group"}})},className:"flex flex-col items-center p-2 rounded-lg ".concat("common"===S?"dark"===k?"text-blue-400":"text-blue-600":"dark"===k?"text-gray-400":"text-gray-500"),children:[(0,Ba.jsx)(un,{size:20}),(0,Ba.jsx)("span",{className:"text-xs mt-1",children:"Common"})]}),(0,Ba.jsxs)("button",{onClick:()=>{var e;C("private"),"private"===(null===i||void 0===i?void 0:i.type)&&null!==i&&void 0!==i&&null!==(e=i.peer)&&void 0!==e&&e._id&&o({type:"common",peer:{_id:null,name:"Common Group"}})},className:"flex flex-col items-center p-2 rounded-lg ".concat("private"===S?"dark"===k?"text-blue-400":"text-blue-600":"dark"===k?"text-gray-400":"text-gray-500"),children:[(0,Ba.jsx)(sn,{size:20}),(0,Ba.jsx)("span",{className:"text-xs mt-1",children:"Private"})]}),(0,Ba.jsxs)("button",{onClick:()=>C("notifications"),className:"flex flex-col items-center p-2 rounded-lg ".concat("notifications"===S?"dark"===k?"text-blue-400":"text-blue-600":"dark"===k?"text-gray-400":"text-gray-500"),children:[(0,Ba.jsxs)("div",{className:"relative",children:[(0,Ba.jsx)(lt,{size:20}),f.length>0&&(0,Ba.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-4 w-4 flex items-center justify-center",children:f.length})]}),(0,Ba.jsx)("span",{className:"text-xs mt-1",children:"Notifications"})]})]})]})},Tie=()=>{const[e,t]=(0,l.useState)(!1),[n,r]=(0,l.useState)(null),[a,i]=(0,l.useState)(null),[o,s]=(0,l.useState)([]),[c,u]=(0,l.useState)([]),[h,d]=(0,l.useState)({type:"common",peer:{_id:null,name:"Common Group"}}),[f,p]=(0,l.useState)(""),[g,m]=(0,l.useState)(!0),[v,b]=(0,l.useState)(""),[x,y]=(0,l.useState)({}),[w,k]=(0,l.useState)({}),[N,S]=(0,l.useState)(new Set),[C,E]=(0,l.useState)(null),[_,I]=(0,l.useState)(null),[T,A]=(0,l.useState)([]),[R,D]=(0,l.useState)(!0),F=(0,l.useRef)(!1),O=((0,l.useRef)(null),(0,l.useRef)(null)),L=(0,l.useRef)(null);(0,l.useEffect)(()=>{const e=()=>{t(window.innerWidth<=768)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),(0,l.useEffect)(()=>{const e=localStorage.getItem("notificationsEnabled");if(null!==e)try{D(JSON.parse(e))}catch(ci){console.error("Failed to parse notification preference from localStorage",ci),D(!0)}},[]),(0,l.useEffect)(()=>{try{localStorage.setItem("notificationsEnabled",JSON.stringify(R))}catch(ci){console.error("Failed to save notification preference to localStorage",ci)}},[R]),(0,l.useEffect)(()=>((async()=>{if(!F.current){F.current=!0;try{m(!0);const{data:e}=await ja.get("/auth/user");r(e);wie(e);if(kie(e=>{console.log("[SOCKET] Received new message:",e),u(t=>{if(!t.some(t=>{var n,r;return t._id===e._id||t.isTemporary&&t.text===e.text&&(null===(n=t.user)||void 0===n?void 0:n._id)===(null===(r=e.user)||void 0===r?void 0:r._id)})){return[...t.filter(e=>!e.isTemporary||e._id!=="temp_"+Date.now()),e]}return t.map(t=>{var n,r;return t.isTemporary&&t.text===e.text&&(null===(n=t.user)||void 0===n?void 0:n._id)===(null===(r=e.user)||void 0===r?void 0:r._id)?fn(fn({},e),{},{isTemporary:!1}):t})})}),Nie(e=>{console.log("[SOCKET] Received notification:",e),console.log("[SOCKET] New message notification received but notifications are disabled")}),"admin"===(null===e||void 0===e?void 0:e.role)){const{data:e}=await ja.get("/fighters/roster");s(e||[])}else{const{data:{adminId:e}}=await ja.get("/auth/admin-id");console.log("[CLIENT] *** CRITICAL: Fighter received admin ID:",e),console.log("[CLIENT] *** This MUST be:","68bc3872c7f20dc76f9da534","for chat to work"),console.log("[CLIENT] *** IDs match:","68bc3872c7f20dc76f9da534"===e),i(e)}const{data:t}=await ja.get("/doubts");u(t),m(!1)}catch(gfe){console.error("Failed to initialize data:",gfe),b("Failed to load data"),m(!1)}}})(),()=>{Sie(),xie&&(xie.removeAllListeners("new_message"),xie.removeAllListeners("new_notification"),xie.removeAllListeners("users_updated"))}),[]);const P=(0,l.useCallback)((e,t)=>{var n,r;console.log("[NOTIFICATION] Showing for:",t,null===(n=e.text)||void 0===n?void 0:n.substring(0,30)),R&&Eie();const a={id:e._id,senderId:null===(r=e.user)||void 0===r?void 0:r._id,senderName:t,text:e.text,timestamp:new Date(e.timestamp),messageType:e.messageType};I(a),A(e=>e.some(e=>e.id===a.id)?e:[a,...e.slice(0,9)]),setTimeout(()=>{I(null)},4e3)},[R,I,A]);(0,l.useEffect)(()=>{if(n&&c.length)return L.current&&clearTimeout(L.current),L.current=setTimeout(()=>{var e,t;const r=c[c.length-1];if(!((null===r||void 0===r||null===(e=r.user)||void 0===e||null===(t=e._id)||void 0===t?void 0:t.toString())===n._id.toString())&&r){var a;const e=(null===(a=r.user)||void 0===a?void 0:a.name)||"Unknown User";let t=!1;var i,o,s,l;if("private"===(null===h||void 0===h?void 0:h.type)&&r.recipientId)t=(null===h||void 0===h||null===(i=h.peer)||void 0===i||null===(o=i._id)||void 0===o?void 0:o.toString())===(null===(s=r.user)||void 0===s||null===(l=s._id)||void 0===l?void 0:l.toString());else"common"!==(null===h||void 0===h?void 0:h.type)||r.recipientId||(t=!0);const n=r.isRead||N.has(r._id);if(!t&&!n){T.some(e=>e.id===r._id)||P(r,e)}}},300),()=>{L.current&&clearTimeout(L.current)}},[c,n,h,T,N,P]);const M=(0,l.useCallback)(()=>{if(!n||!c.length)return{};const e={},t=n._id;if("admin"===n.role){o.forEach(n=>{const r=c.filter(e=>{var r,a,i;return(null===(r=e.user)||void 0===r||null===(a=r._id)||void 0===a?void 0:a.toString())===n._id.toString()&&(null===(i=e.recipientId)||void 0===i?void 0:i.toString())===t.toString()&&!e.isRead&&!N.has(e._id)}).length;r>0&&(e[n._id]=r)});const n=c.filter(e=>{var n,r;return!e.recipientId&&(null===(n=e.user)||void 0===n||null===(r=n._id)||void 0===r?void 0:r.toString())!==t.toString()&&!e.isRead&&!N.has(e._id)}).length;n>0&&(e.common=n)}else if(a){const n=c.filter(e=>{var n,r,i;return(null===(n=e.user)||void 0===n||null===(r=n._id)||void 0===r?void 0:r.toString())===a.toString()&&(null===(i=e.recipientId)||void 0===i?void 0:i.toString())===t.toString()&&!e.isRead&&!N.has(e._id)}).length;n>0&&(e[a]=n);const r=c.filter(e=>{var n,r;return!e.recipientId&&(null===(n=e.user)||void 0===n||null===(r=n._id)||void 0===r?void 0:r.toString())!==t.toString()&&!e.isRead&&!N.has(e._id)}).length;r>0&&(e.common=r)}return e},[n,c,o,a,N]),j=(0,l.useCallback)(()=>{if(!n||!c.length)return[];n._id;if("common"===(null===h||void 0===h?void 0:h.type)){const e=c.filter(e=>!e.recipient&&!e.recipientId&&e.isVisible).sort((e,t)=>new Date(e.timestamp)-new Date(t.timestamp));return e}if("private"===(null===h||void 0===h?void 0:h.type)){var e;const t=null===h||void 0===h||null===(e=h.peer)||void 0===e?void 0:e._id;if(!t)return[];const r=c.filter(e=>{var r,a,i,o,s;if(!e.isVisible)return!1;if(!e.recipient&&!e.recipientId)return!1;const l=null===(r=e.user)||void 0===r||null===(a=r._id)||void 0===a?void 0:a.toString(),c=(null===(i=e.recipient)||void 0===i||null===(o=i._id)||void 0===o?void 0:o.toString())||(null===(s=e.recipientId)||void 0===s?void 0:s.toString()),u=n._id.toString(),h=t.toString();return l===u&&c===h||l===h&&c===u}).sort((e,t)=>new Date(e.timestamp)-new Date(t.timestamp));return r}return[]},[c,h,n]),B=(0,l.useCallback)(()=>"common"===(null===h||void 0===h?void 0:h.type)?"doubt":"admin"===(null===n||void 0===n?void 0:n.role)?"clarity":"doubt",[h,n]),z=(0,l.useCallback)(async e=>{if(!n||!e.text.trim())return;const t={_id:"temp_"+Date.now(),text:e.text,messageType:e.messageType||"doubt",user:{_id:n._id,name:n.name},userModel:"admin"===n.role?"Admin":"Fighter",timestamp:new Date,isTemporary:!0};u(e=>[...e,t]);try{var r;const a={text:e.text,messageType:e.messageType||"doubt"};e.parentDoubt&&(a.parentDoubt=e.parentDoubt),"private"===(null===h||void 0===h?void 0:h.type)&&null!==h&&void 0!==h&&null!==(r=h.peer)&&void 0!==r&&r._id?(a.recipientId=h.peer._id,"admin"===n.role?console.log("[CLIENT] Admin sending CLARITY (answer) to fighter:",h.peer.name):console.log("[CLIENT] Fighter sending DOUBT (question) to admin")):console.log("[CLIENT] Sending common message"),console.log("[CLIENT] Message payload:",a);const{data:i}=await ja.post("/doubts",a);console.log("[CLIENT] Message saved:",i),u(e=>e.map(e=>e._id===t._id?fn(fn({},i),{},{isTemporary:!1}):e))}catch(gfe){console.error("Failed to send message:",gfe),b("Failed to send message"),u(e=>e.filter(e=>e._id!==t._id))}},[n,h]),W=(0,l.useCallback)(async e=>{if(e&&window.confirm("Are you sure you want to delete this message?"))try{await ja.delete("/doubts/".concat(e)),u(t=>t.filter(t=>t._id!==e))}catch(gfe){console.error("Failed to delete message:",gfe),b("Failed to delete message")}},[]);(0,l.useEffect)(()=>(O.current&&clearTimeout(O.current),O.current=setTimeout(()=>{const e=M();y(e);const t=Object.values(e).reduce((e,t)=>e+t,0);document.title=t>0?"(".concat(t,") Chat App"):"Chat App"},300),()=>{O.current&&clearTimeout(O.current)}),[c,n,o,a,w,N,M]);const U={currentUser:n,setCurrentUser:r,adminId:a,setAdminId:i,fighters:o,setFighters:s,messages:c,setMessages:u,activeChat:h,setActiveChat:d,newMessage:f,setNewMessage:p,loading:g,setLoading:m,error:v,setError:b,unreadCounts:x,setUnreadCounts:y,lastSeenMessages:w,setLastSeenMessages:k,readMessages:N,setReadMessages:S,replyingTo:C,setReplyingTo:E,handleSendMessage:z,handleDeleteMessage:W,getFilteredMessages:j,getNextMessageType:B,notification:_,setNotification:I,notifications:T,setNotifications:A,notificationsEnabled:R,setNotificationsEnabled:D};return e?(0,Ba.jsx)(Iie,fn({},U)):(0,Ba.jsx)(_ie,fn({},U))},Aie=e=>{var t;let{user:n,fighterData:r}=e;const[a,i]=(0,l.useState)(!r),o=le();(0,l.useEffect)(()=>{r&&i(!1)},[r]);const s=()=>{localStorage.removeItem("token"),o("/"),window.location.reload()};if(a)return(0,Ba.jsx)("div",{className:"min-h-[50vh] flex items-center justify-center",children:(0,Ba.jsxs)("div",{className:"text-center",children:[(0,Ba.jsx)("div",{className:"w-16 h-16 border-4 border-red-500/50 border-t-red-500 rounded-full animate-spin mx-auto mb-4"}),(0,Ba.jsx)("p",{className:"text-gray-300 text-lg font-light tracking-widest animate-pulse",children:"SYNCING DATA..."})]})});if(!r)return(0,Ba.jsx)("div",{className:"min-h-[50vh] flex flex-col items-center justify-center p-8 text-center",children:(0,Ba.jsxs)("div",{className:"glass-panel rounded-3xl p-10 max-w-md w-full",children:[(0,Ba.jsx)("h1",{className:"text-3xl font-bold text-red-400 mb-4",children:"Profile Not Found"}),(0,Ba.jsx)("p",{className:"text-gray-300 mb-8 font-light",children:"Please contact the administrator to initialize your fighter profile."}),(0,Ba.jsx)("button",{onClick:s,className:"w-full py-3.5 bg-red-600 hover:bg-red-500 text-white font-bold rounded-xl shadow-lg hover:shadow-red-500/30 transition-all duration-300",children:"Logout"})]})});return(0,Ba.jsxs)("div",{className:"space-y-8",children:[(0,Ba.jsxs)("div",{className:"glass-panel p-8 rounded-3xl relative overflow-hidden group flex flex-col justify-center items-center text-center",children:[(0,Ba.jsx)("div",{className:"absolute top-0 right-0 p-8 opacity-5 transform translate-x-10 -translate-y-10",children:(0,Ba.jsx)("svg",{className:"w-64 h-64 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:(0,Ba.jsx)("path",{d:"M19 5h-2V3H7v2H5c-1.1 0-2 .9-2 2v1c0 2.55 1.92 4.63 4.39 4.94.63 1.5 1.98 2.63 3.61 2.96V19H7v2h10v-2h-4v-3.1c1.63-.33 2.98-1.46 3.61-2.96C19.08 12.63 21 10.55 21 8V7c0-1.1-.9-2-2-2zM7 8c0-1.66 1.34-3 3-3v6c-1.66 0-3-1.34-3-3zm10 0c-1.66 0-3 1.34-3 3V5c1.66 0 3 1.34 3 3z"})})}),(0,Ba.jsxs)("div",{className:"relative z-10 max-w-3xl mx-auto py-2",children:[(0,Ba.jsx)("h3",{className:"text-red-400 font-bold text-xs tracking-[0.2em] uppercase mb-4 animate-pulse",children:"Daily Focus"}),(0,Ba.jsxs)("p",{className:"text-2xl md:text-3xl text-white font-serif italic leading-relaxed text-shadow-sm",children:['"',(()=>{const e=["Champions aren't made in gyms. Champions are made from something deep inside them.","The only bad workout is the one that didn't happen.","Success isn't always about greatness. It's about consistency.","Your body can do it\u2014it's your mind you need to convince.","Don't stop when you're tired. Stop when you're done.","Discipline is doing what needs to be done, even if you don't want to do it."];return e[Math.floor(Math.random()*e.length)]})(),'"']})]})]}),(0,Ba.jsx)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[{label:"RFID",value:r.rfid,color:"blue"},{label:"Age",value:r.age,color:"green"},{label:"Height",value:r.height,color:"purple"},{label:"Weight",value:r.weight,color:"red"}].map((e,t)=>(0,Ba.jsx)("div",{className:"relative overflow-hidden rounded-2xl p-5 border transition-all duration-300 hover:-translate-y-1\n                        ".concat("blue"===e.color?"bg-blue-600/10 border-blue-500/20 hover:bg-blue-600/20":"","\n                        ").concat("green"===e.color?"bg-green-600/10 border-green-500/20 hover:bg-green-600/20":"","\n                        ").concat("purple"===e.color?"bg-purple-600/10 border-purple-500/20 hover:bg-purple-600/20":"","\n                        ").concat("red"===e.color?"bg-red-600/10 border-red-500/20 hover:bg-red-600/20":"","\n                        backdrop-blur-md"),children:(0,Ba.jsxs)("div",{className:"relative z-10",children:[(0,Ba.jsx)("div",{className:"".concat("RFID"===e.label?"text-xl md:text-2xl":"text-2xl md:text-3xl"," font-black text-white mb-1 truncate"),children:e.value||"N/A"}),(0,Ba.jsx)("div",{className:"text-xs font-bold uppercase tracking-wider\n                                ".concat("blue"===e.color?"text-blue-400":"","\n                                ").concat("green"===e.color?"text-green-400":"","\n                                ").concat("purple"===e.color?"text-purple-400":"","\n                                ").concat("red"===e.color?"text-red-400":"","\n                            "),children:e.label})]})},t))}),(0,Ba.jsxs)("div",{className:"glass-panel rounded-3xl p-8 hover:bg-white/5 transition-all duration-300",children:[(0,Ba.jsxs)("div",{className:"flex items-center justify-between mb-8 pb-4 border-b border-white/10",children:[(0,Ba.jsxs)("h2",{className:"text-xl md:text-2xl font-bold text-white flex items-center gap-3",children:[(0,Ba.jsx)("span",{className:"w-1.5 h-8 bg-blue-500 rounded-full shadow-[0_0_10px_rgba(59,130,246,0.5)]"}),"Personal Info"]}),(0,Ba.jsx)("span",{className:"hidden md:block px-4 py-1.5 bg-blue-500/10 text-blue-300 rounded-full text-xs font-bold border border-blue-500/20",children:"BIO DATA"})]}),(0,Ba.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[{label:"NAME",value:r.name},{label:"BATCH NO",value:r.fighterBatchNo},{label:"GENDER",value:r.gender},{label:"PHONE",value:r.phNo},{label:"ADDRESS",value:r.address,full:!0}].map((e,t)=>(0,Ba.jsxs)("div",{className:"p-5 rounded-2xl bg-black/20 border border-white/5 hover:border-white/10 transition-colors ".concat(e.full?"md:col-span-2 lg:col-span-3":""),children:[(0,Ba.jsx)("strong",{className:"text-xs font-bold text-blue-400 uppercase tracking-wider block mb-2",children:e.label}),(0,Ba.jsx)("p",{className:"text-lg text-white font-medium",children:e.value||"-"})]},t))})]}),(0,Ba.jsxs)("div",{className:"glass-panel rounded-3xl p-8 hover:bg-white/5 transition-all duration-300",children:[(0,Ba.jsxs)("div",{className:"flex items-center justify-between mb-8 pb-4 border-b border-white/10",children:[(0,Ba.jsxs)("h2",{className:"text-xl md:text-2xl font-bold text-white flex items-center gap-3",children:[(0,Ba.jsx)("span",{className:"w-1.5 h-8 bg-green-500 rounded-full shadow-[0_0_10px_rgba(34,197,94,0.5)]"}),"Fighter Stats"]}),(0,Ba.jsx)("span",{className:"hidden md:block px-4 py-1.5 bg-green-500/10 text-green-300 rounded-full text-xs font-bold border border-green-500/20",children:"METRICS"})]}),(0,Ba.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[{label:"Blood Group",value:r.bloodGroup},{label:"Occupation",value:r.occupation},{label:"Date of Joining",value:r.dateOfJoining?new Date(r.dateOfJoining).toLocaleDateString():"-"},{label:"Package",value:r.package},{label:"Experience",value:r.previousExperience},{label:"Medical Issue",value:r.medicalIssue},{label:"Motto",value:r.motto,full:!0},{label:"Martial Arts Knowledge",value:r.martialArtsKnowledge,full:!0}].map((e,t)=>(0,Ba.jsxs)("div",{className:"p-5 rounded-2xl bg-black/20 border border-white/5 hover:border-white/10 transition-colors ".concat(e.full?"md:col-span-2 lg:col-span-3":""),children:[(0,Ba.jsx)("strong",{className:"text-xs font-bold text-green-400 uppercase tracking-wider block mb-2",children:e.label}),(0,Ba.jsx)("p",{className:"text-lg text-white font-medium",children:e.value||"-"})]},t))})]}),(0,Ba.jsxs)("div",{className:"glass-panel rounded-3xl p-8 hover:bg-white/5 transition-all duration-300",children:[(0,Ba.jsxs)("div",{className:"flex items-center justify-between mb-8 pb-4 border-b border-white/10",children:[(0,Ba.jsxs)("h2",{className:"text-xl md:text-2xl font-bold text-white flex items-center gap-3",children:[(0,Ba.jsx)("span",{className:"w-1.5 h-8 bg-purple-500 rounded-full shadow-[0_0_10px_rgba(168,85,247,0.5)]"}),"Goals & Achievements"]}),(0,Ba.jsx)("span",{className:"hidden md:block px-4 py-1.5 bg-purple-500/10 text-purple-300 rounded-full text-xs font-bold border border-purple-500/20",children:"VISION"})]}),(0,Ba.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Ba.jsxs)("div",{className:"p-6 rounded-2xl bg-black/20 border border-white/5 hover:border-white/10 transition-colors",children:[(0,Ba.jsx)("strong",{className:"text-xs font-bold text-purple-400 uppercase tracking-wider block mb-3",children:"My Goals"}),(0,Ba.jsx)("p",{className:"text-lg text-white font-medium leading-relaxed",children:(null===(t=r.goals)||void 0===t?void 0:t.length)>0?r.goals.join(", "):"No specific goals set yet."})]}),(0,Ba.jsxs)("div",{className:"p-6 rounded-2xl bg-black/20 border border-white/5 hover:border-white/10 transition-colors",children:[(0,Ba.jsx)("strong",{className:"text-xs font-bold text-purple-400 uppercase tracking-wider block mb-3",children:"Referral Source"}),(0,Ba.jsx)("p",{className:"text-lg text-white font-medium",children:r.referral||"Not specified"})]}),r.achievements&&(0,Ba.jsx)("div",{className:"md:col-span-2 p-6 rounded-2xl bg-gradient-to-r from-yellow-500/10 to-transparent border border-yellow-500/20 backdrop-blur-sm",children:(0,Ba.jsxs)("div",{className:"flex gap-4",children:[(0,Ba.jsx)("div",{className:"mt-1 p-2 bg-yellow-500/20 rounded-lg text-yellow-400 h-fit",children:(0,Ba.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Ba.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("strong",{className:"text-sm font-bold text-yellow-400 uppercase tracking-wider block mb-1",children:"Achievements"}),(0,Ba.jsx)("p",{className:"text-lg text-gray-200 font-medium",children:r.achievements})]})]})})]})]})]})},Rie=e=>{let{fighterData:t}=e;const[n,r]=(0,l.useState)(t||null),[a,i]=(0,l.useState)(null),[o,s]=(0,l.useState)(!0),[c,u]=(0,l.useState)(null),h=["stance","jab","straight","left_hook","right_hook","thigh_kick","rib_kick","face_slap_kick","inner_kick","outer_kick","front_kick","rise_kick","boxing_movements","push_ups","cambo"],d=["stamina","speed","flexibility","power","martial_arts_knowledge","discipline"];(0,l.useEffect)(()=>{(async()=>{try{try{const e=await ja.get("/subscriptions/me");i(e.data)}catch(a){console.warn("Could not fetch subscription",a)}if(t)r(t),s(!1);else{const e=await ja.get("/fighters/me");r(e.data),s(!1)}}catch(gfe){var e,n;if(console.error("Error fetching data:",gfe),!t)401===(null===(e=gfe.response)||void 0===e?void 0:e.status)||403===(null===(n=gfe.response)||void 0===n?void 0:n.status)?u("Please log in to view your level progress"):u("Failed to load data.");s(!1)}})();const e=setInterval(async()=>{if(!t)try{const e=await ja.get("/fighters/me");r(e.data)}catch(ci){console.error("Polling error",ci)}},3e3);return()=>clearInterval(e)},[t]);const f=(()=>{if(!n||!n.assessment)return{overallProgress:0,tribeLevel:0,technicalProgress:0,skillProgress:0,specialGradeScore:0};const e=n.assessment;let t=0,r=0,a=0;h.forEach(n=>{const i=e[n]||{};parseInt(i.masterScore)>0&&(t+=parseInt(i.fighterScore)||0,r+=parseInt(i.masterScore)||0,a++)});const i=r>0?Math.min(100,Math.round(t/r*100)):0;let o=0,s=0,l=0;d.forEach(t=>{const n=e[t]||{};parseInt(n.masterScore)>0&&(o+=parseInt(n.fighterScore)||0,s+=parseInt(n.masterScore)||0,l++)});const c=s>0?Math.min(100,Math.round(o/s*100)):0,u=a+l>0?Math.min(100,Math.round((i*a+c*l)/(a+l))):0,f=parseInt(e.specialGradeScore)||0;return{overallProgress:u,tribeLevel:Math.min(100,Math.max(0,f)),technicalProgress:i,skillProgress:c,specialGradeScore:f}})(),p=a&&new Date(a.endDate)<new Date,g=e=>{let{percentage:t,label:n,size:r=120}=e;const a=(r-8)/2,i=2*a*Math.PI,o=i-Math.min(100,t)/100*i;let s="text-green-500";return t<30?s="text-red-500":t<70&&(s="text-yellow-500"),(0,Ba.jsxs)("div",{className:"flex flex-col items-center",children:[(0,Ba.jsxs)("div",{className:"relative",children:[(0,Ba.jsxs)("svg",{width:r,height:r,className:"transform -rotate-90 drop-shadow-lg",children:[(0,Ba.jsx)("circle",{cx:r/2,cy:r/2,r:a,stroke:"currentColor",strokeWidth:8,fill:"transparent",className:"text-white/10"}),(0,Ba.jsx)("circle",{cx:r/2,cy:r/2,r:a,stroke:"currentColor",strokeWidth:8,fill:"transparent",strokeDasharray:i,strokeDashoffset:o,className:"".concat(s," transition-all duration-1000 ease-out"),strokeLinecap:"round"})]}),(0,Ba.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,Ba.jsxs)("span",{className:"text-2xl font-bold text-white drop-shadow-md",children:[t,"%"]})})]}),(0,Ba.jsx)("span",{className:"mt-3 text-sm font-bold text-gray-300 tracking-wider uppercase",children:n})]})},m=e=>{let{label:t,percentage:n}=e,r="from-green-400 to-green-600";return n<30?r="from-red-400 to-red-600":n<70&&(r="from-yellow-400 to-yellow-600"),(0,Ba.jsxs)("div",{className:"mb-5",children:[(0,Ba.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,Ba.jsx)("span",{className:"text-sm font-bold text-gray-300",children:t}),(0,Ba.jsxs)("span",{className:"text-sm font-bold text-white",children:[n,"%"]})]}),(0,Ba.jsx)("div",{className:"w-full bg-black/30 rounded-full h-3 backdrop-blur-sm border border-white/5",children:(0,Ba.jsx)("div",{className:"h-3 rounded-full bg-gradient-to-r ".concat(r," transition-all duration-1000 ease-out shadow-[0_0_10px_rgba(255,255,255,0.2)]"),style:{width:"".concat(Math.min(100,n),"%")}})})]})};return o?(0,Ba.jsxs)("div",{className:"glass-panel p-8 rounded-3xl text-center",children:[(0,Ba.jsx)("div",{className:"w-12 h-12 border-4 border-white/20 border-t-white rounded-full animate-spin mx-auto mb-4"}),(0,Ba.jsx)("p",{className:"text-gray-300 animate-pulse",children:"Analyzing combat data..."})]}):c?(0,Ba.jsx)("div",{className:"glass-panel p-8 rounded-3xl text-center border-red-500/30",children:(0,Ba.jsx)("p",{className:"text-red-400 font-bold",children:c})}):n&&n.assessment?(0,Ba.jsxs)("div",{className:"space-y-6",children:[a&&(0,Ba.jsxs)("div",{className:"glass-panel p-6 rounded-3xl relative overflow-hidden group hover:bg-white/5 transition-all duration-300",children:[(0,Ba.jsx)("div",{className:"absolute -right-6 -top-6 text-white/5 transform rotate-12 group-hover:scale-110 transition-transform duration-500",children:(0,Ba.jsx)(kt,{size:120})}),(0,Ba.jsxs)("div",{className:"relative z-10",children:[(0,Ba.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("h3",{className:"text-gray-400 text-xs font-bold uppercase tracking-widest mb-1",children:"Current Membership"}),(0,Ba.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ba.jsx)("h2",{className:"text-2xl font-bold text-white",children:a.planName||"Standard Plan"}),p?(0,Ba.jsx)("span",{className:"bg-red-500/20 text-red-300 text-xs px-2 py-0.5 rounded border border-red-500/30",children:"EXPIRED"}):(0,Ba.jsx)("span",{className:"bg-green-500/20 text-green-300 text-xs px-2 py-0.5 rounded border border-green-500/30",children:"ACTIVE"})]})]}),(0,Ba.jsx)("div",{className:"text-right",children:(0,Ba.jsxs)("p",{className:"text-xl font-bold text-yellow-400",children:["\u20b9",a.amount]})})]}),(0,Ba.jsxs)("div",{className:"grid grid-cols-2 gap-4 mt-4 bg-black/20 p-4 rounded-xl border border-white/5 backdrop-blur-md",children:[(0,Ba.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Ba.jsx)("div",{className:"p-2 bg-blue-500/20 rounded-lg text-blue-400",children:(0,Ba.jsx)(ht,{})}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("p",{className:"text-gray-400 text-[10px] uppercase font-bold",children:"Expires On"}),(0,Ba.jsx)("p",{className:"text-sm font-bold ".concat(p?"text-red-400":"text-white"),children:new Date(a.endDate).toLocaleDateString()})]})]}),(0,Ba.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Ba.jsx)("div",{className:"p-2 bg-purple-500/20 rounded-lg text-purple-400",children:(0,Ba.jsx)(ct,{})}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("p",{className:"text-gray-400 text-[10px] uppercase font-bold",children:"Status"}),(0,Ba.jsx)("p",{className:"text-sm font-bold text-white",children:p?"Renew Now":"".concat(Math.ceil((new Date(a.endDate)-new Date)/864e5)," Days Left")})]})]})]})]})]}),(0,Ba.jsxs)("div",{className:"glass-panel p-6 md:p-8 rounded-3xl",children:[(0,Ba.jsxs)("div",{className:"mb-8 flex flex-col md:flex-row justify-between items-center gap-4",children:[(0,Ba.jsxs)("div",{children:[(0,Ba.jsxs)("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[(0,Ba.jsx)("span",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),"Combat Proficiency"]}),(0,Ba.jsx)("p",{className:"text-gray-400 text-xs uppercase tracking-wider mt-1",children:"Real-time Assessment Metrics"})]}),(0,Ba.jsxs)("div",{className:"px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-800 rounded-xl border border-blue-400/30 shadow-lg shadow-blue-900/50",children:[(0,Ba.jsx)("span",{className:"block text-[10px] text-blue-200 uppercase font-bold text-center",children:"Special Grade"}),(0,Ba.jsx)("span",{className:"block text-2xl font-black text-white text-center",children:f.specialGradeScore})]})]}),(0,Ba.jsx)("div",{className:"flex flex-col items-center mb-10",children:(0,Ba.jsx)(g,{percentage:f.overallProgress,label:"Overall Fighter Rating",size:160})}),(0,Ba.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-8",children:[(0,Ba.jsxs)("div",{className:"bg-white/5 p-5 rounded-2xl border border-white/5 hover:bg-white/10 transition-colors",children:[(0,Ba.jsxs)("h4",{className:"font-bold text-blue-300 mb-4 flex items-center text-sm uppercase tracking-wider",children:[(0,Ba.jsx)("span",{className:"w-2 h-2 bg-blue-500 rounded-full mr-2 shadow-[0_0_8px_rgba(59,130,246,0.8)]"}),"Technical Skills"]}),(0,Ba.jsx)(m,{label:"Technique Mastery",percentage:f.technicalProgress})]}),(0,Ba.jsxs)("div",{className:"bg-white/5 p-5 rounded-2xl border border-white/5 hover:bg-white/10 transition-colors",children:[(0,Ba.jsxs)("h4",{className:"font-bold text-purple-300 mb-4 flex items-center text-sm uppercase tracking-wider",children:[(0,Ba.jsx)("span",{className:"w-2 h-2 bg-purple-500 rounded-full mr-2 shadow-[0_0_8px_rgba(168,85,247,0.8)]"}),"Physical Attributes"]}),(0,Ba.jsx)(m,{label:"Athletic Conditioning",percentage:f.skillProgress})]})]}),(0,Ba.jsxs)("div",{className:"pt-6 border-t border-white/10",children:[(0,Ba.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,Ba.jsxs)("h4",{className:"font-bold text-indigo-300 flex items-center text-sm uppercase tracking-wider",children:[(0,Ba.jsx)("span",{className:"w-2 h-2 bg-indigo-500 rounded-full mr-2"}),"Tribe Level"]}),(0,Ba.jsx)("span",{className:"text-xl font-black text-white",children:f.tribeLevel})]}),(0,Ba.jsx)("div",{className:"w-full bg-black/40 rounded-full h-4 border border-white/5",children:(0,Ba.jsx)("div",{className:"h-full rounded-full bg-gradient-to-r from-indigo-600 to-purple-600 transition-all duration-1000 ease-out relative overflow-hidden",style:{width:"".concat(Math.min(100,f.tribeLevel),"%")},children:(0,Ba.jsx)("div",{className:"absolute inset-0 bg-white/20 animate-[pulse_2s_infinite]"})})})]})]})]}):(0,Ba.jsxs)("div",{className:"glass-panel p-10 rounded-3xl text-center",children:[(0,Ba.jsx)("div",{className:"text-5xl mb-4",children:"\ud83d\udcca"}),(0,Ba.jsx)("h3",{className:"text-xl font-bold text-white mb-2",children:"No Assessment Data"}),(0,Ba.jsx)("p",{className:"text-gray-400",children:"Your skills have not been graded yet."})]})},Die=e=>{let{isOpen:t,onClose:n,profilePhoto:r,fighterName:a}=e;return t?(0,Ba.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex justify-center items-center z-50 p-4",children:(0,Ba.jsxs)("div",{className:"relative w-full max-w-2xl",children:[(0,Ba.jsx)("button",{onClick:n,className:"absolute top-4 right-4 text-white hover:text-gray-300 text-3xl z-10","aria-label":"Close",children:(0,Ba.jsx)(Qt,{})}),(0,Ba.jsxs)("div",{className:"bg-gray-800 rounded-xl shadow-2xl overflow-hidden",children:[(0,Ba.jsx)("div",{className:"p-4 bg-gradient-to-r from-red-700 to-red-900",children:(0,Ba.jsxs)("h3",{className:"text-xl font-bold text-white text-center flex items-center justify-center",children:[(0,Ba.jsx)(cn,{className:"mr-2"}),a,"'s Profile Photo"]})}),(0,Ba.jsx)("div",{className:"p-4 flex justify-center",children:r?(0,Ba.jsx)("img",{src:r,alt:"".concat(a,"'s profile"),className:"w-full max-h-[70vh] object-contain rounded-lg"}):(0,Ba.jsx)("div",{className:"w-full h-96 flex items-center justify-center text-gray-400 bg-gray-900 rounded-lg",children:(0,Ba.jsx)("span",{className:"text-lg",children:"No profile photo available"})})})]})]})}):null},Fie=e=>{var t;let{user:n}=e;const[r,a]=(0,l.useState)("dashboard"),[i,o]=(0,l.useState)(null),[s,c]=(0,l.useState)(!1),[u,h]=(0,l.useState)(null),d=le();(0,l.useEffect)(()=>{(async()=>{try{const e=await ja.get("/fighters/me");o(e.data)}catch(gfe){console.error("Error fetching fighter data:",gfe)}})()},[]);const f=()=>{const e=setTimeout(()=>{c(!0)},500);h(e)},p=()=>{u&&(clearTimeout(u),h(null))};return(0,Ba.jsxs)("div",{className:"min-h-screen relative bg-gray-900 pb-10 overflow-x-hidden text-gray-200 font-sans selection:bg-red-500 selection:text-white",children:[(0,Ba.jsxs)("div",{className:"fixed inset-0 z-0 pointer-events-none overflow-hidden",children:[(0,Ba.jsx)("div",{className:"absolute top-0 left-1/4 w-96 h-96 bg-red-600 rounded-full mix-blend-screen filter blur-[128px] opacity-20 animate-blob"}),(0,Ba.jsx)("div",{className:"absolute top-0 right-1/4 w-96 h-96 bg-blue-600 rounded-full mix-blend-screen filter blur-[128px] opacity-20 animate-blob animation-delay-2000"}),(0,Ba.jsx)("div",{className:"absolute -bottom-32 left-1/3 w-96 h-96 bg-purple-600 rounded-full mix-blend-screen filter blur-[128px] opacity-20 animate-blob animation-delay-4000"})]}),(0,Ba.jsx)("div",{className:"relative z-10 glass-panel rounded-b-[3rem] p-6 md:p-12 mb-8 border-t-0 border-x-0",children:(0,Ba.jsxs)("div",{className:"max-w-6xl mx-auto flex flex-col md:flex-row justify-between items-center gap-6",children:[(0,Ba.jsxs)("div",{className:"text-center md:text-left animate-fade-in w-full md:w-auto",children:[(0,Ba.jsxs)("h2",{className:"text-3xl md:text-5xl font-black tracking-tight mb-2 text-transparent bg-clip-text bg-gradient-to-r from-white to-gray-400 drop-shadow-sm",children:["Welcome, ",(0,Ba.jsx)("span",{className:"text-red-500 block md:inline",children:(null===n||void 0===n?void 0:n.name)||"Fighter"})]}),(0,Ba.jsx)("p",{className:"text-gray-300 mt-2 text-sm md:text-lg font-light tracking-wide",children:"Train hard. Fight easy. This is your command center."}),(0,Ba.jsxs)("div",{className:"mt-4 flex flex-wrap gap-2 md:gap-3 justify-center md:justify-start",children:[(0,Ba.jsx)("span",{className:"px-3 py-1 md:px-4 md:py-1.5 bg-red-500/20 border border-red-500/30 text-red-200 rounded-full text-xs md:text-sm font-medium backdrop-blur-md",children:"Fighter Portal"}),(0,Ba.jsxs)("span",{className:"px-3 py-1 md:px-4 md:py-1.5 bg-yellow-500/20 border border-yellow-500/30 text-yellow-200 rounded-full text-xs md:text-sm font-medium backdrop-blur-md",children:["Level ",(null===i||void 0===i||null===(t=i.assessment)||void 0===t?void 0:t.specialGradeScore)||"N/A"]})]})]}),i&&(0,Ba.jsxs)("div",{className:"relative group mt-4 md:mt-0",children:[(0,Ba.jsx)("div",{className:"w-24 h-24 md:w-36 md:h-36 rounded-full p-1 bg-gradient-to-br from-white/20 to-transparent backdrop-blur-md shadow-2xl cursor-pointer",onTouchStart:f,onTouchEnd:p,onTouchCancel:p,onMouseDown:f,onMouseUp:p,onMouseLeave:p,children:(0,Ba.jsx)("div",{className:"w-full h-full rounded-full overflow-hidden border-4 border-black/50 relative z-10",children:i.profilePhoto?(0,Ba.jsx)("img",{src:i.profilePhoto,alt:i.name,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"}):(0,Ba.jsx)("div",{className:"w-full h-full flex items-center justify-center text-gray-400 bg-gray-800",children:(0,Ba.jsx)("span",{className:"text-xs",children:"No Photo"})})})}),(0,Ba.jsx)("button",{onClick:()=>d("/fighter/profile/update"),className:"absolute bottom-0 right-0 md:bottom-1 md:right-1 bg-red-600/90 hover:bg-red-500 text-white p-2 md:p-2.5 rounded-full shadow-lg backdrop-blur-sm border border-white/20 transition-transform transform group-hover:scale-110 z-20",title:"Update Profile",children:(0,Ba.jsx)(rn,{className:"text-sm md:text-base"})}),(0,Ba.jsx)("div",{className:"absolute top-2 right-2 w-4 h-4 md:w-5 md:h-5 bg-green-500 rounded-full border-2 border-gray-900 shadow-[0_0_10px_rgba(34,197,94,0.6)] animate-pulse z-20"})]})]})}),(0,Ba.jsxs)("div",{className:"relative z-10 max-w-6xl mx-auto px-4",children:[(0,Ba.jsx)("div",{className:"flex justify-center mb-10 w-full",children:(0,Ba.jsxs)("div",{className:"bg-black/40 backdrop-blur-xl p-1.5 rounded-2xl border border-white/10 shadow-lg flex w-full max-w-md md:w-auto md:min-w-[400px]",children:[(0,Ba.jsxs)("button",{onClick:()=>a("dashboard"),className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-xl text-xs md:text-sm font-bold transition-all duration-300 ".concat("dashboard"===r?"bg-gradient-to-br from-red-600 to-red-800 text-white shadow-lg shadow-red-900/50 ring-1 ring-white/20":"text-gray-400 hover:text-white hover:bg-white/5"),children:[(0,Ba.jsx)(Lt,{className:"text-base md:text-lg"})," Dashboard"]}),(0,Ba.jsxs)("button",{onClick:()=>a("membership"),className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-xl text-xs md:text-sm font-bold transition-all duration-300 ".concat("membership"===r?"bg-gradient-to-br from-red-600 to-red-800 text-white shadow-lg shadow-red-900/50 ring-1 ring-white/20":"text-gray-400 hover:text-white hover:bg-white/5"),children:[(0,Ba.jsx)(kt,{className:"text-base md:text-lg"})," Membership"]})]})}),(0,Ba.jsx)("div",{className:"animate-fade-in-up",children:"dashboard"===r?(0,Ba.jsx)(Aie,{user:n,fighterData:i}):"membership"===r?(0,Ba.jsx)(Rie,{fighterData:i||n}):null})]}),(0,Ba.jsx)(Die,{isOpen:s,onClose:()=>c(!1),profilePhoto:null===i||void 0===i?void 0:i.profilePhoto,fighterName:null===i||void 0===i?void 0:i.name}),(0,Ba.jsx)("style",{jsx:!0,children:"\n                @keyframes fade-in-up {\n                    from { opacity: 0; transform: translateY(20px); }\n                    to { opacity: 1; transform: translateY(0); }\n                }\n                .animate-fade-in-up {\n                    animation: fade-in-up 0.6s cubic-bezier(0.16, 1, 0.3, 1);\n                }\n            "})]})},Oie=e=>{let{isOpen:t,onClose:n,onSubmit:r,loading:a}=e;const[i,o]=(0,l.useState)(""),[s,c]=(0,l.useState)(null),[u,h]=(0,l.useState)("");if(!t)return null;return(0,Ba.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-50 backdrop-blur-sm",children:(0,Ba.jsxs)("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl shadow-2xl p-6 w-full max-w-md mx-4 border border-gray-700",children:[(0,Ba.jsxs)("div",{className:"flex justify-between items-center border-b border-gray-700 pb-3 mb-4",children:[(0,Ba.jsxs)("h3",{className:"text-xl font-semibold text-white flex items-center",children:[(0,Ba.jsx)(Lt,{className:"mr-3 text-yellow-500"}),"Enter Your RFID"]}),(0,Ba.jsx)("button",{onClick:n,className:"text-gray-400 hover:text-white transition-colors duration-200",children:(0,Ba.jsx)(Qt,{size:20})})]}),(0,Ba.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),i){h("");const e=await(async()=>{if(!navigator.geolocation)return h("Geolocation is not supported by your browser."),null;try{const e=await new Promise((e,t)=>{navigator.geolocation.getCurrentPosition(t=>e(t),e=>t(e),{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})});return{latitude:e.coords.latitude,longitude:e.coords.longitude}}catch(e){let t="";switch(e.code){case e.PERMISSION_DENIED:t="Location access denied. Please enable location permissions for this site.";break;case e.POSITION_UNAVAILABLE:t="Location information is unavailable. Please check your device settings.";break;case e.TIMEOUT:t="Location request timed out. Please try again.";break;default:t="Unknown location error: ".concat(e.message)}return h(t),null}})();e||u||h("Could not get your location. Attendance will be marked without location verification."),r(i,e)}},children:[(0,Ba.jsx)("p",{className:"text-gray-300 mb-4",children:"Please enter your RFID code below to check your attendance status."}),(0,Ba.jsx)("input",{type:"text",value:i,onChange:e=>o(e.target.value),className:"w-full px-4 py-3 bg-gray-700 text-white border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500 transition-all duration-200",placeholder:"RFID Code",autoFocus:!0}),u&&(0,Ba.jsx)("div",{className:"mt-3 p-3 bg-red-900 bg-opacity-50 border border-red-700 rounded-lg",children:(0,Ba.jsx)("p",{className:"text-red-300 text-sm",children:u})}),(0,Ba.jsxs)("div",{className:"flex justify-end mt-6 space-x-4",children:[(0,Ba.jsx)("button",{type:"button",onClick:n,className:"px-6 py-2 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 hover:text-white transition-all duration-200",children:"Cancel"}),(0,Ba.jsx)("button",{type:"submit",disabled:!i||a,className:"px-6 py-2 bg-gradient-to-r from-yellow-600 to-yellow-800 text-white rounded-lg hover:from-yellow-700 hover:to-yellow-900 disabled:from-yellow-800 disabled:to-yellow-900 flex items-center transition-all duration-200",children:a?(0,Ba.jsxs)(Ba.Fragment,{children:[(0,Ba.jsx)(Xt,{className:"animate-spin mr-2"}),"Checking..."]}):"Check Status"})]})]})]})})},Lie=e=>{let{isOpen:t,onClose:n,onConfirm:r,data:a}=e;if(!t||!a)return null;const{punchType:i,fighter:o}=a,s="in"===i;return(0,Ba.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex justify-center items-center z-50",children:(0,Ba.jsxs)("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-sm mx-4 text-center",children:[(0,Ba.jsx)("div",{className:"flex justify-end",children:(0,Ba.jsx)("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:(0,Ba.jsx)(Qt,{size:20})})}),(0,Ba.jsx)(tn,{className:"text-6xl text-green-500 mx-auto mb-4"}),(0,Ba.jsx)("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:o.name}),(0,Ba.jsx)("p",{className:"text-md text-gray-500 mb-6",children:o.fighterBatchNo}),(0,Ba.jsx)("div",{className:"p-4 rounded-lg mb-6 ".concat(s?"bg-green-100":"bg-red-100"),children:(0,Ba.jsxs)("p",{className:"text-lg font-semibold flex items-center justify-center",children:[s?(0,Ba.jsx)(qt,{className:"mr-3 text-green-600"}):(0,Ba.jsx)(Kt,{className:"mr-3 text-red-600"}),(0,Ba.jsxs)("span",{className:s?"text-green-800":"text-red-800",children:["Confirm Punch ",s?"IN":"OUT"]})]})}),(0,Ba.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,Ba.jsx)("button",{onClick:n,className:"px-8 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300",children:"Cancel"}),(0,Ba.jsx)("button",{onClick:r,className:"px-8 py-2 text-white rounded-lg ".concat(s?"bg-green-500 hover:bg-green-600":"bg-red-500 hover:bg-red-600"),children:"Confirm"})]})]})})},Pie=()=>{const[e,t]=(0,l.useState)([]),[n,r]=(0,l.useState)(!0),[a,i]=(0,l.useState)(!1),[o,s]=(0,l.useState)(""),[c,u]=(0,l.useState)(!1),[h,d]=(0,l.useState)(""),f=le(),[p,g]=(0,l.useState)(!1),[m,v]=(0,l.useState)(!1),[b,x]=(0,l.useState)(null),y=async()=>{r(!0);try{const e=h?"/attendance/me?date=".concat(h):"/attendance/me",{data:n}=await ja.get(e);t(n)}catch(e){console.error("Error fetching attendance:",e),s("Failed to load attendance data.")}finally{r(!1)}};(0,l.useEffect)(()=>{y()},[h]);const w=async e=>{e&&e.preventDefault(),console.log("Punch initiated..."),i(!0),s("Acquiring Location...");try{let e=null;try{if(!1===window.isSecureContext)console.warn("Geolocation requires HTTPS. Skipping location.");else{const t=await new Promise((e,t)=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(t=>{e(t)},e=>{t(e)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0}):t(new Error("Geolocation is not supported by your browser"))}),{latitude:n,longitude:r,accuracy:a}=t.coords;console.log("Location acquired:",n,r),e={latitude:n,longitude:r},a>1e3&&console.warn("GPS signal is weak.")}}catch(r){console.warn("Location error:",r),e=null}s("Sending Punch...");const{data:t}=await ja.post("/attendance/punch",{location:e});console.log("Punch response:",t),s(t.msg),await y()}catch(gfe){var t,n;console.error("Punch API Error:",gfe);const r=(null===(t=gfe.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.msg)||"An error occurred during punch.";r.includes("subscription has expired")?u(!0):s("Error: ".concat(r))}finally{i(!1)}};return(0,Ba.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 to-gray-800 p-4 sm:p-6 lg:p-8",children:[(0,Ba.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 border-b border-gray-700 pb-4 gap-4",children:[(0,Ba.jsx)("h1",{className:"text-3xl font-bold text-white",children:"My Attendance"}),(0,Ba.jsxs)("div",{className:"flex items-center gap-2 bg-gray-800 p-2 rounded-lg border border-gray-600",children:[(0,Ba.jsx)(ht,{className:"text-gray-400 ml-2"}),(0,Ba.jsx)("input",{type:"date",value:h,onChange:e=>d(e.target.value),className:"bg-transparent text-white border-none outline-none text-sm font-medium",placeholder:"Filter by Date"}),h&&(0,Ba.jsx)("button",{onClick:()=>d(""),className:"text-gray-400 hover:text-white p-1",title:"Clear Date Filter",children:(0,Ba.jsx)(Qt,{})})]})]}),c&&(0,Ba.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4",children:(0,Ba.jsx)("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl border border-red-500/30 shadow-2xl max-w-md w-full p-6",children:(0,Ba.jsxs)("div",{className:"text-center",children:[(0,Ba.jsx)("div",{className:"w-16 h-16 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,Ba.jsx)(Et,{className:"text-red-400 text-2xl"})}),(0,Ba.jsx)("h3",{className:"text-xl font-bold text-white mb-2",children:"Subscription Expired"}),(0,Ba.jsx)("p",{className:"text-gray-300 mb-6",children:"Your subscription has expired. Please renew your membership to continue using the attendance system."}),(0,Ba.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[(0,Ba.jsx)("button",{onClick:()=>u(!1),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg font-medium transition-colors",children:"Close"}),(0,Ba.jsx)("button",{onClick:()=>{u(!1),f("/fighter")},className:"px-4 py-2 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white rounded-lg font-medium transition-all",children:"View Membership"})]})]})})}),(0,Ba.jsxs)("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 shadow-2xl rounded-2xl p-6 mb-8 border border-gray-700",children:[(0,Ba.jsxs)("h2",{className:"text-2xl font-semibold text-white mb-4 flex items-center",children:[(0,Ba.jsx)(Lt,{className:"mr-3 text-red-400"}),"Record Your Attendance"]}),(0,Ba.jsxs)("div",{className:"flex flex-col sm:flex-row items-center gap-4",children:[(0,Ba.jsxs)("button",{type:"button",onClick:()=>g(!0),className:"w-full sm:w-auto bg-gradient-to-r from-yellow-600 to-yellow-800 hover:from-yellow-700 hover:to-yellow-900 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105 flex items-center justify-center text-sm shadow-lg",children:[(0,Ba.jsx)(Lt,{className:"mr-2"}),"RFID PUNCH"]}),(0,Ba.jsxs)("button",{type:"button",onClick:()=>f("/fighter/attendance/face"),className:"w-full sm:w-auto bg-gradient-to-r from-blue-600 to-blue-800 hover:from-blue-700 hover:to-blue-900 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105 flex items-center justify-center text-sm shadow-lg",children:[(0,Ba.jsx)(ft,{className:"mr-2"}),"FACE PUNCH"]}),(0,Ba.jsxs)("button",{type:"button",onClick:w,disabled:a,className:"w-full sm:w-auto bg-gradient-to-r from-red-600 to-red-800 hover:from-red-700 hover:to-red-900 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105 flex items-center justify-center text-sm shadow-lg disabled:opacity-50",children:[(0,Ba.jsx)(bt,{className:"mr-2"}),a?"PUNCHING...":"QUICK PUNCH"]})]}),o&&(0,Ba.jsx)("p",{className:"mt-6 text-center text-sm font-medium p-3 rounded-lg ".concat(o.includes("Error")||o.includes("too far")?"bg-red-900 text-red-300":"bg-green-900 text-green-300"),children:o})]}),(0,Ba.jsxs)("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 shadow-2xl rounded-2xl overflow-hidden border border-gray-700",children:[(0,Ba.jsx)("div",{className:"p-6 flex justify-between items-center",children:(0,Ba.jsxs)("h3",{className:"text-xl font-semibold text-white flex items-center",children:[(0,Ba.jsx)(bt,{className:"mr-3 text-red-400"}),h?"Records for ".concat(h):"Overall History"]})}),(0,Ba.jsx)("div",{className:"overflow-x-auto",children:n?(0,Ba.jsxs)("div",{className:"text-center p-8",children:[(0,Ba.jsx)("div",{className:"w-10 h-10 border-4 border-red-500 border-t-transparent rounded-full animate-spin mx-auto mb-2"}),(0,Ba.jsx)("p",{className:"text-gray-400",children:"Loading..."})]}):(0,Ba.jsxs)("table",{className:"min-w-full divide-y divide-gray-700",children:[(0,Ba.jsx)("thead",{className:"bg-gray-700",children:(0,Ba.jsxs)("tr",{children:[(0,Ba.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Date"}),(0,Ba.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Check-Ins"}),(0,Ba.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Check-Outs"}),(0,Ba.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Duration"})]})}),(0,Ba.jsx)("tbody",{className:"bg-gray-800 divide-y divide-gray-700",children:e.length>0?e.map(e=>{const t=e.checkIns?e.checkIns.filter(e=>!e.late):[],n=e.checkOuts?[...e.checkIns?e.checkIns.filter(e=>e.late):[],...e.checkOuts]:[];return(0,Ba.jsxs)("tr",{className:"hover:bg-gray-750 transition-colors duration-200",children:[(0,Ba.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-white",children:(()=>{const t=new Date(e.date),n=String(t.getDate()).padStart(2,"0"),r=String(t.getMonth()+1).padStart(2,"0"),a=t.getFullYear().toString().slice(-2);return"".concat(n,"/").concat(r,"/").concat(a)})()}),(0,Ba.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:t.map((e,t)=>(0,Ba.jsx)("span",{className:"block text-green-400 bg-green-900 bg-opacity-30 px-2 py-1 rounded mb-1 w-max",children:new Date(e.time).toLocaleTimeString()},t))}),(0,Ba.jsx)("td",{className:"px-5 py-3 whitespace-nowrap text-sm",children:n.map((e,t)=>(0,Ba.jsxs)("div",{className:"flex items-center gap-2 px-2 py-1 rounded w-max mb-1 ".concat(e.late?"bg-yellow-900 bg-opacity-30 text-yellow-300":"bg-red-900 bg-opacity-30 text-red-400"),children:[(0,Ba.jsx)("span",{children:new Date(e.time).toLocaleTimeString()}),e.late&&(0,Ba.jsx)(Et,{title:"Late Check-out"})]},t))}),(0,Ba.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-white",children:e.duration||"00:00:00"})]},e.id||e.date)}):(0,Ba.jsx)("tr",{children:(0,Ba.jsxs)("td",{colSpan:"5",className:"px-6 py-8 text-center text-sm text-gray-500",children:["No attendance records found ",h?"for ".concat(h):"","."]})})})]})})]}),p&&(0,Ba.jsx)(Oie,{isOpen:p,onClose:()=>g(!1),onSubmit:async(e,t)=>{i(!0),s("");try{const{data:n}=await ja.post("/attendance/rfid-status",{rfid:e,location:t});x(n),g(!1),v(!0)}catch(gfe){var n,r;const t=(null===(n=gfe.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.msg)||"An error occurred.";t.includes("subscription has expired")?u(!0):s("Error: ".concat(t)),g(!1)}finally{i(!1)}},loading:a}),m&&b&&(0,Ba.jsx)(Lie,{isOpen:m,onClose:()=>v(!1),onConfirm:async()=>{v(!1),await w()},data:b})]})},Mie=()=>{le();const[e,t]=(0,l.useState)({age:"",gender:"male",phNo:"",address:"",height:"",weight:"",bloodGroup:"",occupation:"",package:"monthly",previousExperience:"",medicalIssue:"",motto:"",martialArtsKnowledge:"",goals:[],referral:"",achievements:"",agreement:!1}),[n,r]=(0,l.useState)(""),a=e=>{const{name:n,value:r}=e.target;t(e=>fn(fn({},e),{},{[n]:r}))},i=e=>{const{value:n,checked:r}=e.target;t(e=>fn(fn({},e),{},r?{goals:[...e.goals,n]}:{goals:e.goals.filter(e=>e!==n)}))};return(0,Ba.jsxs)("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center p-4",children:[(0,Ba.jsxs)("div",{className:"max-w-4xl w-full bg-gray-800 text-white rounded-lg shadow-xl p-8",children:[(0,Ba.jsx)("h1",{className:"text-3xl font-bold text-center mb-6 text-red-500",children:"Complete Your Fighter Profile"}),(0,Ba.jsx)("p",{className:"text-center text-gray-400 mb-8",children:"Please fill out your details to access your dashboard."}),(0,Ba.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),e.agreement){r("");try{await ja.post("/fighters/profile",e),window.location.href="/fighter"}catch(gfe){var n,a;console.error("Profile update error:",gfe),r((null===(n=gfe.response)||void 0===n||null===(a=n.data)||void 0===a?void 0:a.msg)||"Failed to update profile. Please try again.")}}else r("You must agree to the terms and conditions to proceed.")},className:"space-y-8",children:[(0,Ba.jsxs)("div",{className:"p-6 bg-gray-700 rounded-lg",children:[(0,Ba.jsx)("h2",{className:"text-xl font-semibold mb-4 border-b border-gray-600 pb-2",children:"Personal Info"}),(0,Ba.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Ba.jsx)("input",{type:"number",name:"age",placeholder:"Age",onChange:a,required:!0,className:"input-style"}),(0,Ba.jsxs)("select",{name:"gender",onChange:a,className:"input-style",children:[(0,Ba.jsx)("option",{value:"male",children:"Male"}),(0,Ba.jsx)("option",{value:"female",children:"Female"}),(0,Ba.jsx)("option",{value:"other",children:"Other"})]}),(0,Ba.jsx)("input",{type:"tel",name:"phNo",placeholder:"Phone Number",onChange:a,required:!0,className:"input-style"}),(0,Ba.jsx)("input",{type:"text",name:"address",placeholder:"Address",onChange:a,required:!0,className:"input-style"})]})]}),(0,Ba.jsxs)("div",{className:"p-6 bg-gray-700 rounded-lg",children:[(0,Ba.jsx)("h2",{className:"text-xl font-semibold mb-4 border-b border-gray-600 pb-2",children:"Fighter Details"}),(0,Ba.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Ba.jsx)("input",{type:"text",name:"height",placeholder:"Height (cm)",onChange:a,required:!0,className:"input-style"}),(0,Ba.jsx)("input",{type:"text",name:"weight",placeholder:"Weight (kg)",onChange:a,required:!0,className:"input-style"}),(0,Ba.jsx)("input",{type:"text",name:"bloodGroup",placeholder:"Blood Group",onChange:a,className:"input-style"}),(0,Ba.jsx)("input",{type:"text",name:"occupation",placeholder:"Occupation",onChange:a,className:"input-style"}),(0,Ba.jsxs)("select",{name:"package",onChange:a,className:"input-style",children:[(0,Ba.jsx)("option",{value:"monthly",children:"Monthly"}),(0,Ba.jsx)("option",{value:"quarterly",children:"Quarterly"}),(0,Ba.jsx)("option",{value:"yearly",children:"Yearly"})]}),(0,Ba.jsx)("input",{type:"text",name:"previousExperience",placeholder:"Previous Martial Arts Experience?",onChange:a,className:"input-style"}),(0,Ba.jsx)("textarea",{name:"medicalIssue",placeholder:"Any Medical Issues?",onChange:a,className:"input-style md:col-span-2",rows:"2"}),(0,Ba.jsx)("textarea",{name:"motto",placeholder:"What is your Motto?",onChange:a,className:"input-style md:col-span-2",rows:"2"}),(0,Ba.jsx)("textarea",{name:"martialArtsKnowledge",placeholder:"Knowledge in Martial Arts",onChange:a,className:"input-style md:col-span-2",rows:"2"})]})]}),(0,Ba.jsxs)("div",{className:"p-6 bg-gray-700 rounded-lg",children:[(0,Ba.jsx)("h2",{className:"text-xl font-semibold mb-4 border-b border-gray-600 pb-2",children:"Goals & Referral"}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("label",{className:"block mb-2",children:"What are your goals?"}),(0,Ba.jsx)("div",{className:"flex flex-wrap gap-4",children:["Fitness","Self-defense","Competition","Discipline"].map(e=>(0,Ba.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,Ba.jsx)("input",{type:"checkbox",value:e,onChange:i,className:"h-4 w-4 bg-gray-600 border-gray-500 rounded text-red-500 focus:ring-red-500"}),(0,Ba.jsx)("span",{children:e})]},e))})]}),(0,Ba.jsx)("input",{type:"text",name:"referral",placeholder:"How did you hear about us?",onChange:a,className:"input-style mt-4"})]}),(0,Ba.jsxs)("div",{className:"p-6 bg-gray-700 rounded-lg",children:[(0,Ba.jsxs)("div",{className:"flex items-center mb-4 border-b border-gray-600 pb-2",children:[(0,Ba.jsx)(Bt,{className:"text-yellow-400 mr-2",size:24}),(0,Ba.jsx)("h2",{className:"text-xl font-semibold",children:"Achievements"})]}),(0,Ba.jsx)("textarea",{name:"achievements",placeholder:"Your Achievements...",onChange:a,className:"input-style mt-2",rows:"3",value:e.achievements})]}),(0,Ba.jsx)("div",{className:"p-6 bg-gray-700 rounded-lg",children:(0,Ba.jsxs)("label",{className:"flex items-center space-x-3 cursor-pointer",children:[(0,Ba.jsx)("input",{type:"checkbox",checked:e.agreement,onChange:e=>{t(t=>fn(fn({},t),{},{agreement:e.target.checked}))},className:"h-5 w-5 bg-gray-600 border-gray-500 rounded text-red-500 focus:ring-red-500"}),(0,Ba.jsx)("span",{className:"text-gray-300",children:"I agree to the terms and conditions and the gym's code of conduct."})]})}),n&&(0,Ba.jsx)("p",{className:"text-red-400 text-center",children:n}),(0,Ba.jsx)("button",{type:"submit",className:"w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-4 rounded-lg transition duration-300",children:"Submit Profile"})]})]}),(0,Ba.jsx)("style",{children:"\n                .input-style {\n                    background-color: #4A5568; /* gray-700 */\n                    border: 1px solid #718096; /* gray-500 */\n                    color: white;\n                    padding: 0.75rem 1rem;\n                    border-radius: 0.5rem;\n                    width: 100%;\n                }\n                .input-style::placeholder {\n                    color: #A0AEC0; /* gray-400 */\n                }\n                .input-style:focus {\n                    outline: none;\n                    border-color: #F56565; /* red-500 */\n                    box-shadow: 0 0 0 2px #F56565;\n                }\n            "})]})};class jie{constructor(){this.modelsLoaded=!1,this.detectionCount=0,this.maxDetections=5,this.minConfidence=.95,this.matchThreshold=.4}async loadModels(){try{return await Promise.all([dw.ssdMobilenetv1.loadFromUri("/models"),dw.faceLandmark68Net.loadFromUri("/models"),dw.faceRecognitionNet.loadFromUri("/models")]),this.modelsLoaded=!0,!0}catch(e){return console.error("Error loading enhanced models:",e),!1}}async detectFace(e){if(!this.modelsLoaded)return null;try{const t=await Sx(e);return await Fw(t,new Ry({minConfidence:.95})).withFaceLandmarks().withFaceDescriptor()}catch(t){return console.error("High accuracy face detection error:",t),null}}async recognizeFace(e){try{let t=null;try{navigator.geolocation&&(t=await new Promise((e,t)=>{navigator.geolocation.getCurrentPosition(t=>{e({latitude:t.coords.latitude,longitude:t.coords.longitude})},t=>{console.warn("Location access denied or unavailable:",t.message),e(null)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})}))}catch(a){console.warn("Location error:",a)}const n=Array.from(e);console.log("Sending face descriptor to server, length:",n.length),console.log("First 5 elements:",n.slice(0,5));const r=await ja.post("/attendance/admin/face-recognition",{faceDescriptor:n,location:t});return{success:!0,message:r.data.msg||"Attendance marked successfully!",data:r.data}}catch(i){var t,n,r;const e=(null===(t=i.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.msg)||"Face verification failed. Please try again.";return{success:!1,message:e.includes("SECURITY ALERT")||e.includes("Face verification failed")||e.includes("Attendance NOT marked")?e:"Face verification failed. Please ensure good lighting and try again.",status:null===(r=i.response)||void 0===r?void 0:r.status}}}resetDetectionCount(){this.detectionCount=0}incrementDetectionCount(){return this.detectionCount++,this.detectionCount}}const Bie=()=>{const e=(0,l.useRef)(null),t=le(),[n,r]=(0,l.useState)(!0),[a,i]=(0,l.useState)("Loading enhanced face recognition models..."),[o,s]=(0,l.useState)("info"),[c,u]=(0,l.useState)(null),[h,d]=(0,l.useState)(0),[f,p]=(0,l.useState)(!1),[g,m]=(0,l.useState)(!1),[v,b]=(0,l.useState)(0),[x,y]=(0,l.useState)(!1),[w,k]=(0,l.useState)(!1),N=(0,l.useRef)(new jie).current,S=(0,l.useCallback)(async()=>{try{i("Loading enhanced JavaScript face recognition models..."),s("info"),_k().flagRegistry.GPGPU&&_k().set("WEBGL_FORCE_F16_TEXTURES",!0);await N.loadModels()?(i('Models loaded successfully. Click "Start Camera" to begin.'),s("info"),r(!1)):(i("Error loading models. Please refresh the page."),s("error"),r(!1))}catch(e){console.error("Error loading models:",e),i("Error loading models. Please refresh the page."),s("error"),r(!1)}},[N]),C=(0,l.useCallback)(async()=>{try{let t;i("Fetching gym settings..."),s("info");try{t=await ja.get("/settings")}catch(e){throw console.error("API Error Details:",e),e.response?(console.error("API Error Response:",e.response),new Error("Failed to fetch settings. Server responded with status ".concat(e.response.status,". Please check server logs."))):e.request?(console.error("API Error Request:",e.request),new Error("Failed to fetch settings. No response received from server. Please check if server is running.")):(console.error("API Error Message:",e.message),new Error("Failed to fetch settings. Error: ".concat(e.message)))}const n=t.data;if(!n||!n.location)throw new Error("Invalid settings data received from server. Please check server configuration.");if(!n.location.enabled)return k(!0),i("Location verification is disabled. Camera will activate."),s("info"),!0;if(i("Verifying your location against gym coordinates..."),s("info"),navigator.geolocation){i("Requesting your location..."),s("info");const e=await new Promise((e,t)=>{navigator.geolocation.getCurrentPosition(t=>{console.log("Geolocation success:",t),e({latitude:t.coords.latitude,longitude:t.coords.longitude})},e=>{console.error("Geolocation error:",e);let n="";switch(e.code){case e.PERMISSION_DENIED:n="Location access denied by user. Please enable location permissions for this site.";break;case e.POSITION_UNAVAILABLE:n="Location information is unavailable. Please check your device settings.";break;case e.TIMEOUT:n="Location request timed out. Please try again.";break;default:n="Unknown location error: ".concat(e.message)}t(new Error(n))},{enableHighAccuracy:!0,timeout:15e3,maximumAge:6e4})});if(i("Your location: ".concat(e.latitude.toFixed(6),", ").concat(e.longitude.toFixed(6))),s("info"),"number"!==typeof n.location.latitude||"number"!==typeof n.location.longitude)throw new Error("Invalid gym location coordinates in settings. Please check admin settings.");const t={latitude:n.location.latitude,longitude:n.location.longitude},r=((e,t)=>{const n=e=>e*Math.PI/180,r=n(e.latitude),a=n(t.latitude),i=n(t.latitude-e.latitude),o=n(t.longitude-e.longitude),s=Math.sin(i/2)*Math.sin(i/2)+Math.cos(r)*Math.cos(a)*Math.sin(o/2)*Math.sin(o/2);return 2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s))*6371e3})(e,t),a=n.location.radius||100;if(i("Gym location: ".concat(t.latitude.toFixed(6),", ").concat(t.longitude.toFixed(6),". Distance: ").concat(Math.round(r),"m. Required: <=").concat(a,"m")),s("info"),r<=a)return k(!0),i("Location verified successfully. You are ".concat(Math.round(r),"m from the gym.")),s("info"),!0;throw new Error("You are too far from the gym (".concat(Math.round(r),"m). Must be within ").concat(a,"m to mark attendance."))}throw new Error("Geolocation is not supported by your browser.")}catch(t){return console.error("Location verification error:",t),i("SECURITY ALERT: Location verification failed. ".concat(t.message," Attendance NOT marked.")),s("error"),!1}},[]),E=(0,l.useCallback)(async()=>{if(!f&&e.current&&N.modelsLoaded&&x)try{const t=e.current.getScreenshot();if(!t)return;const n=await N.detectFace(t);if(n){console.log("Face detection successful:",n),n.descriptor?console.log("Face descriptor length:",n.descriptor.length):console.log("No descriptor in detections");const e=N.incrementDetectionCount();e>=N.maxDetections?(i("High accuracy verification in progress..."),console.log("Calling verifyFace with descriptor length:",n.descriptor.length),_(n.descriptor),N.resetDetectionCount()):(i("Face detected (".concat(e,"/").concat(N.maxDetections,") for high accuracy. Keep still...")),s("info"))}else N.resetDetectionCount(),i("No face detected. Ensure good lighting and position your face in the frame.")}catch(t){console.error("High accuracy face detection error:",t)}},[f,N,x]),_=(0,l.useCallback)(async e=>{if(!f){console.log("verifyFace called with descriptor length:",e.length),p(!0),i("Verifying face with enhanced accuracy... Please wait."),s("info"),b(0);try{const n=setInterval(()=>{b(e=>e>=90?(clearInterval(n),90):e+10)},200),r=await N.recognizeFace(e);if(clearInterval(n),b(100),r.success)i(r.message),s("success"),setTimeout(()=>{t("/fighter/attendance")},3e3);else{if(400===r.status)if(r.message.includes("Face verification failed"))i("SECURITY ALERT: Face verification failed. Your face does not match the registered face. Attendance NOT marked."),s("error");else{const e=r.message||"Attendance can only be marked once every 2 minutes.";i(e),s("error"),d(120)}else 404===r.status?(i("Face verification failed. Please ensure your face is registered in your profile."),s("error")):(i(r.message),s("error"));setTimeout(()=>{b(0)},3e3)}}finally{setTimeout(()=>{p(!1)},3e3)}}},[f,N,t]),I=(0,l.useCallback)(()=>{c&&clearInterval(c);const e=setInterval(()=>{E()},800);u(e)},[E]),T=(0,l.useCallback)(()=>{c&&(clearInterval(c),u(null))},[c]),A=(0,l.useCallback)(async()=>{i("Verifying location before activating camera..."),s("info");await C()&&(y(!0),i("Camera activated. Position your face in the frame."),s("info"))},[C]),R=(0,l.useCallback)(()=>{y(!1),T(),i('Camera deactivated. Click "Start Camera" to begin face recognition.'),s("info"),N.resetDetectionCount(),b(0),k(!1)},[T,N]);(0,l.useEffect)(()=>(S(),()=>{T(),e.current&&e.current.stream&&e.current.stream.getTracks().forEach(e=>e.stop())}),[S,T]),(0,l.useEffect)(()=>(N.modelsLoaded&&!n&&x?I():x||T(),()=>{T()}),[N.modelsLoaded,n,x]),(0,l.useEffect)(()=>{let e;return h>0&&(e=setInterval(()=>{d(t=>t<=1?(clearInterval(e),i("Position your face in the frame."),s("info"),0):t-1)},1e3)),()=>{e&&clearInterval(e)}},[h]);const D=()=>(0,Ba.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4",children:(0,Ba.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,Ba.jsxs)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-4 flex justify-between items-center",children:[(0,Ba.jsx)("h2",{className:"text-xl font-bold text-white",children:"Enhanced JavaScript Face Recognition Help"}),(0,Ba.jsx)("button",{onClick:()=>m(!1),className:"text-white hover:text-gray-200 text-2xl",children:"\xd7"})]}),(0,Ba.jsxs)("div",{className:"p-6",children:[(0,Ba.jsxs)("div",{className:"mb-6",children:[(0,Ba.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"How Enhanced JavaScript Face Recognition Works"}),(0,Ba.jsx)("p",{className:"text-gray-600",children:"Our system now uses advanced JavaScript facial recognition technology with enhanced security measures. It captures multiple images of your face and compares them against your registered face data with strict accuracy requirements."})]}),(0,Ba.jsxs)("div",{className:"mb-6",children:[(0,Ba.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Enhanced Security & Accuracy"}),(0,Ba.jsxs)("p",{className:"text-gray-600 mb-2",children:[(0,Ba.jsx)("strong",{children:"Critical Security:"})," Attendance is only marked when your face matches your registered face data with extremely high accuracy. If your face does not match, attendance will NOT be marked under any circumstances."]}),(0,Ba.jsxs)("ul",{className:"list-disc list-inside text-gray-600 space-y-1",children:[(0,Ba.jsx)("li",{children:"System requires 5 successful face detections before verification"}),(0,Ba.jsx)("li",{children:"Face matching uses a strict distance threshold of 0.4 for high accuracy"}),(0,Ba.jsx)("li",{children:"At least 60% of your registered face encodings must match"}),(0,Ba.jsx)("li",{children:"Attendance is only marked after successful high accuracy verification"}),(0,Ba.jsx)("li",{children:"If face does not match, no attendance record is created"}),(0,Ba.jsxs)("li",{children:[(0,Ba.jsx)("strong",{children:"HIGH SECURITY:"})," Only your registered face can mark attendance for your profile"]}),(0,Ba.jsxs)("li",{children:[(0,Ba.jsx)("strong",{children:"ZERO TOLERANCE:"})," Any non-matching face is immediately rejected"]}),(0,Ba.jsxs)("li",{children:[(0,Ba.jsx)("strong",{children:"JAVASCRIPT POWERED:"})," Uses enhanced face-api.js library for superior accuracy"]}),(0,Ba.jsxs)("li",{children:[(0,Ba.jsx)("strong",{children:"ISOLATED VERIFICATION:"})," Your face data is never compared against other fighters"]}),(0,Ba.jsxs)("li",{children:[(0,Ba.jsx)("strong",{children:"LOCATION VERIFICATION:"})," Your location is verified to ensure you are at the gym"]})]})]}),(0,Ba.jsxs)("div",{className:"mb-6",children:[(0,Ba.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Location Verification"}),(0,Ba.jsxs)("p",{className:"text-gray-600 mb-2",children:[(0,Ba.jsx)("strong",{children:"Geo-Location Security:"})," To ensure attendance is only marked when you are physically at the gym, your location will be verified during the face recognition process."]}),(0,Ba.jsxs)("ul",{className:"list-disc list-inside text-gray-600 space-y-1",children:[(0,Ba.jsx)("li",{children:"Your location is checked against the gym's registered location"}),(0,Ba.jsx)("li",{children:"Attendance is only marked if you are within 100 meters of the gym"}),(0,Ba.jsx)("li",{children:"Location data is only used for verification and not stored permanently"}),(0,Ba.jsx)("li",{children:"If location access is denied, attendance cannot be marked for security"}),(0,Ba.jsx)("li",{children:"Location verification happens automatically during face recognition"})]})]}),(0,Ba.jsxs)("div",{className:"mb-6",children:[(0,Ba.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"For Best Results"}),(0,Ba.jsxs)("ul",{className:"list-disc list-inside text-gray-600 space-y-1",children:[(0,Ba.jsx)("li",{children:"Ensure excellent lighting on your face (natural light works best)"}),(0,Ba.jsx)("li",{children:"Remove sunglasses, hats, or face coverings"}),(0,Ba.jsx)("li",{children:"Position your face in the center of the frame"}),(0,Ba.jsx)("li",{children:"Keep completely still during scanning process"}),(0,Ba.jsx)("li",{children:"Make sure your entire face is clearly visible"}),(0,Ba.jsx)("li",{children:"Avoid glare or shadows on your face"}),(0,Ba.jsx)("li",{children:"Ensure location services are enabled in your browser"})]})]}),(0,Ba.jsxs)("div",{className:"mb-6",children:[(0,Ba.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Security Assurance"}),(0,Ba.jsx)("p",{className:"text-gray-600 mb-2",children:"Our system implements multiple layers of security to ensure only your face can mark attendance:"}),(0,Ba.jsxs)("ul",{className:"list-disc list-inside text-gray-600 space-y-1",children:[(0,Ba.jsx)("li",{children:"Face data is stored only in your personal profile"}),(0,Ba.jsx)("li",{children:"Verification compares only against your registered face encodings"}),(0,Ba.jsx)("li",{children:"No cross-matching with other fighters' face data"}),(0,Ba.jsx)("li",{children:"Strict threshold prevents false positives"}),(0,Ba.jsx)("li",{children:"Multi-encoding verification ensures consistency"}),(0,Ba.jsxs)("li",{children:[(0,Ba.jsx)("strong",{children:"JAVASCRIPT-BASED PROCESSING:"})," Enhanced face-api.js library for superior accuracy"]}),(0,Ba.jsxs)("li",{children:[(0,Ba.jsx)("strong",{children:"ZERO TOLERANCE POLICY:"})," Any non-matching face is immediately rejected without marking attendance"]}),(0,Ba.jsxs)("li",{children:[(0,Ba.jsx)("strong",{children:"SECURITY ALERTS:"})," Explicit notifications when face verification fails"]}),(0,Ba.jsxs)("li",{children:[(0,Ba.jsx)("strong",{children:"LOCATION SECURITY:"})," Attendance only marked when you're at the gym"]})]})]}),(0,Ba.jsx)("div",{className:"flex justify-end",children:(0,Ba.jsx)("button",{onClick:()=>m(!1),className:"bg-blue-600 text-white px-6 py-2 rounded-lg font-semibold hover:bg-blue-700 transition duration-300",children:"Close Help"})})]})]})});return(0,Ba.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 py-8 px-4 sm:px-6",children:[(0,Ba.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,Ba.jsxs)("div",{className:"text-center mb-8",children:[(0,Ba.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Enhanced JavaScript Face Recognition"}),(0,Ba.jsx)("p",{className:"text-gray-600",children:"Position your face in the frame. Attendance is only marked when face and location verification are successful."})]}),(0,Ba.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden",children:[(0,Ba.jsxs)("div",{className:"bg-gradient-to-r from-red-600 to-red-700 px-6 py-4 flex justify-between items-center",children:[(0,Ba.jsx)("h2",{className:"text-xl font-semibold text-white",children:"Face & Location Scan"}),(0,Ba.jsxs)("button",{onClick:()=>m(!0),className:"text-white hover:text-gray-200 flex items-center",title:"Help",children:[(0,Ba.jsx)(Pt,{className:"mr-1"})," Help"]})]}),(0,Ba.jsx)("div",{className:"p-6",children:(0,Ba.jsxs)("div",{className:"flex flex-col items-center",children:[(0,Ba.jsxs)("div",{className:"w-full max-w-md rounded-xl overflow-hidden border-2 border-gray-300 shadow-md mb-6 relative",children:[x&&(0,Ba.jsx)(si(),{ref:e,audio:!1,screenshotFormat:"image/jpeg",videoConstraints:{width:{ideal:1280},height:{ideal:720},facingMode:"user"},className:"w-full"}),!x&&(0,Ba.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-70 flex items-center justify-center",children:(0,Ba.jsxs)("div",{className:"text-center p-4",children:[(0,Ba.jsx)(ft,{className:"text-white text-3xl mx-auto mb-3"}),(0,Ba.jsx)("p",{className:"text-white font-medium",children:"Camera is not active"}),(0,Ba.jsx)("button",{onClick:A,className:"mt-3 bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-blue-700 transition duration-300",children:"Start Camera"})]})}),n&&(0,Ba.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:(0,Ba.jsx)(Xt,{className:"text-white text-3xl animate-spin"})})]}),(0,Ba.jsxs)("div",{className:"w-full max-w-md p-4 rounded-lg flex items-center ".concat("success"===o?"bg-green-50 border border-green-200":"error"===o?"bg-red-50 border border-red-200":"bg-blue-50 border border-blue-200"),children:[(()=>{switch(o){case"success":return(0,Ba.jsx)(gt,{className:"mr-3 text-green-500"});case"error":return(0,Ba.jsx)(Et,{className:"mr-3 text-red-500"});default:return f?(0,Ba.jsx)(Xt,{className:"mr-3 text-blue-500 animate-spin"}):(0,Ba.jsx)(ft,{className:"mr-3 text-blue-500"})}})(),(0,Ba.jsx)("span",{className:"font-medium ".concat((()=>{switch(o){case"success":return"text-green-600";case"error":return"text-red-600";default:return"text-blue-600"}})()),children:a})]}),h>0&&(0,Ba.jsx)("div",{className:"w-full max-w-md mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,Ba.jsxs)("p",{className:"text-red-600 text-lg font-semibold text-center",children:["Next punch available in: ",Math.floor(h/60),":",String(h%60).padStart(2,"0")]})}),N.detectionCount>0&&N.detectionCount<N.maxDetections&&(0,Ba.jsxs)("div",{className:"w-full max-w-md mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,Ba.jsxs)("p",{className:"text-blue-600 text-center",children:["Detection accuracy: ",N.detectionCount,"/",N.maxDetections," confirmed"]}),(0,Ba.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:(0,Ba.jsx)("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:"".concat(N.detectionCount/N.maxDetections*100,"%")}})})]}),f&&v>0&&(0,Ba.jsxs)("div",{className:"w-full max-w-md mt-4",children:[(0,Ba.jsxs)("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[(0,Ba.jsx)("span",{children:"Verifying face & location..."}),(0,Ba.jsxs)("span",{children:[v,"%"]})]}),(0,Ba.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,Ba.jsx)("div",{className:"bg-green-600 h-2.5 rounded-full transition-all duration-300",style:{width:"".concat(v,"%")}})})]}),(0,Ba.jsx)("div",{className:"mt-6 flex gap-4",children:x?(0,Ba.jsx)("button",{onClick:R,className:"px-6 py-3 bg-red-600 text-white rounded-lg font-semibold hover:bg-red-700 transition duration-300",children:"Stop Camera"}):(0,Ba.jsxs)("button",{onClick:A,disabled:n,className:"px-6 py-3 rounded-lg font-semibold transition duration-300 ".concat(n?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 text-white"),children:[(0,Ba.jsx)(ft,{className:"inline mr-2"}),"Start Camera"]})}),(0,Ba.jsxs)("div",{className:"mt-6 text-center",children:[(0,Ba.jsx)("p",{className:"text-sm text-gray-500 font-medium",children:"Security Notice: Attendance is only marked when both face and location verification are successful."}),(0,Ba.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Your location will be verified to ensure you are at the gym. Only your registered face can mark attendance."})]})]})})]})]}),g&&(0,Ba.jsx)(D,{})]})},zie=()=>{const e=le(),[t,n]=(0,l.useState)({age:"",gender:"male",phNo:"",address:"",height:"",weight:"",bloodGroup:"",occupation:"",package:"monthly",previousExperience:"",medicalIssue:"",motto:"",martialArtsKnowledge:"",goals:[],referral:""}),[r,a]=(0,l.useState)(null),[i,o]=(0,l.useState)(null),[s,c]=(0,l.useState)(""),[u,h]=(0,l.useState)(!1),[d,f]=(0,l.useState)(!0);(0,l.useEffect)(()=>{(async()=>{try{const e=(await ja.get("/fighters/me")).data;o(e.profilePhoto||null),n({age:e.age||"",gender:e.gender||"male",phNo:e.phNo||"",address:e.address||"",height:e.height||"",weight:e.weight||"",bloodGroup:e.bloodGroup||"",occupation:e.occupation||"",package:e.package||"monthly",previousExperience:e.previousExperience||"",medicalIssue:e.medicalIssue||"",motto:e.motto||"",martialArtsKnowledge:e.martialArtsKnowledge||"",goals:e.goals||[],referral:e.referral||""})}catch(gfe){console.error("Error fetching fighter data:",gfe),c("Error fetching profile data."),h(!0)}finally{f(!1)}})()},[]);const p=e=>{const{name:t,value:r}=e.target;n(e=>fn(fn({},e),{},{[t]:r}))},g=e=>{const{value:t,checked:r}=e.target;n(e=>fn(fn({},e),{},r?{goals:[...e.goals,t]}:{goals:e.goals.filter(e=>e!==t)}))};return d?(0,Ba.jsx)("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center p-4",children:(0,Ba.jsx)("div",{className:"text-white",children:"Loading your profile..."})}):(0,Ba.jsxs)("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center p-4",children:[(0,Ba.jsxs)("div",{className:"max-w-4xl w-full bg-gray-800 text-white rounded-lg shadow-xl p-8",children:[(0,Ba.jsx)("h1",{className:"text-3xl font-bold text-center mb-6 text-red-500",children:"Update Your Fighter Profile"}),(0,Ba.jsx)("p",{className:"text-center text-gray-400 mb-8",children:"Update your details as needed."}),(0,Ba.jsxs)("form",{onSubmit:async n=>{n.preventDefault();try{const n=fn({},t);null!==r&&(n.profilePhoto=r),await ja.put("/fighters/me",n),c("Profile updated successfully!"),h(!1),setTimeout(()=>e("/fighter"),2e3)}catch(gfe){var a,i;console.error("Profile update error:",gfe),c((null===(a=gfe.response)||void 0===a||null===(i=a.data)||void 0===i?void 0:i.msg)||"Failed to update profile. Please try again."),h(!0)}},className:"space-y-8",children:[s&&(0,Ba.jsx)("div",{className:"p-3 rounded-md text-sm ".concat(u?"bg-red-100 text-red-700":"bg-green-100 text-green-700"),children:s}),(0,Ba.jsxs)("div",{className:"p-6 bg-gray-700 rounded-lg",children:[(0,Ba.jsx)("h2",{className:"text-xl font-semibold mb-4 border-b border-gray-600 pb-2",children:"Profile Photo"}),(0,Ba.jsxs)("div",{className:"flex flex-col md:flex-row items-start gap-6",children:[(i||r)&&(0,Ba.jsx)("div",{className:"mb-2",children:(0,Ba.jsx)("img",{src:r||i,alt:"Profile Preview",className:"w-32 h-32 rounded-full object-cover border-2 border-gray-600"})}),(0,Ba.jsxs)("div",{className:"flex-1",children:[(0,Ba.jsx)("label",{className:"block text-gray-300 mb-2",children:"Upload New Photo"}),(0,Ba.jsx)("input",{type:"file",accept:".jpg,.jpeg,.png",onChange:e=>{const t=e.target.files[0];if(t){if(!t.type.match("image/jpeg")&&!t.type.match("image/png"))return c("Please upload a JPG, JPEG, or PNG image."),void h(!0);const e=new FileReader;e.onload=e=>{a(e.target.result),c(""),h(!1)},e.readAsDataURL(t)}},className:"w-full bg-gray-600 text-white px-4 py-2 rounded-lg border border-gray-500 focus:outline-none focus:ring-2 focus:ring-red-500"}),(0,Ba.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:"JPG, JPEG, or PNG format"})]})]})]}),(0,Ba.jsxs)("div",{className:"p-6 bg-gray-700 rounded-lg",children:[(0,Ba.jsx)("h2",{className:"text-xl font-semibold mb-4 border-b border-gray-600 pb-2",children:"Personal Info"}),(0,Ba.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Ba.jsx)("input",{type:"number",name:"age",placeholder:"Age",value:t.age,onChange:p,className:"input-style"}),(0,Ba.jsxs)("select",{name:"gender",value:t.gender,onChange:p,className:"input-style",children:[(0,Ba.jsx)("option",{value:"male",children:"Male"}),(0,Ba.jsx)("option",{value:"female",children:"Female"}),(0,Ba.jsx)("option",{value:"other",children:"Other"})]}),(0,Ba.jsx)("input",{type:"tel",name:"phNo",placeholder:"Phone Number",value:t.phNo,onChange:p,className:"input-style"}),(0,Ba.jsx)("input",{type:"text",name:"address",placeholder:"Address",value:t.address,onChange:p,className:"input-style"})]})]}),(0,Ba.jsxs)("div",{className:"p-6 bg-gray-700 rounded-lg",children:[(0,Ba.jsx)("h2",{className:"text-xl font-semibold mb-4 border-b border-gray-600 pb-2",children:"Fighter Details"}),(0,Ba.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Ba.jsx)("input",{type:"text",name:"height",placeholder:"Height (cm)",value:t.height,onChange:p,className:"input-style"}),(0,Ba.jsx)("input",{type:"text",name:"weight",placeholder:"Weight (kg)",value:t.weight,onChange:p,className:"input-style"}),(0,Ba.jsx)("input",{type:"text",name:"bloodGroup",placeholder:"Blood Group",value:t.bloodGroup,onChange:p,className:"input-style"}),(0,Ba.jsx)("input",{type:"text",name:"occupation",placeholder:"Occupation",value:t.occupation,onChange:p,className:"input-style"}),(0,Ba.jsxs)("select",{name:"package",value:t.package,onChange:p,className:"input-style",children:[(0,Ba.jsx)("option",{value:"monthly",children:"Monthly"}),(0,Ba.jsx)("option",{value:"quarterly",children:"Quarterly"}),(0,Ba.jsx)("option",{value:"yearly",children:"Yearly"})]}),(0,Ba.jsx)("input",{type:"text",name:"previousExperience",placeholder:"Previous Martial Arts Experience?",value:t.previousExperience,onChange:p,className:"input-style"}),(0,Ba.jsx)("textarea",{name:"medicalIssue",placeholder:"Any Medical Issues?",value:t.medicalIssue,onChange:p,className:"input-style md:col-span-2",rows:"2"}),(0,Ba.jsx)("textarea",{name:"motto",placeholder:"What is your Motto?",value:t.motto,onChange:p,className:"input-style md:col-span-2",rows:"2"}),(0,Ba.jsx)("textarea",{name:"martialArtsKnowledge",placeholder:"Knowledge in Martial Arts",value:t.martialArtsKnowledge,onChange:p,className:"input-style md:col-span-2",rows:"2"})]})]}),(0,Ba.jsxs)("div",{className:"p-6 bg-gray-700 rounded-lg",children:[(0,Ba.jsx)("h2",{className:"text-xl font-semibold mb-4 border-b border-gray-600 pb-2",children:"Goals & Referral"}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("label",{className:"block mb-2",children:"What are your goals?"}),(0,Ba.jsx)("div",{className:"flex flex-wrap gap-4",children:["Fitness","Self-defense","Competition","Discipline"].map(e=>(0,Ba.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,Ba.jsx)("input",{type:"checkbox",value:e,checked:t.goals.includes(e),onChange:g,className:"h-4 w-4 bg-gray-600 border-gray-500 rounded text-red-500 focus:ring-red-500"}),(0,Ba.jsx)("span",{children:e})]},e))})]}),(0,Ba.jsx)("input",{type:"text",name:"referral",placeholder:"How did you hear about us?",value:t.referral,onChange:p,className:"input-style mt-4"})]}),(0,Ba.jsxs)("div",{className:"p-6 bg-gray-700 rounded-lg",children:[(0,Ba.jsx)("h2",{className:"text-xl font-semibold mb-4 border-b border-gray-600 pb-2",children:"Achievements"}),(0,Ba.jsx)("p",{className:"text-gray-300",children:"Achievements can only be added or modified by administrators."})]}),(0,Ba.jsxs)("div",{className:"flex gap-4",children:[(0,Ba.jsx)("button",{type:"button",onClick:()=>e("/fighter"),className:"flex-1 bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-4 rounded-lg transition duration-300",children:"Cancel"}),(0,Ba.jsx)("button",{type:"submit",className:"flex-1 bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-4 rounded-lg transition duration-300",children:"Update Profile"})]})]})]}),(0,Ba.jsx)("style",{children:"\n                .input-style {\n                    background-color: #4A5568; /* gray-700 */\n                    border: 1px solid #718096; /* gray-500 */\n                    color: white;\n                    padding: 0.75rem 1rem;\n                    border-radius: 0.5rem;\n                    width: 100%;\n                }\n                .input-style::placeholder {\n                    color: #A0AEC0; /* gray-400 */\n                }\n                .input-style:focus {\n                    outline: none;\n                    border-color: #F56565; /* red-500 */\n                    box-shadow: 0 0 0 2px #F56565;\n                }\n            "})]})},Wie=()=>{const[e,t]=(0,l.useState)(null),[n,r]=(0,l.useState)([]),[a,i]=(0,l.useState)(!0);if((0,l.useEffect)(()=>{(async()=>{try{const[e,n]=await Promise.all([ja.get("/subscriptions/me"),ja.get("/subscriptions/history")]);t(e.data),r(n.data)}catch(gfe){console.error("Error fetching subscription data")}finally{i(!1)}})()},[]),a)return(0,Ba.jsx)("div",{className:"min-h-screen bg-gray-900 text-white flex items-center justify-center",children:"Loading..."});const o=e&&new Date(e.endDate)<new Date;return(0,Ba.jsxs)("div",{className:"min-h-screen bg-gray-900 p-4 md:p-8 text-white",children:[(0,Ba.jsxs)("h1",{className:"text-3xl font-bold mb-8 flex items-center gap-3",children:[(0,Ba.jsx)(kt,{className:"text-yellow-500"})," My Membership"]}),(0,Ba.jsx)("div",{className:"rounded-2xl p-8 mb-8 shadow-2xl border ".concat(o?"bg-gray-800 border-red-500":"bg-gradient-to-br from-blue-900 to-gray-900 border-blue-500"),children:e?(0,Ba.jsxs)("div",{children:[(0,Ba.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("h2",{className:"text-2xl font-bold text-white",children:e.planName}),(0,Ba.jsx)("p",{className:"text-sm font-bold uppercase tracking-widest mt-1 ".concat(o?"text-red-400":"text-green-400"),children:o?"Expired":"Active Plan"})]}),(0,Ba.jsxs)("div",{className:"text-right",children:[(0,Ba.jsxs)("p",{className:"text-3xl font-bold text-white",children:["\u20b9",e.amount]}),(0,Ba.jsx)("p",{className:"text-gray-400 text-sm",children:e.paymentMode})]})]}),(0,Ba.jsxs)("div",{className:"bg-black/30 rounded-xl p-4 flex flex-col md:flex-row justify-between gap-4 border border-white/10",children:[(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("p",{className:"text-gray-400 text-xs uppercase",children:"Start Date"}),(0,Ba.jsx)("p",{className:"font-mono font-bold text-lg",children:new Date(e.startDate).toLocaleDateString()})]}),(0,Ba.jsxs)("div",{className:"md:text-right",children:[(0,Ba.jsx)("p",{className:"text-gray-400 text-xs uppercase",children:"Expires On"}),(0,Ba.jsx)("p",{className:"font-mono font-bold text-lg ".concat(o?"text-red-400":"text-yellow-400"),children:new Date(e.endDate).toLocaleDateString()})]})]})]}):(0,Ba.jsx)("div",{className:"text-center py-8 text-gray-400",children:(0,Ba.jsx)("p",{children:"No active subscription found."})})}),(0,Ba.jsxs)("div",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700",children:[(0,Ba.jsxs)("h3",{className:"text-xl font-bold mb-6 flex items-center gap-2 text-gray-300",children:[(0,Ba.jsx)(Ft,{})," Payment History"]}),(0,Ba.jsx)("div",{className:"space-y-4",children:n.length>0?n.map(e=>(0,Ba.jsxs)("div",{className:"flex justify-between items-center p-4 bg-gray-700/50 rounded-lg",children:[(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("p",{className:"font-bold text-white",children:e.planName}),(0,Ba.jsxs)("p",{className:"text-xs text-gray-400",children:[new Date(e.startDate).toLocaleDateString()," - ",new Date(e.endDate).toLocaleDateString()]})]}),(0,Ba.jsx)("div",{className:"text-right",children:(0,Ba.jsxs)("span",{className:"block font-bold text-green-400",children:["\u20b9",e.amount]})})]},e._id)):(0,Ba.jsx)("p",{className:"text-gray-500",children:"No history available."})})]})]})};function Uie(e){return e+.5|0}const Vie=(e,t,n)=>Math.max(Math.min(e,n),t);function Hie(e){return Vie(Uie(2.55*e),0,255)}function Gie(e){return Vie(Uie(255*e),0,255)}function qie(e){return Vie(Uie(e/2.55)/100,0,1)}function Kie(e){return Vie(Uie(100*e),0,100)}const Xie={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Yie=[..."0123456789ABCDEF"],$ie=e=>Yie[15&e],Jie=e=>Yie[(240&e)>>4]+Yie[15&e],Qie=e=>(240&e)>>4===(15&e);function Zie(e){var t=(e=>Qie(e.r)&&Qie(e.g)&&Qie(e.b)&&Qie(e.a))(e)?$ie:Jie;return e?"#"+t(e.r)+t(e.g)+t(e.b)+((e,t)=>e<255?t(e):"")(e.a,t):void 0}const eoe=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function toe(e,t,n){const r=t*Math.min(n,1-n),a=function(t){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t+e/30)%12;return n-r*Math.max(Math.min(a-3,9-a,1),-1)};return[a(0),a(8),a(4)]}function noe(e,t,n){const r=function(r){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(r+e/60)%6;return n-n*t*Math.max(Math.min(a,4-a,1),0)};return[r(5),r(3),r(1)]}function roe(e,t,n){const r=toe(e,1,.5);let a;for(t+n>1&&(a=1/(t+n),t*=a,n*=a),a=0;a<3;a++)r[a]*=1-t-n,r[a]+=t;return r}function aoe(e){const t=e.r/255,n=e.g/255,r=e.b/255,a=Math.max(t,n,r),i=Math.min(t,n,r),o=(a+i)/2;let s,l,c;return a!==i&&(c=a-i,l=o>.5?c/(2-a-i):c/(a+i),s=function(e,t,n,r,a){return e===a?(t-n)/r+(t<n?6:0):t===a?(n-e)/r+2:(e-t)/r+4}(t,n,r,c,a),s=60*s+.5),[0|s,l||0,o]}function ioe(e,t,n,r){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,n,r)).map(Gie)}function ooe(e,t,n){return ioe(toe,e,t,n)}function soe(e){return(e%360+360)%360}function loe(e){const t=eoe.exec(e);let n,r=255;if(!t)return;t[5]!==n&&(r=t[6]?Hie(+t[5]):Gie(+t[5]));const a=soe(+t[2]),i=+t[3]/100,o=+t[4]/100;return n="hwb"===t[1]?function(e,t,n){return ioe(roe,e,t,n)}(a,i,o):"hsv"===t[1]?function(e,t,n){return ioe(noe,e,t,n)}(a,i,o):ooe(a,i,o),{r:n[0],g:n[1],b:n[2],a:r}}const coe={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},uoe={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let hoe;function doe(e){hoe||(hoe=function(){const e={},t=Object.keys(uoe),n=Object.keys(coe);let r,a,i,o,s;for(r=0;r<t.length;r++){for(o=s=t[r],a=0;a<n.length;a++)i=n[a],s=s.replace(i,coe[i]);i=parseInt(uoe[o],16),e[s]=[i>>16&255,i>>8&255,255&i]}return e}(),hoe.transparent=[0,0,0,0]);const t=hoe[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:4===t.length?t[3]:255}}const foe=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;const poe=e=>e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055,goe=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function moe(e,t,n){if(e){let r=aoe(e);r[t]=Math.max(0,Math.min(r[t]+r[t]*n,0===t?360:1)),r=ooe(r),e.r=r[0],e.g=r[1],e.b=r[2]}}function voe(e,t){return e?Object.assign(t||{},e):e}function boe(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=Gie(e[3]))):(t=voe(e,{r:0,g:0,b:0,a:1})).a=Gie(t.a),t}function xoe(e){return"r"===e.charAt(0)?function(e){const t=foe.exec(e);let n,r,a,i=255;if(t){if(t[7]!==n){const e=+t[7];i=t[8]?Hie(e):Vie(255*e,0,255)}return n=+t[1],r=+t[3],a=+t[5],n=255&(t[2]?Hie(n):Vie(n,0,255)),r=255&(t[4]?Hie(r):Vie(r,0,255)),a=255&(t[6]?Hie(a):Vie(a,0,255)),{r:n,g:r,b:a,a:i}}}(e):loe(e)}class yoe{constructor(e){if(e instanceof yoe)return e;const t=typeof e;let n;"object"===t?n=boe(e):"string"===t&&(n=function(e){var t,n=e.length;return"#"===e[0]&&(4===n||5===n?t={r:255&17*Xie[e[1]],g:255&17*Xie[e[2]],b:255&17*Xie[e[3]],a:5===n?17*Xie[e[4]]:255}:7!==n&&9!==n||(t={r:Xie[e[1]]<<4|Xie[e[2]],g:Xie[e[3]]<<4|Xie[e[4]],b:Xie[e[5]]<<4|Xie[e[6]],a:9===n?Xie[e[7]]<<4|Xie[e[8]]:255})),t}(e)||doe(e)||xoe(e)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var e=voe(this._rgb);return e&&(e.a=qie(e.a)),e}set rgb(e){this._rgb=boe(e)}rgbString(){return this._valid?function(e){return e&&(e.a<255?"rgba(".concat(e.r,", ").concat(e.g,", ").concat(e.b,", ").concat(qie(e.a),")"):"rgb(".concat(e.r,", ").concat(e.g,", ").concat(e.b,")"))}(this._rgb):void 0}hexString(){return this._valid?Zie(this._rgb):void 0}hslString(){return this._valid?function(e){if(!e)return;const t=aoe(e),n=t[0],r=Kie(t[1]),a=Kie(t[2]);return e.a<255?"hsla(".concat(n,", ").concat(r,"%, ").concat(a,"%, ").concat(qie(e.a),")"):"hsl(".concat(n,", ").concat(r,"%, ").concat(a,"%)")}(this._rgb):void 0}mix(e,t){if(e){const n=this.rgb,r=e.rgb;let a;const i=t===a?.5:t,o=2*i-1,s=n.a-r.a,l=((o*s===-1?o:(o+s)/(1+o*s))+1)/2;a=1-l,n.r=255&l*n.r+a*r.r+.5,n.g=255&l*n.g+a*r.g+.5,n.b=255&l*n.b+a*r.b+.5,n.a=i*n.a+(1-i)*r.a,this.rgb=n}return this}interpolate(e,t){return e&&(this._rgb=function(e,t,n){const r=goe(qie(e.r)),a=goe(qie(e.g)),i=goe(qie(e.b));return{r:Gie(poe(r+n*(goe(qie(t.r))-r))),g:Gie(poe(a+n*(goe(qie(t.g))-a))),b:Gie(poe(i+n*(goe(qie(t.b))-i))),a:e.a+n*(t.a-e.a)}}(this._rgb,e._rgb,t)),this}clone(){return new yoe(this.rgb)}alpha(e){return this._rgb.a=Gie(e),this}clearer(e){return this._rgb.a*=1-e,this}greyscale(){const e=this._rgb,t=Uie(.3*e.r+.59*e.g+.11*e.b);return e.r=e.g=e.b=t,this}opaquer(e){return this._rgb.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return moe(this._rgb,2,e),this}darken(e){return moe(this._rgb,2,-e),this}saturate(e){return moe(this._rgb,1,e),this}desaturate(e){return moe(this._rgb,1,-e),this}rotate(e){return function(e,t){var n=aoe(e);n[0]=soe(n[0]+t),n=ooe(n),e.r=n[0],e.g=n[1],e.b=n[2]}(this._rgb,e),this}}function woe(){}const koe=(()=>{let e=0;return()=>e++})();function Noe(e){return null===e||void 0===e}function Soe(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return"[object"===t.slice(0,7)&&"Array]"===t.slice(-6)}function Coe(e){return null!==e&&"[object Object]"===Object.prototype.toString.call(e)}function Eoe(e){return("number"===typeof e||e instanceof Number)&&isFinite(+e)}function _oe(e,t){return Eoe(e)?e:t}function Ioe(e,t){return"undefined"===typeof e?t:e}const Toe=(e,t)=>"string"===typeof e&&e.endsWith("%")?parseFloat(e)/100*t:+e;function Aoe(e,t,n){if(e&&"function"===typeof e.call)return e.apply(n,t)}function Roe(e,t,n,r){let a,i,o;if(Soe(e))if(i=e.length,r)for(a=i-1;a>=0;a--)t.call(n,e[a],a);else for(a=0;a<i;a++)t.call(n,e[a],a);else if(Coe(e))for(o=Object.keys(e),i=o.length,a=0;a<i;a++)t.call(n,e[o[a]],o[a])}function Doe(e,t){let n,r,a,i;if(!e||!t||e.length!==t.length)return!1;for(n=0,r=e.length;n<r;++n)if(a=e[n],i=t[n],a.datasetIndex!==i.datasetIndex||a.index!==i.index)return!1;return!0}function Foe(e){if(Soe(e))return e.map(Foe);if(Coe(e)){const t=Object.create(null),n=Object.keys(e),r=n.length;let a=0;for(;a<r;++a)t[n[a]]=Foe(e[n[a]]);return t}return e}function Ooe(e){return-1===["__proto__","prototype","constructor"].indexOf(e)}function Loe(e,t,n,r){if(!Ooe(e))return;const a=t[e],i=n[e];Coe(a)&&Coe(i)?Poe(a,i,r):t[e]=Foe(i)}function Poe(e,t,n){const r=Soe(t)?t:[t],a=r.length;if(!Coe(e))return e;const i=(n=n||{}).merger||Loe;let o;for(let s=0;s<a;++s){if(o=r[s],!Coe(o))continue;const t=Object.keys(o);for(let r=0,a=t.length;r<a;++r)i(t[r],e,o,n)}return e}function Moe(e,t){return Poe(e,t,{merger:joe})}function joe(e,t,n){if(!Ooe(e))return;const r=t[e],a=n[e];Coe(r)&&Coe(a)?Moe(r,a):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=Foe(a))}const Boe={"":e=>e,x:e=>e.x,y:e=>e.y};function zoe(e,t){const n=Boe[t]||(Boe[t]=function(e){const t=function(e){const t=e.split("."),n=[];let r="";for(const a of t)r+=a,r.endsWith("\\")?r=r.slice(0,-1)+".":(n.push(r),r="");return n}(e);return e=>{for(const n of t){if(""===n)break;e=e&&e[n]}return e}}(t));return n(e)}function Woe(e){return e.charAt(0).toUpperCase()+e.slice(1)}const Uoe=e=>"undefined"!==typeof e,Voe=e=>"function"===typeof e,Hoe=(e,t)=>{if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0};const Goe=Math.PI,qoe=2*Goe,Koe=qoe+Goe,Xoe=Number.POSITIVE_INFINITY,Yoe=Goe/180,$oe=Goe/2,Joe=Goe/4,Qoe=2*Goe/3,Zoe=Math.log10,ese=Math.sign;function tse(e,t,n){return Math.abs(e-t)<n}function nse(e){const t=Math.round(e);e=tse(e,t,e/1e3)?t:e;const n=Math.pow(10,Math.floor(Zoe(e))),r=e/n;return(r<=1?1:r<=2?2:r<=5?5:10)*n}function rse(e){return!function(e){return"symbol"===typeof e||"object"===typeof e&&null!==e&&!(Symbol.toPrimitive in e||"toString"in e||"valueOf"in e)}(e)&&!isNaN(parseFloat(e))&&isFinite(e)}function ase(e,t,n){let r,a,i;for(r=0,a=e.length;r<a;r++)i=e[r][n],isNaN(i)||(t.min=Math.min(t.min,i),t.max=Math.max(t.max,i))}function ise(e){return e*(Goe/180)}function ose(e){return e*(180/Goe)}function sse(e){if(!Eoe(e))return;let t=1,n=0;for(;Math.round(e*t)/t!==e;)t*=10,n++;return n}function lse(e,t){const n=t.x-e.x,r=t.y-e.y,a=Math.sqrt(n*n+r*r);let i=Math.atan2(r,n);return i<-.5*Goe&&(i+=qoe),{angle:i,distance:a}}function cse(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function use(e,t){return(e-t+Koe)%qoe-Goe}function hse(e){return(e%qoe+qoe)%qoe}function dse(e,t,n,r){const a=hse(e),i=hse(t),o=hse(n),s=hse(i-a),l=hse(o-a),c=hse(a-i),u=hse(a-o);return a===i||a===o||r&&i===o||s>l&&c<u}function fse(e,t,n){return Math.max(t,Math.min(n,e))}function pse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-6;return e>=Math.min(t,n)-r&&e<=Math.max(t,n)+r}function gse(e,t,n){n=n||(n=>e[n]<t);let r,a=e.length-1,i=0;for(;a-i>1;)r=i+a>>1,n(r)?i=r:a=r;return{lo:i,hi:a}}const mse=(e,t,n,r)=>gse(e,n,r?r=>{const a=e[r][t];return a<n||a===n&&e[r+1][t]===n}:r=>e[r][t]<n),vse=(e,t,n)=>gse(e,n,r=>e[r][t]>=n);const bse=["push","pop","shift","splice","unshift"];function xse(e,t){const n=e._chartjs;if(!n)return;const r=n.listeners,a=r.indexOf(t);-1!==a&&r.splice(a,1),r.length>0||(bse.forEach(t=>{delete e[t]}),delete e._chartjs)}function yse(e){const t=new Set(e);return t.size===e.length?e:Array.from(t)}const wse="undefined"===typeof window?function(e){return e()}:window.requestAnimationFrame;function kse(e,t){let n=[],r=!1;return function(){for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];n=i,r||(r=!0,wse.call(window,()=>{r=!1,e.apply(t,n)}))}}const Nse=e=>"start"===e?"left":"end"===e?"right":"center",Sse=(e,t,n)=>"start"===e?t:"end"===e?n:(t+n)/2;function Cse(e,t,n){const r=t.length;let a=0,i=r;if(e._sorted){const{iScale:o,vScale:s,_parsed:l}=e,c=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null,u=o.axis,{min:h,max:d,minDefined:f,maxDefined:p}=o.getUserBounds();if(f){if(a=Math.min(mse(l,u,h).lo,n?r:mse(t,u,o.getPixelForValue(h)).lo),c){const e=l.slice(0,a+1).reverse().findIndex(e=>!Noe(e[s.axis]));a-=Math.max(0,e)}a=fse(a,0,r-1)}if(p){let e=Math.max(mse(l,o.axis,d,!0).hi+1,n?0:mse(t,u,o.getPixelForValue(d),!0).hi+1);if(c){const t=l.slice(e-1).findIndex(e=>!Noe(e[s.axis]));e+=Math.max(0,t)}i=fse(e,a,r)-a}else i=r-a}return{start:a,count:i}}function Ese(e){const{xScale:t,yScale:n,_scaleRanges:r}=e,a={xmin:t.min,xmax:t.max,ymin:n.min,ymax:n.max};if(!r)return e._scaleRanges=a,!0;const i=r.xmin!==t.min||r.xmax!==t.max||r.ymin!==n.min||r.ymax!==n.max;return Object.assign(r,a),i}const _se=e=>0===e||1===e,Ise=(e,t,n)=>-Math.pow(2,10*(e-=1))*Math.sin((e-t)*qoe/n),Tse=(e,t,n)=>Math.pow(2,-10*e)*Math.sin((e-t)*qoe/n)+1,Ase={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>1-Math.cos(e*$oe),easeOutSine:e=>Math.sin(e*$oe),easeInOutSine:e=>-.5*(Math.cos(Goe*e)-1),easeInExpo:e=>0===e?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>1===e?1:1-Math.pow(2,-10*e),easeInOutExpo:e=>_se(e)?e:e<.5?.5*Math.pow(2,10*(2*e-1)):.5*(2-Math.pow(2,-10*(2*e-1))),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>_se(e)?e:Ise(e,.075,.3),easeOutElastic:e=>_se(e)?e:Tse(e,.075,.3),easeInOutElastic(e){const t=.1125;return _se(e)?e:e<.5?.5*Ise(2*e,t,.45):.5+.5*Tse(2*e-1,t,.45)},easeInBack(e){const t=1.70158;return e*e*((t+1)*e-t)},easeOutBack(e){const t=1.70158;return(e-=1)*e*((t+1)*e+t)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?e*e*((1+(t*=1.525))*e-t)*.5:.5*((e-=2)*e*((1+(t*=1.525))*e+t)+2)},easeInBounce:e=>1-Ase.easeOutBounce(1-e),easeOutBounce(e){const t=7.5625,n=2.75;return e<1/n?t*e*e:e<2/n?t*(e-=1.5/n)*e+.75:e<2.5/n?t*(e-=2.25/n)*e+.9375:t*(e-=2.625/n)*e+.984375},easeInOutBounce:e=>e<.5?.5*Ase.easeInBounce(2*e):.5*Ase.easeOutBounce(2*e-1)+.5};function Rse(e){if(e&&"object"===typeof e){const t=e.toString();return"[object CanvasPattern]"===t||"[object CanvasGradient]"===t}return!1}function Dse(e){return Rse(e)?e:new yoe(e)}function Fse(e){return Rse(e)?e:new yoe(e).saturate(.5).darken(.1).hexString()}const Ose=["x","y","borderWidth","radius","tension"],Lse=["color","borderColor","backgroundColor"];const Pse=new Map;function Mse(e,t,n){return function(e,t){t=t||{};const n=e+JSON.stringify(t);let r=Pse.get(n);return r||(r=new Intl.NumberFormat(e,t),Pse.set(n,r)),r}(t,n).format(e)}const jse={values:e=>Soe(e)?e:""+e,numeric(e,t,n){if(0===e)return"0";const r=this.chart.options.locale;let a,i=e;if(n.length>1){const t=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(t<1e-4||t>1e15)&&(a="scientific"),i=function(e,t){let n=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;Math.abs(n)>=1&&e!==Math.floor(e)&&(n=e-Math.floor(e));return n}(e,n)}const o=Zoe(Math.abs(i)),s=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:a,minimumFractionDigits:s,maximumFractionDigits:s};return Object.assign(l,this.options.ticks.format),Mse(e,r,l)},logarithmic(e,t,n){if(0===e)return"0";const r=n[t].significand||e/Math.pow(10,Math.floor(Zoe(e)));return[1,2,3,5,10,15].includes(r)||t>.8*n.length?jse.numeric.call(this,e,t,n):""}};var Bse={formatters:jse};const zse=Object.create(null),Wse=Object.create(null);function Use(e,t){if(!t)return e;const n=t.split(".");for(let r=0,a=n.length;r<a;++r){const t=n[r];e=e[t]||(e[t]=Object.create(null))}return e}function Vse(e,t,n){return"string"===typeof t?Poe(Use(e,t),n):Poe(Use(e,""),t)}class Hse{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=e=>e.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(e,t)=>Fse(t.backgroundColor),this.hoverBorderColor=(e,t)=>Fse(t.borderColor),this.hoverColor=(e,t)=>Fse(t.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return Vse(this,e,t)}get(e){return Use(this,e)}describe(e,t){return Vse(Wse,e,t)}override(e,t){return Vse(zse,e,t)}route(e,t,n,r){const a=Use(this,e),i=Use(this,n),o="_"+t;Object.defineProperties(a,{[o]:{value:a[t],writable:!0},[t]:{enumerable:!0,get(){const e=this[o],t=i[r];return Coe(e)?Object.assign({},t,e):Ioe(e,t)},set(e){this[o]=e}}})}apply(e){e.forEach(e=>e(this))}}var Gse=new Hse({_scriptable:e=>!e.startsWith("on"),_indexable:e=>"events"!==e,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>"onProgress"!==e&&"onComplete"!==e&&"fn"!==e}),e.set("animations",{colors:{type:"color",properties:Lse},numbers:{type:"number",properties:Ose}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>0|e}}}})},function(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Bse.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&"callback"!==e&&"parser"!==e,_indexable:e=>"borderDash"!==e&&"tickBorderDash"!==e&&"dash"!==e}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:e=>"backdropPadding"!==e&&"callback"!==e,_indexable:e=>"backdropPadding"!==e})}]);function qse(e,t,n,r,a){let i=t[a];return i||(i=t[a]=e.measureText(a).width,n.push(a)),i>r&&(r=i),r}function Kse(e,t,n,r){let a=(r=r||{}).data=r.data||{},i=r.garbageCollect=r.garbageCollect||[];r.font!==t&&(a=r.data={},i=r.garbageCollect=[],r.font=t),e.save(),e.font=t;let o=0;const s=n.length;let l,c,u,h,d;for(l=0;l<s;l++)if(h=n[l],void 0===h||null===h||Soe(h)){if(Soe(h))for(c=0,u=h.length;c<u;c++)d=h[c],void 0===d||null===d||Soe(d)||(o=qse(e,a,i,o,d))}else o=qse(e,a,i,o,h);e.restore();const f=i.length/2;if(f>n.length){for(l=0;l<f;l++)delete a[i[l]];i.splice(0,f)}return o}function Xse(e,t,n){const r=e.currentDevicePixelRatio,a=0!==n?Math.max(n/2,.5):0;return Math.round((t-a)*r)/r+a}function Yse(e,t){(t||e)&&((t=t||e.getContext("2d")).save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore())}function $se(e,t,n,r){Jse(e,t,n,r,null)}function Jse(e,t,n,r,a){let i,o,s,l,c,u,h,d;const f=t.pointStyle,p=t.rotation,g=t.radius;let m=(p||0)*Yoe;if(f&&"object"===typeof f&&(i=f.toString(),"[object HTMLImageElement]"===i||"[object HTMLCanvasElement]"===i))return e.save(),e.translate(n,r),e.rotate(m),e.drawImage(f,-f.width/2,-f.height/2,f.width,f.height),void e.restore();if(!(isNaN(g)||g<=0)){switch(e.beginPath(),f){default:a?e.ellipse(n,r,a/2,g,0,0,qoe):e.arc(n,r,g,0,qoe),e.closePath();break;case"triangle":u=a?a/2:g,e.moveTo(n+Math.sin(m)*u,r-Math.cos(m)*g),m+=Qoe,e.lineTo(n+Math.sin(m)*u,r-Math.cos(m)*g),m+=Qoe,e.lineTo(n+Math.sin(m)*u,r-Math.cos(m)*g),e.closePath();break;case"rectRounded":c=.516*g,l=g-c,o=Math.cos(m+Joe)*l,h=Math.cos(m+Joe)*(a?a/2-c:l),s=Math.sin(m+Joe)*l,d=Math.sin(m+Joe)*(a?a/2-c:l),e.arc(n-h,r-s,c,m-Goe,m-$oe),e.arc(n+d,r-o,c,m-$oe,m),e.arc(n+h,r+s,c,m,m+$oe),e.arc(n-d,r+o,c,m+$oe,m+Goe),e.closePath();break;case"rect":if(!p){l=Math.SQRT1_2*g,u=a?a/2:l,e.rect(n-u,r-l,2*u,2*l);break}m+=Joe;case"rectRot":h=Math.cos(m)*(a?a/2:g),o=Math.cos(m)*g,s=Math.sin(m)*g,d=Math.sin(m)*(a?a/2:g),e.moveTo(n-h,r-s),e.lineTo(n+d,r-o),e.lineTo(n+h,r+s),e.lineTo(n-d,r+o),e.closePath();break;case"crossRot":m+=Joe;case"cross":h=Math.cos(m)*(a?a/2:g),o=Math.cos(m)*g,s=Math.sin(m)*g,d=Math.sin(m)*(a?a/2:g),e.moveTo(n-h,r-s),e.lineTo(n+h,r+s),e.moveTo(n+d,r-o),e.lineTo(n-d,r+o);break;case"star":h=Math.cos(m)*(a?a/2:g),o=Math.cos(m)*g,s=Math.sin(m)*g,d=Math.sin(m)*(a?a/2:g),e.moveTo(n-h,r-s),e.lineTo(n+h,r+s),e.moveTo(n+d,r-o),e.lineTo(n-d,r+o),m+=Joe,h=Math.cos(m)*(a?a/2:g),o=Math.cos(m)*g,s=Math.sin(m)*g,d=Math.sin(m)*(a?a/2:g),e.moveTo(n-h,r-s),e.lineTo(n+h,r+s),e.moveTo(n+d,r-o),e.lineTo(n-d,r+o);break;case"line":o=a?a/2:Math.cos(m)*g,s=Math.sin(m)*g,e.moveTo(n-o,r-s),e.lineTo(n+o,r+s);break;case"dash":e.moveTo(n,r),e.lineTo(n+Math.cos(m)*(a?a/2:g),r+Math.sin(m)*g);break;case!1:e.closePath()}e.fill(),t.borderWidth>0&&e.stroke()}}function Qse(e,t,n){return n=n||.5,!t||e&&e.x>t.left-n&&e.x<t.right+n&&e.y>t.top-n&&e.y<t.bottom+n}function Zse(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function ele(e){e.restore()}function tle(e,t,n,r,a){if(!t)return e.lineTo(n.x,n.y);if("middle"===a){const r=(t.x+n.x)/2;e.lineTo(r,t.y),e.lineTo(r,n.y)}else"after"===a!==!!r?e.lineTo(t.x,n.y):e.lineTo(n.x,t.y);e.lineTo(n.x,n.y)}function nle(e,t,n,r){if(!t)return e.lineTo(n.x,n.y);e.bezierCurveTo(r?t.cp1x:t.cp2x,r?t.cp1y:t.cp2y,r?n.cp2x:n.cp1x,r?n.cp2y:n.cp1y,n.x,n.y)}function rle(e,t,n,r,a){if(a.strikethrough||a.underline){const i=e.measureText(r),o=t-i.actualBoundingBoxLeft,s=t+i.actualBoundingBoxRight,l=n-i.actualBoundingBoxAscent,c=n+i.actualBoundingBoxDescent,u=a.strikethrough?(l+c)/2:c;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=a.decorationWidth||2,e.moveTo(o,u),e.lineTo(s,u),e.stroke()}}function ale(e,t){const n=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=n}function ile(e,t,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const o=Soe(t)?t:[t],s=i.strokeWidth>0&&""!==i.strokeColor;let l,c;for(e.save(),e.font=a.string,function(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),Noe(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}(e,i),l=0;l<o.length;++l)c=o[l],i.backdrop&&ale(e,i.backdrop),s&&(i.strokeColor&&(e.strokeStyle=i.strokeColor),Noe(i.strokeWidth)||(e.lineWidth=i.strokeWidth),e.strokeText(c,n,r,i.maxWidth)),e.fillText(c,n,r,i.maxWidth),rle(e,n,r,c,i),r+=Number(a.lineHeight);e.restore()}function ole(e,t){const{x:n,y:r,w:a,h:i,radius:o}=t;e.arc(n+o.topLeft,r+o.topLeft,o.topLeft,1.5*Goe,Goe,!0),e.lineTo(n,r+i-o.bottomLeft),e.arc(n+o.bottomLeft,r+i-o.bottomLeft,o.bottomLeft,Goe,$oe,!0),e.lineTo(n+a-o.bottomRight,r+i),e.arc(n+a-o.bottomRight,r+i-o.bottomRight,o.bottomRight,$oe,0,!0),e.lineTo(n+a,r+o.topRight),e.arc(n+a-o.topRight,r+o.topRight,o.topRight,0,-$oe,!0),e.lineTo(n+o.topLeft,r)}const sle=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,lle=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function cle(e,t){const n=(""+e).match(sle);if(!n||"normal"===n[1])return 1.2*t;switch(e=+n[2],n[3]){case"px":return e;case"%":e/=100}return t*e}const ule=e=>+e||0;function hle(e,t){const n={},r=Coe(t),a=r?Object.keys(t):t,i=Coe(e)?r?n=>Ioe(e[n],e[t[n]]):t=>e[t]:()=>e;for(const o of a)n[o]=ule(i(o));return n}function dle(e){return hle(e,{top:"y",right:"x",bottom:"y",left:"x"})}function fle(e){return hle(e,["topLeft","topRight","bottomLeft","bottomRight"])}function ple(e){const t=dle(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function gle(e,t){e=e||{},t=t||Gse.font;let n=Ioe(e.size,t.size);"string"===typeof n&&(n=parseInt(n,10));let r=Ioe(e.style,t.style);r&&!(""+r).match(lle)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);const a={family:Ioe(e.family,t.family),lineHeight:cle(Ioe(e.lineHeight,t.lineHeight),n),size:n,style:r,weight:Ioe(e.weight,t.weight),string:""};return a.string=function(e){return!e||Noe(e.size)||Noe(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}(a),a}function mle(e,t,n,r){let a,i,o,s=!0;for(a=0,i=e.length;a<i;++a)if(o=e[a],void 0!==o&&(void 0!==t&&"function"===typeof o&&(o=o(t),s=!1),void 0!==n&&Soe(o)&&(o=o[n%o.length],s=!1),void 0!==o))return r&&!s&&(r.cacheable=!1),o}function vle(e,t){return Object.assign(Object.create(e),t)}function ble(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[""],n=arguments.length>3?arguments[3]:void 0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:()=>e[0];const a=(arguments.length>2?arguments[2]:void 0)||e;"undefined"===typeof n&&(n=Tle("_fallback",e));const i={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:a,_fallback:n,_getTarget:r,override:r=>ble([r,...e],t,a,n)};return new Proxy(i,{deleteProperty:(t,n)=>(delete t[n],delete t._keys,delete e[0][n],!0),get:(n,r)=>Nle(n,r,()=>function(e,t,n,r){let a;for(const i of t)if(a=Tle(wle(i,e),n),"undefined"!==typeof a)return kle(e,a)?_le(n,r,e,a):a}(r,t,e,n)),getOwnPropertyDescriptor:(e,t)=>Reflect.getOwnPropertyDescriptor(e._scopes[0],t),getPrototypeOf:()=>Reflect.getPrototypeOf(e[0]),has:(e,t)=>Ale(e).includes(t),ownKeys:e=>Ale(e),set(e,t,n){const a=e._storage||(e._storage=r());return e[t]=a[t]=n,delete e._keys,!0}})}function xle(e,t,n,r){const a={_cacheable:!1,_proxy:e,_context:t,_subProxy:n,_stack:new Set,_descriptors:yle(e,r),setContext:t=>xle(e,t,n,r),override:a=>xle(e.override(a),t,n,r)};return new Proxy(a,{deleteProperty:(t,n)=>(delete t[n],delete e[n],!0),get:(e,t,n)=>Nle(e,t,()=>function(e,t,n){const{_proxy:r,_context:a,_subProxy:i,_descriptors:o}=e;let s=r[t];Voe(s)&&o.isScriptable(t)&&(s=function(e,t,n,r){const{_proxy:a,_context:i,_subProxy:o,_stack:s}=n;if(s.has(e))throw new Error("Recursion detected: "+Array.from(s).join("->")+"->"+e);s.add(e);let l=t(i,o||r);s.delete(e),kle(e,l)&&(l=_le(a._scopes,a,e,l));return l}(t,s,e,n));Soe(s)&&s.length&&(s=function(e,t,n,r){const{_proxy:a,_context:i,_subProxy:o,_descriptors:s}=n;if("undefined"!==typeof i.index&&r(e))return t[i.index%t.length];if(Coe(t[0])){const n=t,r=a._scopes.filter(e=>e!==n);t=[];for(const l of n){const n=_le(r,a,e,l);t.push(xle(n,i,o&&o[e],s))}}return t}(t,s,e,o.isIndexable));kle(t,s)&&(s=xle(s,a,i&&i[t],o));return s}(e,t,n)),getOwnPropertyDescriptor:(t,n)=>t._descriptors.allKeys?Reflect.has(e,n)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,n),getPrototypeOf:()=>Reflect.getPrototypeOf(e),has:(t,n)=>Reflect.has(e,n),ownKeys:()=>Reflect.ownKeys(e),set:(t,n,r)=>(e[n]=r,delete t[n],!0)})}function yle(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{scriptable:!0,indexable:!0};const{_scriptable:n=t.scriptable,_indexable:r=t.indexable,_allKeys:a=t.allKeys}=e;return{allKeys:a,scriptable:n,indexable:r,isScriptable:Voe(n)?n:()=>n,isIndexable:Voe(r)?r:()=>r}}const wle=(e,t)=>e?e+Woe(t):t,kle=(e,t)=>Coe(t)&&"adapters"!==e&&(null===Object.getPrototypeOf(t)||t.constructor===Object);function Nle(e,t,n){if(Object.prototype.hasOwnProperty.call(e,t)||"constructor"===t)return e[t];const r=n();return e[t]=r,r}function Sle(e,t,n){return Voe(e)?e(t,n):e}const Cle=(e,t)=>!0===e?t:"string"===typeof e?zoe(t,e):void 0;function Ele(e,t,n,r,a){for(const i of t){const t=Cle(n,i);if(t){e.add(t);const i=Sle(t._fallback,n,a);if("undefined"!==typeof i&&i!==n&&i!==r)return i}else if(!1===t&&"undefined"!==typeof r&&n!==r)return null}return!1}function _le(e,t,n,r){const a=t._rootScopes,i=Sle(t._fallback,n,r),o=[...e,...a],s=new Set;s.add(r);let l=Ile(s,o,n,i||n,r);return null!==l&&(("undefined"===typeof i||i===n||(l=Ile(s,o,i,l,r),null!==l))&&ble(Array.from(s),[""],a,i,()=>function(e,t,n){const r=e._getTarget();t in r||(r[t]={});const a=r[t];if(Soe(a)&&Coe(n))return n;return a||{}}(t,n,r)))}function Ile(e,t,n,r,a){for(;n;)n=Ele(e,t,n,r,a);return n}function Tle(e,t){for(const n of t){if(!n)continue;const t=n[e];if("undefined"!==typeof t)return t}}function Ale(e){let t=e._keys;return t||(t=e._keys=function(e){const t=new Set;for(const n of e)for(const e of Object.keys(n).filter(e=>!e.startsWith("_")))t.add(e);return Array.from(t)}(e._scopes)),t}function Rle(e,t,n,r){const{iScale:a}=e,{key:i="r"}=this._parsing,o=new Array(r);let s,l,c,u;for(s=0,l=r;s<l;++s)c=s+n,u=t[c],o[s]={r:a.parse(zoe(u,i),c)};return o}const Dle=Number.EPSILON||1e-14,Fle=(e,t)=>t<e.length&&!e[t].skip&&e[t],Ole=e=>"x"===e?"y":"x";function Lle(e,t,n,r){const a=e.skip?t:e,i=t,o=n.skip?t:n,s=cse(i,a),l=cse(o,i);let c=s/(s+l),u=l/(s+l);c=isNaN(c)?0:c,u=isNaN(u)?0:u;const h=r*c,d=r*u;return{previous:{x:i.x-h*(o.x-a.x),y:i.y-h*(o.y-a.y)},next:{x:i.x+d*(o.x-a.x),y:i.y+d*(o.y-a.y)}}}function Ple(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"x";const n=Ole(t),r=e.length,a=Array(r).fill(0),i=Array(r);let o,s,l,c=Fle(e,0);for(o=0;o<r;++o)if(s=l,l=c,c=Fle(e,o+1),l){if(c){const e=c[t]-l[t];a[o]=0!==e?(c[n]-l[n])/e:0}i[o]=s?c?ese(a[o-1])!==ese(a[o])?0:(a[o-1]+a[o])/2:a[o-1]:a[o]}!function(e,t,n){const r=e.length;let a,i,o,s,l,c=Fle(e,0);for(let u=0;u<r-1;++u)l=c,c=Fle(e,u+1),l&&c&&(tse(t[u],0,Dle)?n[u]=n[u+1]=0:(a=n[u]/t[u],i=n[u+1]/t[u],s=Math.pow(a,2)+Math.pow(i,2),s<=9||(o=3/Math.sqrt(s),n[u]=a*o*t[u],n[u+1]=i*o*t[u])))}(e,a,i),function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"x";const r=Ole(n),a=e.length;let i,o,s,l=Fle(e,0);for(let c=0;c<a;++c){if(o=s,s=l,l=Fle(e,c+1),!s)continue;const a=s[n],u=s[r];o&&(i=(a-o[n])/3,s["cp1".concat(n)]=a-i,s["cp1".concat(r)]=u-i*t[c]),l&&(i=(l[n]-a)/3,s["cp2".concat(n)]=a+i,s["cp2".concat(r)]=u+i*t[c])}}(e,i,t)}function Mle(e,t,n){return Math.max(Math.min(e,n),t)}function jle(e,t,n,r,a){let i,o,s,l;if(t.spanGaps&&(e=e.filter(e=>!e.skip)),"monotone"===t.cubicInterpolationMode)Ple(e,a);else{let n=r?e[e.length-1]:e[0];for(i=0,o=e.length;i<o;++i)s=e[i],l=Lle(n,s,e[Math.min(i+1,o-(r?0:1))%o],t.tension),s.cp1x=l.previous.x,s.cp1y=l.previous.y,s.cp2x=l.next.x,s.cp2y=l.next.y,n=s}t.capBezierPoints&&function(e,t){let n,r,a,i,o,s=Qse(e[0],t);for(n=0,r=e.length;n<r;++n)o=i,i=s,s=n<r-1&&Qse(e[n+1],t),i&&(a=e[n],o&&(a.cp1x=Mle(a.cp1x,t.left,t.right),a.cp1y=Mle(a.cp1y,t.top,t.bottom)),s&&(a.cp2x=Mle(a.cp2x,t.left,t.right),a.cp2y=Mle(a.cp2y,t.top,t.bottom)))}(e,n)}function Ble(){return"undefined"!==typeof window&&"undefined"!==typeof document}function zle(e){let t=e.parentNode;return t&&"[object ShadowRoot]"===t.toString()&&(t=t.host),t}function Wle(e,t,n){let r;return"string"===typeof e?(r=parseInt(e,10),-1!==e.indexOf("%")&&(r=r/100*t.parentNode[n])):r=e,r}const Ule=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);const Vle=["top","right","bottom","left"];function Hle(e,t,n){const r={};n=n?"-"+n:"";for(let a=0;a<4;a++){const i=Vle[a];r[i]=parseFloat(e[t+"-"+i+n])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}function Gle(e,t){if("native"in e)return e;const{canvas:n,currentDevicePixelRatio:r}=t,a=Ule(n),i="border-box"===a.boxSizing,o=Hle(a,"padding"),s=Hle(a,"border","width"),{x:l,y:c,box:u}=function(e,t){const n=e.touches,r=n&&n.length?n[0]:e,{offsetX:a,offsetY:i}=r;let o,s,l=!1;if(((e,t,n)=>(e>0||t>0)&&(!n||!n.shadowRoot))(a,i,e.target))o=a,s=i;else{const e=t.getBoundingClientRect();o=r.clientX-e.left,s=r.clientY-e.top,l=!0}return{x:o,y:s,box:l}}(e,n),h=o.left+(u&&s.left),d=o.top+(u&&s.top);let{width:f,height:p}=t;return i&&(f-=o.width+s.width,p-=o.height+s.height),{x:Math.round((l-h)/f*n.width/r),y:Math.round((c-d)/p*n.height/r)}}const qle=e=>Math.round(10*e)/10;function Kle(e,t,n,r){const a=Ule(e),i=Hle(a,"margin"),o=Wle(a.maxWidth,e,"clientWidth")||Xoe,s=Wle(a.maxHeight,e,"clientHeight")||Xoe,l=function(e,t,n){let r,a;if(void 0===t||void 0===n){const i=e&&zle(e);if(i){const e=i.getBoundingClientRect(),o=Ule(i),s=Hle(o,"border","width"),l=Hle(o,"padding");t=e.width-l.width-s.width,n=e.height-l.height-s.height,r=Wle(o.maxWidth,i,"clientWidth"),a=Wle(o.maxHeight,i,"clientHeight")}else t=e.clientWidth,n=e.clientHeight}return{width:t,height:n,maxWidth:r||Xoe,maxHeight:a||Xoe}}(e,t,n);let{width:c,height:u}=l;if("content-box"===a.boxSizing){const e=Hle(a,"border","width"),t=Hle(a,"padding");c-=t.width+e.width,u-=t.height+e.height}c=Math.max(0,c-i.width),u=Math.max(0,r?c/r:u-i.height),c=qle(Math.min(c,o,l.maxWidth)),u=qle(Math.min(u,s,l.maxHeight)),c&&!u&&(u=qle(c/2));return(void 0!==t||void 0!==n)&&r&&l.height&&u>l.height&&(u=l.height,c=qle(Math.floor(u*r))),{width:c,height:u}}function Xle(e,t,n){const r=t||1,a=qle(e.height*r),i=qle(e.width*r);e.height=qle(e.height),e.width=qle(e.width);const o=e.canvas;return o.style&&(n||!o.style.height&&!o.style.width)&&(o.style.height="".concat(e.height,"px"),o.style.width="".concat(e.width,"px")),(e.currentDevicePixelRatio!==r||o.height!==a||o.width!==i)&&(e.currentDevicePixelRatio=r,o.height=a,o.width=i,e.ctx.setTransform(r,0,0,r,0,0),!0)}const Yle=function(){let e=!1;try{const t={get passive(){return e=!0,!1}};Ble()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch(ci){}return e}();function $le(e,t){const n=function(e,t){return Ule(e).getPropertyValue(t)}(e,t),r=n&&n.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}function Jle(e,t,n,r){return{x:e.x+n*(t.x-e.x),y:e.y+n*(t.y-e.y)}}function Qle(e,t,n,r){return{x:e.x+n*(t.x-e.x),y:"middle"===r?n<.5?e.y:t.y:"after"===r?n<1?e.y:t.y:n>0?t.y:e.y}}function Zle(e,t,n,r){const a={x:e.cp2x,y:e.cp2y},i={x:t.cp1x,y:t.cp1y},o=Jle(e,a,n),s=Jle(a,i,n),l=Jle(i,t,n),c=Jle(o,s,n),u=Jle(s,l,n);return Jle(c,u,n)}function ece(e,t,n){return e?function(e,t){return{x:n=>e+e+t-n,setWidth(e){t=e},textAlign:e=>"center"===e?e:"right"===e?"left":"right",xPlus:(e,t)=>e-t,leftForLtr:(e,t)=>e-t}}(t,n):{x:e=>e,setWidth(e){},textAlign:e=>e,xPlus:(e,t)=>e+t,leftForLtr:(e,t)=>e}}function tce(e,t){let n,r;"ltr"!==t&&"rtl"!==t||(n=e.canvas.style,r=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",t,"important"),e.prevTextDirection=r)}function nce(e,t){void 0!==t&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function rce(e){return"angle"===e?{between:dse,compare:use,normalize:hse}:{between:pse,compare:(e,t)=>e-t,normalize:e=>e}}function ace(e){let{start:t,end:n,count:r,loop:a,style:i}=e;return{start:t%r,end:n%r,loop:a&&(n-t+1)%r===0,style:i}}function ice(e,t,n){if(!n)return[e];const{property:r,start:a,end:i}=n,o=t.length,{compare:s,between:l,normalize:c}=rce(r),{start:u,end:h,loop:d,style:f}=function(e,t,n){const{property:r,start:a,end:i}=n,{between:o,normalize:s}=rce(r),l=t.length;let c,u,{start:h,end:d,loop:f}=e;if(f){for(h+=l,d+=l,c=0,u=l;c<u&&o(s(t[h%l][r]),a,i);++c)h--,d--;h%=l,d%=l}return d<h&&(d+=l),{start:h,end:d,loop:f,style:e.style}}(e,t,n),p=[];let g,m,v,b=!1,x=null;const y=()=>b||l(a,v,g)&&0!==s(a,v),w=()=>!b||0===s(i,g)||l(i,v,g);for(let k=u,N=u;k<=h;++k)m=t[k%o],m.skip||(g=c(m[r]),g!==v&&(b=l(g,a,i),null===x&&y()&&(x=0===s(g,a)?k:N),null!==x&&w()&&(p.push(ace({start:x,end:k,loop:d,count:o,style:f})),x=null),N=k,v=g));return null!==x&&p.push(ace({start:x,end:h,loop:d,count:o,style:f})),p}function oce(e,t){const n=[],r=e.segments;for(let a=0;a<r.length;a++){const i=ice(r[a],e.points,t);i.length&&n.push(...i)}return n}function sce(e,t,n,r){return r&&r.setContext&&n?function(e,t,n,r){const a=e._chart.getContext(),i=lce(e.options),{_datasetIndex:o,options:{spanGaps:s}}=e,l=n.length,c=[];let u=i,h=t[0].start,d=h;function f(e,t,r,a){const i=s?-1:1;if(e!==t){for(e+=l;n[e%l].skip;)e-=i;for(;n[t%l].skip;)t+=i;e%l!==t%l&&(c.push({start:e%l,end:t%l,loop:r,style:a}),u=a,h=t%l)}}for(const p of t){h=s?h:p.start;let e,t=n[h%l];for(d=h+1;d<=p.end;d++){const i=n[d%l];e=lce(r.setContext(vle(a,{type:"segment",p0:t,p1:i,p0DataIndex:(d-1)%l,p1DataIndex:d%l,datasetIndex:o}))),cce(e,u)&&f(h,d-1,p.loop,u),t=i,u=e}h<d-1&&f(h,d-1,p.loop,u)}return c}(e,t,n,r):t}function lce(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function cce(e,t){if(!t)return!1;const n=[],r=function(e,t){return Rse(t)?(n.includes(t)||n.push(t),n.indexOf(t)):t};return JSON.stringify(e,r)!==JSON.stringify(t,r)}function uce(e,t,n){return e.options.clip?e[n]:t[n]}function hce(e,t){const n=t._clip;if(n.disabled)return!1;const r=function(e,t){const{xScale:n,yScale:r}=e;return n&&r?{left:uce(n,t,"left"),right:uce(n,t,"right"),top:uce(r,t,"top"),bottom:uce(r,t,"bottom")}:t}(t,e.chartArea);return{left:!1===n.left?0:r.left-(!0===n.left?0:n.left),right:!1===n.right?e.width:r.right+(!0===n.right?0:n.right),top:!1===n.top?0:r.top-(!0===n.top?0:n.top),bottom:!1===n.bottom?e.height:r.bottom+(!0===n.bottom?0:n.bottom)}}class dce{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,n,r){const a=t.listeners[r],i=t.duration;a.forEach(r=>r({chart:e,initial:t.initial,numSteps:i,currentStep:Math.min(n-t.start,i)}))}_refresh(){this._request||(this._running=!0,this._request=wse.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),t=0;this._charts.forEach((n,r)=>{if(!n.running||!n.items.length)return;const a=n.items;let i,o=a.length-1,s=!1;for(;o>=0;--o)i=a[o],i._active?(i._total>n.duration&&(n.duration=i._total),i.tick(e),s=!0):(a[o]=a[a.length-1],a.pop());s&&(r.draw(),this._notify(r,n,e,"progress")),a.length||(n.running=!1,this._notify(r,n,e,"complete"),n.initial=!1),t+=a.length}),this._lastDate=e,0===t&&(this._running=!1)}_getAnims(e){const t=this._charts;let n=t.get(e);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,n)),n}listen(e,t,n){this._getAnims(e).listeners[t].push(n)}add(e,t){t&&t.length&&this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((e,t)=>Math.max(e,t._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!!(t&&t.running&&t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const n=t.items;let r=n.length-1;for(;r>=0;--r)n[r].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var fce=new dce;const pce="transparent",gce={boolean:(e,t,n)=>n>.5?t:e,color(e,t,n){const r=Dse(e||pce),a=r.valid&&Dse(t||pce);return a&&a.valid?a.mix(r,n).hexString():t},number:(e,t,n)=>e+(t-e)*n};class mce{constructor(e,t,n,r){const a=t[n];r=mle([e.to,r,a,e.from]);const i=mle([e.from,a,r]);this._active=!0,this._fn=e.fn||gce[e.type||typeof i],this._easing=Ase[e.easing]||Ase.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=n,this._from=i,this._to=r,this._promises=void 0}active(){return this._active}update(e,t,n){if(this._active){this._notify(!1);const r=this._target[this._prop],a=n-this._start,i=this._duration-a;this._start=n,this._duration=Math.floor(Math.max(i,e.duration)),this._total+=a,this._loop=!!e.loop,this._to=mle([e.to,t,r,e.from]),this._from=mle([e.from,r,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,n=this._duration,r=this._prop,a=this._from,i=this._loop,o=this._to;let s;if(this._active=a!==o&&(i||t<n),!this._active)return this._target[r]=o,void this._notify(!0);t<0?this._target[r]=a:(s=t/n%2,s=i&&s>1?2-s:s,s=this._easing(Math.min(1,Math.max(0,s))),this._target[r]=this._fn(a,o,s))}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,n)=>{e.push({res:t,rej:n})})}_notify(e){const t=e?"res":"rej",n=this._promises||[];for(let r=0;r<n.length;r++)n[r][t]()}}class vce{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!Coe(e))return;const t=Object.keys(Gse.animation),n=this._properties;Object.getOwnPropertyNames(e).forEach(r=>{const a=e[r];if(!Coe(a))return;const i={};for(const e of t)i[e]=a[e];(Soe(a.properties)&&a.properties||[r]).forEach(e=>{e!==r&&n.has(e)||n.set(e,i)})})}_animateOptions(e,t){const n=t.options,r=function(e,t){if(!t)return;let n=e.options;if(!n)return void(e.options=t);n.$shared&&(e.options=n=Object.assign({},n,{$shared:!1,$animations:{}}));return n}(e,n);if(!r)return[];const a=this._createAnimations(r,n);return n.$shared&&function(e,t){const n=[],r=Object.keys(t);for(let a=0;a<r.length;a++){const t=e[r[a]];t&&t.active()&&n.push(t.wait())}return Promise.all(n)}(e.options.$animations,n).then(()=>{e.options=n},()=>{}),a}_createAnimations(e,t){const n=this._properties,r=[],a=e.$animations||(e.$animations={}),i=Object.keys(t),o=Date.now();let s;for(s=i.length-1;s>=0;--s){const l=i[s];if("$"===l.charAt(0))continue;if("options"===l){r.push(...this._animateOptions(e,t));continue}const c=t[l];let u=a[l];const h=n.get(l);if(u){if(h&&u.active()){u.update(h,c,o);continue}u.cancel()}h&&h.duration?(a[l]=u=new mce(h,e,l,c),r.push(u)):e[l]=c}return r}update(e,t){if(0===this._properties.size)return void Object.assign(e,t);const n=this._createAnimations(e,t);return n.length?(fce.add(this._chart,n),!0):void 0}}function bce(e,t){const n=e&&e.options||{},r=n.reverse,a=void 0===n.min?t:0,i=void 0===n.max?t:0;return{start:r?i:a,end:r?a:i}}function xce(e,t){const n=[],r=e._getSortedDatasetMetas(t);let a,i;for(a=0,i=r.length;a<i;++a)n.push(r[a].index);return n}function yce(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const a=e.keys,i="single"===r.mode;let o,s,l,c;if(null===t)return;let u=!1;for(o=0,s=a.length;o<s;++o){if(l=+a[o],l===n){if(u=!0,r.all)continue;break}c=e.values[l],Eoe(c)&&(i||0===t||ese(t)===ese(c))&&(t+=c)}return u||r.all?t:0}function wce(e,t){const n=e&&e.options.stacked;return n||void 0===n&&void 0!==t.stack}function kce(e,t,n){const r=e[t]||(e[t]={});return r[n]||(r[n]={})}function Nce(e,t,n,r){for(const a of t.getMatchingVisibleMetas(r).reverse()){const t=e[a.index];if(n&&t>0||!n&&t<0)return a.index}return null}function Sce(e,t){const{chart:n,_cachedMeta:r}=e,a=n._stacks||(n._stacks={}),{iScale:i,vScale:o,index:s}=r,l=i.axis,c=o.axis,u=function(e,t,n){return"".concat(e.id,".").concat(t.id,".").concat(n.stack||n.type)}(i,o,r),h=t.length;let d;for(let f=0;f<h;++f){const e=t[f],{[l]:n,[c]:i}=e;d=(e._stacks||(e._stacks={}))[c]=kce(a,u,n),d[s]=i,d._top=Nce(d,o,!0,r.type),d._bottom=Nce(d,o,!1,r.type);(d._visualValues||(d._visualValues={}))[s]=i}}function Cce(e,t){const n=e.scales;return Object.keys(n).filter(e=>n[e].axis===t).shift()}function Ece(e,t){const n=e.controller.index,r=e.vScale&&e.vScale.axis;if(r){t=t||e._parsed;for(const e of t){const t=e._stacks;if(!t||void 0===t[r]||void 0===t[r][n])return;delete t[r][n],void 0!==t[r]._visualValues&&void 0!==t[r]._visualValues[n]&&delete t[r]._visualValues[n]}}}const _ce=e=>"reset"===e||"none"===e,Ice=(e,t)=>t?e:Object.assign({},e);class Tce{constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=wce(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Ece(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,n=this.getDataset(),r=(e,t,n,r)=>"x"===e?t:"r"===e?r:n,a=t.xAxisID=Ioe(n.xAxisID,Cce(e,"x")),i=t.yAxisID=Ioe(n.yAxisID,Cce(e,"y")),o=t.rAxisID=Ioe(n.rAxisID,Cce(e,"r")),s=t.indexAxis,l=t.iAxisID=r(s,a,i,o),c=t.vAxisID=r(s,i,a,o);t.xScale=this.getScaleForId(a),t.yScale=this.getScaleForId(i),t.rScale=this.getScaleForId(o),t.iScale=this.getScaleForId(l),t.vScale=this.getScaleForId(c)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&xse(this._data,this),e._stacked&&Ece(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),n=this._data;if(Coe(t)){const e=this._cachedMeta;this._data=function(e,t){const{iScale:n,vScale:r}=t,a="x"===n.axis?"x":"y",i="x"===r.axis?"x":"y",o=Object.keys(e),s=new Array(o.length);let l,c,u;for(l=0,c=o.length;l<c;++l)u=o[l],s[l]={[a]:u,[i]:e[u]};return s}(t,e)}else if(n!==t){if(n){xse(n,this);const e=this._cachedMeta;Ece(e),e._parsed=[]}t&&Object.isExtensible(t)&&function(e,t){e._chartjs?e._chartjs.listeners.push(t):(Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),bse.forEach(t=>{const n="_onData"+Woe(t),r=e[t];Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value(){for(var t=arguments.length,a=new Array(t),i=0;i<t;i++)a[i]=arguments[i];const o=r.apply(this,a);return e._chartjs.listeners.forEach(e=>{"function"===typeof e[n]&&e[n](...a)}),o}})}))}(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,n=this.getDataset();let r=!1;this._dataCheck();const a=t._stacked;t._stacked=wce(t.vScale,t),t.stack!==n.stack&&(r=!0,Ece(t),t.stack=n.stack),this._resyncElements(e),(r||a!==t._stacked)&&(Sce(this,t._parsed),t._stacked=wce(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),n=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:n,_data:r}=this,{iScale:a,_stacked:i}=n,o=a.axis;let s,l,c,u=0===e&&t===r.length||n._sorted,h=e>0&&n._parsed[e-1];if(!1===this._parsing)n._parsed=r,n._sorted=!0,c=r;else{c=Soe(r[e])?this.parseArrayData(n,r,e,t):Coe(r[e])?this.parseObjectData(n,r,e,t):this.parsePrimitiveData(n,r,e,t);const a=()=>null===l[o]||h&&l[o]<h[o];for(s=0;s<t;++s)n._parsed[s+e]=l=c[s],u&&(a()&&(u=!1),h=l);n._sorted=u}i&&Sce(this,c)}parsePrimitiveData(e,t,n,r){const{iScale:a,vScale:i}=e,o=a.axis,s=i.axis,l=a.getLabels(),c=a===i,u=new Array(r);let h,d,f;for(h=0,d=r;h<d;++h)f=h+n,u[h]={[o]:c||a.parse(l[f],f),[s]:i.parse(t[f],f)};return u}parseArrayData(e,t,n,r){const{xScale:a,yScale:i}=e,o=new Array(r);let s,l,c,u;for(s=0,l=r;s<l;++s)c=s+n,u=t[c],o[s]={x:a.parse(u[0],c),y:i.parse(u[1],c)};return o}parseObjectData(e,t,n,r){const{xScale:a,yScale:i}=e,{xAxisKey:o="x",yAxisKey:s="y"}=this._parsing,l=new Array(r);let c,u,h,d;for(c=0,u=r;c<u;++c)h=c+n,d=t[h],l[c]={x:a.parse(zoe(d,o),h),y:i.parse(zoe(d,s),h)};return l}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,n){const r=this.chart,a=this._cachedMeta,i=t[e.axis];return yce({keys:xce(r,!0),values:t._stacks[e.axis]._visualValues},i,a.index,{mode:n})}updateRangeFromParsed(e,t,n,r){const a=n[t.axis];let i=null===a?NaN:a;const o=r&&n._stacks[t.axis];r&&o&&(r.values=o,i=yce(r,a,this._cachedMeta.index)),e.min=Math.min(e.min,i),e.max=Math.max(e.max,i)}getMinMax(e,t){const n=this._cachedMeta,r=n._parsed,a=n._sorted&&e===n.iScale,i=r.length,o=this._getOtherScale(e),s=((e,t,n)=>e&&!t.hidden&&t._stacked&&{keys:xce(n,!0),values:null})(t,n,this.chart),l={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:c,max:u}=function(e){const{min:t,max:n,minDefined:r,maxDefined:a}=e.getUserBounds();return{min:r?t:Number.NEGATIVE_INFINITY,max:a?n:Number.POSITIVE_INFINITY}}(o);let h,d;function f(){d=r[h];const t=d[o.axis];return!Eoe(d[e.axis])||c>t||u<t}for(h=0;h<i&&(f()||(this.updateRangeFromParsed(l,e,d,s),!a));++h);if(a)for(h=i-1;h>=0;--h)if(!f()){this.updateRangeFromParsed(l,e,d,s);break}return l}getAllParsedValues(e){const t=this._cachedMeta._parsed,n=[];let r,a,i;for(r=0,a=t.length;r<a;++r)i=t[r][e.axis],Eoe(i)&&n.push(i);return n}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,n=t.iScale,r=t.vScale,a=this.getParsed(e);return{label:n?""+n.getLabelForValue(a[n.axis]):"",value:r?""+r.getLabelForValue(a[r.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=function(e){let t,n,r,a;return Coe(e)?(t=e.top,n=e.right,r=e.bottom,a=e.left):t=n=r=a=e,{top:t,right:n,bottom:r,left:a,disabled:!1===e}}(Ioe(this.options.clip,function(e,t,n){if(!1===n)return!1;const r=bce(e,n),a=bce(t,n);return{top:a.end,right:r.end,bottom:a.start,left:r.start}}(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,n=this._cachedMeta,r=n.data||[],a=t.chartArea,i=[],o=this._drawStart||0,s=this._drawCount||r.length-o,l=this.options.drawActiveElementsOnTop;let c;for(n.dataset&&n.dataset.draw(e,a,o,s),c=o;c<o+s;++c){const t=r[c];t.hidden||(t.active&&l?i.push(t):t.draw(e,a))}for(c=0;c<i.length;++c)i[c].draw(e,a)}getStyle(e,t){const n=t?"active":"default";return void 0===e&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(e||0,n)}getContext(e,t,n){const r=this.getDataset();let a;if(e>=0&&e<this._cachedMeta.data.length){const t=this._cachedMeta.data[e];a=t.$context||(t.$context=function(e,t,n){return vle(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:n,index:t,mode:"default",type:"data"})}(this.getContext(),e,t)),a.parsed=this.getParsed(e),a.raw=r.data[e],a.index=a.dataIndex=e}else a=this.$context||(this.$context=function(e,t){return vle(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),a.dataset=r,a.index=a.datasetIndex=this.index;return a.active=!!t,a.mode=n,a}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",n=arguments.length>2?arguments[2]:void 0;const r="active"===t,a=this._cachedDataOpts,i=e+"-"+t,o=a[i],s=this.enableOptionSharing&&Uoe(n);if(o)return Ice(o,s);const l=this.chart.config,c=l.datasetElementScopeKeys(this._type,e),u=r?["".concat(e,"Hover"),"hover",e,""]:[e,""],h=l.getOptionScopes(this.getDataset(),c),d=Object.keys(Gse.elements[e]),f=l.resolveNamedOptions(h,d,()=>this.getContext(n,r,t),u);return f.$shared&&(f.$shared=s,a[i]=Object.freeze(Ice(f,s))),f}_resolveAnimations(e,t,n){const r=this.chart,a=this._cachedDataOpts,i="animation-".concat(t),o=a[i];if(o)return o;let s;if(!1!==r.options.animation){const r=this.chart.config,a=r.datasetAnimationScopeKeys(this._type,t),i=r.getOptionScopes(this.getDataset(),a);s=r.createResolver(i,this.getContext(e,n,t))}const l=new vce(r,s&&s.animations);return s&&s._cacheable&&(a[i]=Object.freeze(l)),l}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||_ce(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const n=this.resolveDataElementOptions(e,t),r=this._sharedOptions,a=this.getSharedOptions(n),i=this.includeOptions(t,a)||a!==r;return this.updateSharedOptions(a,t,n),{sharedOptions:a,includeOptions:i}}updateElement(e,t,n,r){_ce(r)?Object.assign(e,n):this._resolveAnimations(t,r).update(e,n)}updateSharedOptions(e,t,n){e&&!_ce(t)&&this._resolveAnimations(void 0,t).update(e,n)}_setStyle(e,t,n,r){e.active=r;const a=this.getStyle(t,r);this._resolveAnimations(t,n,r).update(e,{options:!r&&this.getSharedOptions(a)||a})}removeHoverStyle(e,t,n){this._setStyle(e,n,"active",!1)}setHoverStyle(e,t,n){this._setStyle(e,n,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,n=this._cachedMeta.data;for(const[o,s,l]of this._syncList)this[o](s,l);this._syncList=[];const r=n.length,a=t.length,i=Math.min(a,r);i&&this.parse(0,i),a>r?this._insertElements(r,a-r,e):a<r&&this._removeElements(a,r-a)}_insertElements(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=this._cachedMeta,a=r.data,i=e+t;let o;const s=e=>{for(e.length+=t,o=e.length-1;o>=i;o--)e[o]=e[o-t]};for(s(a),o=e;o<i;++o)a[o]=new this.dataElementType;this._parsing&&s(r._parsed),this.parse(e,t),n&&this.updateElements(a,e,t,"reset")}updateElements(e,t,n,r){}_removeElements(e,t){const n=this._cachedMeta;if(this._parsing){const r=n._parsed.splice(e,t);n._stacked&&Ece(n,r)}n.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,n,r]=e;this[t](n,r)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const n=arguments.length-2;n&&this._sync(["_insertElements",e,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function Ace(e){const t=e.iScale,n=function(e,t){if(!e._cache.$bar){const n=e.getMatchingVisibleMetas(t);let r=[];for(let t=0,a=n.length;t<a;t++)r=r.concat(n[t].controller.getAllParsedValues(e));e._cache.$bar=yse(r.sort((e,t)=>e-t))}return e._cache.$bar}(t,e.type);let r,a,i,o,s=t._length;const l=()=>{32767!==i&&-32768!==i&&(Uoe(o)&&(s=Math.min(s,Math.abs(i-o)||s)),o=i)};for(r=0,a=n.length;r<a;++r)i=t.getPixelForValue(n[r]),l();for(o=void 0,r=0,a=t.ticks.length;r<a;++r)i=t.getPixelForTick(r),l();return s}function Rce(e,t,n,r){return Soe(e)?function(e,t,n,r){const a=n.parse(e[0],r),i=n.parse(e[1],r),o=Math.min(a,i),s=Math.max(a,i);let l=o,c=s;Math.abs(o)>Math.abs(s)&&(l=s,c=o),t[n.axis]=c,t._custom={barStart:l,barEnd:c,start:a,end:i,min:o,max:s}}(e,t,n,r):t[n.axis]=n.parse(e,r),t}function Dce(e,t,n,r){const a=e.iScale,i=e.vScale,o=a.getLabels(),s=a===i,l=[];let c,u,h,d;for(c=n,u=n+r;c<u;++c)d=t[c],h={},h[a.axis]=s||a.parse(o[c],c),l.push(Rce(d,h,i,c));return l}function Fce(e){return e&&void 0!==e.barStart&&void 0!==e.barEnd}function Oce(e,t,n,r){let a=t.borderSkipped;const i={};if(!a)return void(e.borderSkipped=i);if(!0===a)return void(e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0});const{start:o,end:s,reverse:l,top:c,bottom:u}=function(e){let t,n,r,a,i;return e.horizontal?(t=e.base>e.x,n="left",r="right"):(t=e.base<e.y,n="bottom",r="top"),t?(a="end",i="start"):(a="start",i="end"),{start:n,end:r,reverse:t,top:a,bottom:i}}(e);"middle"===a&&n&&(e.enableBorderRadius=!0,(n._top||0)===r?a=c:(n._bottom||0)===r?a=u:(i[Lce(u,o,s,l)]=!0,a=c)),i[Lce(a,o,s,l)]=!0,e.borderSkipped=i}function Lce(e,t,n,r){var a,i,o;return r?(o=n,e=Pce(e=(a=e)===(i=t)?o:a===o?i:a,n,t)):e=Pce(e,t,n),e}function Pce(e,t,n){return"start"===e?t:"end"===e?n:e}function Mce(e,t,n){let{inflateAmount:r}=t;e.inflateAmount="auto"===r?1===n?.33:0:r}(0,hn.A)(Tce,"defaults",{}),(0,hn.A)(Tce,"datasetElementType",null),(0,hn.A)(Tce,"dataElementType",null);class jce extends Tce{parsePrimitiveData(e,t,n,r){return Dce(e,t,n,r)}parseArrayData(e,t,n,r){return Dce(e,t,n,r)}parseObjectData(e,t,n,r){const{iScale:a,vScale:i}=e,{xAxisKey:o="x",yAxisKey:s="y"}=this._parsing,l="x"===a.axis?o:s,c="x"===i.axis?o:s,u=[];let h,d,f,p;for(h=n,d=n+r;h<d;++h)p=t[h],f={},f[a.axis]=a.parse(zoe(p,l),h),u.push(Rce(zoe(p,c),f,i,h));return u}updateRangeFromParsed(e,t,n,r){super.updateRangeFromParsed(e,t,n,r);const a=n._custom;a&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,a.min),e.max=Math.max(e.max,a.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:n,vScale:r}=t,a=this.getParsed(e),i=a._custom,o=Fce(i)?"["+i.start+", "+i.end+"]":""+r.getLabelForValue(a[r.axis]);return{label:""+n.getLabelForValue(a[n.axis]),value:o}}initialize(){this.enableOptionSharing=!0,super.initialize();this._cachedMeta.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,n,r){const a="reset"===r,{index:i,_cachedMeta:{vScale:o}}=this,s=o.getBasePixel(),l=o.isHorizontal(),c=this._getRuler(),{sharedOptions:u,includeOptions:h}=this._getSharedOptions(t,r);for(let d=t;d<t+n;d++){const t=this.getParsed(d),n=a||Noe(t[o.axis])?{base:s,head:s}:this._calculateBarValuePixels(d),f=this._calculateBarIndexPixels(d,c),p=(t._stacks||{})[o.axis],g={horizontal:l,base:n.base,enableBorderRadius:!p||Fce(t._custom)||i===p._top||i===p._bottom,x:l?n.head:f.center,y:l?f.center:n.head,height:l?f.size:Math.abs(n.size),width:l?Math.abs(n.size):f.size};h&&(g.options=u||this.resolveDataElementOptions(d,e[d].active?"active":r));const m=g.options||e[d].options;Oce(g,m,p,i),Mce(g,m,c.ratio),this.updateElement(e[d],d,g,r)}}_getStacks(e,t){const{iScale:n}=this._cachedMeta,r=n.getMatchingVisibleMetas(this._type).filter(e=>e.controller.options.grouped),a=n.options.stacked,i=[],o=this._cachedMeta.controller.getParsed(t),s=o&&o[n.axis],l=e=>{const t=e._parsed.find(e=>e[n.axis]===s),r=t&&t[e.vScale.axis];if(Noe(r)||isNaN(r))return!0};for(const c of r)if((void 0===t||!l(c))&&((!1===a||-1===i.indexOf(c.stack)||void 0===a&&void 0===c.stack)&&i.push(c.stack),c.index===e))break;return i.length||i.push(void 0),i}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,t=this.chart.options.indexAxis;return Object.keys(e).filter(n=>e[n].axis===t).shift()}_getAxis(){const e={},t=this.getFirstScaleIdForIndexAxis();for(const n of this.chart.data.datasets)e[Ioe("x"===this.chart.options.indexAxis?n.xAxisID:n.yAxisID,t)]=!0;return Object.keys(e)}_getStackIndex(e,t,n){const r=this._getStacks(e,n),a=void 0!==t?r.indexOf(t):-1;return-1===a?r.length-1:a}_getRuler(){const e=this.options,t=this._cachedMeta,n=t.iScale,r=[];let a,i;for(a=0,i=t.data.length;a<i;++a)r.push(n.getPixelForValue(this.getParsed(a)[n.axis],a));const o=e.barThickness;return{min:o||Ace(t),pixels:r,start:n._startPixel,end:n._endPixel,stackCount:this._getStackCount(),scale:n,grouped:e.grouped,ratio:o?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:n,index:r},options:{base:a,minBarLength:i}}=this,o=a||0,s=this.getParsed(e),l=s._custom,c=Fce(l);let u,h,d=s[t.axis],f=0,p=n?this.applyStack(t,s,n):d;p!==d&&(f=p-d,p=d),c&&(d=l.barStart,p=l.barEnd-l.barStart,0!==d&&ese(d)!==ese(l.barEnd)&&(f=0),f+=d);const g=Noe(a)||c?f:a;let m=t.getPixelForValue(g);if(u=this.chart.getDataVisibility(e)?t.getPixelForValue(f+p):m,h=u-m,Math.abs(h)<i){h=function(e,t,n){return 0!==e?ese(e):(t.isHorizontal()?1:-1)*(t.min>=n?1:-1)}(h,t,o)*i,d===o&&(m-=h/2);const e=t.getPixelForDecimal(0),a=t.getPixelForDecimal(1),l=Math.min(e,a),f=Math.max(e,a);m=Math.max(Math.min(m,f),l),u=m+h,n&&!c&&(s._stacks[t.axis]._visualValues[r]=t.getValueForPixel(u)-t.getValueForPixel(m))}if(m===t.getPixelForValue(o)){const e=ese(h)*t.getLineWidthForValue(o)/2;m+=e,h-=e}return{size:h,base:m,head:u,center:u+h/2}}_calculateBarIndexPixels(e,t){const n=t.scale,r=this.options,a=r.skipNull,i=Ioe(r.maxBarThickness,1/0);let o,s;const l=this._getAxisCount();if(t.grouped){const n=a?this._getStackCount(e):t.stackCount,c="flex"===r.barThickness?function(e,t,n,r){const a=t.pixels,i=a[e];let o=e>0?a[e-1]:null,s=e<a.length-1?a[e+1]:null;const l=n.categoryPercentage;null===o&&(o=i-(null===s?t.end-t.start:s-i)),null===s&&(s=i+i-o);const c=i-(i-Math.min(o,s))/2*l;return{chunk:Math.abs(s-o)/2*l/r,ratio:n.barPercentage,start:c}}(e,t,r,n*l):function(e,t,n,r){const a=n.barThickness;let i,o;return Noe(a)?(i=t.min*n.categoryPercentage,o=n.barPercentage):(i=a*r,o=1),{chunk:i/r,ratio:o,start:t.pixels[e]-i/2}}(e,t,r,n*l),u="x"===this.chart.options.indexAxis?this.getDataset().xAxisID:this.getDataset().yAxisID,h=this._getAxis().indexOf(Ioe(u,this.getFirstScaleIdForIndexAxis())),d=this._getStackIndex(this.index,this._cachedMeta.stack,a?e:void 0)+h;o=c.start+c.chunk*d+c.chunk/2,s=Math.min(i,c.chunk*c.ratio)}else o=n.getPixelForValue(this.getParsed(e)[n.axis],e),s=Math.min(i,t.min*t.ratio);return{base:o-s/2,head:o+s/2,center:o,size:s}}draw(){const e=this._cachedMeta,t=e.vScale,n=e.data,r=n.length;let a=0;for(;a<r;++a)null===this.getParsed(a)[t.axis]||n[a].hidden||n[a].draw(this._ctx)}}(0,hn.A)(jce,"id","bar"),(0,hn.A)(jce,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),(0,hn.A)(jce,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class Bce extends Tce{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,t,n,r){const a=super.parsePrimitiveData(e,t,n,r);for(let i=0;i<a.length;i++)a[i]._custom=this.resolveDataElementOptions(i+n).radius;return a}parseArrayData(e,t,n,r){const a=super.parseArrayData(e,t,n,r);for(let i=0;i<a.length;i++){const e=t[n+i];a[i]._custom=Ioe(e[2],this.resolveDataElementOptions(i+n).radius)}return a}parseObjectData(e,t,n,r){const a=super.parseObjectData(e,t,n,r);for(let i=0;i<a.length;i++){const e=t[n+i];a[i]._custom=Ioe(e&&e.r&&+e.r,this.resolveDataElementOptions(i+n).radius)}return a}getMaxOverflow(){const e=this._cachedMeta.data;let t=0;for(let n=e.length-1;n>=0;--n)t=Math.max(t,e[n].size(this.resolveDataElementOptions(n))/2);return t>0&&t}getLabelAndValue(e){const t=this._cachedMeta,n=this.chart.data.labels||[],{xScale:r,yScale:a}=t,i=this.getParsed(e),o=r.getLabelForValue(i.x),s=a.getLabelForValue(i.y),l=i._custom;return{label:n[e]||"",value:"("+o+", "+s+(l?", "+l:"")+")"}}update(e){const t=this._cachedMeta.data;this.updateElements(t,0,t.length,e)}updateElements(e,t,n,r){const a="reset"===r,{iScale:i,vScale:o}=this._cachedMeta,{sharedOptions:s,includeOptions:l}=this._getSharedOptions(t,r),c=i.axis,u=o.axis;for(let h=t;h<t+n;h++){const t=e[h],n=!a&&this.getParsed(h),d={},f=d[c]=a?i.getPixelForDecimal(.5):i.getPixelForValue(n[c]),p=d[u]=a?o.getBasePixel():o.getPixelForValue(n[u]);d.skip=isNaN(f)||isNaN(p),l&&(d.options=s||this.resolveDataElementOptions(h,t.active?"active":r),a&&(d.options.radius=0)),this.updateElement(t,h,d,r)}}resolveDataElementOptions(e,t){const n=this.getParsed(e);let r=super.resolveDataElementOptions(e,t);r.$shared&&(r=Object.assign({},r,{$shared:!1}));const a=r.radius;return"active"!==t&&(r.radius=0),r.radius+=Ioe(n&&n._custom,a),r}}(0,hn.A)(Bce,"id","bubble"),(0,hn.A)(Bce,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),(0,hn.A)(Bce,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});class zce extends Tce{constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const n=this.getDataset().data,r=this._cachedMeta;if(!1===this._parsing)r._parsed=n;else{let a,i,o=e=>+n[e];if(Coe(n[e])){const{key:e="value"}=this._parsing;o=t=>+zoe(n[t],e)}for(a=e,i=e+t;a<i;++a)r._parsed[a]=o(a)}}_getRotation(){return ise(this.options.rotation-90)}_getCircumference(){return ise(this.options.circumference)}_getRotationExtents(){let e=qoe,t=-qoe;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){const r=this.chart.getDatasetMeta(n).controller,a=r._getRotation(),i=r._getCircumference();e=Math.min(e,a),t=Math.max(t,a+i)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:n}=t,r=this._cachedMeta,a=r.data,i=this.getMaxBorderWidth()+this.getMaxOffset(a)+this.options.spacing,o=Math.max((Math.min(n.width,n.height)-i)/2,0),s=Math.min(((e,t)=>"string"===typeof e&&e.endsWith("%")?parseFloat(e)/100:+e/t)(this.options.cutout,o),1),l=this._getRingWeight(this.index),{circumference:c,rotation:u}=this._getRotationExtents(),{ratioX:h,ratioY:d,offsetX:f,offsetY:p}=function(e,t,n){let r=1,a=1,i=0,o=0;if(t<qoe){const s=e,l=s+t,c=Math.cos(s),u=Math.sin(s),h=Math.cos(l),d=Math.sin(l),f=(e,t,r)=>dse(e,s,l,!0)?1:Math.max(t,t*n,r,r*n),p=(e,t,r)=>dse(e,s,l,!0)?-1:Math.min(t,t*n,r,r*n),g=f(0,c,h),m=f($oe,u,d),v=p(Goe,c,h),b=p(Goe+$oe,u,d);r=(g-v)/2,a=(m-b)/2,i=-(g+v)/2,o=-(m+b)/2}return{ratioX:r,ratioY:a,offsetX:i,offsetY:o}}(u,c,s),g=(n.width-i)/h,m=(n.height-i)/d,v=Math.max(Math.min(g,m)/2,0),b=Toe(this.options.radius,v),x=(b-Math.max(b*s,0))/this._getVisibleDatasetWeightTotal();this.offsetX=f*b,this.offsetY=p*b,r.total=this.calculateTotal(),this.outerRadius=b-x*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-x*l,0),this.updateElements(a,0,a.length,e)}_circumference(e,t){const n=this.options,r=this._cachedMeta,a=this._getCircumference();return t&&n.animation.animateRotate||!this.chart.getDataVisibility(e)||null===r._parsed[e]||r.data[e].hidden?0:this.calculateCircumference(r._parsed[e]*a/qoe)}updateElements(e,t,n,r){const a="reset"===r,i=this.chart,o=i.chartArea,s=i.options.animation,l=(o.left+o.right)/2,c=(o.top+o.bottom)/2,u=a&&s.animateScale,h=u?0:this.innerRadius,d=u?0:this.outerRadius,{sharedOptions:f,includeOptions:p}=this._getSharedOptions(t,r);let g,m=this._getRotation();for(g=0;g<t;++g)m+=this._circumference(g,a);for(g=t;g<t+n;++g){const t=this._circumference(g,a),n=e[g],i={x:l+this.offsetX,y:c+this.offsetY,startAngle:m,endAngle:m+t,circumference:t,outerRadius:d,innerRadius:h};p&&(i.options=f||this.resolveDataElementOptions(g,n.active?"active":r)),m+=t,this.updateElement(n,g,i,r)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let n,r=0;for(n=0;n<t.length;n++){const a=e._parsed[n];null===a||isNaN(a)||!this.chart.getDataVisibility(n)||t[n].hidden||(r+=Math.abs(a))}return r}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?qoe*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,n=this.chart,r=n.data.labels||[],a=Mse(t._parsed[e],n.options.locale);return{label:r[e]||"",value:a}}getMaxBorderWidth(e){let t=0;const n=this.chart;let r,a,i,o,s;if(!e)for(r=0,a=n.data.datasets.length;r<a;++r)if(n.isDatasetVisible(r)){i=n.getDatasetMeta(r),e=i.data,o=i.controller;break}if(!e)return 0;for(r=0,a=e.length;r<a;++r)s=o.resolveDataElementOptions(r),"inner"!==s.borderAlign&&(t=Math.max(t,s.borderWidth||0,s.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let n=0,r=e.length;n<r;++n){const e=this.resolveDataElementOptions(n);t=Math.max(t,e.offset||0,e.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let n=0;n<e;++n)this.chart.isDatasetVisible(n)&&(t+=this._getRingWeight(n));return t}_getRingWeight(e){return Math.max(Ioe(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}(0,hn.A)(zce,"id","doughnut"),(0,hn.A)(zce,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),(0,hn.A)(zce,"descriptors",{_scriptable:e=>"spacing"!==e,_indexable:e=>"spacing"!==e&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),(0,hn.A)(zce,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data,{labels:{pointStyle:n,textAlign:r,color:a,useBorderRadius:i,borderRadius:o}}=e.legend.options;return t.labels.length&&t.datasets.length?t.labels.map((t,s)=>{const l=e.getDatasetMeta(0).controller.getStyle(s);return{text:t,fillStyle:l.backgroundColor,fontColor:a,hidden:!e.getDataVisibility(s),lineDash:l.borderDash,lineDashOffset:l.borderDashOffset,lineJoin:l.borderJoinStyle,lineWidth:l.borderWidth,strokeStyle:l.borderColor,textAlign:r,pointStyle:n,borderRadius:i&&(o||l.borderRadius),index:s}}):[]}},onClick(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}}}});class Wce extends Tce{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:n,data:r=[],_dataset:a}=t,i=this.chart._animationsDisabled;let{start:o,count:s}=Cse(t,r,i);this._drawStart=o,this._drawCount=s,Ese(t)&&(o=0,s=r.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!a._decimated,n.points=r;const l=this.resolveDatasetElementOptions(e);this.options.showLine||(l.borderWidth=0),l.segment=this.options.segment,this.updateElement(n,void 0,{animated:!i,options:l},e),this.updateElements(r,o,s,e)}updateElements(e,t,n,r){const a="reset"===r,{iScale:i,vScale:o,_stacked:s,_dataset:l}=this._cachedMeta,{sharedOptions:c,includeOptions:u}=this._getSharedOptions(t,r),h=i.axis,d=o.axis,{spanGaps:f,segment:p}=this.options,g=rse(f)?f:Number.POSITIVE_INFINITY,m=this.chart._animationsDisabled||a||"none"===r,v=t+n,b=e.length;let x=t>0&&this.getParsed(t-1);for(let y=0;y<b;++y){const n=e[y],f=m?n:{};if(y<t||y>=v){f.skip=!0;continue}const b=this.getParsed(y),w=Noe(b[d]),k=f[h]=i.getPixelForValue(b[h],y),N=f[d]=a||w?o.getBasePixel():o.getPixelForValue(s?this.applyStack(o,b,s):b[d],y);f.skip=isNaN(k)||isNaN(N)||w,f.stop=y>0&&Math.abs(b[h]-x[h])>g,p&&(f.parsed=b,f.raw=l.data[y]),u&&(f.options=c||this.resolveDataElementOptions(y,n.active?"active":r)),m||this.updateElement(n,y,f,r),x=b}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,n=t.options&&t.options.borderWidth||0,r=e.data||[];if(!r.length)return n;const a=r[0].size(this.resolveDataElementOptions(0)),i=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(n,a,i)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}(0,hn.A)(Wce,"id","line"),(0,hn.A)(Wce,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),(0,hn.A)(Wce,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class Uce extends Tce{constructor(e,t){super(e,t),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const t=this._cachedMeta,n=this.chart,r=n.data.labels||[],a=Mse(t._parsed[e].r,n.options.locale);return{label:r[e]||"",value:a}}parseObjectData(e,t,n,r){return Rle.bind(this)(e,t,n,r)}update(e){const t=this._cachedMeta.data;this._updateRadius(),this.updateElements(t,0,t.length,e)}getMinMax(){const e=this._cachedMeta,t={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((e,n)=>{const r=this.getParsed(n).r;!isNaN(r)&&this.chart.getDataVisibility(n)&&(r<t.min&&(t.min=r),r>t.max&&(t.max=r))}),t}_updateRadius(){const e=this.chart,t=e.chartArea,n=e.options,r=Math.min(t.right-t.left,t.bottom-t.top),a=Math.max(r/2,0),i=(a-Math.max(n.cutoutPercentage?a/100*n.cutoutPercentage:1,0))/e.getVisibleDatasetCount();this.outerRadius=a-i*this.index,this.innerRadius=this.outerRadius-i}updateElements(e,t,n,r){const a="reset"===r,i=this.chart,o=i.options.animation,s=this._cachedMeta.rScale,l=s.xCenter,c=s.yCenter,u=s.getIndexAngle(0)-.5*Goe;let h,d=u;const f=360/this.countVisibleElements();for(h=0;h<t;++h)d+=this._computeAngle(h,r,f);for(h=t;h<t+n;h++){const t=e[h];let n=d,p=d+this._computeAngle(h,r,f),g=i.getDataVisibility(h)?s.getDistanceFromCenterForValue(this.getParsed(h).r):0;d=p,a&&(o.animateScale&&(g=0),o.animateRotate&&(n=p=u));const m={x:l,y:c,innerRadius:0,outerRadius:g,startAngle:n,endAngle:p,options:this.resolveDataElementOptions(h,t.active?"active":r)};this.updateElement(t,h,m,r)}}countVisibleElements(){const e=this._cachedMeta;let t=0;return e.data.forEach((e,n)=>{!isNaN(this.getParsed(n).r)&&this.chart.getDataVisibility(n)&&t++}),t}_computeAngle(e,t,n){return this.chart.getDataVisibility(e)?ise(this.resolveDataElementOptions(e,t).angle||n):0}}(0,hn.A)(Uce,"id","polarArea"),(0,hn.A)(Uce,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),(0,hn.A)(Uce,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:n,color:r}}=e.legend.options;return t.labels.map((t,a)=>{const i=e.getDatasetMeta(0).controller.getStyle(a);return{text:t,fillStyle:i.backgroundColor,strokeStyle:i.borderColor,fontColor:r,lineWidth:i.borderWidth,pointStyle:n,hidden:!e.getDataVisibility(a),index:a}})}return[]}},onClick(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class Vce extends zce{}(0,hn.A)(Vce,"id","pie"),(0,hn.A)(Vce,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class Hce extends Tce{getLabelAndValue(e){const t=this._cachedMeta.vScale,n=this.getParsed(e);return{label:t.getLabels()[e],value:""+t.getLabelForValue(n[t.axis])}}parseObjectData(e,t,n,r){return Rle.bind(this)(e,t,n,r)}update(e){const t=this._cachedMeta,n=t.dataset,r=t.data||[],a=t.iScale.getLabels();if(n.points=r,"resize"!==e){const t=this.resolveDatasetElementOptions(e);this.options.showLine||(t.borderWidth=0);const i={_loop:!0,_fullLoop:a.length===r.length,options:t};this.updateElement(n,void 0,i,e)}this.updateElements(r,0,r.length,e)}updateElements(e,t,n,r){const a=this._cachedMeta.rScale,i="reset"===r;for(let o=t;o<t+n;o++){const t=e[o],n=this.resolveDataElementOptions(o,t.active?"active":r),s=a.getPointPositionForValue(o,this.getParsed(o).r),l=i?a.xCenter:s.x,c=i?a.yCenter:s.y,u={x:l,y:c,angle:s.angle,skip:isNaN(l)||isNaN(c),options:n};this.updateElement(t,o,u,r)}}}(0,hn.A)(Hce,"id","radar"),(0,hn.A)(Hce,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),(0,hn.A)(Hce,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class Gce extends Tce{getLabelAndValue(e){const t=this._cachedMeta,n=this.chart.data.labels||[],{xScale:r,yScale:a}=t,i=this.getParsed(e),o=r.getLabelForValue(i.x),s=a.getLabelForValue(i.y);return{label:n[e]||"",value:"("+o+", "+s+")"}}update(e){const t=this._cachedMeta,{data:n=[]}=t,r=this.chart._animationsDisabled;let{start:a,count:i}=Cse(t,n,r);if(this._drawStart=a,this._drawCount=i,Ese(t)&&(a=0,i=n.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:a,_dataset:i}=t;a._chart=this.chart,a._datasetIndex=this.index,a._decimated=!!i._decimated,a.points=n;const o=this.resolveDatasetElementOptions(e);o.segment=this.options.segment,this.updateElement(a,void 0,{animated:!r,options:o},e)}else this.datasetElementType&&(delete t.dataset,this.datasetElementType=!1);this.updateElements(n,a,i,e)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,t,n,r){const a="reset"===r,{iScale:i,vScale:o,_stacked:s,_dataset:l}=this._cachedMeta,c=this.resolveDataElementOptions(t,r),u=this.getSharedOptions(c),h=this.includeOptions(r,u),d=i.axis,f=o.axis,{spanGaps:p,segment:g}=this.options,m=rse(p)?p:Number.POSITIVE_INFINITY,v=this.chart._animationsDisabled||a||"none"===r;let b=t>0&&this.getParsed(t-1);for(let x=t;x<t+n;++x){const t=e[x],n=this.getParsed(x),c=v?t:{},p=Noe(n[f]),y=c[d]=i.getPixelForValue(n[d],x),w=c[f]=a||p?o.getBasePixel():o.getPixelForValue(s?this.applyStack(o,n,s):n[f],x);c.skip=isNaN(y)||isNaN(w)||p,c.stop=x>0&&Math.abs(n[d]-b[d])>m,g&&(c.parsed=n,c.raw=l.data[x]),h&&(c.options=u||this.resolveDataElementOptions(x,t.active?"active":r)),v||this.updateElement(t,x,c,r),b=n}this.updateSharedOptions(u,r,c)}getMaxOverflow(){const e=this._cachedMeta,t=e.data||[];if(!this.options.showLine){let e=0;for(let n=t.length-1;n>=0;--n)e=Math.max(e,t[n].size(this.resolveDataElementOptions(n))/2);return e>0&&e}const n=e.dataset,r=n.options&&n.options.borderWidth||0;if(!t.length)return r;const a=t[0].size(this.resolveDataElementOptions(0)),i=t[t.length-1].size(this.resolveDataElementOptions(t.length-1));return Math.max(r,a,i)/2}}(0,hn.A)(Gce,"id","scatter"),(0,hn.A)(Gce,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),(0,hn.A)(Gce,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});function qce(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Kce{static override(e){Object.assign(Kce.prototype,e)}constructor(e){(0,hn.A)(this,"options",void 0),this.options=e||{}}init(){}formats(){return qce()}parse(){return qce()}format(){return qce()}add(){return qce()}diff(){return qce()}startOf(){return qce()}endOf(){return qce()}}var Xce=Kce;function Yce(e,t,n,r){const{controller:a,data:i,_sorted:o}=e,s=a._cachedMeta.iScale,l=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null;if(s&&t===s.axis&&"r"!==t&&o&&i.length){const o=s._reversePixels?vse:mse;if(!r){const r=o(i,t,n);if(l){const{vScale:t}=a._cachedMeta,{_parsed:n}=e,i=n.slice(0,r.lo+1).reverse().findIndex(e=>!Noe(e[t.axis]));r.lo-=Math.max(0,i);const o=n.slice(r.hi).findIndex(e=>!Noe(e[t.axis]));r.hi+=Math.max(0,o)}return r}if(a._sharedOptions){const e=i[0],r="function"===typeof e.getRange&&e.getRange(t);if(r){const e=o(i,t,n-r),a=o(i,t,n+r);return{lo:e.lo,hi:a.hi}}}}return{lo:0,hi:i.length-1}}function $ce(e,t,n,r,a){const i=e.getSortedVisibleDatasetMetas(),o=n[t];for(let s=0,l=i.length;s<l;++s){const{index:e,data:n}=i[s],{lo:l,hi:c}=Yce(i[s],t,o,a);for(let t=l;t<=c;++t){const a=n[t];a.skip||r(a,e,t)}}}function Jce(e,t,n,r,a){const i=[];if(!a&&!e.isPointInArea(t))return i;return $ce(e,n,t,function(n,o,s){(a||Qse(n,e.chartArea,0))&&n.inRange(t.x,t.y,r)&&i.push({element:n,datasetIndex:o,index:s})},!0),i}function Qce(e,t,n,r,a,i){let o=[];const s=function(e){const t=-1!==e.indexOf("x"),n=-1!==e.indexOf("y");return function(e,r){const a=t?Math.abs(e.x-r.x):0,i=n?Math.abs(e.y-r.y):0;return Math.sqrt(Math.pow(a,2)+Math.pow(i,2))}}(n);let l=Number.POSITIVE_INFINITY;return $ce(e,n,t,function(n,c,u){const h=n.inRange(t.x,t.y,a);if(r&&!h)return;const d=n.getCenterPoint(a);if(!(!!i||e.isPointInArea(d))&&!h)return;const f=s(t,d);f<l?(o=[{element:n,datasetIndex:c,index:u}],l=f):f===l&&o.push({element:n,datasetIndex:c,index:u})}),o}function Zce(e,t,n,r,a,i){return i||e.isPointInArea(t)?"r"!==n||r?Qce(e,t,n,r,a,i):function(e,t,n,r){let a=[];return $ce(e,n,t,function(e,n,i){const{startAngle:o,endAngle:s}=e.getProps(["startAngle","endAngle"],r),{angle:l}=lse(e,{x:t.x,y:t.y});dse(l,o,s)&&a.push({element:e,datasetIndex:n,index:i})}),a}(e,t,n,a):[]}function eue(e,t,n,r,a){const i=[],o="x"===n?"inXRange":"inYRange";let s=!1;return $ce(e,n,t,(e,r,l)=>{e[o]&&e[o](t[n],a)&&(i.push({element:e,datasetIndex:r,index:l}),s=s||e.inRange(t.x,t.y,a))}),r&&!s?[]:i}var tue={evaluateInteractionItems:$ce,modes:{index(e,t,n,r){const a=Gle(t,e),i=n.axis||"x",o=n.includeInvisible||!1,s=n.intersect?Jce(e,a,i,r,o):Zce(e,a,i,!1,r,o),l=[];return s.length?(e.getSortedVisibleDatasetMetas().forEach(e=>{const t=s[0].index,n=e.data[t];n&&!n.skip&&l.push({element:n,datasetIndex:e.index,index:t})}),l):[]},dataset(e,t,n,r){const a=Gle(t,e),i=n.axis||"xy",o=n.includeInvisible||!1;let s=n.intersect?Jce(e,a,i,r,o):Zce(e,a,i,!1,r,o);if(s.length>0){const t=s[0].datasetIndex,n=e.getDatasetMeta(t).data;s=[];for(let e=0;e<n.length;++e)s.push({element:n[e],datasetIndex:t,index:e})}return s},point:(e,t,n,r)=>Jce(e,Gle(t,e),n.axis||"xy",r,n.includeInvisible||!1),nearest(e,t,n,r){const a=Gle(t,e),i=n.axis||"xy",o=n.includeInvisible||!1;return Zce(e,a,i,n.intersect,r,o)},x:(e,t,n,r)=>eue(e,Gle(t,e),"x",n.intersect,r),y:(e,t,n,r)=>eue(e,Gle(t,e),"y",n.intersect,r)}};const nue=["left","top","right","bottom"];function rue(e,t){return e.filter(e=>e.pos===t)}function aue(e,t){return e.filter(e=>-1===nue.indexOf(e.pos)&&e.box.axis===t)}function iue(e,t){return e.sort((e,n)=>{const r=t?n:e,a=t?e:n;return r.weight===a.weight?r.index-a.index:r.weight-a.weight})}function oue(e,t){const n=function(e){const t={};for(const n of e){const{stack:e,pos:r,stackWeight:a}=n;if(!e||!nue.includes(r))continue;const i=t[e]||(t[e]={count:0,placed:0,weight:0,size:0});i.count++,i.weight+=a}return t}(e),{vBoxMaxWidth:r,hBoxMaxHeight:a}=t;let i,o,s;for(i=0,o=e.length;i<o;++i){s=e[i];const{fullSize:o}=s.box,l=n[s.stack],c=l&&s.stackWeight/l.weight;s.horizontal?(s.width=c?c*r:o&&t.availableWidth,s.height=a):(s.width=r,s.height=c?c*a:o&&t.availableHeight)}return n}function sue(e,t,n,r){return Math.max(e[n],t[n])+Math.max(e[r],t[r])}function lue(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function cue(e,t,n,r){const{pos:a,box:i}=n,o=e.maxPadding;if(!Coe(a)){n.size&&(e[a]-=n.size);const t=r[n.stack]||{size:0,count:1};t.size=Math.max(t.size,n.horizontal?i.height:i.width),n.size=t.size/t.count,e[a]+=n.size}i.getPadding&&lue(o,i.getPadding());const s=Math.max(0,t.outerWidth-sue(o,e,"left","right")),l=Math.max(0,t.outerHeight-sue(o,e,"top","bottom")),c=s!==e.w,u=l!==e.h;return e.w=s,e.h=l,n.horizontal?{same:c,other:u}:{same:u,other:c}}function uue(e,t){const n=t.maxPadding;function r(e){const r={left:0,top:0,right:0,bottom:0};return e.forEach(e=>{r[e]=Math.max(t[e],n[e])}),r}return r(e?["left","right"]:["top","bottom"])}function hue(e,t,n,r){const a=[];let i,o,s,l,c,u;for(i=0,o=e.length,c=0;i<o;++i){s=e[i],l=s.box,l.update(s.width||t.w,s.height||t.h,uue(s.horizontal,t));const{same:o,other:h}=cue(t,n,s,r);c|=o&&a.length,u=u||h,l.fullSize||a.push(s)}return c&&hue(a,t,n,r)||u}function due(e,t,n,r,a){e.top=n,e.left=t,e.right=t+r,e.bottom=n+a,e.width=r,e.height=a}function fue(e,t,n,r){const a=n.padding;let{x:i,y:o}=t;for(const s of e){const e=s.box,l=r[s.stack]||{count:1,placed:0,weight:1},c=s.stackWeight/l.weight||1;if(s.horizontal){const r=t.w*c,i=l.size||e.height;Uoe(l.start)&&(o=l.start),e.fullSize?due(e,a.left,o,n.outerWidth-a.right-a.left,i):due(e,t.left+l.placed,o,r,i),l.start=o,l.placed+=r,o=e.bottom}else{const r=t.h*c,o=l.size||e.width;Uoe(l.start)&&(i=l.start),e.fullSize?due(e,i,a.top,o,n.outerHeight-a.bottom-a.top):due(e,i,t.top+l.placed,o,r),l.start=i,l.placed+=r,i=e.right}}t.x=i,t.y=o}var pue={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(e){t.draw(e)}}]},e.boxes.push(t)},removeBox(e,t){const n=e.boxes?e.boxes.indexOf(t):-1;-1!==n&&e.boxes.splice(n,1)},configure(e,t,n){t.fullSize=n.fullSize,t.position=n.position,t.weight=n.weight},update(e,t,n,r){if(!e)return;const a=ple(e.options.layout.padding),i=Math.max(t-a.width,0),o=Math.max(n-a.height,0),s=function(e){const t=function(e){const t=[];let n,r,a,i,o,s;for(n=0,r=(e||[]).length;n<r;++n)a=e[n],({position:i,options:{stack:o,stackWeight:s=1}}=a),t.push({index:n,box:a,pos:i,horizontal:a.isHorizontal(),weight:a.weight,stack:o&&i+o,stackWeight:s});return t}(e),n=iue(t.filter(e=>e.box.fullSize),!0),r=iue(rue(t,"left"),!0),a=iue(rue(t,"right")),i=iue(rue(t,"top"),!0),o=iue(rue(t,"bottom")),s=aue(t,"x"),l=aue(t,"y");return{fullSize:n,leftAndTop:r.concat(i),rightAndBottom:a.concat(l).concat(o).concat(s),chartArea:rue(t,"chartArea"),vertical:r.concat(a).concat(l),horizontal:i.concat(o).concat(s)}}(e.boxes),l=s.vertical,c=s.horizontal;Roe(e.boxes,e=>{"function"===typeof e.beforeLayout&&e.beforeLayout()});const u=l.reduce((e,t)=>t.box.options&&!1===t.box.options.display?e:e+1,0)||1,h=Object.freeze({outerWidth:t,outerHeight:n,padding:a,availableWidth:i,availableHeight:o,vBoxMaxWidth:i/2/u,hBoxMaxHeight:o/2}),d=Object.assign({},a);lue(d,ple(r));const f=Object.assign({maxPadding:d,w:i,h:o,x:a.left,y:a.top},a),p=oue(l.concat(c),h);hue(s.fullSize,f,h,p),hue(l,f,h,p),hue(c,f,h,p)&&hue(l,f,h,p),function(e){const t=e.maxPadding;function n(n){const r=Math.max(t[n]-e[n],0);return e[n]+=r,r}e.y+=n("top"),e.x+=n("left"),n("right"),n("bottom")}(f),fue(s.leftAndTop,f,h,p),f.x+=f.w,f.y+=f.h,fue(s.rightAndBottom,f,h,p),e.chartArea={left:f.left,top:f.top,right:f.left+f.w,bottom:f.top+f.h,height:f.h,width:f.w},Roe(s.chartArea,t=>{const n=t.box;Object.assign(n,e.chartArea),n.update(f.w,f.h,{left:0,top:0,right:0,bottom:0})})}};class gue{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,n){}removeEventListener(e,t,n){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,n,r){return t=Math.max(0,t||e.width),n=n||e.height,{width:t,height:Math.max(0,r?Math.floor(t/r):n)}}isAttached(e){return!0}updateConfig(e){}}class mue extends gue{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const vue="$chartjs",bue={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},xue=e=>null===e||""===e;const yue=!!Yle&&{passive:!0};function wue(e,t,n){e&&e.canvas&&e.canvas.removeEventListener(t,n,yue)}function kue(e,t){for(const n of e)if(n===t||n.contains(t))return!0}function Nue(e,t,n){const r=e.canvas,a=new MutationObserver(e=>{let t=!1;for(const n of e)t=t||kue(n.addedNodes,r),t=t&&!kue(n.removedNodes,r);t&&n()});return a.observe(document,{childList:!0,subtree:!0}),a}function Sue(e,t,n){const r=e.canvas,a=new MutationObserver(e=>{let t=!1;for(const n of e)t=t||kue(n.removedNodes,r),t=t&&!kue(n.addedNodes,r);t&&n()});return a.observe(document,{childList:!0,subtree:!0}),a}const Cue=new Map;let Eue=0;function _ue(){const e=window.devicePixelRatio;e!==Eue&&(Eue=e,Cue.forEach((t,n)=>{n.currentDevicePixelRatio!==e&&t()}))}function Iue(e,t,n){const r=e.canvas,a=r&&zle(r);if(!a)return;const i=kse((e,t)=>{const r=a.clientWidth;n(e,t),r<a.clientWidth&&n()},window),o=new ResizeObserver(e=>{const t=e[0],n=t.contentRect.width,r=t.contentRect.height;0===n&&0===r||i(n,r)});return o.observe(a),function(e,t){Cue.size||window.addEventListener("resize",_ue),Cue.set(e,t)}(e,i),o}function Tue(e,t,n){n&&n.disconnect(),"resize"===t&&function(e){Cue.delete(e),Cue.size||window.removeEventListener("resize",_ue)}(e)}function Aue(e,t,n){const r=e.canvas,a=kse(t=>{null!==e.ctx&&n(function(e,t){const n=bue[e.type]||e.type,{x:r,y:a}=Gle(e,t);return{type:n,chart:t,native:e,x:void 0!==r?r:null,y:void 0!==a?a:null}}(t,e))},e);return function(e,t,n){e&&e.addEventListener(t,n,yue)}(r,t,a),a}class Rue extends gue{acquireContext(e,t){const n=e&&e.getContext&&e.getContext("2d");return n&&n.canvas===e?(function(e,t){const n=e.style,r=e.getAttribute("height"),a=e.getAttribute("width");if(e[vue]={initial:{height:r,width:a,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",xue(a)){const t=$le(e,"width");void 0!==t&&(e.width=t)}if(xue(r))if(""===e.style.height)e.height=e.width/(t||2);else{const t=$le(e,"height");void 0!==t&&(e.height=t)}}(e,t),n):null}releaseContext(e){const t=e.canvas;if(!t[vue])return!1;const n=t[vue].initial;["height","width"].forEach(e=>{const r=n[e];Noe(r)?t.removeAttribute(e):t.setAttribute(e,r)});const r=n.style||{};return Object.keys(r).forEach(e=>{t.style[e]=r[e]}),t.width=t.width,delete t[vue],!0}addEventListener(e,t,n){this.removeEventListener(e,t);const r=e.$proxies||(e.$proxies={}),a={attach:Nue,detach:Sue,resize:Iue}[t]||Aue;r[t]=a(e,t,n)}removeEventListener(e,t){const n=e.$proxies||(e.$proxies={}),r=n[t];if(!r)return;({attach:Tue,detach:Tue,resize:Tue}[t]||wue)(e,t,r),n[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,n,r){return Kle(e,t,n,r)}isAttached(e){const t=e&&zle(e);return!(!t||!t.isConnected)}}class Due{constructor(){(0,hn.A)(this,"x",void 0),(0,hn.A)(this,"y",void 0),(0,hn.A)(this,"active",!1),(0,hn.A)(this,"options",void 0),(0,hn.A)(this,"$animations",void 0)}tooltipPosition(e){const{x:t,y:n}=this.getProps(["x","y"],e);return{x:t,y:n}}hasValue(){return rse(this.x)&&rse(this.y)}getProps(e,t){const n=this.$animations;if(!t||!n)return this;const r={};return e.forEach(e=>{r[e]=n[e]&&n[e].active()?n[e]._to:this[e]}),r}}function Fue(e,t){const n=e.options.ticks,r=function(e){const t=e.options.offset,n=e._tickSize(),r=e._length/n+(t?0:1),a=e._maxLength/n;return Math.floor(Math.min(r,a))}(e),a=Math.min(n.maxTicksLimit||r,r),i=n.major.enabled?function(e){const t=[];let n,r;for(n=0,r=e.length;n<r;n++)e[n].major&&t.push(n);return t}(t):[],o=i.length,s=i[0],l=i[o-1],c=[];if(o>a)return function(e,t,n,r){let a,i=0,o=n[0];for(r=Math.ceil(r),a=0;a<e.length;a++)a===o&&(t.push(e[a]),i++,o=n[i*r])}(t,c,i,o/a),c;const u=function(e,t,n){const r=function(e){const t=e.length;let n,r;if(t<2)return!1;for(r=e[0],n=1;n<t;++n)if(e[n]-e[n-1]!==r)return!1;return r}(e),a=t.length/n;if(!r)return Math.max(a,1);const i=function(e){const t=[],n=Math.sqrt(e);let r;for(r=1;r<n;r++)e%r===0&&(t.push(r),t.push(e/r));return n===(0|n)&&t.push(n),t.sort((e,t)=>e-t).pop(),t}(r);for(let o=0,s=i.length-1;o<s;o++){const e=i[o];if(e>a)return e}return Math.max(a,1)}(i,t,a);if(o>0){let e,n;const r=o>1?Math.round((l-s)/(o-1)):null;for(Oue(t,c,u,Noe(r)?0:s-r,s),e=0,n=o-1;e<n;e++)Oue(t,c,u,i[e],i[e+1]);return Oue(t,c,u,l,Noe(r)?t.length:l+r),c}return Oue(t,c,u),c}function Oue(e,t,n,r,a){const i=Ioe(r,0),o=Math.min(Ioe(a,e.length),e.length);let s,l,c,u=0;for(n=Math.ceil(n),a&&(s=a-r,n=s/Math.floor(s/n)),c=i;c<0;)u++,c=Math.round(i+u*n);for(l=Math.max(i,0);l<o;l++)l===c&&(t.push(e[l]),u++,c=Math.round(i+u*n))}(0,hn.A)(Due,"defaults",{}),(0,hn.A)(Due,"defaultRoutes",void 0);const Lue=(e,t,n)=>"top"===t||"left"===t?e[t]+n:e[t]-n,Pue=(e,t)=>Math.min(t||e,e);function Mue(e,t){const n=[],r=e.length/t,a=e.length;let i=0;for(;i<a;i+=r)n.push(e[Math.floor(i)]);return n}function jue(e,t,n){const r=e.ticks.length,a=Math.min(t,r-1),i=e._startPixel,o=e._endPixel,s=1e-6;let l,c=e.getPixelForTick(a);if(!(n&&(l=1===r?Math.max(c-i,o-c):0===t?(e.getPixelForTick(1)-c)/2:(c-e.getPixelForTick(a-1))/2,c+=a<t?l:-l,c<i-s||c>o+s)))return c}function Bue(e){return e.drawTicks?e.tickLength:0}function zue(e,t){if(!e.display)return 0;const n=gle(e.font,t),r=ple(e.padding);return(Soe(e.text)?e.text.length:1)*n.lineHeight+r.height}function Wue(e,t,n){let r=Nse(e);return(n&&"right"!==t||!n&&"right"===t)&&(r=(e=>"left"===e?"right":"right"===e?"left":e)(r)),r}class Uue extends Due{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:n,_suggestedMax:r}=this;return e=_oe(e,Number.POSITIVE_INFINITY),t=_oe(t,Number.NEGATIVE_INFINITY),n=_oe(n,Number.POSITIVE_INFINITY),r=_oe(r,Number.NEGATIVE_INFINITY),{min:_oe(e,n),max:_oe(t,r),minDefined:Eoe(e),maxDefined:Eoe(t)}}getMinMax(e){let t,{min:n,max:r,minDefined:a,maxDefined:i}=this.getUserBounds();if(a&&i)return{min:n,max:r};const o=this.getMatchingVisibleMetas();for(let s=0,l=o.length;s<l;++s)t=o[s].controller.getMinMax(this,e),a||(n=Math.min(n,t.min)),i||(r=Math.max(r,t.max));return n=i&&n>r?r:n,r=a&&n>r?n:r,{min:_oe(n,_oe(r,n)),max:_oe(r,_oe(n,r))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chart.chartArea;return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Aoe(this.options.beforeUpdate,[this])}update(e,t,n){const{beginAtZero:r,grace:a,ticks:i}=this.options,o=i.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=function(e,t,n){const{min:r,max:a}=e,i=Toe(t,(a-r)/2),o=(e,t)=>n&&0===e?0:e+t;return{min:o(r,-Math.abs(i)),max:o(a,i)}}(this,a,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const s=o<this.ticks.length;this._convertTicksToLabels(s?Mue(this.ticks,o):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),i.display&&(i.autoSkip||"auto"===i.source)&&(this.ticks=Fue(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),s&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e,t,n=this.options.reverse;this.isHorizontal()?(e=this.left,t=this.right):(e=this.top,t=this.bottom,n=!n),this._startPixel=e,this._endPixel=t,this._reversePixels=n,this._length=t-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Aoe(this.options.afterUpdate,[this])}beforeSetDimensions(){Aoe(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Aoe(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Aoe(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Aoe(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let n,r,a;for(n=0,r=e.length;n<r;n++)a=e[n],a.label=Aoe(t.callback,[a.value,n,e],this)}afterTickToLabelConversion(){Aoe(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Aoe(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,n=Pue(this.ticks.length,e.ticks.maxTicksLimit),r=t.minRotation||0,a=t.maxRotation;let i,o,s,l=r;if(!this._isVisible()||!t.display||r>=a||n<=1||!this.isHorizontal())return void(this.labelRotation=r);const c=this._getLabelSizes(),u=c.widest.width,h=c.highest.height,d=fse(this.chart.width-u,0,this.maxWidth);i=e.offset?this.maxWidth/n:d/(n-1),u+6>i&&(i=d/(n-(e.offset?.5:1)),o=this.maxHeight-Bue(e.grid)-t.padding-zue(e.title,this.chart.options.font),s=Math.sqrt(u*u+h*h),l=ose(Math.min(Math.asin(fse((c.highest.height+6)/i,-1,1)),Math.asin(fse(o/s,-1,1))-Math.asin(fse(h/s,-1,1)))),l=Math.max(r,Math.min(a,l))),this.labelRotation=l}afterCalculateLabelRotation(){Aoe(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Aoe(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:n,title:r,grid:a}}=this,i=this._isVisible(),o=this.isHorizontal();if(i){const i=zue(r,t.options.font);if(o?(e.width=this.maxWidth,e.height=Bue(a)+i):(e.height=this.maxHeight,e.width=Bue(a)+i),n.display&&this.ticks.length){const{first:t,last:r,widest:a,highest:i}=this._getLabelSizes(),s=2*n.padding,l=ise(this.labelRotation),c=Math.cos(l),u=Math.sin(l);if(o){const t=n.mirror?0:u*a.width+c*i.height;e.height=Math.min(this.maxHeight,e.height+t+s)}else{const t=n.mirror?0:c*a.width+u*i.height;e.width=Math.min(this.maxWidth,e.width+t+s)}this._calculatePadding(t,r,u,c)}}this._handleMargins(),o?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,n,r){const{ticks:{align:a,padding:i},position:o}=this.options,s=0!==this.labelRotation,l="top"!==o&&"x"===this.axis;if(this.isHorizontal()){const o=this.getPixelForTick(0)-this.left,c=this.right-this.getPixelForTick(this.ticks.length-1);let u=0,h=0;s?l?(u=r*e.width,h=n*t.height):(u=n*e.height,h=r*t.width):"start"===a?h=t.width:"end"===a?u=e.width:"inner"!==a&&(u=e.width/2,h=t.width/2),this.paddingLeft=Math.max((u-o+i)*this.width/(this.width-o),0),this.paddingRight=Math.max((h-c+i)*this.width/(this.width-c),0)}else{let n=t.height/2,r=e.height/2;"start"===a?(n=0,r=e.height):"end"===a&&(n=t.height,r=0),this.paddingTop=n+i,this.paddingBottom=r+i}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Aoe(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return"top"===t||"bottom"===t||"x"===e}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){let t,n;for(this.beforeTickToLabelConversion(),this.generateTickLabels(e),t=0,n=e.length;t<n;t++)Noe(e[t].label)&&(e.splice(t,1),n--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let n=this.ticks;t<n.length&&(n=Mue(n,t)),this._labelSizes=e=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,n){const{ctx:r,_longestTextCache:a}=this,i=[],o=[],s=Math.floor(t/Pue(t,n));let l,c,u,h,d,f,p,g,m,v,b,x=0,y=0;for(l=0;l<t;l+=s){if(h=e[l].label,d=this._resolveTickFontOptions(l),r.font=f=d.string,p=a[f]=a[f]||{data:{},gc:[]},g=d.lineHeight,m=v=0,Noe(h)||Soe(h)){if(Soe(h))for(c=0,u=h.length;c<u;++c)b=h[c],Noe(b)||Soe(b)||(m=qse(r,p.data,p.gc,m,b),v+=g)}else m=qse(r,p.data,p.gc,m,h),v=g;i.push(m),o.push(v),x=Math.max(m,x),y=Math.max(v,y)}!function(e,t){Roe(e,e=>{const n=e.gc,r=n.length/2;let a;if(r>t){for(a=0;a<r;++a)delete e.data[n[a]];n.splice(0,r)}})}(a,t);const w=i.indexOf(x),k=o.indexOf(y),N=e=>({width:i[e]||0,height:o[e]||0});return{first:N(0),last:N(t-1),widest:N(w),highest:N(k),widths:i,heights:o}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return function(e){return fse(e,-32768,32767)}(this._alignToPixels?Xse(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const n=t[e];return n.$context||(n.$context=function(e,t,n){return vle(e,{tick:n,index:t,type:"tick"})}(this.getContext(),e,n))}return this.$context||(this.$context=function(e,t){return vle(e,{scale:t,type:"scale"})}(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,t=ise(this.labelRotation),n=Math.abs(Math.cos(t)),r=Math.abs(Math.sin(t)),a=this._getLabelSizes(),i=e.autoSkipPadding||0,o=a?a.widest.width+i:0,s=a?a.highest.height+i:0;return this.isHorizontal()?s*n>o*r?o/n:s/r:s*r<o*n?s/n:o/r}_isVisible(){const e=this.options.display;return"auto"!==e?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,n=this.chart,r=this.options,{grid:a,position:i,border:o}=r,s=a.offset,l=this.isHorizontal(),c=this.ticks.length+(s?1:0),u=Bue(a),h=[],d=o.setContext(this.getContext()),f=d.display?d.width:0,p=f/2,g=function(e){return Xse(n,e,f)};let m,v,b,x,y,w,k,N,S,C,E,_;if("top"===i)m=g(this.bottom),w=this.bottom-u,N=m-p,C=g(e.top)+p,_=e.bottom;else if("bottom"===i)m=g(this.top),C=e.top,_=g(e.bottom)-p,w=m+p,N=this.top+u;else if("left"===i)m=g(this.right),y=this.right-u,k=m-p,S=g(e.left)+p,E=e.right;else if("right"===i)m=g(this.left),S=e.left,E=g(e.right)-p,y=m+p,k=this.left+u;else if("x"===t){if("center"===i)m=g((e.top+e.bottom)/2+.5);else if(Coe(i)){const e=Object.keys(i)[0],t=i[e];m=g(this.chart.scales[e].getPixelForValue(t))}C=e.top,_=e.bottom,w=m+p,N=w+u}else if("y"===t){if("center"===i)m=g((e.left+e.right)/2);else if(Coe(i)){const e=Object.keys(i)[0],t=i[e];m=g(this.chart.scales[e].getPixelForValue(t))}y=m-p,k=y-u,S=e.left,E=e.right}const I=Ioe(r.ticks.maxTicksLimit,c),T=Math.max(1,Math.ceil(c/I));for(v=0;v<c;v+=T){const e=this.getContext(v),t=a.setContext(e),r=o.setContext(e),i=t.lineWidth,c=t.color,u=r.dash||[],d=r.dashOffset,f=t.tickWidth,p=t.tickColor,g=t.tickBorderDash||[],m=t.tickBorderDashOffset;b=jue(this,v,s),void 0!==b&&(x=Xse(n,b,i),l?y=k=S=E=x:w=N=C=_=x,h.push({tx1:y,ty1:w,tx2:k,ty2:N,x1:S,y1:C,x2:E,y2:_,width:i,color:c,borderDash:u,borderDashOffset:d,tickWidth:f,tickColor:p,tickBorderDash:g,tickBorderDashOffset:m}))}return this._ticksLength=c,this._borderValue=m,h}_computeLabelItems(e){const t=this.axis,n=this.options,{position:r,ticks:a}=n,i=this.isHorizontal(),o=this.ticks,{align:s,crossAlign:l,padding:c,mirror:u}=a,h=Bue(n.grid),d=h+c,f=u?-c:d,p=-ise(this.labelRotation),g=[];let m,v,b,x,y,w,k,N,S,C,E,_,I="middle";if("top"===r)w=this.bottom-f,k=this._getXAxisLabelAlignment();else if("bottom"===r)w=this.top+f,k=this._getXAxisLabelAlignment();else if("left"===r){const e=this._getYAxisLabelAlignment(h);k=e.textAlign,y=e.x}else if("right"===r){const e=this._getYAxisLabelAlignment(h);k=e.textAlign,y=e.x}else if("x"===t){if("center"===r)w=(e.top+e.bottom)/2+d;else if(Coe(r)){const e=Object.keys(r)[0],t=r[e];w=this.chart.scales[e].getPixelForValue(t)+d}k=this._getXAxisLabelAlignment()}else if("y"===t){if("center"===r)y=(e.left+e.right)/2-d;else if(Coe(r)){const e=Object.keys(r)[0],t=r[e];y=this.chart.scales[e].getPixelForValue(t)}k=this._getYAxisLabelAlignment(h).textAlign}"y"===t&&("start"===s?I="top":"end"===s&&(I="bottom"));const T=this._getLabelSizes();for(m=0,v=o.length;m<v;++m){b=o[m],x=b.label;const e=a.setContext(this.getContext(m));N=this.getPixelForTick(m)+a.labelOffset,S=this._resolveTickFontOptions(m),C=S.lineHeight,E=Soe(x)?x.length:1;const t=E/2,n=e.color,s=e.textStrokeColor,c=e.textStrokeWidth;let h,d=k;if(i?(y=N,"inner"===k&&(d=m===v-1?this.options.reverse?"left":"right":0===m?this.options.reverse?"right":"left":"center"),_="top"===r?"near"===l||0!==p?-E*C+C/2:"center"===l?-T.highest.height/2-t*C+C:-T.highest.height+C/2:"near"===l||0!==p?C/2:"center"===l?T.highest.height/2-t*C:T.highest.height-E*C,u&&(_*=-1),0===p||e.showLabelBackdrop||(y+=C/2*Math.sin(p))):(w=N,_=(1-E)*C/2),e.showLabelBackdrop){const t=ple(e.backdropPadding),n=T.heights[m],r=T.widths[m];let a=_-t.top,i=0-t.left;switch(I){case"middle":a-=n/2;break;case"bottom":a-=n}switch(k){case"center":i-=r/2;break;case"right":i-=r;break;case"inner":m===v-1?i-=r:m>0&&(i-=r/2)}h={left:i,top:a,width:r+t.width,height:n+t.height,color:e.backdropColor}}g.push({label:x,font:S,textOffset:_,options:{rotation:p,color:n,strokeColor:s,strokeWidth:c,textAlign:d,textBaseline:I,translation:[y,w],backdrop:h}})}return g}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-ise(this.labelRotation))return"top"===e?"left":"right";let n="center";return"start"===t.align?n="left":"end"===t.align?n="right":"inner"===t.align&&(n="inner"),n}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:n,mirror:r,padding:a}}=this.options,i=e+a,o=this._getLabelSizes().widest.width;let s,l;return"left"===t?r?(l=this.right+a,"near"===n?s="left":"center"===n?(s="center",l+=o/2):(s="right",l+=o)):(l=this.right-i,"near"===n?s="right":"center"===n?(s="center",l-=o/2):(s="left",l=this.left)):"right"===t?r?(l=this.left+a,"near"===n?s="right":"center"===n?(s="center",l-=o/2):(s="left",l-=o)):(l=this.left+i,"near"===n?s="left":"center"===n?(s="center",l+=o/2):(s="right",l=this.right)):s="right",{textAlign:s,x:l}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;return"left"===t||"right"===t?{top:0,left:this.left,bottom:e.height,right:this.right}:"top"===t||"bottom"===t?{top:this.top,left:0,bottom:this.bottom,right:e.width}:void 0}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:n,top:r,width:a,height:i}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(n,r,a,i),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const n=this.ticks.findIndex(t=>t.value===e);if(n>=0){return t.setContext(this.getContext(n)).lineWidth}return 0}drawGrid(e){const t=this.options.grid,n=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let a,i;const o=(e,t,r)=>{r.width&&r.color&&(n.save(),n.lineWidth=r.width,n.strokeStyle=r.color,n.setLineDash(r.borderDash||[]),n.lineDashOffset=r.borderDashOffset,n.beginPath(),n.moveTo(e.x,e.y),n.lineTo(t.x,t.y),n.stroke(),n.restore())};if(t.display)for(a=0,i=r.length;a<i;++a){const e=r[a];t.drawOnChartArea&&o({x:e.x1,y:e.y1},{x:e.x2,y:e.y2},e),t.drawTicks&&o({x:e.tx1,y:e.ty1},{x:e.tx2,y:e.ty2},{color:e.tickColor,width:e.tickWidth,borderDash:e.tickBorderDash,borderDashOffset:e.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:n,grid:r}}=this,a=n.setContext(this.getContext()),i=n.display?a.width:0;if(!i)return;const o=r.setContext(this.getContext(0)).lineWidth,s=this._borderValue;let l,c,u,h;this.isHorizontal()?(l=Xse(e,this.left,i)-i/2,c=Xse(e,this.right,o)+o/2,u=h=s):(u=Xse(e,this.top,i)-i/2,h=Xse(e,this.bottom,o)+o/2,l=c=s),t.save(),t.lineWidth=a.width,t.strokeStyle=a.color,t.beginPath(),t.moveTo(l,u),t.lineTo(c,h),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const t=this.ctx,n=this._computeLabelArea();n&&Zse(t,n);const r=this.getLabelItems(e);for(const a of r){const e=a.options,n=a.font;ile(t,a.label,0,a.textOffset,n,e)}n&&ele(t)}drawTitle(){const{ctx:e,options:{position:t,title:n,reverse:r}}=this;if(!n.display)return;const a=gle(n.font),i=ple(n.padding),o=n.align;let s=a.lineHeight/2;"bottom"===t||"center"===t||Coe(t)?(s+=i.bottom,Soe(n.text)&&(s+=a.lineHeight*(n.text.length-1))):s+=i.top;const{titleX:l,titleY:c,maxWidth:u,rotation:h}=function(e,t,n,r){const{top:a,left:i,bottom:o,right:s,chart:l}=e,{chartArea:c,scales:u}=l;let h,d,f,p=0;const g=o-a,m=s-i;if(e.isHorizontal()){if(d=Sse(r,i,s),Coe(n)){const e=Object.keys(n)[0],r=n[e];f=u[e].getPixelForValue(r)+g-t}else f="center"===n?(c.bottom+c.top)/2+g-t:Lue(e,n,t);h=s-i}else{if(Coe(n)){const e=Object.keys(n)[0],r=n[e];d=u[e].getPixelForValue(r)-m+t}else d="center"===n?(c.left+c.right)/2-m+t:Lue(e,n,t);f=Sse(r,o,a),p="left"===n?-$oe:$oe}return{titleX:d,titleY:f,maxWidth:h,rotation:p}}(this,s,t,o);ile(e,n.text,0,0,a,{color:n.color,maxWidth:u,rotation:h,textAlign:Wue(o,t,r),textBaseline:"middle",translation:[l,c]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,n=Ioe(e.grid&&e.grid.z,-1),r=Ioe(e.border&&e.border.z,0);return this._isVisible()&&this.draw===Uue.prototype.draw?[{z:n,draw:e=>{this.drawBackground(),this.drawGrid(e),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:t,draw:e=>{this.drawLabels(e)}}]:[{z:t,draw:e=>{this.draw(e)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",r=[];let a,i;for(a=0,i=t.length;a<i;++a){const i=t[a];i[n]!==this.id||e&&i.type!==e||r.push(i)}return r}_resolveTickFontOptions(e){return gle(this.options.ticks.setContext(this.getContext(e)).font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class Vue{constructor(e,t,n){this.type=e,this.scope=t,this.override=n,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let n;(function(e){return"id"in e&&"defaults"in e})(t)&&(n=this.register(t));const r=this.items,a=e.id,i=this.scope+"."+a;if(!a)throw new Error("class does not have id: "+e);return a in r||(r[a]=e,function(e,t,n){const r=Poe(Object.create(null),[n?Gse.get(n):{},Gse.get(t),e.defaults]);Gse.set(t,r),e.defaultRoutes&&function(e,t){Object.keys(t).forEach(n=>{const r=n.split("."),a=r.pop(),i=[e].concat(r).join("."),o=t[n].split("."),s=o.pop(),l=o.join(".");Gse.route(i,a,l,s)})}(t,e.defaultRoutes);e.descriptors&&Gse.describe(t,e.descriptors)}(e,i,n),this.override&&Gse.override(e.id,e.overrides)),i}get(e){return this.items[e]}unregister(e){const t=this.items,n=e.id,r=this.scope;n in t&&delete t[n],r&&n in Gse[r]&&(delete Gse[r][n],this.override&&delete zse[n])}}class Hue{constructor(){this.controllers=new Vue(Tce,"datasets",!0),this.elements=new Vue(Due,"elements"),this.plugins=new Vue(Object,"plugins"),this.scales=new Vue(Uue,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t)}remove(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t)}addControllers(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.controllers)}addElements(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.elements)}addPlugins(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.plugins)}addScales(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.controllers)}removeElements(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.elements)}removePlugins(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.plugins)}removeScales(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.scales)}_each(e,t,n){[...t].forEach(t=>{const r=n||this._getRegistryForType(t);n||r.isForType(t)||r===this.plugins&&t.id?this._exec(e,r,t):Roe(t,t=>{const r=n||this._getRegistryForType(t);this._exec(e,r,t)})})}_exec(e,t,n){const r=Woe(e);Aoe(n["before"+r],[],n),t[e](n),Aoe(n["after"+r],[],n)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const n=this._typedRegistries[t];if(n.isForType(e))return n}return this.plugins}_get(e,t,n){const r=t.get(e);if(void 0===r)throw new Error('"'+e+'" is not a registered '+n+".");return r}}var Gue=new Hue;class que{constructor(){this._init=void 0}notify(e,t,n,r){if("beforeInit"===t&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),void 0===this._init)return;const a=r?this._descriptors(e).filter(r):this._descriptors(e),i=this._notify(a,e,t,n);return"afterDestroy"===t&&(this._notify(a,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),i}_notify(e,t,n,r){r=r||{};for(const a of e){const e=a.plugin;if(!1===Aoe(e[n],[t,r,a.options],e)&&r.cancelable)return!1}return!0}invalidate(){Noe(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const n=e&&e.config,r=Ioe(n.options&&n.options.plugins,{}),a=function(e){const t={},n=[],r=Object.keys(Gue.plugins.items);for(let i=0;i<r.length;i++)n.push(Gue.getPlugin(r[i]));const a=e.plugins||[];for(let i=0;i<a.length;i++){const e=a[i];-1===n.indexOf(e)&&(n.push(e),t[e.id]=!0)}return{plugins:n,localIds:t}}(n);return!1!==r||t?function(e,t,n,r){let{plugins:a,localIds:i}=t;const o=[],s=e.getContext();for(const l of a){const t=l.id,a=Kue(n[t],r);null!==a&&o.push({plugin:l,options:Xue(e.config,{plugin:l,local:i[t]},a,s)})}return o}(e,a,r,t):[]}_notifyStateChanges(e){const t=this._oldCache||[],n=this._cache,r=(e,t)=>e.filter(e=>!t.some(t=>e.plugin.id===t.plugin.id));this._notify(r(t,n),e,"stop"),this._notify(r(n,t),e,"start")}}function Kue(e,t){return t||!1!==e?!0===e?{}:e:null}function Xue(e,t,n,r){let{plugin:a,local:i}=t;const o=e.pluginScopeKeys(a),s=e.getOptionScopes(n,o);return i&&a.defaults&&s.push(a.defaults),e.createResolver(s,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Yue(e,t){const n=Gse.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||n.indexAxis||"x"}function $ue(e){if("x"===e||"y"===e||"r"===e)return e}function Jue(e){return"top"===e||"bottom"===e?"x":"left"===e||"right"===e?"y":void 0}function Que(e){if($ue(e))return e;for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(const a of n){const t=a.axis||Jue(a.position)||e.length>1&&$ue(e[0].toLowerCase());if(t)return t}throw new Error("Cannot determine type of '".concat(e,"' axis. Please provide 'axis' or 'position' option."))}function Zue(e,t,n){if(n[t+"AxisID"]===e)return{axis:t}}function ehe(e,t){const n=zse[e.type]||{scales:{}},r=t.scales||{},a=Yue(e.type,t),i=Object.create(null);return Object.keys(r).forEach(t=>{const o=r[t];if(!Coe(o))return console.error("Invalid scale configuration for scale: ".concat(t));if(o._proxy)return console.warn("Ignoring resolver passed as options for scale: ".concat(t));const s=Que(t,o,function(e,t){if(t.data&&t.data.datasets){const n=t.data.datasets.filter(t=>t.xAxisID===e||t.yAxisID===e);if(n.length)return Zue(e,"x",n[0])||Zue(e,"y",n[0])}return{}}(t,e),Gse.scales[o.type]),l=function(e,t){return e===t?"_index_":"_value_"}(s,a),c=n.scales||{};i[t]=Moe(Object.create(null),[{axis:s},o,c[s],c[l]])}),e.data.datasets.forEach(n=>{const a=n.type||e.type,o=n.indexAxis||Yue(a,t),s=(zse[a]||{}).scales||{};Object.keys(s).forEach(e=>{const t=function(e,t){let n=e;return"_index_"===e?n=t:"_value_"===e&&(n="x"===t?"y":"x"),n}(e,o),a=n[t+"AxisID"]||t;i[a]=i[a]||Object.create(null),Moe(i[a],[{axis:t},r[a],s[e]])})}),Object.keys(i).forEach(e=>{const t=i[e];Moe(t,[Gse.scales[t.type],Gse.scale])}),i}function the(e){const t=e.options||(e.options={});t.plugins=Ioe(t.plugins,{}),t.scales=ehe(e,t)}function nhe(e){return(e=e||{}).datasets=e.datasets||[],e.labels=e.labels||[],e}const rhe=new Map,ahe=new Set;function ihe(e,t){let n=rhe.get(e);return n||(n=t(),rhe.set(e,n),ahe.add(n)),n}const ohe=(e,t,n)=>{const r=zoe(t,n);void 0!==r&&e.add(r)};class she{constructor(e){this._config=function(e){return(e=e||{}).data=nhe(e.data),the(e),e}(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=nhe(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),the(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return ihe(e,()=>[["datasets.".concat(e),""]])}datasetAnimationScopeKeys(e,t){return ihe("".concat(e,".transition.").concat(t),()=>[["datasets.".concat(e,".transitions.").concat(t),"transitions.".concat(t)],["datasets.".concat(e),""]])}datasetElementScopeKeys(e,t){return ihe("".concat(e,"-").concat(t),()=>[["datasets.".concat(e,".elements.").concat(t),"datasets.".concat(e),"elements.".concat(t),""]])}pluginScopeKeys(e){const t=e.id,n=this.type;return ihe("".concat(n,"-plugin-").concat(t),()=>[["plugins.".concat(t),...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const n=this._scopeCache;let r=n.get(e);return r&&!t||(r=new Map,n.set(e,r)),r}getOptionScopes(e,t,n){const{options:r,type:a}=this,i=this._cachedScopes(e,n),o=i.get(t);if(o)return o;const s=new Set;t.forEach(t=>{e&&(s.add(e),t.forEach(t=>ohe(s,e,t))),t.forEach(e=>ohe(s,r,e)),t.forEach(e=>ohe(s,zse[a]||{},e)),t.forEach(e=>ohe(s,Gse,e)),t.forEach(e=>ohe(s,Wse,e))});const l=Array.from(s);return 0===l.length&&l.push(Object.create(null)),ahe.has(t)&&i.set(t,l),l}chartOptionScopes(){const{options:e,type:t}=this;return[e,zse[t]||{},Gse.datasets[t]||{},{type:t},Gse,Wse]}resolveNamedOptions(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[""];const a={$shared:!0},{resolver:i,subPrefixes:o}=lhe(this._resolverCache,e,r);let s=i;if(function(e,t){const{isScriptable:n,isIndexable:r}=yle(e);for(const a of t){const t=n(a),i=r(a),o=(i||t)&&e[a];if(t&&(Voe(o)||che(o))||i&&Soe(o))return!0}return!1}(i,t)){a.$shared=!1;s=xle(i,n=Voe(n)?n():n,this.createResolver(e,n,o))}for(const l of t)a[l]=s[l];return a}createResolver(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[""],r=arguments.length>3?arguments[3]:void 0;const{resolver:a}=lhe(this._resolverCache,e,n);return Coe(t)?xle(a,t,void 0,r):a}}function lhe(e,t,n){let r=e.get(t);r||(r=new Map,e.set(t,r));const a=n.join();let i=r.get(a);if(!i){i={resolver:ble(t,n),subPrefixes:n.filter(e=>!e.toLowerCase().includes("hover"))},r.set(a,i)}return i}const che=e=>Coe(e)&&Object.getOwnPropertyNames(e).some(t=>Voe(e[t]));const uhe=["top","bottom","left","right","chartArea"];function hhe(e,t){return"top"===e||"bottom"===e||-1===uhe.indexOf(e)&&"x"===t}function dhe(e,t){return function(n,r){return n[e]===r[e]?n[t]-r[t]:n[e]-r[e]}}function fhe(e){const t=e.chart,n=t.options.animation;t.notifyPlugins("afterRender"),Aoe(n&&n.onComplete,[e],t)}function phe(e){const t=e.chart,n=t.options.animation;Aoe(n&&n.onProgress,[e],t)}function ghe(e){return Ble()&&"string"===typeof e?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const mhe={},vhe=e=>{const t=ghe(e);return Object.values(mhe).filter(e=>e.canvas===t).pop()};function bhe(e,t,n){const r=Object.keys(e);for(const a of r){const r=+a;if(r>=t){const i=e[a];delete e[a],(n>0||r>t)&&(e[r+n]=i)}}}class xhe{static register(){Gue.add(...arguments),yhe()}static unregister(){Gue.remove(...arguments),yhe()}constructor(e,t){const n=this.config=new she(t),r=ghe(e),a=vhe(r);if(a)throw new Error("Canvas is already in use. Chart with ID '"+a.id+"' must be destroyed before the canvas with ID '"+a.canvas.id+"' can be reused.");const i=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||function(e){return!Ble()||"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas?mue:Rue}(r)),this.platform.updateConfig(n);const o=this.platform.acquireContext(r,i.aspectRatio),s=o&&o.canvas,l=s&&s.height,c=s&&s.width;this.id=koe(),this.ctx=o,this.canvas=s,this.width=c,this.height=l,this._options=i,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new que,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=function(e,t){let n;return function(){for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t?(clearTimeout(n),n=setTimeout(e,t,a)):e.apply(this,a),t}}(e=>this.update(e),i.resizeDelay||0),this._dataChanges=[],mhe[this.id]=this,o&&s?(fce.listen(this,"complete",fhe),fce.listen(this,"progress",phe),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:n,height:r,_aspectRatio:a}=this;return Noe(e)?t&&a?a:r?n/r:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return Gue}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Xle(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Yse(this.canvas,this.ctx),this}stop(){return fce.stop(this),this}resize(e,t){fce.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const n=this.options,r=this.canvas,a=n.maintainAspectRatio&&this.aspectRatio,i=this.platform.getMaximumSize(r,e,t,a),o=n.devicePixelRatio||this.platform.getDevicePixelRatio(),s=this.width?"resize":"attach";this.width=i.width,this.height=i.height,this._aspectRatio=this.aspectRatio,Xle(this,o,!0)&&(this.notifyPlugins("resize",{size:i}),Aoe(n.onResize,[this,i],this),this.attached&&this._doResize(s)&&this.render())}ensureScalesHaveIDs(){Roe(this.options.scales||{},(e,t)=>{e.id=t})}buildOrUpdateScales(){const e=this.options,t=e.scales,n=this.scales,r=Object.keys(n).reduce((e,t)=>(e[t]=!1,e),{});let a=[];t&&(a=a.concat(Object.keys(t).map(e=>{const n=t[e],r=Que(e,n),a="r"===r,i="x"===r;return{options:n,dposition:a?"chartArea":i?"bottom":"left",dtype:a?"radialLinear":i?"category":"linear"}}))),Roe(a,t=>{const a=t.options,i=a.id,o=Que(i,a),s=Ioe(a.type,t.dtype);void 0!==a.position&&hhe(a.position,o)===hhe(t.dposition)||(a.position=t.dposition),r[i]=!0;let l=null;if(i in n&&n[i].type===s)l=n[i];else{l=new(Gue.getScale(s))({id:i,type:s,ctx:this.ctx,chart:this}),n[l.id]=l}l.init(a,e)}),Roe(r,(e,t)=>{e||delete n[t]}),Roe(n,e=>{pue.configure(this,e,e.options),pue.addBox(this,e)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,n=e.length;if(e.sort((e,t)=>e.index-t.index),n>t){for(let e=t;e<n;++e)this._destroyDatasetMeta(e);e.splice(t,n-t)}this._sortedMetasets=e.slice(0).sort(dhe("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((e,n)=>{0===t.filter(t=>t===e._dataset).length&&this._destroyDatasetMeta(n)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let n,r;for(this._removeUnreferencedMetasets(),n=0,r=t.length;n<r;n++){const r=t[n];let a=this.getDatasetMeta(n);const i=r.type||this.config.type;if(a.type&&a.type!==i&&(this._destroyDatasetMeta(n),a=this.getDatasetMeta(n)),a.type=i,a.indexAxis=r.indexAxis||Yue(i,this.options),a.order=r.order||0,a.index=n,a.label=""+r.label,a.visible=this.isDatasetVisible(n),a.controller)a.controller.updateIndex(n),a.controller.linkScales();else{const t=Gue.getController(i),{datasetElementType:r,dataElementType:o}=Gse.datasets[i];Object.assign(t,{dataElementType:Gue.getElement(o),datasetElementType:r&&Gue.getElement(r)}),a.controller=new t(this,n),e.push(a.controller)}}return this._updateMetasets(),e}_resetElements(){Roe(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const n=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0}))return;const a=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let i=0;for(let l=0,c=this.data.datasets.length;l<c;l++){const{controller:e}=this.getDatasetMeta(l),t=!r&&-1===a.indexOf(e);e.buildOrUpdateElements(t),i=Math.max(+e.getMaxOverflow(),i)}i=this._minPadding=n.layout.autoPadding?i:0,this._updateLayout(i),r||Roe(a,e=>{e.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(dhe("z","_idx"));const{_active:o,_lastEvent:s}=this;s?this._eventHandler(s,!0):o.length&&this._updateHoverStyles(o,o,!0),this.render()}_updateScales(){Roe(this.scales,e=>{pue.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),n=new Set(e.events);Hoe(t,n)&&!!this._responsiveListeners===e.responsive||(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:n,start:r,count:a}of t){bhe(e,r,"_removeElements"===n?-a:a)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,n=t=>new Set(e.filter(e=>e[0]===t).map((e,t)=>t+","+e.splice(1).join(","))),r=n(0);for(let a=1;a<t;a++)if(!Hoe(r,n(a)))return;return Array.from(r).map(e=>e.split(",")).map(e=>({method:e[1],start:+e[2],count:+e[3]}))}_updateLayout(e){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;pue.update(this,this.width,this.height,e);const t=this.chartArea,n=t.width<=0||t.height<=0;this._layers=[],Roe(this.boxes,e=>{n&&"chartArea"===e.position||(e.configure&&e.configure(),this._layers.push(...e._layers()))},this),this._layers.forEach((e,t)=>{e._idx=t}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})){for(let e=0,t=this.data.datasets.length;e<t;++e)this.getDatasetMeta(e).controller.configure();for(let t=0,n=this.data.datasets.length;t<n;++t)this._updateDataset(t,Voe(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const n=this.getDatasetMeta(e),r={meta:n,index:e,mode:t,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",r)&&(n.controller._update(t),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(fce.has(this)?this.attached&&!fce.running(this)&&fce.start(this):(this.draw(),fhe({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:e,height:t}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(e,t)}if(this.clear(),this.width<=0||this.height<=0)return;if(!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,n=[];let r,a;for(r=0,a=t.length;r<a;++r){const a=t[r];e&&!a.visible||n.push(a)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,n={meta:e,index:e.index,cancelable:!0},r=hce(this,e);!1!==this.notifyPlugins("beforeDatasetDraw",n)&&(r&&Zse(t,r),e.controller.draw(),r&&ele(t),n.cancelable=!1,this.notifyPlugins("afterDatasetDraw",n))}isPointInArea(e){return Qse(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,n,r){const a=tue.modes[t];return"function"===typeof a?a(this,e,n,r):[]}getDatasetMeta(e){const t=this.data.datasets[e],n=this._metasets;let r=n.filter(e=>e&&e._dataset===t).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},n.push(r)),r}getContext(){return this.$context||(this.$context=vle(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const n=this.getDatasetMeta(e);return"boolean"===typeof n.hidden?!n.hidden:!t.hidden}setDatasetVisibility(e,t){this.getDatasetMeta(e).hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,n){const r=n?"show":"hide",a=this.getDatasetMeta(e),i=a.controller._resolveAnimations(void 0,r);Uoe(t)?(a.data[t].hidden=!n,this.update()):(this.setDatasetVisibility(e,n),i.update(a,{visible:n}),this.update(t=>t.datasetIndex===e?r:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),fce.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),Yse(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete mhe[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(){return this.canvas.toDataURL(...arguments)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,n=(n,r)=>{t.addEventListener(this,n,r),e[n]=r},r=(e,t,n)=>{e.offsetX=t,e.offsetY=n,this._eventHandler(e)};Roe(this.options.events,e=>n(e,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,n=(n,r)=>{t.addEventListener(this,n,r),e[n]=r},r=(n,r)=>{e[n]&&(t.removeEventListener(this,n,r),delete e[n])},a=(e,t)=>{this.canvas&&this.resize(e,t)};let i;const o=()=>{r("attach",o),this.attached=!0,this.resize(),n("resize",a),n("detach",i)};i=()=>{this.attached=!1,r("resize",a),this._stop(),this._resize(0,0),n("attach",o)},t.isAttached(this.canvas)?o():i()}unbindEvents(){Roe(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},Roe(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,n){const r=n?"set":"remove";let a,i,o,s;for("dataset"===t&&(a=this.getDatasetMeta(e[0].datasetIndex),a.controller["_"+r+"DatasetHoverStyle"]()),o=0,s=e.length;o<s;++o){i=e[o];const t=i&&this.getDatasetMeta(i.datasetIndex).controller;t&&t[r+"HoverStyle"](i.element,i.datasetIndex,i.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],n=e.map(e=>{let{datasetIndex:t,index:n}=e;const r=this.getDatasetMeta(t);if(!r)throw new Error("No dataset found at index "+t);return{datasetIndex:t,element:r.data[n],index:n}});!Doe(n,t)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,t))}notifyPlugins(e,t,n){return this._plugins.notify(this,e,t,n)}isPluginEnabled(e){return 1===this._plugins._cache.filter(t=>t.plugin.id===e).length}_updateHoverStyles(e,t,n){const r=this.options.hover,a=(e,t)=>e.filter(e=>!t.some(t=>e.datasetIndex===t.datasetIndex&&e.index===t.index)),i=a(t,e),o=n?e:a(e,t);i.length&&this.updateHoverStyle(i,r.mode,!1),o.length&&r.mode&&this.updateHoverStyle(o,r.mode,!0)}_eventHandler(e,t){const n={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},r=t=>(t.options.events||this.options.events).includes(e.native.type);if(!1===this.notifyPlugins("beforeEvent",n,r))return;const a=this._handleEvent(e,t,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,r),(a||n.changed)&&this.render(),this}_handleEvent(e,t,n){const{_active:r=[],options:a}=this,i=t,o=this._getActiveElements(e,r,n,i),s=function(e){return"mouseup"===e.type||"click"===e.type||"contextmenu"===e.type}(e),l=function(e,t,n,r){return n&&"mouseout"!==e.type?r?t:e:null}(e,this._lastEvent,n,s);n&&(this._lastEvent=null,Aoe(a.onHover,[e,o,this],this),s&&Aoe(a.onClick,[e,o,this],this));const c=!Doe(o,r);return(c||t)&&(this._active=o,this._updateHoverStyles(o,r,t)),this._lastEvent=l,c}_getActiveElements(e,t,n,r){if("mouseout"===e.type)return[];if(!n)return t;const a=this.options.hover;return this.getElementsAtEventForMode(e,a.mode,a,r)}}function yhe(){return Roe(xhe.instances,e=>e._plugins.invalidate())}function whe(e,t,n,r){const a=function(e){return hle(e,["outerStart","outerEnd","innerStart","innerEnd"])}(e.options.borderRadius),i=(n-t)/2,o=Math.min(i,r*t/2),s=e=>{const t=(n-Math.min(i,e))*r/2;return fse(e,0,Math.min(i,t))};return{outerStart:s(a.outerStart),outerEnd:s(a.outerEnd),innerStart:fse(a.innerStart,0,o),innerEnd:fse(a.innerEnd,0,o)}}function khe(e,t,n,r){return{x:n+e*Math.cos(t),y:r+e*Math.sin(t)}}function Nhe(e,t,n,r,a,i){const{x:o,y:s,startAngle:l,pixelMargin:c,innerRadius:u}=t,h=Math.max(t.outerRadius+r+n-c,0),d=u>0?u+r+n+c:0;let f=0;const p=a-l;if(r){const e=((u>0?u-r:0)+(h>0?h-r:0))/2;f=(p-(0!==e?p*e/(e+r):p))/2}const g=(p-Math.max(.001,p*h-n/Goe)/h)/2,m=l+g+f,v=a-g-f,{outerStart:b,outerEnd:x,innerStart:y,innerEnd:w}=whe(t,d,h,v-m),k=h-b,N=h-x,S=m+b/k,C=v-x/N,E=d+y,_=d+w,I=m+y/E,T=v-w/_;if(e.beginPath(),i){const t=(S+C)/2;if(e.arc(o,s,h,S,t),e.arc(o,s,h,t,C),x>0){const t=khe(N,C,o,s);e.arc(t.x,t.y,x,C,v+$oe)}const n=khe(_,v,o,s);if(e.lineTo(n.x,n.y),w>0){const t=khe(_,T,o,s);e.arc(t.x,t.y,w,v+$oe,T+Math.PI)}const r=(v-w/d+(m+y/d))/2;if(e.arc(o,s,d,v-w/d,r,!0),e.arc(o,s,d,r,m+y/d,!0),y>0){const t=khe(E,I,o,s);e.arc(t.x,t.y,y,I+Math.PI,m-$oe)}const a=khe(k,m,o,s);if(e.lineTo(a.x,a.y),b>0){const t=khe(k,S,o,s);e.arc(t.x,t.y,b,m-$oe,S)}}else{e.moveTo(o,s);const t=Math.cos(S)*h+o,n=Math.sin(S)*h+s;e.lineTo(t,n);const r=Math.cos(C)*h+o,a=Math.sin(C)*h+s;e.lineTo(r,a)}e.closePath()}function She(e,t,n,r,a){const{fullCircles:i,startAngle:o,circumference:s,options:l}=t,{borderWidth:c,borderJoinStyle:u,borderDash:h,borderDashOffset:d,borderRadius:f}=l,p="inner"===l.borderAlign;if(!c)return;e.setLineDash(h||[]),e.lineDashOffset=d,p?(e.lineWidth=2*c,e.lineJoin=u||"round"):(e.lineWidth=c,e.lineJoin=u||"bevel");let g=t.endAngle;if(i){Nhe(e,t,n,r,g,a);for(let t=0;t<i;++t)e.stroke();isNaN(s)||(g=o+(s%qoe||qoe))}p&&function(e,t,n){const{startAngle:r,pixelMargin:a,x:i,y:o,outerRadius:s,innerRadius:l}=t;let c=a/s;e.beginPath(),e.arc(i,o,s,r-c,n+c),l>a?(c=a/l,e.arc(i,o,l,n+c,r-c,!0)):e.arc(i,o,a,n+$oe,r-$oe),e.closePath(),e.clip()}(e,t,g),l.selfJoin&&g-o>=Goe&&0===f&&"miter"!==u&&function(e,t,n){const{startAngle:r,x:a,y:i,outerRadius:o,innerRadius:s,options:l}=t,{borderWidth:c,borderJoinStyle:u}=l,h=Math.min(c/o,hse(r-n));if(e.beginPath(),e.arc(a,i,o-c/2,r+h/2,n-h/2),s>0){const t=Math.min(c/s,hse(r-n));e.arc(a,i,s+c/2,n-t/2,r+t/2,!0)}else{const t=Math.min(c/2,o*hse(r-n));if("round"===u)e.arc(a,i,t,n-Goe/2,r+Goe/2,!0);else if("bevel"===u){const o=2*t*t,s=-o*Math.cos(n+Goe/2)+a,l=-o*Math.sin(n+Goe/2)+i,c=o*Math.cos(r+Goe/2)+a,u=o*Math.sin(r+Goe/2)+i;e.lineTo(s,l),e.lineTo(c,u)}}e.closePath(),e.moveTo(0,0),e.rect(0,0,e.canvas.width,e.canvas.height),e.clip("evenodd")}(e,t,g),i||(Nhe(e,t,n,r,g,a),e.stroke())}(0,hn.A)(xhe,"defaults",Gse),(0,hn.A)(xhe,"instances",mhe),(0,hn.A)(xhe,"overrides",zse),(0,hn.A)(xhe,"registry",Gue),(0,hn.A)(xhe,"version","4.5.1"),(0,hn.A)(xhe,"getChart",vhe);class Che extends Due{constructor(e){super(),(0,hn.A)(this,"circumference",void 0),(0,hn.A)(this,"endAngle",void 0),(0,hn.A)(this,"fullCircles",void 0),(0,hn.A)(this,"innerRadius",void 0),(0,hn.A)(this,"outerRadius",void 0),(0,hn.A)(this,"pixelMargin",void 0),(0,hn.A)(this,"startAngle",void 0),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,t,n){const r=this.getProps(["x","y"],n),{angle:a,distance:i}=lse(r,{x:e,y:t}),{startAngle:o,endAngle:s,innerRadius:l,outerRadius:c,circumference:u}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],n),h=(this.options.spacing+this.options.borderWidth)/2,d=Ioe(u,s-o),f=dse(a,o,s)&&o!==s,p=d>=qoe||f,g=pse(i,l+h,c+h);return p&&g}getCenterPoint(e){const{x:t,y:n,startAngle:r,endAngle:a,innerRadius:i,outerRadius:o}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:s,spacing:l}=this.options,c=(r+a)/2,u=(i+o+l+s)/2;return{x:t+Math.cos(c)*u,y:n+Math.sin(c)*u}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:t,circumference:n}=this,r=(t.offset||0)/4,a=(t.spacing||0)/2,i=t.circular;if(this.pixelMargin="inner"===t.borderAlign?.33:0,this.fullCircles=n>qoe?Math.floor(n/qoe):0,0===n||this.innerRadius<0||this.outerRadius<0)return;e.save();const o=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(o)*r,Math.sin(o)*r);const s=r*(1-Math.sin(Math.min(Goe,n||0)));e.fillStyle=t.backgroundColor,e.strokeStyle=t.borderColor,function(e,t,n,r,a){const{fullCircles:i,startAngle:o,circumference:s}=t;let l=t.endAngle;if(i){Nhe(e,t,n,r,l,a);for(let t=0;t<i;++t)e.fill();isNaN(s)||(l=o+(s%qoe||qoe))}Nhe(e,t,n,r,l,a),e.fill()}(e,this,s,a,i),She(e,this,s,a,i),e.restore()}}function Ehe(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;e.lineCap=Ioe(n.borderCapStyle,t.borderCapStyle),e.setLineDash(Ioe(n.borderDash,t.borderDash)),e.lineDashOffset=Ioe(n.borderDashOffset,t.borderDashOffset),e.lineJoin=Ioe(n.borderJoinStyle,t.borderJoinStyle),e.lineWidth=Ioe(n.borderWidth,t.borderWidth),e.strokeStyle=Ioe(n.borderColor,t.borderColor)}function _he(e,t,n){e.lineTo(n.x,n.y)}function Ihe(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=e.length,{start:a=0,end:i=r-1}=n,{start:o,end:s}=t,l=Math.max(a,o),c=Math.min(i,s),u=a<o&&i<o||a>s&&i>s;return{count:r,start:l,loop:t.loop,ilen:c<l&&!u?r+c-l:c-l}}function The(e,t,n,r){const{points:a,options:i}=t,{count:o,start:s,loop:l,ilen:c}=Ihe(a,n,r),u=function(e){return e.stepped?tle:e.tension||"monotone"===e.cubicInterpolationMode?nle:_he}(i);let h,d,f,{move:p=!0,reverse:g}=r||{};for(h=0;h<=c;++h)d=a[(s+(g?c-h:h))%o],d.skip||(p?(e.moveTo(d.x,d.y),p=!1):u(e,f,d,g,i.stepped),f=d);return l&&(d=a[(s+(g?c:0))%o],u(e,f,d,g,i.stepped)),!!l}function Ahe(e,t,n,r){const a=t.points,{count:i,start:o,ilen:s}=Ihe(a,n,r),{move:l=!0,reverse:c}=r||{};let u,h,d,f,p,g,m=0,v=0;const b=e=>(o+(c?s-e:e))%i,x=()=>{f!==p&&(e.lineTo(m,p),e.lineTo(m,f),e.lineTo(m,g))};for(l&&(h=a[b(0)],e.moveTo(h.x,h.y)),u=0;u<=s;++u){if(h=a[b(u)],h.skip)continue;const t=h.x,n=h.y,r=0|t;r===d?(n<f?f=n:n>p&&(p=n),m=(v*m+t)/++v):(x(),e.lineTo(t,n),d=r,v=0,f=p=n),g=n}x()}function Rhe(e){const t=e.options,n=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&"monotone"!==t.cubicInterpolationMode&&!t.stepped&&!n?Ahe:The}(0,hn.A)(Che,"id","arc"),(0,hn.A)(Che,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),(0,hn.A)(Che,"defaultRoutes",{backgroundColor:"backgroundColor"}),(0,hn.A)(Che,"descriptors",{_scriptable:!0,_indexable:e=>"borderDash"!==e});const Dhe="function"===typeof Path2D;function Fhe(e,t,n,r){Dhe&&!t.options.segment?function(e,t,n,r){let a=t._path;a||(a=t._path=new Path2D,t.path(a,n,r)&&a.closePath()),Ehe(e,t.options),e.stroke(a)}(e,t,n,r):function(e,t,n,r){const{segments:a,options:i}=t,o=Rhe(t);for(const s of a)Ehe(e,i,s.style),e.beginPath(),o(e,t,s,{start:n,end:n+r-1})&&e.closePath(),e.stroke()}(e,t,n,r)}class Ohe extends Due{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const n=this.options;if((n.tension||"monotone"===n.cubicInterpolationMode)&&!n.stepped&&!this._pointsUpdated){const r=n.spanGaps?this._loop:this._fullLoop;jle(this._points,n,e,r,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=function(e,t){const n=e.points,r=e.options.spanGaps,a=n.length;if(!a)return[];const i=!!e._loop,{start:o,end:s}=function(e,t,n,r){let a=0,i=t-1;if(n&&!r)for(;a<t&&!e[a].skip;)a++;for(;a<t&&e[a].skip;)a++;for(a%=t,n&&(i+=a);i>a&&e[i%t].skip;)i--;return i%=t,{start:a,end:i}}(n,a,i,r);return sce(e,!0===r?[{start:o,end:s,loop:i}]:function(e,t,n,r){const a=e.length,i=[];let o,s=t,l=e[t];for(o=t+1;o<=n;++o){const n=e[o%a];n.skip||n.stop?l.skip||(r=!1,i.push({start:t%a,end:(o-1)%a,loop:r}),t=s=n.stop?o:null):(s=o,l.skip&&(t=o)),l=n}return null!==s&&i.push({start:t%a,end:s%a,loop:r}),i}(n,o,s<o?s+a:s,!!e._fullLoop&&0===o&&s===a-1),n,t)}(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,n=e.length;return n&&t[e[n-1].end]}interpolate(e,t){const n=this.options,r=e[t],a=this.points,i=oce(this,{property:t,start:r,end:r});if(!i.length)return;const o=[],s=function(e){return e.stepped?Qle:e.tension||"monotone"===e.cubicInterpolationMode?Zle:Jle}(n);let l,c;for(l=0,c=i.length;l<c;++l){const{start:c,end:u}=i[l],h=a[c],d=a[u];if(h===d){o.push(h);continue}const f=s(h,d,Math.abs((r-h[t])/(d[t]-h[t])),n.stepped);f[t]=e[t],o.push(f)}return 1===o.length?o[0]:o}pathSegment(e,t,n){return Rhe(this)(e,this,t,n)}path(e,t,n){const r=this.segments,a=Rhe(this);let i=this._loop;t=t||0,n=n||this.points.length-t;for(const o of r)i&=a(e,this,o,{start:t,end:t+n-1});return!!i}draw(e,t,n,r){const a=this.options||{};(this.points||[]).length&&a.borderWidth&&(e.save(),Fhe(e,this,n,r),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function Lhe(e,t,n,r){const a=e.options,{[n]:i}=e.getProps([n],r);return Math.abs(t-i)<a.radius+a.hitRadius}(0,hn.A)(Ohe,"id","line"),(0,hn.A)(Ohe,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),(0,hn.A)(Ohe,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),(0,hn.A)(Ohe,"descriptors",{_scriptable:!0,_indexable:e=>"borderDash"!==e&&"fill"!==e});class Phe extends Due{constructor(e){super(),(0,hn.A)(this,"parsed",void 0),(0,hn.A)(this,"skip",void 0),(0,hn.A)(this,"stop",void 0),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,t,n){const r=this.options,{x:a,y:i}=this.getProps(["x","y"],n);return Math.pow(e-a,2)+Math.pow(t-i,2)<Math.pow(r.hitRadius+r.radius,2)}inXRange(e,t){return Lhe(this,e,"x",t)}inYRange(e,t){return Lhe(this,e,"y",t)}getCenterPoint(e){const{x:t,y:n}=this.getProps(["x","y"],e);return{x:t,y:n}}size(e){let t=(e=e||this.options||{}).radius||0;t=Math.max(t,t&&e.hoverRadius||0);return 2*(t+(t&&e.borderWidth||0))}draw(e,t){const n=this.options;this.skip||n.radius<.1||!Qse(this,t,this.size(n)/2)||(e.strokeStyle=n.borderColor,e.lineWidth=n.borderWidth,e.fillStyle=n.backgroundColor,$se(e,n,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}function Mhe(e,t){const{x:n,y:r,base:a,width:i,height:o}=e.getProps(["x","y","base","width","height"],t);let s,l,c,u,h;return e.horizontal?(h=o/2,s=Math.min(n,a),l=Math.max(n,a),c=r-h,u=r+h):(h=i/2,s=n-h,l=n+h,c=Math.min(r,a),u=Math.max(r,a)),{left:s,top:c,right:l,bottom:u}}function jhe(e,t,n,r){return e?0:fse(t,n,r)}function Bhe(e){const t=Mhe(e),n=t.right-t.left,r=t.bottom-t.top,a=function(e,t,n){const r=e.options.borderWidth,a=e.borderSkipped,i=dle(r);return{t:jhe(a.top,i.top,0,n),r:jhe(a.right,i.right,0,t),b:jhe(a.bottom,i.bottom,0,n),l:jhe(a.left,i.left,0,t)}}(e,n/2,r/2),i=function(e,t,n){const{enableBorderRadius:r}=e.getProps(["enableBorderRadius"]),a=e.options.borderRadius,i=fle(a),o=Math.min(t,n),s=e.borderSkipped,l=r||Coe(a);return{topLeft:jhe(!l||s.top||s.left,i.topLeft,0,o),topRight:jhe(!l||s.top||s.right,i.topRight,0,o),bottomLeft:jhe(!l||s.bottom||s.left,i.bottomLeft,0,o),bottomRight:jhe(!l||s.bottom||s.right,i.bottomRight,0,o)}}(e,n/2,r/2);return{outer:{x:t.left,y:t.top,w:n,h:r,radius:i},inner:{x:t.left+a.l,y:t.top+a.t,w:n-a.l-a.r,h:r-a.t-a.b,radius:{topLeft:Math.max(0,i.topLeft-Math.max(a.t,a.l)),topRight:Math.max(0,i.topRight-Math.max(a.t,a.r)),bottomLeft:Math.max(0,i.bottomLeft-Math.max(a.b,a.l)),bottomRight:Math.max(0,i.bottomRight-Math.max(a.b,a.r))}}}}function zhe(e,t,n,r){const a=null===t,i=null===n,o=e&&!(a&&i)&&Mhe(e,r);return o&&(a||pse(t,o.left,o.right))&&(i||pse(n,o.top,o.bottom))}function Whe(e,t){e.rect(t.x,t.y,t.w,t.h)}function Uhe(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=e.x!==n.x?-t:0,a=e.y!==n.y?-t:0,i=(e.x+e.w!==n.x+n.w?t:0)-r,o=(e.y+e.h!==n.y+n.h?t:0)-a;return{x:e.x+r,y:e.y+a,w:e.w+i,h:e.h+o,radius:e.radius}}(0,hn.A)(Phe,"id","point"),(0,hn.A)(Phe,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),(0,hn.A)(Phe,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});class Vhe extends Due{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:n,backgroundColor:r}}=this,{inner:a,outer:i}=Bhe(this),o=(s=i.radius).topLeft||s.topRight||s.bottomLeft||s.bottomRight?ole:Whe;var s;e.save(),i.w===a.w&&i.h===a.h||(e.beginPath(),o(e,Uhe(i,t,a)),e.clip(),o(e,Uhe(a,-t,i)),e.fillStyle=n,e.fill("evenodd")),e.beginPath(),o(e,Uhe(a,t)),e.fillStyle=r,e.fill(),e.restore()}inRange(e,t,n){return zhe(this,e,t,n)}inXRange(e,t){return zhe(this,e,null,t)}inYRange(e,t){return zhe(this,null,e,t)}getCenterPoint(e){const{x:t,y:n,base:r,horizontal:a}=this.getProps(["x","y","base","horizontal"],e);return{x:a?(t+r)/2:t,y:a?n:(n+r)/2}}getRange(e){return"x"===e?this.width/2:this.height/2}}(0,hn.A)(Vhe,"id","bar"),(0,hn.A)(Vhe,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),(0,hn.A)(Vhe,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const Hhe=(e,t)=>{let{boxHeight:n=t,boxWidth:r=t}=e;return e.usePointStyle&&(n=Math.min(n,t),r=e.pointStyleWidth||Math.min(r,t)),{boxWidth:r,boxHeight:n,itemHeight:Math.max(t,n)}};class Ghe extends Due{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,n){this.maxWidth=e,this.maxHeight=t,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=Aoe(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(t=>e.filter(t,this.chart.data))),e.sort&&(t=t.sort((t,n)=>e.sort(t,n,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display)return void(this.width=this.height=0);const n=e.labels,r=gle(n.font),a=r.size,i=this._computeTitleHeight(),{boxWidth:o,itemHeight:s}=Hhe(n,a);let l,c;t.font=r.string,this.isHorizontal()?(l=this.maxWidth,c=this._fitRows(i,a,o,s)+10):(c=this.maxHeight,l=this._fitCols(i,r,o,s)+10),this.width=Math.min(l,e.maxWidth||this.maxWidth),this.height=Math.min(c,e.maxHeight||this.maxHeight)}_fitRows(e,t,n,r){const{ctx:a,maxWidth:i,options:{labels:{padding:o}}}=this,s=this.legendHitBoxes=[],l=this.lineWidths=[0],c=r+o;let u=e;a.textAlign="left",a.textBaseline="middle";let h=-1,d=-c;return this.legendItems.forEach((e,f)=>{const p=n+t/2+a.measureText(e.text).width;(0===f||l[l.length-1]+p+2*o>i)&&(u+=c,l[l.length-(f>0?0:1)]=0,d+=c,h++),s[f]={left:0,top:d,row:h,width:p,height:r},l[l.length-1]+=p+o}),u}_fitCols(e,t,n,r){const{ctx:a,maxHeight:i,options:{labels:{padding:o}}}=this,s=this.legendHitBoxes=[],l=this.columnSizes=[],c=i-e;let u=o,h=0,d=0,f=0,p=0;return this.legendItems.forEach((e,i)=>{const{itemWidth:g,itemHeight:m}=function(e,t,n,r,a){const i=function(e,t,n,r){let a=e.text;a&&"string"!==typeof a&&(a=a.reduce((e,t)=>e.length>t.length?e:t));return t+n.size/2+r.measureText(a).width}(r,e,t,n),o=function(e,t,n){let r=e;"string"!==typeof t.text&&(r=qhe(t,n));return r}(a,r,t.lineHeight);return{itemWidth:i,itemHeight:o}}(n,t,a,e,r);i>0&&d+m+2*o>c&&(u+=h+o,l.push({width:h,height:d}),f+=h+o,p++,h=d=0),s[i]={left:f,top:d,col:p,width:g,height:m},h=Math.max(h,g),d+=m+o}),u+=h,l.push({width:h,height:d}),u}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:n,labels:{padding:r},rtl:a}}=this,i=ece(a,this.left,this.width);if(this.isHorizontal()){let a=0,o=Sse(n,this.left+r,this.right-this.lineWidths[a]);for(const s of t)a!==s.row&&(a=s.row,o=Sse(n,this.left+r,this.right-this.lineWidths[a])),s.top+=this.top+e+r,s.left=i.leftForLtr(i.x(o),s.width),o+=s.width+r}else{let a=0,o=Sse(n,this.top+e+r,this.bottom-this.columnSizes[a].height);for(const s of t)s.col!==a&&(a=s.col,o=Sse(n,this.top+e+r,this.bottom-this.columnSizes[a].height)),s.top=o,s.left+=this.left+r,s.left=i.leftForLtr(i.x(s.left),s.width),o+=s.height+r}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){const e=this.ctx;Zse(e,this),this._draw(),ele(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:n,ctx:r}=this,{align:a,labels:i}=e,o=Gse.color,s=ece(e.rtl,this.left,this.width),l=gle(i.font),{padding:c}=i,u=l.size,h=u/2;let d;this.drawTitle(),r.textAlign=s.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=l.string;const{boxWidth:f,boxHeight:p,itemHeight:g}=Hhe(i,u),m=this.isHorizontal(),v=this._computeTitleHeight();d=m?{x:Sse(a,this.left+c,this.right-n[0]),y:this.top+c+v,line:0}:{x:this.left+c,y:Sse(a,this.top+v+c,this.bottom-t[0].height),line:0},tce(this.ctx,e.textDirection);const b=g+c;this.legendItems.forEach((x,y)=>{r.strokeStyle=x.fontColor,r.fillStyle=x.fontColor;const w=r.measureText(x.text).width,k=s.textAlign(x.textAlign||(x.textAlign=i.textAlign)),N=f+h+w;let S=d.x,C=d.y;s.setWidth(this.width),m?y>0&&S+N+c>this.right&&(C=d.y+=b,d.line++,S=d.x=Sse(a,this.left+c,this.right-n[d.line])):y>0&&C+b>this.bottom&&(S=d.x=S+t[d.line].width+c,d.line++,C=d.y=Sse(a,this.top+v+c,this.bottom-t[d.line].height));if(function(e,t,n){if(isNaN(f)||f<=0||isNaN(p)||p<0)return;r.save();const a=Ioe(n.lineWidth,1);if(r.fillStyle=Ioe(n.fillStyle,o),r.lineCap=Ioe(n.lineCap,"butt"),r.lineDashOffset=Ioe(n.lineDashOffset,0),r.lineJoin=Ioe(n.lineJoin,"miter"),r.lineWidth=a,r.strokeStyle=Ioe(n.strokeStyle,o),r.setLineDash(Ioe(n.lineDash,[])),i.usePointStyle){const o={radius:p*Math.SQRT2/2,pointStyle:n.pointStyle,rotation:n.rotation,borderWidth:a},l=s.xPlus(e,f/2);Jse(r,o,l,t+h,i.pointStyleWidth&&f)}else{const i=t+Math.max((u-p)/2,0),o=s.leftForLtr(e,f),l=fle(n.borderRadius);r.beginPath(),Object.values(l).some(e=>0!==e)?ole(r,{x:o,y:i,w:f,h:p,radius:l}):r.rect(o,i,f,p),r.fill(),0!==a&&r.stroke()}r.restore()}(s.x(S),C,x),S=((e,t,n,r)=>e===(r?"left":"right")?n:"center"===e?(t+n)/2:t)(k,S+f+h,m?S+N:this.right,e.rtl),function(e,t,n){ile(r,n.text,e,t+g/2,l,{strikethrough:n.hidden,textAlign:s.textAlign(n.textAlign)})}(s.x(S),C,x),m)d.x+=N+c;else if("string"!==typeof x.text){const e=l.lineHeight;d.y+=qhe(x,e)+c}else d.y+=b}),nce(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,n=gle(t.font),r=ple(t.padding);if(!t.display)return;const a=ece(e.rtl,this.left,this.width),i=this.ctx,o=t.position,s=n.size/2,l=r.top+s;let c,u=this.left,h=this.width;if(this.isHorizontal())h=Math.max(...this.lineWidths),c=this.top+l,u=Sse(e.align,u,this.right-h);else{const t=this.columnSizes.reduce((e,t)=>Math.max(e,t.height),0);c=l+Sse(e.align,this.top,this.bottom-t-e.labels.padding-this._computeTitleHeight())}const d=Sse(o,u,u+h);i.textAlign=a.textAlign(Nse(o)),i.textBaseline="middle",i.strokeStyle=t.color,i.fillStyle=t.color,i.font=n.string,ile(i,t.text,d,c,n)}_computeTitleHeight(){const e=this.options.title,t=gle(e.font),n=ple(e.padding);return e.display?t.lineHeight+n.height:0}_getLegendItemAt(e,t){let n,r,a;if(pse(e,this.left,this.right)&&pse(t,this.top,this.bottom))for(a=this.legendHitBoxes,n=0;n<a.length;++n)if(r=a[n],pse(e,r.left,r.left+r.width)&&pse(t,r.top,r.top+r.height))return this.legendItems[n];return null}handleEvent(e){const t=this.options;if(!function(e,t){if(("mousemove"===e||"mouseout"===e)&&(t.onHover||t.onLeave))return!0;if(t.onClick&&("click"===e||"mouseup"===e))return!0;return!1}(e.type,t))return;const n=this._getLegendItemAt(e.x,e.y);if("mousemove"===e.type||"mouseout"===e.type){const r=this._hoveredItem,a=((e,t)=>null!==e&&null!==t&&e.datasetIndex===t.datasetIndex&&e.index===t.index)(r,n);r&&!a&&Aoe(t.onLeave,[e,r,this],this),this._hoveredItem=n,n&&!a&&Aoe(t.onHover,[e,n,this],this)}else n&&Aoe(t.onClick,[e,n,this],this)}}function qhe(e,t){return t*(e.text?e.text.length:0)}var Khe={id:"legend",_element:Ghe,start(e,t,n){const r=e.legend=new Ghe({ctx:e.ctx,options:n,chart:e});pue.configure(e,r,n),pue.addBox(e,r)},stop(e){pue.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,n){const r=e.legend;pue.configure(e,r,n),r.options=n},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,n){const r=t.datasetIndex,a=n.chart;a.isDatasetVisible(r)?(a.hide(r),t.hidden=!0):(a.show(r),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const t=e.data.datasets,{labels:{usePointStyle:n,pointStyle:r,textAlign:a,color:i,useBorderRadius:o,borderRadius:s}}=e.legend.options;return e._getSortedDatasetMetas().map(e=>{const l=e.controller.getStyle(n?0:void 0),c=ple(l.borderWidth);return{text:t[e.index].label,fillStyle:l.backgroundColor,fontColor:i,hidden:!e.visible,lineCap:l.borderCapStyle,lineDash:l.borderDash,lineDashOffset:l.borderDashOffset,lineJoin:l.borderJoinStyle,lineWidth:(c.width+c.height)/4,strokeStyle:l.borderColor,pointStyle:r||l.pointStyle,rotation:l.rotation,textAlign:a||l.textAlign,borderRadius:o&&(s||l.borderRadius),datasetIndex:e.index}},this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class Xhe extends Due{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const n=this.options;if(this.left=0,this.top=0,!n.display)return void(this.width=this.height=this.right=this.bottom=0);this.width=this.right=e,this.height=this.bottom=t;const r=Soe(n.text)?n.text.length:1;this._padding=ple(n.padding);const a=r*gle(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=a:this.width=a}isHorizontal(){const e=this.options.position;return"top"===e||"bottom"===e}_drawArgs(e){const{top:t,left:n,bottom:r,right:a,options:i}=this,o=i.align;let s,l,c,u=0;return this.isHorizontal()?(l=Sse(o,n,a),c=t+e,s=a-n):("left"===i.position?(l=n+e,c=Sse(o,r,t),u=-.5*Goe):(l=a-e,c=Sse(o,t,r),u=.5*Goe),s=r-t),{titleX:l,titleY:c,maxWidth:s,rotation:u}}draw(){const e=this.ctx,t=this.options;if(!t.display)return;const n=gle(t.font),r=n.lineHeight/2+this._padding.top,{titleX:a,titleY:i,maxWidth:o,rotation:s}=this._drawArgs(r);ile(e,t.text,0,0,n,{color:t.color,maxWidth:o,rotation:s,textAlign:Nse(t.align),textBaseline:"middle",translation:[a,i]})}}var Yhe={id:"title",_element:Xhe,start(e,t,n){!function(e,t){const n=new Xhe({ctx:e.ctx,options:t,chart:e});pue.configure(e,n,t),pue.addBox(e,n),e.titleBlock=n}(e,n)},stop(e){const t=e.titleBlock;pue.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,n){const r=e.titleBlock;pue.configure(e,r,n),r.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};new WeakMap;const $he={average(e){if(!e.length)return!1;let t,n,r=new Set,a=0,i=0;for(t=0,n=e.length;t<n;++t){const n=e[t].element;if(n&&n.hasValue()){const e=n.tooltipPosition();r.add(e.x),a+=e.y,++i}}if(0===i||0===r.size)return!1;const o=[...r].reduce((e,t)=>e+t)/r.size;return{x:o,y:a/i}},nearest(e,t){if(!e.length)return!1;let n,r,a,i=t.x,o=t.y,s=Number.POSITIVE_INFINITY;for(n=0,r=e.length;n<r;++n){const r=e[n].element;if(r&&r.hasValue()){const e=cse(t,r.getCenterPoint());e<s&&(s=e,a=r)}}if(a){const e=a.tooltipPosition();i=e.x,o=e.y}return{x:i,y:o}}};function Jhe(e,t){return t&&(Soe(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function Qhe(e){return("string"===typeof e||e instanceof String)&&e.indexOf("\n")>-1?e.split("\n"):e}function Zhe(e,t){const{element:n,datasetIndex:r,index:a}=t,i=e.getDatasetMeta(r).controller,{label:o,value:s}=i.getLabelAndValue(a);return{chart:e,label:o,parsed:i.getParsed(a),raw:e.data.datasets[r].data[a],formattedValue:s,dataset:i.getDataset(),dataIndex:a,datasetIndex:r,element:n}}function ede(e,t){const n=e.chart.ctx,{body:r,footer:a,title:i}=e,{boxWidth:o,boxHeight:s}=t,l=gle(t.bodyFont),c=gle(t.titleFont),u=gle(t.footerFont),h=i.length,d=a.length,f=r.length,p=ple(t.padding);let g=p.height,m=0,v=r.reduce((e,t)=>e+t.before.length+t.lines.length+t.after.length,0);if(v+=e.beforeBody.length+e.afterBody.length,h&&(g+=h*c.lineHeight+(h-1)*t.titleSpacing+t.titleMarginBottom),v){g+=f*(t.displayColors?Math.max(s,l.lineHeight):l.lineHeight)+(v-f)*l.lineHeight+(v-1)*t.bodySpacing}d&&(g+=t.footerMarginTop+d*u.lineHeight+(d-1)*t.footerSpacing);let b=0;const x=function(e){m=Math.max(m,n.measureText(e).width+b)};return n.save(),n.font=c.string,Roe(e.title,x),n.font=l.string,Roe(e.beforeBody.concat(e.afterBody),x),b=t.displayColors?o+2+t.boxPadding:0,Roe(r,e=>{Roe(e.before,x),Roe(e.lines,x),Roe(e.after,x)}),b=0,n.font=u.string,Roe(e.footer,x),n.restore(),m+=p.width,{width:m,height:g}}function tde(e,t,n,r){const{x:a,width:i}=n,{width:o,chartArea:{left:s,right:l}}=e;let c="center";return"center"===r?c=a<=(s+l)/2?"left":"right":a<=i/2?c="left":a>=o-i/2&&(c="right"),function(e,t,n,r){const{x:a,width:i}=r,o=n.caretSize+n.caretPadding;return"left"===e&&a+i+o>t.width||"right"===e&&a-i-o<0||void 0}(c,e,t,n)&&(c="center"),c}function nde(e,t,n){const r=n.yAlign||t.yAlign||function(e,t){const{y:n,height:r}=t;return n<r/2?"top":n>e.height-r/2?"bottom":"center"}(e,n);return{xAlign:n.xAlign||t.xAlign||tde(e,t,n,r),yAlign:r}}function rde(e,t,n,r){const{caretSize:a,caretPadding:i,cornerRadius:o}=e,{xAlign:s,yAlign:l}=n,c=a+i,{topLeft:u,topRight:h,bottomLeft:d,bottomRight:f}=fle(o);let p=function(e,t){let{x:n,width:r}=e;return"right"===t?n-=r:"center"===t&&(n-=r/2),n}(t,s);const g=function(e,t,n){let{y:r,height:a}=e;return"top"===t?r+=n:r-="bottom"===t?a+n:a/2,r}(t,l,c);return"center"===l?"left"===s?p+=c:"right"===s&&(p-=c):"left"===s?p-=Math.max(u,d)+a:"right"===s&&(p+=Math.max(h,f)+a),{x:fse(p,0,r.width-t.width),y:fse(g,0,r.height-t.height)}}function ade(e,t,n){const r=ple(n.padding);return"center"===t?e.x+e.width/2:"right"===t?e.x+e.width-r.right:e.x+r.left}function ide(e){return Jhe([],Qhe(e))}function ode(e,t){const n=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return n?e.override(n):e}const sde={beforeTitle:woe,title(e){if(e.length>0){const t=e[0],n=t.chart.data.labels,r=n?n.length:0;if(this&&this.options&&"dataset"===this.options.mode)return t.dataset.label||"";if(t.label)return t.label;if(r>0&&t.dataIndex<r)return n[t.dataIndex]}return""},afterTitle:woe,beforeBody:woe,beforeLabel:woe,label(e){if(this&&this.options&&"dataset"===this.options.mode)return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const n=e.formattedValue;return Noe(n)||(t+=n),t},labelColor(e){const t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:woe,afterBody:woe,beforeFooter:woe,footer:woe,afterFooter:woe};function lde(e,t,n,r){const a=e[t].call(n,r);return"undefined"===typeof a?sde[t].call(n,r):a}class cde extends Due{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,n=this.options.setContext(this.getContext()),r=n.enabled&&t.options.animation&&n.animations,a=new vce(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(a)),a}getContext(){return this.$context||(this.$context=(e=this.chart.getContext(),t=this,n=this._tooltipItems,vle(e,{tooltip:t,tooltipItems:n,type:"tooltip"})));var e,t,n}getTitle(e,t){const{callbacks:n}=t,r=lde(n,"beforeTitle",this,e),a=lde(n,"title",this,e),i=lde(n,"afterTitle",this,e);let o=[];return o=Jhe(o,Qhe(r)),o=Jhe(o,Qhe(a)),o=Jhe(o,Qhe(i)),o}getBeforeBody(e,t){return ide(lde(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:n}=t,r=[];return Roe(e,e=>{const t={before:[],lines:[],after:[]},a=ode(n,e);Jhe(t.before,Qhe(lde(a,"beforeLabel",this,e))),Jhe(t.lines,lde(a,"label",this,e)),Jhe(t.after,Qhe(lde(a,"afterLabel",this,e))),r.push(t)}),r}getAfterBody(e,t){return ide(lde(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:n}=t,r=lde(n,"beforeFooter",this,e),a=lde(n,"footer",this,e),i=lde(n,"afterFooter",this,e);let o=[];return o=Jhe(o,Qhe(r)),o=Jhe(o,Qhe(a)),o=Jhe(o,Qhe(i)),o}_createItems(e){const t=this._active,n=this.chart.data,r=[],a=[],i=[];let o,s,l=[];for(o=0,s=t.length;o<s;++o)l.push(Zhe(this.chart,t[o]));return e.filter&&(l=l.filter((t,r,a)=>e.filter(t,r,a,n))),e.itemSort&&(l=l.sort((t,r)=>e.itemSort(t,r,n))),Roe(l,t=>{const n=ode(e.callbacks,t);r.push(lde(n,"labelColor",this,t)),a.push(lde(n,"labelPointStyle",this,t)),i.push(lde(n,"labelTextColor",this,t))}),this.labelColors=r,this.labelPointStyles=a,this.labelTextColors=i,this.dataPoints=l,l}update(e,t){const n=this.options.setContext(this.getContext()),r=this._active;let a,i=[];if(r.length){const e=$he[n.position].call(this,r,this._eventPosition);i=this._createItems(n),this.title=this.getTitle(i,n),this.beforeBody=this.getBeforeBody(i,n),this.body=this.getBody(i,n),this.afterBody=this.getAfterBody(i,n),this.footer=this.getFooter(i,n);const t=this._size=ede(this,n),o=Object.assign({},e,t),s=nde(this.chart,n,o),l=rde(n,o,s,this.chart);this.xAlign=s.xAlign,this.yAlign=s.yAlign,a={opacity:1,x:l.x,y:l.y,width:t.width,height:t.height,caretX:e.x,caretY:e.y}}else 0!==this.opacity&&(a={opacity:0});this._tooltipItems=i,this.$context=void 0,a&&this._resolveAnimations().update(this,a),e&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,n,r){const a=this.getCaretPosition(e,n,r);t.lineTo(a.x1,a.y1),t.lineTo(a.x2,a.y2),t.lineTo(a.x3,a.y3)}getCaretPosition(e,t,n){const{xAlign:r,yAlign:a}=this,{caretSize:i,cornerRadius:o}=n,{topLeft:s,topRight:l,bottomLeft:c,bottomRight:u}=fle(o),{x:h,y:d}=e,{width:f,height:p}=t;let g,m,v,b,x,y;return"center"===a?(x=d+p/2,"left"===r?(g=h,m=g-i,b=x+i,y=x-i):(g=h+f,m=g+i,b=x-i,y=x+i),v=g):(m="left"===r?h+Math.max(s,c)+i:"right"===r?h+f-Math.max(l,u)-i:this.caretX,"top"===a?(b=d,x=b-i,g=m-i,v=m+i):(b=d+p,x=b+i,g=m+i,v=m-i),y=b),{x1:g,x2:m,x3:v,y1:b,y2:x,y3:y}}drawTitle(e,t,n){const r=this.title,a=r.length;let i,o,s;if(a){const l=ece(n.rtl,this.x,this.width);for(e.x=ade(this,n.titleAlign,n),t.textAlign=l.textAlign(n.titleAlign),t.textBaseline="middle",i=gle(n.titleFont),o=n.titleSpacing,t.fillStyle=n.titleColor,t.font=i.string,s=0;s<a;++s)t.fillText(r[s],l.x(e.x),e.y+i.lineHeight/2),e.y+=i.lineHeight+o,s+1===a&&(e.y+=n.titleMarginBottom-o)}}_drawColorBox(e,t,n,r,a){const i=this.labelColors[n],o=this.labelPointStyles[n],{boxHeight:s,boxWidth:l}=a,c=gle(a.bodyFont),u=ade(this,"left",a),h=r.x(u),d=s<c.lineHeight?(c.lineHeight-s)/2:0,f=t.y+d;if(a.usePointStyle){const t={radius:Math.min(l,s)/2,pointStyle:o.pointStyle,rotation:o.rotation,borderWidth:1},n=r.leftForLtr(h,l)+l/2,c=f+s/2;e.strokeStyle=a.multiKeyBackground,e.fillStyle=a.multiKeyBackground,$se(e,t,n,c),e.strokeStyle=i.borderColor,e.fillStyle=i.backgroundColor,$se(e,t,n,c)}else{e.lineWidth=Coe(i.borderWidth)?Math.max(...Object.values(i.borderWidth)):i.borderWidth||1,e.strokeStyle=i.borderColor,e.setLineDash(i.borderDash||[]),e.lineDashOffset=i.borderDashOffset||0;const t=r.leftForLtr(h,l),n=r.leftForLtr(r.xPlus(h,1),l-2),o=fle(i.borderRadius);Object.values(o).some(e=>0!==e)?(e.beginPath(),e.fillStyle=a.multiKeyBackground,ole(e,{x:t,y:f,w:l,h:s,radius:o}),e.fill(),e.stroke(),e.fillStyle=i.backgroundColor,e.beginPath(),ole(e,{x:n,y:f+1,w:l-2,h:s-2,radius:o}),e.fill()):(e.fillStyle=a.multiKeyBackground,e.fillRect(t,f,l,s),e.strokeRect(t,f,l,s),e.fillStyle=i.backgroundColor,e.fillRect(n,f+1,l-2,s-2))}e.fillStyle=this.labelTextColors[n]}drawBody(e,t,n){const{body:r}=this,{bodySpacing:a,bodyAlign:i,displayColors:o,boxHeight:s,boxWidth:l,boxPadding:c}=n,u=gle(n.bodyFont);let h=u.lineHeight,d=0;const f=ece(n.rtl,this.x,this.width),p=function(n){t.fillText(n,f.x(e.x+d),e.y+h/2),e.y+=h+a},g=f.textAlign(i);let m,v,b,x,y,w,k;for(t.textAlign=i,t.textBaseline="middle",t.font=u.string,e.x=ade(this,g,n),t.fillStyle=n.bodyColor,Roe(this.beforeBody,p),d=o&&"right"!==g?"center"===i?l/2+c:l+2+c:0,x=0,w=r.length;x<w;++x){for(m=r[x],v=this.labelTextColors[x],t.fillStyle=v,Roe(m.before,p),b=m.lines,o&&b.length&&(this._drawColorBox(t,e,x,f,n),h=Math.max(u.lineHeight,s)),y=0,k=b.length;y<k;++y)p(b[y]),h=u.lineHeight;Roe(m.after,p)}d=0,h=u.lineHeight,Roe(this.afterBody,p),e.y-=a}drawFooter(e,t,n){const r=this.footer,a=r.length;let i,o;if(a){const s=ece(n.rtl,this.x,this.width);for(e.x=ade(this,n.footerAlign,n),e.y+=n.footerMarginTop,t.textAlign=s.textAlign(n.footerAlign),t.textBaseline="middle",i=gle(n.footerFont),t.fillStyle=n.footerColor,t.font=i.string,o=0;o<a;++o)t.fillText(r[o],s.x(e.x),e.y+i.lineHeight/2),e.y+=i.lineHeight+n.footerSpacing}}drawBackground(e,t,n,r){const{xAlign:a,yAlign:i}=this,{x:o,y:s}=e,{width:l,height:c}=n,{topLeft:u,topRight:h,bottomLeft:d,bottomRight:f}=fle(r.cornerRadius);t.fillStyle=r.backgroundColor,t.strokeStyle=r.borderColor,t.lineWidth=r.borderWidth,t.beginPath(),t.moveTo(o+u,s),"top"===i&&this.drawCaret(e,t,n,r),t.lineTo(o+l-h,s),t.quadraticCurveTo(o+l,s,o+l,s+h),"center"===i&&"right"===a&&this.drawCaret(e,t,n,r),t.lineTo(o+l,s+c-f),t.quadraticCurveTo(o+l,s+c,o+l-f,s+c),"bottom"===i&&this.drawCaret(e,t,n,r),t.lineTo(o+d,s+c),t.quadraticCurveTo(o,s+c,o,s+c-d),"center"===i&&"left"===a&&this.drawCaret(e,t,n,r),t.lineTo(o,s+u),t.quadraticCurveTo(o,s,o+u,s),t.closePath(),t.fill(),r.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,n=this.$animations,r=n&&n.x,a=n&&n.y;if(r||a){const n=$he[e.position].call(this,this._active,this._eventPosition);if(!n)return;const i=this._size=ede(this,e),o=Object.assign({},n,this._size),s=nde(t,e,o),l=rde(e,o,s,t);r._to===l.x&&a._to===l.y||(this.xAlign=s.xAlign,this.yAlign=s.yAlign,this.width=i.width,this.height=i.height,this.caretX=n.x,this.caretY=n.y,this._resolveAnimations().update(this,l))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(t);const r={width:this.width,height:this.height},a={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const i=ple(t.padding),o=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&o&&(e.save(),e.globalAlpha=n,this.drawBackground(a,e,r,t),tce(e,t.textDirection),a.y+=i.top,this.drawTitle(a,e,t),this.drawBody(a,e,t),this.drawFooter(a,e,t),nce(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const n=this._active,r=e.map(e=>{let{datasetIndex:t,index:n}=e;const r=this.chart.getDatasetMeta(t);if(!r)throw new Error("Cannot find a dataset at index "+t);return{datasetIndex:t,element:r.data[n],index:n}}),a=!Doe(n,r),i=this._positionChanged(r,t);(a||i)&&(this._active=r,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,a=this._active||[],i=this._getActiveElements(e,a,t,n),o=this._positionChanged(i,e),s=t||!Doe(i,a)||o;return s&&(this._active=i,(r.enabled||r.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),s}_getActiveElements(e,t,n,r){const a=this.options;if("mouseout"===e.type)return[];if(!r)return t.filter(e=>this.chart.data.datasets[e.datasetIndex]&&void 0!==this.chart.getDatasetMeta(e.datasetIndex).controller.getParsed(e.index));const i=this.chart.getElementsAtEventForMode(e,a.mode,a,n);return a.reverse&&i.reverse(),i}_positionChanged(e,t){const{caretX:n,caretY:r,options:a}=this,i=$he[a.position].call(this,e,t);return!1!==i&&(n!==i.x||r!==i.y)}}(0,hn.A)(cde,"positioners",$he);var ude={id:"tooltip",_element:cde,positioners:$he,afterInit(e,t,n){n&&(e.tooltip=new cde({chart:e,options:n}))},beforeUpdate(e,t,n){e.tooltip&&e.tooltip.initialize(n)},reset(e,t,n){e.tooltip&&e.tooltip.initialize(n)},afterDraw(e){const t=e.tooltip;if(t&&t._willRender()){const n={tooltip:t};if(!1===e.notifyPlugins("beforeTooltipDraw",fn(fn({},n),{},{cancelable:!0})))return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",n)}},afterEvent(e,t){if(e.tooltip){const n=t.replay;e.tooltip.handleEvent(t.event,n,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:sde},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>"filter"!==e&&"itemSort"!==e&&"external"!==e,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};function hde(e,t,n,r){const a=e.indexOf(t);if(-1===a)return((e,t,n,r)=>("string"===typeof t?(n=e.push(t)-1,r.unshift({index:n,label:t})):isNaN(t)&&(n=null),n))(e,t,n,r);return a!==e.lastIndexOf(t)?n:a}function dde(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}class fde extends Uue{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const e=this.getLabels();for(const{index:n,label:r}of t)e[n]===r&&e.splice(n,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(Noe(e))return null;const n=this.getLabels();return((e,t)=>null===e?null:fse(Math.round(e),0,t))(t=isFinite(t)&&n[t]===e?t:hde(n,e,Ioe(t,e),this._addedLabels),n.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:n,max:r}=this.getMinMax(!0);"ticks"===this.options.bounds&&(e||(n=0),t||(r=this.getLabels().length-1)),this.min=n,this.max=r}buildTicks(){const e=this.min,t=this.max,n=this.options.offset,r=[];let a=this.getLabels();a=0===e&&t===a.length-1?a:a.slice(e,t+1),this._valueRange=Math.max(a.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let i=e;i<=t;i++)r.push({value:i});return r}getLabelForValue(e){return dde.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return"number"!==typeof e&&(e=this.parse(e)),null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function pde(e,t){const n=[],{bounds:r,step:a,min:i,max:o,precision:s,count:l,maxTicks:c,maxDigits:u,includeBounds:h}=e,d=a||1,f=c-1,{min:p,max:g}=t,m=!Noe(i),v=!Noe(o),b=!Noe(l),x=(g-p)/(u+1);let y,w,k,N,S=nse((g-p)/f/d)*d;if(S<1e-14&&!m&&!v)return[{value:p},{value:g}];N=Math.ceil(g/S)-Math.floor(p/S),N>f&&(S=nse(N*S/f/d)*d),Noe(s)||(y=Math.pow(10,s),S=Math.ceil(S*y)/y),"ticks"===r?(w=Math.floor(p/S)*S,k=Math.ceil(g/S)*S):(w=p,k=g),m&&v&&a&&function(e,t){const n=Math.round(e);return n-t<=e&&n+t>=e}((o-i)/a,S/1e3)?(N=Math.round(Math.min((o-i)/S,c)),S=(o-i)/N,w=i,k=o):b?(w=m?i:w,k=v?o:k,N=l-1,S=(k-w)/N):(N=(k-w)/S,N=tse(N,Math.round(N),S/1e3)?Math.round(N):Math.ceil(N));const C=Math.max(sse(S),sse(w));y=Math.pow(10,Noe(s)?C:s),w=Math.round(w*y)/y,k=Math.round(k*y)/y;let E=0;for(m&&(h&&w!==i?(n.push({value:i}),w<i&&E++,tse(Math.round((w+E*S)*y)/y,i,gde(i,x,e))&&E++):w<i&&E++);E<N;++E){const e=Math.round((w+E*S)*y)/y;if(v&&e>o)break;n.push({value:e})}return v&&h&&k!==o?n.length&&tse(n[n.length-1].value,o,gde(o,x,e))?n[n.length-1].value=o:n.push({value:o}):v&&k!==o||n.push({value:k}),n}function gde(e,t,n){let{horizontal:r,minRotation:a}=n;const i=ise(a),o=(r?Math.sin(i):Math.cos(i))||.001,s=.75*t*(""+e).length;return Math.min(t/o,s)}(0,hn.A)(fde,"id","category"),(0,hn.A)(fde,"defaults",{ticks:{callback:dde}});class mde extends Uue{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return Noe(e)||("number"===typeof e||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:n}=this.getUserBounds();let{min:r,max:a}=this;const i=e=>r=t?r:e,o=e=>a=n?a:e;if(e){const e=ese(r),t=ese(a);e<0&&t<0?o(0):e>0&&t>0&&i(0)}if(r===a){let t=0===a?1:Math.abs(.05*a);o(a+t),e||i(r-t)}this.min=r,this.max=a}getTickLimit(){const e=this.options.ticks;let t,{maxTicksLimit:n,stepSize:r}=e;return r?(t=Math.ceil(this.max/r)-Math.floor(this.min/r)+1,t>1e3&&(console.warn("scales.".concat(this.id,".ticks.stepSize: ").concat(r," would result generating up to ").concat(t," ticks. Limiting to 1000.")),t=1e3)):(t=this.computeTickLimit(),n=n||11),n&&(t=Math.min(n,t)),t}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let n=this.getTickLimit();n=Math.max(2,n);const r=pde({maxTicks:n,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:!1!==t.includeBounds},this._range||this);return"ticks"===e.bounds&&ase(r,this,"value"),e.reverse?(r.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),r}configure(){const e=this.ticks;let t=this.min,n=this.max;if(super.configure(),this.options.offset&&e.length){const r=(n-t)/Math.max(e.length-1,1)/2;t-=r,n+=r}this._startValue=t,this._endValue=n,this._valueRange=n-t}getLabelForValue(e){return Mse(e,this.chart.options.locale,this.options.ticks.format)}}class vde extends mde{determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=Eoe(e)?e:0,this.max=Eoe(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,n=ise(this.options.ticks.minRotation),r=(e?Math.sin(n):Math.cos(n))||.001,a=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,a.lineHeight/r))}getPixelForValue(e){return null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}(0,hn.A)(vde,"id","linear"),(0,hn.A)(vde,"defaults",{ticks:{callback:Bse.formatters.numeric}});const bde=e=>Math.floor(Zoe(e)),xde=(e,t)=>Math.pow(10,bde(e)+t);function yde(e){return 1===e/Math.pow(10,bde(e))}function wde(e,t,n){const r=Math.pow(10,n),a=Math.floor(e/r);return Math.ceil(t/r)-a}function kde(e,t){let{min:n,max:r}=t;n=_oe(e.min,n);const a=[],i=bde(n);let o=function(e,t){let n=bde(t-e);for(;wde(e,t,n)>10;)n++;for(;wde(e,t,n)<10;)n--;return Math.min(n,bde(e))}(n,r),s=o<0?Math.pow(10,Math.abs(o)):1;const l=Math.pow(10,o),c=i>o?Math.pow(10,i):0,u=Math.round((n-c)*s)/s,h=Math.floor((n-c)/l/10)*l*10;let d=Math.floor((u-h)/Math.pow(10,o)),f=_oe(e.min,Math.round((c+h+d*Math.pow(10,o))*s)/s);for(;f<r;)a.push({value:f,major:yde(f),significand:d}),d>=10?d=d<15?15:20:d++,d>=20&&(o++,d=2,s=o>=0?1:s),f=Math.round((c+h+d*Math.pow(10,o))*s)/s;const p=_oe(e.max,f);return a.push({value:p,major:yde(p),significand:d}),a}class Nde extends Uue{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,t){const n=mde.prototype.parse.apply(this,[e,t]);if(0!==n)return Eoe(n)&&n>0?n:null;this._zero=!0}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=Eoe(e)?Math.max(0,e):null,this.max=Eoe(t)?Math.max(0,t):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!Eoe(this._userMin)&&(this.min=e===xde(this.min,0)?xde(this.min,-1):xde(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let n=this.min,r=this.max;const a=t=>n=e?n:t,i=e=>r=t?r:e;n===r&&(n<=0?(a(1),i(10)):(a(xde(n,-1)),i(xde(r,1)))),n<=0&&a(xde(r,-1)),r<=0&&i(xde(n,1)),this.min=n,this.max=r}buildTicks(){const e=this.options,t=kde({min:this._userMin,max:this._userMax},this);return"ticks"===e.bounds&&ase(t,this,"value"),e.reverse?(t.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),t}getLabelForValue(e){return void 0===e?"0":Mse(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=Zoe(e),this._valueRange=Zoe(this.max)-Zoe(e)}getPixelForValue(e){return void 0!==e&&0!==e||(e=this.min),null===e||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(Zoe(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const t=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+t*this._valueRange)}}function Sde(e){const t=e.ticks;if(t.display&&e.display){const e=ple(t.backdropPadding);return Ioe(t.font&&t.font.size,Gse.font.size)+e.height}return 0}function Cde(e,t,n){return n=Soe(n)?n:[n],{w:Kse(e,t.string,n),h:n.length*t.lineHeight}}function Ede(e,t,n,r,a){return e===r||e===a?{start:t-n/2,end:t+n/2}:e<r||e>a?{start:t-n,end:t}:{start:t,end:t+n}}function _de(e){const t={l:e.left+e._padding.left,r:e.right-e._padding.right,t:e.top+e._padding.top,b:e.bottom-e._padding.bottom},n=Object.assign({},t),r=[],a=[],i=e._pointLabels.length,o=e.options.pointLabels,s=o.centerPointLabels?Goe/i:0;for(let l=0;l<i;l++){const i=o.setContext(e.getPointLabelContext(l));a[l]=i.padding;const c=e.getPointPosition(l,e.drawingArea+a[l],s),u=gle(i.font),h=Cde(e.ctx,u,e._pointLabels[l]);r[l]=h;const d=hse(e.getIndexAngle(l)+s),f=Math.round(ose(d));Ide(n,t,d,Ede(f,c.x,h.w,0,180),Ede(f,c.y,h.h,90,270))}e.setCenterPoint(t.l-n.l,n.r-t.r,t.t-n.t,n.b-t.b),e._pointLabelItems=function(e,t,n){const r=[],a=e._pointLabels.length,i=e.options,{centerPointLabels:o,display:s}=i.pointLabels,l={extra:Sde(i)/2,additionalAngle:o?Goe/a:0};let c;for(let u=0;u<a;u++){l.padding=n[u],l.size=t[u];const a=Tde(e,u,l);r.push(a),"auto"===s&&(a.visible=Ade(a,c),a.visible&&(c=a))}return r}(e,r,a)}function Ide(e,t,n,r,a){const i=Math.abs(Math.sin(n)),o=Math.abs(Math.cos(n));let s=0,l=0;r.start<t.l?(s=(t.l-r.start)/i,e.l=Math.min(e.l,t.l-s)):r.end>t.r&&(s=(r.end-t.r)/i,e.r=Math.max(e.r,t.r+s)),a.start<t.t?(l=(t.t-a.start)/o,e.t=Math.min(e.t,t.t-l)):a.end>t.b&&(l=(a.end-t.b)/o,e.b=Math.max(e.b,t.b+l))}function Tde(e,t,n){const r=e.drawingArea,{extra:a,additionalAngle:i,padding:o,size:s}=n,l=e.getPointPosition(t,r+a+o,i),c=Math.round(ose(hse(l.angle+$oe))),u=function(e,t,n){90===n||270===n?e-=t/2:(n>270||n<90)&&(e-=t);return e}(l.y,s.h,c),h=function(e){if(0===e||180===e)return"center";if(e<180)return"left";return"right"}(c),d=function(e,t,n){"right"===n?e-=t:"center"===n&&(e-=t/2);return e}(l.x,s.w,h);return{visible:!0,x:l.x,y:u,textAlign:h,left:d,top:u,right:d+s.w,bottom:u+s.h}}function Ade(e,t){if(!t)return!0;const{left:n,top:r,right:a,bottom:i}=e;return!(Qse({x:n,y:r},t)||Qse({x:n,y:i},t)||Qse({x:a,y:r},t)||Qse({x:a,y:i},t))}function Rde(e,t,n){const{left:r,top:a,right:i,bottom:o}=n,{backdropColor:s}=t;if(!Noe(s)){const n=fle(t.borderRadius),l=ple(t.backdropPadding);e.fillStyle=s;const c=r-l.left,u=a-l.top,h=i-r+l.width,d=o-a+l.height;Object.values(n).some(e=>0!==e)?(e.beginPath(),ole(e,{x:c,y:u,w:h,h:d,radius:n}),e.fill()):e.fillRect(c,u,h,d)}}function Dde(e,t,n,r){const{ctx:a}=e;if(n)a.arc(e.xCenter,e.yCenter,t,0,qoe);else{let n=e.getPointPosition(0,t);a.moveTo(n.x,n.y);for(let i=1;i<r;i++)n=e.getPointPosition(i,t),a.lineTo(n.x,n.y)}}(0,hn.A)(Nde,"id","logarithmic"),(0,hn.A)(Nde,"defaults",{ticks:{callback:Bse.formatters.logarithmic,major:{enabled:!0}}});class Fde extends mde{constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=ple(Sde(this.options)/2),t=this.width=this.maxWidth-e.width,n=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+t/2+e.left),this.yCenter=Math.floor(this.top+n/2+e.top),this.drawingArea=Math.floor(Math.min(t,n)/2)}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!1);this.min=Eoe(e)&&!isNaN(e)?e:0,this.max=Eoe(t)&&!isNaN(t)?t:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/Sde(this.options))}generateTickLabels(e){mde.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((e,t)=>{const n=Aoe(this.options.pointLabels.callback,[e,t],this);return n||0===n?n:""}).filter((e,t)=>this.chart.getDataVisibility(t))}fit(){const e=this.options;e.display&&e.pointLabels.display?_de(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,t,n,r){this.xCenter+=Math.floor((e-t)/2),this.yCenter+=Math.floor((n-r)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,t,n,r))}getIndexAngle(e){return hse(e*(qoe/(this._pointLabels.length||1))+ise(this.options.startAngle||0))}getDistanceFromCenterForValue(e){if(Noe(e))return NaN;const t=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*t:(e-this.min)*t}getValueForDistanceFromCenter(e){if(Noe(e))return NaN;const t=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-t:this.min+t}getPointLabelContext(e){const t=this._pointLabels||[];if(e>=0&&e<t.length){const n=t[e];return function(e,t,n){return vle(e,{label:n,index:t,type:"pointLabel"})}(this.getContext(),e,n)}}getPointPosition(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=this.getIndexAngle(e)-$oe+n;return{x:Math.cos(r)*t+this.xCenter,y:Math.sin(r)*t+this.yCenter,angle:r}}getPointPositionForValue(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:t,top:n,right:r,bottom:a}=this._pointLabelItems[e];return{left:t,top:n,right:r,bottom:a}}drawBackground(){const{backgroundColor:e,grid:{circular:t}}=this.options;if(e){const n=this.ctx;n.save(),n.beginPath(),Dde(this,this.getDistanceFromCenterForValue(this._endValue),t,this._pointLabels.length),n.closePath(),n.fillStyle=e,n.fill(),n.restore()}}drawGrid(){const e=this.ctx,t=this.options,{angleLines:n,grid:r,border:a}=t,i=this._pointLabels.length;let o,s,l;if(t.pointLabels.display&&function(e,t){const{ctx:n,options:{pointLabels:r}}=e;for(let a=t-1;a>=0;a--){const t=e._pointLabelItems[a];if(!t.visible)continue;const i=r.setContext(e.getPointLabelContext(a));Rde(n,i,t);const o=gle(i.font),{x:s,y:l,textAlign:c}=t;ile(n,e._pointLabels[a],s,l+o.lineHeight/2,o,{color:i.color,textAlign:c,textBaseline:"middle"})}}(this,i),r.display&&this.ticks.forEach((e,t)=>{if(0!==t||0===t&&this.min<0){s=this.getDistanceFromCenterForValue(e.value);const n=this.getContext(t),o=r.setContext(n),l=a.setContext(n);!function(e,t,n,r,a){const i=e.ctx,o=t.circular,{color:s,lineWidth:l}=t;!o&&!r||!s||!l||n<0||(i.save(),i.strokeStyle=s,i.lineWidth=l,i.setLineDash(a.dash||[]),i.lineDashOffset=a.dashOffset,i.beginPath(),Dde(e,n,o,r),i.closePath(),i.stroke(),i.restore())}(this,o,s,i,l)}}),n.display){for(e.save(),o=i-1;o>=0;o--){const r=n.setContext(this.getPointLabelContext(o)),{color:a,lineWidth:i}=r;i&&a&&(e.lineWidth=i,e.strokeStyle=a,e.setLineDash(r.borderDash),e.lineDashOffset=r.borderDashOffset,s=this.getDistanceFromCenterForValue(t.reverse?this.min:this.max),l=this.getPointPosition(o,s),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(l.x,l.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,t=this.options,n=t.ticks;if(!n.display)return;const r=this.getIndexAngle(0);let a,i;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(r),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((r,o)=>{if(0===o&&this.min>=0&&!t.reverse)return;const s=n.setContext(this.getContext(o)),l=gle(s.font);if(a=this.getDistanceFromCenterForValue(this.ticks[o].value),s.showLabelBackdrop){e.font=l.string,i=e.measureText(r.label).width,e.fillStyle=s.backdropColor;const t=ple(s.backdropPadding);e.fillRect(-i/2-t.left,-a-l.size/2-t.top,i+t.width,l.size+t.height)}ile(e,r.label,0,-a,l,{color:s.color,strokeColor:s.textStrokeColor,strokeWidth:s.textStrokeWidth})}),e.restore()}drawTitle(){}}(0,hn.A)(Fde,"id","radialLinear"),(0,hn.A)(Fde,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Bse.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:e=>e,padding:5,centerPointLabels:!1}}),(0,hn.A)(Fde,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),(0,hn.A)(Fde,"descriptors",{angleLines:{_fallback:"grid"}});const Ode={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Lde=Object.keys(Ode);function Pde(e,t){return e-t}function Mde(e,t){if(Noe(t))return null;const n=e._adapter,{parser:r,round:a,isoWeekday:i}=e._parseOpts;let o=t;return"function"===typeof r&&(o=r(o)),Eoe(o)||(o="string"===typeof r?n.parse(o,r):n.parse(o)),null===o?null:(a&&(o="week"!==a||!rse(i)&&!0!==i?n.startOf(o,a):n.startOf(o,"isoWeek",i)),+o)}function jde(e,t,n,r){const a=Lde.length;for(let i=Lde.indexOf(e);i<a-1;++i){const e=Ode[Lde[i]],a=e.steps?e.steps:Number.MAX_SAFE_INTEGER;if(e.common&&Math.ceil((n-t)/(a*e.size))<=r)return Lde[i]}return Lde[a-1]}function Bde(e,t,n){if(n){if(n.length){const{lo:r,hi:a}=gse(n,t);e[n[r]>=t?n[r]:n[a]]=!0}}else e[t]=!0}function zde(e,t,n){const r=[],a={},i=t.length;let o,s;for(o=0;o<i;++o)s=t[o],a[s]=o,r.push({value:s,major:!1});return 0!==i&&n?function(e,t,n,r){const a=e._adapter,i=+a.startOf(t[0].value,r),o=t[t.length-1].value;let s,l;for(s=i;s<=o;s=+a.add(s,1,r))l=n[s],l>=0&&(t[l].major=!0);return t}(e,r,a,n):r}class Wde extends Uue{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.time||(e.time={}),r=this._adapter=new Xce(e.adapters.date);r.init(t),Moe(n.displayFormats,r.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return void 0===e?null:Mde(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,n=e.time.unit||"day";let{min:r,max:a,minDefined:i,maxDefined:o}=this.getUserBounds();function s(e){i||isNaN(e.min)||(r=Math.min(r,e.min)),o||isNaN(e.max)||(a=Math.max(a,e.max))}i&&o||(s(this._getLabelBounds()),"ticks"===e.bounds&&"labels"===e.ticks.source||s(this.getMinMax(!1))),r=Eoe(r)&&!isNaN(r)?r:+t.startOf(Date.now(),n),a=Eoe(a)&&!isNaN(a)?a:+t.endOf(Date.now(),n)+1,this.min=Math.min(r,a-1),this.max=Math.max(r+1,a)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],n=e[e.length-1]),{min:t,max:n}}buildTicks(){const e=this.options,t=e.time,n=e.ticks,r="labels"===n.source?this.getLabelTimestamps():this._generate();"ticks"===e.bounds&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const a=this.min,i=function(e,t,n){let r=0,a=e.length;for(;r<a&&e[r]<t;)r++;for(;a>r&&e[a-1]>n;)a--;return r>0||a<e.length?e.slice(r,a):e}(r,a,this.max);return this._unit=t.unit||(n.autoSkip?jde(t.minUnit,this.min,this.max,this._getLabelCapacity(a)):function(e,t,n,r,a){for(let i=Lde.length-1;i>=Lde.indexOf(n);i--){const n=Lde[i];if(Ode[n].common&&e._adapter.diff(a,r,n)>=t-1)return n}return Lde[n?Lde.indexOf(n):0]}(this,i.length,t.minUnit,this.min,this.max)),this._majorUnit=n.major.enabled&&"year"!==this._unit?function(e){for(let t=Lde.indexOf(e)+1,n=Lde.length;t<n;++t)if(Ode[Lde[t]].common)return Lde[t]}(this._unit):void 0,this.initOffsets(r),e.reverse&&i.reverse(),zde(this,i,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(){let e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=0,a=0;this.options.offset&&n.length&&(e=this.getDecimalForValue(n[0]),r=1===n.length?1-e:(this.getDecimalForValue(n[1])-e)/2,t=this.getDecimalForValue(n[n.length-1]),a=1===n.length?t:(t-this.getDecimalForValue(n[n.length-2]))/2);const i=n.length<3?.5:.25;r=fse(r,0,i),a=fse(a,0,i),this._offsets={start:r,end:a,factor:1/(r+1+a)}}_generate(){const e=this._adapter,t=this.min,n=this.max,r=this.options,a=r.time,i=a.unit||jde(a.minUnit,t,n,this._getLabelCapacity(t)),o=Ioe(r.ticks.stepSize,1),s="week"===i&&a.isoWeekday,l=rse(s)||!0===s,c={};let u,h,d=t;if(l&&(d=+e.startOf(d,"isoWeek",s)),d=+e.startOf(d,l?"day":i),e.diff(n,t,i)>1e5*o)throw new Error(t+" and "+n+" are too far apart with stepSize of "+o+" "+i);const f="data"===r.ticks.source&&this.getDataTimestamps();for(u=d,h=0;u<n;u=+e.add(u,o,i),h++)Bde(c,u,f);return u!==n&&"ticks"!==r.bounds&&1!==h||Bde(c,u,f),Object.keys(c).sort(Pde).map(e=>+e)}getLabelForValue(e){const t=this._adapter,n=this.options.time;return n.tooltipFormat?t.format(e,n.tooltipFormat):t.format(e,n.displayFormats.datetime)}format(e,t){const n=this.options.time.displayFormats,r=this._unit,a=t||n[r];return this._adapter.format(e,a)}_tickFormatFunction(e,t,n,r){const a=this.options,i=a.ticks.callback;if(i)return Aoe(i,[e,t,n],this);const o=a.time.displayFormats,s=this._unit,l=this._majorUnit,c=s&&o[s],u=l&&o[l],h=n[t],d=l&&u&&h&&h.major;return this._adapter.format(e,r||(d?u:c))}generateTickLabels(e){let t,n,r;for(t=0,n=e.length;t<n;++t)r=e[t],r.label=this._tickFormatFunction(r.value,t,e)}getDecimalForValue(e){return null===e?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,n=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+n)*t.factor)}getValueForPixel(e){const t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+n*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,n=this.ctx.measureText(e).width,r=ise(this.isHorizontal()?t.maxRotation:t.minRotation),a=Math.cos(r),i=Math.sin(r),o=this._resolveTickFontOptions(0).size;return{w:n*a+o*i,h:n*i+o*a}}_getLabelCapacity(e){const t=this.options.time,n=t.displayFormats,r=n[t.unit]||n.millisecond,a=this._tickFormatFunction(e,0,zde(this,[e],this._majorUnit),r),i=this._getLabelSize(a),o=Math.floor(this.isHorizontal()?this.width/i.w:this.height/i.h)-1;return o>0?o:1}getDataTimestamps(){let e,t,n=this._cache.data||[];if(n.length)return n;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(e=0,t=r.length;e<t;++e)n=n.concat(r[e].controller.getAllParsedValues(this));return this._cache.data=this.normalize(n)}getLabelTimestamps(){const e=this._cache.labels||[];let t,n;if(e.length)return e;const r=this.getLabels();for(t=0,n=r.length;t<n;++t)e.push(Mde(this,r[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return yse(e.sort(Pde))}}function Ude(e,t,n){let r,a,i,o,s=0,l=e.length-1;n?(t>=e[s].pos&&t<=e[l].pos&&({lo:s,hi:l}=mse(e,"pos",t)),({pos:r,time:i}=e[s]),({pos:a,time:o}=e[l])):(t>=e[s].time&&t<=e[l].time&&({lo:s,hi:l}=mse(e,"time",t)),({time:r,pos:i}=e[s]),({time:a,pos:o}=e[l]));const c=a-r;return c?i+(o-i)*(t-r)/c:i}(0,hn.A)(Wde,"id","time"),(0,hn.A)(Wde,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});class Vde extends Wde{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=Ude(t,this.min),this._tableRange=Ude(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:n}=this,r=[],a=[];let i,o,s,l,c;for(i=0,o=e.length;i<o;++i)l=e[i],l>=t&&l<=n&&r.push(l);if(r.length<2)return[{time:t,pos:0},{time:n,pos:1}];for(i=0,o=r.length;i<o;++i)c=r[i+1],s=r[i-1],l=r[i],Math.round((c+s)/2)!==l&&a.push({time:l,pos:i/(o-1)});return a}_generate(){const e=this.min,t=this.max;let n=super.getDataTimestamps();return n.includes(e)&&n.length||n.splice(0,0,e),n.includes(t)&&1!==n.length||n.push(t),n.sort((e,t)=>e-t)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),n=this.getLabelTimestamps();return e=t.length&&n.length?this.normalize(t.concat(n)):t.length?t:n,e=this._cache.all=e,e}getDecimalForValue(e){return(Ude(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return Ude(this._table,n*this._tableRange+this._minPos,!0)}}(0,hn.A)(Vde,"id","timeseries"),(0,hn.A)(Vde,"defaults",Wde.defaults);const Hde=["height","width","redraw","datasetIdKey","type","data","options","plugins","fallbackContent","updateMode"],Gde="label";function qde(e,t){"function"===typeof e?e(t):e&&(e.current=t)}function Kde(e,t){e.labels=t}function Xde(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Gde;const r=[];e.datasets=t.map(t=>{const a=e.datasets.find(e=>e[n]===t[n]);return a&&t.data&&!r.includes(a)?(r.push(a),Object.assign(a,t),a):fn({},t)})}function Yde(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Gde;const n={labels:[],datasets:[]};return Kde(n,e.labels),Xde(n,e.datasets,t),n}function $de(e,t){const{height:n=150,width:r=300,redraw:a=!1,datasetIdKey:i,type:o,data:s,options:c,plugins:u=[],fallbackContent:h,updateMode:d}=e,f=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,Hde),p=(0,l.useRef)(null),g=(0,l.useRef)(null),m=()=>{p.current&&(g.current=new xhe(p.current,{type:o,data:Yde(s,i),options:c&&fn({},c),plugins:u}),qde(t,g.current))},v=()=>{qde(t,null),g.current&&(g.current.destroy(),g.current=null)};return(0,l.useEffect)(()=>{!a&&g.current&&c&&function(e,t){const n=e.options;n&&t&&Object.assign(n,t)}(g.current,c)},[a,c]),(0,l.useEffect)(()=>{!a&&g.current&&Kde(g.current.config.data,s.labels)},[a,s.labels]),(0,l.useEffect)(()=>{!a&&g.current&&s.datasets&&Xde(g.current.config.data,s.datasets,i)},[a,s.datasets]),(0,l.useEffect)(()=>{g.current&&(a?(v(),setTimeout(m)):g.current.update(d))},[a,c,s.labels,s.datasets,d]),(0,l.useEffect)(()=>{g.current&&(v(),setTimeout(m))},[o]),(0,l.useEffect)(()=>(m(),()=>v()),[]),(0,Ba.jsx)("canvas",fn(fn({ref:p,role:"img",height:n,width:r},f),{},{children:h}))}const Jde=(0,l.forwardRef)($de);function Qde(e,t){return xhe.register(t),(0,l.forwardRef)((t,n)=>(0,Ba.jsx)(Jde,fn(fn({},t),{},{ref:n,type:e})))}const Zde=Qde("line",Wce);xhe.register(fde,vde,Phe,Ohe,Yhe,ude,Khe);const efe=()=>{const[e,t]=(0,l.useState)([]),[n,r]=(0,l.useState)({benchPress:"",squat:"",deadlift:"",notes:""}),[a,i]=(0,l.useState)(!1),[o,s]=(0,l.useState)(!0);(0,l.useEffect)(()=>{c()},[]);const c=async()=>{try{const{data:e}=await ja.get("/gym-stats/me");t(e)}catch(gfe){console.error("Failed to load stats")}finally{s(!1)}},u={labels:[...e].reverse().map(e=>new Date(e.date).toLocaleDateString(void 0,{month:"short",day:"numeric"})),datasets:[{label:"Bench Press",data:[...e].reverse().map(e=>e.metrics.benchPress),borderColor:"#ef4444",backgroundColor:"rgba(239, 68, 68, 0.5)",tension:.3},{label:"Squat",data:[...e].reverse().map(e=>e.metrics.squat),borderColor:"#3b82f6",backgroundColor:"rgba(59, 130, 246, 0.5)",tension:.3},{label:"Deadlift",data:[...e].reverse().map(e=>e.metrics.deadlift),borderColor:"#10b981",backgroundColor:"rgba(16, 185, 129, 0.5)",tension:.3}]};return o?(0,Ba.jsx)("div",{className:"p-8 text-center text-gray-400",children:"Loading Stats..."}):(0,Ba.jsxs)("div",{className:"min-h-screen bg-gray-900 p-4 md:p-8 text-white",children:[(0,Ba.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center mb-8 gap-4",children:[(0,Ba.jsxs)("h1",{className:"text-3xl font-bold flex items-center gap-3",children:[(0,Ba.jsx)(Nt,{className:"text-red-500"})," Gym Stats"]}),(0,Ba.jsxs)("button",{onClick:()=>i(!a),className:"bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-xl flex items-center gap-2 font-bold shadow-lg transition-transform hover:scale-105",children:[(0,Ba.jsx)(Vt,{})," ",a?"Cancel":"Log New PR"]})]}),a&&(0,Ba.jsxs)("div",{className:"bg-gray-800 p-6 rounded-2xl mb-8 border border-gray-700 animate-fade-in shadow-2xl",children:[(0,Ba.jsx)("h3",{className:"text-xl font-semibold mb-4 text-gray-200",children:"Log Personal Record"}),(0,Ba.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{await ja.post("/gym-stats",n),i(!1),r({benchPress:"",squat:"",deadlift:"",notes:""}),c()}catch(gfe){alert("Error saving record")}},className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,Ba.jsxs)("div",{className:"space-y-1",children:[(0,Ba.jsx)("label",{className:"text-xs text-gray-400",children:"Bench Press (kg)"}),(0,Ba.jsx)("input",{type:"number",placeholder:"0",className:"w-full p-3 bg-gray-900 rounded-lg border border-gray-600 text-white focus:border-red-500 outline-none",value:n.benchPress,onChange:e=>r(fn(fn({},n),{},{benchPress:e.target.value}))})]}),(0,Ba.jsxs)("div",{className:"space-y-1",children:[(0,Ba.jsx)("label",{className:"text-xs text-gray-400",children:"Squat (kg)"}),(0,Ba.jsx)("input",{type:"number",placeholder:"0",className:"w-full p-3 bg-gray-900 rounded-lg border border-gray-600 text-white focus:border-blue-500 outline-none",value:n.squat,onChange:e=>r(fn(fn({},n),{},{squat:e.target.value}))})]}),(0,Ba.jsxs)("div",{className:"space-y-1",children:[(0,Ba.jsx)("label",{className:"text-xs text-gray-400",children:"Deadlift (kg)"}),(0,Ba.jsx)("input",{type:"number",placeholder:"0",className:"w-full p-3 bg-gray-900 rounded-lg border border-gray-600 text-white focus:border-green-500 outline-none",value:n.deadlift,onChange:e=>r(fn(fn({},n),{},{deadlift:e.target.value}))})]}),(0,Ba.jsx)("button",{type:"submit",className:"col-span-full bg-green-600 hover:bg-green-700 py-3 rounded-xl font-bold mt-4 shadow-lg",children:"Save Stats"})]})]}),(0,Ba.jsxs)("div",{className:"bg-gray-800 p-6 rounded-2xl shadow-xl mb-8 border border-gray-700",children:[(0,Ba.jsx)("h3",{className:"text-xl font-semibold mb-6 text-gray-200",children:"Performance History"}),(0,Ba.jsx)("div",{className:"h-72 md:h-96 w-full",children:e.length>0?(0,Ba.jsx)(Zde,{options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"#9ca3af"}}},scales:{y:{grid:{color:"#374151"},ticks:{color:"#9ca3af"}},x:{grid:{color:"#374151"},ticks:{color:"#9ca3af"}}}},data:u}):(0,Ba.jsx)("div",{className:"h-full flex items-center justify-center text-gray-500",children:"No data yet. Log your first workout!"})})]}),(0,Ba.jsxs)("div",{className:"bg-gray-800 rounded-2xl overflow-hidden shadow-xl border border-gray-700",children:[(0,Ba.jsxs)("div",{className:"p-6 border-b border-gray-700 flex items-center gap-2",children:[(0,Ba.jsx)(vt,{className:"text-gray-400"}),(0,Ba.jsx)("h3",{className:"text-xl font-semibold text-gray-200",children:"Recent Logs"})]}),(0,Ba.jsx)("div",{className:"overflow-x-auto",children:(0,Ba.jsxs)("table",{className:"w-full text-left",children:[(0,Ba.jsx)("thead",{className:"bg-gray-700/50 text-gray-400 text-sm uppercase",children:(0,Ba.jsxs)("tr",{children:[(0,Ba.jsx)("th",{className:"p-4",children:"Date"}),(0,Ba.jsx)("th",{className:"p-4 text-red-400",children:"Bench"}),(0,Ba.jsx)("th",{className:"p-4 text-blue-400",children:"Squat"}),(0,Ba.jsx)("th",{className:"p-4 text-green-400",children:"Deadlift"})]})}),(0,Ba.jsx)("tbody",{className:"divide-y divide-gray-700",children:e.map(e=>(0,Ba.jsxs)("tr",{className:"hover:bg-gray-700/30 transition-colors",children:[(0,Ba.jsx)("td",{className:"p-4 text-gray-300",children:new Date(e.date).toLocaleDateString()}),(0,Ba.jsx)("td",{className:"p-4 font-mono font-bold text-white",children:e.metrics.benchPress||"-"}),(0,Ba.jsx)("td",{className:"p-4 font-mono font-bold text-white",children:e.metrics.squat||"-"}),(0,Ba.jsx)("td",{className:"p-4 font-mono font-bold text-white",children:e.metrics.deadlift||"-"})]},e._id))})]})})]})]})},tfe=()=>{const[e,t]=(0,l.useState)("overview"),[n,r]=(0,l.useState)(null),[a,i]=(0,l.useState)([]),[o,s]=(0,l.useState)([]),[c,u]=(0,l.useState)(!0),[h,d]=(0,l.useState)(""),f=async()=>{try{const[e,t,n]=await Promise.all([ja.get("/superadmin/dashboard"),ja.get("/superadmin/tenants"),ja.get("/superadmin/subscriptions")]);r(e.data),i(t.data),s(n.data)}catch(gfe){console.error("Failed to load superadmin data")}finally{u(!1)}};(0,l.useEffect)(()=>{f()},[]);const p=a.filter(e=>e.name.toLowerCase().includes(h.toLowerCase()));return c?(0,Ba.jsx)("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center text-white",children:"Loading Control Panel..."}):(0,Ba.jsxs)("div",{className:"min-h-screen bg-gray-900 p-6 text-white font-sans",children:[(0,Ba.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center mb-8",children:[(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("h1",{className:"text-3xl font-bold tracking-wide",children:"SUPER ADMIN"}),(0,Ba.jsx)("p",{className:"text-purple-400 text-sm",children:"SaaS Management Console"})]}),(0,Ba.jsxs)("div",{className:"flex gap-2 bg-gray-800 p-1 rounded-lg mt-4 md:mt-0",children:[(0,Ba.jsx)("button",{type:"button",onClick:()=>t("overview"),className:"px-4 py-2 rounded-md text-sm font-bold transition ".concat("overview"===e?"bg-purple-600 text-white":"text-gray-400 hover:text-white"),children:"Overview"}),(0,Ba.jsx)("button",{type:"button",onClick:()=>t("tenants"),className:"px-4 py-2 rounded-md text-sm font-bold transition ".concat("tenants"===e?"bg-purple-600 text-white":"text-gray-400 hover:text-white"),children:"Gyms"}),(0,Ba.jsx)("button",{type:"button",onClick:()=>t("subscriptions"),className:"px-4 py-2 rounded-md text-sm font-bold transition ".concat("subscriptions"===e?"bg-purple-600 text-white":"text-gray-400 hover:text-white"),children:"Revenue"})]})]}),"overview"===e&&(0,Ba.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 animate-fade-in",children:[(0,Ba.jsx)("div",{className:"bg-gradient-to-br from-purple-900/50 to-gray-800 border border-purple-500/30 p-6 rounded-2xl",children:(0,Ba.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Ba.jsx)("div",{className:"p-3 bg-purple-500/20 rounded-lg text-purple-400",children:(0,Ba.jsx)(ut,{size:24})}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("p",{className:"text-sm text-gray-400",children:"Total Gyms"}),(0,Ba.jsx)("p",{className:"text-3xl font-bold",children:null===n||void 0===n?void 0:n.totalTenants})]})]})}),(0,Ba.jsx)("div",{className:"bg-gradient-to-br from-blue-900/50 to-gray-800 border border-blue-500/30 p-6 rounded-2xl",children:(0,Ba.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Ba.jsx)("div",{className:"p-3 bg-blue-500/20 rounded-lg text-blue-400",children:(0,Ba.jsx)(un,{size:24})}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("p",{className:"text-sm text-gray-400",children:"Total Fighters"}),(0,Ba.jsx)("p",{className:"text-3xl font-bold",children:null===n||void 0===n?void 0:n.totalFighters})]})]})}),(0,Ba.jsx)("div",{className:"bg-gradient-to-br from-green-900/50 to-gray-800 border border-green-500/30 p-6 rounded-2xl",children:(0,Ba.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Ba.jsx)("div",{className:"p-3 bg-green-500/20 rounded-lg text-green-400",children:(0,Ba.jsx)(zt,{size:24})}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("p",{className:"text-sm text-gray-400",children:"Total SaaS Revenue"}),(0,Ba.jsxs)("p",{className:"text-3xl font-bold",children:["\u20b9",null===n||void 0===n?void 0:n.mmr]})]})]})})]}),"tenants"===e&&(0,Ba.jsxs)("div",{className:"bg-gray-800 rounded-xl border border-gray-700 overflow-hidden animate-fade-in",children:[(0,Ba.jsxs)("div",{className:"p-6 border-b border-gray-700 flex justify-between items-center",children:[(0,Ba.jsx)("h2",{className:"text-xl font-bold text-gray-200",children:"Gym Management"}),(0,Ba.jsxs)("div",{className:"relative",children:[(0,Ba.jsx)(Gt,{className:"absolute left-3 top-3 text-gray-500"}),(0,Ba.jsx)("input",{type:"text",placeholder:"Search Gyms...",className:"bg-gray-900 border border-gray-600 text-white pl-10 pr-4 py-2 rounded-lg focus:outline-none focus:border-purple-500",value:h,onChange:e=>d(e.target.value),onKeyPress:e=>"Enter"===e.key&&e.preventDefault()})]})]}),(0,Ba.jsxs)("table",{className:"w-full text-left text-sm text-gray-300",children:[(0,Ba.jsx)("thead",{className:"bg-gray-700 text-gray-400 uppercase text-xs",children:(0,Ba.jsxs)("tr",{children:[(0,Ba.jsx)("th",{className:"p-4",children:"Gym Name"}),(0,Ba.jsx)("th",{className:"p-4",children:"Slug"}),(0,Ba.jsx)("th",{className:"p-4",children:"Status"}),(0,Ba.jsx)("th",{className:"p-4 text-right",children:"Actions"})]})}),(0,Ba.jsx)("tbody",{className:"divide-y divide-gray-700",children:p.map(e=>(0,Ba.jsxs)("tr",{className:"hover:bg-gray-700/50 transition",children:[(0,Ba.jsx)("td",{className:"p-4 font-bold text-white",children:e.name}),(0,Ba.jsx)("td",{className:"p-4 text-blue-400 font-mono",children:e.slug}),(0,Ba.jsx)("td",{className:"p-4",children:(0,Ba.jsx)("span",{className:"px-2 py-1 rounded text-xs font-bold ".concat(e.isSuspended?"bg-red-900/50 text-red-400":"bg-green-900/50 text-green-400"),children:e.isSuspended?"SUSPENDED":"ACTIVE"})}),(0,Ba.jsx)("td",{className:"p-4 text-right",children:(0,Ba.jsx)("button",{type:"button",onClick:()=>(async(e,t)=>{window.confirm("Confirm ".concat(t?"ACTIVATE":"SUSPEND","?"))&&(await ja.put("/superadmin/tenants/".concat(e,"/status")),f())})(e._id,e.isSuspended),className:"px-3 py-1 rounded text-xs font-bold ".concat(e.isSuspended?"bg-green-600 text-white":"bg-red-600 text-white"),children:e.isSuspended?"Activate":"Suspend"})})]},e._id))})]})]}),"subscriptions"===e&&(0,Ba.jsxs)("div",{className:"bg-gray-800 rounded-xl border border-gray-700 overflow-hidden animate-fade-in",children:[(0,Ba.jsx)("div",{className:"p-6 border-b border-gray-700",children:(0,Ba.jsxs)("h2",{className:"text-xl font-bold text-gray-200 flex items-center gap-2",children:[(0,Ba.jsx)(At,{className:"text-green-500"})," SaaS Payment History"]})}),(0,Ba.jsxs)("table",{className:"w-full text-left text-sm text-gray-300",children:[(0,Ba.jsx)("thead",{className:"bg-gray-700 text-gray-400 uppercase text-xs",children:(0,Ba.jsxs)("tr",{children:[(0,Ba.jsx)("th",{className:"p-4",children:"Gym Name"}),(0,Ba.jsx)("th",{className:"p-4",children:"Plan"}),(0,Ba.jsx)("th",{className:"p-4",children:"Amount"}),(0,Ba.jsx)("th",{className:"p-4",children:"Date"}),(0,Ba.jsx)("th",{className:"p-4",children:"Status"})]})}),(0,Ba.jsx)("tbody",{className:"divide-y divide-gray-700",children:o.length>0?o.map(e=>{var t;return(0,Ba.jsxs)("tr",{className:"hover:bg-gray-700/50",children:[(0,Ba.jsx)("td",{className:"p-4 font-bold text-white",children:(null===(t=e.tenant)||void 0===t?void 0:t.name)||"Unknown Gym"}),(0,Ba.jsx)("td",{className:"p-4",children:e.planName}),(0,Ba.jsxs)("td",{className:"p-4 text-green-400 font-bold",children:["\u20b9",e.amount]}),(0,Ba.jsx)("td",{className:"p-4",children:new Date(e.startDate).toLocaleDateString()}),(0,Ba.jsx)("td",{className:"p-4",children:(0,Ba.jsx)("span",{className:"px-2 py-1 bg-green-900/30 text-green-400 rounded text-xs font-bold border border-green-800",children:e.status})})]},e._id)}):(0,Ba.jsx)("tr",{children:(0,Ba.jsx)("td",{colSpan:"5",className:"p-8 text-center text-gray-500",children:"No payment history found."})})})]})]})]})},nfe=e=>{let{setUser:t}=e;const[n,r]=(0,l.useState)({email:"",password:""}),[a,i]=(0,l.useState)(""),[o,s]=(0,l.useState)(!1),c=le(),{email:u,password:h}=n,d=e=>{r(fn(fn({},n),{},{[e.target.name]:e.target.value}))};return(0,Ba.jsxs)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900 p-4",children:[(0,Ba.jsxs)("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden pointer-events-none",children:[(0,Ba.jsx)("div",{className:"absolute top-1/4 left-1/4 w-64 h-64 bg-purple-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob"}),(0,Ba.jsx)("div",{className:"absolute top-1/3 right-1/4 w-64 h-64 bg-blue-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob animation-delay-2000"}),(0,Ba.jsx)("div",{className:"absolute bottom-1/4 left-1/2 w-64 h-64 bg-pink-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob animation-delay-4000"})]}),(0,Ba.jsx)("div",{className:"relative z-10 w-full max-w-md",children:(0,Ba.jsxs)("div",{className:"bg-gray-800/70 backdrop-blur-xl border border-gray-700 rounded-2xl shadow-2xl overflow-hidden",children:[(0,Ba.jsxs)("div",{className:"p-8 text-center bg-gradient-to-r from-purple-900/50 to-gray-900/50 border-b border-gray-700",children:[(0,Ba.jsx)("div",{className:"flex justify-center mb-4",children:(0,Ba.jsx)("div",{className:"p-3 bg-gradient-to-r from-purple-600 to-blue-600 rounded-full",children:(0,Ba.jsx)(sn,{className:"text-2xl text-white"})})}),(0,Ba.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"Super Admin"}),(0,Ba.jsx)("p",{className:"text-gray-400",children:"Secure Control Panel Access"})]}),(0,Ba.jsxs)("div",{className:"p-8",children:[a&&(0,Ba.jsx)("div",{className:"mb-6 p-3 bg-red-900/30 border border-red-700 rounded-lg text-red-200 text-center text-sm",children:a}),(0,Ba.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),s(!0),i("");try{const e=await ja.post("/auth/login",{email:u,password:h,role:"superadmin"});localStorage.setItem("token",e.data.token),t(e.data.user),c("/superadmin/dashboard")}catch(gfe){var n,r;i((null===(n=gfe.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.msg)||"Login failed")}finally{s(!1)}},className:"space-y-6",children:[(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("label",{className:"block text-gray-300 text-sm font-medium mb-2",children:"Email Address"}),(0,Ba.jsx)("input",{type:"email",name:"email",value:u,onChange:d,className:"w-full px-4 py-3 bg-gray-700/50 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-purple-500 placeholder-gray-500",placeholder:"superadmin@example.com",required:!0})]}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("label",{className:"block text-gray-300 text-sm font-medium mb-2",children:"Password"}),(0,Ba.jsxs)("div",{className:"relative",children:[(0,Ba.jsx)("input",{type:"password",name:"password",value:h,onChange:d,className:"w-full px-4 py-3 bg-gray-700/50 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-purple-500 placeholder-gray-500",placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",required:!0}),(0,Ba.jsx)(jt,{className:"absolute right-3 top-3.5 text-gray-500"})]})]}),(0,Ba.jsx)("button",{type:"submit",disabled:o,className:"w-full py-3 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-500 hover:to-blue-500 text-white font-bold rounded-lg shadow-lg transition-all duration-300 transform hover:scale-[1.02] disabled:opacity-50 disabled:cursor-not-allowed",children:o?(0,Ba.jsxs)("div",{className:"flex items-center justify-center",children:[(0,Ba.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Authenticating..."]}):"Access Control Panel"})]})]}),(0,Ba.jsx)("div",{className:"p-6 bg-gray-900/50 border-t border-gray-700 text-center",children:(0,Ba.jsx)("p",{className:"text-gray-500 text-sm",children:"Authorized personnel only"})})]})})]})},rfe=e=>{let{title:t,subtitle:n,icon:r,children:a}=e;return(0,Ba.jsxs)("div",{className:"min-h-screen bg-gray-900 p-6 text-white font-sans",children:[(0,Ba.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center mb-8",children:[(0,Ba.jsxs)("div",{className:"flex items-center mb-4 md:mb-0",children:[(0,Ba.jsx)("div",{className:"p-3 bg-purple-600 rounded-lg mr-4",children:r&&(0,Ba.jsx)(r,{size:24})}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("h1",{className:"text-3xl font-bold tracking-wide",children:t}),(0,Ba.jsx)("p",{className:"text-purple-400 text-sm",children:n})]})]}),(0,Ba.jsxs)("div",{className:"flex gap-3",children:[(0,Ba.jsxs)("button",{className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors flex items-center",children:[(0,Ba.jsx)(Vt,{className:"mr-2"})," Add New"]}),(0,Ba.jsx)("button",{className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors",children:"Export Data"})]})]}),(0,Ba.jsx)("div",{className:"bg-gray-800 rounded-xl border border-gray-700 p-6",children:a||(0,Ba.jsxs)("div",{className:"text-center py-12",children:[(0,Ba.jsx)("div",{className:"inline-block p-4 bg-gray-700 rounded-full mb-4",children:r&&(0,Ba.jsx)(r,{size:32,className:"text-purple-400"})}),(0,Ba.jsx)("h2",{className:"text-2xl font-bold mb-2",children:t}),(0,Ba.jsxs)("p",{className:"text-gray-400 max-w-2xl mx-auto",children:["This page is under development. The ",t.toLowerCase()," module will allow you to manage all aspects of your SaaS platform efficiently."]}),(0,Ba.jsxs)("div",{className:"mt-6 inline-block bg-gray-700 px-4 py-2 rounded-lg text-sm",children:[(0,Ba.jsx)("span",{className:"text-purple-400",children:"Super Admin"})," \u2022 ",(0,Ba.jsx)("span",{className:"text-gray-400",children:"Control Panel"})]})]})})]})},afe=()=>(0,Ba.jsxs)(rfe,{title:"Gym Management",subtitle:"Manage all gyms in the platform",icon:ut,children:[(0,Ba.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,Ba.jsx)("div",{className:"bg-gradient-to-br from-purple-900/50 to-gray-800 border border-purple-500/30 p-6 rounded-2xl",children:(0,Ba.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Ba.jsx)("div",{className:"p-3 bg-purple-500/20 rounded-lg text-purple-400",children:(0,Ba.jsx)(ut,{size:24})}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("p",{className:"text-sm text-gray-400",children:"Total Gyms"}),(0,Ba.jsx)("p",{className:"text-3xl font-bold",children:"42"})]})]})}),(0,Ba.jsx)("div",{className:"bg-gradient-to-br from-green-900/50 to-gray-800 border border-green-500/30 p-6 rounded-2xl",children:(0,Ba.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Ba.jsx)("div",{className:"p-3 bg-green-500/20 rounded-lg text-green-400",children:(0,Ba.jsx)(gt,{size:24})}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("p",{className:"text-sm text-gray-400",children:"Active Gyms"}),(0,Ba.jsx)("p",{className:"text-3xl font-bold",children:"38"})]})]})}),(0,Ba.jsx)("div",{className:"bg-gradient-to-br from-red-900/50 to-gray-800 border border-red-500/30 p-6 rounded-2xl",children:(0,Ba.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Ba.jsx)("div",{className:"p-3 bg-red-500/20 rounded-lg text-red-400",children:(0,Ba.jsx)(ot,{size:24})}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("p",{className:"text-sm text-gray-400",children:"Suspended Gyms"}),(0,Ba.jsx)("p",{className:"text-3xl font-bold",children:"4"})]})]})})]}),(0,Ba.jsxs)("div",{className:"bg-gray-800 rounded-xl border border-gray-700 overflow-hidden",children:[(0,Ba.jsxs)("div",{className:"p-6 border-b border-gray-700 flex justify-between items-center",children:[(0,Ba.jsx)("h2",{className:"text-xl font-bold text-gray-200",children:"All Gyms"}),(0,Ba.jsxs)("div",{className:"relative",children:[(0,Ba.jsx)("input",{type:"text",placeholder:"Search gyms...",className:"bg-gray-900 border border-gray-600 text-white pl-10 pr-4 py-2 rounded-lg focus:outline-none focus:border-purple-500"}),(0,Ba.jsx)("svg",{className:"absolute left-3 top-2.5 text-gray-500",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",children:(0,Ba.jsx)("path",{d:"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"})})]})]}),(0,Ba.jsxs)("table",{className:"w-full text-left text-sm text-gray-300",children:[(0,Ba.jsx)("thead",{className:"bg-gray-700 text-gray-400 uppercase text-xs",children:(0,Ba.jsxs)("tr",{children:[(0,Ba.jsx)("th",{className:"p-4",children:"Gym Name"}),(0,Ba.jsx)("th",{className:"p-4",children:"Slug"}),(0,Ba.jsx)("th",{className:"p-4",children:"Owner"}),(0,Ba.jsx)("th",{className:"p-4",children:"Members"}),(0,Ba.jsx)("th",{className:"p-4",children:"Status"}),(0,Ba.jsx)("th",{className:"p-4 text-right",children:"Actions"})]})}),(0,Ba.jsxs)("tbody",{className:"divide-y divide-gray-700",children:[(0,Ba.jsxs)("tr",{className:"hover:bg-gray-700/50 transition",children:[(0,Ba.jsx)("td",{className:"p-4 font-bold text-white",children:"Iron Forge Gym"}),(0,Ba.jsx)("td",{className:"p-4 text-blue-400 font-mono",children:"iron-forge"}),(0,Ba.jsx)("td",{className:"p-4",children:"john.doe@example.com"}),(0,Ba.jsx)("td",{className:"p-4",children:"124"}),(0,Ba.jsx)("td",{className:"p-4",children:(0,Ba.jsx)("span",{className:"px-2 py-1 rounded text-xs font-bold bg-green-900/50 text-green-400",children:"ACTIVE"})}),(0,Ba.jsxs)("td",{className:"p-4 text-right",children:[(0,Ba.jsx)("button",{className:"px-3 py-1 bg-purple-600 text-white rounded text-xs font-bold mr-2",children:"View"}),(0,Ba.jsx)("button",{className:"px-3 py-1 bg-red-600 text-white rounded text-xs font-bold",children:"Suspend"})]})]}),(0,Ba.jsxs)("tr",{className:"hover:bg-gray-700/50 transition",children:[(0,Ba.jsx)("td",{className:"p-4 font-bold text-white",children:"Titan Fitness Center"}),(0,Ba.jsx)("td",{className:"p-4 text-blue-400 font-mono",children:"titan-fitness"}),(0,Ba.jsx)("td",{className:"p-4",children:"sarah.connor@example.com"}),(0,Ba.jsx)("td",{className:"p-4",children:"87"}),(0,Ba.jsx)("td",{className:"p-4",children:(0,Ba.jsx)("span",{className:"px-2 py-1 rounded text-xs font-bold bg-green-900/50 text-green-400",children:"ACTIVE"})}),(0,Ba.jsxs)("td",{className:"p-4 text-right",children:[(0,Ba.jsx)("button",{className:"px-3 py-1 bg-purple-600 text-white rounded text-xs font-bold mr-2",children:"View"}),(0,Ba.jsx)("button",{className:"px-3 py-1 bg-red-600 text-white rounded text-xs font-bold",children:"Suspend"})]})]})]})]})]})]}),ife=()=>(0,Ba.jsxs)(rfe,{title:"User Management",subtitle:"Manage all users across the platform",icon:un,children:[(0,Ba.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,Ba.jsx)("div",{className:"bg-gradient-to-br from-purple-900/50 to-gray-800 border border-purple-500/30 p-6 rounded-2xl",children:(0,Ba.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Ba.jsx)("div",{className:"p-3 bg-purple-500/20 rounded-lg text-purple-400",children:(0,Ba.jsx)(un,{size:24})}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("p",{className:"text-sm text-gray-400",children:"Total Users"}),(0,Ba.jsx)("p",{className:"text-3xl font-bold",children:"1,248"})]})]})}),(0,Ba.jsx)("div",{className:"bg-gradient-to-br from-blue-900/50 to-gray-800 border border-blue-500/30 p-6 rounded-2xl",children:(0,Ba.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Ba.jsx)("div",{className:"p-3 bg-blue-500/20 rounded-lg text-blue-400",children:(0,Ba.jsx)(sn,{size:24})}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("p",{className:"text-sm text-gray-400",children:"Admins"}),(0,Ba.jsx)("p",{className:"text-3xl font-bold",children:"42"})]})]})}),(0,Ba.jsx)("div",{className:"bg-gradient-to-br from-green-900/50 to-gray-800 border border-green-500/30 p-6 rounded-2xl",children:(0,Ba.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Ba.jsx)("div",{className:"p-3 bg-green-500/20 rounded-lg text-green-400",children:(0,Ba.jsx)(an,{size:24})}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("p",{className:"text-sm text-gray-400",children:"Fighters"}),(0,Ba.jsx)("p",{className:"text-3xl font-bold",children:"1,206"})]})]})})]}),(0,Ba.jsxs)("div",{className:"bg-gray-800 rounded-xl border border-gray-700 overflow-hidden",children:[(0,Ba.jsxs)("div",{className:"p-6 border-b border-gray-700 flex justify-between items-center",children:[(0,Ba.jsx)("h2",{className:"text-xl font-bold text-gray-200",children:"All Users"}),(0,Ba.jsxs)("div",{className:"relative",children:[(0,Ba.jsx)("input",{type:"text",placeholder:"Search users...",className:"bg-gray-900 border border-gray-600 text-white pl-10 pr-4 py-2 rounded-lg focus:outline-none focus:border-purple-500"}),(0,Ba.jsx)("svg",{className:"absolute left-3 top-2.5 text-gray-500",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",children:(0,Ba.jsx)("path",{d:"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"})})]})]}),(0,Ba.jsxs)("table",{className:"w-full text-left text-sm text-gray-300",children:[(0,Ba.jsx)("thead",{className:"bg-gray-700 text-gray-400 uppercase text-xs",children:(0,Ba.jsxs)("tr",{children:[(0,Ba.jsx)("th",{className:"p-4",children:"User"}),(0,Ba.jsx)("th",{className:"p-4",children:"Email"}),(0,Ba.jsx)("th",{className:"p-4",children:"Role"}),(0,Ba.jsx)("th",{className:"p-4",children:"Gym"}),(0,Ba.jsx)("th",{className:"p-4",children:"Status"}),(0,Ba.jsx)("th",{className:"p-4 text-right",children:"Actions"})]})}),(0,Ba.jsxs)("tbody",{className:"divide-y divide-gray-700",children:[(0,Ba.jsxs)("tr",{className:"hover:bg-gray-700/50 transition",children:[(0,Ba.jsx)("td",{className:"p-4 font-bold text-white",children:"John Doe"}),(0,Ba.jsx)("td",{className:"p-4",children:"john.doe@example.com"}),(0,Ba.jsx)("td",{className:"p-4",children:(0,Ba.jsx)("span",{className:"px-2 py-1 rounded text-xs font-bold bg-blue-900/50 text-blue-400",children:"Admin"})}),(0,Ba.jsx)("td",{className:"p-4",children:"Iron Forge Gym"}),(0,Ba.jsx)("td",{className:"p-4",children:(0,Ba.jsx)("span",{className:"px-2 py-1 rounded text-xs font-bold bg-green-900/50 text-green-400",children:"Active"})}),(0,Ba.jsxs)("td",{className:"p-4 text-right",children:[(0,Ba.jsx)("button",{className:"px-3 py-1 bg-purple-600 text-white rounded text-xs font-bold mr-2",children:"Edit"}),(0,Ba.jsx)("button",{className:"px-3 py-1 bg-red-600 text-white rounded text-xs font-bold",children:"Disable"})]})]}),(0,Ba.jsxs)("tr",{className:"hover:bg-gray-700/50 transition",children:[(0,Ba.jsx)("td",{className:"p-4 font-bold text-white",children:"Sarah Connor"}),(0,Ba.jsx)("td",{className:"p-4",children:"sarah.connor@example.com"}),(0,Ba.jsx)("td",{className:"p-4",children:(0,Ba.jsx)("span",{className:"px-2 py-1 rounded text-xs font-bold bg-green-900/50 text-green-400",children:"Fighter"})}),(0,Ba.jsx)("td",{className:"p-4",children:"Titan Fitness Center"}),(0,Ba.jsx)("td",{className:"p-4",children:(0,Ba.jsx)("span",{className:"px-2 py-1 rounded text-xs font-bold bg-green-900/50 text-green-400",children:"Active"})}),(0,Ba.jsxs)("td",{className:"p-4 text-right",children:[(0,Ba.jsx)("button",{className:"px-3 py-1 bg-purple-600 text-white rounded text-xs font-bold mr-2",children:"Edit"}),(0,Ba.jsx)("button",{className:"px-3 py-1 bg-red-600 text-white rounded text-xs font-bold",children:"Disable"})]})]})]})]})]})]}),ofe=()=>(0,Ba.jsxs)(rfe,{title:"Billing & Revenue",subtitle:"Manage subscriptions and payments across all gyms",icon:zt,children:[(0,Ba.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,Ba.jsx)("div",{className:"bg-gradient-to-br from-green-900/50 to-gray-800 border border-green-500/30 p-6 rounded-2xl",children:(0,Ba.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Ba.jsx)("div",{className:"p-3 bg-green-500/20 rounded-lg text-green-400",children:(0,Ba.jsx)(zt,{size:24})}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("p",{className:"text-sm text-gray-400",children:"Monthly Revenue"}),(0,Ba.jsx)("p",{className:"text-3xl font-bold",children:"\u20b91,24,850"})]})]})}),(0,Ba.jsx)("div",{className:"bg-gradient-to-br from-blue-900/50 to-gray-800 border border-blue-500/30 p-6 rounded-2xl",children:(0,Ba.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Ba.jsx)("div",{className:"p-3 bg-blue-500/20 rounded-lg text-blue-400",children:(0,Ba.jsx)(wt,{size:24})}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("p",{className:"text-sm text-gray-400",children:"Active Subscriptions"}),(0,Ba.jsx)("p",{className:"text-3xl font-bold",children:"42"})]})]})}),(0,Ba.jsx)("div",{className:"bg-gradient-to-br from-purple-900/50 to-gray-800 border border-purple-500/30 p-6 rounded-2xl",children:(0,Ba.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Ba.jsx)("div",{className:"p-3 bg-purple-500/20 rounded-lg text-purple-400",children:(0,Ba.jsx)(Ht,{size:24})}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("p",{className:"text-sm text-gray-400",children:"Pending Payments"}),(0,Ba.jsx)("p",{className:"text-3xl font-bold",children:"3"})]})]})})]}),(0,Ba.jsxs)("div",{className:"bg-gray-800 rounded-xl border border-gray-700 overflow-hidden",children:[(0,Ba.jsxs)("div",{className:"p-6 border-b border-gray-700 flex justify-between items-center",children:[(0,Ba.jsx)("h2",{className:"text-xl font-bold text-gray-200",children:"Recent Transactions"}),(0,Ba.jsxs)("div",{className:"relative",children:[(0,Ba.jsx)("input",{type:"text",placeholder:"Search transactions...",className:"bg-gray-900 border border-gray-600 text-white pl-10 pr-4 py-2 rounded-lg focus:outline-none focus:border-purple-500"}),(0,Ba.jsx)("svg",{className:"absolute left-3 top-2.5 text-gray-500",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",children:(0,Ba.jsx)("path",{d:"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"})})]})]}),(0,Ba.jsxs)("table",{className:"w-full text-left text-sm text-gray-300",children:[(0,Ba.jsx)("thead",{className:"bg-gray-700 text-gray-400 uppercase text-xs",children:(0,Ba.jsxs)("tr",{children:[(0,Ba.jsx)("th",{className:"p-4",children:"Gym"}),(0,Ba.jsx)("th",{className:"p-4",children:"Plan"}),(0,Ba.jsx)("th",{className:"p-4",children:"Amount"}),(0,Ba.jsx)("th",{className:"p-4",children:"Date"}),(0,Ba.jsx)("th",{className:"p-4",children:"Status"}),(0,Ba.jsx)("th",{className:"p-4 text-right",children:"Actions"})]})}),(0,Ba.jsxs)("tbody",{className:"divide-y divide-gray-700",children:[(0,Ba.jsxs)("tr",{className:"hover:bg-gray-700/50 transition",children:[(0,Ba.jsx)("td",{className:"p-4 font-bold text-white",children:"Iron Forge Gym"}),(0,Ba.jsx)("td",{className:"p-4",children:"Growth Plan"}),(0,Ba.jsx)("td",{className:"p-4 text-green-400 font-bold",children:"\u20b912,500"}),(0,Ba.jsx)("td",{className:"p-4",children:"2023-06-15"}),(0,Ba.jsx)("td",{className:"p-4",children:(0,Ba.jsx)("span",{className:"px-2 py-1 rounded text-xs font-bold bg-green-900/50 text-green-400",children:"Paid"})}),(0,Ba.jsxs)("td",{className:"p-4 text-right",children:[(0,Ba.jsx)("button",{className:"px-3 py-1 bg-purple-600 text-white rounded text-xs font-bold mr-2",children:"View"}),(0,Ba.jsx)("button",{className:"px-3 py-1 bg-gray-600 text-white rounded text-xs font-bold",children:"Invoice"})]})]}),(0,Ba.jsxs)("tr",{className:"hover:bg-gray-700/50 transition",children:[(0,Ba.jsx)("td",{className:"p-4 font-bold text-white",children:"Titan Fitness Center"}),(0,Ba.jsx)("td",{className:"p-4",children:"Starter Plan"}),(0,Ba.jsx)("td",{className:"p-4 text-green-400 font-bold",children:"\u20b94,900"}),(0,Ba.jsx)("td",{className:"p-4",children:"2023-06-10"}),(0,Ba.jsx)("td",{className:"p-4",children:(0,Ba.jsx)("span",{className:"px-2 py-1 rounded text-xs font-bold bg-green-900/50 text-green-400",children:"Paid"})}),(0,Ba.jsxs)("td",{className:"p-4 text-right",children:[(0,Ba.jsx)("button",{className:"px-3 py-1 bg-purple-600 text-white rounded text-xs font-bold mr-2",children:"View"}),(0,Ba.jsx)("button",{className:"px-3 py-1 bg-gray-600 text-white rounded text-xs font-bold",children:"Invoice"})]})]})]})]})]})]}),sfe=()=>(0,Ba.jsxs)(rfe,{title:"Platform Analytics",subtitle:"Insights and metrics across all gyms",icon:pt,children:[(0,Ba.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[(0,Ba.jsxs)("div",{className:"bg-gray-800 rounded-xl border border-gray-700 p-6",children:[(0,Ba.jsx)("h3",{className:"text-lg font-bold mb-4 text-gray-200",children:"User Growth"}),(0,Ba.jsx)("div",{className:"h-64 flex items-center justify-center bg-gray-900 rounded-lg",children:(0,Ba.jsxs)("div",{className:"text-center",children:[(0,Ba.jsx)("div",{className:"inline-block p-4 bg-purple-600 rounded-full mb-3",children:(0,Ba.jsx)(pt,{size:24})}),(0,Ba.jsx)("p",{className:"text-gray-400",children:"User Growth Chart"})]})})]}),(0,Ba.jsxs)("div",{className:"bg-gray-800 rounded-xl border border-gray-700 p-6",children:[(0,Ba.jsx)("h3",{className:"text-lg font-bold mb-4 text-gray-200",children:"Revenue Trends"}),(0,Ba.jsx)("div",{className:"h-64 flex items-center justify-center bg-gray-900 rounded-lg",children:(0,Ba.jsxs)("div",{className:"text-center",children:[(0,Ba.jsx)("div",{className:"inline-block p-4 bg-green-600 rounded-full mb-3",children:(0,Ba.jsx)(pt,{size:24})}),(0,Ba.jsx)("p",{className:"text-gray-400",children:"Revenue Trend Chart"})]})})]})]}),(0,Ba.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,Ba.jsx)("div",{className:"bg-gradient-to-br from-blue-900/50 to-gray-800 border border-blue-500/30 p-6 rounded-2xl",children:(0,Ba.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Ba.jsx)("div",{className:"p-3 bg-blue-500/20 rounded-lg text-blue-400",children:(0,Ba.jsx)(pt,{size:24})}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("p",{className:"text-sm text-gray-400",children:"Active Users"}),(0,Ba.jsx)("p",{className:"text-3xl font-bold",children:"12,450"})]})]})}),(0,Ba.jsx)("div",{className:"bg-gradient-to-br from-purple-900/50 to-gray-800 border border-purple-500/30 p-6 rounded-2xl",children:(0,Ba.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Ba.jsx)("div",{className:"p-3 bg-purple-500/20 rounded-lg text-purple-400",children:(0,Ba.jsx)(pt,{size:24})}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("p",{className:"text-sm text-gray-400",children:"Session Duration"}),(0,Ba.jsx)("p",{className:"text-3xl font-bold",children:"24.5m"})]})]})}),(0,Ba.jsx)("div",{className:"bg-gradient-to-br from-green-900/50 to-gray-800 border border-green-500/30 p-6 rounded-2xl",children:(0,Ba.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Ba.jsx)("div",{className:"p-3 bg-green-500/20 rounded-lg text-green-400",children:(0,Ba.jsx)(pt,{size:24})}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("p",{className:"text-sm text-gray-400",children:"Retention Rate"}),(0,Ba.jsx)("p",{className:"text-3xl font-bold",children:"87.3%"})]})]})})]})]}),lfe=()=>{const[e,t]=(0,l.useState)({platformName:"Mutants Academy",supportEmail:"support@mutantsacademy.com",maintenanceMode:!1,autoBackup:!0,notificationEmails:!0}),n=e=>{const{name:n,value:r,type:a,checked:i}=e.target;t(e=>fn(fn({},e),{},{[n]:"checkbox"===a?i:r}))};return(0,Ba.jsx)(rfe,{title:"System Settings",subtitle:"Configure platform-wide settings",icon:yt,children:(0,Ba.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,Ba.jsx)("div",{className:"lg:col-span-2",children:(0,Ba.jsxs)("div",{className:"bg-gray-800 rounded-xl border border-gray-700 p-6",children:[(0,Ba.jsx)("h3",{className:"text-lg font-bold mb-6 text-gray-200",children:"General Settings"}),(0,Ba.jsxs)("form",{onSubmit:e=>{e.preventDefault(),alert("Settings saved successfully!")},className:"space-y-6",children:[(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("label",{className:"block text-gray-300 text-sm font-medium mb-2",children:"Platform Name"}),(0,Ba.jsx)("input",{type:"text",name:"platformName",value:e.platformName,onChange:n,className:"w-full px-4 py-3 bg-gray-900 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("label",{className:"block text-gray-300 text-sm font-medium mb-2",children:"Support Email"}),(0,Ba.jsx)("input",{type:"email",name:"supportEmail",value:e.supportEmail,onChange:n,className:"w-full px-4 py-3 bg-gray-900 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),(0,Ba.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Ba.jsxs)("div",{className:"flex items-center",children:[(0,Ba.jsx)("input",{type:"checkbox",name:"maintenanceMode",checked:e.maintenanceMode,onChange:n,className:"w-5 h-5 text-purple-600 bg-gray-700 border-gray-600 rounded focus:ring-purple-500"}),(0,Ba.jsx)("label",{className:"ml-2 text-gray-300",children:"Maintenance Mode"})]}),(0,Ba.jsxs)("div",{className:"flex items-center",children:[(0,Ba.jsx)("input",{type:"checkbox",name:"autoBackup",checked:e.autoBackup,onChange:n,className:"w-5 h-5 text-purple-600 bg-gray-700 border-gray-600 rounded focus:ring-purple-500"}),(0,Ba.jsx)("label",{className:"ml-2 text-gray-300",children:"Automatic Backups"})]}),(0,Ba.jsxs)("div",{className:"flex items-center",children:[(0,Ba.jsx)("input",{type:"checkbox",name:"notificationEmails",checked:e.notificationEmails,onChange:n,className:"w-5 h-5 text-purple-600 bg-gray-700 border-gray-600 rounded focus:ring-purple-500"}),(0,Ba.jsx)("label",{className:"ml-2 text-gray-300",children:"Notification Emails"})]})]}),(0,Ba.jsx)("div",{className:"flex justify-end pt-4",children:(0,Ba.jsx)("button",{type:"submit",className:"px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white font-bold rounded-lg transition-colors",children:"Save Settings"})})]})]})}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsxs)("div",{className:"bg-gray-800 rounded-xl border border-gray-700 p-6 mb-6",children:[(0,Ba.jsx)("h3",{className:"text-lg font-bold mb-4 text-gray-200",children:"System Info"}),(0,Ba.jsxs)("div",{className:"space-y-4",children:[(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("p",{className:"text-gray-400 text-sm",children:"Version"}),(0,Ba.jsx)("p",{className:"text-white font-medium",children:"v2.1.4"})]}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("p",{className:"text-gray-400 text-sm",children:"Last Backup"}),(0,Ba.jsx)("p",{className:"text-white font-medium",children:"2023-06-18 14:30 UTC"})]}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("p",{className:"text-gray-400 text-sm",children:"Uptime"}),(0,Ba.jsx)("p",{className:"text-green-400 font-medium",children:"99.98%"})]})]})]}),(0,Ba.jsxs)("div",{className:"bg-gray-800 rounded-xl border border-gray-700 p-6",children:[(0,Ba.jsx)("h3",{className:"text-lg font-bold mb-4 text-gray-200",children:"Quick Actions"}),(0,Ba.jsxs)("div",{className:"space-y-3",children:[(0,Ba.jsx)("button",{className:"w-full px-4 py-3 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors text-left",children:"Clear Cache"}),(0,Ba.jsx)("button",{className:"w-full px-4 py-3 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors text-left",children:"Run Diagnostics"}),(0,Ba.jsx)("button",{className:"w-full px-4 py-3 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors text-left",children:"Restart Services"})]})]})]})]})})},cfe=()=>{const[e,t]=(0,l.useState)(""),[n,r]=(0,l.useState)(""),[a,i]=(0,l.useState)(""),[o,s]=(0,l.useState)(!1),c=le();return(0,Ba.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-900 p-4",children:(0,Ba.jsxs)("div",{className:"bg-gray-800 rounded-2xl shadow-2xl p-8 w-full max-w-md border border-gray-700",children:[(0,Ba.jsxs)("div",{className:"text-center mb-8",children:[(0,Ba.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"Forgot Password"}),(0,Ba.jsx)("p",{className:"text-gray-400",children:"Enter your email to receive a reset link"})]}),n&&(0,Ba.jsx)("div",{className:"mb-6 p-4 bg-green-900/30 border border-green-700 rounded-xl text-green-200 text-center",children:n}),a&&(0,Ba.jsx)("div",{className:"mb-6 p-4 bg-red-900/30 border border-red-700 rounded-xl text-red-200 text-center",children:a}),(0,Ba.jsxs)("form",{onSubmit:async t=>{t.preventDefault(),s(!0),i(""),r("");try{const t=await ja.post("/auth/forgot-password",{email:e});r(t.data.msg||"Email sent successfully.")}catch(gfe){var n,a;i((null===(n=gfe.response)||void 0===n||null===(a=n.data)||void 0===a?void 0:a.msg)||"An error occurred. Please try again.")}finally{s(!1)}},className:"space-y-6",children:[(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("label",{className:"block text-gray-300 mb-2",children:"Email Address"}),(0,Ba.jsx)("input",{type:"email",value:e,onChange:e=>t(e.target.value),className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-red-500",placeholder:"Enter your email",required:!0})]}),(0,Ba.jsx)("button",{type:"submit",disabled:o,className:"w-full py-3 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 text-white font-bold rounded-lg shadow-lg transition-all duration-300 disabled:opacity-50",children:o?"Sending...":"Send Reset Link"})]}),(0,Ba.jsx)("div",{className:"mt-6 text-center",children:(0,Ba.jsx)("button",{onClick:()=>c("/login"),className:"text-red-400 hover:text-red-300 font-medium",children:"Back to Login"})})]})})},ufe=()=>{const[e,t]=(0,l.useState)(""),[n,r]=(0,l.useState)(""),[a,i]=(0,l.useState)(""),[o,s]=(0,l.useState)(""),[c,u]=(0,l.useState)(!1),{resetToken:h}=ce(),d=le();return(0,Ba.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-900 p-4",children:(0,Ba.jsxs)("div",{className:"bg-gray-800 rounded-2xl shadow-2xl p-8 w-full max-w-md border border-gray-700",children:[(0,Ba.jsxs)("div",{className:"text-center mb-8",children:[(0,Ba.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"Reset Password"}),(0,Ba.jsx)("p",{className:"text-gray-400",children:"Enter your new password"})]}),a&&(0,Ba.jsx)("div",{className:"mb-6 p-4 bg-green-900/30 border border-green-700 rounded-xl text-green-200 text-center",children:a}),o&&(0,Ba.jsx)("div",{className:"mb-6 p-4 bg-red-900/30 border border-red-700 rounded-xl text-red-200 text-center",children:o}),(0,Ba.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),e===n)if(e.length<6)s("Password must be at least 6 characters");else{u(!0),s(""),i("");try{await ja.post("/auth/reset-password/".concat(h),{password:e});i("Password reset successfully!"),setTimeout(()=>{d("/login")},2e3)}catch(gfe){var r,a;s((null===(r=gfe.response)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.msg)||"An error occurred. Please try again.")}finally{u(!1)}}else s("Passwords do not match")},className:"space-y-6",children:[(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("label",{className:"block text-gray-300 mb-2",children:"New Password"}),(0,Ba.jsx)("input",{type:"password",value:e,onChange:e=>t(e.target.value),className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-red-500",placeholder:"Enter new password",required:!0})]}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsx)("label",{className:"block text-gray-300 mb-2",children:"Confirm Password"}),(0,Ba.jsx)("input",{type:"password",value:n,onChange:e=>r(e.target.value),className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-red-500",placeholder:"Confirm new password",required:!0})]}),(0,Ba.jsx)("button",{type:"submit",disabled:c,className:"w-full py-3 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 text-white font-bold rounded-lg shadow-lg transition-all duration-300 disabled:opacity-50",children:c?"Resetting...":"Reset Password"})]}),(0,Ba.jsx)("div",{className:"mt-6 text-center",children:(0,Ba.jsx)("button",{onClick:()=>d("/login"),className:"text-red-400 hover:text-red-300 font-medium",children:"Back to Login"})})]})})},hfe=e=>{let{handleLogout:t,closeSidebar:n}=e;const[r,a]=(0,l.useState)(!1),i="flex items-center w-full px-4 py-3 text-gray-300 hover:bg-gray-700 hover:text-white rounded-lg transition-colors duration-200",o="bg-red-600 text-white",s="flex items-center w-full pl-11 pr-4 py-2 text-sm text-gray-400 hover:bg-gray-700 hover:text-white rounded-lg transition-colors duration-200",c="bg-red-600/50 text-white",u=()=>{n&&n()};return(0,Ba.jsxs)("div",{className:"flex flex-col h-full bg-gray-800 border-r border-gray-700",children:[(0,Ba.jsxs)("div",{className:"p-6 mb-2 text-center border-b border-gray-700",children:[(0,Ba.jsx)("img",{src:"/logo.png",alt:"Logo",className:"w-20 h-20 mx-auto mb-3 rounded-full object-cover border-2 border-gray-500 shadow-md",onError:e=>{e.target.src="https://via.placeholder.com/150"}}),(0,Ba.jsx)("h1",{className:"text-lg font-bold text-white tracking-wider",children:"ADMIN PANEL"})]}),(0,Ba.jsxs)("nav",{className:"flex-grow px-3 space-y-1 overflow-y-auto py-4 custom-scrollbar",children:[(0,Ba.jsxs)(We,{to:"/admin/dashboard",className:e=>{let{isActive:t}=e;return t?"".concat(i," ").concat(o):i},onClick:u,children:[(0,Ba.jsx)(Jt,{className:"mr-3"})," Dashboard"]}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsxs)("button",{onClick:()=>a(!r),className:"".concat(i," justify-between group"),children:[(0,Ba.jsxs)("div",{className:"flex items-center",children:[(0,Ba.jsx)(un,{className:"mr-3"})," Manage Fighters"]}),r?(0,Ba.jsx)(at,{}):(0,Ba.jsx)(nt,{})]}),r&&(0,Ba.jsxs)("div",{className:"mt-1 space-y-1 mb-1 bg-gray-900/30 rounded-lg pb-2",children:[(0,Ba.jsxs)(We,{to:"/admin/add-fighter",className:e=>{let{isActive:t}=e;return"".concat(s," ").concat(t?c:"")},onClick:u,children:[(0,Ba.jsx)(on,{className:"mr-3 text-xs"})," Add Fighter"]}),(0,Ba.jsxs)(We,{to:"/admin",end:!0,className:e=>{let{isActive:t}=e;return"".concat(s," ").concat(t?c:"")},onClick:u,children:[(0,Ba.jsx)(Mt,{className:"mr-3 text-xs"})," View Fighters"]})]})]}),(0,Ba.jsxs)(We,{to:"/admin/attendance",className:e=>{let{isActive:t}=e;return"".concat(i," ").concat(t?o:"")},onClick:u,children:[(0,Ba.jsx)(dt,{className:"mr-3"})," Attendance"]}),(0,Ba.jsxs)(We,{to:"/admin/subscriptions",className:e=>{let{isActive:t}=e;return"".concat(i," ").concat(t?o:"")},onClick:u,children:[(0,Ba.jsx)(zt,{className:"mr-3"})," Subscriptions"]}),(0,Ba.jsxs)(We,{to:"/admin/ask-doubt",className:e=>{let{isActive:t}=e;return"".concat(i," ").concat(t?o:"")},onClick:u,children:[(0,Ba.jsx)(Ct,{className:"mr-3"})," Ask Doubt"]}),(0,Ba.jsxs)(We,{to:"/admin/fighter-level",className:e=>{let{isActive:t}=e;return"".concat(i," ").concat(t?o:"")},onClick:u,children:[(0,Ba.jsx)(pt,{className:"mr-3"})," Fighter Levels"]}),(0,Ba.jsxs)(We,{to:"/admin/settings",className:e=>{let{isActive:t}=e;return"".concat(i," ").concat(t?o:"")},onClick:u,children:[(0,Ba.jsx)(xt,{className:"mr-3"})," Settings"]})]}),(0,Ba.jsx)("div",{className:"p-4 border-t border-gray-700 bg-gray-900/20",children:(0,Ba.jsxs)("button",{onClick:()=>{t(),u()},className:"flex items-center justify-center w-full px-4 py-3 text-red-400 bg-red-900/10 hover:bg-red-600 hover:text-white border border-red-900/20 hover:border-transparent rounded-xl transition-all duration-200 group",children:[(0,Ba.jsx)(Kt,{className:"mr-3 group-hover:rotate-180 transition-transform duration-300"}),(0,Ba.jsx)("span",{className:"font-semibold",children:"Logout"})]})})]})},dfe=e=>{let{handleLogout:t,closeSidebar:n}=e;const[r,a]=(0,l.useState)("FIGHTER"),i="flex items-center px-4 py-3 text-gray-300 hover:bg-gray-700 hover:text-white rounded-lg transition-colors duration-200",o="bg-blue-600 text-white";return(0,l.useEffect)(()=>{(async()=>{try{var e;const t=await ja.get("/fighters/me");null!==(e=t.data)&&void 0!==e&&e.name&&a(t.data.name)}catch(gfe){console.error(gfe)}})()},[]),(0,Ba.jsxs)("div",{className:"flex flex-col h-full",children:[(0,Ba.jsxs)("div",{className:"p-4 mb-4 text-center",children:[(0,Ba.jsx)("img",{src:"/logo.png",alt:"Logo",className:"w-24 h-24 mx-auto mb-2 rounded-full object-cover border-2 border-gray-600"}),(0,Ba.jsx)("h1",{className:"text-xl font-bold text-white tracking-wider",children:r})]}),(0,Ba.jsxs)("nav",{className:"flex-grow px-4 space-y-2",children:[(0,Ba.jsxs)(We,{to:"/fighter",end:!0,className:e=>{let{isActive:t}=e;return"".concat(i," ").concat(t?o:"")},onClick:n,children:[(0,Ba.jsx)(Ot,{className:"mr-3"})," Home"]}),(0,Ba.jsxs)(We,{to:"/fighter/attendance",className:e=>{let{isActive:t}=e;return"".concat(i," ").concat(t?o:"")},onClick:n,children:[(0,Ba.jsx)(dt,{className:"mr-3"})," My Attendance"]}),(0,Ba.jsxs)(We,{to:"/fighter/stats",className:e=>{let{isActive:t}=e;return"".concat(i," ").concat(t?o:"")},onClick:n,children:[(0,Ba.jsx)(Nt,{className:"mr-3"})," Gym Stats"]}),(0,Ba.jsxs)(We,{to:"/fighter/ask-doubt",className:e=>{let{isActive:t}=e;return"".concat(i," ").concat(t?o:"")},onClick:n,children:[(0,Ba.jsx)(Ct,{className:"mr-3"})," Ask Doubt"]})]}),(0,Ba.jsx)("div",{className:"p-4",children:(0,Ba.jsxs)("button",{onClick:()=>{t(),n()},className:"w-full flex items-center justify-center px-4 py-3 text-gray-300 bg-gray-700 hover:bg-red-700 hover:text-white rounded-lg transition-colors",children:[(0,Ba.jsx)(Kt,{className:"mr-3"})," Logout"]})})]})},ffe=e=>{let{handleLogout:t,closeSidebar:n}=e;const[r,a]=(0,l.useState)({gyms:!1,users:!1,billing:!1,settings:!1}),i=e=>{a(t=>fn(fn({},t),{},{[e]:!t[e]}))},o="flex items-center w-full px-4 py-3 text-gray-300 hover:bg-gray-800 hover:text-white rounded-lg transition-colors duration-200",s="bg-purple-600 text-white",c="ml-4 pl-4 border-l border-gray-700",u="flex items-center w-full px-4 py-2.5 text-sm text-gray-400 hover:bg-gray-800 hover:text-white rounded-lg transition-colors duration-200",h="bg-purple-600/50 text-white",d=()=>{n&&n()};return(0,Ba.jsxs)("div",{className:"flex flex-col h-full bg-gray-900 border-r border-gray-800",children:[(0,Ba.jsxs)("div",{className:"p-6 mb-2 text-center border-b border-gray-800",children:[(0,Ba.jsxs)("div",{className:"flex items-center justify-center mb-3",children:[(0,Ba.jsx)(sn,{className:"text-purple-500 text-2xl mr-2"}),(0,Ba.jsx)("h1",{className:"text-xl font-bold text-white tracking-wider",children:"SUPER ADMIN"})]}),(0,Ba.jsx)("p",{className:"text-xs text-purple-400 tracking-widest uppercase",children:"Control Panel"})]}),(0,Ba.jsxs)("nav",{className:"flex-grow px-3 space-y-1 overflow-y-auto py-4 custom-scrollbar",children:[(0,Ba.jsxs)(We,{to:"/superadmin/dashboard",className:e=>{let{isActive:t}=e;return t?"".concat(o," ").concat(s):o},onClick:d,children:[(0,Ba.jsx)(Jt,{className:"mr-3"})," Dashboard"]}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsxs)("button",{onClick:()=>i("gyms"),className:"".concat(o," justify-between group"),children:[(0,Ba.jsxs)("div",{className:"flex items-center",children:[(0,Ba.jsx)(ut,{className:"mr-3"})," Gyms"]}),r.gyms?(0,Ba.jsx)(nt,{}):(0,Ba.jsx)(rt,{})]}),r.gyms&&(0,Ba.jsxs)("div",{className:c,children:[(0,Ba.jsx)(We,{to:"/superadmin/tenants",className:e=>{let{isActive:t}=e;return"".concat(u," ").concat(t?h:"")},onClick:d,children:"All Gyms"}),(0,Ba.jsx)(We,{to:"/superadmin/tenants/create",className:e=>{let{isActive:t}=e;return"".concat(u," ").concat(t?h:"")},onClick:d,children:"Create Gym"}),(0,Ba.jsx)(We,{to:"/superadmin/tenants/inactive",className:e=>{let{isActive:t}=e;return"".concat(u," ").concat(t?h:"")},onClick:d,children:"Inactive Gyms"})]})]}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsxs)("button",{onClick:()=>i("users"),className:"".concat(o," justify-between group"),children:[(0,Ba.jsxs)("div",{className:"flex items-center",children:[(0,Ba.jsx)(un,{className:"mr-3"})," Users"]}),r.users?(0,Ba.jsx)(nt,{}):(0,Ba.jsx)(rt,{})]}),r.users&&(0,Ba.jsxs)("div",{className:c,children:[(0,Ba.jsx)(We,{to:"/superadmin/users/admins",className:e=>{let{isActive:t}=e;return"".concat(u," ").concat(t?h:"")},onClick:d,children:"Admins"}),(0,Ba.jsx)(We,{to:"/superadmin/users/fighters",className:e=>{let{isActive:t}=e;return"".concat(u," ").concat(t?h:"")},onClick:d,children:"Fighters"}),(0,Ba.jsx)(We,{to:"/superadmin/users/superadmins",className:e=>{let{isActive:t}=e;return"".concat(u," ").concat(t?h:"")},onClick:d,children:"Super Admins"})]})]}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsxs)("button",{onClick:()=>i("billing"),className:"".concat(o," justify-between group"),children:[(0,Ba.jsxs)("div",{className:"flex items-center",children:[(0,Ba.jsx)(zt,{className:"mr-3"})," Billing"]}),r.billing?(0,Ba.jsx)(nt,{}):(0,Ba.jsx)(rt,{})]}),r.billing&&(0,Ba.jsxs)("div",{className:c,children:[(0,Ba.jsx)(We,{to:"/superadmin/billing/subscriptions",className:e=>{let{isActive:t}=e;return"".concat(u," ").concat(t?h:"")},onClick:d,children:"Subscriptions"}),(0,Ba.jsx)(We,{to:"/superadmin/billing/payments",className:e=>{let{isActive:t}=e;return"".concat(u," ").concat(t?h:"")},onClick:d,children:"Payment History"}),(0,Ba.jsx)(We,{to:"/superadmin/billing/invoices",className:e=>{let{isActive:t}=e;return"".concat(u," ").concat(t?h:"")},onClick:d,children:"Invoices"}),(0,Ba.jsx)(We,{to:"/superadmin/billing/refunds",className:e=>{let{isActive:t}=e;return"".concat(u," ").concat(t?h:"")},onClick:d,children:"Refunds"})]})]}),(0,Ba.jsxs)(We,{to:"/superadmin/analytics",className:e=>{let{isActive:t}=e;return t?"".concat(o," ").concat(s):o},onClick:d,children:[(0,Ba.jsx)(pt,{className:"mr-3"})," Analytics"]}),(0,Ba.jsxs)("div",{children:[(0,Ba.jsxs)("button",{onClick:()=>i("settings"),className:"".concat(o," justify-between group"),children:[(0,Ba.jsxs)("div",{className:"flex items-center",children:[(0,Ba.jsx)(yt,{className:"mr-3"})," System"]}),r.settings?(0,Ba.jsx)(nt,{}):(0,Ba.jsx)(rt,{})]}),r.settings&&(0,Ba.jsxs)("div",{className:c,children:[(0,Ba.jsx)(We,{to:"/superadmin/settings/general",className:e=>{let{isActive:t}=e;return"".concat(u," ").concat(t?h:"")},onClick:d,children:"General Settings"}),(0,Ba.jsx)(We,{to:"/superadmin/settings/notifications",className:e=>{let{isActive:t}=e;return"".concat(u," ").concat(t?h:"")},onClick:d,children:"Notifications"}),(0,Ba.jsx)(We,{to:"/superadmin/settings/database",className:e=>{let{isActive:t}=e;return"".concat(u," ").concat(t?h:"")},onClick:d,children:"Database"}),(0,Ba.jsx)(We,{to:"/superadmin/settings/logs",className:e=>{let{isActive:t}=e;return"".concat(u," ").concat(t?h:"")},onClick:d,children:"System Logs"})]})]})]}),(0,Ba.jsx)("div",{className:"p-4 border-t border-gray-800 bg-gray-900/20",children:(0,Ba.jsxs)("button",{onClick:()=>{t(),d()},className:"flex items-center justify-center w-full px-4 py-3 text-red-400 bg-red-900/10 hover:bg-red-600 hover:text-white border border-red-900/20 hover:border-transparent rounded-xl transition-all duration-200 group",children:[(0,Ba.jsx)(Kt,{className:"mr-3 group-hover:rotate-180 transition-transform duration-300"}),(0,Ba.jsx)("span",{className:"font-semibold",children:"Logout"})]})})]})},pfe=()=>{const[e,t]=(0,l.useState)(null),[n,r]=(0,l.useState)(!0),[a,i]=(0,l.useState)(!1);(0,l.useEffect)(()=>{(async()=>{if(localStorage.getItem("token"))try{const{data:e}=await ja.get("/auth/user");t(e)}catch(e){console.error("Session expired or token is invalid."),t(null)}r(!1)})()},[]);const o=()=>{i(!0)},s=()=>{localStorage.removeItem("token"),t(null),window.location.href="/",i(!1)},c=()=>{i(!1)},u=t=>{let{children:r,role:a}=t;const i=oe();return n?null:e?a&&e.role!==a?(0,Ba.jsx)(Se,{to:"/",replace:!0}):"fighter"!==e.role||e.profile_completed||"/fighter/complete-profile"===i.pathname?"fighter"===e.role&&e.profile_completed&&"/fighter/complete-profile"===i.pathname?(0,Ba.jsx)(Se,{to:"/fighter",replace:!0}):r:(0,Ba.jsx)(Se,{to:"/fighter/complete-profile",replace:!0}):(0,Ba.jsx)(Se,{to:"/login",replace:!0})},h=t=>{let{children:n}=t;const[r,a]=(0,l.useState)(!1),i=()=>a(!1);return(0,Ba.jsxs)("div",{className:"relative min-h-screen bg-gray-100",children:[r&&(0,Ba.jsx)("div",{className:"fixed inset-0 z-20 bg-black opacity-50 lg:hidden",onClick:i}),(0,Ba.jsxs)("div",{className:"lg:hidden flex justify-between items-center bg-gray-800 text-white p-4 sticky top-0 z-10",children:[(0,Ba.jsx)("h1",{className:"text-xl font-bold",children:"Admin Panel"}),(0,Ba.jsx)("button",{onClick:()=>a(!r),children:r?(0,Ba.jsx)(Qt,{size:24}):(0,Ba.jsx)(st,{size:24})})]}),(0,Ba.jsx)("aside",{className:"fixed inset-y-0 left-0 z-30 w-64 bg-gray-800 text-white transform ".concat(r?"translate-x-0":"-translate-x-full"," transition-transform duration-300 ease-in-out lg:translate-x-0"),children:(0,Ba.jsx)(hfe,{handleLogout:o,closeSidebar:i,user:e})}),(0,Ba.jsx)("main",{className:"lg:ml-64 p-4 sm:p-6 lg:p-8 min-h-screen",children:n}),(0,Ba.jsx)(p,{})]})},d=t=>{let{children:n}=t;const[r,a]=(0,l.useState)(!1),i=()=>a(!1);return(0,Ba.jsxs)("div",{className:"relative min-h-screen bg-gray-900",children:[r&&(0,Ba.jsx)("div",{className:"fixed inset-0 z-20 bg-black opacity-50 lg:hidden",onClick:i}),(0,Ba.jsxs)("div",{className:"lg:hidden flex justify-between items-center bg-gray-800 text-white p-4 sticky top-0 z-10 border-b border-gray-700",children:[(0,Ba.jsx)("h1",{className:"text-xl font-bold",children:"Fighter Portal"}),(0,Ba.jsx)("button",{onClick:()=>a(!r),children:r?(0,Ba.jsx)(Qt,{size:24}):(0,Ba.jsx)(st,{size:24})})]}),(0,Ba.jsx)("aside",{className:"fixed inset-y-0 left-0 z-30 w-64 bg-gray-800 text-white transform ".concat(r?"translate-x-0":"-translate-x-full"," transition-transform duration-300 ease-in-out lg:translate-x-0 border-r border-gray-700"),children:(0,Ba.jsx)(dfe,{handleLogout:o,closeSidebar:i,user:e})}),(0,Ba.jsx)("main",{className:"lg:ml-64 p-4 sm:p-6 lg:p-8 min-h-screen",children:n}),(0,Ba.jsx)(p,{})]})},f=e=>{let{children:t}=e;const[n,r]=(0,l.useState)(!1),a=()=>r(!1);return(0,Ba.jsxs)("div",{className:"relative min-h-screen bg-gray-900",children:[n&&(0,Ba.jsx)("div",{className:"fixed inset-0 z-20 bg-black opacity-50 lg:hidden",onClick:a}),(0,Ba.jsxs)("div",{className:"lg:hidden flex justify-between items-center bg-gray-900 text-purple-400 p-4 sticky top-0 z-10 border-b border-gray-800",children:[(0,Ba.jsx)("h1",{className:"text-xl font-bold",children:"Super Admin"}),(0,Ba.jsx)("button",{onClick:()=>r(!n),children:n?(0,Ba.jsx)(Qt,{size:24}):(0,Ba.jsx)(st,{size:24})})]}),(0,Ba.jsx)("aside",{className:"fixed inset-y-0 left-0 z-30 w-64 bg-gray-900 text-white transform ".concat(n?"translate-x-0":"-translate-x-full"," transition-transform duration-300 ease-in-out lg:translate-x-0 border-r border-gray-800"),children:(0,Ba.jsx)(ffe,{handleLogout:s,closeSidebar:a})}),(0,Ba.jsx)("main",{className:"lg:ml-64 p-4 sm:p-6 lg:p-8 min-h-screen bg-gray-800",children:t}),(0,Ba.jsx)(p,{})]})},p=()=>a&&(0,Ba.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50",children:(0,Ba.jsxs)("div",{className:"bg-white rounded-lg p-6 w-96 text-gray-800 shadow-xl",children:[(0,Ba.jsx)("h3",{className:"text-xl font-bold mb-4",children:"Confirm Logout"}),(0,Ba.jsx)("p",{className:"mb-6",children:"Are you sure you want to secure your session?"}),(0,Ba.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,Ba.jsx)("button",{onClick:c,className:"px-4 py-2 bg-gray-200 rounded-lg hover:bg-gray-300",children:"Cancel"}),(0,Ba.jsx)("button",{onClick:s,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Logout"})]})]})});return n?(0,Ba.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-900 text-white",children:(0,Ba.jsx)("h1",{className:"text-2xl animate-pulse",children:"Initializing GymRatz..."})}):(0,Ba.jsx)(Me,{children:(0,Ba.jsxs)(_e,{children:[(0,Ba.jsx)(Ce,{path:"/",element:(0,Ba.jsx)(ti,{})}),(0,Ba.jsx)(Ce,{path:"/login",element:(0,Ba.jsx)(za,{setUser:t,user:e})}),(0,Ba.jsx)(Ce,{path:"/signup",element:(0,Ba.jsx)(ni,{})}),(0,Ba.jsx)(Ce,{path:"/forgot-password",element:(0,Ba.jsx)(cfe,{})}),(0,Ba.jsx)(Ce,{path:"/reset-password/:resetToken",element:(0,Ba.jsx)(ufe,{})}),(0,Ba.jsx)(Ce,{path:"/superadmin/login",element:(0,Ba.jsx)(nfe,{setUser:t})}),(0,Ba.jsx)(Ce,{path:"/superadmin/*",element:(0,Ba.jsx)(u,{role:"superadmin",children:(0,Ba.jsx)(f,{children:(0,Ba.jsxs)(_e,{children:[(0,Ba.jsx)(Ce,{path:"dashboard",element:(0,Ba.jsx)(tfe,{})}),(0,Ba.jsx)(Ce,{path:"tenants",element:(0,Ba.jsx)(afe,{})}),(0,Ba.jsx)(Ce,{path:"tenants/create",element:(0,Ba.jsx)(afe,{})}),(0,Ba.jsx)(Ce,{path:"tenants/inactive",element:(0,Ba.jsx)(afe,{})}),(0,Ba.jsx)(Ce,{path:"users/admins",element:(0,Ba.jsx)(ife,{})}),(0,Ba.jsx)(Ce,{path:"users/fighters",element:(0,Ba.jsx)(ife,{})}),(0,Ba.jsx)(Ce,{path:"users/superadmins",element:(0,Ba.jsx)(ife,{})}),(0,Ba.jsx)(Ce,{path:"billing/subscriptions",element:(0,Ba.jsx)(ofe,{})}),(0,Ba.jsx)(Ce,{path:"billing/payments",element:(0,Ba.jsx)(ofe,{})}),(0,Ba.jsx)(Ce,{path:"billing/invoices",element:(0,Ba.jsx)(ofe,{})}),(0,Ba.jsx)(Ce,{path:"billing/refunds",element:(0,Ba.jsx)(ofe,{})}),(0,Ba.jsx)(Ce,{path:"analytics",element:(0,Ba.jsx)(sfe,{})}),(0,Ba.jsx)(Ce,{path:"settings/general",element:(0,Ba.jsx)(lfe,{})}),(0,Ba.jsx)(Ce,{path:"settings/notifications",element:(0,Ba.jsx)(lfe,{})}),(0,Ba.jsx)(Ce,{path:"settings/database",element:(0,Ba.jsx)(lfe,{})}),(0,Ba.jsx)(Ce,{path:"settings/logs",element:(0,Ba.jsx)(lfe,{})}),(0,Ba.jsx)(Ce,{path:"*",element:(0,Ba.jsx)(Se,{to:"/superadmin/dashboard"})})]})})})}),(0,Ba.jsx)(Ce,{path:"/admin/dashboard",element:(0,Ba.jsx)(u,{role:"admin",children:(0,Ba.jsx)(h,{children:(0,Ba.jsx)(ii,{})})})}),(0,Ba.jsx)(Ce,{path:"/admin",element:(0,Ba.jsx)(u,{role:"admin",children:(0,Ba.jsx)(h,{children:(0,Ba.jsx)(ai,{})})})}),(0,Ba.jsx)(Ce,{path:"/admin/add-fighter",element:(0,Ba.jsx)(u,{role:"admin",children:(0,Ba.jsx)(h,{children:(0,Ba.jsx)(Lw,{})})})}),(0,Ba.jsx)(Ce,{path:"/admin/edit-fighter/:id",element:(0,Ba.jsx)(u,{role:"admin",children:(0,Ba.jsx)(h,{children:(0,Ba.jsx)(Mw,{})})})}),(0,Ba.jsx)(Ce,{path:"/admin/fighter/:id",element:(0,Ba.jsx)(u,{role:"admin",children:(0,Ba.jsx)(h,{children:(0,Ba.jsx)(jw,{})})})}),(0,Ba.jsx)(Ce,{path:"/admin/attendance",element:(0,Ba.jsx)(u,{role:"admin",children:(0,Ba.jsx)(h,{children:(0,Ba.jsx)(Xre,{})})})}),(0,Ba.jsx)(Ce,{path:"/admin/settings",element:(0,Ba.jsx)(u,{role:"admin",children:(0,Ba.jsx)(h,{children:(0,Ba.jsx)(Bw,{})})})}),(0,Ba.jsx)(Ce,{path:"/admin/subscriptions",element:(0,Ba.jsx)(u,{role:"admin",children:(0,Ba.jsx)(h,{children:(0,Ba.jsx)(Yre,{})})})}),(0,Ba.jsx)(Ce,{path:"/admin/ask-doubt",element:(0,Ba.jsx)(u,{role:"admin",children:(0,Ba.jsx)(h,{children:(0,Ba.jsx)(Tie,{})})})}),(0,Ba.jsx)(Ce,{path:"/fighter/stats",element:(0,Ba.jsx)(u,{role:"fighter",children:(0,Ba.jsx)(d,{children:(0,Ba.jsx)(efe,{})})})}),(0,Ba.jsx)(Ce,{path:"/fighter/attendance/face",element:(0,Ba.jsx)(u,{role:"fighter",children:(0,Ba.jsx)(d,{children:(0,Ba.jsx)(Bie,{})})})}),(0,Ba.jsx)(Ce,{path:"/fighter/ask-doubt",element:(0,Ba.jsx)(u,{role:"fighter",children:(0,Ba.jsx)(d,{children:(0,Ba.jsx)(Tie,{})})})}),(0,Ba.jsx)(Ce,{path:"/fighter/complete-profile",element:(0,Ba.jsx)(u,{role:"fighter",children:(0,Ba.jsx)(Mie,{})})}),(0,Ba.jsx)(Ce,{path:"/fighter",element:(0,Ba.jsx)(u,{role:"fighter",children:(0,Ba.jsx)(d,{children:(0,Ba.jsx)(Fie,{user:e})})})}),(0,Ba.jsx)(Ce,{path:"/fighter/attendance",element:(0,Ba.jsx)(u,{role:"fighter",children:(0,Ba.jsx)(d,{children:(0,Ba.jsx)(Pie,{user:e})})})}),(0,Ba.jsx)(Ce,{path:"/fighter/profile/update",element:(0,Ba.jsx)(u,{role:"fighter",children:(0,Ba.jsx)(d,{children:(0,Ba.jsx)(zie,{})})})}),(0,Ba.jsx)(Ce,{path:"/fighter/subscription-details",element:(0,Ba.jsx)(u,{role:"fighter",children:(0,Ba.jsx)(d,{children:(0,Ba.jsx)(Wie,{})})})}),(0,Ba.jsx)(Ce,{path:"*",element:(0,Ba.jsx)(Se,{to:"/",replace:!0})})]})})};u.createRoot(document.getElementById("root")).render((0,Ba.jsx)(l.StrictMode,{children:(0,Ba.jsx)(pfe,{})}))})()})();
//# sourceMappingURL=main.fd95420c.js.map